cscope 15 $HOME/interview/thousand/ldns-1.6.17               0001422957
	@buffer.c

10 
	~<ldns/c⁄fig.h
>

12 
	~<ldns/ldns.h
>

13 
	~<ldns/buf„r.h
>

15 
ldns_buf„r
 *

16 
	$ldns_buf„r_√w
(
size_t
 
ˇ∑côy
)

18 
ldns_buf„r
 *
buf„r
 = 
	`LDNS_MALLOC
(ldns_buffer);

20 i‡(!
buf„r
) {

21  
NULL
;

24 
buf„r
->
_d©a
 = (
uöt8_t
 *Ë
	`LDNS_XMALLOC
(uöt8_t, 
ˇ∑côy
);

25 i‡(!
buf„r
->
_d©a
) {

26 
	`LDNS_FREE
(
buf„r
);

27  
NULL
;

30 
buf„r
->
_posôi⁄
 = 0;

31 
buf„r
->
_limô
 = buf„r->
_ˇ∑côy
 = 
ˇ∑côy
;

32 
buf„r
->
_fixed
 = 0;

33 
buf„r
->
_°©us
 = 
LDNS_STATUS_OK
;

35 
	`ldns_buf„r_öv¨ü¡
(
buf„r
);

37  
buf„r
;

38 
	}
}

41 
	$ldns_buf„r_√w_‰m_d©a
(
ldns_buf„r
 *
buf„r
, *
d©a
, 
size_t
 
size
)

43 
	`as£π
(
d©a
 !
NULL
);

45 
buf„r
->
_posôi⁄
 = 0;

46 
buf„r
->
_limô
 = buf„r->
_ˇ∑côy
 = 
size
;

47 
buf„r
->
_fixed
 = 0;

48 
buf„r
->
_d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
size
);

49 if(!
buf„r
->
_d©a
) {

50 
buf„r
->
_°©us
 = 
LDNS_STATUS_MEM_ERR
;

53 
	`mem˝y
(
buf„r
->
_d©a
, 
d©a
, 
size
);

54 
buf„r
->
_°©us
 = 
LDNS_STATUS_OK
;

56 
	`ldns_buf„r_öv¨ü¡
(
buf„r
);

57 
	}
}

59 
boﬁ


60 
	$ldns_buf„r_£t_ˇ∑côy
(
ldns_buf„r
 *
buf„r
, 
size_t
 
ˇ∑côy
)

62 *
d©a
;

64 
	`ldns_buf„r_öv¨ü¡
(
buf„r
);

65 
	`as£π
(
buf„r
->
_posôi⁄
 <
ˇ∑côy
);

67 
d©a
 = (
uöt8_t
 *Ë
	`LDNS_XREALLOC
(
buf„r
->
_d©a
, uöt8_t, 
ˇ∑côy
);

68 i‡(!
d©a
) {

69 
buf„r
->
_°©us
 = 
LDNS_STATUS_MEM_ERR
;

70  
Ál£
;

72 
buf„r
->
_d©a
 = 
d©a
;

73 
buf„r
->
_limô
 = buf„r->
_ˇ∑côy
 = 
ˇ∑côy
;

74  
åue
;

76 
	}
}

78 
boﬁ


79 
	$ldns_buf„r_ª£rve
(
ldns_buf„r
 *
buf„r
, 
size_t
 
amou¡
)

81 
	`ldns_buf„r_öv¨ü¡
(
buf„r
);

82 
	`as£π
(!
buf„r
->
_fixed
);

83 i‡(
buf„r
->
_ˇ∑côy
 < buf„r->
_posôi⁄
 + 
amou¡
) {

84 
size_t
 
√w_ˇ∑côy
 = 
buf„r
->
_ˇ∑côy
 * 3 / 2;

86 i‡(
√w_ˇ∑côy
 < 
buf„r
->
_posôi⁄
 + 
amou¡
) {

87 
√w_ˇ∑côy
 = 
buf„r
->
_posôi⁄
 + 
amou¡
;

89 i‡(!
	`ldns_buf„r_£t_ˇ∑côy
(
buf„r
, 
√w_ˇ∑côy
)) {

90 
buf„r
->
_°©us
 = 
LDNS_STATUS_MEM_ERR
;

91  
Ál£
;

94 
buf„r
->
_limô
 = buf„r->
_ˇ∑côy
;

95  
åue
;

96 
	}
}

99 
	$ldns_buf„r_¥ötf
(
ldns_buf„r
 *
buf„r
, c⁄° *
f‹m©
, ...)

101 
va_li°
 
¨gs
;

102 
wrôãn
 = 0;

103 
size_t
 
ªmaöög
;

105 i‡(
	`ldns_buf„r_°©us_ok
(
buf„r
)) {

106 
	`ldns_buf„r_öv¨ü¡
(
buf„r
);

107 
	`as£π
(
buf„r
->
_limô
 =buf„r->
_ˇ∑côy
);

109 
ªmaöög
 = 
	`ldns_buf„r_ªmaöög
(
buf„r
);

110 
	`va_°¨t
(
¨gs
, 
f‹m©
);

111 
wrôãn
 = 
	`v¢¥ötf
((*Ë
	`ldns_buf„r_cuºít
(
buf„r
), 
ªmaöög
,

112 
f‹m©
, 
¨gs
);

113 
	`va_íd
(
¨gs
);

114 i‡(
wrôãn
 == -1) {

115 
buf„r
->
_°©us
 = 
LDNS_STATUS_INTERNAL_ERR
;

117 } i‡((
size_t
Ë
wrôãn
 >
ªmaöög
) {

118 i‡(!
	`ldns_buf„r_ª£rve
(
buf„r
, (
size_t
Ë
wrôãn
 + 1)) {

119 
buf„r
->
_°©us
 = 
LDNS_STATUS_MEM_ERR
;

122 
	`va_°¨t
(
¨gs
, 
f‹m©
);

123 
wrôãn
 = 
	`v¢¥ötf
((*Ë
	`ldns_buf„r_cuºít
(
buf„r
),

124 
	`ldns_buf„r_ªmaöög
(
buf„r
), 
f‹m©
, 
¨gs
);

125 
	`va_íd
(
¨gs
);

126 i‡(
wrôãn
 == -1) {

127 
buf„r
->
_°©us
 = 
LDNS_STATUS_INTERNAL_ERR
;

131 
buf„r
->
_posôi⁄
 +
wrôãn
;

133  
wrôãn
;

134 
	}
}

137 
	$ldns_buf„r_‰ì
(
ldns_buf„r
 *
buf„r
)

139 i‡(!
buf„r
) {

143 i‡(!
buf„r
->
_fixed
)

144 
	`LDNS_FREE
(
buf„r
->
_d©a
);

146 
	`LDNS_FREE
(
buf„r
);

147 
	}
}

150 
	$ldns_buf„r_exp‹t
(
ldns_buf„r
 *
buf„r
)

152 
buf„r
->
_fixed
 = 1;

153  
buf„r
->
_d©a
;

154 
	}
}

157 
	$ldns_bgëc
(
ldns_buf„r
 *
buf„r
)

159 i‡(!
	`ldns_buf„r_avaûabÀ_©
(
buf„r
, buf„r->
_posôi⁄
, (
uöt8_t
))) {

160 
	`ldns_buf„r_£t_posôi⁄
(
buf„r
, 
	`ldns_buf„r_limô
(buffer));

162  
EOF
;

164  ()
	`ldns_buf„r_ªad_u8
(
buf„r
);

165 
	}
}

168 
	$ldns_buf„r_c›y
(
ldns_buf„r
* 
ªsu…
,Üdns_buf„r* 
‰om
)

170 
size_t
 
toc›y
 = 
	`ldns_buf„r_limô
(
‰om
);

172 if(
toc›y
 > 
	`ldns_buf„r_ˇ∑côy
(
ªsu…
))

173 
toc›y
 = 
	`ldns_buf„r_ˇ∑côy
(
ªsu…
);

174 
	`ldns_buf„r_˛ór
(
ªsu…
);

175 
	`ldns_buf„r_wrôe
(
ªsu…
, 
	`ldns_buf„r_begö
(
‰om
), 
toc›y
);

176 
	`ldns_buf„r_Êù
(
ªsu…
);

177 
	}
}

	@compat/b64_ntop.c

42 
	~<ldns/c⁄fig.h
>

43 
	~<˘y≥.h
>

44 
	~<°dlib.h
>

45 
	~<°rög.h
>

47 c⁄° 
	gBa£64
[] =

49 c⁄° 
	gPad64
 = '=';

115 
	$ldns_b64_¡›
(
uöt8_t
 c⁄° *
§c
, 
size_t
 
§˛ígth
, *
èrgë
, size_à
èrgsize
) {

116 
size_t
 
d©Æígth
 = 0;

117 
uöt8_t
 
öput
[3];

118 
uöt8_t
 
ouçut
[4];

119 
size_t
 
i
;

121 i‡(
§˛ígth
 == 0) {

122 i‡(
èrgsize
 > 0) {

123 
èrgë
[0] = '\0';

130 2 < 
§˛ígth
) {

131 
öput
[0] = *
§c
++;

132 
öput
[1] = *
§c
++;

133 
öput
[2] = *
§c
++;

134 
§˛ígth
 -= 3;

136 
ouçut
[0] = 
öput
[0] >> 2;

137 
ouçut
[1] = ((
öput
[0] & 0x03) << 4) + (input[1] >> 4);

138 
ouçut
[2] = ((
öput
[1] & 0x0f) << 2) + (input[2] >> 6);

139 
ouçut
[3] = 
öput
[2] & 0x3f;

140 
	`as£π
(
ouçut
[0] < 64);

141 
	`as£π
(
ouçut
[1] < 64);

142 
	`as£π
(
ouçut
[2] < 64);

143 
	`as£π
(
ouçut
[3] < 64);

145 i‡(
d©Æígth
 + 4 > 
èrgsize
) {

148 
èrgë
[
d©Æígth
++] = 
Ba£64
[
ouçut
[0]];

149 
èrgë
[
d©Æígth
++] = 
Ba£64
[
ouçut
[1]];

150 
èrgë
[
d©Æígth
++] = 
Ba£64
[
ouçut
[2]];

151 
èrgë
[
d©Æígth
++] = 
Ba£64
[
ouçut
[3]];

155 i‡(0 !
§˛ígth
) {

157 
öput
[0] = i≈ut[1] = i≈ut[2] = (
uöt8_t
) '\0';

158 
i
 = 0; i < 
§˛ígth
; i++)

159 
öput
[
i
] = *
§c
++;

161 
ouçut
[0] = 
öput
[0] >> 2;

162 
ouçut
[1] = ((
öput
[0] & 0x03) << 4) + (input[1] >> 4);

163 
ouçut
[2] = ((
öput
[1] & 0x0f) << 2) + (input[2] >> 6);

164 
	`as£π
(
ouçut
[0] < 64);

165 
	`as£π
(
ouçut
[1] < 64);

166 
	`as£π
(
ouçut
[2] < 64);

168 i‡(
d©Æígth
 + 4 > 
èrgsize
) {

171 
èrgë
[
d©Æígth
++] = 
Ba£64
[
ouçut
[0]];

172 
èrgë
[
d©Æígth
++] = 
Ba£64
[
ouçut
[1]];

173 i‡(
§˛ígth
 == 1) {

174 
èrgë
[
d©Æígth
++] = 
Pad64
;

176 
èrgë
[
d©Æígth
++] = 
Ba£64
[
ouçut
[2]];

178 
èrgë
[
d©Æígth
++] = 
Pad64
;

180 i‡(
d©Æígth
 >
èrgsize
) {

183 
èrgë
[
d©Æígth
] = '\0';

184  (Ë(
d©Æígth
);

185 
	}
}

	@compat/b64_pton.c

42 
	~<ldns/c⁄fig.h
>

43 
	~<˘y≥.h
>

44 
	~<°dlib.h
>

45 
	~<°rög.h
>

47 c⁄° 
	gBa£64
[] =

49 c⁄° 
	gPad64
 = '=';

121 
	$ldns_b64_±⁄
(c⁄° *
§c
, 
uöt8_t
 *
èrgë
, 
size_t
 
èrgsize
)

123 
èrödex
, 
°©e
, 
ch
;

124 *
pos
;

126 
°©e
 = 0;

127 
èrödex
 = 0;

129 i‡(
	`°æí
(
§c
) == 0) {

133 (
ch
 = *
§c
++) != '\0') {

134 i‡(
	`is•a˚
(()
ch
))

137 i‡(
ch
 =
Pad64
)

140 
pos
 = 
	`°rchr
(
Ba£64
, 
ch
);

141 i‡(
pos
 == 0) {

146 
°©e
) {

148 i‡(
èrgë
) {

149 i‡((
size_t
)
èrödex
 >
èrgsize
)

151 
èrgë
[
èrödex
] = (
pos
 - 
Ba£64
) << 2;

153 
°©e
 = 1;

156 i‡(
èrgë
) {

157 i‡((
size_t
)
èrödex
 + 1 >
èrgsize
)

159 
èrgë
[
èrödex
] |(
pos
 - 
Ba£64
) >> 4;

160 
èrgë
[
èrödex
+1] = ((
pos
 - 
Ba£64
) & 0x0f)

163 
èrödex
++;

164 
°©e
 = 2;

167 i‡(
èrgë
) {

168 i‡((
size_t
)
èrödex
 + 1 >
èrgsize
)

170 
èrgë
[
èrödex
] |(
pos
 - 
Ba£64
) >> 2;

171 
èrgë
[
èrödex
+1] = ((
pos
 - 
Ba£64
) & 0x03)

174 
èrödex
++;

175 
°©e
 = 3;

178 i‡(
èrgë
) {

179 i‡((
size_t
)
èrödex
 >
èrgsize
)

181 
èrgë
[
èrödex
] |(
pos
 - 
Ba£64
);

183 
èrödex
++;

184 
°©e
 = 0;

187 
	`ab‹t
();

196 i‡(
ch
 =
Pad64
) {

197 
ch
 = *
§c
++;

198 
°©e
) {

205 ()
NULL
; 
ch
 !'\0'; ch = *
§c
++)

206 i‡(!
	`is•a˚
(()
ch
))

209 i‡(
ch
 !
Pad64
)

211 
ch
 = *
§c
++;

220 ()
NULL
; 
ch
 !'\0'; ch = *
§c
++)

221 i‡(!
	`is•a˚
(()
ch
))

230 i‡(
èrgë
 &&Å¨gë[
èrödex
] != 0)

238 i‡(
°©e
 != 0)

242  (
èrödex
);

243 
	}
}

	@compat/calloc.c

4 #i‡
HAVE_CONFIG_H


5 
	~<ldns/c⁄fig.h
>

8 *
ˇŒoc
();

10 #i‡!
HAVE_BZERO
 && 
HAVE_MEMSET


11 
	#bzîo
(
buf
, 
byãs
Ë((Ë
	`mem£t
 (buf, 0, byãs))

	)

15 
	$ˇŒoc
(
size_t
 
num
, size_à
size
)

17 *
√w
 = 
	`mÆloc
(
num
 * 
size
);

18 i‡(!
√w
) {

19  
NULL
;

21 
	`bzîo
(
√w
, 
num
 * 
size
);

22  
√w
;

23 
	}
}

	@compat/ctime_r.c

1 #ifde‡
HAVE_CONFIG_H


2 
	~<ldns/c⁄fig.h
>

5 #ifde‡
HAVE_TIME_H


6 
	~<time.h
>

9 *
	$˘ime_r
(c⁄° 
time_t
 *
timï
, *
buf
)

12 * 
ªsu…
 = 
	`˘ime
(
timï
);

13 if(
buf
 && 
ªsu…
)

14 
	`°r˝y
(
buf
, 
ªsu…
);

15  
ªsu…
;

16 
	}
}

	@compat/fake-rfc2553.c

39 
	~<ldns/c⁄fig.h
>

40 
	~<ldns/comm⁄.h
>

41 
	~<uni°d.h
>

42 
	~<°rög.h
>

43 
	~<°dio.h
>

44 
	~<°dlib.h
>

45 
	~"com∑t/Áke-rfc2553.h
"

47 #i‚de‡
HAVE_GETNAMEINFO


48 
gë«meöfo
(c⁄° 
sockaddr
 *
ß
, 
size_t
 
ATTR_UNUSED
(
ßÀn
), *
ho°
,

49 
size_t
 
ho°Àn
, *
£rv
, size_à
£rvÀn
, 
Êags
)

51 
sockaddr_ö
 *
	gsö
 = (sockaddr_ö *)
ß
;

52 
ho°ít
 *
	ghp
;

53 
	gtmp£rv
[16];

55 i‡(
	g£rv
 !
NULL
) {

56 
¢¥ötf
(
tmp£rv
, —mp£rv), "%d", 
¡ohs
(
sö
->
sö_p‹t
));

57 i‡(
°æ˝y
(
£rv
, 
tmp£rv
, 
£rvÀn
) >= servlen)

58  (
EAI_MEMORY
);

61 i‡(
	gho°
 !
NULL
) {

62 i‡(
Êags
 & 
NI_NUMERICHOST
) {

63 i‡(
°æ˝y
(
ho°
, 
öë_¡ﬂ
(
sö
->
sö_addr
),

64 
ho°Àn
) >= hostlen)

65  (
EAI_MEMORY
);

69 
	ghp
 = 
gëho°byaddr
((*)&
sö
->
sö_addr
,

70 (
ö_addr
), 
AF_INET
);

71 i‡(
	ghp
 =
NULL
)

72  (
EAI_NODATA
);

74 i‡(
°æ˝y
(
ho°
, 
hp
->
h_«me
, 
ho°Àn
) >= hostlen)

75  (
EAI_MEMORY
);

84 #i‚de‡
HAVE_GAI_STRERROR


85 #ifde‡
HAVE_CONST_GAI_STRERROR_PROTO


90 
	$gai_°ªº‹
(
îr
)

92 
îr
) {

93 
EAI_NODATA
:

95 
EAI_MEMORY
:

97 
EAI_NONAME
:

102 
	}
}

105 #i‚de‡
HAVE_FREEADDRINFO


107 
	$‰ìaddröfo
(
addröfo
 *
ai
)

109 
addröfo
 *
√xt
;

111 ; 
ai
 !
NULL
;) {

112 
√xt
 = 
ai
->
ai_√xt
;

113 
	`‰ì
(
ai
);

114 
ai
 = 
√xt
;

116 
	}
}

119 #i‚de‡
HAVE_GETADDRINFO


121 
addröfo
 *
	$mÆloc_ai
(
p‹t
, 
u_l⁄g
 
addr
, c⁄° 
addröfo
 *
höts
)

123 
addröfo
 *
ai
;

125 
ai
 = 
	`mÆloc
((*aiË+ (
sockaddr_ö
));

126 i‡(
ai
 =
NULL
)

127  (
NULL
);

129 
	`mem£t
(
ai
, '\0', (*aiË+ (
sockaddr_ö
));

131 
ai
->
ai_addr
 = (
sockaddr
 *)(ai + 1);

133 
ai
->
ai_addæí
 = (
sockaddr_ö
);

134 
ai
->
ai_addr
->
ß_Ámûy
 =ái->
ai_Ámûy
 = 
AF_INET
;

136 ((
sockaddr_ö
 *)(
ai
)->
ai_addr
)->
sö_p‹t
 = 
p‹t
;

137 ((
sockaddr_ö
 *)(
ai
)->
ai_addr
)->
sö_addr
.
s_addr
 = 
addr
;

140 i‡(
höts
->
ai_sockty≥
)

141 
ai
->
ai_sockty≥
 = 
höts
->ai_socktype;

143 
ai
->
ai_sockty≥
 = 
SOCK_STREAM
;

145 i‡(
höts
->
ai_¥Ÿocﬁ
)

146 
ai
->
ai_¥Ÿocﬁ
 = 
höts
->ai_protocol;

148  (
ai
);

149 
	}
}

152 
	$gëaddröfo
(c⁄° *
ho°«me
, c⁄° *
£rv«me
,

153 c⁄° 
addröfo
 *
höts
, addröfÿ**
ªs
)

155 
ho°ít
 *
hp
;

156 
£rvít
 *
•
;

157 
ö_addr
 
ö
;

158 
i
;

159 
p‹t
;

160 
u_l⁄g
 
addr
;

162 
p‹t
 = 0;

163 i‡(
£rv«me
 !
NULL
) {

164 *
˝
;

166 
p‹t
 = 
	`°πﬁ
(
£rv«me
, &
˝
, 10);

167 i‡(
p‹t
 > 0 &&Ö‹à<65535 && *
˝
 == '\0')

168 
p‹t
 = 
	`ht⁄s
(port);

169 i‡((
•
 = 
	`gë£rvby«me
(
£rv«me
, 
NULL
)) != NULL)

170 
p‹t
 = 
•
->
s_p‹t
;

172 
p‹t
 = 0;

175 i‡(
höts
 && höts->
ai_Êags
 & 
AI_PASSIVE
) {

176 
addr
 = 
	`ht⁄l
(0x00000000);

177 i‡(
ho°«me
 && 
	`öë_©⁄
(ho°«me, &
ö
) != 0)

178 
addr
 = 
ö
.
s_addr
;

179 *
ªs
 = 
	`mÆloc_ai
(
p‹t
, 
addr
, 
höts
);

180 i‡(*
ªs
 =
NULL
)

181  (
EAI_MEMORY
);

185 i‡(!
ho°«me
) {

186 *
ªs
 = 
	`mÆloc_ai
(
p‹t
, 
	`ht⁄l
(0x7f000001), 
höts
);

187 i‡(*
ªs
 =
NULL
)

188  (
EAI_MEMORY
);

192 i‡(
	`öë_©⁄
(
ho°«me
, &
ö
)) {

193 *
ªs
 = 
	`mÆloc_ai
(
p‹t
, 
ö
.
s_addr
, 
höts
);

194 i‡(*
ªs
 =
NULL
)

195  (
EAI_MEMORY
);

200 i‡(
höts
 && höts->
ai_Êags
 & 
AI_NUMERICHOST
)

201  (
EAI_NONAME
);

203 
hp
 = 
	`gëho°by«me
(
ho°«me
);

204 i‡(
hp
 && hp->
h_«me
 && hp->h_«me[0] && hp->
h_addr_li°
[0]) {

205 
addröfo
 *
cur
, *
¥ev
;

207 
cur
 = 
¥ev
 = *
ªs
 = 
NULL
;

208 
i
 = 0; 
hp
->
h_addr_li°
[i]; i++) {

209 
ö_addr
 *
ö
 = (ö_add∏*)
hp
->
h_addr_li°
[
i
];

211 
cur
 = 
	`mÆloc_ai
(
p‹t
, 
ö
->
s_addr
, 
höts
);

212 i‡(
cur
 =
NULL
) {

213 i‡(*
ªs
 !
NULL
)

214 
	`‰ìaddröfo
(*
ªs
);

215  (
EAI_MEMORY
);

217 i‡(
¥ev
)

218 
¥ev
->
ai_√xt
 = 
cur
;

220 *
ªs
 = 
cur
;

222 
¥ev
 = 
cur
;

227  (
EAI_NODATA
);

228 
	}
}

	@compat/fake-rfc2553.h

39 #i‚de‡
_FAKE_RFC2553_H


40 
	#_FAKE_RFC2553_H


	)

42 
	~<sys/ty≥s.h
>

43 
	~<sys/sockë.h
>

44 
	~<√tdb.h
>

45 
	~<limôs.h
>

47 #ifde‡
__˝lu•lus


54 #i‚de‡
HAVE_STRUCT_SOCKADDR_STORAGE


55 #i‚de‡
_SS_MAXSIZE


56 
	#_SS_MAXSIZE
 128

	)

57 
	#_SS_PADSIZE
 (
_SS_MAXSIZE
 -  (
sockaddr
))

	)

58 
	ssockaddr_°‹age
 {

59 
sockaddr
 
ss_ß
;

60 
__ss_∑d2
[
_SS_PADSIZE
];

62 
	#ss_Ámûy
 
ss_ß
.
ß_Ámûy


	)

66 #i‚de‡
IN6_IS_ADDR_LOOPBACK


67 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

68 (((
uöt32_t
 *)(
a
))[0] == 0 && ((uint32_t *)(a))[1] == 0 && \

69 ((
uöt32_t
 *)(
a
))[2] =0 && ((uöt32_à*)◊))[3] =
	`ht⁄l
(1))

	)

72 #i‚de‡
HAVE_STRUCT_IN6_ADDR


73 
	sö6_addr
 {

74 
uöt8_t
 
	ms6_addr
[16];

78 #i‚de‡
HAVE_STRUCT_SOCKADDR_IN6


79 
	ssockaddr_ö6
 {

80 
	msö6_Ámûy
;

81 
uöt16_t
 
	msö6_p‹t
;

82 
uöt32_t
 
	msö6_Êowöfo
;

83 
ö6_addr
 
	msö6_addr
;

87 #i‚de‡
AF_INET6


89 
	#AF_INET6
 
AF_MAX


	)

96 #i‚de‡
NI_NUMERICHOST


97 
	#NI_NUMERICHOST
 (1)

	)

99 #i‚de‡
NI_NAMEREQD


100 
	#NI_NAMEREQD
 (1<<1)

	)

102 #i‚de‡
NI_NUMERICSERV


103 
	#NI_NUMERICSERV
 (1<<2)

	)

106 #i‚de‡
AI_PASSIVE


107 
	#AI_PASSIVE
 (1)

	)

109 #i‚de‡
AI_CANONNAME


110 
	#AI_CANONNAME
 (1<<1)

	)

112 #i‚de‡
AI_NUMERICHOST


113 
	#AI_NUMERICHOST
 (1<<2)

	)

116 #i‚de‡
NI_MAXSERV


117 
	#NI_MAXSERV
 32

	)

119 #i‚de‡
NI_MAXHOST


120 
	#NI_MAXHOST
 1025

	)

123 #i‚de‡
INT_MAX


124 
	#INT_MAX
 0xffffffff

	)

127 #i‚de‡
EAI_NODATA


128 
	#EAI_NODATA
 (
INT_MAX
 - 1)

	)

130 #i‚de‡
EAI_MEMORY


131 
	#EAI_MEMORY
 (
INT_MAX
 - 2)

	)

133 #i‚de‡
EAI_NONAME


134 
	#EAI_NONAME
 (
INT_MAX
 - 3)

	)

136 #i‚de‡
EAI_SYSTEM


137 
	#EAI_SYSTEM
 (
INT_MAX
 - 4)

	)

140 #i‚de‡
HAVE_STRUCT_ADDRINFO


141 
	saddröfo
 {

142 
	mai_Êags
;

143 
	mai_Ámûy
;

144 
	mai_sockty≥
;

145 
	mai_¥Ÿocﬁ
;

146 
size_t
 
	mai_addæí
;

147 *
	mai_ˇn⁄«me
;

148 
sockaddr
 *
	mai_addr
;

149 
addröfo
 *
	mai_√xt
;

153 #i‚de‡
HAVE_GETADDRINFO


154 #ifde‡
gëaddröfo


155 #unde‡
gëaddröfo


157 
	#gëaddröfo
(
a
,
b
,
c
,
d
Ë(
	`ssh_gëaddröfo
◊,b,c,d))

	)

158 
gëaddröfo
(const *, const *,

159 c⁄° 
addröfo
 *, addrinfo **);

162 #i‡!
deföed
(
HAVE_GAI_STRERROR
Ë&& !deföed(
HAVE_CONST_GAI_STRERROR_PROTO
)

163 
	#gai_°ªº‹
(
a
Ë(
	`ssh_gai_°ªº‹
◊))

	)

164 *
gai_°ªº‹
();

167 #i‚de‡
HAVE_FREEADDRINFO


168 
	#‰ìaddröfo
(
a
Ë(
	`ssh_‰ìaddröfo
◊))

	)

169 
‰ìaddröfo
(
addröfo
 *);

172 #i‚de‡
HAVE_GETNAMEINFO


173 
	#gë«meöfo
(
a
,
b
,
c
,
d
,
e
,
f
,
g
Ë(
	`ssh_gë«meöfo
◊,b,c,d,e,f,g))

	)

174 
gë«meöfo
(c⁄° 
sockaddr
 *, 
size_t
, *, size_t,

175 *, 
size_t
, );

178 #ifde‡
__˝lu•lus


	@compat/gmtime_r.c

1 #ifde‡
HAVE_CONFIG_H


2 
	~<ldns/c⁄fig.h
>

5 #ifde‡
HAVE_TIME_H


6 
	~<time.h
>

9 
tm
 *
	$gmtime_r
(c⁄° 
time_t
 *
timï
, 
tm
 *
ªsu…
)

12 *
ªsu…
 = *
	`gmtime
(
timï
);

13  
ªsu…
;

14 
	}
}

	@compat/inet_aton.c

53 
	~<ldns/c⁄fig.h
>

55 #i‡!
deföed
(
HAVE_INET_ATON
)

57 
	~<sys/ty≥s.h
>

58 
	~<sys/∑øm.h
>

59 #ifde‡
HAVE_NETINET_IN_H


60 
	~<√töë/ö.h
>

62 #ifde‡
HAVE_ARPA_INET_H


63 
	~<¨∑/öë.h
>

65 
	~<˘y≥.h
>

72 
ö_addr_t


73 
	$öë_addr
(c⁄° *
˝
)

75 
ö_addr
 
vÆ
;

77 i‡(
	`öë_©⁄
(
˝
, &
vÆ
))

78  (
vÆ
.
s_addr
);

79  (
INADDR_NONE
);

80 
	}
}

91 
	$öë_©⁄
(c⁄° *
˝
, 
ö_addr
 *
addr
)

93 
uöt32_t
 
vÆ
;

94 
ba£
, 
n
;

95 
c
;

96 
∑πs
[4];

97 *
µ
 = 
∑πs
;

99 
c
 = *
˝
;

106 i‡(!
	`isdigô
((Ë
c
))

108 
vÆ
 = 0; 
ba£
 = 10;

109 i‡(
c
 == '0') {

110 
c
 = *++
˝
;

111 i‡(
c
 == 'x' || c == 'X')

112 
ba£
 = 16, 
c
 = *++
˝
;

114 
ba£
 = 8;

117 i‡(
	`ißscii
((Ë
c
Ë&& 
	`isdigô
(() c)) {

118 
vÆ
 = (vÆ * 
ba£
Ë+ (
c
 - '0');

119 
c
 = *++
˝
;

120 } i‡(
ba£
 =16 && 
	`ißscii
((Ë
c
Ë&& 
	`isxdigô
(() c)) {

121 
vÆ
 = (val << 4) |

122 (
c
 + 10 - (
	`i¶owî
(() c) ? 'a' : 'A'));

123 
c
 = *++
˝
;

127 i‡(
c
 == '.') {

134 i‡(
µ
 >
∑πs
 + 3)

136 *
µ
++ = 
vÆ
;

137 
c
 = *++
˝
;

144 i‡(
c
 !'\0' && (!
	`ißscii
((ËcË|| !
	`is•a˚
(() c)))

150 
n
 = 
µ
 - 
∑πs
 + 1;

151 
n
) {

160 i‡((
vÆ
 > 0xffffffË|| (
∑πs
[0] > 0xff))

162 
vÆ
 |
∑πs
[0] << 24;

166 i‡((
vÆ
 > 0xffffË|| (
∑πs
[0] > 0xff) || (parts[1] > 0xff))

168 
vÆ
 |(
∑πs
[0] << 24) | (parts[1] << 16);

172 i‡((
vÆ
 > 0xffË|| (
∑πs
[0] > 0xff) || (parts[1] > 0xff) || (parts[2] > 0xff))

174 
vÆ
 |(
∑πs
[0] << 24) | (parts[1] << 16) | (parts[2] << 8);

177 i‡(
addr
)

178 
addr
->
s_addr
 = 
	`ht⁄l
(
vÆ
);

180 
	}
}

	@compat/inet_ntop.c

20 
	~<ldns/c⁄fig.h
>

22 #i‚de‡
HAVE_INET_NTOP


24 
	~<sys/∑øm.h
>

25 
	~<sys/ty≥s.h
>

26 #ifde‡
HAVE_SYS_SOCKET_H


27 
	~<sys/sockë.h
>

29 #ifde‡
HAVE_NETINET_IN_H


30 
	~<√töë/ö.h
>

32 
	~<°rög.h
>

33 
	~<î∫o.h
>

34 
	~<°dio.h
>

36 #i‚de‡
IN6ADDRSZ


37 
	#IN6ADDRSZ
 16

	)

40 #i‚de‡
INT16SZ


41 
	#INT16SZ
 2

	)

49 c⁄° *
öë_¡›4
(c⁄° 
u_ch¨
 *
§c
, *
d°
, 
size_t
 
size
);

50 c⁄° *
öë_¡›6
(c⁄° 
u_ch¨
 *
§c
, *
d°
, 
size_t
 
size
);

61 
	$öë_¡›
(
af
, c⁄° *
§c
, *
d°
, 
size_t
 
size
)

63 
af
) {

64 
AF_INET
:

65  (
	`öë_¡›4
(
§c
, 
d°
, 
size
));

66 
AF_INET6
:

67  (
	`öë_¡›6
(
§c
, 
d°
, 
size
));

69 #ifde‡
EAFNOSUPPORT


70 
î∫o
 = 
EAFNOSUPPORT
;

72 
î∫o
 = 
ENOSYS
;

74  (
NULL
);

77 
	}
}

91 
	$öë_¡›4
(c⁄° 
u_ch¨
 *
§c
, *
d°
, 
size_t
 
size
)

93 c⁄° 
fmt
[] = "%u.%u.%u.%u";

94 
tmp
[ "255.255.255.255"];

95 
l
;

97 
l
 = 
	`¢¥ötf
(
tmp
, 
size
, 
fmt
, 
§c
[0], src[1], src[2], src[3]);

98 i‡(
l
 <0 ||Ü >()
size
) {

99 
î∫o
 = 
ENOSPC
;

100  (
NULL
);

102 
	`°æ˝y
(
d°
, 
tmp
, 
size
);

103  (
d°
);

104 
	}
}

113 
	$öë_¡›6
(c⁄° 
u_ch¨
 *
§c
, *
d°
, 
size_t
 
size
)

122 
tmp
[ "ffff:ffff:ffff:ffff:ffff:ffff:255.255.255.255"];

123 *
ç
, *
ï
;

124 °ru˘ { 
ba£
, 
Àn
; } 
be°
, 
cur
;

125 
u_öt
 
w‹ds
[
IN6ADDRSZ
 / 
INT16SZ
];

126 
i
;

127 
adv™˚
;

134 
	`mem£t
(
w‹ds
, '\0',  words);

135 
i
 = 0; i < 
IN6ADDRSZ
; i++)

136 
w‹ds
[
i
 / 2] |(
§c
[i] << ((1 - (i % 2)) << 3));

137 
be°
.
ba£
 = -1;

138 
be°
.
Àn
 = 0;

139 
cur
.
ba£
 = -1;

140 
cur
.
Àn
 = 0;

141 
i
 = 0; i < (
IN6ADDRSZ
 / 
INT16SZ
); i++) {

142 i‡(
w‹ds
[
i
] == 0) {

143 i‡(
cur
.
ba£
 == -1)

144 
cur
.
ba£
 = 
i
, cur.
Àn
 = 1;

146 
cur
.
Àn
++;

148 i‡(
cur
.
ba£
 != -1) {

149 i‡(
be°
.
ba£
 =-1 || 
cur
.
Àn
 > best.len)

150 
be°
 = 
cur
;

151 
cur
.
ba£
 = -1;

155 i‡(
cur
.
ba£
 != -1) {

156 i‡(
be°
.
ba£
 =-1 || 
cur
.
Àn
 > best.len)

157 
be°
 = 
cur
;

159 i‡(
be°
.
ba£
 !-1 && be°.
Àn
 < 2)

160 
be°
.
ba£
 = -1;

165 
ç
 = 
tmp
;

166 
ï
 = 
tmp
 + (tmp);

167 
i
 = 0; i < (
IN6ADDRSZ
 / 
INT16SZ
Ë&& 
ç
 < 
ï
; i++) {

169 i‡(
be°
.
ba£
 !-1 && 
i
 >= best.base &&

170 
i
 < (
be°
.
ba£
 + be°.
Àn
)) {

171 i‡(
i
 =
be°
.
ba£
) {

172 i‡(
ç
 + 1 >
ï
)

173  (
NULL
);

174 *
ç
++ = ':';

179 i‡(
i
 != 0) {

180 i‡(
ç
 + 1 >
ï
)

181  (
NULL
);

182 *
ç
++ = ':';

185 i‡(
i
 =6 && 
be°
.
ba£
 == 0 &&

186 (
be°
.
Àn
 =6 || (be°.À¿=5 && 
w‹ds
[5] == 0xffff))) {

187 i‡(!
	`öë_¡›4
(
§c
+12, 
ç
, (
size_t
)(
ï
 -Åp)))

188  (
NULL
);

189 
ç
 +
	`°æí
(tp);

192 
adv™˚
 = 
	`¢¥ötf
(
ç
, 
ï
 -Åp, "%x", 
w‹ds
[
i
]);

193 i‡(
adv™˚
 <0 ||ádv™˚ >
ï
 - 
ç
)

194  (
NULL
);

195 
ç
 +
adv™˚
;

198 i‡(
be°
.
ba£
 !-1 && (be°.ba£ + be°.
Àn
Ë=(
IN6ADDRSZ
 / 
INT16SZ
)) {

199 i‡(
ç
 + 1 >
ï
)

200  (
NULL
);

201 *
ç
++ = ':';

203 i‡(
ç
 + 1 >
ï
)

204  (
NULL
);

205 *
ç
++ = '\0';

210 i‡((
size_t
)(
ç
 - 
tmp
Ë> 
size
) {

211 
î∫o
 = 
ENOSPC
;

212  (
NULL
);

214 
	`°æ˝y
(
d°
, 
tmp
, 
size
);

215  (
d°
);

216 
	}
}

	@compat/inet_pton.c

19 
	~<ldns/c⁄fig.h
>

21 
	~<°rög.h
>

22 
	~<°dio.h
>

23 
	~<î∫o.h
>

30 
öë_±⁄4
 (c⁄° *
§c
, 
uöt8_t
 *
d°
);

31 
öë_±⁄6
 (c⁄° *
§c
, 
uöt8_t
 *
d°
);

38 #i‚de‡
NS_INT16SZ


39 
	#NS_INT16SZ
 2

	)

42 #i‚de‡
NS_IN6ADDRSZ


43 
	#NS_IN6ADDRSZ
 16

	)

46 #i‚de‡
NS_INADDRSZ


47 
	#NS_INADDRSZ
 4

	)

62 
	$öë_±⁄
(
af
, 
§c
, 
d°
)

63 
af
;

64 c⁄° *
§c
;

65 *
d°
;

67 
af
) {

68 
AF_INET
:

69  (
	`öë_±⁄4
(
§c
, 
d°
));

70 
AF_INET6
:

71  (
	`öë_±⁄6
(
§c
, 
d°
));

73 #ifde‡
EAFNOSUPPORT


74 
î∫o
 = 
EAFNOSUPPORT
;

76 
î∫o
 = 
ENOSYS
;

81 
	}
}

94 
	$öë_±⁄4
(
§c
, 
d°
)

95 c⁄° *
§c
;

96 
uöt8_t
 *
d°
;

98 c⁄° 
digôs
[] = "0123456789";

99 
ßw_digô
, 
o˘ës
, 
ch
;

100 
uöt8_t
 
tmp
[
NS_INADDRSZ
], *
ç
;

102 
ßw_digô
 = 0;

103 
o˘ës
 = 0;

104 *(
ç
 = 
tmp
) = 0;

105 (
ch
 = *
§c
++) != '\0') {

106 c⁄° *
pch
;

108 i‡((
pch
 = 
	`°rchr
(
digôs
, 
ch
)Ë!
NULL
) {

109 
uöt32_t
 
√w
 = *
ç
 * 10 + (
pch
 - 
digôs
);

111 i‡(
√w
 > 255)

113 *
ç
 = 
√w
;

114 i‡(! 
ßw_digô
) {

115 i‡(++
o˘ës
 > 4)

117 
ßw_digô
 = 1;

119 } i‡(
ch
 ='.' && 
ßw_digô
) {

120 i‡(
o˘ës
 == 4)

122 *++
ç
 = 0;

123 
ßw_digô
 = 0;

127 i‡(
o˘ës
 < 4)

130 
	`mem˝y
(
d°
, 
tmp
, 
NS_INADDRSZ
);

132 
	}
}

148 
	$öë_±⁄6
(
§c
, 
d°
)

149 c⁄° *
§c
;

150 
uöt8_t
 *
d°
;

152 c⁄° 
xdigôs_l
[] = "0123456789abcdef",

153 
xdigôs_u
[] = "0123456789ABCDEF";

154 
uöt8_t
 
tmp
[
NS_IN6ADDRSZ
], *
ç
, *
ídp
, *
cﬁ⁄p
;

155 c⁄° *
xdigôs
, *
cuπok
;

156 
ch
, 
ßw_xdigô
;

157 
uöt32_t
 
vÆ
;

159 
	`mem£t
((
ç
 = 
tmp
), '\0', 
NS_IN6ADDRSZ
);

160 
ídp
 = 
ç
 + 
NS_IN6ADDRSZ
;

161 
cﬁ⁄p
 = 
NULL
;

163 i‡(*
§c
 == ':')

164 i‡(*++
§c
 != ':')

166 
cuπok
 = 
§c
;

167 
ßw_xdigô
 = 0;

168 
vÆ
 = 0;

169 (
ch
 = *
§c
++) != '\0') {

170 c⁄° *
pch
;

172 i‡((
pch
 = 
	`°rchr
((
xdigôs
 = 
xdigôs_l
), 
ch
)Ë=
NULL
)

173 
pch
 = 
	`°rchr
((
xdigôs
 = 
xdigôs_u
), 
ch
);

174 i‡(
pch
 !
NULL
) {

175 
vÆ
 <<= 4;

176 
vÆ
 |(
pch
 - 
xdigôs
);

177 i‡(
vÆ
 > 0xffff)

179 
ßw_xdigô
 = 1;

182 i‡(
ch
 == ':') {

183 
cuπok
 = 
§c
;

184 i‡(!
ßw_xdigô
) {

185 i‡(
cﬁ⁄p
)

187 
cﬁ⁄p
 = 
ç
;

190 i‡(
ç
 + 
NS_INT16SZ
 > 
ídp
)

192 *
ç
++ = (
uöt8_t
Ë(
vÆ
 >> 8) & 0xff;

193 *
ç
++ = (
uöt8_t
Ë
vÆ
 & 0xff;

194 
ßw_xdigô
 = 0;

195 
vÆ
 = 0;

198 i‡(
ch
 ='.' && ((
ç
 + 
NS_INADDRSZ
Ë<
ídp
) &&

199 
	`öë_±⁄4
(
cuπok
, 
ç
) > 0) {

200 
ç
 +
NS_INADDRSZ
;

201 
ßw_xdigô
 = 0;

206 i‡(
ßw_xdigô
) {

207 i‡(
ç
 + 
NS_INT16SZ
 > 
ídp
)

209 *
ç
++ = (
uöt8_t
Ë(
vÆ
 >> 8) & 0xff;

210 *
ç
++ = (
uöt8_t
Ë
vÆ
 & 0xff;

212 i‡(
cﬁ⁄p
 !
NULL
) {

217 c⁄° 
n
 = 
ç
 - 
cﬁ⁄p
;

218 
i
;

220 
i
 = 1; i <
n
; i++) {

221 
ídp
[- 
i
] = 
cﬁ⁄p
[
n
 - i];

222 
cﬁ⁄p
[
n
 - 
i
] = 0;

224 
ç
 = 
ídp
;

226 i‡(
ç
 !
ídp
)

228 
	`mem˝y
(
d°
, 
tmp
, 
NS_IN6ADDRSZ
);

230 
	}
}

	@compat/isascii.c

4 #i‡
HAVE_CONFIG_H


5 
	~<ldns/c⁄fig.h
>

8 
ißscii
(
c
);

12 
	$ißscii
(
c
)

14  
c
 >= 0 && c < 128;

15 
	}
}

	@compat/isblank.c

4 #i‡
HAVE_CONFIG_H


5 
	~<ldns/c⁄fig.h
>

8 
isbœnk
(
c
);

12 
	$isbœnk
(
c
)

14  (
c
 == ' ') || (c == '\t');

15 
	}
}

	@compat/localtime_r.c

1 #ifde‡
HAVE_CONFIG_H


2 
	~<ldns/c⁄fig.h
>

5 #ifde‡
HAVE_TIME_H


6 
	~<time.h
>

9 
tm
 *
	$loˇ…ime_r
(c⁄° 
time_t
 *
timï
, 
tm
 *
ªsu…
)

12 *
ªsu…
 = *
	`loˇ…ime
(
timï
);

13  
ªsu…
;

14 
	}
}

	@compat/malloc.c

4 #i‡
HAVE_CONFIG_H


5 
	~<ldns/c⁄fig.h
>

7 #unde‡
mÆloc


9 
	~<sys/ty≥s.h
>

11 *
mÆloc
 ();

17 
	$Ωl_mÆloc
 (
size_t
 
n
)

19 i‡(
n
 == 0)

20 
n
 = 1;

21  
	`mÆloc
 (
n
);

22 
	}
}

	@compat/memmove.c

9 
	~<ldns/c⁄fig.h
>

10 
	~<°dlib.h
>

12 *
memmove
(*
de°
, c⁄° *
§c
, 
size_t
 
n
);

14 *
	$memmove
(*
de°
, c⁄° *
§c
, 
size_t
 
n
)

16 
uöt8_t
* 
‰om
 = (uöt8_t*Ë
§c
;

17 
uöt8_t
* 
to
 = (uöt8_t*Ë
de°
;

19 i‡(
‰om
 =
to
 || 
n
 == 0)

20  
de°
;

21 i‡(
to
 > 
‰om
 &&Åo-‰om < ()
n
) {

26 
i
;

27 
i
=
n
-1; i>=0; i--)

28 
to
[
i
] = 
‰om
[i];

29  
de°
;

31 i‡(
‰om
 > 
to
 && from-tÿ< ()
n
) {

36 
size_t
 
i
;

37 
i
=0; i<
n
; i++)

38 
to
[
i
] = 
‰om
[i];

39  
de°
;

41 
	`mem˝y
(
de°
, 
§c
, 
n
);

42  
de°
;

43 
	}
}

	@compat/realloc.c

4 #i‡
HAVE_CONFIG_H


5 
	~<ldns/c⁄fig.h
>

7 #unde‡
ªÆloc


9 
	~<sys/ty≥s.h
>

11 *
ªÆloc
 (*, 
size_t
);

12 *
mÆloc
 (
size_t
);

21 
	$Ωl_ªÆloc
 (* 
±r
, 
size_t
 
n
)

23 i‡(
n
 == 0)

24 
n
 = 1;

25 if(
±r
 == 0) {

26  
	`mÆloc
(
n
);

28  
	`ªÆloc
(
±r
, 
n
);

29 
	}
}

	@compat/snprintf.c

35 
	~<ldns/c⁄fig.h
>

36 
	~<°dio.h
>

37 
	~<˘y≥.h
>

38 
	~<°rög.h
>

39 
	~<°d¨g.h
>

40 
	~<°dlib.h
>

41 
	~<î∫o.h
>

42 #ifde‡
HAVE_STDINT_H


43 
	~<°döt.h
>

48 #ifde‡
SNPRINTF_TEST


49 
	#¢¥ötf
 
my_¢¥ötf


	)

50 
	#v¢¥ötf
 
my_v¢¥ötf


	)

53 
¢¥ötf
(* 
°r
, 
size_t
 
size
, c⁄° * 
f‹m©
, ...);

54 
v¢¥ötf
(* 
°r
, 
size_t
 
size
, c⁄° * 
f‹m©
, 
va_li°
 
¨g
);

66 
	$¢¥ötf
(* 
°r
, 
size_t
 
size
, c⁄° * 
f‹m©
, ...)

68 
r
;

69 
va_li°
 
¨gs
;

70 
	`va_°¨t
(
¨gs
, 
f‹m©
);

71 
r
 = 
	`v¢¥ötf
(
°r
, 
size
, 
f‹m©
, 
¨gs
);

72 
	`va_íd
(
¨gs
);

73  
r
;

74 
	}
}

78 
	$¥öt_∑d
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
p
, 
num
)

80 
num
--) {

81 if(*
À·
 > 1) {

82 *(*
©
)++ = 
p
;

83 (*
À·
)--;

85 (*
ªt
)++;

87 
	}
}

91 
	$gë_√gsign
(
√g©ive
, 
∂us
, 
•a˚
)

93 if(
√g©ive
)

95 if(
∂us
)

97 if(
•a˚
)

100 
	}
}

102 
	#PRINT_DEC_BUFSZ
 32

	)

105 
	$¥öt_dec
(* 
buf
, 
max
, 
vÆue
)

107 
i
 = 0;

108 if(
vÆue
 == 0) {

109 if(
max
 > 0) {

110 
buf
[0] = '0';

111 
i
 = 1;

113 } 
vÆue
 && 
i
 < 
max
) {

114 
buf
[
i
++] = '0' + 
vÆue
 % 10;

115 
vÆue
 /= 10;

117  
i
;

118 
	}
}

122 
	$¥öt_dec_l
(* 
buf
, 
max
, 
vÆue
)

124 
i
 = 0;

125 if(
vÆue
 == 0) {

126 if(
max
 > 0) {

127 
buf
[0] = '0';

128 
i
 = 1;

130 } 
vÆue
 && 
i
 < 
max
) {

131 
buf
[
i
++] = '0' + 
vÆue
 % 10;

132 
vÆue
 /= 10;

134  
i
;

135 
	}
}

139 
	$¥öt_dec_Œ
(* 
buf
, 
max
, 
vÆue
)

141 
i
 = 0;

142 if(
vÆue
 == 0) {

143 if(
max
 > 0) {

144 
buf
[0] = '0';

145 
i
 = 1;

147 } 
vÆue
 && 
i
 < 
max
) {

148 
buf
[
i
++] = '0' + 
vÆue
 % 10;

149 
vÆue
 /= 10;

151  
i
;

152 
	}
}

156 
	$¥öt_hex
(* 
buf
, 
max
, 
vÆue
)

158 c⁄° * 
h
 = "0123456789abcdef";

159 
i
 = 0;

160 if(
vÆue
 == 0) {

161 if(
max
 > 0) {

162 
buf
[0] = '0';

163 
i
 = 1;

165 } 
vÆue
 && 
i
 < 
max
) {

166 
buf
[
i
++] = 
h
[
vÆue
 & 0x0f];

167 
vÆue
 >>= 4;

169  
i
;

170 
	}
}

174 
	$¥öt_hex_l
(* 
buf
, 
max
, 
vÆue
)

176 c⁄° * 
h
 = "0123456789abcdef";

177 
i
 = 0;

178 if(
vÆue
 == 0) {

179 if(
max
 > 0) {

180 
buf
[0] = '0';

181 
i
 = 1;

183 } 
vÆue
 && 
i
 < 
max
) {

184 
buf
[
i
++] = 
h
[
vÆue
 & 0x0f];

185 
vÆue
 >>= 4;

187  
i
;

188 
	}
}

192 
	$¥öt_hex_Œ
(* 
buf
, 
max
, 
vÆue
)

194 c⁄° * 
h
 = "0123456789abcdef";

195 
i
 = 0;

196 if(
vÆue
 == 0) {

197 if(
max
 > 0) {

198 
buf
[0] = '0';

199 
i
 = 1;

201 } 
vÆue
 && 
i
 < 
max
) {

202 
buf
[
i
++] = 
h
[
vÆue
 & 0x0f];

203 
vÆue
 >>= 4;

205  
i
;

206 
	}
}

210 
	$•oﬁ_°r_ªv
(** 
©
, 
size_t
* 
À·
, * 
ªt
, c⁄° * 
buf
, 
Àn
)

212 
i
 = 
Àn
;

213 
i
) {

214 if(*
À·
 > 1) {

215 *(*
©
)++ = 
buf
[--
i
];

216 (*
À·
)--;

217 } --
i
;

218 (*
ªt
)++;

220 
	}
}

224 
	$•oﬁ_°r
(** 
©
, 
size_t
* 
À·
, * 
ªt
, c⁄° * 
buf
, 
Àn
)

226 
i
;

227 
i
=0; i<
Àn
; i++) {

228 if(*
À·
 > 1) {

229 *(*
©
)++ = 
buf
[
i
];

230 (*
À·
)--;

232 (*
ªt
)++;

234 
	}
}

238 
	$¥öt_num
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
möw
, 
¥ecisi⁄
,

239 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
,

240 
zîo
, 
√g©ive
, * 
buf
, 
Àn
)

242 
w
 = 
Àn
;

243 
s
 = 
	`gë_√gsign
(
√g©ive
, 
∂us
, 
•a˚
);

244 if(
möus
) {

247 
numw
 = 
w
;

248 if(
¥ecisi⁄
 =0 && 
zîo
Ë
numw
 = 0;

249 if(
numw
 < 
¥ecisi⁄
)Çumw =Örecision;

250 if(
s
Ë
numw
++;

253 if(
s
Ë
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, s, 1);

256 if(
¥ecisi⁄
 =0 && 
zîo
) {

259 if(
w
 < 
¥ecisi⁄
)

260 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, '0', 
¥ecisi⁄
 - 
w
);

261 
	`•oﬁ_°r_ªv
(
©
, 
À·
, 
ªt
, 
buf
, 
Àn
);

264 if(
numw
 < 
möw
)

265 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, ' ', 
möw
 - 
numw
);

269 
numw
 = 
w
;

270 if(
¥ecisi⁄
 =0 && 
zîo
Ë
numw
 = 0;

271 if(
numw
 < 
¥ecisi⁄
)Çumw =Örecision;

272 if(!
¥giví
 && 
zî›ad
 && 
numw
 < 
möw
)Çumw = minw;

273 if(
s
Ë
numw
++;

276 if(
numw
 < 
möw
)

277 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, ' ', 
möw
 - 
numw
);

279 if(
s
) {

280 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, 
s
, 1);

281 
numw
--;

284 if(
w
 < 
numw
)

285 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, '0', 
numw
 - 
w
);

286 if(
¥ecisi⁄
 =0 && 
zîo
)

289 
	`•oﬁ_°r_ªv
(
©
, 
À·
, 
ªt
, 
buf
, 
Àn
);

291 
	}
}

295 
	$¥öt_num_d
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

296 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

297 
∂us
, 
•a˚
)

299 
buf
[
PRINT_DEC_BUFSZ
];

300 
√g©ive
 = (
vÆue
 < 0);

301 
zîo
 = (
vÆue
 == 0);

302 
Àn
 = 
	`¥öt_dec
(
buf
, ()(buf),

303 ()(
√g©ive
?-
vÆue
:value));

304 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

305 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

306 
	}
}

310 
	$¥öt_num_ld
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

311 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

312 
∂us
, 
•a˚
)

314 
buf
[
PRINT_DEC_BUFSZ
];

315 
√g©ive
 = (
vÆue
 < 0);

316 
zîo
 = (
vÆue
 == 0);

317 
Àn
 = 
	`¥öt_dec_l
(
buf
, ()(buf),

318 ()(
√g©ive
?-
vÆue
:value));

319 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

320 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

321 
	}
}

325 
	$¥öt_num_Œd
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

326 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

327 
∂us
, 
•a˚
)

329 
buf
[
PRINT_DEC_BUFSZ
];

330 
√g©ive
 = (
vÆue
 < 0);

331 
zîo
 = (
vÆue
 == 0);

332 
Àn
 = 
	`¥öt_dec_Œ
(
buf
, ()(buf),

333 ()(
√g©ive
?-
vÆue
:value));

334 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

335 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

336 
	}
}

340 
	$¥öt_num_u
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

341 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

342 
∂us
, 
•a˚
)

344 
buf
[
PRINT_DEC_BUFSZ
];

345 
√g©ive
 = 0;

346 
zîo
 = (
vÆue
 == 0);

347 
Àn
 = 
	`¥öt_dec
(
buf
, ()(buf), 
vÆue
);

348 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

349 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

350 
	}
}

354 
	$¥öt_num_lu
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

355 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

356 
∂us
, 
•a˚
)

358 
buf
[
PRINT_DEC_BUFSZ
];

359 
√g©ive
 = 0;

360 
zîo
 = (
vÆue
 == 0);

361 
Àn
 = 
	`¥öt_dec_l
(
buf
, ()(buf), 
vÆue
);

362 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

363 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

364 
	}
}

368 
	$¥öt_num_Œu
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

369 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

370 
∂us
, 
•a˚
)

372 
buf
[
PRINT_DEC_BUFSZ
];

373 
√g©ive
 = 0;

374 
zîo
 = (
vÆue
 == 0);

375 
Àn
 = 
	`¥öt_dec_Œ
(
buf
, ()(buf), 
vÆue
);

376 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

377 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

378 
	}
}

382 
	$¥öt_num_x
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

383 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

384 
∂us
, 
•a˚
)

386 
buf
[
PRINT_DEC_BUFSZ
];

387 
√g©ive
 = 0;

388 
zîo
 = (
vÆue
 == 0);

389 
Àn
 = 
	`¥öt_hex
(
buf
, ()(buf), 
vÆue
);

390 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

391 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

392 
	}
}

396 
	$¥öt_num_lx
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

397 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

398 
∂us
, 
•a˚
)

400 
buf
[
PRINT_DEC_BUFSZ
];

401 
√g©ive
 = 0;

402 
zîo
 = (
vÆue
 == 0);

403 
Àn
 = 
	`¥öt_hex_l
(
buf
, ()(buf), 
vÆue
);

404 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

405 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

406 
	}
}

410 
	$¥öt_num_Œx
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

411 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

412 
∂us
, 
•a˚
)

414 
buf
[
PRINT_DEC_BUFSZ
];

415 
√g©ive
 = 0;

416 
zîo
 = (
vÆue
 == 0);

417 
Àn
 = 
	`¥öt_hex_Œ
(
buf
, ()(buf), 
vÆue
);

418 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

419 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

420 
	}
}

424 
	$¥öt_num_Œp
(** 
©
, 
size_t
* 
À·
, * 
ªt
, * 
vÆue
,

425 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

426 
∂us
, 
•a˚
)

428 
buf
[
PRINT_DEC_BUFSZ
];

429 
√g©ive
 = 0;

430 
zîo
 = (
vÆue
 == 0);

431 #i‡
	`deföed
(
UINTPTR_MAX
Ë&& deföed(
UINT32_MAX
) && (UINTPTR_MAX == UINT32_MAX)

433 
ŒvÆue
 = ()
vÆue
;

435 
ŒvÆue
 = ()
vÆue
;

437 
Àn
 = 
	`¥öt_hex_Œ
(
buf
, ()(buf), 
ŒvÆue
);

438 if(
zîo
) {

439 
buf
[0]=')';

440 
buf
[1]='l';

441 
buf
[2]='i';

442 
buf
[3]='n';

443 
buf
[4]='(';

444 
Àn
 = 5;

447 if(
Àn
 < 
PRINT_DEC_BUFSZ
)

448 
buf
[
Àn
++] = 'x';

449 if(
Àn
 < 
PRINT_DEC_BUFSZ
)

450 
buf
[
Àn
++] = '0';

452 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

453 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

454 
	}
}

456 
	#PRINT_FLOAT_BUFSZ
 64

	)

459 
	$¥öt_ªmaödî
(* 
buf
, 
max
, 
r
, 
¥ec
)

461 
ˇp
 = 1;

462 
vÆue
;

463 
Àn
, 
i
;

464 if(
¥ec
 > 19)Örec = 19;

465 if(
max
 < 
¥ec
)  0;

466 
i
=0; i<
¥ec
; i++) {

467 
ˇp
 *= 10;

469 
r
 *()
ˇp
;

470 
vÆue
 = ()
r
;

472 if((()((
r
 - ()
vÆue
)*10.0)) >= 5) {

473 
vÆue
++;

476 if(
vÆue
 >
ˇp
)

477 
vÆue
 = 
ˇp
-1;

479 
Àn
 = 
	`¥öt_dec_Œ
(
buf
, 
max
, 
vÆue
);

480 
Àn
 < 
¥ec
) {

481 
buf
[
Àn
++] = '0';

483 if(
Àn
 < 
max
)

484 
buf
[
Àn
++] = '.';

485  
Àn
;

486 
	}
}

490 
	$¥öt_Êﬂt
(* 
buf
, 
max
, 
vÆue
, 
¥ec
)

497 
whﬁe
 = ()
vÆue
;

498 
ªmaö
 = 
vÆue
 - ()
whﬁe
;

499 
Àn
 = 0;

500 if(
¥ec
 != 0)

501 
Àn
 = 
	`¥öt_ªmaödî
(
buf
, 
max
, 
ªmaö
, 
¥ec
);

502 
Àn
 +
	`¥öt_dec_Œ
(
buf
+Àn, 
max
-Àn, 
whﬁe
);

503  
Àn
;

504 
	}
}

508 
	$¥öt_num_f
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

509 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

510 
∂us
, 
•a˚
)

512 
buf
[
PRINT_FLOAT_BUFSZ
];

513 
√g©ive
 = (
vÆue
 < 0);

514 
zîo
 = 0;

515 
Àn
;

516 if(!
¥giví
Ë
¥ecisi⁄
 = 6;

517 
Àn
 = 
	`¥öt_Êﬂt
(
buf
, ()(buf), 
√g©ive
?-
vÆue
:value,

518 
¥ecisi⁄
);

519 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 1, 0, 
zî›ad
, 
möus
,

520 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

521 
	}
}

525 
	$¥öt_Êﬂt_g
(* 
buf
, 
max
, 
vÆue
, 
¥ec
)

527 
whﬁe
 = ()
vÆue
;

528 
ªmaö
 = 
vÆue
 - ()
whﬁe
;

529 
bef‹e
 = 0;

530 
Àn
 = 0;

533 
whﬁe
 > 0) {

534 
bef‹e
++;

535 
whﬁe
 /= 10;

537 
whﬁe
 = ()
vÆue
;

539 if(
¥ec
 > 
bef‹e
 && 
ªmaö
 != 0.0) {

541 
Àn
 = 
	`¥öt_ªmaödî
(
buf
, 
max
, 
ªmaö
, 
¥ec
-
bef‹e
);

542 
Àn
 > 0 && 
buf
[0]=='0') {

543 
	`memmove
(
buf
, buf+1, --
Àn
);

546 
Àn
 +
	`¥öt_dec_Œ
(
buf
+Àn, 
max
-Àn, 
whﬁe
);

547  
Àn
;

548 
	}
}

553 
	$¥öt_num_g
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
vÆue
,

554 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
,

555 
∂us
, 
•a˚
)

557 
buf
[
PRINT_FLOAT_BUFSZ
];

558 
√g©ive
 = (
vÆue
 < 0);

559 
zîo
 = 0;

560 
Àn
;

561 if(!
¥giví
Ë
¥ecisi⁄
 = 6;

562 if(
¥ecisi⁄
 == 0)Örecision = 1;

563 
Àn
 = 
	`¥öt_Êﬂt_g
(
buf
, ()(buf), 
√g©ive
?-
vÆue
:value,

564 
¥ecisi⁄
);

565 
	`¥öt_num
(
©
, 
À·
, 
ªt
, 
möw
, 1, 0, 
zî›ad
, 
möus
,

566 
∂us
, 
•a˚
, 
zîo
, 
√g©ive
, 
buf
, 
Àn
);

567 
	}
}

572 
	$my_°∫Àn
(c⁄° * 
s
, 
max
)

574 
i
;

575 
i
=0; i<
max
; i++)

576 if(
s
[
i
]==0)

577  
i
;

578  
max
;

579 
	}
}

583 
	$¥öt_°r
(** 
©
, 
size_t
* 
À·
, * 
ªt
, * 
s
,

584 
möw
, 
¥ecisi⁄
, 
¥giví
, 
möus
)

586 
w
;

588 if(
¥giví
)

589 
w
 = 
	`my_°∫Àn
(
s
, 
¥ecisi⁄
);

590 
w
 = ()
	`°æí
(
s
);

591 if(
w
 < 
möw
 && !
möus
)

592 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, ' ', 
möw
 - 
w
);

593 
	`•oﬁ_°r
(
©
, 
À·
, 
ªt
, 
s
, 
w
);

594 if(
w
 < 
möw
 && 
möus
)

595 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, ' ', 
möw
 - 
w
);

596 
	}
}

600 
	$¥öt_ch¨
(** 
©
, 
size_t
* 
À·
, * 
ªt
, 
c
,

601 
möw
, 
möus
)

603 if(1 < 
möw
 && !
möus
)

604 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, ' ', 
möw
 - 1);

605 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, 
c
, 1);

606 if(1 < 
möw
 && 
möus
)

607 
	`¥öt_∑d
(
©
, 
À·
, 
ªt
, ' ', 
möw
 - 1);

608 
	}
}

629 
	$v¢¥ötf
(* 
°r
, 
size_t
 
size
, c⁄° * 
f‹m©
, 
va_li°
 
¨g
)

631 * 
©
 = 
°r
;

632 
size_t
 
À·
 = 
size
;

633 
ªt
 = 0;

634 c⁄° * 
fmt
 = 
f‹m©
;

635 
c⁄v
, 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
, 
Àngth
;

636 *
fmt
) {

638 *
fmt
 && *fmt!='%') {

639 if(
À·
 > 1) {

640 *
©
++ = *
fmt
++;

641 
À·
--;

642 } 
fmt
++;

643 
ªt
++;

647 if(!*
fmt
) ;

650 
fmt
++;

682 
möw
 = 0;

683 
¥ecisi⁄
 = 1;

684 
¥giví
 = 0;

685 
zî›ad
 = 0;

686 
möus
 = 0;

687 
∂us
 = 0;

688 
•a˚
 = 0;

689 
Àngth
 = 0;

693 if(*
fmt
 == '0')

694 
zî›ad
 = 1;

695 if(*
fmt
 == '-')

696 
möus
 = 1;

697 if(*
fmt
 == '+')

698 
∂us
 = 1;

699 if(*
fmt
 == ' ')

700 
•a˚
 = 1;

702 
fmt
++;

706 if(*
fmt
 == '*') {

707 
fmt
++;

708 
möw
 = 
	`va_¨g
(
¨g
, );

709 if(
möw
 < 0) {

710 
möus
 = 1;

711 
möw
 = -minw;

713 } *
fmt
 >= '0' && *fmt <= '9') {

714 
möw
 = möw*10 + (*
fmt
++)-'0';

718 if(*
fmt
 == '.') {

719 
fmt
++;

720 
¥giví
 = 1;

721 
¥ecisi⁄
 = 0;

722 if(*
fmt
 == '*') {

723 
fmt
++;

724 
¥ecisi⁄
 = 
	`va_¨g
(
¨g
, );

725 if(
¥ecisi⁄
 < 0)

726 
¥ecisi⁄
 = 0;

727 } *
fmt
 >= '0' && *fmt <= '9') {

728 
¥ecisi⁄
 =Öªcisi⁄*10 + (*
fmt
++)-'0';

733 if(*
fmt
 == 'l') {

734 
fmt
++;

735 
Àngth
 = 1;

736 if(*
fmt
 == 'l') {

737 
fmt
++;

738 
Àngth
 = 2;

743 if(!*
fmt
Ë
c⁄v
 = 0;

744 
c⁄v
 = *
fmt
++;

749 
c⁄v
) {

752 if(
Àngth
 == 0)

753 
	`¥öt_num_d
(&
©
, &
À·
, &
ªt
, 
	`va_¨g
(
¨g
, ),

754 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

755 if(
Àngth
 == 1)

756 
	`¥öt_num_ld
(&
©
, &
À·
, &
ªt
, 
	`va_¨g
(
¨g
, ),

757 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

758 if(
Àngth
 == 2)

759 
	`¥öt_num_Œd
(&
©
, &
À·
, &
ªt
,

760 
	`va_¨g
(
¨g
, ),

761 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

764 if(
Àngth
 == 0)

765 
	`¥öt_num_u
(&
©
, &
À·
, &
ªt
,

766 
	`va_¨g
(
¨g
, ),

767 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

768 if(
Àngth
 == 1)

769 
	`¥öt_num_lu
(&
©
, &
À·
, &
ªt
,

770 
	`va_¨g
(
¨g
, ),

771 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

772 if(
Àngth
 == 2)

773 
	`¥öt_num_Œu
(&
©
, &
À·
, &
ªt
,

774 
	`va_¨g
(
¨g
, ),

775 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

778 if(
Àngth
 == 0)

779 
	`¥öt_num_x
(&
©
, &
À·
, &
ªt
,

780 
	`va_¨g
(
¨g
, ),

781 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

782 if(
Àngth
 == 1)

783 
	`¥öt_num_lx
(&
©
, &
À·
, &
ªt
,

784 
	`va_¨g
(
¨g
, ),

785 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

786 if(
Àngth
 == 2)

787 
	`¥öt_num_Œx
(&
©
, &
À·
, &
ªt
,

788 
	`va_¨g
(
¨g
, ),

789 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

792 
	`¥öt_°r
(&
©
, &
À·
, &
ªt
, 
	`va_¨g
(
¨g
, *),

793 
möw
, 
¥ecisi⁄
, 
¥giví
, 
möus
);

796 
	`¥öt_ch¨
(&
©
, &
À·
, &
ªt
, 
	`va_¨g
(
¨g
, ),

797 
möw
, 
möus
);

800 *
	`va_¨g
(
¨g
, *Ë
ªt
;

803 
	`¥öt_°r
(&
©
, &
À·
, &
ªt
, 
	`°ªº‹
(
î∫o
),

804 
möw
, 
¥ecisi⁄
, 
¥giví
, 
möus
);

807 
	`¥öt_num_Œp
(&
©
, &
À·
, &
ªt
, 
	`va_¨g
(
¨g
, *),

808 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

811 
	`¥öt_∑d
(&
©
, &
À·
, &
ªt
, '%', 1);

814 
	`¥öt_num_f
(&
©
, &
À·
, &
ªt
, 
	`va_¨g
(
¨g
, ),

815 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

818 
	`¥öt_num_g
(&
©
, &
À·
, &
ªt
, 
	`va_¨g
(
¨g
, ),

819 
möw
, 
¥ecisi⁄
, 
¥giví
, 
zî›ad
, 
möus
, 
∂us
, 
•a˚
);

828 if(
À·
 > 0)

829 *
©
 = 0;

830  
ªt
;

831 
	}
}

833 #ifde‡
SNPRINTF_TEST


836 #unde‡
¢¥ötf


837 
	#DOTEST
(
bufsz
, 
ªsu…
, 
ªtvÆ
, ...) do { \

838 
buf
[
bufsz
]; \

839 
	`¥ötf
("nowÅest %s\n", #__VA_ARGS__); \

840 
r
=
	`my_¢¥ötf
(
buf
, (buf), 
__VA_ARGS__
); \

841 if(
r
 !
ªtvÆ
 || 
	`°rcmp
(
buf
, 
ªsu…
) != 0) { \

842 
	`¥ötf
("errorÅest(%s) was \"%s\":%d\n", \

844 
buf
, 
r
); \

845 
	`exô
(1); \

847 
r
=
	`¢¥ötf
(
buf
, (buf), 
__VA_ARGS__
); \

848 if(
r
 !
ªtvÆ
 || 
	`°rcmp
(
buf
, 
ªsu…
) != 0) { \

849 
	`¥ötf
("errorÅest(%s) differs with system, \"%s\":%d\n", \

851 
buf
, 
r
); \

852 
	`exô
(1); \

854 
	`¥ötf
("ã°(\"%s\":%dË∑s£d\n", 
buf
, 
r
); \

855 } 0);

	)

858 
	$maö
()

860 
x
 = 0;

863 
	`DOTEST
(1024, "hello", 5, "hello");

864 
	`DOTEST
(1024, "h", 1, "h");

868 
	`DOTEST
(3, "he", 5, "hello");

869 
	`DOTEST
(1, "", 7, "%d", 7823089);

872 
	`DOTEST
(1024, "0", 1, "%d", 0);

873 
	`DOTEST
(1024, "1", 1, "%d", 1);

874 
	`DOTEST
(1024, "9", 1, "%d", 9);

875 
	`DOTEST
(1024, "15", 2, "%d", 15);

876 
	`DOTEST
(1024, "ab15cd", 6, "ab%dcd", 15);

877 
	`DOTEST
(1024, "167", 3, "%d", 167);

878 
	`DOTEST
(1024, "7823089", 7, "%d", 7823089);

879 
	`DOTEST
(1024, " 12", 3, "%3d", 12);

880 
	`DOTEST
(1024, "012", 3, "%.3d", 12);

881 
	`DOTEST
(1024, "012", 3, "%3.3d", 12);

882 
	`DOTEST
(1024, "012", 3, "%03d", 12);

883 
	`DOTEST
(1024, " 012", 4, "%4.3d", 12);

884 
	`DOTEST
(1024, "", 0, "%.0d", 0);

887 
	`DOTEST
(1024, "-1", 2, "%d", -1);

888 
	`DOTEST
(1024, "-12", 3, "%3d", -12);

889 
	`DOTEST
(1024, " -2", 3, "%3d", -2);

890 
	`DOTEST
(1024, "-012", 4, "%.3d", -12);

891 
	`DOTEST
(1024, "-012", 4, "%3.3d", -12);

892 
	`DOTEST
(1024, "-012", 4, "%4.3d", -12);

893 
	`DOTEST
(1024, " -012", 5, "%5.3d", -12);

894 
	`DOTEST
(1024, "-12", 3, "%03d", -12);

895 
	`DOTEST
(1024, "-02", 3, "%03d", -2);

896 
	`DOTEST
(1024, "-15", 3, "%d", -15);

897 
	`DOTEST
(1024, "-7307", 5, "%d", -7307);

898 
	`DOTEST
(1024, "-12 ", 5, "%-5d", -12);

899 
	`DOTEST
(1024, "-00012", 6, "%-.5d", -12);

902 
	`DOTEST
(1024, "+12", 3, "%+d", 12);

903 
	`DOTEST
(1024, " 12", 3, "% d", 12);

906 
	`DOTEST
(1024, "12", 2, "%u", 12);

907 
	`DOTEST
(1024, "0", 1, "%u", 0);

908 
	`DOTEST
(1024, "4294967295", 10, "%u", 0xffffffff);

911 
	`DOTEST
(1024, "0", 1, "%x", 0);

912 
	`DOTEST
(1024, "c", 1, "%x", 12);

913 
	`DOTEST
(1024, "12ab34cd", 8, "%x", 0x12ab34cd);

916 
	`DOTEST
(1024, "18446744073709551615", 20, "%llu",

918 
	`DOTEST
(1024, "-9223372036854775808", 20, "%lld",

920 
	`DOTEST
(1024, "9223372036854775808", 19, "%llu",

924 
	`DOTEST
(1024, "hello", 5, "%s", "hello");

925 
	`DOTEST
(1024, " hello", 10, "%10s", "hello");

926 
	`DOTEST
(1024, "hello ", 10, "%-10s", "hello");

927 
	`DOTEST
(1024, "he", 2, "%.2s", "hello");

928 
	`DOTEST
(1024, " he", 4, "%4.2s", "hello");

929 
	`DOTEST
(1024, " h", 4, "%4.2s", "h");

932 
	`DOTEST
(1024, "a", 1, "%c", 'a');

938 
	`DOTEST
(1024, "hñlo", 5, "hñlo%n", &
x
);

939 if(
x
 !5Ë{ 
	`¥ötf
("thê%%¿Áûed\n"); 
	`exô
(1); }

942 
î∫o
 = 0;

943 
	`DOTEST
(1024, "Success", 7, "%m");

946 
	`DOTEST
(1024, "0x10", 4, "%p", (*)0x10);

947 
	`DOTEST
(1024, "(nil)", 5, "%p", (*)0x0);

950 
	`DOTEST
(1024, "%", 1, "%%");

953 
	`DOTEST
(1024, "0.000000", 8, "%f", 0.0);

954 
	`DOTEST
(1024, "0.00", 4, "%.2f", 0.0);

956 
	`DOTEST
(1024, "234.00", 6, "%.2f", 234.005);

957 
	`DOTEST
(1024, "8973497.1246", 12, "%.4f", 8973497.12456);

958 
	`DOTEST
(1024, "-12.000000", 10, "%f", -12.0);

959 
	`DOTEST
(1024, "6", 1, "%.0f", 6.0);

961 
	`DOTEST
(1024, "6", 1, "%g", 6.0);

962 
	`DOTEST
(1024, "6.1", 3, "%g", 6.1);

963 
	`DOTEST
(1024, "6.15", 4, "%g", 6.15);

967 
	`DOTEST
(1024, "abcdef", 6, "%s", "abcdef");

968 
	`DOTEST
(1024, "005", 3, "%03u", 5);

969 
	`DOTEST
(1024, "12345", 5, "%03u", 12345);

970 
	`DOTEST
(1024, "5", 1, "%d", 5);

971 
	`DOTEST
(1024, "“û)", 5, "%p", 
NULL
);

972 
	`DOTEST
(1024, "12345", 5, "%ld", ()12345);

973 
	`DOTEST
(1024, "12345", 5, "%lu", ()12345);

974 
	`DOTEST
(1024, " 12345", 12, "%12u", ()12345);

975 
	`DOTEST
(1024, "12345", 5, "%u", ()12345);

976 
	`DOTEST
(1024, "12345", 5, "%llu", ()12345);

977 
	`DOTEST
(1024, "12345", 5, "%x", 0x12345);

978 
	`DOTEST
(1024, "12345", 5, "%llx", ()0x12345);

979 
	`DOTEST
(1024, "012345", 6, "%6.6d", 12345);

980 
	`DOTEST
(1024, "012345", 6, "%6.6u", 12345);

981 
	`DOTEST
(1024, "1234.54", 7, "%g", 1234.54);

982 
	`DOTEST
(1024, "123456789.54", 12, "%.12g", 123456789.54);

983 
	`DOTEST
(1024, "3456789123456.54", 16, "%.16g", 3456789123456.54);

986 
	`DOTEST
(1024, "12345", 5, "%3.3d", 12345);

987 
	`DOTEST
(1024, "000", 3, "%3.3d", 0);

988 
	`DOTEST
(1024, "001", 3, "%3.3d", 1);

989 
	`DOTEST
(1024, "012", 3, "%3.3d", 12);

990 
	`DOTEST
(1024, "-012", 4, "%3.3d", -12);

991 
	`DOTEST
(1024, "he", 2, "%.2s", "hello");

992 
	`DOTEST
(1024, "helloworld", 10, "%s%s", "hello", "world");

993 
	`DOTEST
(1024, "he", 2, "%.*s", 2, "hello");

994 
	`DOTEST
(1024, " hello", 7, "%*s", 7, "hello");

995 
	`DOTEST
(1024, "hello ", 7, "%*s", -7, "hello");

996 
	`DOTEST
(1024, "0", 1, "%c", '0');

997 
	`DOTEST
(1024, "A", 1, "%c", 'A');

998 
	`DOTEST
(1024, "", 1, "%c", 0);

999 
	`DOTEST
(1024, "\010", 1, "%c", 8);

1000 
	`DOTEST
(1024, "%", 1, "%%");

1001 
	`DOTEST
(1024, "0a", 2, "%02x", 0x0a);

1002 
	`DOTEST
(1024, "bd", 2, "%02x", 0xbd);

1003 
	`DOTEST
(1024, "12", 2, "%02ld", ()12);

1004 
	`DOTEST
(1024, "02", 2, "%02ld", ()2);

1005 
	`DOTEST
(1024, "02", 2, "%02u", ()2);

1006 
	`DOTEST
(1024, "765432", 6, "%05u", ()765432);

1007 
	`DOTEST
(1024, "10.234", 6, "%0.3f", 10.23421);

1008 
	`DOTEST
(1024, "123456.234", 10, "%0.3f", 123456.23421);

1009 
	`DOTEST
(1024, "123456789.234", 13, "%0.3f", 123456789.23421);

1010 
	`DOTEST
(1024, "123456.23", 9, "%.2f", 123456.23421);

1011 
	`DOTEST
(1024, "123456", 6, "%.0f", 123456.23421);

1012 
	`DOTEST
(1024, "0123", 4, "%.4x", 0x0123);

1013 
	`DOTEST
(1024, "00000123", 8, "%.8x", 0x0123);

1014 
	`DOTEST
(1024, "ffeb0cde", 8, "%.8x", 0xffeb0cde);

1015 
	`DOTEST
(1024, " 987654321", 10, "%10lu", ()987654321);

1016 
	`DOTEST
(1024, " 987654321", 12, "%12lu", ()987654321);

1017 
	`DOTEST
(1024, "987654321", 9, "%i", 987654321);

1018 
	`DOTEST
(1024, "-87654321", 9, "%i", -87654321);

1019 
	`DOTEST
(1024, "hello ", 16, "%-16s", "hello");

1020 
	`DOTEST
(1024, " ", 16, "%-16s", "");

1021 
	`DOTEST
(1024, "a ", 16, "%-16s", "a");

1022 
	`DOTEST
(1024, "foobarfoobar ", 16, "%-16s", "foobarfoobar");

1023 
	`DOTEST
(1024, "foobarfoobarfoobar", 18, "%-16s", "foobarfoobarfoobar");

1026 
	`DOTEST
(1024, "foo 1.0 size 512Édns", 21,

1028 
	`DOTEST
(15, "foo 1.0 size 5", 21,

1030 
	`DOTEST
(1024, "packet 1203ceff id", 18,

1032 
	`DOTEST
(1024, "/tmp/testbound_123abcd.tmp", 26, "/tmp/testbound_%u%s%s.tmp", 123, "ab", "cd");

1035 
	}
}

	@compat/strlcpy.c

20 
	~<ldns/c⁄fig.h
>

21 #i‚de‡
HAVE_STRLCPY


23 
	~<sys/ty≥s.h
>

24 
	~<°rög.h
>

31 
size_t


32 
	$°æ˝y
(*
d°
, c⁄° *
§c
, 
size_t
 
siz
)

34 *
d
 = 
d°
;

35 c⁄° *
s
 = 
§c
;

36 
size_t
 
n
 = 
siz
;

39 i‡(
n
 != 0 && --n != 0) {

41 i‡((*
d
++ = *
s
++) == 0)

43 } --
n
 != 0);

47 i‡(
n
 == 0) {

48 i‡(
siz
 != 0)

49 *
d
 = '\0';

50 *
s
++)

54 (
s
 - 
§c
 - 1);

55 
	}
}

	@compat/timegm.c

1 #ifde‡
HAVE_CONFIG_H


2 
	~<ldns/c⁄fig.h
>

5 
	~<°dio.h
>

7 #ifde‡
HAVE_STDLIB_H


8 
	~<°dlib.h
>

11 
	~<time.h
>

13 
time_t


14 
	$timegm
 (
tm
 *tm) {

15 
time_t
 
ªt
;

16 *
tz
;

18 
tz
 = 
	`gëív
("TZ");

19 
	`puãnv
((*)"TZ=");

20 
	`tz£t
();

21 
ªt
 = 
	`mktime
(
tm
);

22 i‡(
tz
) {

23 
buf
[256];

24 
	`¢¥ötf
(
buf
, (buf), "TZ=%s", 
tz
);

25 
	`puãnv
(
tz
);

28 
	`puãnv
((*)"TZ");

29 
	`tz£t
();

30  
ªt
;

31 
	}
}

	@config.h

8 
	#HAVE_ARPA_INET_H
 1

	)

11 
	#HAVE_ATTR_FORMAT
 1

	)

14 
	#HAVE_ATTR_UNUSED
 1

	)

29 
	#HAVE_BZERO
 1

	)

32 
	#HAVE_CALLOC
 1

	)

35 
	#HAVE_CTIME_R
 1

	)

38 
	#HAVE_DANE_CA_FILE
 0

	)

41 
	#HAVE_DANE_CA_PATH
 0

	)

45 
	#HAVE_DECL_NID_SECP384R1
 1

	)

49 
	#HAVE_DECL_NID_X9_62_PRIME256V1
 1

	)

52 
	#HAVE_DLFCN_H
 1

	)

55 
	#HAVE_ENDPROTOENT
 1

	)

58 
	#HAVE_ENDSERVENT
 1

	)

61 
	#HAVE_EVP_SHA256
 1

	)

64 
	#HAVE_FCNTL
 1

	)

67 
	#HAVE_FORK
 1

	)

70 
	#HAVE_GETADDRINFO
 1

	)

73 
	#HAVE_GETOPT_H
 1

	)

76 
	#HAVE_GMTIME_R
 1

	)

79 
	#HAVE_HMAC_CTX_INIT
 1

	)

82 
	#HAVE_INET_ATON
 1

	)

85 
	#HAVE_INET_NTOP
 1

	)

88 
	#HAVE_INET_PTON
 1

	)

91 
	#HAVE_INTTYPES_H
 1

	)

97 
	#HAVE_ISASCII
 1

	)

100 
	#HAVE_ISBLANK
 1

	)

103 
	#HAVE_LIBPCAP
 1

	)

106 
	#HAVE_LOCALTIME_R
 1

	)

110 
	#HAVE_MALLOC
 1

	)

113 
	#HAVE_MEMMOVE
 1

	)

116 
	#HAVE_MEMORY_H
 1

	)

119 
	#HAVE_MEMSET
 1

	)

122 
	#HAVE_NETDB_H
 1

	)

125 
	#HAVE_NETINET_IF_ETHER_H
 1

	)

128 
	#HAVE_NETINET_IGMP_H
 1

	)

131 
	#HAVE_NETINET_IN_H
 1

	)

134 
	#HAVE_NETINET_IN_SYSTM_H
 1

	)

137 
	#HAVE_NETINET_IP6_H
 1

	)

143 
	#HAVE_NETINET_IP_H
 1

	)

146 
	#HAVE_NETINET_UDP_H
 1

	)

149 
	#HAVE_NET_ETHERNET_H
 1

	)

152 
	#HAVE_NET_IF_H
 1

	)

155 
	#HAVE_OPENSSL_ERR_H
 1

	)

158 
	#HAVE_OPENSSL_RAND_H
 1

	)

161 
	#HAVE_OPENSSL_SSL_H
 1

	)

164 
	#HAVE_PCAP_H
 1

	)

170 
	#HAVE_RANDOM
 1

	)

174 
	#HAVE_REALLOC
 1

	)

177 
	#HAVE_SLEEP
 1

	)

180 
	#HAVE_SNPRINTF
 1

	)

183 
	#HAVE_SSL


	)

186 
	#HAVE_STDARG_H
 1

	)

189 
	#HAVE_STDBOOL_H
 1

	)

192 
	#HAVE_STDINT_H
 1

	)

195 
	#HAVE_STDLIB_H
 1

	)

198 
	#HAVE_STRINGS_H
 1

	)

201 
	#HAVE_STRING_H
 1

	)

204 
	#HAVE_STRLCPY
 1

	)

207 
	#HAVE_STRTOUL
 1

	)

213 
	#HAVE_SYS_MOUNT_H
 1

	)

216 
	#HAVE_SYS_PARAM_H
 1

	)

219 
	#HAVE_SYS_SOCKET_H
 1

	)

222 
	#HAVE_SYS_STAT_H
 1

	)

225 
	#HAVE_SYS_TYPES_H
 1

	)

228 
	#HAVE_TIMEGM
 1

	)

231 
	#HAVE_TIME_H
 1

	)

234 
	#HAVE_UNISTD_H
 1

	)

237 
	#HAVE_VFORK
 1

	)

246 
	#HAVE_WORKING_FORK
 1

	)

249 
	#HAVE_WORKING_VFORK
 1

	)

255 
	#HAVE__BOOL
 1

	)

264 
	#LDNS_TRUST_ANCHOR_FILE
 "/ëc/unbound/roŸ.key"

	)

268 
	#LT_OBJDIR
 ".libs/"

	)

271 
	#PACKAGE_BUGREPORT
 "libdns@∆√éabs.∆"

	)

274 
	#PACKAGE_NAME
 "ldns"

	)

277 
	#PACKAGE_STRING
 "ldn†1.6.17"

	)

280 
	#PACKAGE_TARNAME
 "libdns"

	)

283 
	#PACKAGE_URL
 ""

	)

286 
	#PACKAGE_VERSION
 "1.6.17"

	)

304 
	#SIZEOF_TIME_T
 8

	)

307 
	#STDC_HEADERS
 1

	)

313 
	#SYSCONFDIR
 
sysc⁄fdú


	)

316 
	#USE_DANE
 1

	)

319 
	#USE_ECDSA
 1

	)

322 
	#USE_GOST
 1

	)

325 
	#USE_SHA2
 1

	)

328 #i‚de‡
_ALL_SOURCE


329 
	#_ALL_SOURCE
 1

	)

332 #i‚de‡
_GNU_SOURCE


333 
	#_GNU_SOURCE
 1

	)

336 #i‚de‡
_POSIX_PTHREAD_SEMANTICS


337 
	#_POSIX_PTHREAD_SEMANTICS
 1

	)

340 #i‚de‡
_TANDEM_SOURCE


341 
	#_TANDEM_SOURCE
 1

	)

344 #i‚de‡
__EXTENSIONS__


345 
	#__EXTENSIONS__
 1

	)

353 
	#WINVER
 0x0502

	)

357 #i‡
deföed
 
AC_APPLE_UNIVERSAL_BUILD


358 #i‡
deföed
 
__BIG_ENDIAN__


359 
	#WORDS_BIGENDIAN
 1

	)

362 #i‚de‡
WORDS_BIGENDIAN


388 #i‚de‡
__˝lu•lus


444 
	~<°dio.h
>

445 
	~<°rög.h
>

446 
	~<uni°d.h
>

447 
	~<as£π.h
>

449 #i‚de‡
LITTLE_ENDIAN


450 
	#LITTLE_ENDIAN
 1234

	)

453 #i‚de‡
BIG_ENDIAN


454 
	#BIG_ENDIAN
 4321

	)

457 #i‚de‡
BYTE_ORDER


458 #ifde‡
WORDS_BIGENDIAN


459 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

461 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

465 #i‡
STDC_HEADERS


466 
	~<°dlib.h
>

467 
	~<°ddef.h
>

470 #ifde‡
HAVE_STDINT_H


471 
	~<°döt.h
>

474 #ifde‡
HAVE_SYS_SOCKET_H


475 
	~<sys/sockë.h
>

478 #ifde‡
HAVE_NETINET_IN_H


479 
	~<√töë/ö.h
>

482 #ifde‡
HAVE_ARPA_INET_H


483 
	~<¨∑/öë.h
>

486 #ifde‡
HAVE_WINSOCK2_H


487 
	~<wösock2.h
>

490 #ifde‡
HAVE_WS2TCPIP_H


491 
	~<ws2t˝ù.h
>

496 #ifde‡
HAVE_WINSOCK2_H


497 
	#FD_SET_T
 (
u_öt
)

	)

499 
	#FD_SET_T


	)

505 #ifde‡
__˝lu•lus


509 
ldns_b64_¡›
(
uöt8_t
 c⁄° *
§c
, 
size_t
 
§˛ígth
,

510 *
èrgë
, 
size_t
 
èrgsize
);

515 
ölöe
 
size_t
 
ldns_b64_¡›_ˇlcuœã_size
(size_à
§csize
)

517  ((((
§csize
 + 2) / 3) * 4) + 1);

519 
ldns_b64_±⁄
(c⁄° *
§c
, 
uöt8_t
 *
èrgë
, 
size_t
 
èrgsize
);

524 
ölöe
 
size_t
 
ldns_b64_±⁄_ˇlcuœã_size
(size_à
§csize
)

526  (((((
§csize
 + 3) / 4) * 3)) + 1);

533 
ldns_d«me_com∑ª_v
(c⁄° *
a
, c⁄° *
b
);

535 #i‚de‡
HAVE_SLEEP


537 
	#¶ìp
(
x
Ë
	`SÀï
((x)*1000)

	)

540 #i‚de‡
HAVE_RANDOM


541 
	#§™dom
(
x
Ë
	`§™d
(x)

	)

542 
	#øndom
(
x
Ë
	`ønd
(x)

	)

545 #i‚de‡
HAVE_TIMEGM


546 
	~<time.h
>

547 
time_t
 
timegm
 (
tm
 *tm);

549 #i‚de‡
HAVE_GMTIME_R


550 
tm
 *
gmtime_r
(c⁄° 
time_t
 *
timï
, tm *
ªsu…
);

552 #i‚de‡
HAVE_LOCALTIME_R


553 
tm
 *
loˇ…ime_r
(c⁄° 
time_t
 *
timï
, tm *
ªsu…
);

555 #i‚de‡
HAVE_ISBLANK


556 
isbœnk
(
c
);

558 #i‚de‡
HAVE_ISASCII


559 
ißscii
(
c
);

561 #i‚de‡
HAVE_SNPRINTF


562 
	~<°d¨g.h
>

563 
¢¥ötf
 (*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, ...);

564 
v¢¥ötf
 (*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, 
va_li°
 
¨g
);

566 #i‚de‡
HAVE_INET_PTON


567 
öë_±⁄
(
af
, c⁄° * 
§c
, * 
d°
);

569 #i‚de‡
HAVE_INET_NTOP


570 c⁄° *
öë_¡›
(
af
, c⁄° *
§c
, *
d°
, 
size_t
 
size
);

572 #i‚de‡
HAVE_INET_ATON


573 
öë_©⁄
(c⁄° *
˝
, 
ö_addr
 *
addr
);

575 #i‚de‡
HAVE_MEMMOVE


576 *
memmove
(*
de°
, c⁄° *
§c
, 
size_t
 
n
);

578 #i‚de‡
HAVE_STRLCPY


579 
size_t
 
°æ˝y
(*
d°
, c⁄° *
§c
, size_à
siz
);

581 #ifde‡
__˝lu•lus


584 #i‚de‡
HAVE_GETADDRINFO


585 
	~"com∑t/Áke-rfc2553.h
"

587 #i‚de‡
HAVE_STRTOUL


588 
	#°πoul
 ()
°πﬁ


	)

	@contrib/DNS-LDNS/ppport.h

3167 #i‚de‡
_P_P_PORTABILITY_H_


3168 
	#_P_P_PORTABILITY_H_


	)

3170 #i‚de‡
DPPP_NAMESPACE


3171 
	#DPPP_NAMESPACE
 
DPPP_


	)

3174 
	#DPPP_CAT2
(
x
,
y
Ë
	`CAT2
(x,y)

	)

3175 
	#DPPP_
(
«me
Ë
	`DPPP_CAT2
(
DPPP_NAMESPACE
,Çame)

	)

3177 #i‚de‡
PERL_REVISION


3178 #i‡!
deföed
(
__PATCHLEVEL_H_INCLUDED__
Ë&& !(deföed(
PATCHLEVEL
Ë&& deföed(
SUBVERSION
))

3179 
	#PERL_PATCHLEVEL_H_IMPLICIT


	)

3180 
	~<∑tchÀvñ.h
>

3182 #i‡!(
deföed
(
PERL_VERSION
Ë|| (deföed(
SUBVERSION
Ë&& deföed(
PATCHLEVEL
)))

3183 
	~<could_nŸ_föd_Pîl_∑tchÀvñ.h
>

3185 #i‚de‡
PERL_REVISION


3186 
	#PERL_REVISION
 (5)

	)

3188 
	#PERL_VERSION
 
PATCHLEVEL


	)

3189 
	#PERL_SUBVERSION
 
SUBVERSION


	)

3195 
	#_dµpDEC2BCD
(
dec
Ë((((dec)/100)<<8)|((((dec)%100)/10)<<4)|((dec)%10))

	)

3196 
	#PERL_BCDVERSION
 ((
	`_dµpDEC2BCD
(
PERL_REVISION
)<<24)|(_dµpDEC2BCD(
PERL_VERSION
)<<12)|_dµpDEC2BCD(
PERL_SUBVERSION
))

	)

3201 #i‡
PERL_REVISION
 != 5

3202 #îr‹ 
µp‹t
.
h
 
⁄ly
 
w‹ks
 
wôh
 
Pîl
 
vîsi⁄
 5

3204 #i‚de‡
dTHR


3205 
	#dTHR
 
dNOOP


	)

3207 #i‚de‡
dTHX


3208 
	#dTHX
 
dNOOP


	)

3211 #i‚de‡
dTHXa


3212 
	#dTHXa
(
x
Ë
dNOOP


	)

3214 #i‚de‡
pTHX


3215 
	#pTHX
 

	)

3218 #i‚de‡
pTHX_


3219 
	#pTHX_


	)

3222 #i‚de‡
aTHX


3223 
	#aTHX


	)

3226 #i‚de‡
aTHX_


3227 
	#aTHX_


	)

3230 #i‡(
PERL_BCDVERSION
 < 0x5006000)

3231 #ifde‡
USE_THREADS


3232 
	#aTHXR
 
thr


	)

3233 
	#aTHXR_
 
thr
,

	)

3235 
	#aTHXR


	)

3236 
	#aTHXR_


	)

3238 
	#dTHXR
 
dTHR


	)

3240 
	#aTHXR
 
aTHX


	)

3241 
	#aTHXR_
 
aTHX_


	)

3242 
	#dTHXR
 
dTHX


	)

3244 #i‚de‡
dTHXﬂ


3245 
	#dTHXﬂ
(
x
Ë
	`dTHXa
(x)

	)

3248 #ifde‡
I_LIMITS


3249 
	~<limôs.h
>

3252 #i‚de‡
PERL_UCHAR_MIN


3253 
	#PERL_UCHAR_MIN
 (()0)

	)

3256 #i‚de‡
PERL_UCHAR_MAX


3257 #ifde‡
UCHAR_MAX


3258 
	#PERL_UCHAR_MAX
 (()
UCHAR_MAX
)

	)

3260 #ifde‡
MAXUCHAR


3261 
	#PERL_UCHAR_MAX
 (()
MAXUCHAR
)

	)

3263 
	#PERL_UCHAR_MAX
 (()~()0)

	)

3268 #i‚de‡
PERL_USHORT_MIN


3269 
	#PERL_USHORT_MIN
 (()0)

	)

3272 #i‚de‡
PERL_USHORT_MAX


3273 #ifde‡
USHORT_MAX


3274 
	#PERL_USHORT_MAX
 (()
USHORT_MAX
)

	)

3276 #ifde‡
MAXUSHORT


3277 
	#PERL_USHORT_MAX
 (()
MAXUSHORT
)

	)

3279 #ifde‡
USHRT_MAX


3280 
	#PERL_USHORT_MAX
 (()
USHRT_MAX
)

	)

3282 
	#PERL_USHORT_MAX
 (()~()0)

	)

3288 #i‚de‡
PERL_SHORT_MAX


3289 #ifde‡
SHORT_MAX


3290 
	#PERL_SHORT_MAX
 (()
SHORT_MAX
)

	)

3292 #ifde‡
MAXSHORT


3293 
	#PERL_SHORT_MAX
 (()
MAXSHORT
)

	)

3295 #ifde‡
SHRT_MAX


3296 
	#PERL_SHORT_MAX
 (()
SHRT_MAX
)

	)

3298 
	#PERL_SHORT_MAX
 ((Ë(
PERL_USHORT_MAX
 >> 1))

	)

3304 #i‚de‡
PERL_SHORT_MIN


3305 #ifde‡
SHORT_MIN


3306 
	#PERL_SHORT_MIN
 (()
SHORT_MIN
)

	)

3308 #ifde‡
MINSHORT


3309 
	#PERL_SHORT_MIN
 (()
MINSHORT
)

	)

3311 #ifde‡
SHRT_MIN


3312 
	#PERL_SHORT_MIN
 (()
SHRT_MIN
)

	)

3314 
	#PERL_SHORT_MIN
 (-
PERL_SHORT_MAX
 - ((3 & -1Ë=3))

	)

3320 #i‚de‡
PERL_UINT_MAX


3321 #ifde‡
UINT_MAX


3322 
	#PERL_UINT_MAX
 (()
UINT_MAX
)

	)

3324 #ifde‡
MAXUINT


3325 
	#PERL_UINT_MAX
 (()
MAXUINT
)

	)

3327 
	#PERL_UINT_MAX
 (~()0)

	)

3332 #i‚de‡
PERL_UINT_MIN


3333 
	#PERL_UINT_MIN
 (()0)

	)

3336 #i‚de‡
PERL_INT_MAX


3337 #ifde‡
INT_MAX


3338 
	#PERL_INT_MAX
 (()
INT_MAX
)

	)

3340 #ifde‡
MAXINT


3341 
	#PERL_INT_MAX
 (()
MAXINT
)

	)

3343 
	#PERL_INT_MAX
 (()(
PERL_UINT_MAX
 >> 1))

	)

3348 #i‚de‡
PERL_INT_MIN


3349 #ifde‡
INT_MIN


3350 
	#PERL_INT_MIN
 (()
INT_MIN
)

	)

3352 #ifde‡
MININT


3353 
	#PERL_INT_MIN
 (()
MININT
)

	)

3355 
	#PERL_INT_MIN
 (-
PERL_INT_MAX
 - ((3 & -1Ë=3))

	)

3360 #i‚de‡
PERL_ULONG_MAX


3361 #ifde‡
ULONG_MAX


3362 
	#PERL_ULONG_MAX
 (()
ULONG_MAX
)

	)

3364 #ifde‡
MAXULONG


3365 
	#PERL_ULONG_MAX
 (()
MAXULONG
)

	)

3367 
	#PERL_ULONG_MAX
 (~()0)

	)

3372 #i‚de‡
PERL_ULONG_MIN


3373 
	#PERL_ULONG_MIN
 (()0L)

	)

3376 #i‚de‡
PERL_LONG_MAX


3377 #ifde‡
LONG_MAX


3378 
	#PERL_LONG_MAX
 (()
LONG_MAX
)

	)

3380 #ifde‡
MAXLONG


3381 
	#PERL_LONG_MAX
 (()
MAXLONG
)

	)

3383 
	#PERL_LONG_MAX
 ((Ë(
PERL_ULONG_MAX
 >> 1))

	)

3388 #i‚de‡
PERL_LONG_MIN


3389 #ifde‡
LONG_MIN


3390 
	#PERL_LONG_MIN
 (()
LONG_MIN
)

	)

3392 #ifde‡
MINLONG


3393 
	#PERL_LONG_MIN
 (()
MINLONG
)

	)

3395 
	#PERL_LONG_MIN
 (-
PERL_LONG_MAX
 - ((3 & -1Ë=3))

	)

3400 #i‡
deföed
(
HAS_QUAD
Ë&& (deföed(
c⁄vex
Ë|| deföed(
uts
))

3401 #i‚de‡
PERL_UQUAD_MAX


3402 #ifde‡
ULONGLONG_MAX


3403 
	#PERL_UQUAD_MAX
 (()
ULONGLONG_MAX
)

	)

3405 #ifde‡
MAXULONGLONG


3406 
	#PERL_UQUAD_MAX
 (()
MAXULONGLONG
)

	)

3408 
	#PERL_UQUAD_MAX
 (~()0)

	)

3413 #i‚de‡
PERL_UQUAD_MIN


3414 
	#PERL_UQUAD_MIN
 (()0L)

	)

3417 #i‚de‡
PERL_QUAD_MAX


3418 #ifde‡
LONGLONG_MAX


3419 
	#PERL_QUAD_MAX
 (()
LONGLONG_MAX
)

	)

3421 #ifde‡
MAXLONGLONG


3422 
	#PERL_QUAD_MAX
 (()
MAXLONGLONG
)

	)

3424 
	#PERL_QUAD_MAX
 ((Ë(
PERL_UQUAD_MAX
 >> 1))

	)

3429 #i‚de‡
PERL_QUAD_MIN


3430 #ifde‡
LONGLONG_MIN


3431 
	#PERL_QUAD_MIN
 (()
LONGLONG_MIN
)

	)

3433 #ifde‡
MINLONGLONG


3434 
	#PERL_QUAD_MIN
 (()
MINLONGLONG
)

	)

3436 
	#PERL_QUAD_MIN
 (-
PERL_QUAD_MAX
 - ((3 & -1Ë=3))

	)

3443 #ifde‡
HAS_QUAD


3444 #ifde‡
¸ay


3445 #i‚de‡
IVTYPE


3446 
	#IVTYPE
 

	)

3449 #i‚de‡
IV_MIN


3450 
	#IV_MIN
 
PERL_INT_MIN


	)

3453 #i‚de‡
IV_MAX


3454 
	#IV_MAX
 
PERL_INT_MAX


	)

3457 #i‚de‡
UV_MIN


3458 
	#UV_MIN
 
PERL_UINT_MIN


	)

3461 #i‚de‡
UV_MAX


3462 
	#UV_MAX
 
PERL_UINT_MAX


	)

3465 #ifde‡
INTSIZE


3466 #i‚de‡
IVSIZE


3467 
	#IVSIZE
 
INTSIZE


	)

3472 #i‡
deföed
(
c⁄vex
Ë|| deföed(
uts
)

3473 #i‚de‡
IVTYPE


3474 
	#IVTYPE
 

	)

3477 #i‚de‡
IV_MIN


3478 
	#IV_MIN
 
PERL_QUAD_MIN


	)

3481 #i‚de‡
IV_MAX


3482 
	#IV_MAX
 
PERL_QUAD_MAX


	)

3485 #i‚de‡
UV_MIN


3486 
	#UV_MIN
 
PERL_UQUAD_MIN


	)

3489 #i‚de‡
UV_MAX


3490 
	#UV_MAX
 
PERL_UQUAD_MAX


	)

3493 #ifde‡
LONGLONGSIZE


3494 #i‚de‡
IVSIZE


3495 
	#IVSIZE
 
LONGLONGSIZE


	)

3500 #i‚de‡
IVTYPE


3501 
	#IVTYPE
 

	)

3504 #i‚de‡
IV_MIN


3505 
	#IV_MIN
 
PERL_LONG_MIN


	)

3508 #i‚de‡
IV_MAX


3509 
	#IV_MAX
 
PERL_LONG_MAX


	)

3512 #i‚de‡
UV_MIN


3513 
	#UV_MIN
 
PERL_ULONG_MIN


	)

3516 #i‚de‡
UV_MAX


3517 
	#UV_MAX
 
PERL_ULONG_MAX


	)

3520 #ifde‡
LONGSIZE


3521 #i‚de‡
IVSIZE


3522 
	#IVSIZE
 
LONGSIZE


	)

3528 #i‚de‡
IVSIZE


3529 
	#IVSIZE
 8

	)

3532 #i‚de‡
PERL_QUAD_MIN


3533 
	#PERL_QUAD_MIN
 
IV_MIN


	)

3536 #i‚de‡
PERL_QUAD_MAX


3537 
	#PERL_QUAD_MAX
 
IV_MAX


	)

3540 #i‚de‡
PERL_UQUAD_MIN


3541 
	#PERL_UQUAD_MIN
 
UV_MIN


	)

3544 #i‚de‡
PERL_UQUAD_MAX


3545 
	#PERL_UQUAD_MAX
 
UV_MAX


	)

3549 #i‚de‡
IVTYPE


3550 
	#IVTYPE
 

	)

3553 #i‚de‡
IV_MIN


3554 
	#IV_MIN
 
PERL_LONG_MIN


	)

3557 #i‚de‡
IV_MAX


3558 
	#IV_MAX
 
PERL_LONG_MAX


	)

3561 #i‚de‡
UV_MIN


3562 
	#UV_MIN
 
PERL_ULONG_MIN


	)

3565 #i‚de‡
UV_MAX


3566 
	#UV_MAX
 
PERL_ULONG_MAX


	)

3571 #i‚de‡
IVSIZE


3572 #ifde‡
LONGSIZE


3573 
	#IVSIZE
 
LONGSIZE


	)

3575 
	#IVSIZE
 4

	)

3578 #i‚de‡
UVTYPE


3579 
	#UVTYPE
 
IVTYPE


	)

3582 #i‚de‡
UVSIZE


3583 
	#UVSIZE
 
IVSIZE


	)

3585 #i‚de‡
sv_£tuv


3586 
	#sv_£tuv
(
sv
, 
uv
) \

3587 
STMT_START
 { \

3588 
UV
 
TeMpUv
 = 
uv
; \

3589 i‡(
TeMpUv
 <
IV_MAX
) \

3590 
	`sv_£tiv
(
sv
, 
TeMpUv
); \

3592 
	`sv_£äv
(
sv
, ()
TeMpUv
); \

3593 } 
STMT_END


	)

3595 #i‚de‡
√wSVuv


3596 
	#√wSVuv
(
uv
Ë((uvË<
IV_MAX
 ? 
	`√wSViv
((
IV
)uvË: 
	`√wSVnv
((
NV
)uv))

	)

3598 #i‚de‡
sv_2uv


3599 
	#sv_2uv
(
sv
Ë((
PL_Sv
 = (sv)), (
UV
Ë(
	`SvNOK
(PL_SvË? 
	`SvNV
(PL_SvË: 
	`sv_2nv
(PL_Sv)))

	)

3602 #i‚de‡
SvUVX


3603 
	#SvUVX
(
sv
Ë((
UV
)
	`SvIVX
(sv))

	)

3606 #i‚de‡
SvUVXx


3607 
	#SvUVXx
(
sv
Ë
	`SvUVX
(sv)

	)

3610 #i‚de‡
SvUV


3611 
	#SvUV
(
sv
Ë(
	`SvIOK
(svË? 
	`SvUVX
(svË: 
	`sv_2uv
(sv))

	)

3614 #i‚de‡
SvUVx


3615 
	#SvUVx
(
sv
Ë((
PL_Sv
 = (sv)), 
	`SvUV
(PL_Sv))

	)

3621 #i‚de‡
sv_uv


3622 
	#sv_uv
(
sv
Ë
	`SvUVx
(sv)

	)

3625 #i‡!
deföed
(
SvUOK
Ë&& deföed(
SvIOK_UV
)

3626 
	#SvUOK
(
sv
Ë
	`SvIOK_UV
(sv)

	)

3628 #i‚de‡
XST_mUV


3629 
	#XST_mUV
(
i
,
v
Ë(
	`ST
(iË
	`sv_2m‹èl
(
	`√wSVuv
(v)Ë)

	)

3632 #i‚de‡
XSRETURN_UV


3633 
	#XSRETURN_UV
(
v
Ë
STMT_START
 { 
	`XST_mUV
(0,v); 
	`XSRETURN
(1); } 
STMT_END


	)

3635 #i‚de‡
PUSHu


3636 
	#PUSHu
(
u
Ë
STMT_START
 { 
	`sv_£tuv
(
TARG
, (
UV
)(u)); 
PUSHTARG
; } 
STMT_END


	)

3639 #i‚de‡
XPUSHu


3640 
	#XPUSHu
(
u
Ë
STMT_START
 { 
	`sv_£tuv
(
TARG
, (
UV
)(u)); 
XPUSHTARG
; } 
STMT_END


	)

3643 #ifde‡
HAS_MEMCMP


3644 #i‚de‡
memNE


3645 
	#memNE
(
s1
,
s2
,
l
Ë(
	`memcmp
(s1,s2,l))

	)

3648 #i‚de‡
memEQ


3649 
	#memEQ
(
s1
,
s2
,
l
Ë(!
	`memcmp
(s1,s2,l))

	)

3653 #i‚de‡
memNE


3654 
	#memNE
(
s1
,
s2
,
l
Ë(
	`bcmp
(s1,s2,l))

	)

3657 #i‚de‡
memEQ


3658 
	#memEQ
(
s1
,
s2
,
l
Ë(!
	`bcmp
(s1,s2,l))

	)

3662 #i‚de‡
MoveD


3663 
	#MoveD
(
s
,
d
,
n
,
t
Ë
	`memmove
((*)(d),(*)(s), (nË* —))

	)

3666 #i‚de‡
C›yD


3667 
	#C›yD
(
s
,
d
,
n
,
t
Ë
	`mem˝y
((*)(d),(*)(s), (nË* —))

	)

3670 #ifde‡
HAS_MEMSET


3671 #i‚de‡
ZîoD


3672 
	#ZîoD
(
d
,
n
,
t
Ë
	`memzîo
((*)(d), (nË* —))

	)

3676 #i‚de‡
ZîoD


3677 
	#ZîoD
(
d
,
n
,
t
Ë(()
	`memzîo
((*)(d), (nË* —)), d)

	)

3681 #i‚de‡
Pois⁄Wôh


3682 
	#Pois⁄Wôh
(
d
,
n
,
t
,
b
Ë()
	`mem£t
((*)(d), (
U8
)(b), (nË* —))

	)

3685 #i‚de‡
Pois⁄New


3686 
	#Pois⁄New
(
d
,
n
,
t
Ë
	`Pois⁄Wôh
(d,n,t,0xAB)

	)

3689 #i‚de‡
Pois⁄Fªe


3690 
	#Pois⁄Fªe
(
d
,
n
,
t
Ë
	`Pois⁄Wôh
(d,n,t,0xEF)

	)

3693 #i‚de‡
Pois⁄


3694 
	#Pois⁄
(
d
,
n
,
t
Ë
	`Pois⁄Fªe
(d,n,t)

	)

3696 #i‚de‡
Newx


3697 
	#Newx
(
v
,
n
,
t
Ë
	`New
(0,v,n,t)

	)

3700 #i‚de‡
Newxc


3701 
	#Newxc
(
v
,
n
,
t
,
c
Ë
	`Newc
(0,v,n,t,c)

	)

3704 #i‚de‡
Newxz


3705 
	#Newxz
(
v
,
n
,
t
Ë
	`Newz
(0,v,n,t)

	)

3708 #i‚de‡
PERL_UNUSED_DECL


3709 #ifde‡
HASATTRIBUTE


3710 #i‡(
deföed
(
__GNUC__
Ë&& deföed(
__˝lu•lus
)Ë|| deföed(
__INTEL_COMPILER
)

3711 
	#PERL_UNUSED_DECL


	)

3713 
	#PERL_UNUSED_DECL
 
	`__©åibuã__
((
unu£d
))

	)

3716 
	#PERL_UNUSED_DECL


	)

3720 #i‚de‡
PERL_UNUSED_ARG


3721 #i‡
deföed
(
löt
Ë&& deföed(
S_SPLINT_S
)

3722 
	~<nŸe.h
>

3723 
	#PERL_UNUSED_ARG
(
x
Ë
	`NOTE
(
	`ARGUNUSED
(x))

	)

3725 
	#PERL_UNUSED_ARG
(
x
Ë(()x)

	)

3729 #i‚de‡
PERL_UNUSED_VAR


3730 
	#PERL_UNUSED_VAR
(
x
Ë(()x)

	)

3733 #i‚de‡
PERL_UNUSED_CONTEXT


3734 #ifde‡
USE_ITHREADS


3735 
	#PERL_UNUSED_CONTEXT
 
	`PERL_UNUSED_ARG
(
my_≥æ
)

	)

3737 
	#PERL_UNUSED_CONTEXT


	)

3740 #i‚de‡
NOOP


3741 
	#NOOP
 ()0

	)

3744 #i‚de‡
dNOOP


3745 
	#dNOOP
 
Pîl___nŸu£d
 
PERL_UNUSED_DECL


	)

3748 #i‚de‡
NVTYPE


3749 #i‡
deföed
(
USE_LONG_DOUBLE
Ë&& deföed(
HAS_LONG_DOUBLE
)

3750 
	#NVTYPE
 

	)

3752 
	#NVTYPE
 

	)

3754 
NVTYPE
 
	tNV
;

3757 #i‚de‡
INT2PTR


3758 #i‡(
IVSIZE
 =
PTRSIZE
Ë&& (
UVSIZE
 == PTRSIZE)

3759 
	#PTRV
 
UV


	)

3760 
	#INT2PTR
(
™y
,
d
Ë◊ny)(d)

	)

3762 #i‡
PTRSIZE
 =
LONGSIZE


3763 
	#PTRV
 

	)

3765 
	#PTRV
 

	)

3767 
	#INT2PTR
(
™y
,
d
Ë◊ny)(
PTRV
)(d)

	)

3771 #i‚de‡
PTR2ul


3772 #i‡
PTRSIZE
 =
LONGSIZE


3773 
	#PTR2ul
(
p
Ë()’)

	)

3775 
	#PTR2ul
(
p
Ë
	`INT2PTR
(,p)

	)

3778 #i‚de‡
PTR2«t


3779 
	#PTR2«t
(
p
Ë(
PTRV
)’)

	)

3782 #i‚de‡
NUM2PTR


3783 
	#NUM2PTR
(
™y
,
d
Ë◊ny)
	`PTR2«t
(d)

	)

3786 #i‚de‡
PTR2IV


3787 
	#PTR2IV
(
p
Ë
	`INT2PTR
(
IV
,p)

	)

3790 #i‚de‡
PTR2UV


3791 
	#PTR2UV
(
p
Ë
	`INT2PTR
(
UV
,p)

	)

3794 #i‚de‡
PTR2NV


3795 
	#PTR2NV
(
p
Ë
	`NUM2PTR
(
NV
,p)

	)

3798 #unde‡
START_EXTERN_C


3799 #unde‡
END_EXTERN_C


3800 #unde‡
EXTERN_C


3801 #ifde‡
__˝lu•lus


3802 
	#START_EXTERN_C
 "C" {

	)

3803 
	#END_EXTERN_C
 }

	)

3804 
	#EXTERN_C
 "C"

	)

3806 
	#START_EXTERN_C


	)

3807 
	#END_EXTERN_C


	)

3808 
	#EXTERN_C
 

	)

3811 #i‡
deföed
(
PERL_GCC_PEDANTIC
)

3812 #i‚de‡
PERL_GCC_BRACE_GROUPS_FORBIDDEN


3813 
	#PERL_GCC_BRACE_GROUPS_FORBIDDEN


	)

3817 #i‡
deföed
(
__GNUC__
Ë&& !deföed(
PERL_GCC_BRACE_GROUPS_FORBIDDEN
Ë&& !deföed(
__˝lu•lus
)

3818 #i‚de‡
PERL_USE_GCC_BRACE_GROUPS


3819 
	#PERL_USE_GCC_BRACE_GROUPS


	)

3823 #unde‡
STMT_START


3824 #unde‡
STMT_END


3825 #ifde‡
PERL_USE_GCC_BRACE_GROUPS


3826 
	#STMT_START
 ()–

	)

3827 
	#STMT_END
 )

	)

3829 #i‡
deföed
(
VOIDFLAGS
Ë&& (VOIDFLAGSË&& (deföed(
sun
Ë|| deföed(
__sun__
)Ë&& !deföed(
__GNUC__
)

3830 
	#STMT_START
 i‡(1)

	)

3831 
	#STMT_END
 ()0

	)

3833 
	#STMT_START
 do

	)

3834 
	#STMT_END
 0)

	)

3837 #i‚de‡
boﬁSV


3838 
	#boﬁSV
(
b
Ë((bË? &
PL_sv_yes
 : &
PL_sv_no
)

	)

3842 #i‚de‡
DEFSV


3843 
	#DEFSV
 
	`GvSV
(
PL_defgv
)

	)

3846 #i‚de‡
SAVE_DEFSV


3847 
	#SAVE_DEFSV
 
	`SAVESPTR
(
	`GvSV
(
PL_defgv
))

	)

3850 #i‚de‡
DEFSV_£t


3851 
	#DEFSV_£t
(
sv
Ë(
DEFSV
 = (sv))

	)

3855 #i‚de‡
AvFILLp


3856 
	#AvFILLp
 
AvFILL


	)

3858 #i‚de‡
ERRSV


3859 
	#ERRSV
 
	`gë_sv
("@",
FALSE
)

	)

3868 #i‚de‡
gv_°ashpvn


3869 
	#gv_°ashpvn
(
°r
,
Àn
,
¸óã
Ë
	`gv_°ashpv
(°r,¸óã)

	)

3873 #i‚de‡
gë_cv


3874 
	#gë_cv
 
≥æ_gë_cv


	)

3877 #i‚de‡
gë_sv


3878 
	#gë_sv
 
≥æ_gë_sv


	)

3881 #i‚de‡
gë_av


3882 
	#gë_av
 
≥æ_gë_av


	)

3885 #i‚de‡
gë_hv


3886 
	#gë_hv
 
≥æ_gë_hv


	)

3890 #i‚de‡
dUNDERBAR


3891 
	#dUNDERBAR
 
dNOOP


	)

3894 #i‚de‡
UNDERBAR


3895 
	#UNDERBAR
 
DEFSV


	)

3897 #i‚de‡
dAX


3898 
	#dAX
 
I32
 
ax
 = 
MARK
 - 
PL_°ack_ba£
 + 1

	)

3901 #i‚de‡
dITEMS


3902 
	#dITEMS
 
I32
 
ôems
 = 
SP
 - 
MARK


	)

3904 #i‚de‡
dXSTARG


3905 
	#dXSTARG
 
SV
 * 
èrg
 = 
	`sv_√wm‹èl
()

	)

3907 #i‚de‡
dAXMARK


3908 
	#dAXMARK
 
I32
 
ax
 = 
POPMARK
; \

3909 
SV
 ** c⁄° 
m¨k
 = 
PL_°ack_ba£
 + 
ax
++

	)

3911 #i‚de‡
XS¥ePUSH


3912 
	#XS¥ePUSH
 (
•
 = 
PL_°ack_ba£
 + 
ax
 - 1)

	)

3915 #i‡(
PERL_BCDVERSION
 < 0x5005000)

3916 #unde‡
XSRETURN


3917 
	#XSRETURN
(
off
) \

3918 
STMT_START
 { \

3919 
PL_°ack_•
 = 
PL_°ack_ba£
 + 
ax
 + ((
off
) - 1); \

3921 } 
STMT_END


	)

3923 #i‚de‡
XSPROTO


3924 
	#XSPROTO
(
«me
Ë
	`«me
(
pTHX_
 
CV
* 
cv
)

	)

3927 #i‚de‡
SVfARG


3928 
	#SVfARG
(
p
Ë((*)’))

	)

3930 #i‚de‡
PERL_ABS


3931 
	#PERL_ABS
(
x
Ë((xË< 0 ? -(xË: (x))

	)

3933 #i‚de‡
dVAR


3934 
	#dVAR
 
dNOOP


	)

3936 #i‚de‡
SVf


3937 
	#SVf
 "_"

	)

3939 #i‚de‡
UTF8_MAXBYTES


3940 
	#UTF8_MAXBYTES
 
UTF8_MAXLEN


	)

3942 #i‚de‡
CPERLsc›e


3943 
	#CPERLsc›e
(
x
Ë
	)
x

3945 #i‚de‡
PERL_HASH


3946 
	#PERL_HASH
(
hash
,
°r
,
Àn
) \

3947 
STMT_START
 { \

3948 c⁄° *
s_PeRlHaSh
 = 
°r
; \

3949 
I32
 
i_PeRlHaSh
 = 
Àn
; \

3950 
U32
 
hash_PeRlHaSh
 = 0; \

3951 
i_PeRlHaSh
--) \

3952 
hash_PeRlHaSh
 = hash_PeRlHaSh * 33 + *
s_PeRlHaSh
++; \

3953 (
hash
Ë
hash_PeRlHaSh
; \

3954 } 
STMT_END


	)

3957 #i‚de‡
PERLIO_FUNCS_DECL


3958 #ifde‡
PERLIO_FUNCS_CONST


3959 
	#PERLIO_FUNCS_DECL
(
funcs
Ëc⁄° 
PîlIO_funcs
 
	)
funcs

3960 
	#PERLIO_FUNCS_CAST
(
funcs
Ë(
PîlIO_funcs
*)(funcs)

	)

3962 
	#PERLIO_FUNCS_DECL
(
funcs
Ë
PîlIO_funcs
 
	)
funcs

3963 
	#PERLIO_FUNCS_CAST
(
funcs
Ë(funcs)

	)

3968 #i‡(
PERL_BCDVERSION
 < 0x5009003)

3970 #ifde‡
ARGS¥Ÿo


3971 
	gOP
* (
	tCPERLsc›e
(*
	tPîl_µaddr_t
))(
	tARGS¥Ÿo
);

3973 
OP
* (
	tCPERLsc›e
(*
	tPîl_µaddr_t
))(
	tpTHX
);

3976 
OP
* (
	tCPERLsc›e
(*
	tPîl_check_t
)Ë(
	tpTHX_
 
	tOP
*);

3979 #i‚de‡
isPSXSPC


3980 
	#isPSXSPC
(
c
Ë(
	`isSPACE
(cË|| (cË='\v')

	)

3983 #i‚de‡
isBLANK


3984 
	#isBLANK
(
c
Ë((cË=' ' || (cË='\t')

	)

3987 #ifde‡
EBCDIC


3988 #i‚de‡
isALNUMC


3989 
	#isALNUMC
(
c
Ë
	`iß um
(c)

	)

3992 #i‚de‡
isASCII


3993 
	#isASCII
(
c
Ë
	`ißscii
(c)

	)

3996 #i‚de‡
isCNTRL


3997 
	#isCNTRL
(
c
Ë
	`is˙ål
(c)

	)

4000 #i‚de‡
isGRAPH


4001 
	#isGRAPH
(
c
Ë
	`isgøph
(c)

	)

4004 #i‚de‡
isPRINT


4005 
	#isPRINT
(
c
Ë
	`i•röt
(c)

	)

4008 #i‚de‡
isPUNCT


4009 
	#isPUNCT
(
c
Ë
	`i•un˘
(c)

	)

4012 #i‚de‡
isXDIGIT


4013 
	#isXDIGIT
(
c
Ë
	`isxdigô
(c)

	)

4017 #i‡(
PERL_BCDVERSION
 < 0x5010000)

4023 #unde‡
isPRINT


4025 #i‚de‡
isALNUMC


4026 
	#isALNUMC
(
c
Ë(
	`isALPHA
(cË|| 
	`isDIGIT
(c))

	)

4029 #i‚de‡
isASCII


4030 
	#isASCII
(
c
Ë((cË<127)

	)

4033 #i‚de‡
isCNTRL


4034 
	#isCNTRL
(
c
Ë((cË< ' ' || (cË=127)

	)

4037 #i‚de‡
isGRAPH


4038 
	#isGRAPH
(
c
Ë(
	`isALNUM
(cË|| 
	`isPUNCT
(c))

	)

4041 #i‚de‡
isPRINT


4042 
	#isPRINT
(
c
Ë(((cË>32 && (cË< 127))

	)

4045 #i‚de‡
isPUNCT


4046 
	#isPUNCT
(
c
Ë(((cË>33 && (cË<47Ë|| ((cË>58 && (cË<64Ë|| ((cË>91 && (cË<96Ë|| ((cË>123 && (cË<126))

	)

4049 #i‚de‡
isXDIGIT


4050 
	#isXDIGIT
(
c
Ë(
	`isDIGIT
(cË|| ((cË>'a' && (cË<'f'Ë|| ((cË>'A' && (cË<'F'))

	)

4055 #i‚de‡
PERL_SIGNALS_UNSAFE_FLAG


4057 
	#PERL_SIGNALS_UNSAFE_FLAG
 0x0001

	)

4059 #i‡(
PERL_BCDVERSION
 < 0x5008000)

4060 
	#D_PPP_PERL_SIGNALS_INIT
 
PERL_SIGNALS_UNSAFE_FLAG


	)

4062 
	#D_PPP_PERL_SIGNALS_INIT
 0

	)

4065 #i‡
	`deföed
(
NEED_PL_sig«ls
)

4066 
U32
 
	`DPPP_
(
my_PL_sig«ls
Ë
D_PPP_PERL_SIGNALS_INIT
;

4067 #ñi‡
	`deföed
(
NEED_PL_sig«ls_GLOBAL
)

4068 
U32
 
	`DPPP_
(
my_PL_sig«ls
Ë
D_PPP_PERL_SIGNALS_INIT
;

4070 
U32
 
	`DPPP_
(
my_PL_sig«ls
);

4072 
	#PL_sig«ls
 
	`DPPP_
(
my_PL_sig«ls
)

	)

4083 #i‡(
PERL_BCDVERSION
 <= 0x5005005)

4085 
	#PL_µaddr
 
µaddr


	)

4086 
	#PL_no_modify
 
no_modify


	)

4090 #i‡(
PERL_BCDVERSION
 <= 0x5004005)

4092 
	#PL_DBsig«l
 
DBsig«l


	)

4093 
	#PL_DBsögÀ
 
DBsögÀ


	)

4094 
	#PL_DBsub
 
DBsub


	)

4095 
	#PL_DBåa˚
 
DBåa˚


	)

4096 
	#PL_Sv
 
Sv


	)

4097 
	#PL_bu„nd
 
bu„nd


	)

4098 
	#PL_buÂå
 
buÂå


	)

4099 
	#PL_compûög
 
compûög


	)

4100 
	#PL_c›löe
 
c›löe


	)

4101 
	#PL_curc›
 
curc›


	)

4102 
	#PL_cur°ash
 
cur°ash


	)

4103 
	#PL_deb°ash
 
deb°ash


	)

4104 
	#PL_defgv
 
defgv


	)

4105 
	#PL_dõhook
 
dõhook


	)

4106 
	#PL_dúty
 
dúty


	)

4107 
	#PL_dow¨n
 
dow¨n


	)

4108 
	#PL_îrgv
 
îrgv


	)

4109 
	#PL_îr‹_cou¡
 
îr‹_cou¡


	)

4110 
	#PL_ex≥˘
 
ex≥˘


	)

4111 
	#PL_hexdigô
 
hexdigô


	)

4112 
	#PL_höts
 
höts


	)

4113 
	#PL_ö_my
 
ö_my


	)

4114 
	#PL_œ°°©vÆ
 
œ°°©vÆ


	)

4115 
	#PL_Àx_°©e
 
Àx_°©e


	)

4116 
	#PL_Àx_°uff
 
Àx_°uff


	)

4117 
	#PL_löe°r
 
löe°r


	)

4118 
	#PL_«
 
«


	)

4119 
	#PL_≥æ_de°ru˘_Àvñ
 
≥æ_de°ru˘_Àvñ


	)

4120 
	#PL_≥ædb
 
≥ædb


	)

4121 
	#PL_rsÂ_fûãrs
 
rsÂ_fûãrs


	)

4122 
	#PL_rsÂ
 
rsÂ


	)

4123 
	#PL_°ack_ba£
 
°ack_ba£


	)

4124 
	#PL_°ack_•
 
°ack_•


	)

4125 
	#PL_°©ˇche
 
°©ˇche


	)

4126 
	#PL_°dögv
 
°dögv


	)

4127 
	#PL_sv_¨í¨oŸ
 
sv_¨í¨oŸ


	)

4128 
	#PL_sv_no
 
sv_no


	)

4129 
	#PL_sv_undef
 
sv_undef


	)

4130 
	#PL_sv_yes
 
sv_yes


	)

4131 
	#PL_èöãd
 
èöãd


	)

4132 
	#PL_èötög
 
èötög


	)

4133 
	#PL_tokíbuf
 
tokíbuf


	)

4147 #i‡(
PERL_BCDVERSION
 >= 0x5009005)

4148 #ifde‡
DPPP_PL_∑r£r_NO_DUMMY


4149 
	#D_PPP_my_PL_∑r£r_v¨
(
v¨
Ë((
PL_∑r£r
 ? PL_parser : \

4150 (
	`¸ﬂk
("panic: PL_parser == NULL in %s:%d", \

4151 
__FILE__
, 
__LINE__
), (
yy_∑r£r
 *Ë
NULL
))->
v¨
)

	)

4153 #ifde‡
DPPP_PL_∑r£r_NO_DUMMY_WARNING


4154 
	#D_PPP_∑r£r_dummy_w¨nög
(
v¨
)

	)

4156 
	#D_PPP_∑r£r_dummy_w¨nög
(
v¨
) \

4157 
	`w¨n
("w¨nög: dummy PL_" #v¨ " u£d i¿%s:%d", 
__FILE__
, 
__LINE__
),

	)

4159 
	#D_PPP_my_PL_∑r£r_v¨
(
v¨
Ë((
PL_∑r£r
 ? PL_parser : \

4160 (
	`D_PPP_∑r£r_dummy_w¨nög
(
v¨
Ë&
	`DPPP_
(
dummy_PL_∑r£r
)))->v¨)

	)

4161 #i‡
	`deföed
(
NEED_PL_∑r£r
)

4162 
yy_∑r£r
 
	`DPPP_
(
dummy_PL_∑r£r
);

4163 #ñi‡
	`deföed
(
NEED_PL_∑r£r_GLOBAL
)

4164 
yy_∑r£r
 
	`DPPP_
(
dummy_PL_∑r£r
);

4166 
yy_∑r£r
 
	`DPPP_
(
dummy_PL_∑r£r
);

4186 
	#PL_ex≥˘
 
	`D_PPP_my_PL_∑r£r_v¨
(
ex≥˘
)

	)

4187 
	#PL_c›löe
 
	`D_PPP_my_PL_∑r£r_v¨
(
c›löe
)

	)

4188 
	#PL_rsÂ
 
	`D_PPP_my_PL_∑r£r_v¨
(
rsÂ
)

	)

4189 
	#PL_rsÂ_fûãrs
 
	`D_PPP_my_PL_∑r£r_v¨
(
rsÂ_fûãrs
)

	)

4190 
	#PL_löe°r
 
	`D_PPP_my_PL_∑r£r_v¨
(
löe°r
)

	)

4191 
	#PL_buÂå
 
	`D_PPP_my_PL_∑r£r_v¨
(
buÂå
)

	)

4192 
	#PL_bu„nd
 
	`D_PPP_my_PL_∑r£r_v¨
(
bu„nd
)

	)

4193 
	#PL_Àx_°©e
 
	`D_PPP_my_PL_∑r£r_v¨
(
Àx_°©e
)

	)

4194 
	#PL_Àx_°uff
 
	`D_PPP_my_PL_∑r£r_v¨
(
Àx_°uff
)

	)

4195 
	#PL_tokíbuf
 
	`D_PPP_my_PL_∑r£r_v¨
(
tokíbuf
)

	)

4196 
	#PL_ö_my
 
	`D_PPP_my_PL_∑r£r_v¨
(
ö_my
)

	)

4197 
	#PL_ö_my_°ash
 
	`D_PPP_my_PL_∑r£r_v¨
(
ö_my_°ash
)

	)

4198 
	#PL_îr‹_cou¡
 
	`D_PPP_my_PL_∑r£r_v¨
(
îr‹_cou¡
)

	)

4204 
	#PL_∑r£r
 ((*Ë1)

	)

4207 #i‚de‡
mPUSHs


4208 
	#mPUSHs
(
s
Ë
	`PUSHs
(
	`sv_2m‹èl
(s))

	)

4211 #i‚de‡
PUSHm‹èl


4212 
	#PUSHm‹èl
 
	`PUSHs
(
	`sv_√wm‹èl
())

	)

4215 #i‚de‡
mPUSHp


4216 
	#mPUSHp
(
p
,
l
Ë
	`sv_£çvn
(
PUSHm‹èl
, (p), (l))

	)

4219 #i‚de‡
mPUSHn


4220 
	#mPUSHn
(
n
Ë
	`sv_£äv
(
PUSHm‹èl
, (
NV
)“))

	)

4223 #i‚de‡
mPUSHi


4224 
	#mPUSHi
(
i
Ë
	`sv_£tiv
(
PUSHm‹èl
, (
IV
)(i))

	)

4227 #i‚de‡
mPUSHu


4228 
	#mPUSHu
(
u
Ë
	`sv_£tuv
(
PUSHm‹èl
, (
UV
)(u))

	)

4230 #i‚de‡
mXPUSHs


4231 
	#mXPUSHs
(
s
Ë
	`XPUSHs
(
	`sv_2m‹èl
(s))

	)

4234 #i‚de‡
XPUSHm‹èl


4235 
	#XPUSHm‹èl
 
	`XPUSHs
(
	`sv_√wm‹èl
())

	)

4238 #i‚de‡
mXPUSHp


4239 
	#mXPUSHp
(
p
,
l
Ë
STMT_START
 { 
	`EXTEND
(
•
,1); 
	`sv_£çvn
(
PUSHm‹èl
, (p), (l)); 
	}
} 
STMT_END


	)

4242 #i‚de‡
mXPUSHn


4243 
	#mXPUSHn
(
n
Ë
STMT_START
 { 
	`EXTEND
(
•
,1); 
	`sv_£äv
(
PUSHm‹èl
, (
NV
)“)); } 
STMT_END


	)

4246 #i‚de‡
mXPUSHi


4247 
	#mXPUSHi
(
i
Ë
STMT_START
 { 
	`EXTEND
(
•
,1); 
	`sv_£tiv
(
PUSHm‹èl
, (
IV
)(i)); } 
STMT_END


	)

4250 #i‚de‡
mXPUSHu


4251 
	#mXPUSHu
(
u
Ë
STMT_START
 { 
	`EXTEND
(
•
,1); 
	`sv_£tuv
(
PUSHm‹èl
, (
UV
)(u)); } 
STMT_END


	)

4255 #i‚de‡
ˇŒ_sv


4256 
	#ˇŒ_sv
 
≥æ_ˇŒ_sv


	)

4259 #i‚de‡
ˇŒ_pv


4260 
	#ˇŒ_pv
 
≥æ_ˇŒ_pv


	)

4263 #i‚de‡
ˇŒ_¨gv


4264 
	#ˇŒ_¨gv
 
≥æ_ˇŒ_¨gv


	)

4267 #i‚de‡
ˇŒ_mëhod


4268 
	#ˇŒ_mëhod
 
≥æ_ˇŒ_mëhod


	)

4270 #i‚de‡
evÆ_sv


4271 
	#evÆ_sv
 
≥æ_evÆ_sv


	)

4275 #i‚de‡
PERL_LOADMOD_DENY


4276 
	#PERL_LOADMOD_DENY
 0x1

	)

4279 #i‚de‡
PERL_LOADMOD_NOIMPORT


4280 
	#PERL_LOADMOD_NOIMPORT
 0x2

	)

4283 #i‚de‡
PERL_LOADMOD_IMPORT_OPS


4284 
	#PERL_LOADMOD_IMPORT_OPS
 0x4

	)

4287 #i‚de‡
G_METHOD


4288 
	#G_METHOD
 64

	)

4289 #ifde‡
ˇŒ_sv


4290 #unde‡
ˇŒ_sv


4292 #i‡(
PERL_BCDVERSION
 < 0x5006000)

4293 
	#ˇŒ_sv
(
sv
, 
Êags
Ë((ÊagsË& 
G_METHOD
 ? 
	`≥æ_ˇŒ_mëhod
((*Ë
	`SvPV_nﬁí_c⁄°
(sv), \

4294 (
Êags
Ë& ~
G_METHOD
Ë: 
	`≥æ_ˇŒ_sv
(
sv
, fœgs))

	)

4296 
	#ˇŒ_sv
(
sv
, 
Êags
Ë((ÊagsË& 
G_METHOD
 ? 
	`Pîl_ˇŒ_mëhod
(
	`aTHX_
 (*Ë
	`SvPV_nﬁí_c⁄°
(sv), \

4297 (
Êags
Ë& ~
G_METHOD
Ë: 
	`Pîl_ˇŒ_sv
(
aTHX_
 
sv
, fœgs))

	)

4303 #i‚de‡
evÆ_pv


4304 #i‡
deföed
(
NEED_evÆ_pv
)

4305 
SV
* 
	$DPPP_
(
my_evÆ_pv
)(*
p
, 
I32
 
¸ﬂk_⁄_îr‹
);

4308 
SV
* 
	$DPPP_
(
my_evÆ_pv
)(*
p
, 
I32
 
¸ﬂk_⁄_îr‹
);

4311 #ifde‡
evÆ_pv


4312 #unde‡
evÆ_pv


4314 
	#evÆ_pv
(
a
,
b
Ë
	`DPPP_
(
my_evÆ_pv
)(
aTHX_
á,b)

	)

4315 
	#Pîl_evÆ_pv
 
	`DPPP_
(
my_evÆ_pv
)

	)

4317 #i‡
	`deföed
(
NEED_evÆ_pv
Ë|| deföed(
NEED_evÆ_pv_GLOBAL
)

4319 
SV
*

4320 
	$DPPP_
(
my_evÆ_pv
)(*
p
, 
I32
 
¸ﬂk_⁄_îr‹
)

4322 
dSP
;

4323 
SV
* 
sv
 = 
	`√wSVpv
(
p
, 0);

4325 
	`PUSHMARK
(
•
);

4326 
	`evÆ_sv
(
sv
, 
G_SCALAR
);

4327 
	`SvREFCNT_dec
(
sv
);

4329 
SPAGAIN
;

4330 
sv
 = 
POPs
;

4331 
PUTBACK
;

4333 i‡(
¸ﬂk_⁄_îr‹
 && 
	`SvTRUE
(
	`GvSV
(
îrgv
)))

4334 
	`¸ﬂk
(
	`SvPVx
(
	`GvSV
(
îrgv
), 
«
));

4336  
sv
;

4337 
	}
}

4342 #i‚de‡
vlﬂd_moduÀ


4343 #i‡
deföed
(
NEED_vlﬂd_moduÀ
)

4344 
	$DPPP_
(
my_vlﬂd_moduÀ
)(
U32
 
Êags
, 
SV
 *
«me
, SV *
vî
, 
va_li°
 *
¨gs
);

4347 
	$DPPP_
(
my_vlﬂd_moduÀ
)(
U32
 
Êags
, 
SV
 *
«me
, SV *
vî
, 
va_li°
 *
¨gs
);

4350 #ifde‡
vlﬂd_moduÀ


4351 #unde‡
vlﬂd_moduÀ


4353 
	#vlﬂd_moduÀ
(
a
,
b
,
c
,
d
Ë
	`DPPP_
(
my_vlﬂd_moduÀ
)(
aTHX_
á,b,c,d)

	)

4354 
	#Pîl_vlﬂd_moduÀ
 
	`DPPP_
(
my_vlﬂd_moduÀ
)

	)

4356 #i‡
	`deföed
(
NEED_vlﬂd_moduÀ
Ë|| deföed(
NEED_vlﬂd_moduÀ_GLOBAL
)

4359 
	$DPPP_
(
my_vlﬂd_moduÀ
)(
U32
 
Êags
, 
SV
 *
«me
, SV *
vî
, 
va_li°
 *
¨gs
)

4361 
dTHR
;

4362 
dVAR
;

4363 
OP
 *
ve›
, *
im›
;

4365 
OP
 * c⁄° 
mod«me
 = 
	`√wSVOP
(
OP_CONST
, 0, 
«me
);

4371 
	`SvREADONLY_off
(((
SVOP
*)
mod«me
)->
›_sv
);

4372 
mod«me
->
›_¥iv©e
 |
OPpCONST_BARE
;

4373 i‡(
vî
) {

4374 
ve›
 = 
	`√wSVOP
(
OP_CONST
, 0, 
vî
);

4377 
ve›
 = 
NULL
;

4378 i‡(
Êags
 & 
PERL_LOADMOD_NOIMPORT
) {

4379 
im›
 = 
	`ßw∑ªns
(
	`√wNULLLIST
());

4381 i‡(
Êags
 & 
PERL_LOADMOD_IMPORT_OPS
) {

4382 
im›
 = 
	`va_¨g
(*
¨gs
, 
OP
*);

4385 
SV
 *
sv
;

4386 
im›
 = 
NULL
;

4387 
sv
 = 
	`va_¨g
(*
¨gs
, 
SV
*);

4388 
sv
) {

4389 
im›
 = 
	`≠≥nd_ñem
(
OP_LIST
, im›, 
	`√wSVOP
(
OP_CONST
, 0, 
sv
));

4390 
sv
 = 
	`va_¨g
(*
¨gs
, 
SV
*);

4394 c⁄° 
löe_t
 
oc›löe
 = 
PL_c›löe
;

4395 
COP
 * c⁄° 
ocurc›
 = 
PL_curc›
;

4396 c⁄° 
€x≥˘
 = 
PL_ex≥˘
;

4398 #i‡(
PERL_BCDVERSION
 >= 0x5004000)

4399 
	`utûize
(!(
Êags
 & 
PERL_LOADMOD_DENY
), 
	`°¨t_sub∑r£
(
FALSE
, 0),

4400 
ve›
, 
mod«me
, 
im›
);

4402 
	`utûize
(!(
Êags
 & 
PERL_LOADMOD_DENY
), 
	`°¨t_sub∑r£
(),

4403 
mod«me
, 
im›
);

4405 
PL_ex≥˘
 = 
€x≥˘
;

4406 
PL_c›löe
 = 
oc›löe
;

4407 
PL_curc›
 = 
ocurc›
;

4409 
	}
}

4414 #i‚de‡
lﬂd_moduÀ


4415 #i‡
deföed
(
NEED_lﬂd_moduÀ
)

4416 
	$DPPP_
(
my_lﬂd_moduÀ
)(
U32
 
Êags
, 
SV
 *
«me
, SV *
vî
, ...);

4419 
	$DPPP_
(
my_lﬂd_moduÀ
)(
U32
 
Êags
, 
SV
 *
«me
, SV *
vî
, ...);

4422 #ifde‡
lﬂd_moduÀ


4423 #unde‡
lﬂd_moduÀ


4425 
	#lﬂd_moduÀ
 
	`DPPP_
(
my_lﬂd_moduÀ
)

	)

4426 
	#Pîl_lﬂd_moduÀ
 
	`DPPP_
(
my_lﬂd_moduÀ
)

	)

4428 #i‡
	`deföed
(
NEED_lﬂd_moduÀ
Ë|| deföed(
NEED_lﬂd_moduÀ_GLOBAL
)

4431 
	$DPPP_
(
my_lﬂd_moduÀ
)(
U32
 
Êags
, 
SV
 *
«me
, SV *
vî
, ...)

4433 
va_li°
 
¨gs
;

4434 
	`va_°¨t
(
¨gs
, 
vî
);

4435 
	`vlﬂd_moduÀ
(
Êags
, 
«me
, 
vî
, &
¨gs
);

4436 
	`va_íd
(
¨gs
);

4437 
	}
}

4441 #i‚de‡
√wRV_öc


4442 
	#√wRV_öc
(
sv
Ë
	`√wRV
(svË

	)

4445 #i‚de‡
√wRV_noöc


4446 #i‡
deföed
(
NEED_√wRV_noöc
)

4447 
SV
 * 
	$DPPP_
(
my_√wRV_noöc
)(
SV
 *
sv
);

4450 
SV
 * 
	$DPPP_
(
my_√wRV_noöc
)(
SV
 *
sv
);

4453 #ifde‡
√wRV_noöc


4454 #unde‡
√wRV_noöc


4456 
	#√wRV_noöc
(
a
Ë
	`DPPP_
(
my_√wRV_noöc
)(
aTHX_
á)

	)

4457 
	#Pîl_√wRV_noöc
 
	`DPPP_
(
my_√wRV_noöc
)

	)

4459 #i‡
	`deföed
(
NEED_√wRV_noöc
Ë|| deföed(
NEED_√wRV_noöc_GLOBAL
)

4460 
SV
 *

4461 
	$DPPP_
(
my_√wRV_noöc
)(
SV
 *
sv
)

4463 
SV
 *
rv
 = (SV *)
	`√wRV
(
sv
);

4464 
	`SvREFCNT_dec
(
sv
);

4465  
rv
;

4466 
	}
}

4476 #i‡(
PERL_BCDVERSION
 < 0x5004063) && (PERL_BCDVERSION != 0x5004005)

4477 #i‡
deföed
(
NEED_√wCONSTSUB
)

4478 
	$DPPP_
(
my_√wCONSTSUB
)(
HV
 *
°ash
, c⁄° *
«me
, 
SV
 *
sv
);

4481 
	$DPPP_
(
my_√wCONSTSUB
)(
HV
 *
°ash
, c⁄° *
«me
, 
SV
 *
sv
);

4484 #ifde‡
√wCONSTSUB


4485 #unde‡
√wCONSTSUB


4487 
	#√wCONSTSUB
(
a
,
b
,
c
Ë
	`DPPP_
(
my_√wCONSTSUB
)(
aTHX_
á,b,c)

	)

4488 
	#Pîl_√wCONSTSUB
 
	`DPPP_
(
my_√wCONSTSUB
)

	)

4490 #i‡
	`deföed
(
NEED_√wCONSTSUB
Ë|| deföed(
NEED_√wCONSTSUB_GLOBAL
)

4494 
	#D_PPP_PL_c›löe
 
PL_c›löe


	)

4497 
	$DPPP_
(
my_√wCONSTSUB
)(
HV
 *
°ash
, c⁄° *
«me
, 
SV
 *
sv
)

4499 
U32
 
ﬁdhöts
 = 
PL_höts
;

4500 
HV
 *
ﬁd_c›_°ash
 = 
PL_curc›
->
c›_°ash
;

4501 
HV
 *
ﬁd_cur°ash
 = 
PL_cur°ash
;

4502 
löe_t
 
ﬁdlöe
 = 
PL_curc›
->
c›_löe
;

4503 
PL_curc›
->
c›_löe
 = 
D_PPP_PL_c›löe
;

4505 
PL_höts
 &~
HINT_BLOCK_SCOPE
;

4506 i‡(
°ash
)

4507 
PL_cur°ash
 = 
PL_curc›
->
c›_°ash
 = 
°ash
;

4509 
	`√wSUB
(

4511 #i‡ (
PERL_BCDVERSION
 < 0x5003022)

4512 
	`°¨t_sub∑r£
(),

4513 #ñi‡(
PERL_BCDVERSION
 == 0x5003022)

4514 
	`°¨t_sub∑r£
(0),

4516 
	`°¨t_sub∑r£
(
FALSE
, 0),

4519 
	`√wSVOP
(
OP_CONST
, 0, 
	`√wSVpv
((*Ë
«me
, 0)),

4520 
	`√wSVOP
(
OP_CONST
, 0, &
PL_sv_no
),

4521 
	`√wSTATEOP
(0, 
NuŒch
, 
	`√wSVOP
(
OP_CONST
, 0, 
sv
))

4524 
PL_höts
 = 
ﬁdhöts
;

4525 
PL_curc›
->
c›_°ash
 = 
ﬁd_c›_°ash
;

4526 
PL_cur°ash
 = 
ﬁd_cur°ash
;

4527 
PL_curc›
->
c›_löe
 = 
ﬁdlöe
;

4528 
	}
}

4551 #i‡
deföed
(
MULTIPLICITY
Ë|| deföed(
PERL_OBJECT
) || \

4552 
deföed
(
PERL_CAPI
Ë|| 
	$deföed
(
PERL_IMPLICIT_CONTEXT
)

4554 #i‚de‡
START_MY_CXT


4559 
	#START_MY_CXT


	)

4561 #i‡(
PERL_BCDVERSION
 < 0x5004068)

4563 
	#dMY_CXT_SV
 \

4564 
SV
 *
my_cxt_sv
 = 
	`gë_sv
(
MY_CXT_KEY
, 
FALSE
)

	)

4566 
	#dMY_CXT_SV
 \

4567 
SV
 *
my_cxt_sv
 = *
	`hv_„tch
(
PL_modglobÆ
, 
MY_CXT_KEY
, \

4568 (
MY_CXT_KEY
)-1, 
TRUE
)

	)

4573 
	#dMY_CXT
 \

4574 
dMY_CXT_SV
; \

4575 
my_cxt_t
 *
my_cxç
 = 
	`INT2PTR
(my_cxt_t*,
	`SvUV
(
my_cxt_sv
))

	)

4580 
	#MY_CXT_INIT
 \

4581 
dMY_CXT_SV
; \

4583 
my_cxt_t
 *
my_cxç
 = (my_cxt_t*)
	`SvPVX
(
	`√wSV
((my_cxt_t)-1));\

4584 
	`Zîo
(
my_cxç
, 1, 
my_cxt_t
); \

4585 
	`sv_£tuv
(
my_cxt_sv
, 
	`PTR2UV
(
my_cxç
))

	)

4589 
	#MY_CXT
 (*
my_cxç
)

	)

4593 
	#pMY_CXT
 
my_cxt_t
 *
my_cxç


	)

4594 
	#pMY_CXT_
 
pMY_CXT
,

	)

4595 
	#_pMY_CXT
 ,
pMY_CXT


	)

4596 
	#aMY_CXT
 
my_cxç


	)

4597 
	#aMY_CXT_
 
aMY_CXT
,

	)

4598 
	#_aMY_CXT
 ,
aMY_CXT


	)

4602 #i‚de‡
MY_CXT_CLONE


4604 
	#MY_CXT_CLONE
 \

4605 
dMY_CXT_SV
; \

4606 
my_cxt_t
 *
my_cxç
 = (my_cxt_t*)
	`SvPVX
(
	`√wSV
((my_cxt_t)-1));\

4607 
	`C›y
(
	`INT2PTR
(
my_cxt_t
*, 
	`SvUV
(
my_cxt_sv
)), 
my_cxç
, 1, my_cxt_t);\

4608 
	`sv_£tuv
(
my_cxt_sv
, 
	`PTR2UV
(
my_cxç
))

	)

4613 #i‚de‡
START_MY_CXT


4615 
	#START_MY_CXT
 
my_cxt_t
 
my_cxt
;

	)

4616 
	#dMY_CXT_SV
 
dNOOP


	)

4617 
	#dMY_CXT
 
dNOOP


	)

4618 
	#MY_CXT_INIT
 
NOOP


	)

4619 
	#MY_CXT
 
my_cxt


	)

4621 
	#pMY_CXT
 

	)

4622 
	#pMY_CXT_


	)

4623 
	#_pMY_CXT


	)

4624 
	#aMY_CXT


	)

4625 
	#aMY_CXT_


	)

4626 
	#_aMY_CXT


	)

4630 #i‚de‡
MY_CXT_CLONE


4631 
	#MY_CXT_CLONE
 
NOOP


	)

4636 #i‚de‡
IVdf


4637 #i‡
IVSIZE
 =
LONGSIZE


4638 
	#IVdf
 "ld"

	)

4639 
	#UVuf
 "lu"

	)

4640 
	#UVof
 "lo"

	)

4641 
	#UVxf
 "lx"

	)

4642 
	#UVXf
 "lX"

	)

4644 #i‡
IVSIZE
 =
INTSIZE


4645 
	#IVdf
 "d"

	)

4646 
	#UVuf
 "u"

	)

4647 
	#UVof
 "o"

	)

4648 
	#UVxf
 "x"

	)

4649 
	#UVXf
 "X"

	)

4654 #i‚de‡
NVef


4655 #i‡
	`deföed
(
USE_LONG_DOUBLE
Ë&& deföed(
HAS_LONG_DOUBLE
) && \

4656 
	`deföed
(
PERL_PRIÊdbl
Ë&& (
PERL_BCDVERSION
 != 0x5006000)

4658 
	#NVef
 
PERL_PRIñdbl


	)

4659 
	#NVff
 
PERL_PRIÊdbl


	)

4660 
	#NVgf
 
PERL_PRIgldbl


	)

4662 
	#NVef
 "e"

	)

4663 
	#NVff
 "f"

	)

4664 
	#NVgf
 "g"

	)

4668 #i‚de‡
SvREFCNT_öc


4669 #ifde‡
PERL_USE_GCC_BRACE_GROUPS


4670 
	#SvREFCNT_öc
(
sv
) \

4672 
SV
 * c⁄° 
_sv
 = (SV*)(
sv
); \

4673 i‡(
_sv
) \

4674 (
	`SvREFCNT
(
_sv
))++; \

4675 
_sv
; \

4676 
	}
})

	)

4678 
	#SvREFCNT_öc
(
sv
) \

4679 ((
PL_Sv
=(
SV
*)(
sv
)Ë? (++(
	`SvREFCNT
(PL_Sv)),PL_SvË: 
NULL
)

	)

4683 #i‚de‡
SvREFCNT_öc_sim∂e


4684 #ifde‡
PERL_USE_GCC_BRACE_GROUPS


4685 
	#SvREFCNT_öc_sim∂e
(
sv
) \

4687 i‡(
sv
) \

4688 (
	`SvREFCNT
(
sv
))++; \

4689 (
SV
 *)(
sv
); \

4690 })

	)

4692 
	#SvREFCNT_öc_sim∂e
(
sv
) \

4693 ((
sv
Ë? (
	`SvREFCNT
(sv)++,(
SV
*)(sv)Ë: 
NULL
)

	)

4697 #i‚de‡
SvREFCNT_öc_NN


4698 #ifde‡
PERL_USE_GCC_BRACE_GROUPS


4699 
	#SvREFCNT_öc_NN
(
sv
) \

4701 
SV
 * c⁄° 
_sv
 = (SV*)(
sv
); \

4702 
	`SvREFCNT
(
_sv
)++; \

4703 
_sv
; \

4704 })

	)

4706 
	#SvREFCNT_öc_NN
(
sv
) \

4707 (
PL_Sv
=(
SV
*)(
sv
),++(
	`SvREFCNT
(PL_Sv)),PL_Sv)

	)

4711 #i‚de‡
SvREFCNT_öc_void


4712 #ifde‡
PERL_USE_GCC_BRACE_GROUPS


4713 
	#SvREFCNT_öc_void
(
sv
) \

4715 
SV
 * c⁄° 
_sv
 = (SV*)(
sv
); \

4716 i‡(
_sv
) \

4717 ()(
	`SvREFCNT
(
_sv
)++); \

4718 })

	)

4720 
	#SvREFCNT_öc_void
(
sv
) \

4721 ()((
PL_Sv
=(
SV
*)(
sv
)Ë? ++(
	`SvREFCNT
(PL_Sv)Ë: 0)

	)

4724 #i‚de‡
SvREFCNT_öc_sim∂e_void


4725 
	#SvREFCNT_öc_sim∂e_void
(
sv
Ë
STMT_START
 { i‡(svË
	`SvREFCNT
(sv)++; } 
STMT_END


	)

4728 #i‚de‡
SvREFCNT_öc_sim∂e_NN


4729 
	#SvREFCNT_öc_sim∂e_NN
(
sv
Ë(++
	`SvREFCNT
(sv), (
SV
*)(sv))

	)

4732 #i‚de‡
SvREFCNT_öc_void_NN


4733 
	#SvREFCNT_öc_void_NN
(
sv
Ë()(++
	`SvREFCNT
((
SV
*)(sv)))

	)

4736 #i‚de‡
SvREFCNT_öc_sim∂e_void_NN


4737 
	#SvREFCNT_öc_sim∂e_void_NN
(
sv
Ë()(++
	`SvREFCNT
((
SV
*)(sv)))

	)

4740 #i‚de‡
√wSV_ty≥


4742 #i‡
deföed
(
NEED_√wSV_ty≥
)

4743 
SV
* 
	$DPPP_
(
my_√wSV_ty≥
)(
pTHX_
 
svty≥
 c⁄° 
t
);

4746 
SV
* 
	$DPPP_
(
my_√wSV_ty≥
)(
pTHX_
 
svty≥
 c⁄° 
t
);

4749 #ifde‡
√wSV_ty≥


4750 #unde‡
√wSV_ty≥


4752 
	#√wSV_ty≥
(
a
Ë
	`DPPP_
(
my_√wSV_ty≥
)(
aTHX_
á)

	)

4753 
	#Pîl_√wSV_ty≥
 
	`DPPP_
(
my_√wSV_ty≥
)

	)

4755 #i‡
	`deföed
(
NEED_√wSV_ty≥
Ë|| deföed(
NEED_√wSV_ty≥_GLOBAL
)

4757 
SV
*

4758 
	$DPPP_
(
my_√wSV_ty≥
)(
pTHX_
 
svty≥
 c⁄° 
t
)

4760 
SV
* c⁄° 
sv
 = 
	`√wSV
(0);

4761 
	`sv_upgøde
(
sv
, 
t
);

4762  
sv
;

4763 
	}
}

4769 #i‡(
PERL_BCDVERSION
 < 0x5006000)

4770 
	#D_PPP_CONSTPV_ARG
(
x
Ë((*Ë(x))

	)

4772 
	#D_PPP_CONSTPV_ARG
(
x
Ë(x)

	)

4774 #i‚de‡
√wSVpvn


4775 
	#√wSVpvn
(
d©a
,
Àn
) ((data) \

4776 ? ((
Àn
Ë? 
	`√wSVpv
((
d©a
), (len)) :ÇewSVpv("", 0)) \

4777 : 
	`√wSV
(0))

	)

4779 #i‚de‡
√wSVpvn_utf8


4780 
	#√wSVpvn_utf8
(
s
, 
Àn
, 
u
Ë
	`√wSVpvn_Êags
((s), (Àn), (uË? 
SVf_UTF8
 : 0)

	)

4782 #i‚de‡
SVf_UTF8


4783 
	#SVf_UTF8
 0

	)

4786 #i‚de‡
√wSVpvn_Êags


4788 #i‡
deföed
(
NEED_√wSVpvn_Êags
)

4789 
SV
 * 
	$DPPP_
(
my_√wSVpvn_Êags
)(
pTHX_
 c⁄° *
s
, 
STRLEN
 
Àn
, 
U32
 
Êags
);

4792 
SV
 * 
	$DPPP_
(
my_√wSVpvn_Êags
)(
pTHX_
 c⁄° *
s
, 
STRLEN
 
Àn
, 
U32
 
Êags
);

4795 #ifde‡
√wSVpvn_Êags


4796 #unde‡
√wSVpvn_Êags


4798 
	#√wSVpvn_Êags
(
a
,
b
,
c
Ë
	`DPPP_
(
my_√wSVpvn_Êags
)(
aTHX_
á,b,c)

	)

4799 
	#Pîl_√wSVpvn_Êags
 
	`DPPP_
(
my_√wSVpvn_Êags
)

	)

4801 #i‡
	`deföed
(
NEED_√wSVpvn_Êags
Ë|| deföed(
NEED_√wSVpvn_Êags_GLOBAL
)

4803 
SV
 *

4804 
	$DPPP_
(
my_√wSVpvn_Êags
)(
pTHX_
 c⁄° *
s
, 
STRLEN
 
Àn
, 
U32
 
Êags
)

4806 
SV
 *
sv
 = 
	`√wSVpvn
(
	`D_PPP_CONSTPV_ARG
(
s
), 
Àn
);

4807 
	`SvFLAGS
(
sv
Ë|(
Êags
 & 
SVf_UTF8
);

4808  (
Êags
 & 
SVs_TEMP
Ë? 
	`sv_2m‹èl
(
sv
) : sv;

4809 
	}
}

4816 #i‡!
deföed
(
NEED_sv_2pv_Êags
Ë&& deföed(
NEED_sv_2pv_nﬁí
)

4817 
	#NEED_sv_2pv_Êags


	)

4819 #i‡!
deföed
(
NEED_sv_2pv_Êags_GLOBAL
Ë&& deföed(
NEED_sv_2pv_nﬁí_GLOBAL
)

4820 
	#NEED_sv_2pv_Êags_GLOBAL


	)

4826 #i‚de‡
sv_2pv_nﬁí


4827 
	#sv_2pv_nﬁí
(
sv
Ë
	`SvPV_nﬁí
(sv)

	)

4830 #ifde‡
SvPVbyã


4837 #i‡(
PERL_BCDVERSION
 < 0x5007000)

4839 #i‡
deföed
(
NEED_sv_2pvbyã
)

4840 * 
	$DPPP_
(
my_sv_2pvbyã
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
);

4843 * 
	$DPPP_
(
my_sv_2pvbyã
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
);

4846 #ifde‡
sv_2pvbyã


4847 #unde‡
sv_2pvbyã


4849 
	#sv_2pvbyã
(
a
,
b
Ë
	`DPPP_
(
my_sv_2pvbyã
)(
aTHX_
á,b)

	)

4850 
	#Pîl_sv_2pvbyã
 
	`DPPP_
(
my_sv_2pvbyã
)

	)

4852 #i‡
	`deföed
(
NEED_sv_2pvbyã
Ë|| deföed(
NEED_sv_2pvbyã_GLOBAL
)

4855 
	$DPPP_
(
my_sv_2pvbyã
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
)

4857 
	`sv_utf8_downgøde
(
sv
,0);

4858  
	`SvPV
(
sv
,*
Õ
);

4859 
	}
}

4867 #unde‡
SvPVbyã


4869 
	#SvPVbyã
(
sv
, 
Õ
) \

4870 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
|
SVf_UTF8
)) == (SVf_POK) \

4871 ? ((
Õ
 = 
	`SvCUR
(
sv
)), 
	`SvPVX
(sv)Ë: 
	`sv_2pvbyã
(sv, &Õ))

	)

4877 
	#SvPVbyã
 
SvPV


	)

4878 
	#sv_2pvbyã
 
sv_2pv


	)

4881 #i‚de‡
sv_2pvbyã_nﬁí


4882 
	#sv_2pvbyã_nﬁí
(
sv
Ë
	`sv_2pv_nﬁí
(sv)

	)

4894 #i‚de‡
SV_IMMEDIATE_UNREF


4895 
	#SV_IMMEDIATE_UNREF
 0

	)

4898 #i‚de‡
SV_GMAGIC


4899 
	#SV_GMAGIC
 0

	)

4902 #i‚de‡
SV_COW_DROP_PV


4903 
	#SV_COW_DROP_PV
 0

	)

4906 #i‚de‡
SV_UTF8_NO_ENCODING


4907 
	#SV_UTF8_NO_ENCODING
 0

	)

4910 #i‚de‡
SV_NOSTEAL


4911 
	#SV_NOSTEAL
 0

	)

4914 #i‚de‡
SV_CONST_RETURN


4915 
	#SV_CONST_RETURN
 0

	)

4918 #i‚de‡
SV_MUTABLE_RETURN


4919 
	#SV_MUTABLE_RETURN
 0

	)

4922 #i‚de‡
SV_SMAGIC


4923 
	#SV_SMAGIC
 0

	)

4926 #i‚de‡
SV_HAS_TRAILING_NUL


4927 
	#SV_HAS_TRAILING_NUL
 0

	)

4930 #i‚de‡
SV_COW_SHARED_HASH_KEYS


4931 
	#SV_COW_SHARED_HASH_KEYS
 0

	)

4934 #i‡(
PERL_BCDVERSION
 < 0x5007002)

4936 #i‡
deföed
(
NEED_sv_2pv_Êags
)

4937 * 
	$DPPP_
(
my_sv_2pv_Êags
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
, 
I32
 
Êags
);

4940 * 
	$DPPP_
(
my_sv_2pv_Êags
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
, 
I32
 
Êags
);

4943 #ifde‡
sv_2pv_Êags


4944 #unde‡
sv_2pv_Êags


4946 
	#sv_2pv_Êags
(
a
,
b
,
c
Ë
	`DPPP_
(
my_sv_2pv_Êags
)(
aTHX_
á,b,c)

	)

4947 
	#Pîl_sv_2pv_Êags
 
	`DPPP_
(
my_sv_2pv_Êags
)

	)

4949 #i‡
	`deföed
(
NEED_sv_2pv_Êags
Ë|| deföed(
NEED_sv_2pv_Êags_GLOBAL
)

4952 
	$DPPP_
(
my_sv_2pv_Êags
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
, 
I32
 
Êags
)

4954 
STRLEN
 
n_a
 = (STRLENË
Êags
;

4955  
	`sv_2pv
(
sv
, 
Õ
 ?Ü∞: &
n_a
);

4956 
	}
}

4960 #i‡
deföed
(
NEED_sv_pvn_f‹˚_Êags
)

4961 * 
	$DPPP_
(
my_sv_pvn_f‹˚_Êags
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
, 
I32
 
Êags
);

4964 * 
	$DPPP_
(
my_sv_pvn_f‹˚_Êags
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
, 
I32
 
Êags
);

4967 #ifde‡
sv_pvn_f‹˚_Êags


4968 #unde‡
sv_pvn_f‹˚_Êags


4970 
	#sv_pvn_f‹˚_Êags
(
a
,
b
,
c
Ë
	`DPPP_
(
my_sv_pvn_f‹˚_Êags
)(
aTHX_
á,b,c)

	)

4971 
	#Pîl_sv_pvn_f‹˚_Êags
 
	`DPPP_
(
my_sv_pvn_f‹˚_Êags
)

	)

4973 #i‡
	`deföed
(
NEED_sv_pvn_f‹˚_Êags
Ë|| deföed(
NEED_sv_pvn_f‹˚_Êags_GLOBAL
)

4976 
	$DPPP_
(
my_sv_pvn_f‹˚_Êags
)(
pTHX_
 
SV
 *
sv
, 
STRLEN
 *
Õ
, 
I32
 
Êags
)

4978 
STRLEN
 
n_a
 = (STRLENË
Êags
;

4979  
	`sv_pvn_f‹˚
(
sv
, 
Õ
 ?Ü∞: &
n_a
);

4980 
	}
}

4986 #i‡(
PERL_BCDVERSION
 < 0x5008008) || ( (PERL_BCDVERSION >= 0x5009000) && (PERL_BCDVERSION < 0x5009003) )

4987 
	#DPPP_SVPV_NOLEN_LP_ARG
 &
PL_«


	)

4989 
	#DPPP_SVPV_NOLEN_LP_ARG
 0

	)

4991 #i‚de‡
SvPV_c⁄°


4992 
	#SvPV_c⁄°
(
sv
, 
Õ
Ë
	`SvPV_Êags_c⁄°
(sv,Üp, 
SV_GMAGIC
)

	)

4995 #i‚de‡
SvPV_muèbÀ


4996 
	#SvPV_muèbÀ
(
sv
, 
Õ
Ë
	`SvPV_Êags_muèbÀ
(sv,Üp, 
SV_GMAGIC
)

	)

4998 #i‚de‡
SvPV_Êags


4999 
	#SvPV_Êags
(
sv
, 
Õ
, 
Êags
) \

5000 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
)) == SVf_POK \

5001 ? ((
Õ
 = 
	`SvCUR
(
sv
)), 
	`SvPVX
(sv)Ë: 
	`sv_2pv_Êags
(sv, &Õ, 
Êags
))

	)

5003 #i‚de‡
SvPV_Êags_c⁄°


5004 
	#SvPV_Êags_c⁄°
(
sv
, 
Õ
, 
Êags
) \

5005 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
)) == SVf_POK \

5006 ? ((
Õ
 = 
	`SvCUR
(
sv
)), 
	`SvPVX_c⁄°
(sv)) : \

5007 (c⁄° *Ë
	`sv_2pv_Êags
(
sv
, &
Õ
, 
Êags
|
SV_CONST_RETURN
))

	)

5009 #i‚de‡
SvPV_Êags_c⁄°_nﬁí


5010 
	#SvPV_Êags_c⁄°_nﬁí
(
sv
, 
Êags
) \

5011 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
)) == SVf_POK \

5012 ? 
	`SvPVX_c⁄°
(
sv
) : \

5013 (c⁄° *Ë
	`sv_2pv_Êags
(
sv
, 
DPPP_SVPV_NOLEN_LP_ARG
, 
Êags
|
SV_CONST_RETURN
))

	)

5015 #i‚de‡
SvPV_Êags_muèbÀ


5016 
	#SvPV_Êags_muèbÀ
(
sv
, 
Õ
, 
Êags
) \

5017 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
)) == SVf_POK \

5018 ? ((
Õ
 = 
	`SvCUR
(
sv
)), 
	`SvPVX_muèbÀ
(sv)) : \

5019 
	`sv_2pv_Êags
(
sv
, &
Õ
, 
Êags
|
SV_MUTABLE_RETURN
))

	)

5021 #i‚de‡
SvPV_f‹˚


5022 
	#SvPV_f‹˚
(
sv
, 
Õ
Ë
	`SvPV_f‹˚_Êags
(sv,Üp, 
SV_GMAGIC
)

	)

5025 #i‚de‡
SvPV_f‹˚_nﬁí


5026 
	#SvPV_f‹˚_nﬁí
(
sv
Ë
	`SvPV_f‹˚_Êags_nﬁí
(sv, 
SV_GMAGIC
)

	)

5029 #i‚de‡
SvPV_f‹˚_muèbÀ


5030 
	#SvPV_f‹˚_muèbÀ
(
sv
, 
Õ
Ë
	`SvPV_f‹˚_Êags_muèbÀ
(sv,Üp, 
SV_GMAGIC
)

	)

5033 #i‚de‡
SvPV_f‹˚_nomg


5034 
	#SvPV_f‹˚_nomg
(
sv
, 
Õ
Ë
	`SvPV_f‹˚_Êags
(sv,Üp, 0)

	)

5037 #i‚de‡
SvPV_f‹˚_nomg_nﬁí


5038 
	#SvPV_f‹˚_nomg_nﬁí
(
sv
Ë
	`SvPV_f‹˚_Êags_nﬁí
(sv, 0)

	)

5040 #i‚de‡
SvPV_f‹˚_Êags


5041 
	#SvPV_f‹˚_Êags
(
sv
, 
Õ
, 
Êags
) \

5042 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
|
SVf_THINKFIRST
)) == SVf_POK \

5043 ? ((
Õ
 = 
	`SvCUR
(
sv
)), 
	`SvPVX
(sv)Ë: 
	`sv_pvn_f‹˚_Êags
(sv, &Õ, 
Êags
))

	)

5045 #i‚de‡
SvPV_f‹˚_Êags_nﬁí


5046 
	#SvPV_f‹˚_Êags_nﬁí
(
sv
, 
Êags
) \

5047 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
|
SVf_THINKFIRST
)) == SVf_POK \

5048 ? 
	`SvPVX
(
sv
Ë: 
	`sv_pvn_f‹˚_Êags
(sv, 
DPPP_SVPV_NOLEN_LP_ARG
, 
Êags
))

	)

5050 #i‚de‡
SvPV_f‹˚_Êags_muèbÀ


5051 
	#SvPV_f‹˚_Êags_muèbÀ
(
sv
, 
Õ
, 
Êags
) \

5052 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
|
SVf_THINKFIRST
)) == SVf_POK \

5053 ? ((
Õ
 = 
	`SvCUR
(
sv
)), 
	`SvPVX_muèbÀ
(sv)) \

5054 : 
	`sv_pvn_f‹˚_Êags
(
sv
, &
Õ
, 
Êags
|
SV_MUTABLE_RETURN
))

	)

5056 #i‚de‡
SvPV_nﬁí


5057 
	#SvPV_nﬁí
(
sv
) \

5058 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
)) == SVf_POK \

5059 ? 
	`SvPVX
(
sv
Ë: 
	`sv_2pv_Êags
(sv, 
DPPP_SVPV_NOLEN_LP_ARG
, 
SV_GMAGIC
))

	)

5061 #i‚de‡
SvPV_nﬁí_c⁄°


5062 
	#SvPV_nﬁí_c⁄°
(
sv
) \

5063 ((
	`SvFLAGS
(
sv
Ë& (
SVf_POK
)) == SVf_POK \

5064 ? 
	`SvPVX_c⁄°
(
sv
Ë: 
	`sv_2pv_Êags
(sv, 
DPPP_SVPV_NOLEN_LP_ARG
, 
SV_GMAGIC
|
SV_CONST_RETURN
))

	)

5066 #i‚de‡
SvPV_nomg


5067 
	#SvPV_nomg
(
sv
, 
Õ
Ë
	`SvPV_Êags
(sv,Üp, 0)

	)

5070 #i‚de‡
SvPV_nomg_c⁄°


5071 
	#SvPV_nomg_c⁄°
(
sv
, 
Õ
Ë
	`SvPV_Êags_c⁄°
(sv,Üp, 0)

	)

5074 #i‚de‡
SvPV_nomg_c⁄°_nﬁí


5075 
	#SvPV_nomg_c⁄°_nﬁí
(
sv
Ë
	`SvPV_Êags_c⁄°_nﬁí
(sv, 0)

	)

5077 #i‚de‡
SvPV_ª√w


5078 
	#SvPV_ª√w
(
sv
,
n
Ë
STMT_START
 { 
	`SvLEN_£t
(sv,Ç); \

5079 
	`SvPV_£t
((
sv
), (*Ë
	`ß„ªÆloc
( \

5080 (
MÆloc_t
)
	`SvPVX
(
sv
), (
MEM_SIZE
)((
n
)))); \

5081 } 
STMT_END


	)

5083 #i‚de‡
SvMAGIC_£t


5084 
	#SvMAGIC_£t
(
sv
, 
vÆ
) \

5085 
STMT_START
 { 
	`as£π
(
	`SvTYPE
(
sv
Ë>
SVt_PVMG
); \

5086 (((
XPVMG
*Ë
	`SvANY
(
sv
))->
xmg_magic
 = (
vÆ
)); } 
STMT_END


	)

5089 #i‡(
PERL_BCDVERSION
 < 0x5009003)

5090 #i‚de‡
SvPVX_c⁄°


5091 
	#SvPVX_c⁄°
(
sv
Ë((c⁄° *Ë(0 + 
	`SvPVX
(sv)))

	)

5094 #i‚de‡
SvPVX_muèbÀ


5095 
	#SvPVX_muèbÀ
(
sv
Ë(0 + 
	`SvPVX
(sv))

	)

5097 #i‚de‡
SvRV_£t


5098 
	#SvRV_£t
(
sv
, 
vÆ
) \

5099 
STMT_START
 { 
	`as£π
(
	`SvTYPE
(
sv
Ë>
SVt_RV
); \

5100 (((
XRV
*Ë
	`SvANY
(
sv
))->
xrv_rv
 = (
vÆ
)); } 
STMT_END


	)

5104 #i‚de‡
SvPVX_c⁄°


5105 
	#SvPVX_c⁄°
(
sv
Ë((c⁄° *)((sv)->
sv_u
.
svu_pv
))

	)

5108 #i‚de‡
SvPVX_muèbÀ


5109 
	#SvPVX_muèbÀ
(
sv
Ë((sv)->
sv_u
.
svu_pv
)

	)

5111 #i‚de‡
SvRV_£t


5112 
	#SvRV_£t
(
sv
, 
vÆ
) \

5113 
STMT_START
 { 
	`as£π
(
	`SvTYPE
(
sv
Ë>
SVt_RV
); \

5114 ((
sv
)->
sv_u
.
svu_rv
 = (
vÆ
)); } 
STMT_END


	)

5118 #i‚de‡
SvSTASH_£t


5119 
	#SvSTASH_£t
(
sv
, 
vÆ
) \

5120 
STMT_START
 { 
	`as£π
(
	`SvTYPE
(
sv
Ë>
SVt_PVMG
); \

5121 (((
XPVMG
*Ë
	`SvANY
(
sv
))->
xmg_°ash
 = (
vÆ
)); } 
STMT_END


	)

5124 #i‡(
PERL_BCDVERSION
 < 0x5004000)

5125 #i‚de‡
SvUV_£t


5126 
	#SvUV_£t
(
sv
, 
vÆ
) \

5127 
STMT_START
 { 
	`as£π
(
	`SvTYPE
(
sv
Ë=
SVt_IV
 || SvTYPE(svË>
SVt_PVIV
); \

5128 (((
XPVIV
*Ë
	`SvANY
(
sv
))->
xiv_iv
 = (
IV
Ë(
vÆ
)); } 
STMT_END


	)

5132 #i‚de‡
SvUV_£t


5133 
	#SvUV_£t
(
sv
, 
vÆ
) \

5134 
STMT_START
 { 
	`as£π
(
	`SvTYPE
(
sv
Ë=
SVt_IV
 || SvTYPE(svË>
SVt_PVIV
); \

5135 (((
XPVUV
*Ë
	`SvANY
(
sv
))->
xuv_uv
 = (
vÆ
)); } 
STMT_END


	)

5140 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
v√wSVpvf
)

5141 #i‡
deföed
(
NEED_v√wSVpvf
)

5142 
SV
 * 
	$DPPP_
(
my_v√wSVpvf
)(
pTHX_
 c⁄° *
∑t
, 
va_li°
 *
¨gs
);

5145 
SV
 * 
	$DPPP_
(
my_v√wSVpvf
)(
pTHX_
 c⁄° *
∑t
, 
va_li°
 *
¨gs
);

5148 #ifde‡
v√wSVpvf


5149 #unde‡
v√wSVpvf


5151 
	#v√wSVpvf
(
a
,
b
Ë
	`DPPP_
(
my_v√wSVpvf
)(
aTHX_
á,b)

	)

5152 
	#Pîl_v√wSVpvf
 
	`DPPP_
(
my_v√wSVpvf
)

	)

5154 #i‡
	`deföed
(
NEED_v√wSVpvf
Ë|| deföed(
NEED_v√wSVpvf_GLOBAL
)

5156 
SV
 *

5157 
	$DPPP_
(
my_v√wSVpvf
)(
pTHX_
 c⁄° *
∑t
, 
va_li°
 *
¨gs
)

5159 
SV
 *
sv
 = 
	`√wSV
(0);

5160 
	`sv_v£çv‚
(
sv
, 
∑t
, 
	`°æí
’©), 
¨gs
, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*));

5161  
sv
;

5162 
	}
}

5167 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_vˇçvf
)

5168 
	#sv_vˇçvf
(
sv
, 
∑t
, 
¨gs
Ë
	`sv_vˇçv‚
(sv,Ö©, 
	`°æí
’©),árgs, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*))

	)

5171 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_v£çvf
)

5172 
	#sv_v£çvf
(
sv
, 
∑t
, 
¨gs
Ë
	`sv_v£çv‚
(sv,Ö©, 
	`°æí
’©),árgs, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*))

	)

5175 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_ˇçvf_mg
)

5176 #i‡
deföed
(
NEED_sv_ˇçvf_mg
)

5177 
	$DPPP_
(
my_sv_ˇçvf_mg
)(
pTHX_
 
SV
 *
sv
, c⁄° *
∑t
, ...);

5180 
	$DPPP_
(
my_sv_ˇçvf_mg
)(
pTHX_
 
SV
 *
sv
, c⁄° *
∑t
, ...);

5183 
	#Pîl_sv_ˇçvf_mg
 
	`DPPP_
(
my_sv_ˇçvf_mg
)

	)

5185 #i‡
	`deföed
(
NEED_sv_ˇçvf_mg
Ë|| deföed(
NEED_sv_ˇçvf_mg_GLOBAL
)

5188 
	$DPPP_
(
my_sv_ˇçvf_mg
)(
pTHX_
 
SV
 *
sv
, c⁄° *
∑t
, ...)

5190 
va_li°
 
¨gs
;

5191 
	`va_°¨t
(
¨gs
, 
∑t
);

5192 
	`sv_vˇçv‚
(
sv
, 
∑t
, 
	`°æí
’©), &
¨gs
, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*));

5193 
	`SvSETMAGIC
(
sv
);

5194 
	`va_íd
(
¨gs
);

5195 
	}
}

5200 #ifde‡
PERL_IMPLICIT_CONTEXT


5201 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_ˇçvf_mg_noc⁄ãxt
)

5202 #i‡
deföed
(
NEED_sv_ˇçvf_mg_noc⁄ãxt
)

5203 
	$DPPP_
(
my_sv_ˇçvf_mg_noc⁄ãxt
)(
SV
 *
sv
, c⁄° *
∑t
, ...);

5206 
	$DPPP_
(
my_sv_ˇçvf_mg_noc⁄ãxt
)(
SV
 *
sv
, c⁄° *
∑t
, ...);

5209 
	#sv_ˇçvf_mg_noc⁄ãxt
 
	`DPPP_
(
my_sv_ˇçvf_mg_noc⁄ãxt
)

	)

5210 
	#Pîl_sv_ˇçvf_mg_noc⁄ãxt
 
	`DPPP_
(
my_sv_ˇçvf_mg_noc⁄ãxt
)

	)

5212 #i‡
	`deföed
(
NEED_sv_ˇçvf_mg_noc⁄ãxt
Ë|| deföed(
NEED_sv_ˇçvf_mg_noc⁄ãxt_GLOBAL
)

5215 
	$DPPP_
(
my_sv_ˇçvf_mg_noc⁄ãxt
)(
SV
 *
sv
, c⁄° *
∑t
, ...)

5217 
dTHX
;

5218 
va_li°
 
¨gs
;

5219 
	`va_°¨t
(
¨gs
, 
∑t
);

5220 
	`sv_vˇçv‚
(
sv
, 
∑t
, 
	`°æí
’©), &
¨gs
, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*));

5221 
	`SvSETMAGIC
(
sv
);

5222 
	`va_íd
(
¨gs
);

5223 
	}
}

5230 #i‚de‡
sv_ˇçvf_mg


5231 #ifde‡
PERL_IMPLICIT_CONTEXT


5232 
	#sv_ˇçvf_mg
 
Pîl_sv_ˇçvf_mg_noc⁄ãxt


	)

5234 
	#sv_ˇçvf_mg
 
Pîl_sv_ˇçvf_mg


	)

5238 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_vˇçvf_mg
)

5239 
	#sv_vˇçvf_mg
(
sv
, 
∑t
, 
¨gs
) \

5240 
STMT_START
 { \

5241 
	`sv_vˇçv‚
(
sv
, 
∑t
, 
	`°æí
’©), 
¨gs
, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*)); \

5242 
	`SvSETMAGIC
(
sv
); \

5243 } 
STMT_END


	)

5246 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_£çvf_mg
)

5247 #i‡
deföed
(
NEED_sv_£çvf_mg
)

5248 
	$DPPP_
(
my_sv_£çvf_mg
)(
pTHX_
 
SV
 *
sv
, c⁄° *
∑t
, ...);

5251 
	$DPPP_
(
my_sv_£çvf_mg
)(
pTHX_
 
SV
 *
sv
, c⁄° *
∑t
, ...);

5254 
	#Pîl_sv_£çvf_mg
 
	`DPPP_
(
my_sv_£çvf_mg
)

	)

5256 #i‡
	`deföed
(
NEED_sv_£çvf_mg
Ë|| deföed(
NEED_sv_£çvf_mg_GLOBAL
)

5259 
	$DPPP_
(
my_sv_£çvf_mg
)(
pTHX_
 
SV
 *
sv
, c⁄° *
∑t
, ...)

5261 
va_li°
 
¨gs
;

5262 
	`va_°¨t
(
¨gs
, 
∑t
);

5263 
	`sv_v£çv‚
(
sv
, 
∑t
, 
	`°æí
’©), &
¨gs
, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*));

5264 
	`SvSETMAGIC
(
sv
);

5265 
	`va_íd
(
¨gs
);

5266 
	}
}

5271 #ifde‡
PERL_IMPLICIT_CONTEXT


5272 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_£çvf_mg_noc⁄ãxt
)

5273 #i‡
deföed
(
NEED_sv_£çvf_mg_noc⁄ãxt
)

5274 
	$DPPP_
(
my_sv_£çvf_mg_noc⁄ãxt
)(
SV
 *
sv
, c⁄° *
∑t
, ...);

5277 
	$DPPP_
(
my_sv_£çvf_mg_noc⁄ãxt
)(
SV
 *
sv
, c⁄° *
∑t
, ...);

5280 
	#sv_£çvf_mg_noc⁄ãxt
 
	`DPPP_
(
my_sv_£çvf_mg_noc⁄ãxt
)

	)

5281 
	#Pîl_sv_£çvf_mg_noc⁄ãxt
 
	`DPPP_
(
my_sv_£çvf_mg_noc⁄ãxt
)

	)

5283 #i‡
	`deföed
(
NEED_sv_£çvf_mg_noc⁄ãxt
Ë|| deföed(
NEED_sv_£çvf_mg_noc⁄ãxt_GLOBAL
)

5286 
	$DPPP_
(
my_sv_£çvf_mg_noc⁄ãxt
)(
SV
 *
sv
, c⁄° *
∑t
, ...)

5288 
dTHX
;

5289 
va_li°
 
¨gs
;

5290 
	`va_°¨t
(
¨gs
, 
∑t
);

5291 
	`sv_v£çv‚
(
sv
, 
∑t
, 
	`°æí
’©), &
¨gs
, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*));

5292 
	`SvSETMAGIC
(
sv
);

5293 
	`va_íd
(
¨gs
);

5294 
	}
}

5301 #i‚de‡
sv_£çvf_mg


5302 #ifde‡
PERL_IMPLICIT_CONTEXT


5303 
	#sv_£çvf_mg
 
Pîl_sv_£çvf_mg_noc⁄ãxt


	)

5305 
	#sv_£çvf_mg
 
Pîl_sv_£çvf_mg


	)

5309 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
sv_v£çvf_mg
)

5310 
	#sv_v£çvf_mg
(
sv
, 
∑t
, 
¨gs
) \

5311 
STMT_START
 { \

5312 
	`sv_v£çv‚
(
sv
, 
∑t
, 
	`°æí
’©), 
¨gs
, 
	`NuŒ
(
SV
**), 0, NuŒ(
boﬁ
*)); \

5313 
	`SvSETMAGIC
(
sv
); \

5314 } 
STMT_END


	)

5317 #i‚de‡
√wSVpvn_sh¨e


5319 #i‡
deföed
(
NEED_√wSVpvn_sh¨e
)

5320 
SV
 * 
	$DPPP_
(
my_√wSVpvn_sh¨e
)(
pTHX_
 c⁄° *
§c
, 
I32
 
Àn
, 
U32
 
hash
);

5323 
SV
 * 
	$DPPP_
(
my_√wSVpvn_sh¨e
)(
pTHX_
 c⁄° *
§c
, 
I32
 
Àn
, 
U32
 
hash
);

5326 #ifde‡
√wSVpvn_sh¨e


5327 #unde‡
√wSVpvn_sh¨e


5329 
	#√wSVpvn_sh¨e
(
a
,
b
,
c
Ë
	`DPPP_
(
my_√wSVpvn_sh¨e
)(
aTHX_
á,b,c)

	)

5330 
	#Pîl_√wSVpvn_sh¨e
 
	`DPPP_
(
my_√wSVpvn_sh¨e
)

	)

5332 #i‡
	`deföed
(
NEED_√wSVpvn_sh¨e
Ë|| deföed(
NEED_√wSVpvn_sh¨e_GLOBAL
)

5334 
SV
 *

5335 
	$DPPP_
(
my_√wSVpvn_sh¨e
)(
pTHX_
 c⁄° *
§c
, 
I32
 
Àn
, 
U32
 
hash
)

5337 
SV
 *
sv
;

5338 i‡(
Àn
 < 0)

5339 
Àn
 = -len;

5340 i‡(!
hash
)

5341 
	`PERL_HASH
(
hash
, (*Ë
§c
, 
Àn
);

5342 
sv
 = 
	`√wSVpvn
((*Ë
§c
, 
Àn
);

5343 
	`sv_upgøde
(
sv
, 
SVt_PVIV
);

5344 
	`SvIVX
(
sv
Ë
hash
;

5345 
	`SvREADONLY_⁄
(
sv
);

5346 
	`SvPOK_⁄
(
sv
);

5347  
sv
;

5348 
	}
}

5353 #i‚de‡
SvSHARED_HASH


5354 
	#SvSHARED_HASH
(
sv
Ë(0 + 
	`SvUVX
(sv))

	)

5356 #i‚de‡
HvNAME_gë


5357 
	#HvNAME_gë
(
hv
Ë
	`HvNAME
(hv)

	)

5359 #i‚de‡
HvNAMELEN_gë


5360 
	#HvNAMELEN_gë
(
hv
Ë(
	`HvNAME_gë
(hvË? (
I32
)
	`°æí
(HvNAME_gë(hv)Ë: 0)

	)

5362 #i‚de‡
GvSVn


5363 
	#GvSVn
(
gv
Ë
	`GvSV
(gv)

	)

5366 #i‚de‡
isGV_wôh_GP


5367 
	#isGV_wôh_GP
(
gv
Ë
	`isGV
(gv)

	)

5369 #i‚de‡
WARN_ALL


5370 
	#WARN_ALL
 0

	)

5373 #i‚de‡
WARN_CLOSURE


5374 
	#WARN_CLOSURE
 1

	)

5377 #i‚de‡
WARN_DEPRECATED


5378 
	#WARN_DEPRECATED
 2

	)

5381 #i‚de‡
WARN_EXITING


5382 
	#WARN_EXITING
 3

	)

5385 #i‚de‡
WARN_GLOB


5386 
	#WARN_GLOB
 4

	)

5389 #i‚de‡
WARN_IO


5390 
	#WARN_IO
 5

	)

5393 #i‚de‡
WARN_CLOSED


5394 
	#WARN_CLOSED
 6

	)

5397 #i‚de‡
WARN_EXEC


5398 
	#WARN_EXEC
 7

	)

5401 #i‚de‡
WARN_LAYER


5402 
	#WARN_LAYER
 8

	)

5405 #i‚de‡
WARN_NEWLINE


5406 
	#WARN_NEWLINE
 9

	)

5409 #i‚de‡
WARN_PIPE


5410 
	#WARN_PIPE
 10

	)

5413 #i‚de‡
WARN_UNOPENED


5414 
	#WARN_UNOPENED
 11

	)

5417 #i‚de‡
WARN_MISC


5418 
	#WARN_MISC
 12

	)

5421 #i‚de‡
WARN_NUMERIC


5422 
	#WARN_NUMERIC
 13

	)

5425 #i‚de‡
WARN_ONCE


5426 
	#WARN_ONCE
 14

	)

5429 #i‚de‡
WARN_OVERFLOW


5430 
	#WARN_OVERFLOW
 15

	)

5433 #i‚de‡
WARN_PACK


5434 
	#WARN_PACK
 16

	)

5437 #i‚de‡
WARN_PORTABLE


5438 
	#WARN_PORTABLE
 17

	)

5441 #i‚de‡
WARN_RECURSION


5442 
	#WARN_RECURSION
 18

	)

5445 #i‚de‡
WARN_REDEFINE


5446 
	#WARN_REDEFINE
 19

	)

5449 #i‚de‡
WARN_REGEXP


5450 
	#WARN_REGEXP
 20

	)

5453 #i‚de‡
WARN_SEVERE


5454 
	#WARN_SEVERE
 21

	)

5457 #i‚de‡
WARN_DEBUGGING


5458 
	#WARN_DEBUGGING
 22

	)

5461 #i‚de‡
WARN_INPLACE


5462 
	#WARN_INPLACE
 23

	)

5465 #i‚de‡
WARN_INTERNAL


5466 
	#WARN_INTERNAL
 24

	)

5469 #i‚de‡
WARN_MALLOC


5470 
	#WARN_MALLOC
 25

	)

5473 #i‚de‡
WARN_SIGNAL


5474 
	#WARN_SIGNAL
 26

	)

5477 #i‚de‡
WARN_SUBSTR


5478 
	#WARN_SUBSTR
 27

	)

5481 #i‚de‡
WARN_SYNTAX


5482 
	#WARN_SYNTAX
 28

	)

5485 #i‚de‡
WARN_AMBIGUOUS


5486 
	#WARN_AMBIGUOUS
 29

	)

5489 #i‚de‡
WARN_BAREWORD


5490 
	#WARN_BAREWORD
 30

	)

5493 #i‚de‡
WARN_DIGIT


5494 
	#WARN_DIGIT
 31

	)

5497 #i‚de‡
WARN_PARENTHESIS


5498 
	#WARN_PARENTHESIS
 32

	)

5501 #i‚de‡
WARN_PRECEDENCE


5502 
	#WARN_PRECEDENCE
 33

	)

5505 #i‚de‡
WARN_PRINTF


5506 
	#WARN_PRINTF
 34

	)

5509 #i‚de‡
WARN_PROTOTYPE


5510 
	#WARN_PROTOTYPE
 35

	)

5513 #i‚de‡
WARN_QW


5514 
	#WARN_QW
 36

	)

5517 #i‚de‡
WARN_RESERVED


5518 
	#WARN_RESERVED
 37

	)

5521 #i‚de‡
WARN_SEMICOLON


5522 
	#WARN_SEMICOLON
 38

	)

5525 #i‚de‡
WARN_TAINT


5526 
	#WARN_TAINT
 39

	)

5529 #i‚de‡
WARN_THREADS


5530 
	#WARN_THREADS
 40

	)

5533 #i‚de‡
WARN_UNINITIALIZED


5534 
	#WARN_UNINITIALIZED
 41

	)

5537 #i‚de‡
WARN_UNPACK


5538 
	#WARN_UNPACK
 42

	)

5541 #i‚de‡
WARN_UNTIE


5542 
	#WARN_UNTIE
 43

	)

5545 #i‚de‡
WARN_UTF8


5546 
	#WARN_UTF8
 44

	)

5549 #i‚de‡
WARN_VOID


5550 
	#WARN_VOID
 45

	)

5553 #i‚de‡
WARN_ASSERTIONS


5554 
	#WARN_ASSERTIONS
 46

	)

5556 #i‚de‡
∑ckWARN


5557 
	#∑ckWARN
(
a
Ë◊)

	)

5560 #i‚de‡
ckWARN


5561 #ifde‡
G_WARN_ON


5562 
	#ckWARN
(
a
Ë(
PL_dow¨n
 & 
G_WARN_ON
)

	)

5564 
	#ckWARN
(
a
Ë
PL_dow¨n


	)

5568 #i‡(
PERL_BCDVERSION
 >0x5004000Ë&& !
deföed
(
w¨√r
)

5569 #i‡
deföed
(
NEED_w¨√r
)

5570 
	$DPPP_
(
my_w¨√r
)(
U32
 
îr
, c⁄° *
∑t
, ...);

5573 
	$DPPP_
(
my_w¨√r
)(
U32
 
îr
, c⁄° *
∑t
, ...);

5576 
	#Pîl_w¨√r
 
	`DPPP_
(
my_w¨√r
)

	)

5578 #i‡
	`deföed
(
NEED_w¨√r
Ë|| deföed(
NEED_w¨√r_GLOBAL
)

5581 
	$DPPP_
(
my_w¨√r
)(
U32
 
îr
, c⁄° *
∑t
, ...)

5583 
SV
 *
sv
;

5584 
va_li°
 
¨gs
;

5586 
	`PERL_UNUSED_ARG
(
îr
);

5588 
	`va_°¨t
(
¨gs
, 
∑t
);

5589 
sv
 = 
	`v√wSVpvf
(
∑t
, &
¨gs
);

5590 
	`va_íd
(
¨gs
);

5591 
	`sv_2m‹èl
(
sv
);

5592 
	`w¨n
("%s", 
	`SvPV_nﬁí
(
sv
));

5593 
	}
}

5595 
	#w¨√r
 
Pîl_w¨√r


	)

5597 
	#Pîl_w¨√r_noc⁄ãxt
 
Pîl_w¨√r


	)

5606 #i‚de‡
STR_WITH_LEN


5607 
	#STR_WITH_LEN
(
s
Ë(†""), ((s)-1)

	)

5609 #i‚de‡
√wSVpvs


5610 
	#√wSVpvs
(
°r
Ë
	`√wSVpvn
(°∏"", (°rË- 1)

	)

5613 #i‚de‡
√wSVpvs_Êags


5614 
	#√wSVpvs_Êags
(
°r
, 
Êags
Ë
	`√wSVpvn_Êags
(°∏"", (°rË- 1, fœgs)

	)

5617 #i‚de‡
sv_ˇçvs


5618 
	#sv_ˇçvs
(
sv
, 
°r
Ë
	`sv_ˇçvn
(sv, så "", (°rË- 1)

	)

5621 #i‚de‡
sv_£çvs


5622 
	#sv_£çvs
(
sv
, 
°r
Ë
	`sv_£çvn
(sv, så "", (°rË- 1)

	)

5625 #i‚de‡
hv_„tchs


5626 
	#hv_„tchs
(
hv
, 
key
, 
lvÆ
Ë
	`hv_„tch
(hv, key "", (keyË- 1,ÜvÆ)

	)

5629 #i‚de‡
hv_°‹es


5630 
	#hv_°‹es
(
hv
, 
key
, 
vÆ
Ë
	`hv_°‹e
(hv, key "", (keyË- 1, vÆ, 0)

	)

5632 #i‚de‡
gv_„tchpvn_Êags


5633 
	#gv_„tchpvn_Êags
(
«me
, 
Àn
, 
Êags
, 
svt
Ë
	`gv_„tchpv
“ame, fœgs, svt)

	)

5636 #i‚de‡
gv_„tchpvs


5637 
	#gv_„tchpvs
(
«me
, 
Êags
, 
svt
Ë
	`gv_„tchpvn_Êags
“amê"", “ameË- 1, fœgs, svt)

	)

5640 #i‚de‡
gv_°ashpvs


5641 
	#gv_°ashpvs
(
«me
, 
Êags
Ë
	`gv_°ashpvn
“amê"", “ameË- 1, fœgs)

	)

5643 #i‚de‡
SvGETMAGIC


5644 
	#SvGETMAGIC
(
x
Ë
STMT_START
 { i‡(
	`SvGMAGICAL
(x)Ë
	`mg_gë
(x); } 
STMT_END


	)

5646 #i‚de‡
PERL_MAGIC_sv


5647 
	#PERL_MAGIC_sv
 '\0'

	)

5650 #i‚de‡
PERL_MAGIC_ovîlﬂd


5651 
	#PERL_MAGIC_ovîlﬂd
 'A'

	)

5654 #i‚de‡
PERL_MAGIC_ovîlﬂd_ñem


5655 
	#PERL_MAGIC_ovîlﬂd_ñem
 'a'

	)

5658 #i‚de‡
PERL_MAGIC_ovîlﬂd_èbÀ


5659 
	#PERL_MAGIC_ovîlﬂd_èbÀ
 'c'

	)

5662 #i‚de‡
PERL_MAGIC_bm


5663 
	#PERL_MAGIC_bm
 'B'

	)

5666 #i‚de‡
PERL_MAGIC_ªgd©a


5667 
	#PERL_MAGIC_ªgd©a
 'D'

	)

5670 #i‚de‡
PERL_MAGIC_ªgd©um


5671 
	#PERL_MAGIC_ªgd©um
 'd'

	)

5674 #i‚de‡
PERL_MAGIC_ív


5675 
	#PERL_MAGIC_ív
 'E'

	)

5678 #i‚de‡
PERL_MAGIC_ívñem


5679 
	#PERL_MAGIC_ívñem
 'e'

	)

5682 #i‚de‡
PERL_MAGIC_fm


5683 
	#PERL_MAGIC_fm
 'f'

	)

5686 #i‚de‡
PERL_MAGIC_ªgex_globÆ


5687 
	#PERL_MAGIC_ªgex_globÆ
 'g'

	)

5690 #i‚de‡
PERL_MAGIC_iß


5691 
	#PERL_MAGIC_iß
 'I'

	)

5694 #i‚de‡
PERL_MAGIC_ißñem


5695 
	#PERL_MAGIC_ißñem
 'i'

	)

5698 #i‚de‡
PERL_MAGIC_nkeys


5699 
	#PERL_MAGIC_nkeys
 'k'

	)

5702 #i‚de‡
PERL_MAGIC_dbfûe


5703 
	#PERL_MAGIC_dbfûe
 'L'

	)

5706 #i‚de‡
PERL_MAGIC_dblöe


5707 
	#PERL_MAGIC_dblöe
 'l'

	)

5710 #i‚de‡
PERL_MAGIC_muãx


5711 
	#PERL_MAGIC_muãx
 'm'

	)

5714 #i‚de‡
PERL_MAGIC_sh¨ed


5715 
	#PERL_MAGIC_sh¨ed
 'N'

	)

5718 #i‚de‡
PERL_MAGIC_sh¨ed_sˇœr


5719 
	#PERL_MAGIC_sh¨ed_sˇœr
 'n'

	)

5722 #i‚de‡
PERL_MAGIC_cﬁlx‰m


5723 
	#PERL_MAGIC_cﬁlx‰m
 'o'

	)

5726 #i‚de‡
PERL_MAGIC_tõd


5727 
	#PERL_MAGIC_tõd
 'P'

	)

5730 #i‚de‡
PERL_MAGIC_tõdñem


5731 
	#PERL_MAGIC_tõdñem
 'p'

	)

5734 #i‚de‡
PERL_MAGIC_tõdsˇœr


5735 
	#PERL_MAGIC_tõdsˇœr
 'q'

	)

5738 #i‚de‡
PERL_MAGIC_qr


5739 
	#PERL_MAGIC_qr
 'r'

	)

5742 #i‚de‡
PERL_MAGIC_sig


5743 
	#PERL_MAGIC_sig
 'S'

	)

5746 #i‚de‡
PERL_MAGIC_sigñem


5747 
	#PERL_MAGIC_sigñem
 's'

	)

5750 #i‚de‡
PERL_MAGIC_èöt


5751 
	#PERL_MAGIC_èöt
 't'

	)

5754 #i‚de‡
PERL_MAGIC_uv¨


5755 
	#PERL_MAGIC_uv¨
 'U'

	)

5758 #i‚de‡
PERL_MAGIC_uv¨_ñem


5759 
	#PERL_MAGIC_uv¨_ñem
 'u'

	)

5762 #i‚de‡
PERL_MAGIC_v°rög


5763 
	#PERL_MAGIC_v°rög
 'V'

	)

5766 #i‚de‡
PERL_MAGIC_vec


5767 
	#PERL_MAGIC_vec
 'v'

	)

5770 #i‚de‡
PERL_MAGIC_utf8


5771 
	#PERL_MAGIC_utf8
 'w'

	)

5774 #i‚de‡
PERL_MAGIC_sub°r


5775 
	#PERL_MAGIC_sub°r
 'x'

	)

5778 #i‚de‡
PERL_MAGIC_de„Àm


5779 
	#PERL_MAGIC_de„Àm
 'y'

	)

5782 #i‚de‡
PERL_MAGIC_glob


5783 
	#PERL_MAGIC_glob
 '*'

	)

5786 #i‚de‡
PERL_MAGIC_¨yÀn


5787 
	#PERL_MAGIC_¨yÀn
 '#'

	)

5790 #i‚de‡
PERL_MAGIC_pos


5791 
	#PERL_MAGIC_pos
 '.'

	)

5794 #i‚de‡
PERL_MAGIC_backªf


5795 
	#PERL_MAGIC_backªf
 '<'

	)

5798 #i‚de‡
PERL_MAGIC_ext


5799 
	#PERL_MAGIC_ext
 '~'

	)

5803 #i‚de‡
sv_ˇçvn_nomg


5804 
	#sv_ˇçvn_nomg
 
sv_ˇçvn


	)

5807 #i‚de‡
sv_ˇtsv_nomg


5808 
	#sv_ˇtsv_nomg
 
sv_ˇtsv


	)

5811 #i‚de‡
sv_£tsv_nomg


5812 
	#sv_£tsv_nomg
 
sv_£tsv


	)

5815 #i‚de‡
sv_pvn_nomg


5816 
	#sv_pvn_nomg
 
sv_pvn


	)

5819 #i‚de‡
SvIV_nomg


5820 
	#SvIV_nomg
 
SvIV


	)

5823 #i‚de‡
SvUV_nomg


5824 
	#SvUV_nomg
 
SvUV


	)

5827 #i‚de‡
sv_ˇçv_mg


5828 
	#sv_ˇçv_mg
(
sv
, 
±r
) \

5829 
STMT_START
 { \

5830 
SV
 *
TeMpSv
 = 
sv
; \

5831 
	`sv_ˇçv
(
TeMpSv
,
±r
); \

5832 
	`SvSETMAGIC
(
TeMpSv
); \

5833 } 
STMT_END


	)

5836 #i‚de‡
sv_ˇçvn_mg


5837 
	#sv_ˇçvn_mg
(
sv
, 
±r
, 
Àn
) \

5838 
STMT_START
 { \

5839 
SV
 *
TeMpSv
 = 
sv
; \

5840 
	`sv_ˇçvn
(
TeMpSv
,
±r
,
Àn
); \

5841 
	`SvSETMAGIC
(
TeMpSv
); \

5842 } 
STMT_END


	)

5845 #i‚de‡
sv_ˇtsv_mg


5846 
	#sv_ˇtsv_mg
(
dsv
, 
ssv
) \

5847 
STMT_START
 { \

5848 
SV
 *
TeMpSv
 = 
dsv
; \

5849 
	`sv_ˇtsv
(
TeMpSv
,
ssv
); \

5850 
	`SvSETMAGIC
(
TeMpSv
); \

5851 } 
STMT_END


	)

5854 #i‚de‡
sv_£tiv_mg


5855 
	#sv_£tiv_mg
(
sv
, 
i
) \

5856 
STMT_START
 { \

5857 
SV
 *
TeMpSv
 = 
sv
; \

5858 
	`sv_£tiv
(
TeMpSv
,
i
); \

5859 
	`SvSETMAGIC
(
TeMpSv
); \

5860 } 
STMT_END


	)

5863 #i‚de‡
sv_£äv_mg


5864 
	#sv_£äv_mg
(
sv
, 
num
) \

5865 
STMT_START
 { \

5866 
SV
 *
TeMpSv
 = 
sv
; \

5867 
	`sv_£äv
(
TeMpSv
,
num
); \

5868 
	`SvSETMAGIC
(
TeMpSv
); \

5869 } 
STMT_END


	)

5872 #i‚de‡
sv_£çv_mg


5873 
	#sv_£çv_mg
(
sv
, 
±r
) \

5874 
STMT_START
 { \

5875 
SV
 *
TeMpSv
 = 
sv
; \

5876 
	`sv_£çv
(
TeMpSv
,
±r
); \

5877 
	`SvSETMAGIC
(
TeMpSv
); \

5878 } 
STMT_END


	)

5881 #i‚de‡
sv_£çvn_mg


5882 
	#sv_£çvn_mg
(
sv
, 
±r
, 
Àn
) \

5883 
STMT_START
 { \

5884 
SV
 *
TeMpSv
 = 
sv
; \

5885 
	`sv_£çvn
(
TeMpSv
,
±r
,
Àn
); \

5886 
	`SvSETMAGIC
(
TeMpSv
); \

5887 } 
STMT_END


	)

5890 #i‚de‡
sv_£tsv_mg


5891 
	#sv_£tsv_mg
(
dsv
, 
ssv
) \

5892 
STMT_START
 { \

5893 
SV
 *
TeMpSv
 = 
dsv
; \

5894 
	`sv_£tsv
(
TeMpSv
,
ssv
); \

5895 
	`SvSETMAGIC
(
TeMpSv
); \

5896 } 
STMT_END


	)

5899 #i‚de‡
sv_£tuv_mg


5900 
	#sv_£tuv_mg
(
sv
, 
i
) \

5901 
STMT_START
 { \

5902 
SV
 *
TeMpSv
 = 
sv
; \

5903 
	`sv_£tuv
(
TeMpSv
,
i
); \

5904 
	`SvSETMAGIC
(
TeMpSv
); \

5905 } 
STMT_END


	)

5908 #i‚de‡
sv_u£pvn_mg


5909 
	#sv_u£pvn_mg
(
sv
, 
±r
, 
Àn
) \

5910 
STMT_START
 { \

5911 
SV
 *
TeMpSv
 = 
sv
; \

5912 
	`sv_u£pvn
(
TeMpSv
,
±r
,
Àn
); \

5913 
	`SvSETMAGIC
(
TeMpSv
); \

5914 } 
STMT_END


	)

5916 #i‚de‡
SvVSTRING_mg


5917 
	#SvVSTRING_mg
(
sv
Ë(
	`SvMAGICAL
(svË? 
	`mg_föd
(sv, 
PERL_MAGIC_v°rög
Ë: 
NULL
)

	)

5930 #i‡(
PERL_BCDVERSION
 < 0x5004000)

5934 #ñi‡(
PERL_BCDVERSION
 < 0x5008000)

5936 
	#sv_magic_p‹èbÀ
(
sv
, 
obj
, 
how
, 
«me
, 
«mÀn
) \

5937 
STMT_START
 { \

5938 
SV
 *
SvMp_sv
 = (
sv
); \

5939 *
SvMp_«me
 = (*Ë(
«me
); \

5940 
I32
 
SvMp_«mÀn
 = (
«mÀn
); \

5941 i‡(
SvMp_«me
 && 
SvMp_«mÀn
 == 0) \

5943 
MAGIC
 *
mg
; \

5944 
	`sv_magic
(
SvMp_sv
, 
obj
, 
how
, 0, 0); \

5945 
mg
 = 
	`SvMAGIC
(
SvMp_sv
); \

5946 
mg
->
mg_Àn
 = -42; \

5947 
mg
->
mg_±r
 = 
SvMp_«me
; \

5951 
	`sv_magic
(
SvMp_sv
, 
obj
, 
how
, 
SvMp_«me
, 
SvMp_«mÀn
); \

5953 } 
STMT_END


	)

5957 
	#sv_magic_p‹èbÀ
(
a
, 
b
, 
c
, 
d
, 
e
Ë
	`sv_magic
◊, b, c, d,É)

	)

5961 #ifde‡
USE_ITHREADS


5962 #i‚de‡
C›FILE


5963 
	#C›FILE
(
c
Ë((c)->
c›_fûe
)

	)

5966 #i‚de‡
C›FILEGV


5967 
	#C›FILEGV
(
c
Ë(
	`C›FILE
(cË? 
	`gv_„tchfûe
(C›FILE(c)Ë: 
NuŒgv
)

	)

5970 #i‚de‡
C›FILE_£t


5971 
	#C›FILE_£t
(
c
,
pv
Ë((c)->
c›_fûe
 = 
	`ßvïv
’v))

	)

5974 #i‚de‡
C›FILESV


5975 
	#C›FILESV
(
c
Ë(
	`C›FILE
(cË? 
	`GvSV
(
	`gv_„tchfûe
(C›FILE(c))Ë: 
NuŒsv
)

	)

5978 #i‚de‡
C›FILEAV


5979 
	#C›FILEAV
(
c
Ë(
	`C›FILE
(cË? 
	`GvAV
(
	`gv_„tchfûe
(C›FILE(c))Ë: 
NuŒav
)

	)

5982 #i‚de‡
C›STASHPV


5983 
	#C›STASHPV
(
c
Ë((c)->
c›_°ashpv
)

	)

5986 #i‚de‡
C›STASHPV_£t


5987 
	#C›STASHPV_£t
(
c
,
pv
Ë((c)->
c›_°ashpv
 = (’vË? 
	`ßvïv
’vË: 
NuŒch
))

	)

5990 #i‚de‡
C›STASH


5991 
	#C›STASH
(
c
Ë(
	`C›STASHPV
(cË? 
	`gv_°ashpv
(C›STASHPV(c),
GV_ADD
Ë: 
NuŒhv
)

	)

5994 #i‚de‡
C›STASH_£t


5995 
	#C›STASH_£t
(
c
,
hv
Ë
	`C›STASHPV_£t
(c, (hvË? 
	`HvNAME
(hvË: 
NuŒch
)

	)

5998 #i‚de‡
C›STASH_eq


5999 
	#C›STASH_eq
(
c
,
hv
Ë((hvË&& (
	`C›STASHPV
(cË=
	`HvNAME
(hv) \

6000 || (
	`C›STASHPV
(
c
Ë&& 
	`HvNAME
(
hv
) \

6001 && 
	`°rEQ
(
	`C›STASHPV
(
c
), 
	`HvNAME
(
hv
)))))

	)

6005 #i‚de‡
C›FILEGV


6006 
	#C›FILEGV
(
c
Ë((c)->
c›_fûegv
)

	)

6009 #i‚de‡
C›FILEGV_£t


6010 
	#C›FILEGV_£t
(
c
,
gv
Ë((c)->
c›_fûegv
 = (
GV
*)
	`SvREFCNT_öc
(gv))

	)

6013 #i‚de‡
C›FILE_£t


6014 
	#C›FILE_£t
(
c
,
pv
Ë
	`C›FILEGV_£t
((c), 
	`gv_„tchfûe
’v))

	)

6017 #i‚de‡
C›FILESV


6018 
	#C›FILESV
(
c
Ë(
	`C›FILEGV
(cË? 
	`GvSV
(C›FILEGV(c)Ë: 
NuŒsv
)

	)

6021 #i‚de‡
C›FILEAV


6022 
	#C›FILEAV
(
c
Ë(
	`C›FILEGV
(cË? 
	`GvAV
(C›FILEGV(c)Ë: 
NuŒav
)

	)

6025 #i‚de‡
C›FILE


6026 
	#C›FILE
(
c
Ë(
	`C›FILESV
(cË? 
	`SvPVX
(C›FILESV(c)Ë: 
NuŒch
)

	)

6029 #i‚de‡
C›STASH


6030 
	#C›STASH
(
c
Ë((c)->
c›_°ash
)

	)

6033 #i‚de‡
C›STASH_£t


6034 
	#C›STASH_£t
(
c
,
hv
Ë((c)->
c›_°ash
 = (hv))

	)

6037 #i‚de‡
C›STASHPV


6038 
	#C›STASHPV
(
c
Ë(
	`C›STASH
(cË? 
	`HvNAME
(C›STASH(c)Ë: 
NuŒch
)

	)

6041 #i‚de‡
C›STASHPV_£t


6042 
	#C›STASHPV_£t
(
c
,
pv
Ë
	`C›STASH_£t
((c), 
	`gv_°ashpv
’v,
GV_ADD
))

	)

6045 #i‚de‡
C›STASH_eq


6046 
	#C›STASH_eq
(
c
,
hv
Ë(
	`C›STASH
(cË=(hv))

	)

6050 #i‚de‡
IN_PERL_COMPILETIME


6051 
	#IN_PERL_COMPILETIME
 (
PL_curc›
 =&
PL_compûög
)

	)

6054 #i‚de‡
IN_LOCALE_RUNTIME


6055 
	#IN_LOCALE_RUNTIME
 (
PL_curc›
->
›_¥iv©e
 & 
HINT_LOCALE
)

	)

6058 #i‚de‡
IN_LOCALE_COMPILETIME


6059 
	#IN_LOCALE_COMPILETIME
 (
PL_höts
 & 
HINT_LOCALE
)

	)

6062 #i‚de‡
IN_LOCALE


6063 
	#IN_LOCALE
 (
IN_PERL_COMPILETIME
 ? 
IN_LOCALE_COMPILETIME
 : 
IN_LOCALE_RUNTIME
)

	)

6065 #i‚de‡
IS_NUMBER_IN_UV


6066 
	#IS_NUMBER_IN_UV
 0x01

	)

6069 #i‚de‡
IS_NUMBER_GREATER_THAN_UV_MAX


6070 
	#IS_NUMBER_GREATER_THAN_UV_MAX
 0x02

	)

6073 #i‚de‡
IS_NUMBER_NOT_INT


6074 
	#IS_NUMBER_NOT_INT
 0x04

	)

6077 #i‚de‡
IS_NUMBER_NEG


6078 
	#IS_NUMBER_NEG
 0x08

	)

6081 #i‚de‡
IS_NUMBER_INFINITY


6082 
	#IS_NUMBER_INFINITY
 0x10

	)

6085 #i‚de‡
IS_NUMBER_NAN


6086 
	#IS_NUMBER_NAN
 0x20

	)

6088 #i‚de‡
GROK_NUMERIC_RADIX


6089 
	#GROK_NUMERIC_RADIX
(
•
, 
£nd
Ë
	`grok_numîic_ødix
(•, síd)

	)

6091 #i‚de‡
PERL_SCAN_GREATER_THAN_UV_MAX


6092 
	#PERL_SCAN_GREATER_THAN_UV_MAX
 0x02

	)

6095 #i‚de‡
PERL_SCAN_SILENT_ILLDIGIT


6096 
	#PERL_SCAN_SILENT_ILLDIGIT
 0x04

	)

6099 #i‚de‡
PERL_SCAN_ALLOW_UNDERSCORES


6100 
	#PERL_SCAN_ALLOW_UNDERSCORES
 0x01

	)

6103 #i‚de‡
PERL_SCAN_DISALLOW_PREFIX


6104 
	#PERL_SCAN_DISALLOW_PREFIX
 0x02

	)

6107 #i‚de‡
grok_numîic_ødix


6108 #i‡
deföed
(
NEED_grok_numîic_ødix
)

6109 
boﬁ
 
	$DPPP_
(
my_grok_numîic_ødix
)(
pTHX_
 c⁄° ** 
•
, c⁄° * 
£nd
);

6112 
boﬁ
 
	$DPPP_
(
my_grok_numîic_ødix
)(
pTHX_
 c⁄° ** 
•
, c⁄° * 
£nd
);

6115 #ifde‡
grok_numîic_ødix


6116 #unde‡
grok_numîic_ødix


6118 
	#grok_numîic_ødix
(
a
,
b
Ë
	`DPPP_
(
my_grok_numîic_ødix
)(
aTHX_
á,b)

	)

6119 
	#Pîl_grok_numîic_ødix
 
	`DPPP_
(
my_grok_numîic_ødix
)

	)

6121 #i‡
	`deföed
(
NEED_grok_numîic_ødix
Ë|| deföed(
NEED_grok_numîic_ødix_GLOBAL
)

6122 
boﬁ


6123 
	$DPPP_
(
my_grok_numîic_ødix
)(
pTHX_
 c⁄° **
•
, c⁄° *
£nd
)

6125 #ifde‡
USE_LOCALE_NUMERIC


6126 #ifde‡
PL_numîic_ødix_sv


6127 i‡(
PL_numîic_ødix_sv
 && 
IN_LOCALE
) {

6128 
STRLEN
 
Àn
;

6129 * 
ødix
 = 
	`SvPV
(
PL_numîic_ødix_sv
, 
Àn
);

6130 i‡(*
•
 + 
Àn
 <
£nd
 && 
	`memEQ
(*•, 
ødix
,Üen)) {

6131 *
•
 +
Àn
;

6132  
TRUE
;

6139 
	~<loˇÀ.h
>

6140 
dTHR
;

6141 
lc⁄v
 *
lc
 = 
	`loˇÀc⁄v
();

6142 *
ødix
 = 
lc
->
decimÆ_poöt
;

6143 i‡(
ødix
 && 
IN_LOCALE
) {

6144 
STRLEN
 
Àn
 = 
	`°æí
(
ødix
);

6145 i‡(*
•
 + 
Àn
 <
£nd
 && 
	`memEQ
(*•, 
ødix
,Üen)) {

6146 *
•
 +
Àn
;

6147  
TRUE
;

6154 i‡(*
•
 < 
£nd
 && **sp == '.') {

6155 ++*
•
;

6156  
TRUE
;

6158  
FALSE
;

6159 
	}
}

6163 #i‚de‡
grok_numbî


6164 #i‡
deföed
(
NEED_grok_numbî
)

6165 
	$DPPP_
(
my_grok_numbî
)(
pTHX_
 c⁄° * 
pv
, 
STRLEN
 
Àn
, 
UV
 * 
vÆuï
);

6168 
	$DPPP_
(
my_grok_numbî
)(
pTHX_
 c⁄° * 
pv
, 
STRLEN
 
Àn
, 
UV
 * 
vÆuï
);

6171 #ifde‡
grok_numbî


6172 #unde‡
grok_numbî


6174 
	#grok_numbî
(
a
,
b
,
c
Ë
	`DPPP_
(
my_grok_numbî
)(
aTHX_
á,b,c)

	)

6175 
	#Pîl_grok_numbî
 
	`DPPP_
(
my_grok_numbî
)

	)

6177 #i‡
	`deföed
(
NEED_grok_numbî
Ë|| deföed(
NEED_grok_numbî_GLOBAL
)

6179 
	$DPPP_
(
my_grok_numbî
)(
pTHX_
 c⁄° *
pv
, 
STRLEN
 
Àn
, 
UV
 *
vÆuï
)

6181 c⁄° *
s
 = 
pv
;

6182 c⁄° *
£nd
 = 
pv
 + 
Àn
;

6183 c⁄° 
UV
 
max_div_10
 = 
UV_MAX
 / 10;

6184 c⁄° 
max_mod_10
 = 
UV_MAX
 % 10;

6185 
numty≥
 = 0;

6186 
ßwöf
 = 0;

6187 
ßw«n
 = 0;

6189 
s
 < 
£nd
 && 
	`isSPACE
(*s))

6190 
s
++;

6191 i‡(
s
 =
£nd
) {

6193 } i‡(*
s
 == '-') {

6194 
s
++;

6195 
numty≥
 = 
IS_NUMBER_NEG
;

6197 i‡(*
s
 == '+')

6198 
s
++;

6200 i‡(
s
 =
£nd
)

6204 i‡(
	`isDIGIT
(*
s
)) {

6207 
UV
 
vÆue
 = *
s
 - '0';

6213 i‡(++
s
 < 
£nd
) {

6214 
digô
 = *
s
 - '0';

6215 i‡(
digô
 >= 0 && digit <= 9) {

6216 
vÆue
 = vÆuê* 10 + 
digô
;

6217 i‡(++
s
 < 
£nd
) {

6218 
digô
 = *
s
 - '0';

6219 i‡(
digô
 >= 0 && digit <= 9) {

6220 
vÆue
 = vÆuê* 10 + 
digô
;

6221 i‡(++
s
 < 
£nd
) {

6222 
digô
 = *
s
 - '0';

6223 i‡(
digô
 >= 0 && digit <= 9) {

6224 
vÆue
 = vÆuê* 10 + 
digô
;

6225 i‡(++
s
 < 
£nd
) {

6226 
digô
 = *
s
 - '0';

6227 i‡(
digô
 >= 0 && digit <= 9) {

6228 
vÆue
 = vÆuê* 10 + 
digô
;

6229 i‡(++
s
 < 
£nd
) {

6230 
digô
 = *
s
 - '0';

6231 i‡(
digô
 >= 0 && digit <= 9) {

6232 
vÆue
 = vÆuê* 10 + 
digô
;

6233 i‡(++
s
 < 
£nd
) {

6234 
digô
 = *
s
 - '0';

6235 i‡(
digô
 >= 0 && digit <= 9) {

6236 
vÆue
 = vÆuê* 10 + 
digô
;

6237 i‡(++
s
 < 
£nd
) {

6238 
digô
 = *
s
 - '0';

6239 i‡(
digô
 >= 0 && digit <= 9) {

6240 
vÆue
 = vÆuê* 10 + 
digô
;

6241 i‡(++
s
 < 
£nd
) {

6242 
digô
 = *
s
 - '0';

6243 i‡(
digô
 >= 0 && digit <= 9) {

6244 
vÆue
 = vÆuê* 10 + 
digô
;

6245 i‡(++
s
 < 
£nd
) {

6248 
digô
 = *
s
 - '0';

6249 
digô
 >= 0 && digit <= 9

6250 && (
vÆue
 < 
max_div_10


6251 || (
vÆue
 =
max_div_10


6252 && 
digô
 <
max_mod_10
))) {

6253 
vÆue
 = vÆuê* 10 + 
digô
;

6254 i‡(++
s
 < 
£nd
)

6255 
digô
 = *
s
 - '0';

6259 i‡(
digô
 >= 0 && digit <= 9

6260 && (
s
 < 
£nd
)) {

6265 
s
++;

6266 } 
s
 < 
£nd
 && 
	`isDIGIT
(*s));

6267 
numty≥
 |=

6268 
IS_NUMBER_GREATER_THAN_UV_MAX
;

6269 
skù_vÆue
;

6288 
numty≥
 |
IS_NUMBER_IN_UV
;

6289 i‡(
vÆuï
)

6290 *
vÆuï
 = 
vÆue
;

6292 
skù_vÆue
:

6293 i‡(
	`GROK_NUMERIC_RADIX
(&
s
, 
£nd
)) {

6294 
numty≥
 |
IS_NUMBER_NOT_INT
;

6295 
s
 < 
£nd
 && 
	`isDIGIT
(*s))

6296 
s
++;

6299 i‡(
	`GROK_NUMERIC_RADIX
(&
s
, 
£nd
)) {

6300 
numty≥
 |
IS_NUMBER_NOT_INT
 | 
IS_NUMBER_IN_UV
;

6302 i‡(
s
 < 
£nd
 && 
	`isDIGIT
(*s)) {

6304 
s
++;

6305 } 
s
 < 
£nd
 && 
	`isDIGIT
(*s));

6306 i‡(
vÆuï
) {

6308 *
vÆuï
 = 0;

6313 } i‡(*
s
 == 'I' || *s == 'i') {

6314 
s
++; i‡(†=
£nd
 || (*s != 'N' && *s != 'n'))  0;

6315 
s
++; i‡(†=
£nd
 || (*s != 'F' && *s != 'f'))  0;

6316 
s
++; i‡(†< 
£nd
 && (*s == 'I' || *s == 'i')) {

6317 
s
++; i‡(†=
£nd
 || (*s != 'N' && *s != 'n'))  0;

6318 
s
++; i‡(†=
£nd
 || (*s != 'I' && *s != 'i'))  0;

6319 
s
++; i‡(†=
£nd
 || (*s != 'T' && *s != 't'))  0;

6320 
s
++; i‡(†=
£nd
 || (*s != 'Y' && *s != 'y'))  0;

6321 
s
++;

6323 
ßwöf
 = 1;

6324 } i‡(*
s
 == 'N' || *s == 'n') {

6326 
s
++; i‡(†=
£nd
 || (*s != 'A' && *s != 'a'))  0;

6327 
s
++; i‡(†=
£nd
 || (*s != 'N' && *s != 'n'))  0;

6328 
s
++;

6329 
ßw«n
 = 1;

6333 i‡(
ßwöf
) {

6334 
numty≥
 &
IS_NUMBER_NEG
;

6335 
numty≥
 |
IS_NUMBER_INFINITY
 | 
IS_NUMBER_NOT_INT
;

6336 } i‡(
ßw«n
) {

6337 
numty≥
 &
IS_NUMBER_NEG
;

6338 
numty≥
 |
IS_NUMBER_NAN
 | 
IS_NUMBER_NOT_INT
;

6339 } i‡(
s
 < 
£nd
) {

6341 i‡(*
s
 == 'e' || *s == 'E') {

6343 
numty≥
 &
IS_NUMBER_NEG
;

6344 
numty≥
 |
IS_NUMBER_NOT_INT
;

6345 
s
++;

6346 i‡(
s
 < 
£nd
 && (*s == '-' || *s == '+'))

6347 
s
++;

6348 i‡(
s
 < 
£nd
 && 
	`isDIGIT
(*s)) {

6350 
s
++;

6351 } 
s
 < 
£nd
 && 
	`isDIGIT
(*s));

6357 
s
 < 
£nd
 && 
	`isSPACE
(*s))

6358 
s
++;

6359 i‡(
s
 >
£nd
)

6360  
numty≥
;

6361 i‡(
Àn
 =10 && 
	`memEQ
(
pv
, "0 butÅrue", 10)) {

6362 i‡(
vÆuï
)

6363 *
vÆuï
 = 0;

6364  
IS_NUMBER_IN_UV
;

6367 
	}
}

6377 #i‚de‡
grok_bö


6378 #i‡
deföed
(
NEED_grok_bö
)

6379 
UV
 
	$DPPP_
(
my_grok_bö
)(
pTHX_
 c⁄° * 
°¨t
, 
STRLEN
 * 
Àn_p
, 
I32
 * 
Êags
, 
NV
 * 
ªsu…
);

6382 
UV
 
	$DPPP_
(
my_grok_bö
)(
pTHX_
 c⁄° * 
°¨t
, 
STRLEN
 * 
Àn_p
, 
I32
 * 
Êags
, 
NV
 * 
ªsu…
);

6385 #ifde‡
grok_bö


6386 #unde‡
grok_bö


6388 
	#grok_bö
(
a
,
b
,
c
,
d
Ë
	`DPPP_
(
my_grok_bö
)(
aTHX_
á,b,c,d)

	)

6389 
	#Pîl_grok_bö
 
	`DPPP_
(
my_grok_bö
)

	)

6391 #i‡
	`deföed
(
NEED_grok_bö
Ë|| deföed(
NEED_grok_bö_GLOBAL
)

6392 
UV


6393 
	$DPPP_
(
my_grok_bö
)(
pTHX_
 c⁄° *
°¨t
, 
STRLEN
 *
Àn_p
, 
I32
 *
Êags
, 
NV
 *
ªsu…
)

6395 c⁄° *
s
 = 
°¨t
;

6396 
STRLEN
 
Àn
 = *
Àn_p
;

6397 
UV
 
vÆue
 = 0;

6398 
NV
 
vÆue_nv
 = 0;

6400 c⁄° 
UV
 
max_div_2
 = 
UV_MAX
 / 2;

6401 
boﬁ
 
Ælow_undîsc‹es
 = *
Êags
 & 
PERL_SCAN_ALLOW_UNDERSCORES
;

6402 
boﬁ
 
ovîÊowed
 = 
FALSE
;

6404 i‡(!(*
Êags
 & 
PERL_SCAN_DISALLOW_PREFIX
)) {

6408 i‡(
Àn
 >= 1) {

6409 i‡(
s
[0] == 'b') {

6410 
s
++;

6411 
Àn
--;

6413 i‡(
Àn
 >2 && 
s
[0] == '0' && s[1] == 'b') {

6414 
s
+=2;

6415 
Àn
-=2;

6420 ; 
Àn
-- && *
s
; s++) {

6421 
bô
 = *
s
;

6422 i‡(
bô
 == '0' || bit == '1') {

6426 
ªdo
:

6427 i‡(!
ovîÊowed
) {

6428 i‡(
vÆue
 <
max_div_2
) {

6429 
vÆue
 = (vÆuê<< 1Ë| (
bô
 - '0');

6433 
	`w¨n
("Integer overflow in binaryÇumber");

6434 
ovîÊowed
 = 
TRUE
;

6435 
vÆue_nv
 = (
NV
Ë
vÆue
;

6437 
vÆue_nv
 *= 2.0;

6444 
vÆue_nv
 +(
NV
)(
bô
 - '0');

6447 i‡(
bô
 ='_' && 
Àn
 && 
Ælow_undîsc‹es
 && (bô = 
s
[1])

6448 && (
bô
 == '0' || bit == '1'))

6450 --
Àn
;

6451 ++
s
;

6452 
ªdo
;

6454 i‡(!(*
Êags
 & 
PERL_SCAN_SILENT_ILLDIGIT
))

6455 
	`w¨n
("IŒegÆ bö¨y digô '%c' ign‹ed", *
s
);

6459 i‡––
ovîÊowed
 && 
vÆue_nv
 > 4294967295.0)

6460 #i‡
UVSIZE
 > 4

6461 || (!
ovîÊowed
 && 
vÆue
 > 0xffffffff )

6464 
	`w¨n
("BinaryÇumber > 0b11111111111111111111111111111111Çon-portable");

6466 *
Àn_p
 = 
s
 - 
°¨t
;

6467 i‡(!
ovîÊowed
) {

6468 *
Êags
 = 0;

6469  
vÆue
;

6471 *
Êags
 = 
PERL_SCAN_GREATER_THAN_UV_MAX
;

6472 i‡(
ªsu…
)

6473 *
ªsu…
 = 
vÆue_nv
;

6474  
UV_MAX
;

6475 
	}
}

6479 #i‚de‡
grok_hex


6480 #i‡
deföed
(
NEED_grok_hex
)

6481 
UV
 
	$DPPP_
(
my_grok_hex
)(
pTHX_
 c⁄° * 
°¨t
, 
STRLEN
 * 
Àn_p
, 
I32
 * 
Êags
, 
NV
 * 
ªsu…
);

6484 
UV
 
	$DPPP_
(
my_grok_hex
)(
pTHX_
 c⁄° * 
°¨t
, 
STRLEN
 * 
Àn_p
, 
I32
 * 
Êags
, 
NV
 * 
ªsu…
);

6487 #ifde‡
grok_hex


6488 #unde‡
grok_hex


6490 
	#grok_hex
(
a
,
b
,
c
,
d
Ë
	`DPPP_
(
my_grok_hex
)(
aTHX_
á,b,c,d)

	)

6491 
	#Pîl_grok_hex
 
	`DPPP_
(
my_grok_hex
)

	)

6493 #i‡
	`deföed
(
NEED_grok_hex
Ë|| deföed(
NEED_grok_hex_GLOBAL
)

6494 
UV


6495 
	$DPPP_
(
my_grok_hex
)(
pTHX_
 c⁄° *
°¨t
, 
STRLEN
 *
Àn_p
, 
I32
 *
Êags
, 
NV
 *
ªsu…
)

6497 c⁄° *
s
 = 
°¨t
;

6498 
STRLEN
 
Àn
 = *
Àn_p
;

6499 
UV
 
vÆue
 = 0;

6500 
NV
 
vÆue_nv
 = 0;

6502 c⁄° 
UV
 
max_div_16
 = 
UV_MAX
 / 16;

6503 
boﬁ
 
Ælow_undîsc‹es
 = *
Êags
 & 
PERL_SCAN_ALLOW_UNDERSCORES
;

6504 
boﬁ
 
ovîÊowed
 = 
FALSE
;

6505 c⁄° *
xdigô
;

6507 i‡(!(*
Êags
 & 
PERL_SCAN_DISALLOW_PREFIX
)) {

6511 i‡(
Àn
 >= 1) {

6512 i‡(
s
[0] == 'x') {

6513 
s
++;

6514 
Àn
--;

6516 i‡(
Àn
 >2 && 
s
[0] == '0' && s[1] == 'x') {

6517 
s
+=2;

6518 
Àn
-=2;

6523 ; 
Àn
-- && *
s
; s++) {

6524 
xdigô
 = 
	`°rchr
((*Ë
PL_hexdigô
, *
s
);

6525 i‡(
xdigô
) {

6529 
ªdo
:

6530 i‡(!
ovîÊowed
) {

6531 i‡(
vÆue
 <
max_div_16
) {

6532 
vÆue
 = (vÆuê<< 4Ë| ((
xdigô
 - 
PL_hexdigô
) & 15);

6535 
	`w¨n
("Integer overflow in hexadecimalÇumber");

6536 
ovîÊowed
 = 
TRUE
;

6537 
vÆue_nv
 = (
NV
Ë
vÆue
;

6539 
vÆue_nv
 *= 16.0;

6546 
vÆue_nv
 +(
NV
)((
xdigô
 - 
PL_hexdigô
) & 15);

6549 i‡(*
s
 ='_' && 
Àn
 && 
Ælow_undîsc‹es
 && s[1]

6550 && (
xdigô
 = 
	`°rchr
((*Ë
PL_hexdigô
, 
s
[1])))

6552 --
Àn
;

6553 ++
s
;

6554 
ªdo
;

6556 i‡(!(*
Êags
 & 
PERL_SCAN_SILENT_ILLDIGIT
))

6557 
	`w¨n
("IŒegÆ hexadecimÆ digô '%c' ign‹ed", *
s
);

6561 i‡––
ovîÊowed
 && 
vÆue_nv
 > 4294967295.0)

6562 #i‡
UVSIZE
 > 4

6563 || (!
ovîÊowed
 && 
vÆue
 > 0xffffffff )

6566 
	`w¨n
("HexadecimalÇumber > 0xffffffffÇon-portable");

6568 *
Àn_p
 = 
s
 - 
°¨t
;

6569 i‡(!
ovîÊowed
) {

6570 *
Êags
 = 0;

6571  
vÆue
;

6573 *
Êags
 = 
PERL_SCAN_GREATER_THAN_UV_MAX
;

6574 i‡(
ªsu…
)

6575 *
ªsu…
 = 
vÆue_nv
;

6576  
UV_MAX
;

6577 
	}
}

6581 #i‚de‡
grok_o˘


6582 #i‡
deföed
(
NEED_grok_o˘
)

6583 
UV
 
	$DPPP_
(
my_grok_o˘
)(
pTHX_
 c⁄° * 
°¨t
, 
STRLEN
 * 
Àn_p
, 
I32
 * 
Êags
, 
NV
 * 
ªsu…
);

6586 
UV
 
	$DPPP_
(
my_grok_o˘
)(
pTHX_
 c⁄° * 
°¨t
, 
STRLEN
 * 
Àn_p
, 
I32
 * 
Êags
, 
NV
 * 
ªsu…
);

6589 #ifde‡
grok_o˘


6590 #unde‡
grok_o˘


6592 
	#grok_o˘
(
a
,
b
,
c
,
d
Ë
	`DPPP_
(
my_grok_o˘
)(
aTHX_
á,b,c,d)

	)

6593 
	#Pîl_grok_o˘
 
	`DPPP_
(
my_grok_o˘
)

	)

6595 #i‡
	`deföed
(
NEED_grok_o˘
Ë|| deföed(
NEED_grok_o˘_GLOBAL
)

6596 
UV


6597 
	$DPPP_
(
my_grok_o˘
)(
pTHX_
 c⁄° *
°¨t
, 
STRLEN
 *
Àn_p
, 
I32
 *
Êags
, 
NV
 *
ªsu…
)

6599 c⁄° *
s
 = 
°¨t
;

6600 
STRLEN
 
Àn
 = *
Àn_p
;

6601 
UV
 
vÆue
 = 0;

6602 
NV
 
vÆue_nv
 = 0;

6604 c⁄° 
UV
 
max_div_8
 = 
UV_MAX
 / 8;

6605 
boﬁ
 
Ælow_undîsc‹es
 = *
Êags
 & 
PERL_SCAN_ALLOW_UNDERSCORES
;

6606 
boﬁ
 
ovîÊowed
 = 
FALSE
;

6608 ; 
Àn
-- && *
s
; s++) {

6611 
digô
 = *
s
 - '0';

6612 i‡(
digô
 >= 0 && digit <= 7) {

6616 
ªdo
:

6617 i‡(!
ovîÊowed
) {

6618 i‡(
vÆue
 <
max_div_8
) {

6619 
vÆue
 = (vÆuê<< 3Ë| 
digô
;

6623 
	`w¨n
("Integer overflow in octalÇumber");

6624 
ovîÊowed
 = 
TRUE
;

6625 
vÆue_nv
 = (
NV
Ë
vÆue
;

6627 
vÆue_nv
 *= 8.0;

6634 
vÆue_nv
 +(
NV
)
digô
;

6637 i‡(
digô
 =('_' - '0'Ë&& 
Àn
 && 
Ælow_undîsc‹es


6638 && (
digô
 = 
s
[1] - '0') && (digit >= 0 && digit <= 7))

6640 --
Àn
;

6641 ++
s
;

6642 
ªdo
;

6647 i‡(
digô
 == 8 || digit == 9) {

6648 i‡(!(*
Êags
 & 
PERL_SCAN_SILENT_ILLDIGIT
))

6649 
	`w¨n
("IŒegÆ o˘Æ digô '%c' ign‹ed", *
s
);

6654 i‡––
ovîÊowed
 && 
vÆue_nv
 > 4294967295.0)

6655 #i‡
UVSIZE
 > 4

6656 || (!
ovîÊowed
 && 
vÆue
 > 0xffffffff )

6659 
	`w¨n
("OctalÇumber > 037777777777Çon-portable");

6661 *
Àn_p
 = 
s
 - 
°¨t
;

6662 i‡(!
ovîÊowed
) {

6663 *
Êags
 = 0;

6664  
vÆue
;

6666 *
Êags
 = 
PERL_SCAN_GREATER_THAN_UV_MAX
;

6667 i‡(
ªsu…
)

6668 *
ªsu…
 = 
vÆue_nv
;

6669  
UV_MAX
;

6670 
	}
}

6674 #i‡!
deföed
(
my_¢¥ötf
)

6675 #i‡
deföed
(
NEED_my_¢¥ötf
)

6676 
	$DPPP_
(
my_my_¢¥ötf
)(* 
buf„r
, c⁄° 
Size_t
 
Àn
, c⁄° * 
f‹m©
, ...);

6679 
	$DPPP_
(
my_my_¢¥ötf
)(* 
buf„r
, c⁄° 
Size_t
 
Àn
, c⁄° * 
f‹m©
, ...);

6682 
	#my_¢¥ötf
 
	`DPPP_
(
my_my_¢¥ötf
)

	)

6683 
	#Pîl_my_¢¥ötf
 
	`DPPP_
(
my_my_¢¥ötf
)

	)

6685 #i‡
	`deföed
(
NEED_my_¢¥ötf
Ë|| deföed(
NEED_my_¢¥ötf_GLOBAL
)

6688 
	$DPPP_
(
my_my_¢¥ötf
)(*
buf„r
, c⁄° 
Size_t
 
Àn
, c⁄° *
f‹m©
, ...)

6690 
dTHX
;

6691 
ªtvÆ
;

6692 
va_li°
 
≠
;

6693 
	`va_°¨t
(
≠
, 
f‹m©
);

6694 #ifde‡
HAS_VSNPRINTF


6695 
ªtvÆ
 = 
	`v¢¥ötf
(
buf„r
, 
Àn
, 
f‹m©
, 
≠
);

6697 
ªtvÆ
 = 
	`v•rötf
(
buf„r
, 
f‹m©
, 
≠
);

6699 
	`va_íd
(
≠
);

6700 i‡(
ªtvÆ
 < 0 || (
Àn
 > 0 && (
Size_t
)retval >=Üen))

6701 
	`Pîl_¸ﬂk
(
aTHX_
 "panic: my_snprintf buffer overflow");

6702  
ªtvÆ
;

6703 
	}
}

6708 #i‡!
deföed
(
my_•rötf
)

6709 #i‡
deföed
(
NEED_my_•rötf
)

6710 
	$DPPP_
(
my_my_•rötf
)(* 
buf„r
, c⁄° * 
∑t
, ...);

6713 
	$DPPP_
(
my_my_•rötf
)(* 
buf„r
, c⁄° * 
∑t
, ...);

6716 
	#my_•rötf
 
	`DPPP_
(
my_my_•rötf
)

	)

6717 
	#Pîl_my_•rötf
 
	`DPPP_
(
my_my_•rötf
)

	)

6719 #i‡
	`deföed
(
NEED_my_•rötf
Ë|| deföed(
NEED_my_•rötf_GLOBAL
)

6722 
	$DPPP_
(
my_my_•rötf
)(*
buf„r
, c⁄° * 
∑t
, ...)

6724 
va_li°
 
¨gs
;

6725 
	`va_°¨t
(
¨gs
, 
∑t
);

6726 
	`v•rötf
(
buf„r
, 
∑t
, 
¨gs
);

6727 
	`va_íd
(
¨gs
);

6728  
	`°æí
(
buf„r
);

6729 
	}
}

6734 #ifde‡
NO_XSLOCKS


6735 #ifde‡
dJMPENV


6736 
	#dXCPT
 
dJMPENV
; 
rEtV
 = 0

	)

6737 
	#XCPT_TRY_START
 
	`JMPENV_PUSH
(
rEtV
); i‡‘EtV =0)

	)

6738 
	#XCPT_TRY_END
 
JMPENV_POP
;

	)

6739 
	#XCPT_CATCH
 i‡(
rEtV
 !0)

	)

6740 
	#XCPT_RETHROW
 
	`JMPENV_JUMP
(
rEtV
)

	)

6742 
	#dXCPT
 
Sigjmp_buf
 
ﬁdTOP
; 
rEtV
 = 0

	)

6743 
	#XCPT_TRY_START
 
	`C›y
(
t›_ív
, 
ﬁdTOP
, 1, 
Sigjmp_buf
); 
rEtV
 = 
	`Sig£tjmp
—›_ív, 1); i‡‘EtV =0)

	)

6744 
	#XCPT_TRY_END
 
	`C›y
(
ﬁdTOP
, 
t›_ív
, 1, 
Sigjmp_buf
);

	)

6745 
	#XCPT_CATCH
 i‡(
rEtV
 !0)

	)

6746 
	#XCPT_RETHROW
 
	`Sigl⁄gjmp
(
t›_ív
, 
rEtV
)

	)

6750 #i‡!
deföed
(
my_°æˇt
)

6751 #i‡
deföed
(
NEED_my_°æˇt
)

6752 
Size_t
 
	$DPPP_
(
my_my_°æˇt
)(* 
d°
, c⁄° * 
§c
, 
Size_t
 
size
);

6755 
Size_t
 
	$DPPP_
(
my_my_°æˇt
)(* 
d°
, c⁄° * 
§c
, 
Size_t
 
size
);

6758 
	#my_°æˇt
 
	`DPPP_
(
my_my_°æˇt
)

	)

6759 
	#Pîl_my_°æˇt
 
	`DPPP_
(
my_my_°æˇt
)

	)

6761 #i‡
	`deföed
(
NEED_my_°æˇt
Ë|| deföed(
NEED_my_°æˇt_GLOBAL
)

6763 
Size_t


6764 
	$DPPP_
(
my_my_°æˇt
)(*
d°
, c⁄° *
§c
, 
Size_t
 
size
)

6766 
Size_t
 
u£d
, 
Àngth
, 
c›y
;

6768 
u£d
 = 
	`°æí
(
d°
);

6769 
Àngth
 = 
	`°æí
(
§c
);

6770 i‡(
size
 > 0 && 
u£d
 < size - 1) {

6771 
c›y
 = (
Àngth
 >
size
 - 
u£d
) ? size - used - 1 :Üength;

6772 
	`mem˝y
(
d°
 + 
u£d
, 
§c
, 
c›y
);

6773 
d°
[
u£d
 + 
c›y
] = '\0';

6775  
u£d
 + 
Àngth
;

6776 
	}
}

6780 #i‡!
deföed
(
my_°æ˝y
)

6781 #i‡
deföed
(
NEED_my_°æ˝y
)

6782 
Size_t
 
	$DPPP_
(
my_my_°æ˝y
)(* 
d°
, c⁄° * 
§c
, 
Size_t
 
size
);

6785 
Size_t
 
	$DPPP_
(
my_my_°æ˝y
)(* 
d°
, c⁄° * 
§c
, 
Size_t
 
size
);

6788 
	#my_°æ˝y
 
	`DPPP_
(
my_my_°æ˝y
)

	)

6789 
	#Pîl_my_°æ˝y
 
	`DPPP_
(
my_my_°æ˝y
)

	)

6791 #i‡
	`deföed
(
NEED_my_°æ˝y
Ë|| deföed(
NEED_my_°æ˝y_GLOBAL
)

6793 
Size_t


6794 
	$DPPP_
(
my_my_°æ˝y
)(*
d°
, c⁄° *
§c
, 
Size_t
 
size
)

6796 
Size_t
 
Àngth
, 
c›y
;

6798 
Àngth
 = 
	`°æí
(
§c
);

6799 i‡(
size
 > 0) {

6800 
c›y
 = (
Àngth
 >
size
) ? size - 1 :Üength;

6801 
	`mem˝y
(
d°
, 
§c
, 
c›y
);

6802 
d°
[
c›y
] = '\0';

6804  
Àngth
;

6805 
	}
}

6809 #i‚de‡
PERL_PV_ESCAPE_QUOTE


6810 
	#PERL_PV_ESCAPE_QUOTE
 0x0001

	)

6813 #i‚de‡
PERL_PV_PRETTY_QUOTE


6814 
	#PERL_PV_PRETTY_QUOTE
 
PERL_PV_ESCAPE_QUOTE


	)

6817 #i‚de‡
PERL_PV_PRETTY_ELLIPSES


6818 
	#PERL_PV_PRETTY_ELLIPSES
 0x0002

	)

6821 #i‚de‡
PERL_PV_PRETTY_LTGT


6822 
	#PERL_PV_PRETTY_LTGT
 0x0004

	)

6825 #i‚de‡
PERL_PV_ESCAPE_FIRSTCHAR


6826 
	#PERL_PV_ESCAPE_FIRSTCHAR
 0x0008

	)

6829 #i‚de‡
PERL_PV_ESCAPE_UNI


6830 
	#PERL_PV_ESCAPE_UNI
 0x0100

	)

6833 #i‚de‡
PERL_PV_ESCAPE_UNI_DETECT


6834 
	#PERL_PV_ESCAPE_UNI_DETECT
 0x0200

	)

6837 #i‚de‡
PERL_PV_ESCAPE_ALL


6838 
	#PERL_PV_ESCAPE_ALL
 0x1000

	)

6841 #i‚de‡
PERL_PV_ESCAPE_NOBACKSLASH


6842 
	#PERL_PV_ESCAPE_NOBACKSLASH
 0x2000

	)

6845 #i‚de‡
PERL_PV_ESCAPE_NOCLEAR


6846 
	#PERL_PV_ESCAPE_NOCLEAR
 0x4000

	)

6849 #i‚de‡
PERL_PV_ESCAPE_RE


6850 
	#PERL_PV_ESCAPE_RE
 0x8000

	)

6853 #i‚de‡
PERL_PV_PRETTY_NOCLEAR


6854 
	#PERL_PV_PRETTY_NOCLEAR
 
PERL_PV_ESCAPE_NOCLEAR


	)

6856 #i‚de‡
PERL_PV_PRETTY_DUMP


6857 
	#PERL_PV_PRETTY_DUMP
 
PERL_PV_PRETTY_ELLIPSES
|
PERL_PV_PRETTY_QUOTE


	)

6860 #i‚de‡
PERL_PV_PRETTY_REGPROP


6861 
	#PERL_PV_PRETTY_REGPROP
 
PERL_PV_PRETTY_ELLIPSES
|
PERL_PV_PRETTY_LTGT
|
PERL_PV_ESCAPE_RE


	)

6870 #i‚de‡
pv_esˇ≥


6871 #i‡
deföed
(
NEED_pv_esˇ≥
)

6872 * 
	$DPPP_
(
my_pv_esˇ≥
)(
pTHX_
 
SV
 * 
dsv
, c⁄° * c⁄° 
°r
, c⁄° 
STRLEN
 
cou¡
, c⁄° STRLEN 
max
, STRLEN * c⁄° 
esˇ≥d
, c⁄° 
U32
 
Êags
);

6875 * 
	$DPPP_
(
my_pv_esˇ≥
)(
pTHX_
 
SV
 * 
dsv
, c⁄° * c⁄° 
°r
, c⁄° 
STRLEN
 
cou¡
, c⁄° STRLEN 
max
, STRLEN * c⁄° 
esˇ≥d
, c⁄° 
U32
 
Êags
);

6878 #ifde‡
pv_esˇ≥


6879 #unde‡
pv_esˇ≥


6881 
	#pv_esˇ≥
(
a
,
b
,
c
,
d
,
e
,
f
Ë
	`DPPP_
(
my_pv_esˇ≥
)(
aTHX_
á,b,c,d,e,f)

	)

6882 
	#Pîl_pv_esˇ≥
 
	`DPPP_
(
my_pv_esˇ≥
)

	)

6884 #i‡
	`deföed
(
NEED_pv_esˇ≥
Ë|| deföed(
NEED_pv_esˇ≥_GLOBAL
)

6887 
	$DPPP_
(
my_pv_esˇ≥
)(
pTHX_
 
SV
 *
dsv
, c⁄° * c⁄° 
°r
,

6888 c⁄° 
STRLEN
 
cou¡
, c⁄° STRLEN 
max
,

6889 
STRLEN
 * c⁄° 
esˇ≥d
, c⁄° 
U32
 
Êags
)

6891 c⁄° 
esc
 = 
Êags
 & 
PERL_PV_ESCAPE_RE
 ? '%' : '\\';

6892 c⁄° 
dq
 = 
Êags
 & 
PERL_PV_ESCAPE_QUOTE
 ? '"' : 
esc
;

6893 
o˘buf
[32] = "%123456789ABCDF";

6894 
STRLEN
 
wrŸe
 = 0;

6895 
STRLEN
 
chsize
 = 0;

6896 
STRLEN
 
ªadsize
 = 1;

6897 #i‡
	`deföed
(
is_utf8_°rög
Ë&& deföed(
utf8_to_uvchr
)

6898 
boﬁ
 
isuni
 = 
Êags
 & 
PERL_PV_ESCAPE_UNI
 ? 1 : 0;

6900 c⁄° *
pv
 = 
°r
;

6901 c⁄° * c⁄° 
íd
 = 
pv
 + 
cou¡
;

6902 
o˘buf
[0] = 
esc
;

6904 i‡(!(
Êags
 & 
PERL_PV_ESCAPE_NOCLEAR
))

6905 
	`sv_£çvs
(
dsv
, "");

6907 #i‡
	`deföed
(
is_utf8_°rög
Ë&& deföed(
utf8_to_uvchr
)

6908 i‡((
Êags
 & 
PERL_PV_ESCAPE_UNI_DETECT
Ë&& 
	`is_utf8_°rög
((
U8
*)
pv
, 
cou¡
))

6909 
isuni
 = 1;

6912 ; 
pv
 < 
íd
 && (!
max
 || 
wrŸe
 < maxË;Öv +
ªadsize
) {

6913 c⁄° 
UV
 
u
 =

6914 #i‡
	`deföed
(
is_utf8_°rög
Ë&& deföed(
utf8_to_uvchr
)

6915 
isuni
 ? 
	`utf8_to_uvchr
((
U8
*)
pv
, &
ªadsize
) :

6917 (
U8
)*
pv
;

6918 c⁄° 
U8
 
c
 = (U8)
u
 & 0xFF;

6920 i‡(
u
 > 255 || (
Êags
 & 
PERL_PV_ESCAPE_ALL
)) {

6921 i‡(
Êags
 & 
PERL_PV_ESCAPE_FIRSTCHAR
)

6922 
chsize
 = 
	`my_¢¥ötf
(
o˘buf
,  octbuf,

6923 "%"
UVxf
, 
u
);

6925 
chsize
 = 
	`my_¢¥ötf
(
o˘buf
,  octbuf,

6926 "%cx{%"
UVxf
"}", 
esc
, 
u
);

6927 } i‡(
Êags
 & 
PERL_PV_ESCAPE_NOBACKSLASH
) {

6928 
chsize
 = 1;

6930 i‡(
c
 =
dq
 || c =
esc
 || !
	`isPRINT
(c)) {

6931 
chsize
 = 2;

6932 
c
) {

6934 '%' : i‡(
c
 =
esc
)

6935 
o˘buf
[1] = 
esc
;

6937 
chsize
 = 1;

6939 '\v' : 
o˘buf
[1] = 'v'; ;

6940 '\t' : 
o˘buf
[1] = 't'; ;

6941 '\r' : 
o˘buf
[1] = 'r'; ;

6942 '\n' : 
o˘buf
[1] = 'n'; ;

6943 '\f' : 
o˘buf
[1] = 'f'; ;

6944 '"' : i‡(
dq
 == '"')

6945 
o˘buf
[1] = '"';

6947 
chsize
 = 1;

6949 : 
chsize
 = 
	`my_¢¥ötf
(
o˘buf
,  octbuf,

6950 
pv
 < 
íd
 && 
	`isDIGIT
((
U8
)*’v+
ªadsize
))

6951 ? "%c%03o" : "%c%o", 
esc
, 
c
);

6954 
chsize
 = 1;

6957 i‡(
max
 && 
wrŸe
 + 
chsize
 > max) {

6959 } i‡(
chsize
 > 1) {

6960 
	`sv_ˇçvn
(
dsv
, 
o˘buf
, 
chsize
);

6961 
wrŸe
 +
chsize
;

6963 
tmp
[2];

6964 
	`my_¢¥ötf
(
tmp
, Åmp, "%c", 
c
);

6965 
	`sv_ˇçvn
(
dsv
, 
tmp
, 1);

6966 
wrŸe
++;

6968 i‡(
Êags
 & 
PERL_PV_ESCAPE_FIRSTCHAR
)

6971 i‡(
esˇ≥d
 !
NULL
)

6972 *
esˇ≥d

pv
 - 
°r
;

6973  
	`SvPVX
(
dsv
);

6974 
	}
}

6979 #i‚de‡
pv_¥ëty


6980 #i‡
deföed
(
NEED_pv_¥ëty
)

6981 * 
	$DPPP_
(
my_pv_¥ëty
)(
pTHX_
 
SV
 * 
dsv
, c⁄° * c⁄° 
°r
, c⁄° 
STRLEN
 
cou¡
, c⁄° STRLEN 
max
, c⁄° * c⁄° 
°¨t_cﬁ‹
, c⁄° * c⁄° 
íd_cﬁ‹
, c⁄° 
U32
 
Êags
);

6984 * 
	$DPPP_
(
my_pv_¥ëty
)(
pTHX_
 
SV
 * 
dsv
, c⁄° * c⁄° 
°r
, c⁄° 
STRLEN
 
cou¡
, c⁄° STRLEN 
max
, c⁄° * c⁄° 
°¨t_cﬁ‹
, c⁄° * c⁄° 
íd_cﬁ‹
, c⁄° 
U32
 
Êags
);

6987 #ifde‡
pv_¥ëty


6988 #unde‡
pv_¥ëty


6990 
	#pv_¥ëty
(
a
,
b
,
c
,
d
,
e
,
f
,
g
Ë
	`DPPP_
(
my_pv_¥ëty
)(
aTHX_
á,b,c,d,e,f,g)

	)

6991 
	#Pîl_pv_¥ëty
 
	`DPPP_
(
my_pv_¥ëty
)

	)

6993 #i‡
	`deföed
(
NEED_pv_¥ëty
Ë|| deföed(
NEED_pv_¥ëty_GLOBAL
)

6996 
	$DPPP_
(
my_pv_¥ëty
)(
pTHX_
 
SV
 *
dsv
, c⁄° * c⁄° 
°r
, c⁄° 
STRLEN
 
cou¡
,

6997 c⁄° 
STRLEN
 
max
, c⁄° * c⁄° 
°¨t_cﬁ‹
, c⁄° * c⁄° 
íd_cﬁ‹
,

6998 c⁄° 
U32
 
Êags
)

7000 c⁄° 
U8
 
dq
 = (
Êags
 & 
PERL_PV_PRETTY_QUOTE
) ? '"' : '%';

7001 
STRLEN
 
esˇ≥d
;

7003 i‡(!(
Êags
 & 
PERL_PV_PRETTY_NOCLEAR
))

7004 
	`sv_£çvs
(
dsv
, "");

7006 i‡(
dq
 == '"')

7007 
	`sv_ˇçvs
(
dsv
, "\"");

7008 i‡(
Êags
 & 
PERL_PV_PRETTY_LTGT
)

7009 
	`sv_ˇçvs
(
dsv
, "<");

7011 i‡(
°¨t_cﬁ‹
 !
NULL
)

7012 
	`sv_ˇçv
(
dsv
, 
	`D_PPP_CONSTPV_ARG
(
°¨t_cﬁ‹
));

7014 
	`pv_esˇ≥
(
dsv
, 
°r
, 
cou¡
, 
max
, &
esˇ≥d
, 
Êags
 | 
PERL_PV_ESCAPE_NOCLEAR
);

7016 i‡(
íd_cﬁ‹
 !
NULL
)

7017 
	`sv_ˇçv
(
dsv
, 
	`D_PPP_CONSTPV_ARG
(
íd_cﬁ‹
));

7019 i‡(
dq
 == '"')

7020 
	`sv_ˇçvs
(
dsv
, "\"");

7021 i‡(
Êags
 & 
PERL_PV_PRETTY_LTGT
)

7022 
	`sv_ˇçvs
(
dsv
, ">");

7024 i‡((
Êags
 & 
PERL_PV_PRETTY_ELLIPSES
Ë&& 
esˇ≥d
 < 
cou¡
)

7025 
	`sv_ˇçvs
(
dsv
, "...");

7027  
	`SvPVX
(
dsv
);

7028 
	}
}

7033 #i‚de‡
pv_di•œy


7034 #i‡
deföed
(
NEED_pv_di•œy
)

7035 * 
	$DPPP_
(
my_pv_di•œy
)(
pTHX_
 
SV
 * 
dsv
, c⁄° * 
pv
, 
STRLEN
 
cur
, STRLEN 
Àn
, STRLEN 
pvlim
);

7038 * 
	$DPPP_
(
my_pv_di•œy
)(
pTHX_
 
SV
 * 
dsv
, c⁄° * 
pv
, 
STRLEN
 
cur
, STRLEN 
Àn
, STRLEN 
pvlim
);

7041 #ifde‡
pv_di•œy


7042 #unde‡
pv_di•œy


7044 
	#pv_di•œy
(
a
,
b
,
c
,
d
,
e
Ë
	`DPPP_
(
my_pv_di•œy
)(
aTHX_
á,b,c,d,e)

	)

7045 
	#Pîl_pv_di•œy
 
	`DPPP_
(
my_pv_di•œy
)

	)

7047 #i‡
	`deföed
(
NEED_pv_di•œy
Ë|| deföed(
NEED_pv_di•œy_GLOBAL
)

7050 
	$DPPP_
(
my_pv_di•œy
)(
pTHX_
 
SV
 *
dsv
, c⁄° *
pv
, 
STRLEN
 
cur
, STRLEN 
Àn
, STRLEN 
pvlim
)

7052 
	`pv_¥ëty
(
dsv
, 
pv
, 
cur
, 
pvlim
, 
NULL
, NULL, 
PERL_PV_PRETTY_DUMP
);

7053 i‡(
Àn
 > 
cur
 && 
pv
[cur] == '\0')

7054 
	`sv_ˇçvs
(
dsv
, "\\0");

7055  
	`SvPVX
(
dsv
);

7056 
	}
}

	@dane.c

10 
	~<ldns/c⁄fig.h
>

11 #ifde‡
USE_DANE


13 
	~<ldns/ldns.h
>

14 
	~<ldns/d™e.h
>

16 
	~<uni°d.h
>

17 
	~<°dlib.h
>

18 
	~<sys/ty≥s.h
>

19 #ifde‡
HAVE_SYS_SOCKET_H


20 
	~<sys/sockë.h
>

22 #ifde‡
HAVE_NETDB_H


23 
	~<√tdb.h
>

26 #ifde‡
HAVE_SSL


27 
	~<›ís¶/s¶.h
>

28 
	~<›ís¶/îr.h
>

29 
	~<›ís¶/x509v3.h
>

32 
ldns_°©us


33 
	$ldns_d™e_¸óã_éß_ow√r
(
ldns_rdf
** 
éß_ow√r
, c⁄°Üdns_rdf* 
«me
,

34 
uöt16_t
 
p‹t
, 
ldns_d™e_å™•‹t
 
å™•‹t
)

36 
buf
[
LDNS_MAX_DOMAINLEN
];

37 
size_t
 
s
;

39 
	`as£π
(
éß_ow√r
 !
NULL
);

40 
	`as£π
(
«me
 !
NULL
);

41 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
«me
Ë=
LDNS_RDF_TYPE_DNAME
);

43 
s
 = (
size_t
)
	`¢¥ötf
(
buf
, 
LDNS_MAX_DOMAINLEN
, "X_%d", ()
p‹t
);

44 
buf
[0] = ()(
s
 - 1);

46 
å™•‹t
) {

47 
LDNS_DANE_TRANSPORT_TCP
:

48 
s
 +
	`¢¥ötf
(
buf
 + s, 
LDNS_MAX_DOMAINLEN
 - s, "\004_tcp");

51 
LDNS_DANE_TRANSPORT_UDP
:

52 
s
 +
	`¢¥ötf
(
buf
 + s, 
LDNS_MAX_DOMAINLEN
 - s, "\004_udp");

55 
LDNS_DANE_TRANSPORT_SCTP
:

56 
s
 +
	`¢¥ötf
(
buf
 + s, 
LDNS_MAX_DOMAINLEN
 - s, "\005_sctp");

60  
LDNS_STATUS_DANE_UNKNOWN_TRANSPORT
;

62 i‡(
s
 + 
	`ldns_rdf_size
(
«me
Ë> 
LDNS_MAX_DOMAINLEN
) {

63  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

65 
	`mem˝y
(
buf
 + 
s
, 
	`ldns_rdf_d©a
(
«me
), 
	`ldns_rdf_size
(name));

66 *
éß_ow√r
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_DNAME
,

67 
s
 + 
	`ldns_rdf_size
(
«me
), 
buf
);

68 i‡(*
éß_ow√r
 =
NULL
) {

69  
LDNS_STATUS_MEM_ERR
;

71  
LDNS_STATUS_OK
;

72 
	}
}

75 #ifde‡
HAVE_SSL


76 
ldns_°©us


77 
	$ldns_d™e_˚π2rdf
(
ldns_rdf
** 
rdf
, 
X509
* 
˚π
,

78 
ldns_éß_£À˘‹
 
£À˘‹
,

79 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
)

81 * 
buf
 = 
NULL
;

82 
size_t
 
Àn
;

84 
X509_PUBKEY
* 
xpubkey
;

85 
EVP_PKEY
* 
ïubkey
;

87 * 
dige°
;

89 
	`as£π
(
rdf
 !
NULL
);

90 
	`as£π
(
˚π
 !
NULL
);

92 
£À˘‹
) {

93 
LDNS_TLSA_SELECTOR_FULL_CERTIFICATE
:

95 
Àn
 = (
size_t
)
	`i2d_X509
(
˚π
, &
buf
);

98 
LDNS_TLSA_SELECTOR_SUBJECTPUBLICKEYINFO
:

100 #i‚de‡
S_SPLINT_S


101 
xpubkey
 = 
	`X509_gë_X509_PUBKEY
(
˚π
);

103 i‡(! 
xpubkey
) {

104  
LDNS_STATUS_SSL_ERR
;

106 
ïubkey
 = 
	`X509_PUBKEY_gë
(
xpubkey
);

107 i‡(! 
ïubkey
) {

108  
LDNS_STATUS_SSL_ERR
;

110 
Àn
 = (
size_t
)
	`i2d_PUBKEY
(
ïubkey
, &
buf
);

114  
LDNS_STATUS_DANE_UNKNOWN_SELECTOR
;

117 
m©chög_ty≥
) {

118 
LDNS_TLSA_MATCHING_TYPE_NO_HASH_USED
:

120 *
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_HEX
, 
Àn
, 
buf
);

122  *
rdf
 ? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_MEM_ERR
;

125 
LDNS_TLSA_MATCHING_TYPE_SHA256
:

127 
dige°
 = 
	`LDNS_XMALLOC
(, 
LDNS_SHA256_DIGEST_LENGTH
);

128 i‡(
dige°
 =
NULL
) {

129 
	`LDNS_FREE
(
buf
);

130  
LDNS_STATUS_MEM_ERR
;

132 (Ë
	`ldns_sha256
(
buf
, ()
Àn
, 
dige°
);

133 *
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_HEX
, 
LDNS_SHA256_DIGEST_LENGTH
,

134 
dige°
);

135 
	`LDNS_FREE
(
buf
);

137  *
rdf
 ? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_MEM_ERR
;

140 
LDNS_TLSA_MATCHING_TYPE_SHA512
:

142 
dige°
 = 
	`LDNS_XMALLOC
(, 
LDNS_SHA512_DIGEST_LENGTH
);

143 i‡(
dige°
 =
NULL
) {

144 
	`LDNS_FREE
(
buf
);

145  
LDNS_STATUS_MEM_ERR
;

147 (Ë
	`ldns_sha512
(
buf
, ()
Àn
, 
dige°
);

148 *
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_HEX
, 
LDNS_SHA512_DIGEST_LENGTH
,

149 
dige°
);

150 
	`LDNS_FREE
(
buf
);

152  *
rdf
 ? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_MEM_ERR
;

156 
	`LDNS_FREE
(
buf
);

157  
LDNS_STATUS_DANE_UNKNOWN_MATCHING_TYPE
;

159 
	}
}

165 
ldns_°©us


166 
ldns_d™e_pkix_vÆid©e
(
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

167 
X509_STORE
* 
°‹e
)

169 
X509_STORE_CTX
* 
	gvrfy_˘x
;

170 
ldns_°©us
 
	gs
;

172 i‡(! 
	g°‹e
) {

173  
	gLDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
;

175 
	gvrfy_˘x
 = 
X509_STORE_CTX_√w
();

176 i‡(! 
	gvrfy_˘x
) {

178  
	gLDNS_STATUS_SSL_ERR
;

180 } i‡(
X509_STORE_CTX_öô
(
vrfy_˘x
, 
°‹e
,

181 
˚π
, 
exåa_˚πs
) != 1) {

182 
s
 = 
LDNS_STATUS_SSL_ERR
;

184 } i‡(
X509_vîify_˚π
(
vrfy_˘x
) == 1) {

186 
s
 = 
LDNS_STATUS_OK
;

189 
	gs
 = 
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
;

191 
X509_STORE_CTX_‰ì
(
vrfy_˘x
);

192  
	gs
;

199 
ldns_°©us


200 
ldns_d™e_pkix_vÆid©e_™d_gë_chaö
(
STACK_OF
(
X509
)** 
chaö
, X509* 
˚π
,

201 
STACK_OF
(
X509
)* 
exåa_˚πs
, 
X509_STORE
* 
°‹e
)

203 
ldns_°©us
 
	gs
;

204 
X509_STORE
* 
	gem±y_°‹e
 = 
NULL
;

205 
X509_STORE_CTX
* 
	gvrfy_˘x
;

207 
as£π
(
chaö
 !
NULL
);

209 i‡(! 
	g°‹e
) {

210 
	g°‹e
 = 
em±y_°‹e
 = 
X509_STORE_√w
();

212 
	gs
 = 
LDNS_STATUS_SSL_ERR
;

213 
	gvrfy_˘x
 = 
X509_STORE_CTX_√w
();

214 i‡(! 
	gvrfy_˘x
) {

216 
	gexô_‰ì_em±y_°‹e
;

218 } i‡(
X509_STORE_CTX_öô
(
vrfy_˘x
, 
°‹e
,

219 
˚π
, 
exåa_˚πs
) != 1) {

220 
exô_‰ì_vrfy_˘x
;

222 } i‡(
X509_vîify_˚π
(
vrfy_˘x
) == 1) {

224 
s
 = 
LDNS_STATUS_OK
;

227 
	gs
 = 
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
;

229 *
	gchaö
 = 
X509_STORE_CTX_gë1_chaö
(
vrfy_˘x
);

230 i‡(! *
	gchaö
) {

231 
	gs
 = 
LDNS_STATUS_SSL_ERR
;

234 
	gexô_‰ì_vrfy_˘x
:

235 
X509_STORE_CTX_‰ì
(
vrfy_˘x
);

237 
	gexô_‰ì_em±y_°‹e
:

238 i‡(
em±y_°‹e
) {

239 
X509_STORE_‰ì
(
em±y_°‹e
);

241  
	gs
;

247 
ldns_°©us


248 
ldns_d™e_pkix_gë_chaö
(
STACK_OF
(
X509
)** 
chaö
,

249 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
)

251 
ldns_°©us
 
	gs
;

252 
X509_STORE
* 
	gem±y_°‹e
 = 
NULL
;

253 
X509_STORE_CTX
* 
	gvrfy_˘x
;

255 
as£π
(
chaö
 !
NULL
);

257 
	gem±y_°‹e
 = 
X509_STORE_√w
();

258 
	gs
 = 
LDNS_STATUS_SSL_ERR
;

259 
	gvrfy_˘x
 = 
X509_STORE_CTX_√w
();

260 i‡(! 
	gvrfy_˘x
) {

262 
	gexô_‰ì_em±y_°‹e
;

264 } i‡(
X509_STORE_CTX_öô
(
vrfy_˘x
, 
em±y_°‹e
,

265 
˚π
, 
exåa_˚πs
) != 1) {

266 
exô_‰ì_vrfy_˘x
;

268 (Ë
X509_vîify_˚π
(
vrfy_˘x
);

269 *
	gchaö
 = 
X509_STORE_CTX_gë1_chaö
(
vrfy_˘x
);

270 i‡(! *
	gchaö
) {

271 
	gs
 = 
LDNS_STATUS_SSL_ERR
;

273 
	gs
 = 
LDNS_STATUS_OK
;

275 
	gexô_‰ì_vrfy_˘x
:

276 
X509_STORE_CTX_‰ì
(
vrfy_˘x
);

278 
	gexô_‰ì_em±y_°‹e
:

279 
X509_STORE_‰ì
(
em±y_°‹e
);

280  
	gs
;

286 
ldns_°©us


287 
ldns_d™e_gë_¡h_˚π_‰om_vÆid©i⁄_chaö
(

288 
X509
** 
˚π
, 
STACK_OF
(X509)* 
chaö
, 
n
, 
boﬁ
 
ˇ
)

290 i‡(
	gn
 >
sk_X509_num
(
chaö
Ë|| 
n
 < 0) {

291  
LDNS_STATUS_DANE_OFFSET_OUT_OF_RANGE
;

293 *
	g˚π
 = 
sk_X509_p›
(
chaö
);

294 
	gn
-- > 0) {

295 
X509_‰ì
(*
˚π
);

296 *
	g˚π
 = 
sk_X509_p›
(
chaö
);

298 i‡(
	gˇ
 && ! 
X509_check_ˇ
(*
˚π
)) {

299  
	gLDNS_STATUS_DANE_NON_CA_CERTIFICATE
;

301  
	gLDNS_STATUS_OK
;

308 
ldns_°©us


309 
ldns_d™e_pkix_gë_œ°_£lf_sig√d
(
X509
** 
out_˚π
,

310 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
)

312 
ldns_°©us
 
	gs
;

313 
X509_STORE
* 
	gem±y_°‹e
 = 
NULL
;

314 
X509_STORE_CTX
* 
	gvrfy_˘x
;

316 
as£π
(
out_˚π
 !
NULL
);

318 
	gem±y_°‹e
 = 
X509_STORE_√w
();

319 
	gs
 = 
LDNS_STATUS_SSL_ERR
;

320 
	gvrfy_˘x
 = 
X509_STORE_CTX_√w
();

321 i‡(! 
	gvrfy_˘x
) {

322 
	gexô_‰ì_em±y_°‹e
;

324 } i‡(
X509_STORE_CTX_öô
(
vrfy_˘x
, 
em±y_°‹e
,

325 
˚π
, 
exåa_˚πs
) != 1) {

326 
exô_‰ì_vrfy_˘x
;

329 (Ë
X509_vîify_˚π
(
vrfy_˘x
);

330 i‡(
	gvrfy_˘x
->
	gîr‹
 =
X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN
 ||

331 
vrfy_˘x
->
îr‹
 =
X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT
){

333 *
out_˚π
 = 
X509_STORE_CTX_gë_cuºít_˚π
–
vrfy_˘x
);

334 
	gs
 = 
LDNS_STATUS_OK
;

336 
	gs
 = 
LDNS_STATUS_DANE_PKIX_NO_SELF_SIGNED_TRUST_ANCHOR
;

338 
	gexô_‰ì_vrfy_˘x
:

339 
X509_STORE_CTX_‰ì
(
vrfy_˘x
);

341 
	gexô_‰ì_em±y_°‹e
:

342 
X509_STORE_‰ì
(
em±y_°‹e
);

343  
	gs
;

347 
ldns_°©us


348 
ldns_d™e_£À˘_˚πifiˇã
(
X509
** 
£À˘ed_˚π
,

349 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

350 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
,

351 
ldns_éß_˚πifiˇã_ußge
 
˚π_ußge
, 
off£t
)

353 
ldns_°©us
 
	gs
;

354 
STACK_OF
(
X509
)* 
	gpkix_vÆid©i⁄_chaö
 = 
NULL
;

356 
as£π
(
£À˘ed_˚π
 !
NULL
);

357 
as£π
(
˚π
 !
NULL
);

364 i‡(
	gpkix_vÆid©i⁄_°‹e
 =
NULL
) {

365 
˚π_ußge
) {

367 
LDNS_TLSA_USAGE_CA_CONSTRAINT
:

369 
˚π_ußge
 = 
LDNS_TLSA_USAGE_TRUST_ANCHOR_ASSERTION
;

372 
	gLDNS_TLSA_USAGE_SERVICE_CERTIFICATE_CONSTRAINT
:

374 
˚π_ußge
 = 
LDNS_TLSA_USAGE_DOMAIN_ISSUED_CERTIFICATE
;

384 
	g˚π_ußge
) {

386 
	gLDNS_TLSA_USAGE_CA_CONSTRAINT
:

388 
s
 = 
ldns_d™e_pkix_vÆid©e_™d_gë_chaö
(

389 &
pkix_vÆid©i⁄_chaö
,

390 
˚π
, 
exåa_˚πs
,

391 
pkix_vÆid©i⁄_°‹e
);

392 i‡(! 
	gpkix_vÆid©i⁄_chaö
) {

393  
	gs
;

395 i‡(
	gs
 =
LDNS_STATUS_OK
) {

396 i‡(
off£t
 == -1) {

397 
off£t
 = 0;

399 
	gs
 = 
ldns_d™e_gë_¡h_˚π_‰om_vÆid©i⁄_chaö
(

400 
£À˘ed_˚π
, 
pkix_vÆid©i⁄_chaö
,

401 
off£t
, 
åue
);

403 
sk_X509_p›_‰ì
(
pkix_vÆid©i⁄_chaö
, 
X509_‰ì
);

404  
	gs
;

408 
	gLDNS_TLSA_USAGE_SERVICE_CERTIFICATE_CONSTRAINT
:

410 *
£À˘ed_˚π
 = 
˚π
;

411  
ldns_d™e_pkix_vÆid©e
(
˚π
, 
exåa_˚πs
,

412 
pkix_vÆid©i⁄_°‹e
);

416 
	gLDNS_TLSA_USAGE_TRUST_ANCHOR_ASSERTION
:

418 i‡(
off£t
 == -1) {

419 
s
 = 
ldns_d™e_pkix_gë_œ°_£lf_sig√d
(

420 
£À˘ed_˚π
, 
˚π
, 
exåa_˚πs
);

421  
	gs
;

423 
	gs
 = 
ldns_d™e_pkix_gë_chaö
(

424 &
pkix_vÆid©i⁄_chaö
,

425 
˚π
, 
exåa_˚πs
);

426 i‡(
	gs
 =
LDNS_STATUS_OK
) {

427 
s
 =

428 
ldns_d™e_gë_¡h_˚π_‰om_vÆid©i⁄_chaö
(

429 
£À˘ed_˚π
, 
pkix_vÆid©i⁄_chaö
,

430 
off£t
, 
Ál£
);

431 } i‡(! 
	gpkix_vÆid©i⁄_chaö
) {

432  
	gs
;

434 
sk_X509_p›_‰ì
(
pkix_vÆid©i⁄_chaö
, 
X509_‰ì
);

435  
	gs
;

440 
	gLDNS_TLSA_USAGE_DOMAIN_ISSUED_CERTIFICATE
:

442 *
£À˘ed_˚π
 = 
˚π
;

443  
	gLDNS_STATUS_OK
;

447  
LDNS_STATUS_DANE_UNKNOWN_CERTIFICATE_USAGE
;

453 
ldns_°©us


454 
	$ldns_d™e_¸óã_éß_º
(
ldns_º
** 
éß
,

455 
ldns_éß_˚πifiˇã_ußge
 
˚πifiˇã_ußge
,

456 
ldns_éß_£À˘‹
 
£À˘‹
,

457 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
,

458 
X509
* 
˚π
)

460 
ldns_rdf
* 
rdf
;

461 
ldns_°©us
 
s
;

463 
	`as£π
(
éß
 !
NULL
);

464 
	`as£π
(
˚π
 !
NULL
);

467 *
éß
 = 
	`ldns_º_√w_‰m_ty≥
(
LDNS_RR_TYPE_TLSA
);

468 i‡(*
éß
 =
NULL
) {

469  
LDNS_STATUS_MEM_ERR
;

472 
rdf
 = 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
,

473 (
uöt8_t
)
˚πifiˇã_ußge
);

474 i‡(
rdf
 =
NULL
) {

475 
memîr‹
;

477 (Ë
	`ldns_º_£t_rdf
(*
éß
, 
rdf
, 0);

479 
rdf
 = 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
, (
uöt8_t
)
£À˘‹
);

480 i‡(
rdf
 =
NULL
) {

481 
memîr‹
;

483 (Ë
	`ldns_º_£t_rdf
(*
éß
, 
rdf
, 1);

485 
rdf
 = 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
, (
uöt8_t
)
m©chög_ty≥
);

486 i‡(
rdf
 =
NULL
) {

487 
memîr‹
;

489 (Ë
	`ldns_º_£t_rdf
(*
éß
, 
rdf
, 2);

491 
s
 = 
	`ldns_d™e_˚π2rdf
(&
rdf
, 
˚π
, 
£À˘‹
, 
m©chög_ty≥
);

492 i‡(
s
 =
LDNS_STATUS_OK
) {

493 (Ë
	`ldns_º_£t_rdf
(*
éß
, 
rdf
, 3);

494  
LDNS_STATUS_OK
;

496 
	`ldns_º_‰ì
(*
éß
);

497 *
éß
 = 
NULL
;

498  
s
;

500 
memîr‹
:

501 
	`ldns_º_‰ì
(*
éß
);

502 *
éß
 = 
NULL
;

503  
LDNS_STATUS_MEM_ERR
;

504 
	}
}

510 
ldns_º_li°
*

511 
	$ldns_d™e_fûãr_unußbÀ_ªc‹ds
(c⁄° 
ldns_º_li°
* 
éßs
)

513 
size_t
 
i
;

514 
ldns_º_li°
* 
r
 = 
	`ldns_º_li°_√w
();

515 
ldns_º
* 
éß_º
;

517 i‡(! 
r
) {

518  
NULL
;

520 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
éßs
); i++) {

521 
éß_º
 = 
	`ldns_º_li°_º
(
éßs
, 
i
);

522 i‡(
	`ldns_º_gë_ty≥
(
éß_º
Ë=
LDNS_RR_TYPE_TLSA
 &&

523 
	`ldns_º_rd_cou¡
(
éß_º
) == 4 &&

524 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
éß_º
, 0)) <= 3 &&

525 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
éß_º
, 1)) <= 1 &&

526 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
éß_º
, 2)) <= 2) {

528 i‡(! 
	`ldns_º_li°_push_º
(
r
, 
éß_º
)) {

529 
	`ldns_º_li°_‰ì
(
r
);

530  
NULL
;

534  
r
;

535 
	}
}

540 
ldns_°©us


541 
	$ldns_d™e_m©ch_˚π_wôh_d©a
(
X509
* 
˚π
, 
ldns_éß_£À˘‹
 
£À˘‹
,

542 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
, 
ldns_rdf
* 
d©a
)

544 
ldns_°©us
 
s
;

545 
ldns_rdf
* 
m©ch_d©a
;

547 
s
 = 
	`ldns_d™e_˚π2rdf
(&
m©ch_d©a
, 
˚π
, 
£À˘‹
, 
m©chög_ty≥
);

548 i‡(
s
 =
LDNS_STATUS_OK
) {

549 i‡(
	`ldns_rdf_com∑ª
(
d©a
, 
m©ch_d©a
) != 0) {

550 
s
 = 
LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH
;

552 
	`ldns_rdf_‰ì
(
m©ch_d©a
);

554  
s
;

555 
	}
}

562 
ldns_°©us


563 
ldns_d™e_m©ch_™y_˚π_wôh_d©a
(
STACK_OF
(
X509
)* 
chaö
,

564 
ldns_éß_£À˘‹
 
£À˘‹
,

565 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
,

566 
ldns_rdf
* 
d©a
, 
boﬁ
 
ˇ
)

568 
ldns_°©us
 
	gs
 = 
LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH
;

569 
size_t
 
	gn
, 
	gi
;

570 
X509
* 
	g˚π
;

572 
	gn
 = (
size_t
)
sk_X509_num
(
chaö
);

573 
	gi
 = 0; i < 
	gn
; i++) {

574 
	g˚π
 = 
sk_X509_p›
(
chaö
);

575 i‡(! 
	g˚π
) {

576 
	gs
 = 
LDNS_STATUS_SSL_ERR
;

579 
	gs
 = 
ldns_d™e_m©ch_˚π_wôh_d©a
(
˚π
,

580 
£À˘‹
, 
m©chög_ty≥
, 
d©a
);

581 i‡(
	gˇ
 && 
	gs
 =
LDNS_STATUS_OK
 && ! 
X509_check_ˇ
(
˚π
)) {

582 
s
 = 
LDNS_STATUS_DANE_NON_CA_CERTIFICATE
;

584 
X509_‰ì
(
˚π
);

585 i‡(
	gs
 !
LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH
) {

592  
	gs
;

596 
ldns_°©us


597 
ldns_d™e_vîify_º
(c⁄° 
ldns_º
* 
éß_º
,

598 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

599 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
)

601 
ldns_°©us
 
	gs
;

603 
STACK_OF
(
X509
)* 
	gpkix_vÆid©i⁄_chaö
 = 
NULL
;

605 
ldns_éß_˚πifiˇã_ußge
 
	g˚π_ußge
;

606 
ldns_éß_£À˘‹
 
	g£À˘‹
;

607 
ldns_éß_m©chög_ty≥
 
	gm©chög_ty≥
;

608 
ldns_rdf
* 
	gd©a
;

610 i‡(! 
	géß_º
) {

613  
ldns_d™e_pkix_vÆid©e
(
˚π
, 
exåa_˚πs
,

614 
pkix_vÆid©i⁄_°‹e
);

616 
	g˚π_ußge
 = 
ldns_rdf2«tive_öt8
(
ldns_º_rdf
(
éß_º
, 0));

617 
	g£À˘‹
 = 
ldns_rdf2«tive_öt8
(
ldns_º_rdf
(
éß_º
, 1));

618 
	gm©chög_ty≥
 = 
ldns_rdf2«tive_öt8
(
ldns_º_rdf
(
éß_º
, 2));

619 
	gd©a
 = 
ldns_º_rdf
(
éß_º
, 3) ;

621 
	g˚π_ußge
) {

622 
	gLDNS_TLSA_USAGE_CA_CONSTRAINT
:

623 
s
 = 
ldns_d™e_pkix_vÆid©e_™d_gë_chaö
(

624 &
pkix_vÆid©i⁄_chaö
,

625 
˚π
, 
exåa_˚πs
,

626 
pkix_vÆid©i⁄_°‹e
);

627 i‡(! 
	gpkix_vÆid©i⁄_chaö
) {

628  
	gs
;

630 i‡(
	gs
 =
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
) {

639 
s
 = 
ldns_d™e_m©ch_™y_˚π_wôh_d©a
(

640 
pkix_vÆid©i⁄_chaö
,

641 
£À˘‹
, 
m©chög_ty≥
, 
d©a
, 
åue
);

643 i‡(
	gs
 =
LDNS_STATUS_OK
) {

648 
s
 = 
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
;

651 } i‡(
	gs
 =
LDNS_STATUS_OK
) {

654 
s
 = 
ldns_d™e_m©ch_™y_˚π_wôh_d©a
(

655 
pkix_vÆid©i⁄_chaö
,

656 
£À˘‹
, 
m©chög_ty≥
, 
d©a
, 
åue
);

658 
sk_X509_p›_‰ì
(
pkix_vÆid©i⁄_chaö
, 
X509_‰ì
);

659  
	gs
;

662 
	gLDNS_TLSA_USAGE_SERVICE_CERTIFICATE_CONSTRAINT
:

663 
s
 = 
ldns_d™e_m©ch_˚π_wôh_d©a
(
˚π
,

664 
£À˘‹
, 
m©chög_ty≥
, 
d©a
);

666 i‡(
	gs
 =
LDNS_STATUS_OK
) {

667  
ldns_d™e_pkix_vÆid©e
(
˚π
, 
exåa_˚πs
,

668 
pkix_vÆid©i⁄_°‹e
);

670  
	gs
;

673 
	gLDNS_TLSA_USAGE_TRUST_ANCHOR_ASSERTION
:

674 
s
 = 
ldns_d™e_pkix_gë_chaö
(&
pkix_vÆid©i⁄_chaö
,

675 
˚π
, 
exåa_˚πs
);

677 i‡(
	gs
 =
LDNS_STATUS_OK
) {

678 
s
 = 
ldns_d™e_m©ch_™y_˚π_wôh_d©a
(

679 
pkix_vÆid©i⁄_chaö
,

680 
£À˘‹
, 
m©chög_ty≥
, 
d©a
, 
Ál£
);

682 } i‡(! 
	gpkix_vÆid©i⁄_chaö
) {

683  
	gs
;

685 
sk_X509_p›_‰ì
(
pkix_vÆid©i⁄_chaö
, 
X509_‰ì
);

686  
	gs
;

689 
	gLDNS_TLSA_USAGE_DOMAIN_ISSUED_CERTIFICATE
:

690  
ldns_d™e_m©ch_˚π_wôh_d©a
(
˚π
,

691 
£À˘‹
, 
m©chög_ty≥
, 
d©a
);

697  
	gLDNS_STATUS_DANE_UNKNOWN_CERTIFICATE_USAGE
;

701 
ldns_°©us


702 
ldns_d™e_vîify
(
ldns_º_li°
* 
éßs
,

703 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

704 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
)

706 
size_t
 
	gi
;

707 
ldns_º
* 
	géß_º
;

708 
ldns_°©us
 
	gs
 = 
LDNS_STATUS_OK
, 
	gps
;

710 
as£π
(
˚π
 !
NULL
);

712 i‡(
	géßs
 && 
ldns_º_li°_º_cou¡
(
éßs
) > 0) {

713 
	géßs
 = 
ldns_d™e_fûãr_unußbÀ_ªc‹ds
(
éßs
);

714 i‡(! 
	géßs
) {

715  
	gLDNS_STATUS_MEM_ERR
;

718 i‡(! 
	géßs
 || 
ldns_º_li°_º_cou¡
(
éßs
) == 0) {

721  
ldns_d™e_pkix_vÆid©e
(
˚π
, 
exåa_˚πs
,

722 
pkix_vÆid©i⁄_°‹e
);

724 
	gi
 = 0; i < 
ldns_º_li°_º_cou¡
(
éßs
); i++) {

725 
	géß_º
 = 
ldns_º_li°_º
(
éßs
, 
i
);

726 
	gps
 = 
s
;

727 
	gs
 = 
ldns_d™e_vîify_º
(
éß_º
, 
˚π
, 
exåa_˚πs
,

728 
pkix_vÆid©i⁄_°‹e
);

730 i‡(
	gs
 !
LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH
 &&

731 
s
 !
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
) {

739 
	gs
 = (
s
 > 
ps
 ? s :Ös);

743 
ldns_º_li°_‰ì
(
éßs
);

745  
	gs
;

	@dname.c

16 
	~<ldns/c⁄fig.h
>

18 
	~<ldns/ldns.h
>

20 #ifde‡
HAVE_NETINET_IN_H


21 
	~<√töë/ö.h
>

23 #ifde‡
HAVE_SYS_SOCKET_H


24 
	~<sys/sockë.h
>

26 #ifde‡
HAVE_NETDB_H


27 
	~<√tdb.h
>

29 #ifde‡
HAVE_ARPA_INET_H


30 
	~<¨∑/öë.h
>

37 
boﬁ


38 
	$ldns_d«me_œ°_œbñ_is_roŸ_œbñ
(c⁄° 
ldns_rdf
* 
d«me
)

40 
size_t
 
§c_pos
;

41 
size_t
 
Àn
 = 0;

43 
§c_pos
 = 0; src_po†< 
	`ldns_rdf_size
(
d«me
); src_po†+
Àn
 + 1) {

44 
Àn
 = 
	`ldns_rdf_d©a
(
d«me
)[
§c_pos
];

46 
	`as£π
(
§c_pos
 =
	`ldns_rdf_size
(
d«me
));

48  
§c_pos
 > 0 && 
Àn
 == 0;

49 
	}
}

51 
ldns_rdf
 *

52 
	$ldns_d«me_ˇt_˛⁄e
(c⁄° 
ldns_rdf
 *
rd1
, c⁄°Üdns_rd‡*
rd2
)

54 
ldns_rdf
 *
√w
;

55 
uöt16_t
 
√w_size
;

56 
uöt8_t
 *
buf
;

57 
uöt16_t
 
À·_size
;

59 i‡(
	`ldns_rdf_gë_ty≥
(
rd1
Ë!
LDNS_RDF_TYPE_DNAME
 ||

60 
	`ldns_rdf_gë_ty≥
(
rd2
Ë!
LDNS_RDF_TYPE_DNAME
) {

61  
NULL
;

67 
À·_size
 = 
	`ldns_rdf_size
(
rd1
);

68 i‡(
	`ldns_d«me_œ°_œbñ_is_roŸ_œbñ
(
rd1
)) {

69 
À·_size
--;

73 
√w_size
 = 
À·_size
 + 
	`ldns_rdf_size
(
rd2
);

74 
buf
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
√w_size
);

75 i‡(!
buf
) {

76  
NULL
;

80 
	`mem˝y
(
buf
, 
	`ldns_rdf_d©a
(
rd1
), 
À·_size
);

81 
	`mem˝y
(
buf
 + 
À·_size
, 
	`ldns_rdf_d©a
(
rd2
), 
	`ldns_rdf_size
(rd2));

83 
√w
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_DNAME
, 
√w_size
, 
buf
);

85 
	`LDNS_FREE
(
buf
);

86  
√w
;

87 
	}
}

89 
ldns_°©us


90 
	$ldns_d«me_ˇt
(
ldns_rdf
 *
rd1
,Üdns_rd‡*
rd2
)

92 
uöt16_t
 
À·_size
;

93 
uöt16_t
 
size
;

94 
uöt8_t
* 
√wd
;

96 i‡(
	`ldns_rdf_gë_ty≥
(
rd1
Ë!
LDNS_RDF_TYPE_DNAME
 ||

97 
	`ldns_rdf_gë_ty≥
(
rd2
Ë!
LDNS_RDF_TYPE_DNAME
) {

98  
LDNS_STATUS_ERR
;

104 
À·_size
 = 
	`ldns_rdf_size
(
rd1
);

105 i‡(
	`ldns_d«me_œ°_œbñ_is_roŸ_œbñ
(
rd1
)) {

106 
À·_size
--;

109 
size
 = 
À·_size
 + 
	`ldns_rdf_size
(
rd2
);

110 
√wd
 = 
	`LDNS_XREALLOC
(
	`ldns_rdf_d©a
(
rd1
), 
uöt8_t
, 
size
);

111 if(!
√wd
) {

112  
LDNS_STATUS_MEM_ERR
;

115 
	`ldns_rdf_£t_d©a
(
rd1
, 
√wd
);

116 
	`mem˝y
(
	`ldns_rdf_d©a
(
rd1
Ë+ 
À·_size
,Üdns_rdf_d©a(
rd2
),

117 
	`ldns_rdf_size
(
rd2
));

118 
	`ldns_rdf_£t_size
(
rd1
, 
size
);

120  
LDNS_STATUS_OK
;

121 
	}
}

123 
ldns_rdf
*

124 
	$ldns_d«me_ªvî£
(c⁄° 
ldns_rdf
 *
d«me
)

126 
size_t
 
rd_size
;

127 
uöt8_t
* 
buf
;

128 
ldns_rdf
* 
√w
;

129 
size_t
 
§c_pos
;

130 
size_t
 
Àn
 ;

132 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
d«me
Ë=
LDNS_RDF_TYPE_DNAME
);

134 
rd_size
 = 
	`ldns_rdf_size
(
d«me
);

135 
buf
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
rd_size
);

136 i‡(! 
buf
) {

137  
NULL
;

139 
√w
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_DNAME
, 
rd_size
, 
buf
);

140 i‡(! 
√w
) {

141 
	`LDNS_FREE
(
buf
);

142  
NULL
;

147 i‡(
	`ldns_d«me_œ°_œbñ_is_roŸ_œbñ
(
d«me
)) {

148 
buf
[
rd_size
 - 1] = 0;

149 
rd_size
 -= 1;

151 
§c_pos
 = 0; src_po†< 
rd_size
; src_po†+
Àn
 + 1) {

152 
Àn
 = 
	`ldns_rdf_d©a
(
d«me
)[
§c_pos
];

153 
	`mem˝y
(&
buf
[
rd_size
 - 
§c_pos
 - 
Àn
 - 1],

154 &
	`ldns_rdf_d©a
(
d«me
)[
§c_pos
], 
Àn
 + 1);

156  
√w
;

157 
	}
}

159 
ldns_rdf
 *

160 
	$ldns_d«me_˛⁄e_‰om
(c⁄° 
ldns_rdf
 *
d
, 
uöt16_t
 
n
)

162 
uöt8_t
 *
d©a
;

163 
uöt8_t
 
œbñ_size
;

164 
size_t
 
d©a_size
;

166 i‡(!
d
 ||

167 
	`ldns_rdf_gë_ty≥
(
d
Ë!
LDNS_RDF_TYPE_DNAME
 ||

168 
	`ldns_d«me_œbñ_cou¡
(
d
Ë< 
n
) {

169  
NULL
;

172 
d©a
 = 
	`ldns_rdf_d©a
(
d
);

173 
d©a_size
 = 
	`ldns_rdf_size
(
d
);

174 
n
 > 0) {

175 
œbñ_size
 = 
d©a
[0] + 1;

176 
d©a
 +
œbñ_size
;

177 i‡(
d©a_size
 < 
œbñ_size
) {

179  
NULL
;

181 
d©a_size
 -
œbñ_size
;

182 
n
--;

185  
	`ldns_d«me_√w_‰m_d©a
(
d©a_size
, 
d©a
);

186 
	}
}

188 
ldns_rdf
 *

189 
	$ldns_d«me_À·_ch›
(c⁄° 
ldns_rdf
 *
d
)

191 
uöt8_t
 
œbñ_pos
;

192 
ldns_rdf
 *
ch›
;

194 i‡(!
d
) {

195  
NULL
;

198 i‡(
	`ldns_rdf_gë_ty≥
(
d
Ë!
LDNS_RDF_TYPE_DNAME
) {

199  
NULL
;

201 i‡(
	`ldns_d«me_œbñ_cou¡
(
d
) == 0) {

203  
NULL
;

206 
œbñ_pos
 = 
	`ldns_rdf_d©a
(
d
)[0];

208 
ch›
 = 
	`ldns_d«me_√w_‰m_d©a
(
	`ldns_rdf_size
(
d
Ë- 
œbñ_pos
 - 1,

209 
	`ldns_rdf_d©a
(
d
Ë+ 
œbñ_pos
 + 1);

210  
ch›
;

211 
	}
}

213 
uöt8_t


214 
	$ldns_d«me_œbñ_cou¡
(c⁄° 
ldns_rdf
 *
r
)

216 
uöt16_t
 
§c_pos
;

217 
uöt16_t
 
Àn
;

218 
uöt8_t
 
i
;

219 
size_t
 
r_size
;

221 i‡(!
r
) {

225 
i
 = 0;

226 
§c_pos
 = 0;

227 
r_size
 = 
	`ldns_rdf_size
(
r
);

229 i‡(
	`ldns_rdf_gë_ty≥
(
r
Ë!
LDNS_RDF_TYPE_DNAME
) {

232 
Àn
 = 
	`ldns_rdf_d©a
(
r
)[
§c_pos
];

235 i‡(1 =
r_size
) {

238 (
Àn
 > 0Ë&& 
§c_pos
 < 
r_size
) {

239 
§c_pos
++;

240 
§c_pos
 +
Àn
;

241 
Àn
 = 
	`ldns_rdf_d©a
(
r
)[
§c_pos
];

242 
i
++;

246  
i
;

247 
	}
}

249 
ldns_rdf
 *

250 
	$ldns_d«me_√w
(
uöt16_t
 
s
, *
d
)

252 
ldns_rdf
 *
rd
;

254 
rd
 = 
	`LDNS_MALLOC
(
ldns_rdf
);

255 i‡(!
rd
) {

256  
NULL
;

258 
	`ldns_rdf_£t_size
(
rd
, 
s
);

259 
	`ldns_rdf_£t_ty≥
(
rd
, 
LDNS_RDF_TYPE_DNAME
);

260 
	`ldns_rdf_£t_d©a
(
rd
, 
d
);

261  
rd
;

262 
	}
}

264 
ldns_rdf
 *

265 
	$ldns_d«me_√w_‰m_°r
(c⁄° *
°r
)

267  
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
°r
);

268 
	}
}

270 
ldns_rdf
 *

271 
	$ldns_d«me_√w_‰m_d©a
(
uöt16_t
 
size
, c⁄° *
d©a
)

273  
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_DNAME
, 
size
, 
d©a
);

274 
	}
}

277 
	$ldns_d«me2ˇn⁄iˇl
(c⁄° 
ldns_rdf
 *
rd
)

279 
uöt8_t
 *
rdd
;

280 
uöt16_t
 
i
;

282 i‡(
	`ldns_rdf_gë_ty≥
(
rd
Ë!
LDNS_RDF_TYPE_DNAME
) {

286 
rdd
 = (
uöt8_t
*)
	`ldns_rdf_d©a
(
rd
);

287 
i
 = 0; i < 
	`ldns_rdf_size
(
rd
); i++, 
rdd
++) {

288 *
rdd
 = (
uöt8_t
)
	`LDNS_DNAME_NORMALIZE
(()*rdd);

290 
	}
}

292 
boﬁ


293 
	$ldns_d«me_is_subdomaö
(c⁄° 
ldns_rdf
 *
sub
, c⁄°Üdns_rd‡*
∑ª¡
)

295 
uöt8_t
 
sub_œb
;

296 
uöt8_t
 
∑r_œb
;

297 
öt8_t
 
i
, 
j
;

298 
ldns_rdf
 *
tmp_sub
 = 
NULL
;

299 
ldns_rdf
 *
tmp_∑r
 = 
NULL
;

300 
ldns_rdf
 *
sub_˛⁄e
;

301 
ldns_rdf
 *
∑ª¡_˛⁄e
;

302 
boﬁ
 
ªsu…
 = 
åue
;

304 i‡(
	`ldns_rdf_gë_ty≥
(
sub
Ë!
LDNS_RDF_TYPE_DNAME
 ||

305 
	`ldns_rdf_gë_ty≥
(
∑ª¡
Ë!
LDNS_RDF_TYPE_DNAME
 ||

306 
	`ldns_rdf_com∑ª
(
sub
, 
∑ª¡
) == 0) {

307  
Ál£
;

311 
sub_˛⁄e
 = 
	`ldns_d«me_˛⁄e_‰om
(
sub
, 0);

312 
∑ª¡_˛⁄e
 = 
	`ldns_d«me_˛⁄e_‰om
(
∑ª¡
, 0);

313 
	`ldns_d«me2ˇn⁄iˇl
(
sub_˛⁄e
);

314 
	`ldns_d«me2ˇn⁄iˇl
(
∑ª¡_˛⁄e
);

316 
sub_œb
 = 
	`ldns_d«me_œbñ_cou¡
(
sub_˛⁄e
);

317 
∑r_œb
 = 
	`ldns_d«me_œbñ_cou¡
(
∑ª¡_˛⁄e
);

320 i‡(
sub_œb
 < 
∑r_œb
) {

321 
ªsu…
 = 
Ál£
;

326 
j
 = 
sub_œb
 - 1;

327 
i
 = 
∑r_œb
 -1; i >= 0; i--) {

328 
tmp_sub
 = 
	`ldns_d«me_œbñ
(
sub_˛⁄e
, 
j
);

329 
tmp_∑r
 = 
	`ldns_d«me_œbñ
(
∑ª¡_˛⁄e
, 
i
);

330 i‡(!
tmp_sub
 || !
tmp_∑r
) {

332 
	`ldns_rdf_dìp_‰ì
(
tmp_sub
);

333 
	`ldns_rdf_dìp_‰ì
(
tmp_∑r
);

334 
ªsu…
 = 
Ál£
;

338 i‡(
	`ldns_rdf_com∑ª
(
tmp_sub
, 
tmp_∑r
) != 0) {

340 
	`ldns_rdf_dìp_‰ì
(
tmp_sub
);

341 
	`ldns_rdf_dìp_‰ì
(
tmp_∑r
);

342 
ªsu…
 = 
Ál£
;

345 
	`ldns_rdf_dìp_‰ì
(
tmp_sub
);

346 
	`ldns_rdf_dìp_‰ì
(
tmp_∑r
);

347 
j
--;

350 
	`ldns_rdf_dìp_‰ì
(
sub_˛⁄e
);

351 
	`ldns_rdf_dìp_‰ì
(
∑ª¡_˛⁄e
);

352  
ªsu…
;

353 
	}
}

356 
	$ldns_d«me_com∑ª
(c⁄° 
ldns_rdf
 *
d«me1
, c⁄°Üdns_rd‡*
d«me2
)

358 
size_t
 
lc1
, 
lc2
, 
lc1f
, 
lc2f
;

359 
size_t
 
i
;

360 
ªsu…
 = 0;

361 
uöt8_t
 *
Õ1
, *
Õ2
;

367 i‡(!
d«me1
 && !
d«me2
) {

370 i‡(!
d«me1
 || !
d«me2
) {

377 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
d«me1
Ë=
LDNS_RDF_TYPE_DNAME
);

378 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
d«me2
Ë=
LDNS_RDF_TYPE_DNAME
);

380 
lc1
 = 
	`ldns_d«me_œbñ_cou¡
(
d«me1
);

381 
lc2
 = 
	`ldns_d«me_œbñ_cou¡
(
d«me2
);

383 i‡(
lc1
 =0 && 
lc2
 == 0) {

386 i‡(
lc1
 == 0) {

389 i‡(
lc2
 == 0) {

392 
lc1
--;

393 
lc2
--;

395 
åue
) {

397 
lc1f
 = 
lc1
;

398 
Õ1
 = 
	`ldns_rdf_d©a
(
d«me1
);

399 
lc1f
 > 0) {

400 
Õ1
 += *lp1 + 1;

401 
lc1f
--;

405 
lc2f
 = 
lc2
;

406 
Õ2
 = 
	`ldns_rdf_d©a
(
d«me2
);

407 
lc2f
 > 0) {

408 
Õ2
 += *lp2 + 1;

409 
lc2f
--;

413 
i
 = 1; i < (
size_t
)(*
Õ1
 + 1); i++) {

414 i‡(
i
 > *
Õ2
) {

416 
ªsu…
 = 1;

417 
d⁄e
;

419 i‡(
	`LDNS_DNAME_NORMALIZE
((Ë*(
Õ1
 + 
i
)) <

420 
	`LDNS_DNAME_NORMALIZE
((Ë*(
Õ2
 + 
i
))) {

421 
ªsu…
 = -1;

422 
d⁄e
;

423 } i‡(
	`LDNS_DNAME_NORMALIZE
((Ë*(
Õ1
 + 
i
)) >

424 
	`LDNS_DNAME_NORMALIZE
((Ë*(
Õ2
 + 
i
))) {

425 
ªsu…
 = 1;

426 
d⁄e
;

429 i‡(*
Õ1
 < *
Õ2
) {

431 
ªsu…
 = -1;

432 
d⁄e
;

434 i‡(
lc1
 =0 && 
lc2
 > 0) {

435 
ªsu…
 = -1;

436 
d⁄e
;

437 } i‡(
lc1
 > 0 && 
lc2
 == 0) {

438 
ªsu…
 = 1;

439 
d⁄e
;

440 } i‡(
lc1
 =0 && 
lc2
 == 0) {

441 
ªsu…
 = 0;

442 
d⁄e
;

444 
lc1
--;

445 
lc2
--;

448 
d⁄e
:

449  
ªsu…
;

450 
	}
}

453 
	$ldns_d«me_is_wûdˇrd
(c⁄° 
ldns_rdf
* 
d«me
)

455  ( 
	`ldns_d«me_œbñ_cou¡
(
d«me
) > 0 &&

456 
	`ldns_rdf_d©a
(
d«me
)[0] == 1 &&

457 
	`ldns_rdf_d©a
(
d«me
)[1] == '*');

458 
	}
}

461 
	$ldns_d«me_m©ch_wûdˇrd
(c⁄° 
ldns_rdf
 *
d«me
, c⁄°Üdns_rd‡*
wûdˇrd
)

463 
ldns_rdf
 *
wc_ch›≥d
;

464 
ªsu…
;

466 i‡(
	`ldns_d«me_is_wûdˇrd
(
wûdˇrd
)) {

470 
wc_ch›≥d
 = 
	`ldns_d«me_À·_ch›
(
wûdˇrd
);

471 
ªsu…
 = (Ë
	`ldns_d«me_is_subdomaö
(
d«me
, 
wc_ch›≥d
);

472 
	`ldns_rdf_dìp_‰ì
(
wc_ch›≥d
);

474 
ªsu…
 = (
	`ldns_d«me_com∑ª
(
d«me
, 
wûdˇrd
) == 0);

476  
ªsu…
;

477 
	}
}

485 
	$ldns_d«me_öãrvÆ
(c⁄° 
ldns_rdf
 *
¥ev
, c⁄°Üdns_rd‡*
middÀ
,

486 c⁄° 
ldns_rdf
 *
√xt
)

488 
¥ev_check
, 
√xt_check
;

490 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
¥ev
Ë=
LDNS_RDF_TYPE_DNAME
);

491 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
middÀ
Ë=
LDNS_RDF_TYPE_DNAME
);

492 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
√xt
Ë=
LDNS_RDF_TYPE_DNAME
);

494 
¥ev_check
 = 
	`ldns_d«me_com∑ª
(
¥ev
, 
middÀ
);

495 
√xt_check
 = 
	`ldns_d«me_com∑ª
(
middÀ
, 
√xt
);

499 i‡(
√xt_check
 == 0) {

504 i‡((
¥ev_check
 == -1 ||Örev_check == 0) &&

506 
√xt_check
 == -1) {

511 
	}
}

514 
boﬁ


515 
	$ldns_d«me_°r_absﬁuã
(c⁄° *
d«me_°r
)

517 c⁄° * 
s
;

518 if(
d«me_°r
 && 
	`°rcmp
(dname_str, ".") == 0)

520 if(!
d«me_°r
 || 
	`°æí
(dname_str) < 2)

522 if(
d«me_°r
[
	`°æí
(dname_str) - 1] != '.')

524 if(
d«me_°r
[
	`°æí
(dname_str) - 2] != '\\')

527 
s
=
d«me_°r
; *s; s++) {

528 if(*
s
 == '\\') {

529 if(
s
[1] && s[2] && s[3]

530 && 
	`isdigô
(
s
[1]) && isdigit(s[2]) &&

531 
	`isdigô
(
s
[3]))

532 
s
 += 3;

533 if(!
s
[1] || 
	`isdigô
(s[1]))

535 
s
++;

537 if(!*(
s
+1) && *s == '.')

541 
	}
}

543 
boﬁ


544 
	$ldns_d«me_absﬁuã
(c⁄° 
ldns_rdf
 *
rdf
)

546 *
°r
 = 
	`ldns_rdf2°r
(
rdf
);

547 i‡(
°r
) {

548 
boﬁ
 
r
 = 
	`ldns_d«me_°r_absﬁuã
(
°r
);

549 
	`LDNS_FREE
(
°r
);

550  
r
;

552  
Ál£
;

553 
	}
}

555 
ldns_rdf
 *

556 
	$ldns_d«me_œbñ
(c⁄° 
ldns_rdf
 *
rdf
, 
uöt8_t
 
œbñpos
)

558 
uöt8_t
 
œbñ˙t
;

559 
uöt16_t
 
§c_pos
;

560 
uöt16_t
 
Àn
;

561 
ldns_rdf
 *
tm≤ew
;

562 
size_t
 
s
;

563 
uöt8_t
 *
d©a
;

565 i‡(
	`ldns_rdf_gë_ty≥
(
rdf
Ë!
LDNS_RDF_TYPE_DNAME
) {

566  
NULL
;

569 
œbñ˙t
 = 0;

570 
§c_pos
 = 0;

571 
s
 = 
	`ldns_rdf_size
(
rdf
);

573 
Àn
 = 
	`ldns_rdf_d©a
(
rdf
)[
§c_pos
];

574 (
Àn
 > 0Ë&& 
§c_pos
 < 
s
) {

575 i‡(
œbñ˙t
 =
œbñpos
) {

577 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
Àn
 + 2);

578 i‡(!
d©a
) {

579  
NULL
;

581 
	`mem˝y
(
d©a
, 
	`ldns_rdf_d©a
(
rdf
Ë+ 
§c_pos
, 
Àn
 + 1);

582 
d©a
[
Àn
 + 2 - 1] = 0;

584 
tm≤ew
 = 
	`ldns_rdf_√w
–
LDNS_RDF_TYPE_DNAME


585 , 
Àn
 + 2, 
d©a
);

586 i‡(!
tm≤ew
) {

587 
	`LDNS_FREE
(
d©a
);

588  
NULL
;

590  
tm≤ew
;

592 
§c_pos
++;

593 
§c_pos
 +
Àn
;

594 
Àn
 = 
	`ldns_rdf_d©a
(
rdf
)[
§c_pos
];

595 
œbñ˙t
++;

597  
NULL
;

598 
	}
}

	@dnssec.c

12 
	~<ldns/c⁄fig.h
>

14 
	~<ldns/ldns.h
>

15 
	~<ldns/dns£c.h
>

17 
	~<°rögs.h
>

18 
	~<time.h
>

20 #ifde‡
HAVE_SSL


21 
	~<›ís¶/s¶.h
>

22 
	~<›ís¶/evp.h
>

23 
	~<›ís¶/ønd.h
>

24 
	~<›ís¶/îr.h
>

25 
	~<›ís¶/md5.h
>

28 
ldns_º
 *

29 
	$ldns_dns£c_gë_ºsig_f‹_«me_™d_ty≥
(c⁄° 
ldns_rdf
 *
«me
,

30 c⁄° 
ldns_º_ty≥
 
ty≥
,

31 c⁄° 
ldns_º_li°
 *
ºs
)

33 
size_t
 
i
;

34 
ldns_º
 *
ˇndid©e
;

36 i‡(!
«me
 || !
ºs
) {

37  
NULL
;

40 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºs
); i++) {

41 
ˇndid©e
 = 
	`ldns_º_li°_º
(
ºs
, 
i
);

42 i‡(
	`ldns_º_gë_ty≥
(
ˇndid©e
Ë=
LDNS_RR_TYPE_RRSIG
) {

43 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
ˇndid©e
),

44 
«me
) == 0 &&

45 
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(
ˇndid©e
))

46 =
ty≥


48  
ˇndid©e
;

53  
NULL
;

54 
	}
}

56 
ldns_º
 *

57 
	$ldns_dns£c_gë_dnskey_f‹_ºsig
(c⁄° 
ldns_º
 *
ºsig
,

58 c⁄° 
ldns_º_li°
 *
ºs
)

60 
size_t
 
i
;

61 
ldns_º
 *
ˇndid©e
;

63 i‡(!
ºsig
 || !
ºs
) {

64  
NULL
;

67 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºs
); i++) {

68 
ˇndid©e
 = 
	`ldns_º_li°_º
(
ºs
, 
i
);

69 i‡(
	`ldns_º_gë_ty≥
(
ˇndid©e
Ë=
LDNS_RR_TYPE_DNSKEY
) {

70 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
ˇndid©e
),

71 
	`ldns_º_ºsig_sig«me
(
ºsig
)) == 0 &&

72 
	`ldns_rdf2«tive_öt16
(
	`ldns_º_ºsig_keyèg
(
ºsig
)) ==

73 
	`ldns_ˇlc_keyèg
(
ˇndid©e
)

75  
ˇndid©e
;

80  
NULL
;

81 
	}
}

83 
ldns_rdf
 *

84 
	$ldns_n£c_gë_bôm≠
(
ldns_º
 *
n£c
) {

85 i‡(
	`ldns_º_gë_ty≥
(
n£c
Ë=
LDNS_RR_TYPE_NSEC
) {

86  
	`ldns_º_rdf
(
n£c
, 1);

87 } i‡(
	`ldns_º_gë_ty≥
(
n£c
Ë=
LDNS_RR_TYPE_NSEC3
) {

88  
	`ldns_º_rdf
(
n£c
, 5);

90  
NULL
;

92 
	}
}

96 
ldns_rdf
 *

97 
ldns_dns£c_n£c3_˛o£°_í˛o£r
(
ldns_rdf
 *
q«me
,

98 
ATTR_UNUSED
(
ldns_º_ty≥
 
qty≥
),

99 
ldns_º_li°
 *
n£c3s
)

102 
uöt8_t
 
	gÆg‹ôhm
;

103 
uöt32_t
 
	gôî©i⁄s
;

104 
uöt8_t
 
	gß…_Àngth
;

105 
uöt8_t
 *
	gß…
;

107 
ldns_rdf
 *
	g¢ame
, *
	ghashed_¢ame
, *
	gtmp
;

108 
boﬁ
 
	gÊag
;

110 
boﬁ
 
	gexa˘_m©ch_found
;

111 
boﬁ
 
	gö_ønge_found
;

113 
ldns_°©us
 
	g°©us
;

114 
ldns_rdf
 *
	gz⁄e_«me
;

116 
size_t
 
	gn£c_i
;

117 
ldns_º
 *
	gn£c
;

118 
ldns_rdf
 *
	gªsu…
 = 
NULL
;

120 i‡(!
	gq«me
 || !
	gn£c3s
 || 
ldns_º_li°_º_cou¡
(
n£c3s
) < 1) {

121  
	gNULL
;

124 
	gn£c
 = 
ldns_º_li°_º
(
n£c3s
, 0);

125 
	gÆg‹ôhm
 = 
ldns_n£c3_Æg‹ôhm
(
n£c
);

126 
	gß…_Àngth
 = 
ldns_n£c3_ß…_Àngth
(
n£c
);

127 
	gß…
 = 
ldns_n£c3_ß…_d©a
(
n£c
);

128 
	gôî©i⁄s
 = 
ldns_n£c3_ôî©i⁄s
(
n£c
);

130 
	g¢ame
 = 
ldns_rdf_˛⁄e
(
q«me
);

132 
	gÊag
 = 
Ál£
;

134 
	gz⁄e_«me
 = 
ldns_d«me_À·_ch›
(
ldns_º_ow√r
(
n£c
));

137 
ldns_d«me_œbñ_cou¡
(
¢ame
) > 0) {

138 
	gexa˘_m©ch_found
 = 
Ál£
;

139 
	gö_ønge_found
 = 
Ál£
;

141 
	ghashed_¢ame
 = 
ldns_n£c3_hash_«me
(
¢ame
,

142 
Æg‹ôhm
,

143 
ôî©i⁄s
,

144 
ß…_Àngth
,

145 
ß…
);

147 
	g°©us
 = 
ldns_d«me_ˇt
(
hashed_¢ame
, 
z⁄e_«me
);

148 if(
	g°©us
 !
LDNS_STATUS_OK
) {

149 
LDNS_FREE
(
ß…
);

150 
ldns_rdf_dìp_‰ì
(
z⁄e_«me
);

151 
ldns_rdf_dìp_‰ì
(
¢ame
);

152  
	gNULL
;

155 
	gn£c_i
 = 0;Ç£c_ò< 
ldns_º_li°_º_cou¡
(
n£c3s
);Çsec_i++) {

156 
	gn£c
 = 
ldns_º_li°_º
(
n£c3s
, 
n£c_i
);

161 i‡(
ldns_d«me_com∑ª
(
ldns_º_ow√r
(
n£c
), 
hashed_¢ame
) == 0) {

162 
exa˘_m©ch_found
 = 
åue
;

163 } i‡(
ldns_n£c_covîs_«me
(
n£c
, 
hashed_¢ame
)) {

164 
	gö_ønge_found
 = 
åue
;

168 i‡(!
	gexa˘_m©ch_found
 && 
	gö_ønge_found
) {

169 
	gÊag
 = 
åue
;

170 } i‡(
	gexa˘_m©ch_found
 && 
	gÊag
) {

171 
	gªsu…
 = 
ldns_rdf_˛⁄e
(
¢ame
);

173 
ldns_rdf_dìp_‰ì
(
hashed_¢ame
);

174 
	gd⁄e
;

175 } i‡(
	gexa˘_m©ch_found
 && !
	gÊag
) {

177 
ldns_rdf_dìp_‰ì
(
hashed_¢ame
);

178 
	gd⁄e
;

180 
	gÊag
 = 
Ál£
;

183 
ldns_rdf_dìp_‰ì
(
hashed_¢ame
);

184 
	gtmp
 = 
¢ame
;

185 
	g¢ame
 = 
ldns_d«me_À·_ch›
(
¢ame
);

186 
ldns_rdf_dìp_‰ì
(
tmp
);

189 
	gd⁄e
:

190 
LDNS_FREE
(
ß…
);

191 
ldns_rdf_dìp_‰ì
(
z⁄e_«me
);

192 
ldns_rdf_dìp_‰ì
(
¢ame
);

194  
	gªsu…
;

197 
boﬁ


198 
	$ldns_dns£c_pkt_has_ºsigs
(c⁄° 
ldns_pkt
 *
pkt
)

200 
size_t
 
i
;

201 
i
 = 0; i < 
	`ldns_pkt_™cou¡
(
pkt
); i++) {

202 i‡(
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
	`ldns_pkt_™swî
(
pkt
), 
i
)) ==

203 
LDNS_RR_TYPE_RRSIG
) {

204  
åue
;

207 
i
 = 0; i < 
	`ldns_pkt_nscou¡
(
pkt
); i++) {

208 i‡(
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
	`ldns_pkt_auth‹ôy
(
pkt
), 
i
)) ==

209 
LDNS_RR_TYPE_RRSIG
) {

210  
åue
;

213  
Ál£
;

214 
	}
}

216 
ldns_º_li°
 *

217 
	$ldns_dns£c_pkt_gë_ºsigs_f‹_«me_™d_ty≥
(c⁄° 
ldns_pkt
 *
pkt
,

218 
ldns_rdf
 *
«me
,

219 
ldns_º_ty≥
 
ty≥
)

221 
uöt16_t
 
t_√t‹dî
;

222 
ldns_º_li°
 *
sigs
;

223 
ldns_º_li°
 *
sigs_covîed
;

224 
ldns_rdf
 *
rdf_t
;

226 
sigs
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
pkt
,

227 
«me
,

228 
LDNS_RR_TYPE_RRSIG
,

229 
LDNS_SECTION_ANY_NOQUESTION


232 
t_√t‹dî
 = 
	`ht⁄s
(
ty≥
);

233 
rdf_t
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_TYPE
, 
LDNS_RDF_SIZE_WORD
, &
t_√t‹dî
);

234 
sigs_covîed
 = 
	`ldns_º_li°_subty≥_by_rdf
(
sigs
, 
rdf_t
, 0);

236 
	`ldns_rdf_‰ì
(
rdf_t
);

237 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

239  
sigs_covîed
;

241 
	}
}

243 
ldns_º_li°
 *

244 
	$ldns_dns£c_pkt_gë_ºsigs_f‹_ty≥
(c⁄° 
ldns_pkt
 *
pkt
, 
ldns_º_ty≥
 
ty≥
)

246 
uöt16_t
 
t_√t‹dî
;

247 
ldns_º_li°
 *
sigs
;

248 
ldns_º_li°
 *
sigs_covîed
;

249 
ldns_rdf
 *
rdf_t
;

251 
sigs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
,

252 
LDNS_RR_TYPE_RRSIG
,

253 
LDNS_SECTION_ANY_NOQUESTION


256 
t_√t‹dî
 = 
	`ht⁄s
(
ty≥
);

257 
rdf_t
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_TYPE
,

259 &
t_√t‹dî
);

260 
sigs_covîed
 = 
	`ldns_º_li°_subty≥_by_rdf
(
sigs
, 
rdf_t
, 0);

262 
	`ldns_rdf_‰ì
(
rdf_t
);

263 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

265  
sigs_covîed
;

267 
	}
}

270 
uöt16_t


271 
	$ldns_ˇlc_keyèg
(c⁄° 
ldns_º
 *
key
)

273 
uöt16_t
 
ac16
;

274 
ldns_buf„r
 *
keybuf
;

275 
size_t
 
keysize
;

277 i‡(!
key
) {

281 i‡(
	`ldns_º_gë_ty≥
(
key
Ë!
LDNS_RR_TYPE_DNSKEY
 &&

282 
	`ldns_º_gë_ty≥
(
key
Ë!
LDNS_RR_TYPE_KEY


288 
keybuf
 = 
	`ldns_buf„r_√w
(
LDNS_MIN_BUFLEN
);

289 i‡(!
keybuf
) {

292 ()
	`ldns_º_rd©a2buf„r_wúe
(
keybuf
, 
key
);

294 
keysize

	`ldns_buf„r_posôi⁄
(
keybuf
);

296 
ac16
 = 
	`ldns_ˇlc_keyèg_øw
(
	`ldns_buf„r_begö
(
keybuf
), 
keysize
);

297 
	`ldns_buf„r_‰ì
(
keybuf
);

298  
ac16
;

299 
	}
}

301 
uöt16_t
 
	$ldns_ˇlc_keyèg_øw
(
uöt8_t
* 
key
, 
size_t
 
keysize
)

303 
i
;

304 
uöt32_t
 
ac32
;

305 
uöt16_t
 
ac16
;

307 if(
keysize
 < 4) {

311 i‡(
key
[3] =
LDNS_RSAMD5
) {

312 
ac16
 = 0;

313 i‡(
keysize
 > 4) {

314 
	`memmove
(&
ac16
, 
key
 + 
keysize
 - 3, 2);

316 
ac16
 = 
	`¡ohs
(ac16);

317  (
uöt16_t
Ë
ac16
;

319 
ac32
 = 0;

320 
i
 = 0; (
size_t
)ò< 
keysize
; ++i) {

321 
ac32
 +(
i
 & 1Ë? 
key
[i] : key[i] << 8;

323 
ac32
 += (ac32 >> 16) & 0xFFFF;

324  (
uöt16_t
Ë(
ac32
 & 0xFFFF);

326 
	}
}

328 #ifde‡
HAVE_SSL


329 
DSA
 *

330 
	$ldns_key_buf2dß
(
ldns_buf„r
 *
key
)

332  
	`ldns_key_buf2dß_øw
((*)
	`ldns_buf„r_begö
(
key
),

333 
	`ldns_buf„r_posôi⁄
(
key
));

334 
	}
}

336 
DSA
 *

337 
	$ldns_key_buf2dß_øw
(* 
key
, 
size_t
 
Àn
)

339 
uöt8_t
 
T
;

340 
uöt16_t
 
Àngth
;

341 
uöt16_t
 
off£t
;

342 
DSA
 *
dß
;

343 
BIGNUM
 *
Q
; BIGNUM *
P
;

344 
BIGNUM
 *
G
; BIGNUM *
Y
;

346 if(
Àn
 == 0)

347  
NULL
;

348 
T
 = (
uöt8_t
)
key
[0];

349 
Àngth
 = (64 + 
T
 * 8);

350 
off£t
 = 1;

352 i‡(
T
 > 8) {

353  
NULL
;

355 if(
Àn
 < (
size_t
)1 + 
SHA_DIGEST_LENGTH
 + 3*
Àngth
)

356  
NULL
;

358 
Q
 = 
	`BN_bö2bn
(
key
+
off£t
, 
SHA_DIGEST_LENGTH
, 
NULL
);

359 
off£t
 +
SHA_DIGEST_LENGTH
;

361 
P
 = 
	`BN_bö2bn
(
key
+
off£t
, ()
Àngth
, 
NULL
);

362 
off£t
 +
Àngth
;

364 
G
 = 
	`BN_bö2bn
(
key
+
off£t
, ()
Àngth
, 
NULL
);

365 
off£t
 +
Àngth
;

367 
Y
 = 
	`BN_bö2bn
(
key
+
off£t
, ()
Àngth
, 
NULL
);

368 
off£t
 +
Àngth
;

371 if(!
Q
 || !
P
 || !
G
 || !
Y
 || !(
dß
 = 
	`DSA_√w
())) {

372 
	`BN_‰ì
(
Q
);

373 
	`BN_‰ì
(
P
);

374 
	`BN_‰ì
(
G
);

375 
	`BN_‰ì
(
Y
);

376  
NULL
;

378 #i‚de‡
S_SPLINT_S


379 
dß
->
p
 = 
P
;

380 
dß
->
q
 = 
Q
;

381 
dß
->
g
 = 
G
;

382 
dß
->
pub_key
 = 
Y
;

385  
dß
;

386 
	}
}

388 
RSA
 *

389 
	$ldns_key_buf2rß
(
ldns_buf„r
 *
key
)

391  
	`ldns_key_buf2rß_øw
((*)
	`ldns_buf„r_begö
(
key
),

392 
	`ldns_buf„r_posôi⁄
(
key
));

393 
	}
}

395 
RSA
 *

396 
	$ldns_key_buf2rß_øw
(* 
key
, 
size_t
 
Àn
)

398 
uöt16_t
 
off£t
;

399 
uöt16_t
 
exp
;

400 
uöt16_t
 
öt16
;

401 
RSA
 *
rß
;

402 
BIGNUM
 *
modulus
;

403 
BIGNUM
 *
exp⁄ít
;

405 i‡(
Àn
 == 0)

406  
NULL
;

407 i‡(
key
[0] == 0) {

408 if(
Àn
 < 3)

409  
NULL
;

413 
	`memmove
(&
öt16
, 
key
+1, 2);

414 
exp
 = 
	`¡ohs
(
öt16
);

415 
off£t
 = 3;

417 
exp
 = 
key
[0];

418 
off£t
 = 1;

422 if(
Àn
 < (
size_t
)
off£t
 + 
exp
 + 1)

423  
NULL
;

426 
exp⁄ít
 = 
	`BN_√w
();

427 if(!
exp⁄ít
Ë 
NULL
;

428 (Ë
	`BN_bö2bn
(
key
+
off£t
, ()
exp
, 
exp⁄ít
);

429 
off£t
 +
exp
;

432 
modulus
 = 
	`BN_√w
();

433 if(!
modulus
) {

434 
	`BN_‰ì
(
exp⁄ít
);

435  
NULL
;

438 (Ë
	`BN_bö2bn
(
key
+
off£t
, ()(
Àn
 - off£t), 
modulus
);

440 
rß
 = 
	`RSA_√w
();

441 if(!
rß
) {

442 
	`BN_‰ì
(
exp⁄ít
);

443 
	`BN_‰ì
(
modulus
);

444  
NULL
;

446 #i‚de‡
S_SPLINT_S


447 
rß
->
n
 = 
modulus
;

448 
rß
->
e
 = 
exp⁄ít
;

451  
rß
;

452 
	}
}

455 
	$ldns_dige°_evp
(* 
d©a
, 
Àn
, * 
de°
,

456 c⁄° 
EVP_MD
* 
md
)

458 
EVP_MD_CTX
* 
˘x
;

459 
˘x
 = 
	`EVP_MD_CTX_¸óã
();

460 if(!
˘x
)

461  
Ál£
;

462 if(!
	`EVP_Dige°Inô_ex
(
˘x
, 
md
, 
NULL
) ||

463 !
	`EVP_Dige°Upd©e
(
˘x
, 
d©a
, 
Àn
) ||

464 !
	`EVP_Dige°FöÆ_ex
(
˘x
, 
de°
, 
NULL
)) {

465 
	`EVP_MD_CTX_de°roy
(
˘x
);

466  
Ál£
;

468 
	`EVP_MD_CTX_de°roy
(
˘x
);

469  
åue
;

470 
	}
}

473 
ldns_º
 *

474 
	$ldns_key_º2ds
(c⁄° 
ldns_º
 *
key
, 
ldns_hash
 
h
)

476 
ldns_rdf
 *
tmp
;

477 
ldns_º
 *
ds
;

478 
uöt16_t
 
keyèg
;

479 
uöt8_t
 
sha1hash
;

480 
uöt8_t
 *
dige°
;

481 
ldns_buf„r
 *
d©a_buf
;

482 #ifde‡
USE_GOST


483 c⁄° 
EVP_MD
* 
md
 = 
NULL
;

486 i‡(
	`ldns_º_gë_ty≥
(
key
Ë!
LDNS_RR_TYPE_DNSKEY
) {

487  
NULL
;

490 
ds
 = 
	`ldns_º_√w
();

491 i‡(!
ds
) {

492  
NULL
;

494 
	`ldns_º_£t_ty≥
(
ds
, 
LDNS_RR_TYPE_DS
);

495 
	`ldns_º_£t_ow√r
(
ds
, 
	`ldns_rdf_˛⁄e
(

496 
	`ldns_º_ow√r
(
key
)));

497 
	`ldns_º_£t_âl
(
ds
, 
	`ldns_º_âl
(
key
));

498 
	`ldns_º_£t_˛ass
(
ds
, 
	`ldns_º_gë_˛ass
(
key
));

500 
h
) {

502 
LDNS_SHA1
:

503 
dige°
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_SHA1_DIGEST_LENGTH
);

504 i‡(!
dige°
) {

505 
	`ldns_º_‰ì
(
ds
);

506  
NULL
;

509 
LDNS_SHA256
:

510 
dige°
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_SHA256_DIGEST_LENGTH
);

511 i‡(!
dige°
) {

512 
	`ldns_º_‰ì
(
ds
);

513  
NULL
;

516 
LDNS_HASH_GOST
:

517 #ifde‡
USE_GOST


518 ()
	`ldns_key_EVP_lﬂd_go°_id
();

519 
md
 = 
	`EVP_gë_dige°by«me
("md_gost94");

520 if(!
md
) {

521 
	`ldns_º_‰ì
(
ds
);

522  
NULL
;

524 
dige°
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
	`EVP_MD_size
(
md
));

525 i‡(!
dige°
) {

526 
	`ldns_º_‰ì
(
ds
);

527  
NULL
;

532 
	`ldns_º_‰ì
(
ds
);

533  
NULL
;

535 
LDNS_SHA384
:

536 #ifde‡
USE_ECDSA


537 
dige°
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
SHA384_DIGEST_LENGTH
);

538 i‡(!
dige°
) {

539 
	`ldns_º_‰ì
(
ds
);

540  
NULL
;

545 
	`ldns_º_‰ì
(
ds
);

546  
NULL
;

550 
d©a_buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

551 i‡(!
d©a_buf
) {

552 
	`LDNS_FREE
(
dige°
);

553 
	`ldns_º_‰ì
(
ds
);

554  
NULL
;

558 
keyèg
 = 
	`ht⁄s
(
	`ldns_ˇlc_keyèg
((
ldns_º
*)
key
));

559 
tmp
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_INT16
,

560 (
uöt16_t
),

561 &
keyèg
);

562 
	`ldns_º_push_rdf
(
ds
, 
tmp
);

565 i‡((
tmp
 = 
	`ldns_º_rdf
(
key
, 2)Ë=
NULL
) {

566 
	`LDNS_FREE
(
dige°
);

567 
	`ldns_buf„r_‰ì
(
d©a_buf
);

568 
	`ldns_º_‰ì
(
ds
);

569  
NULL
;

571 
	`ldns_º_push_rdf
(
ds
, 
	`ldns_rdf_˛⁄e
–
tmp
 ));

575 
sha1hash
 = (
uöt8_t
)
h
;

576 
tmp
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_INT8
,

577 (
uöt8_t
),

578 &
sha1hash
);

579 
	`ldns_º_push_rdf
(
ds
, 
tmp
);

583 
tmp
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_ow√r
(
key
));

584 
	`ldns_d«me2ˇn⁄iˇl
(
tmp
);

585 i‡(
	`ldns_rdf2buf„r_wúe
(
d©a_buf
, 
tmp
Ë!
LDNS_STATUS_OK
) {

586 
	`LDNS_FREE
(
dige°
);

587 
	`ldns_buf„r_‰ì
(
d©a_buf
);

588 
	`ldns_º_‰ì
(
ds
);

589 
	`ldns_rdf_dìp_‰ì
(
tmp
);

590  
NULL
;

592 
	`ldns_rdf_dìp_‰ì
(
tmp
);

595 i‡(
	`ldns_º_rd©a2buf„r_wúe
(
d©a_buf
,

596 (
ldns_º
*)
key
Ë!
LDNS_STATUS_OK
) {

597 
	`LDNS_FREE
(
dige°
);

598 
	`ldns_buf„r_‰ì
(
d©a_buf
);

599 
	`ldns_º_‰ì
(
ds
);

600  
NULL
;

602 
h
) {

603 
LDNS_SHA1
:

604 (Ë
	`ldns_sha1
((*Ë
	`ldns_buf„r_begö
(
d©a_buf
),

605 (Ë
	`ldns_buf„r_posôi⁄
(
d©a_buf
),

606 (*Ë
dige°
);

608 
tmp
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_HEX
,

609 
LDNS_SHA1_DIGEST_LENGTH
,

610 
dige°
);

611 
	`ldns_º_push_rdf
(
ds
, 
tmp
);

614 
LDNS_SHA256
:

615 (Ë
	`ldns_sha256
((*Ë
	`ldns_buf„r_begö
(
d©a_buf
),

616 (Ë
	`ldns_buf„r_posôi⁄
(
d©a_buf
),

617 (*Ë
dige°
);

618 
tmp
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_HEX
,

619 
LDNS_SHA256_DIGEST_LENGTH
,

620 
dige°
);

621 
	`ldns_º_push_rdf
(
ds
, 
tmp
);

623 
LDNS_HASH_GOST
:

624 #ifde‡
USE_GOST


625 if(!
	`ldns_dige°_evp
((*Ë
	`ldns_buf„r_begö
(
d©a_buf
),

626 (Ë
	`ldns_buf„r_posôi⁄
(
d©a_buf
),

627 (*Ë
dige°
, 
md
)) {

628 
	`LDNS_FREE
(
dige°
);

629 
	`ldns_buf„r_‰ì
(
d©a_buf
);

630 
	`ldns_º_‰ì
(
ds
);

631  
NULL
;

633 
tmp
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_HEX
,

634 (
size_t
)
	`EVP_MD_size
(
md
),

635 
dige°
);

636 
	`ldns_º_push_rdf
(
ds
, 
tmp
);

639 
LDNS_SHA384
:

640 #ifde‡
USE_ECDSA


641 (Ë
	`SHA384
((*Ë
	`ldns_buf„r_begö
(
d©a_buf
),

642 (Ë
	`ldns_buf„r_posôi⁄
(
d©a_buf
),

643 (*Ë
dige°
);

644 
tmp
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_HEX
,

645 
SHA384_DIGEST_LENGTH
,

646 
dige°
);

647 
	`ldns_º_push_rdf
(
ds
, 
tmp
);

652 
	`LDNS_FREE
(
dige°
);

653 
	`ldns_buf„r_‰ì
(
d©a_buf
);

654  
ds
;

655 
	}
}

684 
ldns_rdf
 *

685 
	$ldns_dns£c_¸óã_n£c_bôm≠
(
ldns_º_ty≥
 
º_ty≥_li°
[],

686 
size_t
 
size
,

687 
ldns_º_ty≥
 
n£c_ty≥
)

689 
uöt8_t
 
wödow
;

690 
uöt8_t
 
subty≥
;

691 
uöt16_t
 
wödows
[256]

692 #i‚de‡
S_SPLINT_S


696 
ldns_º_ty≥
* 
d
;

697 
size_t
 
i
;

699 
size_t
 
sz
;

700 
uöt8_t
* 
d©a
 = 
NULL
;

701 
uöt8_t
* 
d±r
;

702 
ldns_rdf
* 
rdf
;

704 i‡(
n£c_ty≥
 !
LDNS_RR_TYPE_NSEC
 &&

705 
n£c_ty≥
 !
LDNS_RR_TYPE_NSEC3
) {

706  
NULL
;

711 
d
 = 
º_ty≥_li°
; d <Ñr_ty≥_li° + 
size
; d++) {

712 
wödow
 = *
d
 >> 8;

713 
subty≥
 = *
d
 & 0xff;

714 i‡(
wödows
[
wödow
] < 
subty≥
) {

715 
wödows
[
wödow
] = 
subty≥
;

721 
sz
 = 0;

722 
i
 = 0; i < 256; i++) {

723 i‡(
wödows
[
i
]) {

724 
sz
 +
wödows
[
i
] / 8 + 3;

727 i‡(
sz
 > 0) {

730 
d±r
 = 
d©a
 = 
	`LDNS_CALLOC
(
uöt8_t
, 
sz
);

731 i‡(!
d©a
) {

732  
NULL
;

734 
i
 = 0; i < 256; i++) {

735 i‡(
wödows
[
i
]) {

736 *
d±r
++ = (
uöt8_t
)
i
;

737 *
d±r
++ = (
uöt8_t
)(
wödows
[
i
] / 8 + 1);

742 
wödows
[
i
] = (
uöt16_t
)(
d±r
 - 
d©a
);

744 
d±r
 += dptr[-1];

751 
d
 = 
º_ty≥_li°
; d <Ñr_ty≥_li° + 
size
; d++) {

752 
subty≥
 = *
d
 & 0xff;

753 
d©a
[
wödows
[*
d
 >> 8] + 
subty≥
/8] |= (0x80 >> (subtype % 8));

758 
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_BITMAP
, 
sz
, 
d©a
);

759 i‡(!
rdf
) {

760 
	`LDNS_FREE
(
d©a
);

761  
NULL
;

763  
rdf
;

764 
	}
}

767 
	$ldns_dns£c_º£ts_c⁄èös_ty≥
(
ldns_dns£c_º£ts
 *
º£ts
,

768 
ldns_º_ty≥
 
ty≥
)

770 
ldns_dns£c_º£ts
 *
cur_º£t
 = 
º£ts
;

771 
cur_º£t
) {

772 i‡(
cur_º£t
->
ty≥
 ==Åype) {

775 
cur_º£t
 = cur_º£t->
√xt
;

778 
	}
}

780 
ldns_º
 *

781 
	$ldns_dns£c_¸óã_n£c
(
ldns_dns£c_«me
 *
‰om
,

782 
ldns_dns£c_«me
 *
to
,

783 
ldns_º_ty≥
 
n£c_ty≥
)

785 
ldns_º
 *
n£c_º
;

786 
ldns_º_ty≥
 
ty≥s
[65536];

787 
size_t
 
ty≥_cou¡
 = 0;

788 
ldns_dns£c_º£ts
 *
cur_º£ts
;

789 
⁄_dñeg©i⁄_poöt
;

791 i‡(!
‰om
 || !
to
 || (
n£c_ty≥
 !
LDNS_RR_TYPE_NSEC
)) {

792  
NULL
;

795 
n£c_º
 = 
	`ldns_º_√w
();

796 
	`ldns_º_£t_ty≥
(
n£c_º
, 
n£c_ty≥
);

797 
	`ldns_º_£t_ow√r
(
n£c_º
, 
	`ldns_rdf_˛⁄e
(
	`ldns_dns£c_«me_«me
(
‰om
)));

798 
	`ldns_º_push_rdf
(
n£c_º
, 
	`ldns_rdf_˛⁄e
(
	`ldns_dns£c_«me_«me
(
to
)));

800 
⁄_dñeg©i⁄_poöt
 = 
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

801 
‰om
->
º£ts
, 
LDNS_RR_TYPE_NS
)

802 && !
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

803 
‰om
->
º£ts
, 
LDNS_RR_TYPE_SOA
);

805 
cur_º£ts
 = 
‰om
->
º£ts
;

806 
cur_º£ts
) {

809 i‡((
⁄_dñeg©i⁄_poöt
 && (

810 
cur_º£ts
->
ty≥
 =
LDNS_RR_TYPE_NS


811 || 
cur_º£ts
->
ty≥
 =
LDNS_RR_TYPE_DS
))

812 || (!
⁄_dñeg©i⁄_poöt
 &&

813 
cur_º£ts
->
ty≥
 !
LDNS_RR_TYPE_RRSIG


814 && 
cur_º£ts
->
ty≥
 !
LDNS_RR_TYPE_NSEC
)) {

816 
ty≥s
[
ty≥_cou¡
] = 
cur_º£ts
->
ty≥
;

817 
ty≥_cou¡
++;

819 
cur_º£ts
 = cur_º£ts->
√xt
;

822 
ty≥s
[
ty≥_cou¡
] = 
LDNS_RR_TYPE_RRSIG
;

823 
ty≥_cou¡
++;

824 
ty≥s
[
ty≥_cou¡
] = 
LDNS_RR_TYPE_NSEC
;

825 
ty≥_cou¡
++;

827 
	`ldns_º_push_rdf
(
n£c_º
, 
	`ldns_dns£c_¸óã_n£c_bôm≠
(
ty≥s
,

828 
ty≥_cou¡
,

829 
n£c_ty≥
));

831  
n£c_º
;

832 
	}
}

834 
ldns_º
 *

835 
	$ldns_dns£c_¸óã_n£c3
(
ldns_dns£c_«me
 *
‰om
,

836 
ldns_dns£c_«me
 *
to
,

837 
ldns_rdf
 *
z⁄e_«me
,

838 
uöt8_t
 
Æg‹ôhm
,

839 
uöt8_t
 
Êags
,

840 
uöt16_t
 
ôî©i⁄s
,

841 
uöt8_t
 
ß…_Àngth
,

842 
uöt8_t
 *
ß…
)

844 
ldns_º
 *
n£c_º
;

845 
ldns_º_ty≥
 
ty≥s
[65536];

846 
size_t
 
ty≥_cou¡
 = 0;

847 
ldns_dns£c_º£ts
 *
cur_º£ts
;

848 
ldns_°©us
 
°©us
;

849 
⁄_dñeg©i⁄_poöt
;

851 i‡(!
‰om
) {

852  
NULL
;

855 
n£c_º
 = 
	`ldns_º_√w_‰m_ty≥
(
LDNS_RR_TYPE_NSEC3
);

856 
	`ldns_º_£t_ow√r
(
n£c_º
,

857 
	`ldns_n£c3_hash_«me
(
	`ldns_dns£c_«me_«me
(
‰om
),

858 
Æg‹ôhm
,

859 
ôî©i⁄s
,

860 
ß…_Àngth
,

861 
ß…
));

862 
°©us
 = 
	`ldns_d«me_ˇt
(
	`ldns_º_ow√r
(
n£c_º
), 
z⁄e_«me
);

863 if(
°©us
 !
LDNS_STATUS_OK
) {

864 
	`ldns_º_‰ì
(
n£c_º
);

865  
NULL
;

867 
	`ldns_n£c3_add_∑øm_rdfs
(
n£c_º
,

868 
Æg‹ôhm
,

869 
Êags
,

870 
ôî©i⁄s
,

871 
ß…_Àngth
,

872 
ß…
);

874 
⁄_dñeg©i⁄_poöt
 = 
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

875 
‰om
->
º£ts
, 
LDNS_RR_TYPE_NS
)

876 && !
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

877 
‰om
->
º£ts
, 
LDNS_RR_TYPE_SOA
);

878 
cur_º£ts
 = 
‰om
->
º£ts
;

879 
cur_º£ts
) {

886 i‡((
⁄_dñeg©i⁄_poöt
 && (

887 
cur_º£ts
->
ty≥
 =
LDNS_RR_TYPE_NS


888 || 
cur_º£ts
->
ty≥
 =
LDNS_RR_TYPE_DS
))

889 || (!
⁄_dñeg©i⁄_poöt
 &&

890 
cur_º£ts
->
ty≥
 !
LDNS_RR_TYPE_RRSIG
)) {

892 
ty≥s
[
ty≥_cou¡
] = 
cur_º£ts
->
ty≥
;

893 
ty≥_cou¡
++;

895 
cur_º£ts
 = cur_º£ts->
√xt
;

900 i‡(
ty≥_cou¡
 > 0 &&

901 !(
ty≥_cou¡
 =1 && 
ty≥s
[0] =
LDNS_RR_TYPE_NS
)) {

902 
ty≥s
[
ty≥_cou¡
] = 
LDNS_RR_TYPE_RRSIG
;

903 
ty≥_cou¡
++;

907 i‡(
to
 &&Åo->
hashed_«me
) {

908 (Ë
	`ldns_º_£t_rdf
(
n£c_º
,

909 
	`ldns_rdf_˛⁄e
(
to
->
hashed_«me
),

912 (Ë
	`ldns_º_£t_rdf
(
n£c_º
, 
NULL
, 4);

915 
	`ldns_º_push_rdf
(
n£c_º
,

916 
	`ldns_dns£c_¸óã_n£c_bôm≠
(
ty≥s
,

917 
ty≥_cou¡
,

918 
LDNS_RR_TYPE_NSEC3
));

920  
n£c_º
;

921 
	}
}

923 
ldns_º
 *

924 
	$ldns_¸óã_n£c
(
ldns_rdf
 *
cur_ow√r
,Üdns_rd‡*
√xt_ow√r
, 
ldns_º_li°
 *
ºs
)

934 
uöt16_t
 
i
;

935 
ldns_º
 *
i_º
;

936 
uöt16_t
 
i_ty≥
;

938 
ldns_º
 *
n£c
 = 
NULL
;

939 
ldns_º_ty≥
 
i_ty≥_li°
[65536];

940 
size_t
 
ty≥_cou¡
 = 0;

942 
n£c
 = 
	`ldns_º_√w
();

943 
	`ldns_º_£t_ty≥
(
n£c
, 
LDNS_RR_TYPE_NSEC
);

944 
	`ldns_º_£t_ow√r
(
n£c
, 
	`ldns_rdf_˛⁄e
(
cur_ow√r
));

945 
	`ldns_º_push_rdf
(
n£c
, 
	`ldns_rdf_˛⁄e
(
√xt_ow√r
));

947 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºs
); i++) {

948 
i_º
 = 
	`ldns_º_li°_º
(
ºs
, 
i
);

949 i‡(
	`ldns_rdf_com∑ª
(
cur_ow√r
,

950 
	`ldns_º_ow√r
(
i_º
)) == 0) {

951 
i_ty≥
 = 
	`ldns_º_gë_ty≥
(
i_º
);

952 i‡(
i_ty≥
 !
LDNS_RR_TYPE_RRSIG
 && i_ty≥ !
LDNS_RR_TYPE_NSEC
) {

953 i‡(
ty≥_cou¡
 =0 || 
i_ty≥_li°
[ty≥_cou¡-1] !
i_ty≥
) {

954 
i_ty≥_li°
[
ty≥_cou¡
] = 
i_ty≥
;

955 
ty≥_cou¡
++;

961 
i_ty≥_li°
[
ty≥_cou¡
] = 
LDNS_RR_TYPE_RRSIG
;

962 
ty≥_cou¡
++;

963 
i_ty≥_li°
[
ty≥_cou¡
] = 
LDNS_RR_TYPE_NSEC
;

964 
ty≥_cou¡
++;

966 
	`ldns_º_push_rdf
(
n£c
,

967 
	`ldns_dns£c_¸óã_n£c_bôm≠
(
i_ty≥_li°
,

968 
ty≥_cou¡
, 
LDNS_RR_TYPE_NSEC
));

970  
n£c
;

971 
	}
}

973 
ldns_rdf
 *

974 
	$ldns_n£c3_hash_«me
(
ldns_rdf
 *
«me
,

975 
uöt8_t
 
Æg‹ôhm
,

976 
uöt16_t
 
ôî©i⁄s
,

977 
uöt8_t
 
ß…_Àngth
,

978 
uöt8_t
 *
ß…
)

980 
size_t
 
hashed_ow√r_°r_Àn
;

981 
ldns_rdf
 *
ˇ¬
;

982 
ldns_rdf
 *
hashed_ow√r
;

983 *
hashed_ow√r_°r
;

984 *
hashed_ow√r_b32
;

985 
size_t
 
hashed_ow√r_b32_Àn
;

986 
uöt32_t
 
cur_ô
;

989 
hash
[
LDNS_SHA1_DIGEST_LENGTH
];

990 
ldns_°©us
 
°©us
;

993 i‡(
Æg‹ôhm
 !
LDNS_SHA1
) {

994  
NULL
;

998 
ˇ¬
 = 
	`ldns_rdf_˛⁄e
(
«me
);

999 if(!
ˇ¬
) {

1000 #ifde‡
STDERR_MSGS


1001 
	`Ârötf
(
°dîr
, "MemoryÉrror\n");

1003  
NULL
;

1005 
	`ldns_d«me2ˇn⁄iˇl
(
ˇ¬
);

1007 
hashed_ow√r_°r_Àn
 = 
ß…_Àngth
 + 
	`ldns_rdf_size
(
ˇ¬
);

1008 
hashed_ow√r_°r
 = 
	`LDNS_XMALLOC
(, 
hashed_ow√r_°r_Àn
);

1009 if(!
hashed_ow√r_°r
) {

1010 
	`ldns_rdf_dìp_‰ì
(
ˇ¬
);

1011  
NULL
;

1013 
	`mem˝y
(
hashed_ow√r_°r
, 
	`ldns_rdf_d©a
(
ˇ¬
), 
	`ldns_rdf_size
(cann));

1014 
	`mem˝y
(
hashed_ow√r_°r
 + 
	`ldns_rdf_size
(
ˇ¬
), 
ß…
, 
ß…_Àngth
);

1015 
	`ldns_rdf_dìp_‰ì
(
ˇ¬
);

1017 
cur_ô
 = 
ôî©i⁄s
 + 1; cur_it > 0; cur_it--) {

1018 (Ë
	`ldns_sha1
((*Ë
hashed_ow√r_°r
,

1019 (Ë
hashed_ow√r_°r_Àn
, 
hash
);

1021 
	`LDNS_FREE
(
hashed_ow√r_°r
);

1022 
hashed_ow√r_°r_Àn
 = 
ß…_Àngth
 + 
LDNS_SHA1_DIGEST_LENGTH
;

1023 
hashed_ow√r_°r
 = 
	`LDNS_XMALLOC
(, 
hashed_ow√r_°r_Àn
);

1024 i‡(!
hashed_ow√r_°r
) {

1025  
NULL
;

1027 
	`mem˝y
(
hashed_ow√r_°r
, 
hash
, 
LDNS_SHA1_DIGEST_LENGTH
);

1028 
	`mem˝y
(
hashed_ow√r_°r
 + 
LDNS_SHA1_DIGEST_LENGTH
, 
ß…
, 
ß…_Àngth
);

1029 
hashed_ow√r_°r_Àn
 = 
LDNS_SHA1_DIGEST_LENGTH
 + 
ß…_Àngth
;

1032 
	`LDNS_FREE
(
hashed_ow√r_°r
);

1033 
hashed_ow√r_°r
 = 
hash
;

1034 
hashed_ow√r_°r_Àn
 = 
LDNS_SHA1_DIGEST_LENGTH
;

1036 
hashed_ow√r_b32
 = 
	`LDNS_XMALLOC
(,

1037 
	`ldns_b32_¡›_ˇlcuœã_size
(
hashed_ow√r_°r_Àn
) + 1);

1038 if(!
hashed_ow√r_b32
) {

1039  
NULL
;

1041 
hashed_ow√r_b32_Àn
 = (
size_t
Ë
	`ldns_b32_¡›_exãnded_hex
(

1042 (
uöt8_t
 *Ë
hashed_ow√r_°r
,

1043 
hashed_ow√r_°r_Àn
,

1044 
hashed_ow√r_b32
,

1045 
	`ldns_b32_¡›_ˇlcuœã_size
(
hashed_ow√r_°r_Àn
)+1);

1046 i‡(
hashed_ow√r_b32_Àn
 < 1) {

1047 #ifde‡
STDERR_MSGS


1048 
	`Ârötf
(
°dîr
, "Error in base32Éxtended hexÉncoding ");

1049 
	`Ârötf
(
°dîr
, "of hashed ownerÇame (name: ");

1050 
	`ldns_rdf_¥öt
(
°dîr
, 
«me
);

1051 
	`Ârötf
(
°dîr
, ",Ñeturn code: %u)\n",

1052 (Ë
hashed_ow√r_b32_Àn
);

1054 
	`LDNS_FREE
(
hashed_ow√r_b32
);

1055  
NULL
;

1057 
hashed_ow√r_b32
[
hashed_ow√r_b32_Àn
] = '\0';

1059 
°©us
 = 
	`ldns_°r2rdf_d«me
(&
hashed_ow√r
, 
hashed_ow√r_b32
);

1060 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1061 #ifde‡
STDERR_MSGS


1062 
	`Ârötf
(
°dîr
, "Eº‹ cª©ögÑd‡‰om %s\n", 
hashed_ow√r_b32
);

1064 
	`LDNS_FREE
(
hashed_ow√r_b32
);

1065  
NULL
;

1068 
	`LDNS_FREE
(
hashed_ow√r_b32
);

1069  
hashed_ow√r
;

1070 
	}
}

1073 
	$ldns_n£c3_add_∑øm_rdfs
(
ldns_º
 *
º
,

1074 
uöt8_t
 
Æg‹ôhm
,

1075 
uöt8_t
 
Êags
,

1076 
uöt16_t
 
ôî©i⁄s
,

1077 
uöt8_t
 
ß…_Àngth
,

1078 
uöt8_t
 *
ß…
)

1080 
ldns_rdf
 *
ß…_rdf
 = 
NULL
;

1081 
uöt8_t
 *
ß…_d©a
 = 
NULL
;

1082 
ldns_rdf
 *
ﬁd
;

1084 
ﬁd
 = 
	`ldns_º_£t_rdf
(
º
,

1085 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_INT8
,

1086 1, (*)&
Æg‹ôhm
),

1088 i‡(
ﬁd
Ë
	`ldns_rdf_dìp_‰ì
(old);

1090 
ﬁd
 = 
	`ldns_º_£t_rdf
(
º
,

1091 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_INT8
,

1092 1, (*)&
Êags
),

1094 i‡(
ﬁd
Ë
	`ldns_rdf_dìp_‰ì
(old);

1096 
ﬁd
 = 
	`ldns_º_£t_rdf
(
º
,

1097 
	`ldns_«tive2rdf_öt16
(
LDNS_RDF_TYPE_INT16
,

1098 
ôî©i⁄s
),

1100 i‡(
ﬁd
Ë
	`ldns_rdf_dìp_‰ì
(old);

1102 
ß…_d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
ß…_Àngth
 + 1);

1103 if(!
ß…_d©a
) {

1107 
ß…_d©a
[0] = 
ß…_Àngth
;

1108 
	`mem˝y
(
ß…_d©a
 + 1, 
ß…
, 
ß…_Àngth
);

1109 
ß…_rdf
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_NSEC3_SALT
,

1110 
ß…_Àngth
 + 1,

1111 
ß…_d©a
);

1112 if(!
ß…_rdf
) {

1113 
	`LDNS_FREE
(
ß…_d©a
);

1118 
ﬁd
 = 
	`ldns_º_£t_rdf
(
º
, 
ß…_rdf
, 3);

1119 i‡(
ﬁd
Ë
	`ldns_rdf_dìp_‰ì
(old);

1120 
	`LDNS_FREE
(
ß…_d©a
);

1121 
	}
}

1124 
	$º_li°_dñeg©i⁄_⁄ly
(
ldns_rdf
 *
‹igö
, 
ldns_º_li°
 *
º_li°
)

1126 
size_t
 
i
;

1127 
ldns_º
 *
cur_º
;

1128 i‡(!
‹igö
 || !
º_li°
)  0;

1129 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

1130 
cur_º
 = 
	`ldns_º_li°_º
(
º_li°
, 
i
);

1131 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
cur_º
), 
‹igö
) == 0) {

1134 i‡(
	`ldns_º_gë_ty≥
(
cur_º
Ë!
LDNS_RR_TYPE_NS
) {

1139 
	}
}

1143 
ldns_º
 *

1144 
	$ldns_¸óã_n£c3
(
ldns_rdf
 *
cur_ow√r
,

1145 
ldns_rdf
 *
cur_z⁄e
,

1146 
ldns_º_li°
 *
ºs
,

1147 
uöt8_t
 
Æg‹ôhm
,

1148 
uöt8_t
 
Êags
,

1149 
uöt16_t
 
ôî©i⁄s
,

1150 
uöt8_t
 
ß…_Àngth
,

1151 
uöt8_t
 *
ß…
,

1152 
boﬁ
 
em±yn⁄ãrmöÆ
)

1154 
size_t
 
i
;

1155 
ldns_º
 *
i_º
;

1156 
uöt16_t
 
i_ty≥
;

1158 
ldns_º
 *
n£c
 = 
NULL
;

1159 
ldns_rdf
 *
hashed_ow√r
 = 
NULL
;

1161 
ldns_°©us
 
°©us
;

1163 
ldns_º_ty≥
 
i_ty≥_li°
[1024];

1164 
size_t
 
ty≥_cou¡
 = 0;

1166 
hashed_ow√r
 = 
	`ldns_n£c3_hash_«me
(
cur_ow√r
,

1167 
Æg‹ôhm
,

1168 
ôî©i⁄s
,

1169 
ß…_Àngth
,

1170 
ß…
);

1171 
°©us
 = 
	`ldns_d«me_ˇt
(
hashed_ow√r
, 
cur_z⁄e
);

1172 if(
°©us
 !
LDNS_STATUS_OK
) {

1173 
	`ldns_rdf_dìp_‰ì
(
hashed_ow√r
);

1174  
NULL
;

1176 
n£c
 = 
	`ldns_º_√w_‰m_ty≥
(
LDNS_RR_TYPE_NSEC3
);

1177 if(!
n£c
) {

1178 
	`ldns_rdf_dìp_‰ì
(
hashed_ow√r
);

1179  
NULL
;

1181 
	`ldns_º_£t_ty≥
(
n£c
, 
LDNS_RR_TYPE_NSEC3
);

1182 
	`ldns_º_£t_ow√r
(
n£c
, 
hashed_ow√r
);

1184 
	`ldns_n£c3_add_∑øm_rdfs
(
n£c
,

1185 
Æg‹ôhm
,

1186 
Êags
,

1187 
ôî©i⁄s
,

1188 
ß…_Àngth
,

1189 
ß…
);

1190 (Ë
	`ldns_º_£t_rdf
(
n£c
, 
NULL
, 4);

1193 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºs
); i++) {

1194 
i_º
 = 
	`ldns_º_li°_º
(
ºs
, 
i
);

1195 i‡(
	`ldns_rdf_com∑ª
(
cur_ow√r
,

1196 
	`ldns_º_ow√r
(
i_º
)) == 0) {

1197 
i_ty≥
 = 
	`ldns_º_gë_ty≥
(
i_º
);

1198 i‡(
ty≥_cou¡
 =0 || 
i_ty≥_li°
[ty≥_cou¡-1] !
i_ty≥
) {

1199 
i_ty≥_li°
[
ty≥_cou¡
] = 
i_ty≥
;

1200 
ty≥_cou¡
++;

1207 i‡(!
em±yn⁄ãrmöÆ
 && !
	`º_li°_dñeg©i⁄_⁄ly
(
cur_z⁄e
, 
ºs
)) {

1208 
i_ty≥_li°
[
ty≥_cou¡
] = 
LDNS_RR_TYPE_RRSIG
;

1209 
ty≥_cou¡
++;

1213 i‡(
	`ldns_d«me_com∑ª
(
cur_z⁄e
, 
cur_ow√r
) == 0) {

1214 
i_ty≥_li°
[
ty≥_cou¡
] = 
LDNS_RR_TYPE_SOA
;

1215 
ty≥_cou¡
++;

1218 
	`ldns_º_push_rdf
(
n£c
,

1219 
	`ldns_dns£c_¸óã_n£c_bôm≠
(
i_ty≥_li°
,

1220 
ty≥_cou¡
, 
LDNS_RR_TYPE_NSEC3
));

1222  
n£c
;

1223 
	}
}

1225 
uöt8_t


1226 
	$ldns_n£c3_Æg‹ôhm
(c⁄° 
ldns_º
 *
n£c3_º
)

1228 i‡(
n£c3_º
 &&

1229 (
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3
 ||

1230 
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3PARAM
)

1231 && (
	`ldns_º_rdf
(
n£c3_º
, 0Ë!
NULL
)

1232 && 
	`ldns_rdf_size
(
	`ldns_º_rdf
(
n£c3_º
, 0)) > 0) {

1233  
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
n£c3_º
, 0));

1236 
	}
}

1238 
uöt8_t


1239 
	$ldns_n£c3_Êags
(c⁄° 
ldns_º
 *
n£c3_º
)

1241 i‡(
n£c3_º
 &&

1242 (
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3
 ||

1243 
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3PARAM
)

1244 && (
	`ldns_º_rdf
(
n£c3_º
, 1Ë!
NULL
)

1245 && 
	`ldns_rdf_size
(
	`ldns_º_rdf
(
n£c3_º
, 1)) > 0) {

1246  
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
n£c3_º
, 1));

1249 
	}
}

1251 
boﬁ


1252 
	$ldns_n£c3_›tout
(c⁄° 
ldns_º
 *
n£c3_º
)

1254  (
	`ldns_n£c3_Êags
(
n£c3_º
Ë& 
LDNS_NSEC3_VARS_OPTOUT_MASK
);

1255 
	}
}

1257 
uöt16_t


1258 
	$ldns_n£c3_ôî©i⁄s
(c⁄° 
ldns_º
 *
n£c3_º
)

1260 i‡(
n£c3_º
 &&

1261 (
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3
 ||

1262 
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3PARAM
)

1263 && (
	`ldns_º_rdf
(
n£c3_º
, 2Ë!
NULL
)

1264 && 
	`ldns_rdf_size
(
	`ldns_º_rdf
(
n£c3_º
, 2)) > 0) {

1265  
	`ldns_rdf2«tive_öt16
(
	`ldns_º_rdf
(
n£c3_º
, 2));

1269 
	}
}

1271 
ldns_rdf
 *

1272 
	$ldns_n£c3_ß…
(c⁄° 
ldns_º
 *
n£c3_º
)

1274 i‡(
n£c3_º
 &&

1275 (
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3
 ||

1276 
	`ldns_º_gë_ty≥
(
n£c3_º
Ë=
LDNS_RR_TYPE_NSEC3PARAM
)

1278  
	`ldns_º_rdf
(
n£c3_º
, 3);

1280  
NULL
;

1281 
	}
}

1283 
uöt8_t


1284 
	$ldns_n£c3_ß…_Àngth
(c⁄° 
ldns_º
 *
n£c3_º
)

1286 
ldns_rdf
 *
ß…_rdf
 = 
	`ldns_n£c3_ß…
(
n£c3_º
);

1287 i‡(
ß…_rdf
 && 
	`ldns_rdf_size
(salt_rdf) > 0) {

1288  (
uöt8_t
Ë
	`ldns_rdf_d©a
(
ß…_rdf
)[0];

1291 
	}
}

1294 
uöt8_t
 *

1295 
	$ldns_n£c3_ß…_d©a
(c⁄° 
ldns_º
 *
n£c3_º
)

1297 
uöt8_t
 
ß…_Àngth
;

1298 
uöt8_t
 *
ß…
;

1300 
ldns_rdf
 *
ß…_rdf
 = 
	`ldns_n£c3_ß…
(
n£c3_º
);

1301 i‡(
ß…_rdf
 && 
	`ldns_rdf_size
(salt_rdf) > 0) {

1302 
ß…_Àngth
 = 
	`ldns_rdf_d©a
(
ß…_rdf
)[0];

1303 
ß…
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
ß…_Àngth
);

1304 if(!
ß…
Ë 
NULL
;

1305 
	`mem˝y
(
ß…
, &
	`ldns_rdf_d©a
(
ß…_rdf
)[1], 
ß…_Àngth
);

1306  
ß…
;

1308  
NULL
;

1309 
	}
}

1311 
ldns_rdf
 *

1312 
	$ldns_n£c3_√xt_ow√r
(c⁄° 
ldns_º
 *
n£c3_º
)

1314 i‡(!
n£c3_º
 || 
	`ldns_º_gë_ty≥
“£c3_ºË!
LDNS_RR_TYPE_NSEC3
) {

1315  
NULL
;

1317  
	`ldns_º_rdf
(
n£c3_º
, 4);

1319 
	}
}

1321 
ldns_rdf
 *

1322 
	$ldns_n£c3_bôm≠
(c⁄° 
ldns_º
 *
n£c3_º
)

1324 i‡(!
n£c3_º
 || 
	`ldns_º_gë_ty≥
“£c3_ºË!
LDNS_RR_TYPE_NSEC3
) {

1325  
NULL
;

1327  
	`ldns_º_rdf
(
n£c3_º
, 5);

1329 
	}
}

1331 
ldns_rdf
 *

1332 
	$ldns_n£c3_hash_«me_‰m_n£c3
(c⁄° 
ldns_º
 *
n£c
, 
ldns_rdf
 *
«me
)

1334 
uöt8_t
 
Æg‹ôhm
;

1335 
uöt16_t
 
ôî©i⁄s
;

1336 
uöt8_t
 
ß…_Àngth
;

1337 
uöt8_t
 *
ß…
 = 0;

1339 
ldns_rdf
 *
hashed_ow√r
;

1341 
Æg‹ôhm
 = 
	`ldns_n£c3_Æg‹ôhm
(
n£c
);

1342 
ß…_Àngth
 = 
	`ldns_n£c3_ß…_Àngth
(
n£c
);

1343 
ß…
 = 
	`ldns_n£c3_ß…_d©a
(
n£c
);

1344 
ôî©i⁄s
 = 
	`ldns_n£c3_ôî©i⁄s
(
n£c
);

1346 
hashed_ow√r
 = 
	`ldns_n£c3_hash_«me
(
«me
,

1347 
Æg‹ôhm
,

1348 
ôî©i⁄s
,

1349 
ß…_Àngth
,

1350 
ß…
);

1352 
	`LDNS_FREE
(
ß…
);

1353  
hashed_ow√r
;

1354 
	}
}

1356 
boﬁ


1357 
	$ldns_n£c_bôm≠_covîs_ty≥
(c⁄° 
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
)

1359 
uöt8_t
* 
d±r
;

1360 
uöt8_t
* 
díd
;

1367 
uöt8_t
 
wödow
 = 
ty≥
 >> 8;

1368 
uöt8_t
 
subty≥
 = 
ty≥
 & 0xff;

1370 i‡(! 
bôm≠
) {

1371  
Ál£
;

1373 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
bôm≠
Ë=
LDNS_RDF_TYPE_BITMAP
);

1375 
d±r
 = 
	`ldns_rdf_d©a
(
bôm≠
);

1376 
díd
 = 
	`ldns_rdf_d©a
(
bôm≠
Ë+ 
	`ldns_rdf_size
(bitmap);

1381 
d±r
 < 
díd
 && d±r[0] <
wödow
) {

1383 i‡(
d±r
[0] =
wödow
 && 
subty≥
 / 8 < dptr[1] &&

1384 
d±r
 + d±r[1] + 2 <
díd
) {

1386  
d±r
[2 + 
subty≥
 / 8] & (0x80 >> (subtype % 8));

1388 
d±r
 += dptr[1] + 2;

1390  
Ál£
;

1391 
	}
}

1393 
ldns_°©us


1394 
	$ldns_n£c_bôm≠_£t_ty≥
(
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
)

1396 
uöt8_t
* 
d±r
;

1397 
uöt8_t
* 
díd
;

1404 
uöt8_t
 
wödow
 = 
ty≥
 >> 8;

1405 
uöt8_t
 
subty≥
 = 
ty≥
 & 0xff;

1407 i‡(! 
bôm≠
) {

1408  
Ál£
;

1410 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
bôm≠
Ë=
LDNS_RDF_TYPE_BITMAP
);

1412 
d±r
 = 
	`ldns_rdf_d©a
(
bôm≠
);

1413 
díd
 = 
	`ldns_rdf_d©a
(
bôm≠
Ë+ 
	`ldns_rdf_size
(bitmap);

1418 
d±r
 < 
díd
 && d±r[0] <
wödow
) {

1420 i‡(
d±r
[0] =
wödow
 && 
subty≥
 / 8 < dptr[1] &&

1421 
d±r
 + d±r[1] + 2 <
díd
) {

1423 
d±r
[2 + 
subty≥
 / 8] |= (0x80 >> (subtype % 8));

1424  
LDNS_STATUS_OK
;

1426 
d±r
 += dptr[1] + 2;

1428  
LDNS_STATUS_TYPE_NOT_IN_BITMAP
;

1429 
	}
}

1431 
ldns_°©us


1432 
	$ldns_n£c_bôm≠_˛ór_ty≥
(
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
)

1434 
uöt8_t
* 
d±r
;

1435 
uöt8_t
* 
díd
;

1442 
uöt8_t
 
wödow
 = 
ty≥
 >> 8;

1443 
uöt8_t
 
subty≥
 = 
ty≥
 & 0xff;

1445 i‡(! 
bôm≠
) {

1446  
Ál£
;

1449 
	`as£π
(
	`ldns_rdf_gë_ty≥
(
bôm≠
Ë=
LDNS_RDF_TYPE_BITMAP
);

1451 
d±r
 = 
	`ldns_rdf_d©a
(
bôm≠
);

1452 
díd
 = 
	`ldns_rdf_d©a
(
bôm≠
Ë+ 
	`ldns_rdf_size
(bitmap);

1457 
d±r
 < 
díd
 && d±r[0] <
wödow
) {

1459 i‡(
d±r
[0] =
wödow
 && 
subty≥
 / 8 < dptr[1] &&

1460 
d±r
 + d±r[1] + 2 <
díd
) {

1462 
d±r
[2 + 
subty≥
 / 8] &= ~(0x80 >> (subtype % 8));

1463  
LDNS_STATUS_OK
;

1465 
d±r
 += dptr[1] + 2;

1467  
LDNS_STATUS_TYPE_NOT_IN_BITMAP
;

1468 
	}
}

1471 
boﬁ


1472 
	$ldns_n£c_covîs_«me
(c⁄° 
ldns_º
 *
n£c
, c⁄° 
ldns_rdf
 *
«me
)

1474 
ldns_rdf
 *
n£c_ow√r
 = 
	`ldns_º_ow√r
(
n£c
);

1475 
ldns_rdf
 *
hash_√xt
;

1476 *
√xt_hash_°r
;

1477 
ldns_rdf
 *
n£c_√xt
 = 
NULL
;

1478 
ldns_°©us
 
°©us
;

1479 
ldns_rdf
 *
ch›≥d_d«me
;

1480 
boﬁ
 
ªsu…
;

1482 i‡(
	`ldns_º_gë_ty≥
(
n£c
Ë=
LDNS_RR_TYPE_NSEC
) {

1483 i‡(
	`ldns_º_rdf
(
n£c
, 0Ë!
NULL
) {

1484 
n£c_√xt
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_rdf
(
n£c
, 0));

1486  
Ál£
;

1488 } i‡(
	`ldns_º_gë_ty≥
(
n£c
Ë=
LDNS_RR_TYPE_NSEC3
) {

1489 
hash_√xt
 = 
	`ldns_n£c3_√xt_ow√r
(
n£c
);

1490 
√xt_hash_°r
 = 
	`ldns_rdf2°r
(
hash_√xt
);

1491 
n£c_√xt
 = 
	`ldns_d«me_√w_‰m_°r
(
√xt_hash_°r
);

1492 
	`LDNS_FREE
(
√xt_hash_°r
);

1493 
ch›≥d_d«me
 = 
	`ldns_d«me_À·_ch›
(
n£c_ow√r
);

1494 
°©us
 = 
	`ldns_d«me_ˇt
(
n£c_√xt
, 
ch›≥d_d«me
);

1495 
	`ldns_rdf_dìp_‰ì
(
ch›≥d_d«me
);

1496 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1497 
	`¥ötf
("îr‹ c©tög: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

1500 
	`ldns_rdf_dìp_‰ì
(
n£c_√xt
);

1501  
Ál£
;

1505 if(
	`ldns_d«me_com∑ª
(
n£c_ow√r
, 
n£c_√xt
) > 0) {

1506 
ªsu…
 = (
	`ldns_d«me_com∑ª
(
n£c_ow√r
, 
«me
) <= 0 ||

1507 
	`ldns_d«me_com∑ª
(
«me
, 
n£c_√xt
) < 0);

1508 } if(
	`ldns_d«me_com∑ª
(
n£c_ow√r
, 
n£c_√xt
) < 0) {

1509 
ªsu…
 = (
	`ldns_d«me_com∑ª
(
n£c_ow√r
, 
«me
) <= 0 &&

1510 
	`ldns_d«me_com∑ª
(
«me
, 
n£c_√xt
) < 0);

1512 
ªsu…
 = 
åue
;

1515 
	`ldns_rdf_dìp_‰ì
(
n£c_√xt
);

1516  
ªsu…
;

1517 
	}
}

1519 #ifde‡
HAVE_SSL


1522 
ldns_°©us


1523 
	$ldns_pkt_vîify_time
(
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_rdf
 *
o
,

1524 
ldns_º_li°
 *
k
,Üdns_º_li° *
s
,

1525 
time_t
 
check_time
, 
ldns_º_li°
 *
good_keys
)

1527 
ldns_º_li°
 *
º£t
;

1528 
ldns_º_li°
 *
sigs
;

1529 
ldns_º_li°
 *
sigs_covîed
;

1530 
ldns_rdf
 *
rdf_t
;

1531 
ldns_º_ty≥
 
t_√t‹dî
;

1533 i‡(!
k
) {

1534  
LDNS_STATUS_ERR
;

1538 i‡(
t
 =
LDNS_RR_TYPE_RRSIG
) {

1540  
LDNS_STATUS_ERR
;

1543 i‡(
s
) {

1545 
sigs
 = 
s
;

1548 
sigs
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
p
, 
o
,

1549 
LDNS_RR_TYPE_RRSIG
,

1550 
LDNS_SECTION_ANY_NOQUESTION
);

1551 i‡(!
sigs
) {

1553  
LDNS_STATUS_ERR
;

1561 
t_√t‹dî
 = 
	`ht⁄s
(
t
);

1563 
rdf_t
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_TYPE
, 2, &
t_√t‹dî
);

1565 
sigs_covîed
 = 
	`ldns_º_li°_subty≥_by_rdf
(
sigs
, 
rdf_t
, 0);

1566 
	`ldns_rdf_‰ì
(
rdf_t
);

1567 i‡(! 
sigs_covîed
) {

1568 i‡(! 
s
) {

1569 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

1571  
LDNS_STATUS_ERR
;

1573 
	`ldns_º_li°_dìp_‰ì
(
sigs_covîed
);

1575 
º£t
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
p
, 
o
, 
t
,

1576 
LDNS_SECTION_ANY_NOQUESTION
);

1577 i‡(!
º£t
) {

1578 i‡(! 
s
) {

1579 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

1581  
LDNS_STATUS_ERR
;

1583  
	`ldns_vîify_time
(
º£t
, 
sigs
, 
k
, 
check_time
, 
good_keys
);

1584 
	}
}

1586 
ldns_°©us


1587 
	$ldns_pkt_vîify
(
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_rdf
 *
o
,

1588 
ldns_º_li°
 *
k
,Üdns_º_li° *
s
,Üdns_º_li° *
good_keys
)

1590  
	`ldns_pkt_vîify_time
(
p
, 
t
, 
o
, 
k
, 
s
, 
	`ldns_time
(
NULL
), 
good_keys
);

1591 
	}
}

1594 
ldns_°©us


1595 
	$ldns_dns£c_chaö_n£c3_li°
(
ldns_º_li°
 *
n£c3_ºs
)

1597 
size_t
 
i
;

1598 *
√xt_n£c_ow√r_°r
;

1599 
ldns_rdf
 *
√xt_n£c_ow√r_œbñ
;

1600 
ldns_rdf
 *
√xt_n£c_rdf
;

1601 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

1603 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
n£c3_ºs
); i++) {

1604 i‡(
i
 =
	`ldns_º_li°_º_cou¡
(
n£c3_ºs
) - 1) {

1605 
√xt_n£c_ow√r_œbñ
 =

1606 
	`ldns_d«me_œbñ
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
n£c3_ºs
,

1608 
√xt_n£c_ow√r_°r
 = 
	`ldns_rdf2°r
(
√xt_n£c_ow√r_œbñ
);

1609 i‡(
√xt_n£c_ow√r_°r
[
	`°æí
(next_nsec_owner_str) - 1]

1611 
√xt_n£c_ow√r_°r
[
	`°æí
(next_nsec_owner_str) - 1]

1614 
°©us
 = 
	`ldns_°r2rdf_b32_ext
(&
√xt_n£c_rdf
,

1615 
√xt_n£c_ow√r_°r
);

1616 i‡(!
	`ldns_º_£t_rdf
(
	`ldns_º_li°_º
(
n£c3_ºs
, 
i
),

1617 
√xt_n£c_rdf
, 4)) {

1621 
	`ldns_rdf_dìp_‰ì
(
√xt_n£c_ow√r_œbñ
);

1622 
	`LDNS_FREE
(
√xt_n£c_ow√r_°r
);

1624 
√xt_n£c_ow√r_œbñ
 =

1625 
	`ldns_d«me_œbñ
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
n£c3_ºs
,

1626 
i
 + 1)),

1628 
√xt_n£c_ow√r_°r
 = 
	`ldns_rdf2°r
(
√xt_n£c_ow√r_œbñ
);

1629 i‡(
√xt_n£c_ow√r_°r
[
	`°æí
(next_nsec_owner_str) - 1]

1631 
√xt_n£c_ow√r_°r
[
	`°æí
(next_nsec_owner_str) - 1]

1634 
°©us
 = 
	`ldns_°r2rdf_b32_ext
(&
√xt_n£c_rdf
,

1635 
√xt_n£c_ow√r_°r
);

1636 
	`ldns_rdf_dìp_‰ì
(
√xt_n£c_ow√r_œbñ
);

1637 
	`LDNS_FREE
(
√xt_n£c_ow√r_°r
);

1638 i‡(!
	`ldns_º_£t_rdf
(
	`ldns_º_li°_º
(
n£c3_ºs
, 
i
),

1639 
√xt_n£c_rdf
, 4)) {

1644  
°©us
;

1645 
	}
}

1648 
	$qs‹t_º_com∑ª_n£c3
(c⁄° *
a
, c⁄° *
b
)

1650 c⁄° 
ldns_º
 *
º1
 = * (c⁄°Üdns_º **Ë
a
;

1651 c⁄° 
ldns_º
 *
º2
 = * (c⁄°Üdns_º **Ë
b
;

1652 i‡(
º1
 =
NULL
 && 
º2
 == NULL) {

1655 i‡(
º1
 =
NULL
) {

1658 i‡(
º2
 =
NULL
) {

1661  
	`ldns_rdf_com∑ª
(
	`ldns_º_ow√r
(
º1
),Üdns_º_ow√r(
º2
));

1662 
	}
}

1665 
	$ldns_º_li°_s‹t_n£c3
(
ldns_º_li°
 *
uns‹ãd
)

1667 
	`qs‹t
(
uns‹ãd
->
_ºs
,

1668 
	`ldns_º_li°_º_cou¡
(
uns‹ãd
),

1669 (
ldns_º
 *),

1670 
qs‹t_º_com∑ª_n£c3
);

1671 
	}
}

1674 
ldns_dns£c_deÁu…_add_to_sig«tuªs
–
ATTR_UNUSED
(
ldns_º
 *
sig
)

1675 , 
	$ATTR_UNUSED
(*
n
)

1678  
LDNS_SIGNATURE_LEAVE_ADD_NEW
;

1679 
	}
}

1682 
ldns_dns£c_deÁu…_Àave_sig«tuªs
–
ATTR_UNUSED
(
ldns_º
 *
sig
)

1683 , 
	$ATTR_UNUSED
(*
n
)

1686  
LDNS_SIGNATURE_LEAVE_NO_ADD
;

1687 
	}
}

1690 
ldns_dns£c_deÁu…_dñëe_sig«tuªs
–
ATTR_UNUSED
(
ldns_º
 *
sig
)

1691 , 
	$ATTR_UNUSED
(*
n
)

1694  
LDNS_SIGNATURE_REMOVE_NO_ADD
;

1695 
	}
}

1698 
ldns_dns£c_deÁu…_ª∂a˚_sig«tuªs
–
ATTR_UNUSED
(
ldns_º
 *
sig
)

1699 , 
	$ATTR_UNUSED
(*
n
)

1702  
LDNS_SIGNATURE_REMOVE_ADD_NEW
;

1703 
	}
}

1705 #ifde‡
HAVE_SSL


1706 
ldns_rdf
 *

1707 
	$ldns_c⁄vît_dß_ºsig_a¢12rdf
(c⁄° 
ldns_buf„r
 *
sig
,

1708 c⁄° 
sig_Àn
)

1710 
ldns_rdf
 *
sigd©a_rdf
;

1711 
DSA_SIG
 *
dßsig
;

1712 *
dßsig_d©a
 = (*)
	`ldns_buf„r_begö
(
sig
);

1713 
size_t
 
byã_off£t
;

1715 
dßsig
 = 
	`d2i_DSA_SIG
(
NULL
,

1716 (c⁄° **)&
dßsig_d©a
,

1717 
sig_Àn
);

1718 i‡(!
dßsig
) {

1719 
	`DSA_SIG_‰ì
(
dßsig
);

1720  
NULL
;

1723 
dßsig_d©a
 = 
	`LDNS_XMALLOC
(, 41);

1724 if(!
dßsig_d©a
) {

1725 
	`DSA_SIG_‰ì
(
dßsig
);

1726  
NULL
;

1728 
dßsig_d©a
[0] = 0;

1729 
byã_off£t
 = (
size_t
Ë(20 - 
	`BN_num_byãs
(
dßsig
->
r
));

1730 i‡(
byã_off£t
 > 20) {

1731 
	`DSA_SIG_‰ì
(
dßsig
);

1732 
	`LDNS_FREE
(
dßsig_d©a
);

1733  
NULL
;

1735 
	`mem£t
(&
dßsig_d©a
[1], 0, 
byã_off£t
);

1736 
	`BN_bn2bö
(
dßsig
->
r
, &
dßsig_d©a
[1 + 
byã_off£t
]);

1737 
byã_off£t
 = (
size_t
Ë(20 - 
	`BN_num_byãs
(
dßsig
->
s
));

1738 i‡(
byã_off£t
 > 20) {

1739 
	`DSA_SIG_‰ì
(
dßsig
);

1740 
	`LDNS_FREE
(
dßsig_d©a
);

1741  
NULL
;

1743 
	`mem£t
(&
dßsig_d©a
[21], 0, 
byã_off£t
);

1744 
	`BN_bn2bö
(
dßsig
->
s
, &
dßsig_d©a
[21 + 
byã_off£t
]);

1746 
sigd©a_rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_B64
, 41, 
dßsig_d©a
);

1747 if(!
sigd©a_rdf
) {

1748 
	`LDNS_FREE
(
dßsig_d©a
);

1750 
	`DSA_SIG_‰ì
(
dßsig
);

1752  
sigd©a_rdf
;

1753 
	}
}

1755 
ldns_°©us


1756 
	$ldns_c⁄vît_dß_ºsig_rdf2a¢1
(
ldns_buf„r
 *
èrgë_buf„r
,

1757 c⁄° 
ldns_rdf
 *
sig_rdf
)

1760 
BIGNUM
 *
R
, *
S
;

1761 
DSA_SIG
 *
dßsig
;

1762 *
øw_sig
 = 
NULL
;

1763 
øw_sig_Àn
;

1765 if(
	`ldns_rdf_size
(
sig_rdf
Ë< 1 + 2*
SHA_DIGEST_LENGTH
)

1766  
LDNS_STATUS_SYNTAX_RDATA_ERR
;

1768 
R
 = 
	`BN_√w
();

1769 if(!
R
Ë 
LDNS_STATUS_MEM_ERR
;

1770 (Ë
	`BN_bö2bn
((*Ë
	`ldns_rdf_d©a
(
sig_rdf
) + 1,

1771 
SHA_DIGEST_LENGTH
, 
R
);

1772 
S
 = 
	`BN_√w
();

1773 if(!
S
) {

1774 
	`BN_‰ì
(
R
);

1775  
LDNS_STATUS_MEM_ERR
;

1777 (Ë
	`BN_bö2bn
((*Ë
	`ldns_rdf_d©a
(
sig_rdf
) + 21,

1778 
SHA_DIGEST_LENGTH
, 
S
);

1780 
dßsig
 = 
	`DSA_SIG_√w
();

1781 i‡(!
dßsig
) {

1782 
	`BN_‰ì
(
R
);

1783 
	`BN_‰ì
(
S
);

1784  
LDNS_STATUS_MEM_ERR
;

1787 
dßsig
->
r
 = 
R
;

1788 
dßsig
->
s
 = 
S
;

1790 
øw_sig_Àn
 = 
	`i2d_DSA_SIG
(
dßsig
, &
øw_sig
);

1791 i‡(
øw_sig_Àn
 < 0) {

1792 
	`DSA_SIG_‰ì
(
dßsig
);

1793 
	`‰ì
(
øw_sig
);

1794  
LDNS_STATUS_SSL_ERR
;

1796 i‡(
	`ldns_buf„r_ª£rve
(
èrgë_buf„r
, (
size_t
Ë
øw_sig_Àn
)) {

1797 
	`ldns_buf„r_wrôe
(
èrgë_buf„r
, 
øw_sig
, (
size_t
)
øw_sig_Àn
);

1800 
	`DSA_SIG_‰ì
(
dßsig
);

1801 
	`‰ì
(
øw_sig
);

1803  
	`ldns_buf„r_°©us
(
èrgë_buf„r
);

1804 
	}
}

1806 #ifde‡
USE_ECDSA


1807 #i‚de‡
S_SPLINT_S


1808 
ldns_rdf
 *

1809 
	$ldns_c⁄vît_ecdß_ºsig_a¢12rdf
(c⁄° 
ldns_buf„r
 *
sig
, c⁄° 
sig_Àn
)

1811 
ECDSA_SIG
* 
ecdß_sig
;

1812 *
d©a
 = (*)
	`ldns_buf„r_begö
(
sig
);

1813 
ldns_rdf
* 
rdf
;

1814 
ecdß_sig
 = 
	`d2i_ECDSA_SIG
(
NULL
, (c⁄° **)&
d©a
, 
sig_Àn
);

1815 if(!
ecdß_sig
Ë 
NULL
;

1818 
d©a
 = 
	`LDNS_XMALLOC
(,

1819 
	`BN_num_byãs
(
ecdß_sig
->
r
Ë+ BN_num_byãs”cdß_sig->
s
));

1820 if(!
d©a
) {

1821 
	`ECDSA_SIG_‰ì
(
ecdß_sig
);

1822  
NULL
;

1824 
	`BN_bn2bö
(
ecdß_sig
->
r
, 
d©a
);

1825 
	`BN_bn2bö
(
ecdß_sig
->
s
, 
d©a
+
	`BN_num_byãs
”cdß_sig->
r
));

1826 
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_B64
, (
size_t
)(

1827 
	`BN_num_byãs
(
ecdß_sig
->
r
Ë+ BN_num_byãs”cdß_sig->
s
)), 
d©a
);

1828 
	`ECDSA_SIG_‰ì
(
ecdß_sig
);

1829  
rdf
;

1830 
	}
}

1832 
ldns_°©us


1833 
	$ldns_c⁄vît_ecdß_ºsig_rdf2a¢1
(
ldns_buf„r
 *
èrgë_buf„r
,

1834 c⁄° 
ldns_rdf
 *
sig_rdf
)

1836 
ECDSA_SIG
* 
sig
;

1837 
øw_sig_Àn
;

1838 
bnsize
 = ()
	`ldns_rdf_size
(
sig_rdf
) / 2;

1840 if(
bnsize
 < 16 || (
size_t
)bnsize*2 !
	`ldns_rdf_size
(
sig_rdf
))

1841  
LDNS_STATUS_ERR
;

1844 
sig
 = 
	`ECDSA_SIG_√w
();

1845 if(!
sig
Ë 
LDNS_STATUS_MEM_ERR
;

1846 
sig
->
r
 = 
	`BN_bö2bn
((c⁄° *)
	`ldns_rdf_d©a
(
sig_rdf
),

1847 
bnsize
, 
sig
->
r
);

1848 
sig
->
s
 = 
	`BN_bö2bn
((c⁄° *)
	`ldns_rdf_d©a
(
sig_rdf
)+
bnsize
,

1849 
bnsize
, 
sig
->
s
);

1850 if(!
sig
->
r
 || !sig->
s
) {

1851 
	`ECDSA_SIG_‰ì
(
sig
);

1852  
LDNS_STATUS_MEM_ERR
;

1855 
øw_sig_Àn
 = 
	`i2d_ECDSA_SIG
(
sig
, 
NULL
);

1856 i‡(
	`ldns_buf„r_ª£rve
(
èrgë_buf„r
, (
size_t
Ë
øw_sig_Àn
)) {

1857 * 
µ
 = (*)

1858 
	`ldns_buf„r_cuºít
(
èrgë_buf„r
);

1859 
øw_sig_Àn
 = 
	`i2d_ECDSA_SIG
(
sig
, &
µ
);

1860 
	`ldns_buf„r_skù
(
èrgë_buf„r
, (
ssize_t
Ë
øw_sig_Àn
);

1862 
	`ECDSA_SIG_‰ì
(
sig
);

1864  
	`ldns_buf„r_°©us
(
èrgë_buf„r
);

1865 
	}
}

	@dnssec_sign.c

1 
	~<ldns/c⁄fig.h
>

3 
	~<ldns/ldns.h
>

5 
	~<ldns/dns£c.h
>

6 
	~<ldns/dns£c_sign.h
>

8 
	~<°rögs.h
>

9 
	~<time.h
>

11 #ifde‡
HAVE_SSL


15 
	~<›ís¶/s¶.h
>

16 
	~<›ís¶/evp.h
>

17 
	~<›ís¶/ønd.h
>

18 
	~<›ís¶/îr.h
>

19 
	~<›ís¶/md5.h
>

22 
ldns_º
 *

23 
	$ldns_¸óã_em±y_ºsig
(
ldns_º_li°
 *
º£t
,

24 
ldns_key
 *
cuºít_key
)

26 
uöt32_t
 
‹ig_âl
;

27 
ldns_º_˛ass
 
‹ig_˛ass
;

28 
time_t
 
now
;

29 
ldns_º
 *
cuºít_sig
;

30 
uöt8_t
 
œbñ_cou¡
;

31 
ldns_rdf
 *
sig«me
;

33 
œbñ_cou¡
 = 
	`ldns_d«me_œbñ_cou¡
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
º£t
,

36 if(
	`ldns_d«me_is_wûdˇrd
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
º£t
, 0))))

37 
œbñ_cou¡
 --;

39 
cuºít_sig
 = 
	`ldns_º_√w_‰m_ty≥
(
LDNS_RR_TYPE_RRSIG
);

42 
‹ig_âl
 = 
	`ldns_º_âl
(
	`ldns_º_li°_º
(
º£t
, 0));

43 
‹ig_˛ass
 = 
	`ldns_º_gë_˛ass
(
	`ldns_º_li°_º
(
º£t
, 0));

45 
	`ldns_º_£t_âl
(
cuºít_sig
, 
‹ig_âl
);

46 
	`ldns_º_£t_˛ass
(
cuºít_sig
, 
‹ig_˛ass
);

47 
	`ldns_º_£t_ow√r
(
cuºít_sig
,

48 
	`ldns_rdf_˛⁄e
(

49 
	`ldns_º_ow√r
(

50 
	`ldns_º_li°_º
(
º£t
,

56 ()
	`ldns_º_ºsig_£t_‹igâl
(

57 
cuºít_sig
,

58 
	`ldns_«tive2rdf_öt32
(
LDNS_RDF_TYPE_INT32
,

59 
‹ig_âl
));

61 
sig«me
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_key_pubkey_ow√r
(
cuºít_key
));

62 
	`ldns_d«me2ˇn⁄iˇl
(
sig«me
);

63 ()
	`ldns_º_ºsig_£t_sig«me
(

64 
cuºít_sig
,

65 
sig«me
);

67 ()
	`ldns_º_ºsig_£t_œbñs
(

68 
cuºít_sig
,

69 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
,

70 
œbñ_cou¡
));

72 
now
 = 
	`time
(
NULL
);

73 i‡(
	`ldns_key_ö˚±i⁄
(
cuºít_key
) != 0) {

74 ()
	`ldns_º_ºsig_£t_ö˚±i⁄
(

75 
cuºít_sig
,

76 
	`ldns_«tive2rdf_öt32
(

77 
LDNS_RDF_TYPE_TIME
,

78 
	`ldns_key_ö˚±i⁄
(
cuºít_key
)));

80 ()
	`ldns_º_ºsig_£t_ö˚±i⁄
(

81 
cuºít_sig
,

82 
	`ldns_«tive2rdf_öt32
(
LDNS_RDF_TYPE_TIME
, 
now
));

84 i‡(
	`ldns_key_expú©i⁄
(
cuºít_key
) != 0) {

85 ()
	`ldns_º_ºsig_£t_expú©i⁄
(

86 
cuºít_sig
,

87 
	`ldns_«tive2rdf_öt32
(

88 
LDNS_RDF_TYPE_TIME
,

89 
	`ldns_key_expú©i⁄
(
cuºít_key
)));

91 ()
	`ldns_º_ºsig_£t_expú©i⁄
(

92 
cuºít_sig
,

93 
	`ldns_«tive2rdf_öt32
(

94 
LDNS_RDF_TYPE_TIME
,

95 
now
 + 
LDNS_DEFAULT_EXP_TIME
));

98 ()
	`ldns_º_ºsig_£t_keyèg
(

99 
cuºít_sig
,

100 
	`ldns_«tive2rdf_öt16
(
LDNS_RDF_TYPE_INT16
,

101 
	`ldns_key_keyèg
(
cuºít_key
)));

103 ()
	`ldns_º_ºsig_£t_Æg‹ôhm
(

104 
cuºít_sig
,

105 
	`ldns_«tive2rdf_öt8
(

106 
LDNS_RDF_TYPE_ALG
,

107 
	`ldns_key_Æg‹ôhm
(
cuºít_key
)));

109 ()
	`ldns_º_ºsig_£t_ty≥covîed
(

110 
cuºít_sig
,

111 
	`ldns_«tive2rdf_öt16
(

112 
LDNS_RDF_TYPE_TYPE
,

113 
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
º£t
,

115  
cuºít_sig
;

116 
	}
}

118 #ifde‡
HAVE_SSL


119 
ldns_rdf
 *

120 
	$ldns_sign_public_buf„r
(
ldns_buf„r
 *
sign_buf
, 
ldns_key
 *
cuºít_key
)

122 
ldns_rdf
 *
b64rdf
 = 
NULL
;

124 
	`ldns_key_Æg‹ôhm
(
cuºít_key
)) {

125 
LDNS_SIGN_DSA
:

126 
LDNS_SIGN_DSA_NSEC3
:

127 
b64rdf
 = 
	`ldns_sign_public_evp
(

128 
sign_buf
,

129 
	`ldns_key_evp_key
(
cuºít_key
),

130 
	`EVP_dss1
());

132 
LDNS_SIGN_RSASHA1
:

133 
LDNS_SIGN_RSASHA1_NSEC3
:

134 
b64rdf
 = 
	`ldns_sign_public_evp
(

135 
sign_buf
,

136 
	`ldns_key_evp_key
(
cuºít_key
),

137 
	`EVP_sha1
());

139 #ifde‡
USE_SHA2


140 
LDNS_SIGN_RSASHA256
:

141 
b64rdf
 = 
	`ldns_sign_public_evp
(

142 
sign_buf
,

143 
	`ldns_key_evp_key
(
cuºít_key
),

144 
	`EVP_sha256
());

146 
LDNS_SIGN_RSASHA512
:

147 
b64rdf
 = 
	`ldns_sign_public_evp
(

148 
sign_buf
,

149 
	`ldns_key_evp_key
(
cuºít_key
),

150 
	`EVP_sha512
());

153 #ifde‡
USE_GOST


154 
LDNS_SIGN_ECC_GOST
:

155 
b64rdf
 = 
	`ldns_sign_public_evp
(

156 
sign_buf
,

157 
	`ldns_key_evp_key
(
cuºít_key
),

158 
	`EVP_gë_dige°by«me
("md_gost94"));

161 #ifde‡
USE_ECDSA


162 
LDNS_SIGN_ECDSAP256SHA256
:

163 
b64rdf
 = 
	`ldns_sign_public_evp
(

164 
sign_buf
,

165 
	`ldns_key_evp_key
(
cuºít_key
),

166 
	`EVP_sha256
());

168 
LDNS_SIGN_ECDSAP384SHA384
:

169 
b64rdf
 = 
	`ldns_sign_public_evp
(

170 
sign_buf
,

171 
	`ldns_key_evp_key
(
cuºít_key
),

172 
	`EVP_sha384
());

175 
LDNS_SIGN_RSAMD5
:

176 
b64rdf
 = 
	`ldns_sign_public_evp
(

177 
sign_buf
,

178 
	`ldns_key_evp_key
(
cuºít_key
),

179 
	`EVP_md5
());

183 
	`¥ötf
("unknownálgorithm, ");

184 
	`¥ötf
("isÅhe one usedávailable onÅhis system?\n");

188  
b64rdf
;

189 
	}
}

195 
ldns_º_li°
 *

196 
	$ldns_sign_public
(
ldns_º_li°
 *
º£t
, 
ldns_key_li°
 *
keys
)

198 
ldns_º_li°
 *
sig«tuªs
;

199 
ldns_º_li°
 *
º£t_˛⁄e
;

200 
ldns_º
 *
cuºít_sig
;

201 
ldns_rdf
 *
b64rdf
;

202 
ldns_key
 *
cuºít_key
;

203 
size_t
 
key_cou¡
;

204 
uöt16_t
 
i
;

205 
ldns_buf„r
 *
sign_buf
;

206 
ldns_rdf
 *
√w_ow√r
;

208 i‡(!
º£t
 || 
	`ldns_º_li°_º_cou¡
‘r£tË< 1 || !
keys
) {

209  
NULL
;

212 
√w_ow√r
 = 
NULL
;

214 
sig«tuªs
 = 
	`ldns_º_li°_√w
();

218 
º£t_˛⁄e
 = 
	`ldns_º_li°_˛⁄e
(
º£t
);

219 i‡(!
º£t_˛⁄e
) {

220  
NULL
;

224 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º£t_˛⁄e
); i++) {

225 
	`ldns_º_£t_âl
(
	`ldns_º_li°_º
(
º£t_˛⁄e
, 
i
),

226 
	`ldns_º_âl
(
	`ldns_º_li°_º
(
º£t
, 0)));

227 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_º_li°_º
(
º£t_˛⁄e
, 
i
));

230 
	`ldns_º_li°_s‹t
(
º£t_˛⁄e
);

232 
key_cou¡
 = 0;

233 
key_cou¡
 < 
	`ldns_key_li°_key_cou¡
(
keys
);

234 
key_cou¡
++) {

235 i‡(!
	`ldns_key_u£
(
	`ldns_key_li°_key
(
keys
, 
key_cou¡
))) {

238 
sign_buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

239 i‡(!
sign_buf
) {

240 
	`ldns_º_li°_‰ì
(
º£t_˛⁄e
);

241 
	`ldns_º_li°_‰ì
(
sig«tuªs
);

242 
	`ldns_rdf_‰ì
(
√w_ow√r
);

243  
NULL
;

245 
b64rdf
 = 
NULL
;

247 
cuºít_key
 = 
	`ldns_key_li°_key
(
keys
, 
key_cou¡
);

250 i‡(
	`ldns_key_Êags
(
cuºít_key
Ë& 
LDNS_KEY_ZONE_KEY
) {

251 
cuºít_sig
 = 
	`ldns_¸óã_em±y_ºsig
(
º£t_˛⁄e
,

252 
cuºít_key
);

258 i‡(
	`ldns_ºsig2buf„r_wúe
(
sign_buf
, 
cuºít_sig
)

259 !
LDNS_STATUS_OK
) {

260 
	`ldns_buf„r_‰ì
(
sign_buf
);

262 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

263 
	`ldns_º_‰ì
(
cuºít_sig
);

264 
	`ldns_º_li°_dìp_‰ì
(
sig«tuªs
);

265  
NULL
;

269 i‡(
	`ldns_º_li°2buf„r_wúe
(
sign_buf
, 
º£t_˛⁄e
)

270 !
LDNS_STATUS_OK
) {

271 
	`ldns_buf„r_‰ì
(
sign_buf
);

272 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

273 
	`ldns_º_‰ì
(
cuºít_sig
);

274 
	`ldns_º_li°_dìp_‰ì
(
sig«tuªs
);

275  
NULL
;

278 
b64rdf
 = 
	`ldns_sign_public_buf„r
(
sign_buf
, 
cuºít_key
);

280 i‡(!
b64rdf
) {

282 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

283 
	`ldns_º_‰ì
(
cuºít_sig
);

284 
	`ldns_º_li°_dìp_‰ì
(
sig«tuªs
);

285  
NULL
;

288 
	`ldns_º_ºsig_£t_sig
(
cuºít_sig
, 
b64rdf
);

291 
	`ldns_º_li°_push_º
(
sig«tuªs
, 
cuºít_sig
);

293 
	`ldns_buf„r_‰ì
(
sign_buf
);

295 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

297  
sig«tuªs
;

298 
	}
}

308 
ldns_rdf
 *

309 
	$ldns_sign_public_dß
(
ldns_buf„r
 *
to_sign
, 
DSA
 *
key
)

311 *
sha1_hash
;

312 
ldns_rdf
 *
sigd©a_rdf
;

313 
ldns_buf„r
 *
b64sig
;

315 
DSA_SIG
 *
sig
;

316 
uöt8_t
 *
d©a
;

317 
size_t
 
∑d
;

319 
b64sig
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

320 i‡(!
b64sig
) {

321  
NULL
;

324 
sha1_hash
 = 
	`SHA1
((*)
	`ldns_buf„r_begö
(
to_sign
),

325 
	`ldns_buf„r_posôi⁄
(
to_sign
), 
NULL
);

326 i‡(!
sha1_hash
) {

327 
	`ldns_buf„r_‰ì
(
b64sig
);

328  
NULL
;

331 
sig
 = 
	`DSA_do_sign
(
sha1_hash
, 
SHA_DIGEST_LENGTH
, 
key
);

332 if(!
sig
) {

333 
	`ldns_buf„r_‰ì
(
b64sig
);

334  
NULL
;

337 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 1 + 2 * 
SHA_DIGEST_LENGTH
);

338 if(!
d©a
) {

339 
	`ldns_buf„r_‰ì
(
b64sig
);

340 
	`DSA_SIG_‰ì
(
sig
);

341  
NULL
;

344 
d©a
[0] = 1;

345 
∑d
 = 20 - (
size_t
Ë
	`BN_num_byãs
(
sig
->
r
);

346 i‡(
∑d
 > 0) {

347 
	`mem£t
(
d©a
 + 1, 0, 
∑d
);

349 
	`BN_bn2bö
(
sig
->
r
, (*Ë(
d©a
 + 1Ë+ 
∑d
);

351 
∑d
 = 20 - (
size_t
Ë
	`BN_num_byãs
(
sig
->
s
);

352 i‡(
∑d
 > 0) {

353 
	`mem£t
(
d©a
 + 1 + 
SHA_DIGEST_LENGTH
, 0, 
∑d
);

355 
	`BN_bn2bö
(
sig
->
s
, (*Ë(
d©a
 + 1 + 
SHA_DIGEST_LENGTH
 + 
∑d
));

357 
sigd©a_rdf
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
,

358 1 + 2 * 
SHA_DIGEST_LENGTH
,

359 
d©a
);

361 
	`ldns_buf„r_‰ì
(
b64sig
);

362 
	`LDNS_FREE
(
d©a
);

363 
	`DSA_SIG_‰ì
(
sig
);

365  
sigd©a_rdf
;

366 
	}
}

368 #ifde‡
USE_ECDSA


369 #i‚de‡
S_SPLINT_S


371 
	$ldns_pkey_is_ecdß
(
EVP_PKEY
* 
pkey
)

373 
EC_KEY
* 
ec
;

374 c⁄° 
EC_GROUP
* 
g
;

375 if(
	`EVP_PKEY_ty≥
(
pkey
->
ty≥
Ë!
EVP_PKEY_EC
)

377 
ec
 = 
	`EVP_PKEY_gë1_EC_KEY
(
pkey
);

378 
g
 = 
	`EC_KEY_gë0_group
(
ec
);

379 if(!
g
) {

380 
	`EC_KEY_‰ì
(
ec
);

383 if(
	`EC_GROUP_gë_curve_«me
(
g
Ë=
NID_£˝224r1
 ||

384 
	`EC_GROUP_gë_curve_«me
(
g
Ë=
NID_X9_62_¥ime256v1
 ||

385 
	`EC_GROUP_gë_curve_«me
(
g
Ë=
NID_£˝384r1
) {

386 
	`EC_KEY_‰ì
(
ec
);

390 
	`EC_KEY_‰ì
(
ec
);

392 
	}
}

396 
ldns_rdf
 *

397 
	$ldns_sign_public_evp
(
ldns_buf„r
 *
to_sign
,

398 
EVP_PKEY
 *
key
,

399 c⁄° 
EVP_MD
 *
dige°_ty≥
)

401 
sigÀn
;

402 
ldns_rdf
 *
sigd©a_rdf
;

403 
ldns_buf„r
 *
b64sig
;

404 
EVP_MD_CTX
 
˘x
;

405 c⁄° 
EVP_MD
 *
md_ty≥
;

406 
r
;

408 
sigÀn
 = 0;

409 
b64sig
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

410 i‡(!
b64sig
) {

411  
NULL
;

415 
md_ty≥
 = 
dige°_ty≥
;

416 if(!
md_ty≥
) {

418 
	`ldns_buf„r_‰ì
(
b64sig
);

419  
NULL
;

422 
	`EVP_MD_CTX_öô
(&
˘x
);

423 
r
 = 
	`EVP_SignInô
(&
˘x
, 
md_ty≥
);

424 if(
r
 == 1) {

425 
r
 = 
	`EVP_SignUpd©e
(&
˘x
, (*)

426 
	`ldns_buf„r_begö
(
to_sign
),

427 
	`ldns_buf„r_posôi⁄
(
to_sign
));

429 
	`ldns_buf„r_‰ì
(
b64sig
);

430  
NULL
;

432 if(
r
 == 1) {

433 
r
 = 
	`EVP_SignFöÆ
(&
˘x
, (*)

434 
	`ldns_buf„r_begö
(
b64sig
), &
sigÀn
, 
key
);

436 
	`ldns_buf„r_‰ì
(
b64sig
);

437  
NULL
;

439 if(
r
 != 1) {

440 
	`ldns_buf„r_‰ì
(
b64sig
);

441  
NULL
;

445 #i‚de‡
S_SPLINT_S


446 i‡(
	`EVP_PKEY_ty≥
(
key
->
ty≥
Ë=
EVP_PKEY_DSA
) {

447 
sigd©a_rdf
 = 
	`ldns_c⁄vît_dß_ºsig_a¢12rdf
(
b64sig
, 
sigÀn
);

448 #ifde‡
USE_ECDSA


449 } if(
	`EVP_PKEY_ty≥
(
key
->
ty≥
Ë=
EVP_PKEY_EC
 &&

450 
	`ldns_pkey_is_ecdß
(
key
)) {

451 
sigd©a_rdf
 = 
	`ldns_c⁄vît_ecdß_ºsig_a¢12rdf
(
b64sig
, 
sigÀn
);

455 
sigd©a_rdf
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
sigÀn
,

456 
	`ldns_buf„r_begö
(
b64sig
));

459 
	`ldns_buf„r_‰ì
(
b64sig
);

460 
	`EVP_MD_CTX_˛ónup
(&
˘x
);

461  
sigd©a_rdf
;

462 
	}
}

464 
ldns_rdf
 *

465 
	$ldns_sign_public_rßsha1
(
ldns_buf„r
 *
to_sign
, 
RSA
 *
key
)

467 *
sha1_hash
;

468 
sigÀn
;

469 
ldns_rdf
 *
sigd©a_rdf
;

470 
ldns_buf„r
 *
b64sig
;

471 
ªsu…
;

473 
sigÀn
 = 0;

474 
b64sig
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

475 i‡(!
b64sig
) {

476  
NULL
;

479 
sha1_hash
 = 
	`SHA1
((*)
	`ldns_buf„r_begö
(
to_sign
),

480 
	`ldns_buf„r_posôi⁄
(
to_sign
), 
NULL
);

481 i‡(!
sha1_hash
) {

482 
	`ldns_buf„r_‰ì
(
b64sig
);

483  
NULL
;

486 
ªsu…
 = 
	`RSA_sign
(
NID_sha1
, 
sha1_hash
, 
SHA_DIGEST_LENGTH
,

487 (*)
	`ldns_buf„r_begö
(
b64sig
),

488 &
sigÀn
, 
key
);

489 i‡(
ªsu…
 != 1) {

490 
	`ldns_buf„r_‰ì
(
b64sig
);

491  
NULL
;

494 
sigd©a_rdf
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
sigÀn
,

495 
	`ldns_buf„r_begö
(
b64sig
));

496 
	`ldns_buf„r_‰ì
(
b64sig
);

497  
sigd©a_rdf
;

498 
	}
}

500 
ldns_rdf
 *

501 
	$ldns_sign_public_rßmd5
(
ldns_buf„r
 *
to_sign
, 
RSA
 *
key
)

503 *
md5_hash
;

504 
sigÀn
;

505 
ldns_rdf
 *
sigd©a_rdf
;

506 
ldns_buf„r
 *
b64sig
;

508 
b64sig
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

509 i‡(!
b64sig
) {

510  
NULL
;

513 
md5_hash
 = 
	`MD5
((*)
	`ldns_buf„r_begö
(
to_sign
),

514 
	`ldns_buf„r_posôi⁄
(
to_sign
), 
NULL
);

515 i‡(!
md5_hash
) {

516 
	`ldns_buf„r_‰ì
(
b64sig
);

517  
NULL
;

520 
	`RSA_sign
(
NID_md5
, 
md5_hash
, 
MD5_DIGEST_LENGTH
,

521 (*)
	`ldns_buf„r_begö
(
b64sig
),

522 &
sigÀn
, 
key
);

524 
sigd©a_rdf
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
sigÀn
,

525 
	`ldns_buf„r_begö
(
b64sig
));

526 
	`ldns_buf„r_‰ì
(
b64sig
);

527  
sigd©a_rdf
;

528 
	}
}

534 
ldns_°©us


535 
	$ldns_dns£c_addªs£s_⁄_glue_li°
(

536 
ldns_dns£c_º£ts
 *
cur_º£t
,

537 
ldns_º_li°
 *
glue_li°
)

539 
ldns_dns£c_ºs
 *
cur_ºs
;

540 
cur_º£t
) {

541 i‡(
cur_º£t
->
ty≥
 =
LDNS_RR_TYPE_A


542 || 
cur_º£t
->
ty≥
 =
LDNS_RR_TYPE_AAAA
) {

543 
cur_ºs
 = 
cur_º£t
->
ºs
;

544 
cur_ºs
;

545 
cur_ºs
 = cur_ºs->
√xt
) {

546 i‡(
cur_ºs
->
º
) {

547 i‡(!
	`ldns_º_li°_push_º
(
glue_li°
,

548 
cur_ºs
->
º
)) {

549  
LDNS_STATUS_MEM_ERR
;

559 
cur_º£t
 = cur_º£t->
√xt
;

561  
LDNS_STATUS_OK
;

562 
	}
}

578 
ldns_°©us


579 
	$ldns_dns£c_z⁄e_m¨k_™d_gë_glue
(
ldns_dns£c_z⁄e
 *
z⁄e
,

580 
ldns_º_li°
 *
glue_li°
)

582 
ldns_rbnode_t
 *
node
;

583 
ldns_dns£c_«me
 *
«me
;

584 
ldns_rdf
 *
ow√r
;

585 
ldns_rdf
 *
cut
 = 
NULL
;

589 
bñow_dñeg©i⁄
 = -1;

590 
ldns_°©us
 
s
;

592 i‡(!
z⁄e
 || !z⁄e->
«mes
) {

593  
LDNS_STATUS_NULL
;

595 
node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
);

596 
node
 !
LDNS_RBTREE_NULL
;

597 
node
 = 
	`ldns_rbåì_√xt
(node)) {

598 
«me
 = (
ldns_dns£c_«me
 *Ë
node
->
d©a
;

599 
ow√r
 = 
	`ldns_dns£c_«me_«me
(
«me
);

601 i‡(
cut
) {

613 i‡(
	`ldns_d«me_is_subdomaö
(
ow√r
, 
cut
) &&

614 !
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

615 
«me
->
º£ts
, 
LDNS_RR_TYPE_SOA
)) {

617 i‡(
bñow_dñeg©i⁄
 && 
glue_li°
) {

618 
s
 = 
	`ldns_dns£c_addªs£s_⁄_glue_li°
(

619 
«me
->
º£ts
, 
glue_li°
);

620 i‡(
s
 !
LDNS_STATUS_OK
) {

621  
s
;

624 
«me
->
is_glue
 = 
åue
;

627 
cut
 = 
NULL
;

635 i‡(
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

636 
«me
->
º£ts
, 
LDNS_RR_TYPE_NS
)

637 && !
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

638 
«me
->
º£ts
, 
LDNS_RR_TYPE_SOA
)) {

639 
cut
 = 
ow√r
;

640 
bñow_dñeg©i⁄
 = 1;

641 i‡(
glue_li°
) {

642 
s
 = 
	`ldns_dns£c_addªs£s_⁄_glue_li°
(

643 
«me
->
º£ts
, 
glue_li°
);

644 i‡(
s
 !
LDNS_STATUS_OK
) {

645  
s
;

648 } i‡(
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

649 
«me
->
º£ts
, 
LDNS_RR_TYPE_DNAME
)) {

650 
cut
 = 
ow√r
;

651 
bñow_dñeg©i⁄
 = 0;

654  
LDNS_STATUS_OK
;

655 
	}
}

667 
ldns_°©us


668 
	$ldns_dns£c_z⁄e_m¨k_glue
(
ldns_dns£c_z⁄e
 *
z⁄e
)

670  
	`ldns_dns£c_z⁄e_m¨k_™d_gë_glue
(
z⁄e
, 
NULL
);

671 
	}
}

673 
ldns_rbnode_t
 *

674 
	$ldns_dns£c_«me_node_√xt_n⁄glue
(
ldns_rbnode_t
 *
node
)

676 
ldns_rbnode_t
 *
√xt_node
 = 
NULL
;

677 
ldns_dns£c_«me
 *
√xt_«me
 = 
NULL
;

678 
boﬁ
 
d⁄e
 = 
Ál£
;

680 i‡(
node
 =
LDNS_RBTREE_NULL
) {

681  
NULL
;

683 
√xt_node
 = 
node
;

684 !
d⁄e
) {

685 i‡(
√xt_node
 =
LDNS_RBTREE_NULL
) {

686  
NULL
;

688 
√xt_«me
 = (
ldns_dns£c_«me
 *)
√xt_node
->
d©a
;

689 i‡(!
√xt_«me
->
is_glue
) {

690 
d⁄e
 = 
åue
;

692 
√xt_node
 = 
	`ldns_rbåì_√xt
(next_node);

696  
√xt_node
;

697 
	}
}

699 
ldns_°©us


700 
	$ldns_dns£c_z⁄e_¸óã_n£cs
(
ldns_dns£c_z⁄e
 *
z⁄e
,

701 
ldns_º_li°
 *
√w_ºs
)

704 
ldns_rbnode_t
 *
fú°_node
, *
cur_node
, *
√xt_node
;

705 
ldns_dns£c_«me
 *
cur_«me
, *
√xt_«me
;

706 
ldns_º
 *
n£c_º
;

707 
uöt32_t
 
n£c_âl
;

708 
ldns_dns£c_º£ts
 *
sﬂ
;

713 
sﬂ
 = 
	`ldns_dns£c_«me_föd_º£t
(
z⁄e
->sﬂ, 
LDNS_RR_TYPE_SOA
);

718 i‡(
sﬂ
 && sﬂ->
ºs
 && sﬂ->ºs->
º


719 && (
	`ldns_º_rdf
(
sﬂ
->
ºs
->
º
, 6Ë!
NULL
)) {

720 
n£c_âl
 = 
	`ldns_rdf2«tive_öt32
(
	`ldns_º_rdf
(
sﬂ
->
ºs
->
º
, 6));

722 
n£c_âl
 = 
LDNS_DEFAULT_TTL
;

725 
fú°_node
 = 
	`ldns_dns£c_«me_node_√xt_n⁄glue
(

726 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
));

727 
cur_node
 = 
fú°_node
;

728 i‡(
cur_node
) {

729 
√xt_node
 = 
	`ldns_dns£c_«me_node_√xt_n⁄glue
(

730 
	`ldns_rbåì_√xt
(
cur_node
));

732 
√xt_node
 = 
NULL
;

735 
cur_node
 && 
√xt_node
) {

736 
cur_«me
 = (
ldns_dns£c_«me
 *)
cur_node
->
d©a
;

737 
√xt_«me
 = (
ldns_dns£c_«me
 *)
√xt_node
->
d©a
;

738 
n£c_º
 = 
	`ldns_dns£c_¸óã_n£c
(
cur_«me
,

739 
√xt_«me
,

740 
LDNS_RR_TYPE_NSEC
);

741 
	`ldns_º_£t_âl
(
n£c_º
, 
n£c_âl
);

742 if(
	`ldns_dns£c_«me_add_º
(
cur_«me
, 
n£c_º
)!=
LDNS_STATUS_OK
){

743 
	`ldns_º_‰ì
(
n£c_º
);

744  
LDNS_STATUS_ERR
;

746 
	`ldns_º_li°_push_º
(
√w_ºs
, 
n£c_º
);

747 
cur_node
 = 
√xt_node
;

748 i‡(
cur_node
) {

749 
√xt_node
 = 
	`ldns_dns£c_«me_node_√xt_n⁄glue
(

750 
	`ldns_rbåì_√xt
(
cur_node
));

754 i‡(
cur_node
 && !
√xt_node
) {

755 
cur_«me
 = (
ldns_dns£c_«me
 *)
cur_node
->
d©a
;

756 
√xt_«me
 = (
ldns_dns£c_«me
 *)
fú°_node
->
d©a
;

757 
n£c_º
 = 
	`ldns_dns£c_¸óã_n£c
(
cur_«me
,

758 
√xt_«me
,

759 
LDNS_RR_TYPE_NSEC
);

760 
	`ldns_º_£t_âl
(
n£c_º
, 
n£c_âl
);

761 if(
	`ldns_dns£c_«me_add_º
(
cur_«me
, 
n£c_º
)!=
LDNS_STATUS_OK
){

762 
	`ldns_º_‰ì
(
n£c_º
);

763  
LDNS_STATUS_ERR
;

765 
	`ldns_º_li°_push_º
(
√w_ºs
, 
n£c_º
);

767 
	`¥ötf
("error\n");

770  
LDNS_STATUS_OK
;

771 
	}
}

773 #ifde‡
HAVE_SSL


775 
	$ldns_hashed_«mes_node_‰ì
(
ldns_rbnode_t
 *
node
, *
¨g
) {

776 (Ë
¨g
;

777 
	`LDNS_FREE
(
node
);

778 
	}
}

780 
ldns_°©us


781 
	$ldns_dns£c_z⁄e_¸óã_n£c3s_mkm≠
(
ldns_dns£c_z⁄e
 *
z⁄e
,

782 
ldns_º_li°
 *
√w_ºs
,

783 
uöt8_t
 
Æg‹ôhm
,

784 
uöt8_t
 
Êags
,

785 
uöt16_t
 
ôî©i⁄s
,

786 
uöt8_t
 
ß…_Àngth
,

787 
uöt8_t
 *
ß…
,

788 
ldns_rbåì_t
 **
m≠
)

790 
ldns_rbnode_t
 *
fú°_«me_node
;

791 
ldns_rbnode_t
 *
cuºít_«me_node
;

792 
ldns_dns£c_«me
 *
cuºít_«me
;

793 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

794 
ldns_º
 *
n£c_º
;

795 
ldns_º_li°
 *
n£c3_li°
;

796 
uöt32_t
 
n£c_âl
;

797 
ldns_dns£c_º£ts
 *
sﬂ
;

798 
ldns_rbnode_t
 *
hashm≠_node
;

800 i‡(!
z⁄e
 || !
√w_ºs
 || !z⁄e->
«mes
) {

801  
LDNS_STATUS_ERR
;

807 
sﬂ
 = 
	`ldns_dns£c_«me_föd_º£t
(
z⁄e
->sﬂ, 
LDNS_RR_TYPE_SOA
);

812 i‡(
sﬂ
 && sﬂ->
ºs
 && sﬂ->ºs->
º


813 && 
	`ldns_º_rdf
(
sﬂ
->
ºs
->
º
, 6Ë!
NULL
) {

814 
n£c_âl
 = 
	`ldns_rdf2«tive_öt32
(
	`ldns_º_rdf
(
sﬂ
->
ºs
->
º
, 6));

816 
n£c_âl
 = 
LDNS_DEFAULT_TTL
;

819 i‡(
z⁄e
->
hashed_«mes
) {

820 
	`ldns_åavî£_po°‹dî
(
z⁄e
->
hashed_«mes
,

821 
ldns_hashed_«mes_node_‰ì
, 
NULL
);

822 
	`LDNS_FREE
(
z⁄e
->
hashed_«mes
);

824 
z⁄e
->
hashed_«mes
 = 
	`ldns_rbåì_¸óã
(
ldns_d«me_com∑ª_v
);

825 i‡(
z⁄e
->
hashed_«mes
 && 
m≠
) {

826 *
m≠
 = 
z⁄e
->
hashed_«mes
;

829 
fú°_«me_node
 = 
	`ldns_dns£c_«me_node_√xt_n⁄glue
(

830 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
));

832 
cuºít_«me_node
 = 
fú°_«me_node
;

834 
cuºít_«me_node
 && cuºít_«me_nodê!
LDNS_RBTREE_NULL
 &&

835 
ªsu…
 =
LDNS_STATUS_OK
) {

837 
cuºít_«me
 = (
ldns_dns£c_«me
 *Ë
cuºít_«me_node
->
d©a
;

838 
n£c_º
 = 
	`ldns_dns£c_¸óã_n£c3
(
cuºít_«me
,

839 
NULL
,

840 
z⁄e
->
sﬂ
->
«me
,

841 
Æg‹ôhm
,

842 
Êags
,

843 
ôî©i⁄s
,

844 
ß…_Àngth
,

845 
ß…
);

848 i‡(!
cuºít_«me
->
º£ts
) {

849 
	`ldns_rdf_dìp_‰ì
(
	`ldns_º_p›_rdf
(
n£c_º
));

851 
	`ldns_º_£t_âl
(
n£c_º
, 
n£c_âl
);

852 
ªsu…
 = 
	`ldns_dns£c_«me_add_º
(
cuºít_«me
, 
n£c_º
);

853 
	`ldns_º_li°_push_º
(
√w_ºs
, 
n£c_º
);

854 i‡(
	`ldns_º_ow√r
(
n£c_º
)) {

855 
hashm≠_node
 = 
	`LDNS_MALLOC
(
ldns_rbnode_t
);

856 i‡(
hashm≠_node
 =
NULL
) {

857  
LDNS_STATUS_MEM_ERR
;

859 
cuºít_«me
->
hashed_«me
 =

860 
	`ldns_d«me_œbñ
(
	`ldns_º_ow√r
(
n£c_º
), 0);

862 i‡(
cuºít_«me
->
hashed_«me
 =
NULL
) {

863 
	`LDNS_FREE
(
hashm≠_node
);

864  
LDNS_STATUS_MEM_ERR
;

866 
hashm≠_node
->
key
 = 
cuºít_«me
->
hashed_«me
;

867 
hashm≠_node
->
d©a
 = 
cuºít_«me
;

869 i‡(! 
	`ldns_rbåì_ö£π
(
z⁄e
->
hashed_«mes


870 , 
hashm≠_node
)) {

871 
	`LDNS_FREE
(
hashm≠_node
);

874 
cuºít_«me_node
 = 
	`ldns_dns£c_«me_node_√xt_n⁄glue
(

875 
	`ldns_rbåì_√xt
(
cuºít_«me_node
));

877 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

878  
ªsu…
;

883 
n£c3_li°
 = 
	`ldns_º_li°_√w
();

884 i‡(
n£c3_li°
 =
NULL
) {

885  
LDNS_STATUS_MEM_ERR
;

887  
hashm≠_node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
hashed_«mes
)

888 ; 
hashm≠_node
 !
LDNS_RBTREE_NULL


889 ; 
hashm≠_node
 = 
	`ldns_rbåì_√xt
(hashmap_node)

891 
cuºít_«me
 = (
ldns_dns£c_«me
 *Ë
hashm≠_node
->
d©a
;

892 
n£c_º
 = ((
ldns_dns£c_«me
 *Ë
hashm≠_node
->
d©a
)->
n£c
;

893 i‡(
n£c_º
) {

894 
	`ldns_º_li°_push_º
(
n£c3_li°
, 
n£c_º
);

897 
ªsu…
 = 
	`ldns_dns£c_chaö_n£c3_li°
(
n£c3_li°
);

898 
	`ldns_º_li°_‰ì
(
n£c3_li°
);

900  
ªsu…
;

901 
	}
}

903 
ldns_°©us


904 
	$ldns_dns£c_z⁄e_¸óã_n£c3s
(
ldns_dns£c_z⁄e
 *
z⁄e
,

905 
ldns_º_li°
 *
√w_ºs
,

906 
uöt8_t
 
Æg‹ôhm
,

907 
uöt8_t
 
Êags
,

908 
uöt16_t
 
ôî©i⁄s
,

909 
uöt8_t
 
ß…_Àngth
,

910 
uöt8_t
 *
ß…
)

912  
	`ldns_dns£c_z⁄e_¸óã_n£c3s_mkm≠
(
z⁄e
, 
√w_ºs
, 
Æg‹ôhm
,

913 
Êags
, 
ôî©i⁄s
, 
ß…_Àngth
, 
ß…
, 
NULL
);

915 
	}
}

918 
ldns_dns£c_ºs
 *

919 
ldns_dns£c_ªmove_sig«tuªs
–
ldns_dns£c_ºs
 *
sig«tuªs


920 , 
ATTR_UNUSED
(
ldns_key_li°
 *
key_li°
)

921 , (*
func
)(
ldns_º
 *, *)

922 , *
¨g


925 
ldns_dns£c_ºs
 *
ba£_ºs
 = 
sig«tuªs
;

926 
ldns_dns£c_ºs
 *
cur_º
 = 
ba£_ºs
;

927 
ldns_dns£c_ºs
 *
¥ev_º
 = 
NULL
;

928 
ldns_dns£c_ºs
 *
√xt_º
;

930 
uöt16_t
 
keyèg
;

931 
size_t
 
i
;

933 i‡(!
cur_º
) {

934 
	`func
(
NULL
, 
¨g
)) {

935 
LDNS_SIGNATURE_LEAVE_ADD_NEW
:

936 
LDNS_SIGNATURE_REMOVE_ADD_NEW
:

938 
LDNS_SIGNATURE_LEAVE_NO_ADD
:

939 
LDNS_SIGNATURE_REMOVE_NO_ADD
:

940 
	`ldns_key_li°_£t_u£
(
key_li°
, 
Ál£
);

943 #ifde‡
STDERR_MSGS


944 
	`Ârötf
(
°dîr
, "[XX] unknownÑeturn value from callback\n");

948  
NULL
;

950 ()
	`func
(
cur_º
->
º
, 
¨g
);

952 
cur_º
) {

953 
√xt_º
 = 
cur_º
->
√xt
;

955 
	`func
(
cur_º
->
º
, 
¨g
)) {

956 
LDNS_SIGNATURE_LEAVE_ADD_NEW
:

957 
¥ev_º
 = 
cur_º
;

959 
LDNS_SIGNATURE_LEAVE_NO_ADD
:

960 
keyèg
 = 
	`ldns_rdf2«tive_öt16
(

961 
	`ldns_º_ºsig_keyèg
(
cur_º
->
º
));

962 
i
 = 0; i < 
	`ldns_key_li°_key_cou¡
(
key_li°
); i++) {

963 i‡(
	`ldns_key_keyèg
(
	`ldns_key_li°_key
(
key_li°
, 
i
)) ==

964 
keyèg
) {

965 
	`ldns_key_£t_u£
(
	`ldns_key_li°_key
(
key_li°
, 
i
),

966 
Ál£
);

969 
¥ev_º
 = 
cur_º
;

971 
LDNS_SIGNATURE_REMOVE_NO_ADD
:

972 
keyèg
 = 
	`ldns_rdf2«tive_öt16
(

973 
	`ldns_º_ºsig_keyèg
(
cur_º
->
º
));

974 
i
 = 0; i < 
	`ldns_key_li°_key_cou¡
(
key_li°
); i++) {

975 i‡(
	`ldns_key_keyèg
(
	`ldns_key_li°_key
(
key_li°
, 
i
))

976 =
keyèg
) {

977 
	`ldns_key_£t_u£
(
	`ldns_key_li°_key
(
key_li°
, 
i
),

978 
Ál£
);

981 i‡(
¥ev_º
) {

982 
¥ev_º
->
√xt
 = 
√xt_º
;

984 
ba£_ºs
 = 
√xt_º
;

986 
	`LDNS_FREE
(
cur_º
);

988 
LDNS_SIGNATURE_REMOVE_ADD_NEW
:

989 i‡(
¥ev_º
) {

990 
¥ev_º
->
√xt
 = 
√xt_º
;

992 
ba£_ºs
 = 
√xt_º
;

994 
	`LDNS_FREE
(
cur_º
);

997 #ifde‡
STDERR_MSGS


998 
	`Ârötf
(
°dîr
, "[XX] unknownÑeturn value from callback\n");

1002 
cur_º
 = 
√xt_º
;

1005  
ba£_ºs
;

1006 
	}
}

1008 #ifde‡
HAVE_SSL


1009 
ldns_°©us


1010 
ldns_dns£c_z⁄e_¸óã_ºsigs
(
ldns_dns£c_z⁄e
 *
z⁄e
,

1011 
ldns_º_li°
 *
√w_ºs
,

1012 
ldns_key_li°
 *
key_li°
,

1013 (*
func
)(
ldns_º
 *, *),

1014 *
¨g
)

1016  
	`ldns_dns£c_z⁄e_¸óã_ºsigs_Êg
(
z⁄e
, 
√w_ºs
, 
key_li°
,

1017 
func
, 
¨g
, 0);

1018 
	}
}

1022 
	$ldns_key_li°_fûãr_f‹_dnskey
(
ldns_key_li°
 *
key_li°
)

1024 
ßw_ksk
 = 0;

1025 
size_t
 
i
;

1026 
i
=0; i<
	`ldns_key_li°_key_cou¡
(
key_li°
); i++)

1027 if((
	`ldns_key_Êags
(
	`ldns_key_li°_key
(
key_li°
, 
i
))&
LDNS_KEY_SEP_KEY
)) {

1028 
ßw_ksk
 = 1;

1031 if(!
ßw_ksk
)

1033 
i
=0; i<
	`ldns_key_li°_key_cou¡
(
key_li°
); i++)

1034 if(!(
	`ldns_key_Êags
(
	`ldns_key_li°_key
(
key_li°
, 
i
))&
LDNS_KEY_SEP_KEY
))

1035 
	`ldns_key_£t_u£
(
	`ldns_key_li°_key
(
key_li°
, 
i
), 0);

1036 
	}
}

1040 
	$ldns_key_li°_fûãr_f‹_n⁄_dnskey
(
ldns_key_li°
 *
key_li°
)

1042 
ßw_zsk
 = 0;

1043 
size_t
 
i
;

1044 
i
=0; i<
	`ldns_key_li°_key_cou¡
(
key_li°
); i++)

1045 if(!(
	`ldns_key_Êags
(
	`ldns_key_li°_key
(
key_li°
, 
i
))&
LDNS_KEY_SEP_KEY
)) {

1046 
ßw_zsk
 = 1;

1049 if(!
ßw_zsk
)

1052 
i
=0; i<
	`ldns_key_li°_key_cou¡
(
key_li°
); i++)

1053 if((
	`ldns_key_Êags
(
	`ldns_key_li°_key
(
key_li°
, 
i
))&
LDNS_KEY_SEP_KEY
))

1054 
	`ldns_key_£t_u£
(
	`ldns_key_li°_key
(
key_li°
, 
i
), 0);

1055 
	}
}

1057 
ldns_°©us


1058 
ldns_dns£c_z⁄e_¸óã_ºsigs_Êg
–
ldns_dns£c_z⁄e
 *
z⁄e


1059 , 
ldns_º_li°
 *
√w_ºs


1060 , 
ldns_key_li°
 *
key_li°


1061 , (*
func
)(
ldns_º
 *, *)

1062 , *
¨g


1063 , 
Êags


1066 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

1068 
ldns_rbnode_t
 *
cur_node
;

1069 
ldns_º_li°
 *
º_li°
;

1071 
ldns_dns£c_«me
 *
cur_«me
;

1072 
ldns_dns£c_º£ts
 *
cur_º£t
;

1073 
ldns_dns£c_ºs
 *
cur_º
;

1075 
ldns_º_li°
 *
sigli°
;

1077 
size_t
 
i
;

1079 
⁄_dñeg©i⁄_poöt
 = 0;

1081 
ldns_º_li°
 *
pubkey_li°
 = 
	`ldns_º_li°_√w
();

1082 
i
 = 0; i<
	`ldns_key_li°_key_cou¡
(
key_li°
); i++) {

1083 
	`ldns_º_li°_push_º
–
pubkey_li°


1084 , 
	`ldns_key2º
(
	`ldns_key_li°_key
(

1085 
key_li°
, 
i
))

1090 
cur_node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
);

1091 
cur_node
 !
LDNS_RBTREE_NULL
) {

1092 
cur_«me
 = (
ldns_dns£c_«me
 *Ë
cur_node
->
d©a
;

1094 i‡(!
cur_«me
->
is_glue
) {

1095 
⁄_dñeg©i⁄_poöt
 = 
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

1096 
cur_«me
->
º£ts
, 
LDNS_RR_TYPE_NS
)

1097 && !
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(

1098 
cur_«me
->
º£ts
, 
LDNS_RR_TYPE_SOA
);

1099 
cur_º£t
 = 
cur_«me
->
º£ts
;

1100 
cur_º£t
) {

1102 
	`ldns_key_li°_£t_u£
(
key_li°
, 
åue
);

1106 
cur_º£t
->
sig«tuªs
 =

1107 
	`ldns_dns£c_ªmove_sig«tuªs
(
cur_º£t
->
sig«tuªs
,

1108 
key_li°
,

1109 
func
,

1110 
¨g
);

1111 if(!(
Êags
&
LDNS_SIGN_DNSKEY_WITH_ZSK
) &&

1112 
cur_º£t
->
ty≥
 =
LDNS_RR_TYPE_DNSKEY
)

1113 
	`ldns_key_li°_fûãr_f‹_dnskey
(
key_li°
);

1115 if(
cur_º£t
->
ty≥
 !
LDNS_RR_TYPE_DNSKEY
)

1116 
	`ldns_key_li°_fûãr_f‹_n⁄_dnskey
(
key_li°
);

1119 
º_li°
 = 
	`ldns_º_li°_√w
();

1121 
cur_º
 = 
cur_º£t
->
ºs
;

1122 
cur_º
) {

1123 
	`ldns_º_li°_push_º
(
º_li°
, 
cur_º
->
º
);

1124 
cur_º
 = cur_º->
√xt
;

1130 i‡(!
⁄_dñeg©i⁄_poöt
 ||

1131 
	`ldns_º_li°_ty≥
(
º_li°
)

1132 =
LDNS_RR_TYPE_DS
 ||

1133 
	`ldns_º_li°_ty≥
(
º_li°
)

1134 =
LDNS_RR_TYPE_NSEC
 ||

1135 
	`ldns_º_li°_ty≥
(
º_li°
)

1136 =
LDNS_RR_TYPE_NSEC3
) {

1137 
sigli°
 = 
	`ldns_sign_public
(
º_li°
, 
key_li°
);

1138 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
sigli°
); i++) {

1139 i‡(
cur_º£t
->
sig«tuªs
) {

1140 
ªsu…
 = 
	`ldns_dns£c_ºs_add_º
(
cur_º£t
->
sig«tuªs
,

1141 
	`ldns_º_li°_º
(
sigli°
,

1142 
i
));

1144 
cur_º£t
->
sig«tuªs
 = 
	`ldns_dns£c_ºs_√w
();

1145 
cur_º£t
->
sig«tuªs
->
º
 =

1146 
	`ldns_º_li°_º
(
sigli°
, 
i
);

1148 i‡(
√w_ºs
) {

1149 
	`ldns_º_li°_push_º
(
√w_ºs
,

1150 
	`ldns_º_li°_º
(
sigli°
,

1151 
i
));

1154 
	`ldns_º_li°_‰ì
(
sigli°
);

1157 
	`ldns_º_li°_‰ì
(
º_li°
);

1159 
cur_º£t
 = cur_º£t->
√xt
;

1163 
	`ldns_key_li°_£t_u£
(
key_li°
, 
åue
);

1164 
cur_«me
->
n£c_sig«tuªs
 =

1165 
	`ldns_dns£c_ªmove_sig«tuªs
(
cur_«me
->
n£c_sig«tuªs
,

1166 
key_li°
,

1167 
func
,

1168 
¨g
);

1169 
	`ldns_key_li°_fûãr_f‹_n⁄_dnskey
(
key_li°
);

1171 
º_li°
 = 
	`ldns_º_li°_√w
();

1172 
	`ldns_º_li°_push_º
(
º_li°
, 
cur_«me
->
n£c
);

1173 
sigli°
 = 
	`ldns_sign_public
(
º_li°
, 
key_li°
);

1175 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
sigli°
); i++) {

1176 i‡(
cur_«me
->
n£c_sig«tuªs
) {

1177 
ªsu…
 = 
	`ldns_dns£c_ºs_add_º
(
cur_«me
->
n£c_sig«tuªs
,

1178 
	`ldns_º_li°_º
(
sigli°
, 
i
));

1180 
cur_«me
->
n£c_sig«tuªs
 = 
	`ldns_dns£c_ºs_√w
();

1181 
cur_«me
->
n£c_sig«tuªs
->
º
 =

1182 
	`ldns_º_li°_º
(
sigli°
, 
i
);

1184 i‡(
√w_ºs
) {

1185 
	`ldns_º_li°_push_º
(
√w_ºs
,

1186 
	`ldns_º_li°_º
(
sigli°
, 
i
));

1190 
	`ldns_º_li°_‰ì
(
sigli°
);

1191 
	`ldns_º_li°_‰ì
(
º_li°
);

1193 
cur_node
 = 
	`ldns_rbåì_√xt
(cur_node);

1196 
	`ldns_º_li°_dìp_‰ì
(
pubkey_li°
);

1197  
ªsu…
;

1198 
	}
}

1200 
ldns_°©us


1201 
ldns_dns£c_z⁄e_sign
(
ldns_dns£c_z⁄e
 *
z⁄e
,

1202 
ldns_º_li°
 *
√w_ºs
,

1203 
ldns_key_li°
 *
key_li°
,

1204 (*
func
)(
ldns_º
 *, *),

1205 *
¨g
)

1207  
	`ldns_dns£c_z⁄e_sign_Êg
(
z⁄e
, 
√w_ºs
, 
key_li°
, 
func
, 
¨g
, 0);

1208 
	}
}

1210 
ldns_°©us


1211 
ldns_dns£c_z⁄e_sign_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

1212 
ldns_º_li°
 *
√w_ºs
,

1213 
ldns_key_li°
 *
key_li°
,

1214 (*
func
)(
ldns_º
 *, *),

1215 *
¨g
,

1216 
Êags
)

1218 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

1220 i‡(!
z⁄e
 || !
√w_ºs
 || !
key_li°
) {

1221  
LDNS_STATUS_ERR
;

1225 
ªsu…
 = 
	`ldns_dns£c_z⁄e_m¨k_glue
(
z⁄e
);

1226 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

1227  
ªsu…
;

1231 i‡(
z⁄e
->
«mes
 && !((
ldns_dns£c_«me
 *)z⁄e->«mes->
roŸ
->
d©a
)->
n£c
) {

1232 
ªsu…
 = 
	`ldns_dns£c_z⁄e_¸óã_n£cs
(
z⁄e
, 
√w_ºs
);

1233 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

1234  
ªsu…
;

1238 
ªsu…
 = 
	`ldns_dns£c_z⁄e_¸óã_ºsigs_Êg
(
z⁄e
,

1239 
√w_ºs
,

1240 
key_li°
,

1241 
func
,

1242 
¨g
,

1243 
Êags
);

1245  
ªsu…
;

1246 
	}
}

1248 
ldns_°©us


1249 
ldns_dns£c_z⁄e_sign_n£c3
(
ldns_dns£c_z⁄e
 *
z⁄e
,

1250 
ldns_º_li°
 *
√w_ºs
,

1251 
ldns_key_li°
 *
key_li°
,

1252 (*
func
)(
ldns_º
 *, *),

1253 *
¨g
,

1254 
uöt8_t
 
Æg‹ôhm
,

1255 
uöt8_t
 
Êags
,

1256 
uöt16_t
 
ôî©i⁄s
,

1257 
uöt8_t
 
ß…_Àngth
,

1258 
uöt8_t
 *
ß…
)

1260  
	`ldns_dns£c_z⁄e_sign_n£c3_Êg_mkm≠
(
z⁄e
, 
√w_ºs
, 
key_li°
,

1261 
func
, 
¨g
, 
Æg‹ôhm
, 
Êags
, 
ôî©i⁄s
, 
ß…_Àngth
, 
ß…
, 0,

1262 
NULL
);

1263 
	}
}

1265 
ldns_°©us


1266 
ldns_dns£c_z⁄e_sign_n£c3_Êg_mkm≠
(
ldns_dns£c_z⁄e
 *
z⁄e
,

1267 
ldns_º_li°
 *
√w_ºs
,

1268 
ldns_key_li°
 *
key_li°
,

1269 (*
func
)(
ldns_º
 *, *),

1270 *
¨g
,

1271 
uöt8_t
 
Æg‹ôhm
,

1272 
uöt8_t
 
Êags
,

1273 
uöt16_t
 
ôî©i⁄s
,

1274 
uöt8_t
 
ß…_Àngth
,

1275 
uöt8_t
 *
ß…
,

1276 
signÊags
,

1277 
ldns_rbåì_t
 **
m≠
)

1279 
ldns_º
 *
n£c3
, *
n£c3∑øm
;

1280 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

1283 
ªsu…
 = 
	`ldns_dns£c_z⁄e_m¨k_glue
(
z⁄e
);

1284 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

1285  
ªsu…
;

1291 i‡(
z⁄e
->
«mes
) {

1293 
ªsu…
 = 
	`ldns_dns£c_z⁄e_add_em±y_n⁄ãrmöÆs
(
z⁄e
);

1294 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

1295  
ªsu…
;

1298 
n£c3
 = ((
ldns_dns£c_«me
 *)
z⁄e
->
«mes
->
roŸ
->
d©a
)->
n£c
;

1299 i‡(
n£c3
 && 
	`ldns_º_gë_ty≥
“£c3Ë=
LDNS_RR_TYPE_NSEC3
) {

1302 i‡(!
	`ldns_dns£c_z⁄e_föd_º£t
(
z⁄e
,

1303 
z⁄e
->
sﬂ
->
«me
,

1304 
LDNS_RR_TYPE_NSEC3PARAM
)) {

1306 
n£c3∑øm
 =

1307 
	`ldns_º_√w_‰m_ty≥
(
LDNS_RR_TYPE_NSEC3PARAM
);

1308 
	`ldns_º_£t_ow√r
(
n£c3∑øm
,

1309 
	`ldns_rdf_˛⁄e
(
z⁄e
->
sﬂ
->
«me
));

1310 
	`ldns_n£c3_add_∑øm_rdfs
(
n£c3∑øm
,

1311 
Æg‹ôhm
,

1312 
Êags
,

1313 
ôî©i⁄s
,

1314 
ß…_Àngth
,

1315 
ß…
);

1319 
	`ldns_£t_bô
(
	`ldns_rdf_d©a
(
	`ldns_º_rdf
(
n£c3∑øm
, 1)), 0, 0);

1320 
ªsu…
 = 
	`ldns_dns£c_z⁄e_add_º
(
z⁄e
, 
n£c3∑øm
);

1321 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

1322  
ªsu…
;

1324 
	`ldns_º_li°_push_º
(
√w_ºs
, 
n£c3∑øm
);

1326 
ªsu…
 = 
	`ldns_dns£c_z⁄e_¸óã_n£c3s_mkm≠
(
z⁄e
,

1327 
√w_ºs
,

1328 
Æg‹ôhm
,

1329 
Êags
,

1330 
ôî©i⁄s
,

1331 
ß…_Àngth
,

1332 
ß…
,

1333 
m≠
);

1334 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

1335  
ªsu…
;

1339 
ªsu…
 = 
	`ldns_dns£c_z⁄e_¸óã_ºsigs_Êg
(
z⁄e
,

1340 
√w_ºs
,

1341 
key_li°
,

1342 
func
,

1343 
¨g
,

1344 
signÊags
);

1347  
ªsu…
;

1348 
	}
}

1350 
ldns_°©us


1351 
ldns_dns£c_z⁄e_sign_n£c3_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

1352 
ldns_º_li°
 *
√w_ºs
,

1353 
ldns_key_li°
 *
key_li°
,

1354 (*
func
)(
ldns_º
 *, *),

1355 *
¨g
,

1356 
uöt8_t
 
Æg‹ôhm
,

1357 
uöt8_t
 
Êags
,

1358 
uöt16_t
 
ôî©i⁄s
,

1359 
uöt8_t
 
ß…_Àngth
,

1360 
uöt8_t
 *
ß…
,

1361 
signÊags
)

1363  
	`ldns_dns£c_z⁄e_sign_n£c3_Êg_mkm≠
(
z⁄e
, 
√w_ºs
, 
key_li°
,

1364 
func
, 
¨g
, 
Æg‹ôhm
, 
Êags
, 
ôî©i⁄s
, 
ß…_Àngth
, 
ß…
,

1365 
signÊags
, 
NULL
);

1366 
	}
}

1368 
ldns_z⁄e
 *

1369 
	$ldns_z⁄e_sign
(c⁄° 
ldns_z⁄e
 *
z⁄e
, 
ldns_key_li°
 *
key_li°
)

1371 
ldns_dns£c_z⁄e
 *
dns£c_z⁄e
;

1372 
ldns_z⁄e
 *
sig√d_z⁄e
;

1373 
ldns_º_li°
 *
√w_ºs
;

1374 
size_t
 
i
;

1376 
sig√d_z⁄e
 = 
	`ldns_z⁄e_√w
();

1377 
dns£c_z⁄e
 = 
	`ldns_dns£c_z⁄e_√w
();

1379 (Ë
	`ldns_dns£c_z⁄e_add_º
(
dns£c_z⁄e
, 
	`ldns_z⁄e_sﬂ
(
z⁄e
));

1380 
	`ldns_z⁄e_£t_sﬂ
(
sig√d_z⁄e
, 
	`ldns_º_˛⁄e
(
	`ldns_z⁄e_sﬂ
(
z⁄e
)));

1382 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z⁄e
)); i++) {

1383 (Ë
	`ldns_dns£c_z⁄e_add_º
(
dns£c_z⁄e
,

1384 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z⁄e
),

1385 
i
));

1386 
	`ldns_z⁄e_push_º
(
sig√d_z⁄e
,

1387 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z⁄e
),

1388 
i
)));

1391 
√w_ºs
 = 
	`ldns_º_li°_√w
();

1392 (Ë
	`ldns_dns£c_z⁄e_sign
(
dns£c_z⁄e
,

1393 
√w_ºs
,

1394 
key_li°
,

1395 
ldns_dns£c_deÁu…_ª∂a˚_sig«tuªs
,

1396 
NULL
);

1398 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
√w_ºs
); i++) {

1399 
	`ldns_º_li°_push_º
(
	`ldns_z⁄e_ºs
(
sig√d_z⁄e
),

1400 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
√w_ºs
, 
i
)));

1403 
	`ldns_º_li°_dìp_‰ì
(
√w_ºs
);

1404 
	`ldns_dns£c_z⁄e_‰ì
(
dns£c_z⁄e
);

1406  
sig√d_z⁄e
;

1407 
	}
}

1409 
ldns_z⁄e
 *

1410 
	$ldns_z⁄e_sign_n£c3
(
ldns_z⁄e
 *
z⁄e
, 
ldns_key_li°
 *
key_li°
, 
uöt8_t
 
Æg‹ôhm
, uöt8_à
Êags
, 
uöt16_t
 
ôî©i⁄s
, uöt8_à
ß…_Àngth
, uöt8_à*
ß…
)

1412 
ldns_dns£c_z⁄e
 *
dns£c_z⁄e
;

1413 
ldns_z⁄e
 *
sig√d_z⁄e
;

1414 
ldns_º_li°
 *
√w_ºs
;

1415 
size_t
 
i
;

1417 
sig√d_z⁄e
 = 
	`ldns_z⁄e_√w
();

1418 
dns£c_z⁄e
 = 
	`ldns_dns£c_z⁄e_√w
();

1420 (Ë
	`ldns_dns£c_z⁄e_add_º
(
dns£c_z⁄e
, 
	`ldns_z⁄e_sﬂ
(
z⁄e
));

1421 
	`ldns_z⁄e_£t_sﬂ
(
sig√d_z⁄e
, 
	`ldns_º_˛⁄e
(
	`ldns_z⁄e_sﬂ
(
z⁄e
)));

1423 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z⁄e
)); i++) {

1424 (Ë
	`ldns_dns£c_z⁄e_add_º
(
dns£c_z⁄e
,

1425 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z⁄e
),

1426 
i
));

1427 
	`ldns_z⁄e_push_º
(
sig√d_z⁄e
,

1428 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z⁄e
),

1429 
i
)));

1432 
√w_ºs
 = 
	`ldns_º_li°_√w
();

1433 (Ë
	`ldns_dns£c_z⁄e_sign_n£c3
(
dns£c_z⁄e
,

1434 
√w_ºs
,

1435 
key_li°
,

1436 
ldns_dns£c_deÁu…_ª∂a˚_sig«tuªs
,

1437 
NULL
,

1438 
Æg‹ôhm
,

1439 
Êags
,

1440 
ôî©i⁄s
,

1441 
ß…_Àngth
,

1442 
ß…
);

1444 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
√w_ºs
); i++) {

1445 
	`ldns_º_li°_push_º
(
	`ldns_z⁄e_ºs
(
sig√d_z⁄e
),

1446 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
√w_ºs
, 
i
)));

1449 
	`ldns_º_li°_dìp_‰ì
(
√w_ºs
);

1450 
	`ldns_dns£c_z⁄e_‰ì
(
dns£c_z⁄e
);

1452  
sig√d_z⁄e
;

1453 
	}
}

	@dnssec_verify.c

1 
	~<ldns/c⁄fig.h
>

3 
	~<ldns/ldns.h
>

5 
	~<°rögs.h
>

6 
	~<time.h
>

8 #ifde‡
HAVE_SSL


12 
	~<›ís¶/s¶.h
>

13 
	~<›ís¶/evp.h
>

14 
	~<›ís¶/ønd.h
>

15 
	~<›ís¶/îr.h
>

16 
	~<›ís¶/md5.h
>

18 
ldns_dns£c_d©a_chaö
 *

19 
	$ldns_dns£c_d©a_chaö_√w
()

21 
ldns_dns£c_d©a_chaö
 *
nc
 = 
	`LDNS_CALLOC
(ldns_dnssec_data_chain, 1);

22 if(!
nc
Ë 
NULL
;

35  
nc
;

36 
	}
}

39 
	$ldns_dns£c_d©a_chaö_‰ì
(
ldns_dns£c_d©a_chaö
 *
chaö
)

41 
	`LDNS_FREE
(
chaö
);

42 
	}
}

45 
	$ldns_dns£c_d©a_chaö_dìp_‰ì
(
ldns_dns£c_d©a_chaö
 *
chaö
)

47 
	`ldns_º_li°_dìp_‰ì
(
chaö
->
º£t
);

48 
	`ldns_º_li°_dìp_‰ì
(
chaö
->
sig«tuªs
);

49 i‡(
chaö
->
∑ª¡
) {

50 
	`ldns_dns£c_d©a_chaö_dìp_‰ì
(
chaö
->
∑ª¡
);

52 
	`LDNS_FREE
(
chaö
);

53 
	}
}

56 
	$ldns_dns£c_d©a_chaö_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

57 c⁄° 
ldns_dns£c_d©a_chaö
 *
chaö
)

59 
ldns_lookup_èbÀ
 *
rcode
;

60 c⁄° 
ldns_º_des¸ùt‹
 *
º_des¸ùt‹
;

61 i‡(
chaö
) {

62 
	`ldns_dns£c_d©a_chaö_¥öt_fmt
(
out
, 
fmt
, 
chaö
->
∑ª¡
);

63 i‡(
	`ldns_º_li°_º_cou¡
(
chaö
->
º£t
) > 0) {

64 
rcode
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
,

65 (Ë
chaö
->
∑ckë_rcode
);

66 i‡(
rcode
) {

67 
	`Ârötf
(
out
, ";;Ñcode: %s\n", 
rcode
->
«me
);

70 
º_des¸ùt‹
 = 
	`ldns_º_des¸ùt
(
chaö
->
∑ckë_qty≥
);

71 i‡(
º_des¸ùt‹
 &&Ñr_des¸ùt‹->
_«me
) {

72 
	`Ârötf
(
out
, ";; qty≥: %s\n", 
º_des¸ùt‹
->
_«me
);

73 } i‡(
chaö
->
∑ckë_qty≥
 != 0) {

74 
	`Ârötf
(
out
, "TYPE%u",

75 
chaö
->
∑ckë_qty≥
);

77 i‡(
chaö
->
∑ckë_nod©a
) {

78 
	`Ârötf
(
out
, ";; NODATAÑesponse\n");

80 
	`Ârötf
(
out
, "rrset:\n");

81 
	`ldns_º_li°_¥öt_fmt
(
out
, 
fmt
, 
chaö
->
º£t
);

82 
	`Ârötf
(
out
, "sigs:\n");

83 
	`ldns_º_li°_¥öt_fmt
(
out
, 
fmt
, 
chaö
->
sig«tuªs
);

84 
	`Ârötf
(
out
, "---\n");

86 
	`Ârötf
(
out
, "<no data>\n");

89 
	}
}

91 
	$ldns_dns£c_d©a_chaö_¥öt
(
FILE
 *
out
, c⁄° 
ldns_dns£c_d©a_chaö
 *
chaö
)

93 
	`ldns_dns£c_d©a_chaö_¥öt_fmt
(

94 
out
, 
ldns_ouçut_f‹m©_deÁu…
, 
chaö
);

95 
	}
}

99 
	$ldns_dns£c_buûd_d©a_chaö_dnskey
(
ldns_ªsﬁvî
 *
ªs
,

100 
uöt16_t
 
qÊags
,

101 c⁄° 
ldns_pkt
 *
pkt
,

102 
ldns_º_li°
 *
sig«tuªs
,

103 
ldns_dns£c_d©a_chaö
 *
√w_chaö
,

104 
ldns_rdf
 *
key_«me
,

105 
ldns_º_˛ass
 
c
) {

106 
ldns_º_li°
 *
keys
;

107 
ldns_pkt
 *
my_pkt
;

108 i‡(
sig«tuªs
 && 
	`ldns_º_li°_º_cou¡
(signatures) > 0) {

109 
√w_chaö
->
sig«tuªs
 = 
	`ldns_º_li°_˛⁄e
(signatures);

110 
√w_chaö
->
∑ª¡_ty≥
 = 0;

112 
keys
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(

113 
pkt
,

114 
key_«me
,

115 
LDNS_RR_TYPE_DNSKEY
,

116 
LDNS_SECTION_ANY_NOQUESTION


118 i‡(!
keys
) {

119 
my_pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
,

120 
key_«me
,

121 
LDNS_RR_TYPE_DNSKEY
,

122 
c
,

123 
qÊags
);

124 i‡(
my_pkt
) {

125 
keys
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(

126 
my_pkt
,

127 
key_«me
,

128 
LDNS_RR_TYPE_DNSKEY
,

129 
LDNS_SECTION_ANY_NOQUESTION


131 
√w_chaö
->
∑ª¡
 = 
	`ldns_dns£c_buûd_d©a_chaö
(
ªs
,

132 
qÊags
,

133 
keys
,

134 
my_pkt
,

135 
NULL
);

136 
√w_chaö
->
∑ª¡
->
∑ckë_qty≥
 = 
LDNS_RR_TYPE_DNSKEY
;

137 
	`ldns_pkt_‰ì
(
my_pkt
);

140 
√w_chaö
->
∑ª¡
 = 
	`ldns_dns£c_buûd_d©a_chaö
(
ªs
,

141 
qÊags
,

142 
keys
,

143 
pkt
,

144 
NULL
);

145 
√w_chaö
->
∑ª¡
->
∑ckë_qty≥
 = 
LDNS_RR_TYPE_DNSKEY
;

147 
	`ldns_º_li°_dìp_‰ì
(
keys
);

149 
	}
}

152 
	$ldns_dns£c_buûd_d©a_chaö_Ÿhî
(
ldns_ªsﬁvî
 *
ªs
,

153 
uöt16_t
 
qÊags
,

154 
ldns_dns£c_d©a_chaö
 *
√w_chaö
,

155 
ldns_rdf
 *
key_«me
,

156 
ldns_º_˛ass
 
c
,

157 
ldns_º_li°
 *
dss
)

169 
ldns_pkt
 *
my_pkt
;

170 
ldns_º_li°
 *
sig«tuªs2
;

172 
√w_chaö
->
∑ª¡_ty≥
 = 1;

174 
my_pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
,

175 
key_«me
,

176 
LDNS_RR_TYPE_DS
,

177 
c
,

178 
qÊags
);

179 i‡(
my_pkt
) {

180 
dss
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
my_pkt
,

181 
key_«me
,

182 
LDNS_RR_TYPE_DS
,

183 
LDNS_SECTION_ANY_NOQUESTION


185 i‡(
dss
) {

186 
√w_chaö
->
∑ª¡
 = 
	`ldns_dns£c_buûd_d©a_chaö
(
ªs
,

187 
qÊags
,

188 
dss
,

189 
my_pkt
,

190 
NULL
);

191 
√w_chaö
->
∑ª¡
->
∑ckë_qty≥
 = 
LDNS_RR_TYPE_DS
;

192 
	`ldns_º_li°_dìp_‰ì
(
dss
);

194 
	`ldns_pkt_‰ì
(
my_pkt
);

197 
my_pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
,

198 
key_«me
,

199 
LDNS_RR_TYPE_DNSKEY
,

200 
c
,

201 
qÊags
);

202 i‡(
my_pkt
) {

203 
sig«tuªs2
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
my_pkt
,

204 
key_«me
,

205 
LDNS_RR_TYPE_RRSIG
,

206 
LDNS_SECTION_ANSWER
);

207 i‡(
sig«tuªs2
) {

208 i‡(
√w_chaö
->
sig«tuªs
) {

209 
	`¥ötf
("There wereálready sigs!\n");

210 
	`ldns_º_li°_dìp_‰ì
(
√w_chaö
->
sig«tuªs
);

211 
	`¥ötf
("replacingÅhe old sigs\n");

213 
√w_chaö
->
sig«tuªs
 = 
sig«tuªs2
;

215 
	`ldns_pkt_‰ì
(
my_pkt
);

217 
	}
}

219 
ldns_dns£c_d©a_chaö
 *

220 
	$ldns_dns£c_buûd_d©a_chaö_nokey«me
(
ldns_ªsﬁvî
 *
ªs
,

221 
uöt16_t
 
qÊags
,

222 
ldns_º
 *
‹ig_º
,

223 c⁄° 
ldns_º_li°
 *
º£t
,

224 
ldns_dns£c_d©a_chaö
 *
√w_chaö
)

226 
ldns_rdf
 *
possibÀ_∑ª¡_«me
;

227 
ldns_pkt
 *
my_pkt
;

232 i‡(
‹ig_º
) {

233 
possibÀ_∑ª¡_«me
 = 
	`ldns_º_ow√r
(
‹ig_º
);

234 } i‡(
º£t
 && 
	`ldns_º_li°_º_cou¡
(rrset) > 0) {

235 
possibÀ_∑ª¡_«me
 = 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
º£t
, 0));

238  
√w_chaö
;

241 
my_pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
,

242 
possibÀ_∑ª¡_«me
,

243 
LDNS_RR_TYPE_DS
,

244 
LDNS_RR_CLASS_IN
,

245 
qÊags
);

246 i‡(!
my_pkt
) {

247  
√w_chaö
;

250 i‡(
	`ldns_pkt_™cou¡
(
my_pkt
) > 0) {

253 
	`ldns_pkt_‰ì
(
my_pkt
);

256 
√w_chaö
->
∑ª¡
 = 
	`ldns_dns£c_buûd_d©a_chaö
(
ªs
,

257 
qÊags
,

258 
NULL
,

259 
my_pkt
,

260 
NULL
);

262 
√w_chaö
->
∑ª¡
->
∑ckë_qty≥
 = 
LDNS_RR_TYPE_DS
;

265  
√w_chaö
;

266 
	}
}

269 
ldns_dns£c_d©a_chaö
 *

270 
	$ldns_dns£c_buûd_d©a_chaö
(
ldns_ªsﬁvî
 *
ªs
,

271 
uöt16_t
 
qÊags
,

272 c⁄° 
ldns_º_li°
 *
º£t
,

273 c⁄° 
ldns_pkt
 *
pkt
,

274 
ldns_º
 *
‹ig_º
)

276 
ldns_º_li°
 *
sig«tuªs
 = 
NULL
;

277 
ldns_º_li°
 *
dss
 = 
NULL
;

279 
ldns_º_li°
 *
my_º£t
;

281 
ldns_pkt
 *
my_pkt
;

283 
ldns_rdf
 *
«me
 = 
NULL
, *
key_«me
 = NULL;

284 
ldns_º_ty≥
 
ty≥
 = 0;

285 
ldns_º_˛ass
 
c
 = 0;

287 
boﬁ
 
Ÿhî_º£t
 = 
Ál£
;

289 
ldns_dns£c_d©a_chaö
 *
√w_chaö
 = 
	`ldns_dns£c_d©a_chaö_√w
();

291 
	`as£π
(
pkt
 !
NULL
);

293 i‡(!
	`ldns_dns£c_pkt_has_ºsigs
(
pkt
)) {

296  
√w_chaö
;

299 i‡(
‹ig_º
) {

300 
√w_chaö
->
º£t
 = 
	`ldns_º_li°_√w
();

301 
	`ldns_º_li°_push_º
(
√w_chaö
->
º£t
, 
‹ig_º
);

302 
√w_chaö
->
∑ª¡
 = 
	`ldns_dns£c_buûd_d©a_chaö
(
ªs
,

303 
qÊags
,

304 
º£t
,

305 
pkt
,

306 
NULL
);

307 
√w_chaö
->
∑ckë_rcode
 = 
	`ldns_pkt_gë_rcode
(
pkt
);

308 
√w_chaö
->
∑ckë_qty≥
 = 
	`ldns_º_gë_ty≥
(
‹ig_º
);

309 i‡(
	`ldns_pkt_™cou¡
(
pkt
) == 0) {

310 
√w_chaö
->
∑ckë_nod©a
 = 
åue
;

312  
√w_chaö
;

315 i‡(!
º£t
 || 
	`ldns_º_li°_º_cou¡
(rrset) < 1) {

318 
√w_chaö
->
∑ckë_nod©a
 = 
åue
;

319 i‡(
pkt
) {

320 
my_º£t
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
,

321 
LDNS_RR_TYPE_NSEC
,

322 
LDNS_SECTION_ANY_NOQUESTION


324 i‡(
my_º£t
) {

325 i‡(
	`ldns_º_li°_º_cou¡
(
my_º£t
) > 0) {

326 
ty≥
 = 
LDNS_RR_TYPE_NSEC
;

327 
Ÿhî_º£t
 = 
åue
;

329 
	`ldns_º_li°_dìp_‰ì
(
my_º£t
);

330 
my_º£t
 = 
NULL
;

334 
my_º£t
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
,

335 
LDNS_RR_TYPE_NSEC3
,

336 
LDNS_SECTION_ANY_NOQUESTION
);

337 i‡(
my_º£t
) {

338 i‡(
	`ldns_º_li°_º_cou¡
(
my_º£t
) > 0) {

339 
ty≥
 = 
LDNS_RR_TYPE_NSEC3
;

340 
Ÿhî_º£t
 = 
åue
;

342 
	`ldns_º_li°_dìp_‰ì
(
my_º£t
);

343 
my_º£t
 = 
NULL
;

348  
√w_chaö
;

352  
√w_chaö
;

355 
my_º£t
 = (
ldns_º_li°
 *Ë
º£t
;

358 i‡(
my_º£t
 && 
	`ldns_º_li°_º_cou¡
(my_rrset) > 0) {

359 
√w_chaö
->
º£t
 = 
	`ldns_º_li°_˛⁄e
(
my_º£t
);

360 
«me
 = 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
my_º£t
, 0));

361 
ty≥
 = 
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
my_º£t
, 0));

362 
c
 = 
	`ldns_º_gë_˛ass
(
	`ldns_º_li°_º
(
my_º£t
, 0));

365 i‡(
Ÿhî_º£t
) {

366 
	`ldns_º_li°_dìp_‰ì
(
my_º£t
);

373 i‡(
ty≥
 =
LDNS_RR_TYPE_NSEC
 ||Åy≥ =
LDNS_RR_TYPE_NSEC3
) {

376 i‡(
pkt
) {

377 
sig«tuªs
 = 
	`ldns_dns£c_pkt_gë_ºsigs_f‹_ty≥
(
pkt
, 
ty≥
);

379 
my_pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
«me
, 
ty≥
, 
c
, 
qÊags
);

380 i‡(
my_pkt
) {

381 
sig«tuªs
 = 
	`ldns_dns£c_pkt_gë_ºsigs_f‹_ty≥
(
pkt
, 
ty≥
);

382 
	`ldns_pkt_‰ì
(
my_pkt
);

386 i‡(
pkt
) {

387 
sig«tuªs
 =

388 
	`ldns_dns£c_pkt_gë_ºsigs_f‹_«me_™d_ty≥
(
pkt
,

389 
«me
,

390 
ty≥
);

392 i‡(!
sig«tuªs
) {

393 
my_pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
«me
, 
ty≥
, 
c
, 
qÊags
);

394 i‡(
my_pkt
) {

395 
sig«tuªs
 =

396 
	`ldns_dns£c_pkt_gë_ºsigs_f‹_«me_™d_ty≥
(
my_pkt
,

397 
«me
,

398 
ty≥
);

399 
	`ldns_pkt_‰ì
(
my_pkt
);

404 i‡(
sig«tuªs
 && 
	`ldns_º_li°_º_cou¡
(signatures) > 0) {

405 
key_«me
 = 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
sig«tuªs
, 0), 7);

407 i‡(!
key_«me
) {

408 i‡(
sig«tuªs
) {

409 
	`ldns_º_li°_dìp_‰ì
(
sig«tuªs
);

411  
	`ldns_dns£c_buûd_d©a_chaö_nokey«me
(
ªs
,

412 
qÊags
,

413 
‹ig_º
,

414 
º£t
,

415 
√w_chaö
);

417 i‡(
ty≥
 !
LDNS_RR_TYPE_DNSKEY
) {

418 
	`ldns_dns£c_buûd_d©a_chaö_dnskey
(
ªs
,

419 
qÊags
,

420 
pkt
,

421 
sig«tuªs
,

422 
√w_chaö
,

423 
key_«me
,

424 
c


427 
	`ldns_dns£c_buûd_d©a_chaö_Ÿhî
(
ªs
,

428 
qÊags
,

429 
√w_chaö
,

430 
key_«me
,

431 
c
,

432 
dss


435 i‡(
sig«tuªs
) {

436 
	`ldns_º_li°_dìp_‰ì
(
sig«tuªs
);

438  
√w_chaö
;

439 
	}
}

441 
ldns_dns£c_åu°_åì
 *

442 
	$ldns_dns£c_åu°_åì_√w
()

444 
ldns_dns£c_åu°_åì
 *
√w_åì
 = 
	`LDNS_XMALLOC
(ldns_dnssec_trust_tree,

446 if(!
√w_åì
Ë 
NULL
;

447 
√w_åì
->
º
 = 
NULL
;

448 
√w_åì
->
º£t
 = 
NULL
;

449 
√w_åì
->
∑ª¡_cou¡
 = 0;

451  
√w_åì
;

452 
	}
}

455 
	$ldns_dns£c_åu°_åì_‰ì
(
ldns_dns£c_åu°_åì
 *
åì
)

457 
size_t
 
i
;

458 i‡(
åì
) {

459 
i
 = 0; i < 
åì
->
∑ª¡_cou¡
; i++) {

460 
	`ldns_dns£c_åu°_åì_‰ì
(
åì
->
∑ª¡s
[
i
]);

463 
	`LDNS_FREE
(
åì
);

464 
	}
}

466 
size_t


467 
	$ldns_dns£c_åu°_åì_dïth
(
ldns_dns£c_åu°_åì
 *
åì
)

469 
size_t
 
ªsu…
 = 0;

470 
size_t
 
∑ª¡
 = 0;

471 
size_t
 
i
;

473 
i
 = 0; i < 
åì
->
∑ª¡_cou¡
; i++) {

474 
∑ª¡
 = 
	`ldns_dns£c_åu°_åì_dïth
(
åì
->
∑ª¡s
[
i
]);

475 i‡(
∑ª¡
 > 
ªsu…
) {

476 
ªsu…
 = 
∑ª¡
;

479  1 + 
ªsu…
;

480 
	}
}

484 
	$¥öt_èbs
(
FILE
 *
out
, 
size_t
 
ƒ
, 
uöt8_t
 *
m≠
, size_à
åìdïth
)

486 
size_t
 
i
;

487 
i
 = 0; i < 
ƒ
; i++) {

488 i‡(
i
 =
ƒ
 - 1) {

489 
	`Ârötf
(
out
, "|---");

490 } i‡(
m≠
 && 
i
 < 
åìdïth
 && map[i] == 1) {

491 
	`Ârötf
(
out
, "| ");

493 
	`Ârötf
(
out
, " ");

496 
	}
}

499 
	$ldns_dns£c_åu°_åì_¥öt_sm_fmt
(
FILE
 *
out
,

500 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

501 
ldns_dns£c_åu°_åì
 *
åì
,

502 
size_t
 
èbs
,

503 
boﬁ
 
exãnded
,

504 
uöt8_t
 *
sibm≠
,

505 
size_t
 
åìdïth
)

507 
size_t
 
i
;

508 c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
;

509 
boﬁ
 
m≠£t
 = 
Ál£
;

511 i‡(!
sibm≠
) {

512 
åìdïth
 = 
	`ldns_dns£c_åu°_åì_dïth
(
åì
);

513 
sibm≠
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
åìdïth
);

514 if(!
sibm≠
)

516 
	`mem£t
(
sibm≠
, 0, 
åìdïth
);

517 
m≠£t
 = 
åue
;

520 i‡(
åì
) {

521 i‡(
åì
->
º
) {

522 
	`¥öt_èbs
(
out
, 
èbs
, 
sibm≠
, 
åìdïth
);

523 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_º_ow√r
(
åì
->
º
));

524 
des¸ùt‹
 = 
	`ldns_º_des¸ùt
(
	`ldns_º_gë_ty≥
(
åì
->
º
));

526 i‡(
des¸ùt‹
->
_«me
) {

527 
	`Ârötf
(
out
, " (%s", 
des¸ùt‹
->
_«me
);

529 
	`Ârötf
(
out
, " (TYPE%d",

530 
	`ldns_º_gë_ty≥
(
åì
->
º
));

532 i‡(
èbs
 > 0) {

533 i‡(
	`ldns_º_gë_ty≥
(
åì
->
º
Ë=
LDNS_RR_TYPE_DNSKEY
) {

534 
	`Ârötf
(
out
, " keytag: %u",

535 (Ë
	`ldns_ˇlc_keyèg
(
åì
->
º
));

536 
	`Ârötf
(
out
, "álg: ");

537 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_º_rdf
(
åì
->
º
, 2));

538 
	`Ârötf
(
out
, " flags: ");

539 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_º_rdf
(
åì
->
º
, 0));

540 } i‡(
	`ldns_º_gë_ty≥
(
åì
->
º
Ë=
LDNS_RR_TYPE_DS
) {

541 
	`Ârötf
(
out
, " keytag: ");

542 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_º_rdf
(
åì
->
º
, 0));

543 
	`Ârötf
(
out
, " digestÅype: ");

544 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_º_rdf
(
åì
->
º
, 2));

546 i‡(
	`ldns_º_gë_ty≥
(
åì
->
º
Ë=
LDNS_RR_TYPE_NSEC
) {

547 
	`Ârötf
(
out
, " ");

548 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_º_rdf
(
åì
->
º
, 0));

549 
	`Ârötf
(
out
, " ");

550 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_º_rdf
(
åì
->
º
, 1));

554 
	`Ârötf
(
out
, ")\n");

555 
i
 = 0; i < 
åì
->
∑ª¡_cou¡
; i++) {

556 i‡(
åì
->
∑ª¡_cou¡
 > 1 && 
i
 <Åree->parent_count - 1) {

557 
sibm≠
[
èbs
] = 1;

559 
sibm≠
[
èbs
] = 0;

562 i‡(
	`ldns_º_gë_ty≥
(
åì
->
∑ª¡s
[
i
]->
º
) ==

563 
LDNS_RR_TYPE_NSEC
 ||

564 
	`ldns_º_gë_ty≥
(
åì
->
∑ª¡s
[
i
]->
º
) ==

565 
LDNS_RR_TYPE_NSEC3
) {

566 i‡(
åì
->
∑ª¡_°©us
[
i
] =
LDNS_STATUS_OK
) {

567 
	`¥öt_èbs
(
out
, 
èbs
 + 1, 
sibm≠
, 
åìdïth
);

568 i‡(
èbs
 == 0 &&

569 
	`ldns_º_gë_ty≥
(
åì
->
º
Ë=
LDNS_RR_TYPE_NS
 &&

570 
	`ldns_º_rd_cou¡
(
åì
->
º
) > 0) {

571 
	`Ârötf
(
out
, "Existence of DS is denied by:\n");

573 
	`Ârötf
(
out
, "Existence is denied by:\n");

577 i‡(
	`ldns_º_gë_ty≥
(
åì
->
º
Ë=
LDNS_RR_TYPE_NS
) {

578 
	`Ârötf
(
out
, "Existence of DS is denied by:\n");

580 
	`¥öt_èbs
(
out
, 
èbs
 + 1, 
sibm≠
, 
åìdïth
);

581 
	`Ârötf
(
out
,

583 
	`ldns_gë_îr‹°r_by_id
(

584 
åì
->
∑ª¡_°©us
[
i
]));

588 i‡(
åì
->
∑ª¡_°©us
[
i
] !
LDNS_STATUS_OK
) {

589 
	`¥öt_èbs
(
out
, 
èbs
 + 1, 
sibm≠
, 
åìdïth
);

590 
	`Ârötf
(
out
,

592 
	`ldns_gë_îr‹°r_by_id
(

593 
åì
->
∑ª¡_°©us
[
i
]));

594 i‡(
åì
->
∑ª¡_°©us
[
i
]

595 =
LDNS_STATUS_SSL_ERR
) {

596 
	`¥ötf
("; SSL Error: ");

597 
	`ERR_lﬂd_¸y±o_°rögs
();

598 
	`ERR_¥öt_îr‹s_Â
(
°dout
);

599 
	`¥ötf
("\n");

601 
	`ldns_º_¥öt_fmt
(
out
, 
fmt
,

602 
åì
->

603 
∑ª¡_sig«tuª
[
i
]);

604 
	`¥ötf
("For RRset:\n");

605 
	`ldns_º_li°_¥öt_fmt
(
out
, 
fmt
,

606 
åì
->
º£t
);

607 
	`¥ötf
("With key:\n");

608 
	`ldns_º_¥öt_fmt
(
out
, 
fmt
,

609 
åì
->
∑ª¡s
[
i
]->
º
);

611 
	`ldns_dns£c_åu°_åì_¥öt_sm_fmt
(
out
, 
fmt
,

612 
åì
->
∑ª¡s
[
i
],

613 
èbs
+1,

614 
exãnded
,

615 
sibm≠
,

616 
åìdïth
);

619 
	`¥öt_èbs
(
out
, 
èbs
, 
sibm≠
, 
åìdïth
);

620 
	`Ârötf
(
out
, "<no data>\n");

623 
	`Ârötf
(
out
, "<nullÖointer>\n");

626 i‡(
m≠£t
) {

627 
	`LDNS_FREE
(
sibm≠
);

629 
	}
}

632 
	$ldns_dns£c_åu°_åì_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

633 
ldns_dns£c_åu°_åì
 *
åì
,

634 
size_t
 
èbs
,

635 
boﬁ
 
exãnded
)

637 
	`ldns_dns£c_åu°_åì_¥öt_sm_fmt
(
out
, 
fmt
,

638 
åì
, 
èbs
, 
exãnded
, 
NULL
, 0);

639 
	}
}

642 
	$ldns_dns£c_åu°_åì_¥öt
(
FILE
 *
out
,

643 
ldns_dns£c_åu°_åì
 *
åì
,

644 
size_t
 
èbs
,

645 
boﬁ
 
exãnded
)

647 
	`ldns_dns£c_åu°_åì_¥öt_fmt
(
out
, 
ldns_ouçut_f‹m©_deÁu…
,

648 
åì
, 
èbs
, 
exãnded
);

649 
	}
}

652 
ldns_°©us


653 
	$ldns_dns£c_åu°_åì_add_∑ª¡
(
ldns_dns£c_åu°_åì
 *
åì
,

654 c⁄° 
ldns_dns£c_åu°_åì
 *
∑ª¡
,

655 c⁄° 
ldns_º
 *
sig«tuª
,

656 c⁄° 
ldns_°©us
 
∑ª¡_°©us
)

658 i‡(
åì


659 && 
∑ª¡


660 && 
åì
->
∑ª¡_cou¡
 < 
LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
) {

667 
åì
->
∑ª¡s
[åì->
∑ª¡_cou¡
] =

668 (
ldns_dns£c_åu°_åì
 *Ë
∑ª¡
;

669 
åì
->
∑ª¡_°©us
[åì->
∑ª¡_cou¡
] =Öarent_status;

670 
åì
->
∑ª¡_sig«tuª
[åì->
∑ª¡_cou¡
] = (
ldns_º
 *Ë
sig«tuª
;

671 
åì
->
∑ª¡_cou¡
++;

672  
LDNS_STATUS_OK
;

674  
LDNS_STATUS_ERR
;

676 
	}
}

679 
ldns_dns£c_åu°_åì
 *

680 
	$ldns_dns£c_dîive_åu°_åì_time
(

681 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

682 
ldns_º
 *
º
,

683 
time_t
 
check_time


686 
ldns_º_li°
 *
cur_º£t
;

687 
ldns_º_li°
 *
cur_sigs
;

688 
ldns_º
 *
cur_º
 = 
NULL
;

689 
ldns_º
 *
cur_sig_º
;

690 
size_t
 
i
, 
j
;

692 
ldns_dns£c_åu°_åì
 *
√w_åì
 = 
	`ldns_dns£c_åu°_åì_√w
();

693 if(!
√w_åì
)

694  
NULL
;

696 i‡(
d©a_chaö
 && d©a_chaö->
º£t
) {

697 
cur_º£t
 = 
d©a_chaö
->
º£t
;

699 
cur_sigs
 = 
d©a_chaö
->
sig«tuªs
;

701 i‡(
º
) {

702 
cur_º
 = 
º
;

705 i‡(!
cur_º
 && 
	`ldns_º_li°_º_cou¡
(
cur_º£t
) > 0) {

706 
cur_º
 = 
	`ldns_º_li°_º
(
cur_º£t
, 0);

709 i‡(
cur_º
) {

710 
√w_åì
->
º
 = 
cur_º
;

711 
√w_åì
->
º£t
 = 
cur_º£t
;

720 i‡(
cur_sigs
) {

721 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
cur_sigs
); i++) {

723 
cur_sig_º
 = 
	`ldns_º_li°_º
(
cur_sigs
, 
i
);

725 i‡(
	`ldns_º_gë_ty≥
(
cur_º
Ë=
LDNS_RR_TYPE_NSEC
) {

726 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
cur_sig_º
),

727 
	`ldns_º_ow√r
(
cur_º
)))

731 
j
 = 0;

732 
j
 < 
	`ldns_º_li°_º_cou¡
(
cur_º£t
) &&

733 
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
cur_sig_º
),ldns_º_ow√r(
cur_º
)) != 0;

734 
j
++) {

735 
cur_º
 = 
	`ldns_º_li°_º
(
cur_º£t
, 
j
);

738 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
cur_sig_º
),

739 
	`ldns_º_ow√r
(
cur_º
)))

747 i‡(
d©a_chaö
->
∑ª¡
) {

748 
	`ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t_time
(

749 
√w_åì
,

750 
d©a_chaö
,

751 
cur_sig_º
,

752 
check_time
);

756 
	`ldns_dns£c_dîive_åu°_åì_dnskey_º£t_time
(

757 
√w_åì
,

758 
d©a_chaö
,

759 
cur_º
,

760 
cur_sig_º
,

761 
check_time
);

764 
	`ldns_dns£c_dîive_åu°_åì_ds_º£t_time
(

765 
√w_åì
, 
d©a_chaö
,

766 
cur_º
, 
check_time
);

771 
	`ldns_dns£c_dîive_åu°_åì_no_sig_time
(

772 
√w_åì
, 
d©a_chaö
, 
check_time
);

777  
√w_åì
;

778 
	}
}

780 
ldns_dns£c_åu°_åì
 *

781 
	$ldns_dns£c_dîive_åu°_åì
(
ldns_dns£c_d©a_chaö
 *
d©a_chaö
, 
ldns_º
 *
º
)

783  
	`ldns_dns£c_dîive_åu°_åì_time
(
d©a_chaö
, 
º
, 
	`ldns_time
(
NULL
));

784 
	}
}

787 
	$ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t_time
(

788 
ldns_dns£c_åu°_åì
 *
√w_åì
,

789 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

790 
ldns_º
 *
cur_sig_º
,

791 
time_t
 
check_time
)

793 
size_t
 
i
, 
j
;

794 
ldns_º_li°
 *
cur_º£t
 = 
	`ldns_º_li°_˛⁄e
(
d©a_chaö
->
º£t
);

795 
ldns_dns£c_åu°_åì
 *
cur_∑ª¡_åì
;

796 
ldns_º
 *
cur_∑ª¡_º
;

797 
uöt16_t
 
cur_keyèg
;

798 
ldns_º_li°
 *
tmp_º£t
 = 
NULL
;

799 
ldns_°©us
 
cur_°©us
;

801 
cur_keyèg
 = 
	`ldns_rdf2«tive_öt16
(
	`ldns_º_ºsig_keyèg
(
cur_sig_º
));

803 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
d©a_chaö
->
∑ª¡
->
º£t
); j++) {

804 
cur_∑ª¡_º
 = 
	`ldns_º_li°_º
(
d©a_chaö
->
∑ª¡
->
º£t
, 
j
);

805 i‡(
	`ldns_º_gë_ty≥
(
cur_∑ª¡_º
Ë=
LDNS_RR_TYPE_DNSKEY
) {

806 i‡(
	`ldns_ˇlc_keyèg
(
cur_∑ª¡_º
Ë=
cur_keyèg
) {

809 i‡(
cur_º£t
 && 
	`ldns_º_li°_º_cou¡
(cur_rrset) > 0) {

810 
tmp_º£t
 = 
cur_º£t
;

811 i‡(
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
cur_º£t
, 0))

812 =
LDNS_RR_TYPE_NSEC
 ||

813 
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
cur_º£t
, 0))

814 =
LDNS_RR_TYPE_NSEC3
) {

817 
	`ldns_º_li°_s‹t
(
cur_º£t
);

818 
	`as£π
(
tmp_º£t
 =
cur_º£t
);

819 
tmp_º£t
 = 
	`ldns_º_li°_p›_º£t
(
cur_º£t
);

822 
tmp_º£t
 &&

823 
	`ldns_º_li°_º_cou¡
(
cur_º£t
) > 0 &&

824 
	`ldns_d«me_com∑ª
(

825 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(

826 
tmp_º£t
, 0)),

827 
	`ldns_º_ow√r
(
cur_sig_º
)) != 0) {

828 
	`ldns_º_li°_dìp_‰ì
(
tmp_º£t
);

829 
tmp_º£t
 =

830 
	`ldns_º_li°_p›_º£t
(
cur_º£t
);

833 
cur_°©us
 = 
	`ldns_vîify_ºsig_time
(

834 
tmp_º£t
,

835 
cur_sig_º
,

836 
cur_∑ª¡_º
,

837 
check_time
);

838 i‡(
tmp_º£t
 &&Åmp_º£à!
cur_º£t


840 
	`ldns_º_li°_dìp_‰ì
(

841 
tmp_º£t
);

842 
tmp_º£t
 = 
NULL
;

845 
i
 = 0; i < 
√w_åì
->
∑ª¡_cou¡
; i++) {

846 i‡(
cur_∑ª¡_º
 =
√w_åì
->
∑ª¡s
[
i
]->
º
) {

847 
d⁄e
;

851 
cur_∑ª¡_åì
 =

852 
	`ldns_dns£c_dîive_åu°_åì_time
(

853 
d©a_chaö
->
∑ª¡
,

854 
cur_∑ª¡_º
,

855 
check_time
);

856 ()
	`ldns_dns£c_åu°_åì_add_∑ª¡
(
√w_åì
,

857 
cur_∑ª¡_åì
,

858 
cur_sig_º
,

859 
cur_°©us
);

864 
d⁄e
:

865 
	`ldns_º_li°_dìp_‰ì
(
cur_º£t
);

866 
	}
}

869 
	$ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t
(
ldns_dns£c_åu°_åì
 *
√w_åì
,

870 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

871 
ldns_º
 *
cur_sig_º
)

873 
	`ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t_time
(

874 
√w_åì
, 
d©a_chaö
, 
cur_sig_º
, 
	`ldns_time
(
NULL
));

875 
	}
}

878 
	$ldns_dns£c_dîive_åu°_åì_dnskey_º£t_time
(

879 
ldns_dns£c_åu°_åì
 *
√w_åì
,

880 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

881 
ldns_º
 *
cur_º
,

882 
ldns_º
 *
cur_sig_º
,

883 
time_t
 
check_time
)

885 
size_t
 
j
;

886 
ldns_º_li°
 *
cur_º£t
 = 
d©a_chaö
->
º£t
;

887 
ldns_dns£c_åu°_åì
 *
cur_∑ª¡_åì
;

888 
ldns_º
 *
cur_∑ª¡_º
;

889 
uöt16_t
 
cur_keyèg
;

890 
ldns_°©us
 
cur_°©us
;

892 
cur_keyèg
 = 
	`ldns_rdf2«tive_öt16
(
	`ldns_º_ºsig_keyèg
(
cur_sig_º
));

894 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
cur_º£t
); j++) {

895 
cur_∑ª¡_º
 = 
	`ldns_º_li°_º
(
cur_º£t
, 
j
);

896 i‡(
cur_∑ª¡_º
 !
cur_º
 &&

897 
	`ldns_º_gë_ty≥
(
cur_∑ª¡_º
Ë=
LDNS_RR_TYPE_DNSKEY
) {

898 i‡(
	`ldns_ˇlc_keyèg
(
cur_∑ª¡_º
Ë=
cur_keyèg


900 
cur_∑ª¡_åì
 = 
	`ldns_dns£c_åu°_åì_√w
();

901 
cur_∑ª¡_åì
->
º
 = 
cur_∑ª¡_º
;

902 
cur_∑ª¡_åì
->
º£t
 = 
cur_º£t
;

903 
cur_°©us
 = 
	`ldns_vîify_ºsig_time
(

904 
cur_º£t
, 
cur_sig_º
,

905 
cur_∑ª¡_º
, 
check_time
);

906 (Ë
	`ldns_dns£c_åu°_åì_add_∑ª¡
(
√w_åì
,

907 
cur_∑ª¡_åì
, 
cur_sig_º
, 
cur_°©us
);

911 
	}
}

914 
	$ldns_dns£c_dîive_åu°_åì_dnskey_º£t
(
ldns_dns£c_åu°_åì
 *
√w_åì
,

915 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

916 
ldns_º
 *
cur_º
,

917 
ldns_º
 *
cur_sig_º
)

919 
	`ldns_dns£c_dîive_åu°_åì_dnskey_º£t_time
(

920 
√w_åì
, 
d©a_chaö
, 
cur_º
, 
cur_sig_º
, 
	`ldns_time
(
NULL
));

921 
	}
}

924 
	$ldns_dns£c_dîive_åu°_åì_ds_º£t_time
(

925 
ldns_dns£c_åu°_åì
 *
√w_åì
,

926 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

927 
ldns_º
 *
cur_º
,

928 
time_t
 
check_time
)

930 
size_t
 
j
, 
h
;

931 
ldns_º_li°
 *
cur_º£t
 = 
d©a_chaö
->
º£t
;

932 
ldns_dns£c_åu°_åì
 *
cur_∑ª¡_åì
;

933 
ldns_º
 *
cur_∑ª¡_º
;

936 i‡(
	`ldns_º_gë_ty≥
(
cur_º
Ë=
LDNS_RR_TYPE_DNSKEY
 &&

937 
d©a_chaö
->
∑ª¡
 &&

938 
d©a_chaö
->
∑ª¡
->
º£t


940 
j
 = 0;

941 
j
 < 
	`ldns_º_li°_º_cou¡
(
d©a_chaö
->
∑ª¡
->
º£t
);

942 
j
++) {

943 
cur_∑ª¡_º
 = 
	`ldns_º_li°_º
(
d©a_chaö
->
∑ª¡
->
º£t
, 
j
);

944 i‡(
	`ldns_º_gë_ty≥
(
cur_∑ª¡_º
Ë=
LDNS_RR_TYPE_DS
) {

945 
h
 = 0; h < 
	`ldns_º_li°_º_cou¡
(
cur_º£t
); h++) {

946 
cur_º
 = 
	`ldns_º_li°_º
(
cur_º£t
, 
h
);

947 i‡(
	`ldns_º_com∑ª_ds
(
cur_º
, 
cur_∑ª¡_º
)) {

948 
cur_∑ª¡_åì
 =

949 
	`ldns_dns£c_dîive_åu°_åì_time
(

950 
d©a_chaö
->
∑ª¡
,

951 
cur_∑ª¡_º
,

952 
check_time
);

953 (Ë
	`ldns_dns£c_åu°_åì_add_∑ª¡
(

954 
√w_åì
,

955 
cur_∑ª¡_åì
,

956 
NULL
,

957 
LDNS_STATUS_OK
);

965 
	}
}

968 
	$ldns_dns£c_dîive_åu°_åì_ds_º£t
(
ldns_dns£c_åu°_åì
 *
√w_åì
,

969 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

970 
ldns_º
 *
cur_º
)

972 
	`ldns_dns£c_dîive_åu°_åì_ds_º£t_time
(

973 
√w_åì
, 
d©a_chaö
, 
cur_º
, 
	`ldns_time
(
NULL
));

974 
	}
}

977 
	$ldns_dns£c_dîive_åu°_åì_no_sig_time
(

978 
ldns_dns£c_åu°_åì
 *
√w_åì
,

979 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

980 
time_t
 
check_time
)

982 
size_t
 
i
;

983 
ldns_º_li°
 *
cur_º£t
;

984 
ldns_º
 *
cur_∑ª¡_º
;

985 
ldns_dns£c_åu°_åì
 *
cur_∑ª¡_åì
;

986 
ldns_°©us
 
ªsu…
;

988 i‡(
d©a_chaö
->
∑ª¡
 && d©a_chaö->∑ª¡->
º£t
) {

989 
cur_º£t
 = 
d©a_chaö
->
∑ª¡
->
º£t
;

991 i‡(
cur_º£t
 && 
	`ldns_º_li°_º_cou¡
(cur_rrset) > 0) {

992 i‡(
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
cur_º£t
, 0)) ==

993 
LDNS_RR_TYPE_NSEC3
) {

994 
ªsu…
 = 
	`ldns_dns£c_vîify_díül_n£c3
(

995 
√w_åì
->
º
,

996 
cur_º£t
,

997 
d©a_chaö
->
∑ª¡
->
sig«tuªs
,

998 
d©a_chaö
->
∑ckë_rcode
,

999 
d©a_chaö
->
∑ckë_qty≥
,

1000 
d©a_chaö
->
∑ckë_nod©a
);

1001 } i‡(
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
cur_º£t
, 0)) ==

1002 
LDNS_RR_TYPE_NSEC
) {

1003 
ªsu…
 = 
	`ldns_dns£c_vîify_díül
(

1004 
√w_åì
->
º
,

1005 
cur_º£t
,

1006 
d©a_chaö
->
∑ª¡
->
sig«tuªs
);

1009 
ªsu…
 = 
LDNS_STATUS_OK
;

1012 
ªsu…
 = 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
;

1014 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
cur_º£t
); i++) {

1015 
cur_∑ª¡_º
 = 
	`ldns_º_li°_º
(
cur_º£t
, 
i
);

1016 
cur_∑ª¡_åì
 =

1017 
	`ldns_dns£c_dîive_åu°_åì_time
(

1018 
d©a_chaö
->
∑ª¡
,

1019 
cur_∑ª¡_º
,

1020 
check_time
);

1021 (Ë
	`ldns_dns£c_åu°_åì_add_∑ª¡
(
√w_åì
,

1022 
cur_∑ª¡_åì
, 
NULL
, 
ªsu…
);

1025 
	}
}

1028 
	$ldns_dns£c_dîive_åu°_åì_no_sig
(
ldns_dns£c_åu°_åì
 *
√w_åì
,

1029 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
)

1031 
	`ldns_dns£c_dîive_åu°_åì_no_sig_time
(

1032 
√w_åì
, 
d©a_chaö
, 
	`ldns_time
(
NULL
));

1033 
	}
}

1040 
ldns_°©us


1041 
	$ldns_dns£c_åu°_åì_c⁄èös_keys
(
ldns_dns£c_åu°_åì
 *
åì
,

1042 
ldns_º_li°
 *
åu°ed_keys
)

1044 
size_t
 
i
;

1045 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_CRYPTO_NO_DNSKEY
;

1046 
boﬁ
 
equÆ
;

1047 
ldns_°©us
 
∑ª¡_ªsu…
;

1049 i‡(
åì
 && 
åu°ed_keys
 && 
	`ldns_º_li°_º_cou¡
(trusted_keys) > 0)

1050 { i‡(
åì
->
º
) {

1051 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
åu°ed_keys
); i++) {

1052 
equÆ
 = 
	`ldns_º_com∑ª_ds
(

1053 
åì
->
º
,

1054 
	`ldns_º_li°_º
(
åu°ed_keys
, 
i
));

1055 i‡(
equÆ
) {

1056 
ªsu…
 = 
LDNS_STATUS_OK
;

1057  
ªsu…
;

1061 
i
 = 0; i < 
åì
->
∑ª¡_cou¡
; i++) {

1062 
∑ª¡_ªsu…
 =

1063 
	`ldns_dns£c_åu°_åì_c⁄èös_keys
(
åì
->
∑ª¡s
[
i
],

1064 
åu°ed_keys
);

1065 i‡(
∑ª¡_ªsu…
 !
LDNS_STATUS_CRYPTO_NO_DNSKEY
) {

1066 i‡(
åì
->
∑ª¡_°©us
[
i
] !
LDNS_STATUS_OK
) {

1067 
ªsu…
 = 
åì
->
∑ª¡_°©us
[
i
];

1069 i‡(
åì
->
º
 &&

1070 
	`ldns_º_gë_ty≥
(
åì
->
º
)

1071 =
LDNS_RR_TYPE_NSEC
 &&

1072 
∑ª¡_ªsu…
 =
LDNS_STATUS_OK


1074 
ªsu…
 =

1075 
LDNS_STATUS_DNSSEC_EXISTENCE_DENIED
;

1077 
ªsu…
 = 
∑ª¡_ªsu…
;

1083 
ªsu…
 = 
LDNS_STATUS_ERR
;

1086  
ªsu…
;

1087 
	}
}

1089 
ldns_°©us


1090 
	$ldns_vîify_time
(

1091 
ldns_º_li°
 *
º£t
,

1092 
ldns_º_li°
 *
ºsig
,

1093 c⁄° 
ldns_º_li°
 *
keys
,

1094 
time_t
 
check_time
,

1095 
ldns_º_li°
 *
good_keys


1098 
uöt16_t
 
i
;

1099 
ldns_°©us
 
vîify_ªsu…
 = 
LDNS_STATUS_ERR
;

1101 i‡(!
º£t
 || !
ºsig
 || !
keys
) {

1102  
LDNS_STATUS_ERR
;

1105 i‡(
	`ldns_º_li°_º_cou¡
(
º£t
) < 1) {

1106  
LDNS_STATUS_ERR
;

1109 i‡(
	`ldns_º_li°_º_cou¡
(
ºsig
) < 1) {

1110  
LDNS_STATUS_CRYPTO_NO_RRSIG
;

1113 i‡(
	`ldns_º_li°_º_cou¡
(
keys
) < 1) {

1114 
vîify_ªsu…
 = 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DNSKEY
;

1116 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºsig
); i++) {

1117 
ldns_°©us
 
s
 = 
	`ldns_vîify_ºsig_keyli°_time
(

1118 
º£t
, 
	`ldns_º_li°_º
(
ºsig
, 
i
),

1119 
keys
, 
check_time
, 
good_keys
);

1121 if(
s
 =
LDNS_STATUS_OK
) {

1122 
vîify_ªsu…
 = 
LDNS_STATUS_OK
;

1123 } if(
vîify_ªsu…
 =
LDNS_STATUS_ERR
)

1124 
vîify_ªsu…
 = 
s
;

1125 if(
s
 !
LDNS_STATUS_ERR
 && 
vîify_ªsu…
 ==

1126 
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
)

1127 
vîify_ªsu…
 = 
s
;

1130  
vîify_ªsu…
;

1131 
	}
}

1133 
ldns_°©us


1134 
	$ldns_vîify
(
ldns_º_li°
 *
º£t
,Üdns_º_li° *
ºsig
, c⁄°Üdns_º_li° *
keys
,

1135 
ldns_º_li°
 *
good_keys
)

1137  
	`ldns_vîify_time
(
º£t
, 
ºsig
, 
keys
, 
	`ldns_time
(
NULL
), 
good_keys
);

1138 
	}
}

1140 
ldns_°©us


1141 
	$ldns_vîify_nŸime
(
ldns_º_li°
 *
º£t
,Üdns_º_li° *
ºsig
,

1142 c⁄° 
ldns_º_li°
 *
keys
,Üdns_º_li° *
good_keys
)

1144 
uöt16_t
 
i
;

1145 
ldns_°©us
 
vîify_ªsu…
 = 
LDNS_STATUS_ERR
;

1147 i‡(!
º£t
 || !
ºsig
 || !
keys
) {

1148  
LDNS_STATUS_ERR
;

1151 i‡(
	`ldns_º_li°_º_cou¡
(
º£t
) < 1) {

1152  
LDNS_STATUS_ERR
;

1155 i‡(
	`ldns_º_li°_º_cou¡
(
ºsig
) < 1) {

1156  
LDNS_STATUS_CRYPTO_NO_RRSIG
;

1159 i‡(
	`ldns_º_li°_º_cou¡
(
keys
) < 1) {

1160 
vîify_ªsu…
 = 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DNSKEY
;

1162 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºsig
); i++) {

1163 
ldns_°©us
 
s
 = 
	`ldns_vîify_ºsig_keyli°_nŸime
(
º£t
,

1164 
	`ldns_º_li°_º
(
ºsig
, 
i
), 
keys
, 
good_keys
);

1167 i‡(
s
 =
LDNS_STATUS_OK
) {

1168 
vîify_ªsu…
 = 
LDNS_STATUS_OK
;

1169 } i‡(
vîify_ªsu…
 =
LDNS_STATUS_ERR
) {

1170 
vîify_ªsu…
 = 
s
;

1171 } i‡(
s
 !
LDNS_STATUS_ERR
 && 
vîify_ªsu…
 ==

1172 
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
) {

1173 
vîify_ªsu…
 = 
s
;

1177  
vîify_ªsu…
;

1178 
	}
}

1180 
ldns_º_li°
 *

1181 
	$ldns_„tch_vÆid_domaö_keys_time
(c⁄° 
ldns_ªsﬁvî
 *
ªs
,

1182 c⁄° 
ldns_rdf
 *
domaö
,

1183 c⁄° 
ldns_º_li°
 *
keys
,

1184 
time_t
 
check_time
,

1185 
ldns_°©us
 *
°©us
)

1187 
ldns_º_li°
 * 
åu°ed_keys
 = 
NULL
;

1188 
ldns_º_li°
 * 
ds_keys
 = 
NULL
;

1189 
ldns_rdf
 * 
¥ev_∑ª¡_domaö
;

1190 
ldns_rdf
 * 
∑ª¡_domaö
;

1191 
ldns_º_li°
 * 
∑ª¡_keys
 = 
NULL
;

1193 i‡(
ªs
 && 
domaö
 && 
keys
) {

1195 i‡((
åu°ed_keys
 = 
	`ldns_vÆid©e_domaö_dnskey_time
(
ªs
,

1196 
domaö
, 
keys
, 
check_time
))) {

1197 *
°©us
 = 
LDNS_STATUS_OK
;

1200 *
°©us
 = 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DNSKEY
;

1202 
∑ª¡_domaö
 = 
	`ldns_d«me_À·_ch›
(
domaö
);

1203 
∑ª¡_domaö
 &&

1204 
	`ldns_rdf_size
(
∑ª¡_domaö
) > 0) {

1206 i‡((
∑ª¡_keys
 =

1207 
	`ldns_„tch_vÆid_domaö_keys_time
(
ªs
,

1208 
∑ª¡_domaö
,

1209 
keys
,

1210 
check_time
,

1211 
°©us
))) {

1213 i‡((
ds_keys
 =

1214 
	`ldns_vÆid©e_domaö_ds_time
(
ªs
,

1215 
domaö
,

1216 
∑ª¡_keys
,

1217 
check_time
))) {

1218 
åu°ed_keys
 =

1219 
	`ldns_„tch_vÆid_domaö_keys_time
(

1220 
ªs
,

1221 
domaö
,

1222 
ds_keys
,

1223 
check_time
,

1224 
°©us
);

1225 
	`ldns_º_li°_dìp_‰ì
(
ds_keys
);

1228 *
°©us
 = 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DS
 ;

1230 
	`ldns_º_li°_dìp_‰ì
(
∑ª¡_keys
);

1233 
∑ª¡_domaö
 = 
	`ldns_d«me_À·_ch›
((

1234 
¥ev_∑ª¡_domaö


1235 
∑ª¡_domaö


1237 
	`ldns_rdf_dìp_‰ì
(
¥ev_∑ª¡_domaö
);

1240 i‡(
∑ª¡_domaö
) {

1241 
	`ldns_rdf_dìp_‰ì
(
∑ª¡_domaö
);

1245  
åu°ed_keys
;

1246 
	}
}

1248 
ldns_º_li°
 *

1249 
	$ldns_„tch_vÆid_domaö_keys
(c⁄° 
ldns_ªsﬁvî
 *
ªs
,

1250 c⁄° 
ldns_rdf
 *
domaö
,

1251 c⁄° 
ldns_º_li°
 *
keys
,

1252 
ldns_°©us
 *
°©us
)

1254  
	`ldns_„tch_vÆid_domaö_keys_time
(

1255 
ªs
, 
domaö
, 
keys
, 
	`ldns_time
(
NULL
), 
°©us
);

1256 
	}
}

1258 
ldns_º_li°
 *

1259 
	$ldns_vÆid©e_domaö_dnskey_time
(

1260 c⁄° 
ldns_ªsﬁvî
 * 
ªs
,

1261 c⁄° 
ldns_rdf
 * 
domaö
,

1262 c⁄° 
ldns_º_li°
 * 
keys
,

1263 
time_t
 
check_time


1266 
ldns_pkt
 * 
keypkt
;

1267 
ldns_º
 * 
cur_key
;

1268 
uöt16_t
 
key_i
; uöt16_à
key_j
; uöt16_à
key_k
;

1269 
uöt16_t
 
sig_i
; 
ldns_º
 * 
cur_sig
;

1271 
ldns_º_li°
 * 
domaö_keys
 = 
NULL
;

1272 
ldns_º_li°
 * 
domaö_sigs
 = 
NULL
;

1273 
ldns_º_li°
 * 
åu°ed_keys
 = 
NULL
;

1276 
keypkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
domaö
,

1277 
LDNS_RR_TYPE_DNSKEY
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

1278 i‡(
keypkt
) {

1279 
domaö_keys
 = 
	`ldns_pkt_º_li°_by_ty≥
(
keypkt
,

1280 
LDNS_RR_TYPE_DNSKEY
,

1281 
LDNS_SECTION_ANSWER
);

1282 
domaö_sigs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
keypkt
,

1283 
LDNS_RR_TYPE_RRSIG
,

1284 
LDNS_SECTION_ANSWER
);

1287 
key_i
=0; key_i< 
	`ldns_º_li°_º_cou¡
(
domaö_keys
); key_i++) {

1289 
cur_key
 = 
	`ldns_º_li°_º
(
domaö_keys
, 
key_i
);

1290 
key_j
=0; key_j<
	`ldns_º_li°_º_cou¡
(
keys
); key_j++) {

1291 i‡(
	`ldns_º_com∑ª_ds
(
	`ldns_º_li°_º
(
keys
, 
key_j
),

1292 
cur_key
)) {

1295 
åu°ed_keys
 = 
	`ldns_º_li°_√w
();

1297 
sig_i
=0;

1298 
sig_i
<
	`ldns_º_li°_º_cou¡
(
domaö_sigs
);

1299 
sig_i
++) {

1300 
cur_sig
 = 
	`ldns_º_li°_º
(
domaö_sigs
, 
sig_i
);

1302 i‡(
	`ldns_rdf2«tive_öt16
(

1303 
	`ldns_º_ºsig_keyèg
(
cur_sig
))

1304 =
	`ldns_ˇlc_keyèg
(
cur_key
)) {

1305 i‡(
	`ldns_vîify_ºsig_time
(

1306 
domaö_keys
,

1307 
cur_sig
,

1308 
cur_key
,

1309 
check_time
)

1310 =
LDNS_STATUS_OK
) {

1314 
key_k
=0;

1315 
key_k
<
	`ldns_º_li°_º_cou¡
(

1316 
domaö_keys
);

1317 
key_k
++) {

1318 
	`ldns_º_li°_push_º
(

1319 
åu°ed_keys
,

1320 
	`ldns_º_˛⁄e
(

1321 
	`ldns_º_li°_º
(

1322 
domaö_keys
,

1323 
key_k
)));

1326 
	`ldns_º_li°_dìp_‰ì
(
domaö_keys
);

1327 
	`ldns_º_li°_dìp_‰ì
(
domaö_sigs
);

1328 
	`ldns_pkt_‰ì
(
keypkt
);

1329  
åu°ed_keys
;

1335 
	`ldns_º_li°_push_º
(
åu°ed_keys
,

1336 
	`ldns_º_˛⁄e
(
cur_key
));

1341 
	`ldns_º_li°_dìp_‰ì
(
domaö_keys
);

1342 
	`ldns_º_li°_dìp_‰ì
(
domaö_sigs
);

1343 
	`ldns_pkt_‰ì
(
keypkt
);

1349  
åu°ed_keys
;

1350 
	}
}

1352 
ldns_º_li°
 *

1353 
	$ldns_vÆid©e_domaö_dnskey
(c⁄° 
ldns_ªsﬁvî
 * 
ªs
,

1354 c⁄° 
ldns_rdf
 * 
domaö
,

1355 c⁄° 
ldns_º_li°
 * 
keys
)

1357  
	`ldns_vÆid©e_domaö_dnskey_time
(

1358 
ªs
, 
domaö
, 
keys
, 
	`ldns_time
(
NULL
));

1359 
	}
}

1361 
ldns_º_li°
 *

1362 
	$ldns_vÆid©e_domaö_ds_time
(

1363 c⁄° 
ldns_ªsﬁvî
 *
ªs
,

1364 c⁄° 
ldns_rdf
 * 
domaö
,

1365 c⁄° 
ldns_º_li°
 * 
keys
,

1366 
time_t
 
check_time
)

1368 
ldns_pkt
 * 
d•kt
;

1369 
uöt16_t
 
key_i
;

1370 
ldns_º_li°
 * 
º£t
 = 
NULL
;

1371 
ldns_º_li°
 * 
sigs
 = 
NULL
;

1372 
ldns_º_li°
 * 
åu°ed_keys
 = 
NULL
;

1375 
d•kt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
domaö
,

1376 
LDNS_RR_TYPE_DS
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

1377 i‡(
d•kt
) {

1378 
º£t
 = 
	`ldns_pkt_º_li°_by_ty≥
(
d•kt
,

1379 
LDNS_RR_TYPE_DS
,

1380 
LDNS_SECTION_ANSWER
);

1381 
sigs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
d•kt
,

1382 
LDNS_RR_TYPE_RRSIG
,

1383 
LDNS_SECTION_ANSWER
);

1386 i‡(
	`ldns_vîify_time
(
º£t
, 
sigs
, 
keys
, 
check_time
, 
NULL
)

1387 =
LDNS_STATUS_OK
) {

1388 
åu°ed_keys
 = 
	`ldns_º_li°_√w
();

1389 
key_i
=0; key_i<
	`ldns_º_li°_º_cou¡
(
º£t
); key_i++) {

1390 
	`ldns_º_li°_push_º
(
åu°ed_keys
,

1391 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
º£t
,

1392 
key_i
)

1398 
	`ldns_º_li°_dìp_‰ì
(
º£t
);

1399 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

1400 
	`ldns_pkt_‰ì
(
d•kt
);

1406  
åu°ed_keys
;

1407 
	}
}

1409 
ldns_º_li°
 *

1410 
	$ldns_vÆid©e_domaö_ds
(c⁄° 
ldns_ªsﬁvî
 *
ªs
,

1411 c⁄° 
ldns_rdf
 * 
domaö
,

1412 c⁄° 
ldns_º_li°
 * 
keys
)

1414  
	`ldns_vÆid©e_domaö_ds_time
(
ªs
, 
domaö
, 
keys
, 
	`ldns_time
(
NULL
));

1415 
	}
}

1417 
ldns_°©us


1418 
	$ldns_vîify_åu°ed_time
(

1419 
ldns_ªsﬁvî
 *
ªs
,

1420 
ldns_º_li°
 *
º£t
,

1421 
ldns_º_li°
 * 
ºsigs
,

1422 
time_t
 
check_time
,

1423 
ldns_º_li°
 * 
vÆid©ög_keys


1426 
uöt16_t
 
sig_i
; uöt16_à
key_i
;

1427 
ldns_º
 * 
cur_sig
;Üdns_º * 
cur_key
;

1428 
ldns_º_li°
 * 
åu°ed_keys
 = 
NULL
;

1429 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_ERR
;

1431 i‡(!
ªs
 || !
º£t
 || !
ºsigs
) {

1432  
LDNS_STATUS_ERR
;

1435 i‡(
	`ldns_º_li°_º_cou¡
(
º£t
) < 1) {

1436  
LDNS_STATUS_ERR
;

1439 i‡(
	`ldns_º_li°_º_cou¡
(
ºsigs
) < 1) {

1440  
LDNS_STATUS_CRYPTO_NO_RRSIG
;

1444 
sig_i
=0; sig_ò< 
	`ldns_º_li°_º_cou¡
(
ºsigs
); sig_i++) {

1446 
cur_sig
 = 
	`ldns_º_li°_º
(
ºsigs
, 
sig_i
);

1448 i‡((
åu°ed_keys
 = 
	`ldns_„tch_vÆid_domaö_keys_time
(

1449 
ªs
,

1450 
	`ldns_º_ºsig_sig«me
(
cur_sig
),

1451 
	`ldns_ªsﬁvî_dns£c_™ch‹s
(
ªs
),

1452 
check_time
,

1453 &
ªsu…
))) {

1455 
key_i
 = 0;

1456 
key_i
 < 
	`ldns_º_li°_º_cou¡
(
åu°ed_keys
);

1457 
key_i
++) {

1458 
cur_key
 = 
	`ldns_º_li°_º
(
åu°ed_keys
, 
key_i
);

1460 i‡((
ªsu…
 = 
	`ldns_vîify_ºsig_time
(
º£t
,

1461 
cur_sig
,

1462 
cur_key
,

1463 
check_time
))

1464 =
LDNS_STATUS_OK
) {

1465 i‡(
vÆid©ög_keys
) {

1466 
	`ldns_º_li°_push_º
(
vÆid©ög_keys
,

1467 
	`ldns_º_˛⁄e
(
cur_key
));

1469 
	`ldns_º_li°_dìp_‰ì
(
åu°ed_keys
);

1470  
LDNS_STATUS_OK
;

1476 
	`ldns_º_li°_dìp_‰ì
(
åu°ed_keys
);

1477  
ªsu…
;

1478 
	}
}

1480 
ldns_°©us


1481 
	$ldns_vîify_åu°ed
(

1482 
ldns_ªsﬁvî
 *
ªs
,

1483 
ldns_º_li°
 *
º£t
,

1484 
ldns_º_li°
 * 
ºsigs
,

1485 
ldns_º_li°
 * 
vÆid©ög_keys
)

1487  
	`ldns_vîify_åu°ed_time
(

1488 
ªs
, 
º£t
, 
ºsigs
, 
	`ldns_time
(
NULL
), 
vÆid©ög_keys
);

1489 
	}
}

1492 
ldns_°©us


1493 
	$ldns_dns£c_vîify_díül
(
ldns_º
 *
º
,

1494 
ldns_º_li°
 *
n£cs
,

1495 
ldns_º_li°
 *
ºsigs
)

1497 
ldns_rdf
 *
º_«me
;

1498 
ldns_rdf
 *
wûdˇrd_«me
;

1499 
ldns_rdf
 *
ch›≥d_d«me
;

1500 
ldns_º
 *
cur_n£c
;

1501 
size_t
 
i
;

1502 
ldns_°©us
 
ªsu…
;

1504 
ldns_º
 *
ºsig
;

1505 
boﬁ
 
«me_covîed
 = 
Ál£
;

1506 
boﬁ
 
ty≥_covîed
 = 
Ál£
;

1507 
boﬁ
 
wûdˇrd_covîed
 = 
Ál£
;

1508 
boﬁ
 
wûdˇrd_ty≥_covîed
 = 
Ál£
;

1510 
wûdˇrd_«me
 = 
	`ldns_d«me_√w_‰m_°r
("*");

1511 
º_«me
 = 
	`ldns_º_ow√r
(
º
);

1512 
ch›≥d_d«me
 = 
	`ldns_d«me_À·_ch›
(
º_«me
);

1513 
ªsu…
 = 
	`ldns_d«me_ˇt
(
wûdˇrd_«me
, 
ch›≥d_d«me
);

1514 
	`ldns_rdf_dìp_‰ì
(
ch›≥d_d«me
);

1515 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

1516  
ªsu…
;

1519 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
n£cs
); i++) {

1520 
cur_n£c
 = 
	`ldns_º_li°_º
(
n£cs
, 
i
);

1521 i‡(
	`ldns_d«me_com∑ª
(
º_«me
, 
	`ldns_º_ow√r
(
cur_n£c
)) == 0) {

1525 
ºsig
 = 
	`ldns_dns£c_gë_ºsig_f‹_«me_™d_ty≥
(

1526 
	`ldns_º_ow√r
(
cur_n£c
),

1527 
	`ldns_º_gë_ty≥
(
cur_n£c
),

1528 
ºsigs
);

1529 i‡(
ºsig
 && 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_ºsig_œbñs
(rrsig))

1530 =
	`ldns_d«me_œbñ_cou¡
(
º_«me
)) {

1531 
wûdˇrd_covîed
 = 
åue
;

1534 i‡(
	`ldns_n£c_bôm≠_covîs_ty≥
(
	`ldns_n£c_gë_bôm≠
(
cur_n£c
),

1535 
	`ldns_º_gë_ty≥
(
º
))) {

1536 
ty≥_covîed
 = 
åue
;

1539 i‡(
	`ldns_n£c_covîs_«me
(
cur_n£c
, 
º_«me
)) {

1540 
«me_covîed
 = 
åue
;

1543 i‡(
	`ldns_d«me_com∑ª
(
wûdˇrd_«me
,

1544 
	`ldns_º_ow√r
(
cur_n£c
)) == 0) {

1545 i‡(
	`ldns_n£c_bôm≠_covîs_ty≥
(
	`ldns_n£c_gë_bôm≠
(
cur_n£c
),

1546 
	`ldns_º_gë_ty≥
(
º
))) {

1547 
wûdˇrd_ty≥_covîed
 = 
åue
;

1551 i‡(
	`ldns_n£c_covîs_«me
(
cur_n£c
, 
wûdˇrd_«me
)) {

1552 
wûdˇrd_covîed
 = 
åue
;

1557 
	`ldns_rdf_dìp_‰ì
(
wûdˇrd_«me
);

1559 i‡(
ty≥_covîed
 || !
«me_covîed
) {

1560  
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
;

1563 i‡(
wûdˇrd_ty≥_covîed
 || !
wûdˇrd_covîed
) {

1564  
LDNS_STATUS_DNSSEC_NSEC_WILDCARD_NOT_COVERED
;

1567  
LDNS_STATUS_OK
;

1568 
	}
}

1570 
ldns_°©us


1571 
ldns_dns£c_vîify_díül_n£c3_m©ch
–
ldns_º
 *
º


1572 , 
ldns_º_li°
 *
n£cs


1573 , 
ATTR_UNUSED
(
ldns_º_li°
 *
ºsigs
)

1574 , 
ldns_pkt_rcode
 
∑ckë_rcode


1575 , 
ldns_º_ty≥
 
∑ckë_qty≥


1576 , 
boﬁ
 
∑ckë_nod©a


1577 , 
ldns_º
 **
m©ch


1580 
ldns_rdf
 *
	g˛o£°_í˛o£r
;

1581 
ldns_rdf
 *
	gwûdˇrd
;

1582 
ldns_rdf
 *
	ghashed_wûdˇrd_«me
;

1583 
boﬁ
 
	gwûdˇrd_covîed
 = 
Ál£
;

1584 
ldns_rdf
 *
	gz⁄e_«me
;

1585 
ldns_rdf
 *
	ghashed_«me
;

1587 
ldns_rdf
 *
	g√xt_˛o£r
 = 
√xt_˛o£r
;

1588 
ldns_rdf
 *
	ghashed_√xt_˛o£r
;

1589 
size_t
 
	gi
;

1590 
ldns_°©us
 
	gªsu…
 = 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
;

1592 i‡(
	gm©ch
) {

1593 *
	gm©ch
 = 
NULL
;

1596 
	gz⁄e_«me
 = 
ldns_d«me_À·_ch›
(
ldns_º_ow√r
(
ldns_º_li°_º
(
n£cs
,0)));

1599 i‡(
	g∑ckë_rcode
 =
LDNS_RCODE_NXDOMAIN
) {

1600 
˛o£°_í˛o£r
 = 
ldns_dns£c_n£c3_˛o£°_í˛o£r
(

1601 
ldns_º_ow√r
(
º
),

1602 
ldns_º_gë_ty≥
(
º
),

1603 
n£cs
);

1604 if(!
	g˛o£°_í˛o£r
) {

1605 
	gªsu…
 = 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
;

1606 
	gd⁄e
;

1609 
	gwûdˇrd
 = 
ldns_d«me_√w_‰m_°r
("*");

1610 (Ë
ldns_d«me_ˇt
(
wûdˇrd
, 
˛o£°_í˛o£r
);

1612 
	gi
 = 0; i < 
ldns_º_li°_º_cou¡
(
n£cs
); i++) {

1613 
	ghashed_wûdˇrd_«me
 =

1614 
ldns_n£c3_hash_«me_‰m_n£c3
(
ldns_º_li°_º
(
n£cs
, 0),

1615 
wûdˇrd


1617 (Ë
ldns_d«me_ˇt
(
hashed_wûdˇrd_«me
, 
z⁄e_«me
);

1619 i‡(
ldns_n£c_covîs_«me
(
ldns_º_li°_º
(
n£cs
, 
i
),

1620 
hashed_wûdˇrd_«me
)) {

1621 
	gwûdˇrd_covîed
 = 
åue
;

1622 i‡(
	gm©ch
) {

1623 *
	gm©ch
 = 
ldns_º_li°_º
(
n£cs
, 
i
);

1626 
ldns_rdf_dìp_‰ì
(
hashed_wûdˇrd_«me
);

1629 i‡(! 
	gwûdˇrd_covîed
) {

1630 
	gªsu…
 = 
LDNS_STATUS_DNSSEC_NSEC_WILDCARD_NOT_COVERED
;

1632 
	gªsu…
 = 
LDNS_STATUS_OK
;

1634 
ldns_rdf_dìp_‰ì
(
˛o£°_í˛o£r
);

1635 
ldns_rdf_dìp_‰ì
(
wûdˇrd
);

1637 } i‡(
	g∑ckë_nod©a
 && 
	g∑ckë_qty≥
 !
LDNS_RR_TYPE_DS
) {

1639 
hashed_«me
 = 
ldns_n£c3_hash_«me_‰m_n£c3
(

1640 
ldns_º_li°_º
(
n£cs
, 0),

1641 
ldns_º_ow√r
(
º
));

1642 (Ë
ldns_d«me_ˇt
(
hashed_«me
, 
z⁄e_«me
);

1643 
	gi
 = 0; i < 
ldns_º_li°_º_cou¡
(
n£cs
); i++) {

1644 i‡(
ldns_d«me_com∑ª
(
hashed_«me
,

1645 
ldns_º_ow√r
(
ldns_º_li°_º
(
n£cs
, 
i
)))

1647 i‡(!
ldns_n£c_bôm≠_covîs_ty≥
(

1648 
ldns_n£c3_bôm≠
(
ldns_º_li°_º
(
n£cs
, 
i
)),

1649 
∑ckë_qty≥
)

1651 !
ldns_n£c_bôm≠_covîs_ty≥
(

1652 
ldns_n£c3_bôm≠
(
ldns_º_li°_º
(
n£cs
, 
i
)),

1653 
LDNS_RR_TYPE_CNAME
)) {

1654 
ªsu…
 = 
LDNS_STATUS_OK
;

1655 i‡(
	gm©ch
) {

1656 *
	gm©ch
 = 
ldns_º_li°_º
(
n£cs
, 
i
);

1658 
	gd⁄e
;

1662 
	gªsu…
 = 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
;

1664 
	g˛o£°_í˛o£r
 = 
ldns_dns£c_n£c3_˛o£°_í˛o£r
(

1665 
ldns_º_ow√r
(
º
),

1666 
ldns_º_gë_ty≥
(
º
),

1667 
n£cs
);

1668 if(!
	g˛o£°_í˛o£r
) {

1669 
	gªsu…
 = 
LDNS_STATUS_NSEC3_ERR
;

1670 
	gd⁄e
;

1672 
	gwûdˇrd
 = 
ldns_d«me_√w_‰m_°r
("*");

1673 (Ë
ldns_d«me_ˇt
(
wûdˇrd
, 
˛o£°_í˛o£r
);

1674 
	gi
 = 0; i < 
ldns_º_li°_º_cou¡
(
n£cs
); i++) {

1675 
	ghashed_wûdˇrd_«me
 =

1676 
ldns_n£c3_hash_«me_‰m_n£c3
(
ldns_º_li°_º
(
n£cs
, 0),

1677 
wûdˇrd
);

1678 (Ë
ldns_d«me_ˇt
(
hashed_wûdˇrd_«me
, 
z⁄e_«me
);

1680 i‡(
ldns_d«me_com∑ª
(
hashed_wûdˇrd_«me
,

1681 
ldns_º_ow√r
(
ldns_º_li°_º
(
n£cs
, 
i
)))

1683 i‡(!
ldns_n£c_bôm≠_covîs_ty≥
(

1684 
ldns_n£c3_bôm≠
(
ldns_º_li°_º
(
n£cs
, 
i
)),

1685 
∑ckë_qty≥
)

1687 !
ldns_n£c_bôm≠_covîs_ty≥
(

1688 
ldns_n£c3_bôm≠
(
ldns_º_li°_º
(
n£cs
, 
i
)),

1689 
LDNS_RR_TYPE_CNAME
)) {

1690 
ªsu…
 = 
LDNS_STATUS_OK
;

1691 i‡(
	gm©ch
) {

1692 *
	gm©ch
 = 
ldns_º_li°_º
(
n£cs
, 
i
);

1696 
ldns_rdf_dìp_‰ì
(
hashed_wûdˇrd_«me
);

1697 i‡(
	gªsu…
 =
LDNS_STATUS_OK
) {

1701 
ldns_rdf_dìp_‰ì
(
˛o£°_í˛o£r
);

1702 
ldns_rdf_dìp_‰ì
(
wûdˇrd
);

1703 } i‡(
	g∑ckë_nod©a
 && 
	g∑ckë_qty≥
 =
LDNS_RR_TYPE_DS
) {

1706 
hashed_«me
 = 
ldns_n£c3_hash_«me_‰m_n£c3
(
ldns_º_li°_º
(
n£cs
,

1708 
ldns_º_ow√r
(
º
)

1710 (Ë
ldns_d«me_ˇt
(
hashed_«me
, 
z⁄e_«me
);

1711 
	gi
 = 0; i < 
ldns_º_li°_º_cou¡
(
n£cs
); i++) {

1712 i‡(
ldns_d«me_com∑ª
(
hashed_«me
,

1713 
ldns_º_ow√r
(
ldns_º_li°_º
(
n£cs
,

1714 
i
)))

1716 i‡(!
ldns_n£c_bôm≠_covîs_ty≥
(

1717 
ldns_n£c3_bôm≠
(
ldns_º_li°_º
(
n£cs
, 
i
)),

1718 
LDNS_RR_TYPE_DS
)

1720 !
ldns_n£c_bôm≠_covîs_ty≥
(

1721 
ldns_n£c3_bôm≠
(
ldns_º_li°_º
(
n£cs
, 
i
)),

1722 
LDNS_RR_TYPE_CNAME
)) {

1723 
ªsu…
 = 
LDNS_STATUS_OK
;

1724 i‡(
	gm©ch
) {

1725 *
	gm©ch
 = 
ldns_º_li°_º
(
n£cs
, 
i
);

1727 
	gd⁄e
;

1733 
	gªsu…
 = 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
;

1735 
	g˛o£°_í˛o£r
 = 
ldns_dns£c_n£c3_˛o£°_í˛o£r
(

1736 
ldns_º_ow√r
(
º
),

1737 
ldns_º_gë_ty≥
(
º
),

1738 
n£cs
);

1739 if(!
	g˛o£°_í˛o£r
) {

1740 
	gªsu…
 = 
LDNS_STATUS_NSEC3_ERR
;

1741 
	gd⁄e
;

1745 i‡(
ldns_d«me_œbñ_cou¡
(
˛o£°_í˛o£r
) + 1

1746 >
ldns_d«me_œbñ_cou¡
(
ldns_º_ow√r
(
º
))) {

1749 
hashed_√xt_˛o£r
 = 
hashed_«me
;

1755 
	g√xt_˛o£r
 = 
ldns_d«me_˛⁄e_‰om
(

1756 
ldns_º_ow√r
(
º
),

1757 
ldns_d«me_œbñ_cou¡
(
ldns_º_ow√r
(
º
))

1758 - (
ldns_d«me_œbñ_cou¡
(
˛o£°_í˛o£r
) + 1)

1760 
	ghashed_√xt_˛o£r
 = 
ldns_n£c3_hash_«me_‰m_n£c3
(

1761 
ldns_º_li°_º
(
n£cs
, 0),

1762 
√xt_˛o£r


1764 (Ë
ldns_d«me_ˇt
(
hashed_√xt_˛o£r
, 
z⁄e_«me
);

1767 
	gi
 = 0; i < 
ldns_º_li°_º_cou¡
(
n£cs
); i++) {

1768 i‡(
ldns_n£c_covîs_«me
(
ldns_º_li°_º
(
n£cs
, 
i
),

1769 
hashed_√xt_˛o£r
) &&

1770 
ldns_n£c3_›tout
(
ldns_º_li°_º
(
n£cs
, 
i
))) {

1772 
	gªsu…
 = 
LDNS_STATUS_OK
;

1773 i‡(
	gm©ch
) {

1774 *
	gm©ch
 = 
ldns_º_li°_º
(
n£cs
, 
i
);

1779 i‡(
ldns_d«me_œbñ_cou¡
(
˛o£°_í˛o£r
) + 1

1780 < 
ldns_d«me_œbñ_cou¡
(
ldns_º_ow√r
(
º
))) {

1785 
ldns_rdf_dìp_‰ì
(
hashed_√xt_˛o£r
);

1786 
ldns_rdf_dìp_‰ì
(
√xt_˛o£r
);

1788 
ldns_rdf_dìp_‰ì
(
˛o£°_í˛o£r
);

1791 
	gd⁄e
:

1792 
ldns_rdf_dìp_‰ì
(
z⁄e_«me
);

1793  
	gªsu…
;

1796 
ldns_°©us


1797 
	$ldns_dns£c_vîify_díül_n£c3
(
ldns_º
 *
º
,

1798 
ldns_º_li°
 *
n£cs
,

1799 
ldns_º_li°
 *
ºsigs
,

1800 
ldns_pkt_rcode
 
∑ckë_rcode
,

1801 
ldns_º_ty≥
 
∑ckë_qty≥
,

1802 
boﬁ
 
∑ckë_nod©a
)

1804  
	`ldns_dns£c_vîify_díül_n£c3_m©ch
(

1805 
º
, 
n£cs
, 
ºsigs
, 
∑ckë_rcode
,

1806 
∑ckë_qty≥
, 
∑ckë_nod©a
, 
NULL


1808 
	}
}

1810 #ifde‡
USE_GOST


1811 
EVP_PKEY
*

1812 
	$ldns_go°2pkey_øw
(* 
key
, 
size_t
 
keyÀn
)

1815 
uöt8_t
 
a¢
[37] = { 0x30, 0x63, 0x30, 0x1c, 0x06, 0x06, 0x2a, 0x85,

1819 
ícoded
[37+64];

1820 c⁄° * 
µ
;

1821 if(
keyÀn
 != 64) {

1823  
NULL
;

1827 
	`memmove
(
ícoded
, 
a¢
, 37);

1828 
	`memmove
(
ícoded
+37, 
key
, 64);

1829 
µ
 = (*)&
ícoded
[0];

1831  
	`d2i_PUBKEY
(
NULL
, &
µ
, ()(
ícoded
));

1832 
	}
}

1834 
ldns_°©us


1835 
	$ldns_vîify_ºsig_go°_øw
(* 
sig
, 
size_t
 
sigÀn
,

1836 
ldns_buf„r
* 
º£t
, * 
key
, 
size_t
 
keyÀn
)

1838 
EVP_PKEY
 *
evp_key
;

1839 
ldns_°©us
 
ªsu…
;

1841 (Ë
	`ldns_key_EVP_lﬂd_go°_id
();

1842 
evp_key
 = 
	`ldns_go°2pkey_øw
(
key
, 
keyÀn
);

1843 if(!
evp_key
) {

1845  
LDNS_STATUS_CRYPTO_BOGUS
;

1849 
ªsu…
 = 
	`ldns_vîify_ºsig_evp_øw
(
sig
, 
sigÀn
, 
º£t
,

1850 
evp_key
, 
	`EVP_gë_dige°by«me
("md_gost94"));

1851 
	`EVP_PKEY_‰ì
(
evp_key
);

1853  
ªsu…
;

1854 
	}
}

1857 #ifde‡
USE_ECDSA


1858 
EVP_PKEY
*

1859 
	$ldns_ecdß2pkey_øw
(* 
key
, 
size_t
 
keyÀn
, 
uöt8_t
 
Ægo
)

1861 
buf
[256+2];

1862 c⁄° * 
µ
 = 
buf
;

1863 
EVP_PKEY
 *
evp_key
;

1864 
EC_KEY
 *
ec
;

1866 if(
Ægo
 =
LDNS_ECDSAP256SHA256
) {

1867 if(
keyÀn
 !2*256/8Ë 
NULL
;

1868 
ec
 = 
	`EC_KEY_√w_by_curve_«me
(
NID_X9_62_¥ime256v1
);

1869 } if(
Ægo
 =
LDNS_ECDSAP384SHA384
) {

1870 if(
keyÀn
 !2*384/8Ë 
NULL
;

1871 
ec
 = 
	`EC_KEY_√w_by_curve_«me
(
NID_£˝384r1
);

1872 } 
ec
 = 
NULL
;

1873 if(!
ec
Ë 
NULL
;

1874 if(
keyÀn
+1 > (
buf
))

1875  
NULL
;

1878 
buf
[0] = 
POINT_CONVERSION_UNCOMPRESSED
;

1879 
	`memmove
(
buf
+1, 
key
, 
keyÀn
);

1880 if(!
	`o2i_ECPublicKey
(&
ec
, &
µ
, ()
keyÀn
+1)) {

1881 
	`EC_KEY_‰ì
(
ec
);

1882  
NULL
;

1884 
evp_key
 = 
	`EVP_PKEY_√w
();

1885 if(!
evp_key
) {

1886 
	`EC_KEY_‰ì
(
ec
);

1887  
NULL
;

1889 i‡(!
	`EVP_PKEY_assign_EC_KEY
(
evp_key
, 
ec
)) {

1890 
	`EVP_PKEY_‰ì
(
evp_key
);

1891 
	`EC_KEY_‰ì
(
ec
);

1892  
NULL
;

1894  
evp_key
;

1895 
	}
}

1897 
ldns_°©us


1898 
	$ldns_vîify_ºsig_ecdß_øw
(* 
sig
, 
size_t
 
sigÀn
,

1899 
ldns_buf„r
* 
º£t
, * 
key
, 
size_t
 
keyÀn
, 
uöt8_t
 
Ægo
)

1901 
EVP_PKEY
 *
evp_key
;

1902 
ldns_°©us
 
ªsu…
;

1903 c⁄° 
EVP_MD
 *
d
;

1905 
evp_key
 = 
	`ldns_ecdß2pkey_øw
(
key
, 
keyÀn
, 
Ægo
);

1906 if(!
evp_key
) {

1908  
LDNS_STATUS_CRYPTO_BOGUS
;

1910 if(
Ægo
 =
LDNS_ECDSAP256SHA256
)

1911 
d
 = 
	`EVP_sha256
();

1912 
d
 = 
	`EVP_sha384
();

1913 
ªsu…
 = 
	`ldns_vîify_ºsig_evp_øw
(
sig
, 
sigÀn
, 
º£t
, 
evp_key
, 
d
);

1914 
	`EVP_PKEY_‰ì
(
evp_key
);

1915  
ªsu…
;

1916 
	}
}

1919 
ldns_°©us


1920 
	$ldns_vîify_ºsig_buf„rs
(
ldns_buf„r
 *
øwsig_buf
,Üdns_buf„∏*
vîify_buf
,

1921 
ldns_buf„r
 *
key_buf
, 
uöt8_t
 
Ægo
)

1923  
	`ldns_vîify_ºsig_buf„rs_øw
(

1924 (*)
	`ldns_buf„r_begö
(
øwsig_buf
),

1925 
	`ldns_buf„r_posôi⁄
(
øwsig_buf
),

1926 
vîify_buf
,

1927 (*)
	`ldns_buf„r_begö
(
key_buf
),

1928 
	`ldns_buf„r_posôi⁄
(
key_buf
), 
Ægo
);

1929 
	}
}

1931 
ldns_°©us


1932 
	$ldns_vîify_ºsig_buf„rs_øw
(* 
sig
, 
size_t
 
sigÀn
,

1933 
ldns_buf„r
 *
vîify_buf
, * 
key
, 
size_t
 
keyÀn
,

1934 
uöt8_t
 
Ægo
)

1937 
Ægo
) {

1938 
LDNS_DSA
:

1939 
LDNS_DSA_NSEC3
:

1940  
	`ldns_vîify_ºsig_dß_øw
(
sig
,

1941 
sigÀn
,

1942 
vîify_buf
,

1943 
key
,

1944 
keyÀn
);

1946 
LDNS_RSASHA1
:

1947 
LDNS_RSASHA1_NSEC3
:

1948  
	`ldns_vîify_ºsig_rßsha1_øw
(
sig
,

1949 
sigÀn
,

1950 
vîify_buf
,

1951 
key
,

1952 
keyÀn
);

1954 #ifde‡
USE_SHA2


1955 
LDNS_RSASHA256
:

1956  
	`ldns_vîify_ºsig_rßsha256_øw
(
sig
,

1957 
sigÀn
,

1958 
vîify_buf
,

1959 
key
,

1960 
keyÀn
);

1962 
LDNS_RSASHA512
:

1963  
	`ldns_vîify_ºsig_rßsha512_øw
(
sig
,

1964 
sigÀn
,

1965 
vîify_buf
,

1966 
key
,

1967 
keyÀn
);

1970 #ifde‡
USE_GOST


1971 
LDNS_ECC_GOST
:

1972  
	`ldns_vîify_ºsig_go°_øw
(
sig
, 
sigÀn
, 
vîify_buf
,

1973 
key
, 
keyÀn
);

1976 #ifde‡
USE_ECDSA


1977 
LDNS_ECDSAP256SHA256
:

1978 
LDNS_ECDSAP384SHA384
:

1979  
	`ldns_vîify_ºsig_ecdß_øw
(
sig
, 
sigÀn
, 
vîify_buf
,

1980 
key
, 
keyÀn
, 
Ægo
);

1983 
LDNS_RSAMD5
:

1984  
	`ldns_vîify_ºsig_rßmd5_øw
(
sig
,

1985 
sigÀn
,

1986 
vîify_buf
,

1987 
key
,

1988 
keyÀn
);

1992  
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
;

1994 
	}
}

2005 
	$ldns_º£t_u£_sig«tuª_âl
(
ldns_º_li°
* 
º£t_˛⁄e
, 
ldns_º
* 
ºsig
)

2007 
uöt32_t
 
‹ig_âl
;

2008 
uöt16_t
 
i
;

2009 
uöt8_t
 
œbñ_cou¡
;

2010 
ldns_rdf
 *
wûdˇrd_«me
;

2011 
ldns_rdf
 *
wûdˇrd_ch›≥d
;

2012 
ldns_rdf
 *
wûdˇrd_ch›≥d_tmp
;

2014 i‡((
ºsig
 =
NULL
Ë|| 
	`ldns_º_rd_cou¡
(rrsig) < 4) {

2018 
‹ig_âl
 = 
	`ldns_rdf2«tive_öt32
–
	`ldns_º_rdf
(
ºsig
, 3));

2019 
œbñ_cou¡
 = 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
ºsig
, 2));

2021 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º£t_˛⁄e
); i++) {

2022 i‡(
œbñ_cou¡
 <

2023 
	`ldns_d«me_œbñ_cou¡
(

2024 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
º£t_˛⁄e
, 
i
)))) {

2025 (Ë
	`ldns_°r2rdf_d«me
(&
wûdˇrd_«me
, "*");

2026 
wûdˇrd_ch›≥d
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_ow√r
(

2027 
	`ldns_º_li°_º
(
º£t_˛⁄e
, 
i
)));

2028 
œbñ_cou¡
 < 
	`ldns_d«me_œbñ_cou¡
(
wûdˇrd_ch›≥d
)) {

2029 
wûdˇrd_ch›≥d_tmp
 = 
	`ldns_d«me_À·_ch›
(

2030 
wûdˇrd_ch›≥d
);

2031 
	`ldns_rdf_dìp_‰ì
(
wûdˇrd_ch›≥d
);

2032 
wûdˇrd_ch›≥d
 = 
wûdˇrd_ch›≥d_tmp
;

2034 (Ë
	`ldns_d«me_ˇt
(
wûdˇrd_«me
, 
wûdˇrd_ch›≥d
);

2035 
	`ldns_rdf_dìp_‰ì
(
wûdˇrd_ch›≥d
);

2036 
	`ldns_rdf_dìp_‰ì
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(

2037 
º£t_˛⁄e
, 
i
)));

2038 
	`ldns_º_£t_ow√r
(
	`ldns_º_li°_º
(
º£t_˛⁄e
, 
i
),

2039 
wûdˇrd_«me
);

2041 
	`ldns_º_£t_âl
(
	`ldns_º_li°_º
(
º£t_˛⁄e
, 
i
), 
‹ig_âl
);

2043 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_º_li°_º
(
º£t_˛⁄e
, 
i
));

2045 
	}
}

2053 
ldns_°©us


2054 
	$ldns_ºsig2øwsig_buf„r
(
ldns_buf„r
* 
øwsig_buf
, 
ldns_º
* 
ºsig
)

2056 
uöt8_t
 
sig_Ægo
;

2058 i‡(
ºsig
 =
NULL
) {

2059  
LDNS_STATUS_CRYPTO_NO_RRSIG
;

2061 i‡(
	`ldns_º_rdf
(
ºsig
, 1Ë=
NULL
) {

2062  
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
;

2064 
sig_Ægo
 = 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
ºsig
, 1));

2072 
sig_Ægo
) {

2073 
LDNS_RSAMD5
:

2074 
LDNS_RSASHA1
:

2075 
LDNS_RSASHA1_NSEC3
:

2076 #ifde‡
USE_SHA2


2077 
LDNS_RSASHA256
:

2078 
LDNS_RSASHA512
:

2080 #ifde‡
USE_GOST


2081 
LDNS_ECC_GOST
:

2083 i‡(
	`ldns_º_rdf
(
ºsig
, 8Ë=
NULL
) {

2084  
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
;

2086 i‡(
	`ldns_rdf2buf„r_wúe
(
øwsig_buf
, 
	`ldns_º_rdf
(
ºsig
, 8))

2087 !
LDNS_STATUS_OK
) {

2088  
LDNS_STATUS_MEM_ERR
;

2091 
LDNS_DSA
:

2092 
LDNS_DSA_NSEC3
:

2094 i‡(
	`ldns_º_rdf
(
ºsig
, 8Ë=
NULL
) {

2095  
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
;

2097 i‡(
	`ldns_c⁄vît_dß_ºsig_rdf2a¢1
(

2098 
øwsig_buf
, 
	`ldns_º_rdf
(
ºsig
, 8))

2099 !
LDNS_STATUS_OK
) {

2104  
LDNS_STATUS_MEM_ERR
;

2107 #ifde‡
USE_ECDSA


2108 
LDNS_ECDSAP256SHA256
:

2109 
LDNS_ECDSAP384SHA384
:

2112 i‡(
	`ldns_º_rdf
(
ºsig
, 8Ë=
NULL
) {

2113  
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
;

2115 i‡(
	`ldns_c⁄vît_ecdß_ºsig_rdf2a¢1
(

2116 
øwsig_buf
, 
	`ldns_º_rdf
(
ºsig
, 8))

2117 !
LDNS_STATUS_OK
) {

2118  
LDNS_STATUS_MEM_ERR
;

2122 
LDNS_DH
:

2123 
LDNS_ECC
:

2124 
LDNS_INDIRECT
:

2125  
LDNS_STATUS_CRYPTO_ALGO_NOT_IMPL
;

2127  
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
;

2129  
LDNS_STATUS_OK
;

2130 
	}
}

2138 
ldns_°©us


2139 
	$ldns_ºsig_check_time°amps
(
ldns_º
* 
ºsig
, 
time_t
 
now
)

2141 
öt32_t
 
ö˚±i⁄
, 
expú©i⁄
;

2144 
ö˚±i⁄
 = (
öt32_t
)
	`ldns_rdf2«tive_time_t
(

2145 
	`ldns_º_ºsig_ö˚±i⁄
(
ºsig
));

2146 
expú©i⁄
 = (
öt32_t
)
	`ldns_rdf2«tive_time_t
(

2147 
	`ldns_º_ºsig_expú©i⁄
(
ºsig
));

2149 i‡(
expú©i⁄
 - 
ö˚±i⁄
 < 0) {

2151  
LDNS_STATUS_CRYPTO_EXPIRATION_BEFORE_INCEPTION
;

2153 i‡(((
öt32_t
Ë
now
Ë- 
ö˚±i⁄
 < 0) {

2155  
LDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED
;

2157 i‡(
expú©i⁄
 - ((
öt32_t
Ë
now
) < 0) {

2159  
LDNS_STATUS_CRYPTO_SIG_EXPIRED
;

2161  
LDNS_STATUS_OK
;

2162 
	}
}

2172 
ldns_°©us


2173 
	$ldns_¥ï¨e_f‹_vîify
(
ldns_buf„r
* 
øwsig_buf
,Üdns_buf„r* 
vîify_buf
,

2174 
ldns_º_li°
* 
º£t_˛⁄e
, 
ldns_º
* 
ºsig
)

2176 
ldns_°©us
 
ªsu…
;

2179 
	`ldns_d«me2ˇn⁄iˇl
(
	`ldns_º_ow√r
(
ºsig
));

2182 i‡(
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(
ºsig
)) !=

2183 
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
º£t_˛⁄e
, 0)))

2184  
LDNS_STATUS_CRYPTO_TYPE_COVERED_ERR
;

2187 
ªsu…
 = 
	`ldns_ºsig2øwsig_buf„r
(
øwsig_buf
, 
ºsig
);

2188 if(
ªsu…
 !
LDNS_STATUS_OK
)

2189  
ªsu…
;

2193 
	`ldns_º£t_u£_sig«tuª_âl
(
º£t_˛⁄e
, 
ºsig
);

2196 
	`ldns_º_li°_s‹t
(
º£t_˛⁄e
);

2199 i‡(
	`ldns_ºsig2buf„r_wúe
(
vîify_buf
, 
ºsig
Ë!
LDNS_STATUS_OK
)

2200  
LDNS_STATUS_MEM_ERR
;

2203 if(
	`ldns_º_li°2buf„r_wúe
(
vîify_buf
, 
º£t_˛⁄e
)

2204 !
LDNS_STATUS_OK
)

2205  
LDNS_STATUS_MEM_ERR
;

2207  
LDNS_STATUS_OK
;

2208 
	}
}

2219 
ldns_°©us


2220 
	$ldns_vîify_ã°_sig_key
(
ldns_buf„r
* 
øwsig_buf
,Üdns_buf„r* 
vîify_buf
,

2221 
ldns_º
* 
ºsig
,Üdns_º* 
key
)

2223 
uöt8_t
 
sig_Ægo
;

2225 i‡(
ºsig
 =
NULL
) {

2226  
LDNS_STATUS_CRYPTO_NO_RRSIG
;

2228 i‡(
	`ldns_º_rdf
(
ºsig
, 1Ë=
NULL
) {

2229  
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
;

2231 
sig_Ægo
 = 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
ºsig
, 1));

2234 i‡(
	`ldns_ˇlc_keyèg
(
key
)

2236 
	`ldns_rdf2«tive_öt16
(
	`ldns_º_ºsig_keyèg
(
ºsig
))

2238 
ldns_buf„r
* 
key_buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2239 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_ERR
;

2243 i‡(
	`ldns_º_rdf
(
key
, 3Ë=
NULL
) {

2244 
	`ldns_buf„r_‰ì
(
key_buf
);

2245  
LDNS_STATUS_MISSING_RDATA_FIELDS_KEY
;

2247 i‡(
	`ldns_rdf2buf„r_wúe
(
key_buf
, 
	`ldns_º_rdf
(
key
, 3))

2248 !
LDNS_STATUS_OK
) {

2249 
	`ldns_buf„r_‰ì
(
key_buf
);

2253  
LDNS_STATUS_ERR
;

2256 i‡(
	`ldns_º_rdf
(
key
, 2Ë=
NULL
) {

2257 
ªsu…
 = 
LDNS_STATUS_MISSING_RDATA_FIELDS_KEY
;

2259 i‡(
sig_Ægo
 =
	`ldns_rdf2«tive_öt8
(

2260 
	`ldns_º_rdf
(
key
, 2))) {

2261 
ªsu…
 = 
	`ldns_vîify_ºsig_buf„rs
(
øwsig_buf
,

2262 
vîify_buf
, 
key_buf
, 
sig_Ægo
);

2265 
ªsu…
 = 
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
;

2268 
	`ldns_buf„r_‰ì
(
key_buf
);

2269  
ªsu…
;

2273  
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
;

2275 
	}
}

2286 
ldns_°©us


2287 
	$ldns_vîify_ºsig_keyli°_time
(

2288 
ldns_º_li°
 *
º£t
,

2289 
ldns_º
 *
ºsig
,

2290 c⁄° 
ldns_º_li°
 *
keys
,

2291 
time_t
 
check_time
,

2292 
ldns_º_li°
 *
good_keys
)

2294 
ldns_°©us
 
ªsu…
;

2295 
ldns_º_li°
 *
vÆid
 = 
	`ldns_º_li°_√w
();

2296 i‡(!
vÆid
)

2297  
LDNS_STATUS_MEM_ERR
;

2299 
ªsu…
 = 
	`ldns_vîify_ºsig_keyli°_nŸime
(
º£t
, 
ºsig
, 
keys
, 
vÆid
);

2300 if(
ªsu…
 !
LDNS_STATUS_OK
) {

2301 
	`ldns_º_li°_‰ì
(
vÆid
);

2302  
ªsu…
;

2306 
ªsu…
 = 
	`ldns_ºsig_check_time°amps
(
ºsig
, 
check_time
);

2307 if(
ªsu…
 !
LDNS_STATUS_OK
) {

2308 
	`ldns_º_li°_‰ì
(
vÆid
);

2309  
ªsu…
;

2312 
	`ldns_º_li°_ˇt
(
good_keys
, 
vÆid
);

2313 
	`ldns_º_li°_‰ì
(
vÆid
);

2314  
LDNS_STATUS_OK
;

2315 
	}
}

2326 
ldns_°©us


2327 
	$ldns_vîify_ºsig_keyli°
(
ldns_º_li°
 *
º£t
,

2328 
ldns_º
 *
ºsig
,

2329 c⁄° 
ldns_º_li°
 *
keys
,

2330 
ldns_º_li°
 *
good_keys
)

2332  
	`ldns_vîify_ºsig_keyli°_time
(

2333 
º£t
, 
ºsig
, 
keys
, 
	`ldns_time
(
NULL
), 
good_keys
);

2334 
	}
}

2336 
ldns_°©us


2337 
	$ldns_vîify_ºsig_keyli°_nŸime
(
ldns_º_li°
 *
º£t
,

2338 
ldns_º
 *
ºsig
,

2339 c⁄° 
ldns_º_li°
 *
keys
,

2340 
ldns_º_li°
 *
good_keys
)

2342 
ldns_buf„r
 *
øwsig_buf
;

2343 
ldns_buf„r
 *
vîify_buf
;

2344 
uöt16_t
 
i
;

2345 
ldns_°©us
 
ªsu…
, 
°©us
;

2346 
ldns_º_li°
 *
º£t_˛⁄e
;

2347 
ldns_º_li°
 *
vÆidkeys
;

2349 i‡(!
º£t
) {

2350  
LDNS_STATUS_ERR
;

2353 
vÆidkeys
 = 
	`ldns_º_li°_√w
();

2354 i‡(!
vÆidkeys
) {

2355  
LDNS_STATUS_MEM_ERR
;

2359 
º£t_˛⁄e
 = 
	`ldns_º_li°_˛⁄e
(
º£t
);

2362 
øwsig_buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2363 
vîify_buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2365 
ªsu…
 = 
	`ldns_¥ï¨e_f‹_vîify
(
øwsig_buf
, 
vîify_buf
,

2366 
º£t_˛⁄e
, 
ºsig
);

2367 if(
ªsu…
 !
LDNS_STATUS_OK
) {

2368 
	`ldns_buf„r_‰ì
(
vîify_buf
);

2369 
	`ldns_buf„r_‰ì
(
øwsig_buf
);

2370 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

2371 
	`ldns_º_li°_‰ì
(
vÆidkeys
);

2372  
ªsu…
;

2375 
ªsu…
 = 
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
;

2376 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
keys
); i++) {

2377 
°©us
 = 
	`ldns_vîify_ã°_sig_key
(
øwsig_buf
, 
vîify_buf
,

2378 
ºsig
, 
	`ldns_º_li°_º
(
keys
, 
i
));

2379 i‡(
°©us
 =
LDNS_STATUS_OK
) {

2384 i‡(!
	`ldns_º_li°_push_º
(
vÆidkeys
,

2385 
	`ldns_º_li°_º
(
keys
,
i
))) {

2387 
	`ldns_buf„r_‰ì
(
øwsig_buf
);

2388 
	`ldns_buf„r_‰ì
(
vîify_buf
);

2389 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

2390 
	`ldns_º_li°_‰ì
(
vÆidkeys
);

2391  
LDNS_STATUS_MEM_ERR
;

2394 
ªsu…
 = 
°©us
;

2397 i‡(
ªsu…
 =
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
) {

2398 
ªsu…
 = 
°©us
;

2403 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

2404 
	`ldns_buf„r_‰ì
(
øwsig_buf
);

2405 
	`ldns_buf„r_‰ì
(
vîify_buf
);

2407 i‡(
	`ldns_º_li°_º_cou¡
(
vÆidkeys
) == 0) {

2409 
	`ldns_º_li°_‰ì
(
vÆidkeys
);

2410  
ªsu…
;

2415 
	`ldns_º_li°_ˇt
(
good_keys
, 
vÆidkeys
);

2416 
	`ldns_º_li°_‰ì
(
vÆidkeys
);

2417  
LDNS_STATUS_OK
;

2418 
	}
}

2420 
ldns_°©us


2421 
	$ldns_vîify_ºsig_time
(

2422 
ldns_º_li°
 *
º£t
,

2423 
ldns_º
 *
ºsig
,

2424 
ldns_º
 *
key
,

2425 
time_t
 
check_time
)

2427 
ldns_buf„r
 *
øwsig_buf
;

2428 
ldns_buf„r
 *
vîify_buf
;

2429 
ldns_°©us
 
ªsu…
;

2430 
ldns_º_li°
 *
º£t_˛⁄e
;

2432 i‡(!
º£t
) {

2433  
LDNS_STATUS_NO_DATA
;

2436 
º£t_˛⁄e
 = 
	`ldns_º_li°_˛⁄e
(
º£t
);

2438 
øwsig_buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2439 
vîify_buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2441 
ªsu…
 = 
	`ldns_¥ï¨e_f‹_vîify
(
øwsig_buf
, 
vîify_buf
,

2442 
º£t_˛⁄e
, 
ºsig
);

2443 if(
ªsu…
 !
LDNS_STATUS_OK
) {

2444 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

2445 
	`ldns_buf„r_‰ì
(
øwsig_buf
);

2446 
	`ldns_buf„r_‰ì
(
vîify_buf
);

2447  
ªsu…
;

2449 
ªsu…
 = 
	`ldns_vîify_ã°_sig_key
(
øwsig_buf
, 
vîify_buf
,

2450 
ºsig
, 
key
);

2452 
	`ldns_º_li°_dìp_‰ì
(
º£t_˛⁄e
);

2453 
	`ldns_buf„r_‰ì
(
øwsig_buf
);

2454 
	`ldns_buf„r_‰ì
(
vîify_buf
);

2457 if(
ªsu…
 =
LDNS_STATUS_OK
)

2458 
ªsu…
 = 
	`ldns_ºsig_check_time°amps
(
ºsig
, 
check_time
);

2460  
ªsu…
;

2461 
	}
}

2463 
ldns_°©us


2464 
	$ldns_vîify_ºsig
(
ldns_º_li°
 *
º£t
, 
ldns_º
 *
ºsig
,Üdns_º *
key
)

2466  
	`ldns_vîify_ºsig_time
(
º£t
, 
ºsig
, 
key
, 
	`ldns_time
(
NULL
));

2467 
	}
}

2470 
ldns_°©us


2471 
	$ldns_vîify_ºsig_evp
(
ldns_buf„r
 *
sig
,

2472 
ldns_buf„r
 *
º£t
,

2473 
EVP_PKEY
 *
key
,

2474 c⁄° 
EVP_MD
 *
dige°_ty≥
)

2476  
	`ldns_vîify_ºsig_evp_øw
(

2477 (*)
	`ldns_buf„r_begö
(
sig
),

2478 
	`ldns_buf„r_posôi⁄
(
sig
),

2479 
º£t
,

2480 
key
,

2481 
dige°_ty≥
);

2482 
	}
}

2484 
ldns_°©us


2485 
	$ldns_vîify_ºsig_evp_øw
(*
sig
, 
size_t
 
sigÀn
,

2486 
ldns_buf„r
 *
º£t
, 
EVP_PKEY
 *
key
, c⁄° 
EVP_MD
 *
dige°_ty≥
)

2488 
EVP_MD_CTX
 
˘x
;

2489 
ªs
;

2491 
	`EVP_MD_CTX_öô
(&
˘x
);

2493 
	`EVP_VîifyInô
(&
˘x
, 
dige°_ty≥
);

2494 
	`EVP_VîifyUpd©e
(&
˘x
,

2495 
	`ldns_buf„r_begö
(
º£t
),

2496 
	`ldns_buf„r_posôi⁄
(
º£t
));

2497 
ªs
 = 
	`EVP_VîifyFöÆ
(&
˘x
, 
sig
, (Ë
sigÀn
, 
key
);

2499 
	`EVP_MD_CTX_˛ónup
(&
˘x
);

2501 i‡(
ªs
 == 1) {

2502  
LDNS_STATUS_OK
;

2503 } i‡(
ªs
 == 0) {

2504  
LDNS_STATUS_CRYPTO_BOGUS
;

2508  
LDNS_STATUS_SSL_ERR
;

2509 
	}
}

2511 
ldns_°©us


2512 
	$ldns_vîify_ºsig_dß
(
ldns_buf„r
 *
sig
,Üdns_buf„∏*
º£t
,Üdns_buf„∏*
key
)

2514  
	`ldns_vîify_ºsig_dß_øw
(

2515 (*Ë
	`ldns_buf„r_begö
(
sig
),

2516 
	`ldns_buf„r_posôi⁄
(
sig
),

2517 
º£t
,

2518 (*Ë
	`ldns_buf„r_begö
(
key
),

2519 
	`ldns_buf„r_posôi⁄
(
key
));

2520 
	}
}

2522 
ldns_°©us


2523 
	$ldns_vîify_ºsig_rßsha1
(
ldns_buf„r
 *
sig
,Üdns_buf„∏*
º£t
,Üdns_buf„∏*
key
)

2525  
	`ldns_vîify_ºsig_rßsha1_øw
(

2526 (*)
	`ldns_buf„r_begö
(
sig
),

2527 
	`ldns_buf„r_posôi⁄
(
sig
),

2528 
º£t
,

2529 (*Ë
	`ldns_buf„r_begö
(
key
),

2530 
	`ldns_buf„r_posôi⁄
(
key
));

2531 
	}
}

2533 
ldns_°©us


2534 
	$ldns_vîify_ºsig_rßmd5
(
ldns_buf„r
 *
sig
,Üdns_buf„∏*
º£t
,Üdns_buf„∏*
key
)

2536  
	`ldns_vîify_ºsig_rßmd5_øw
(

2537 (*)
	`ldns_buf„r_begö
(
sig
),

2538 
	`ldns_buf„r_posôi⁄
(
sig
),

2539 
º£t
,

2540 (*Ë
	`ldns_buf„r_begö
(
key
),

2541 
	`ldns_buf„r_posôi⁄
(
key
));

2542 
	}
}

2544 
ldns_°©us


2545 
	$ldns_vîify_ºsig_dß_øw
(* 
sig
, 
size_t
 
sigÀn
,

2546 
ldns_buf„r
* 
º£t
, * 
key
, 
size_t
 
keyÀn
)

2548 
EVP_PKEY
 *
evp_key
;

2549 
ldns_°©us
 
ªsu…
;

2551 
evp_key
 = 
	`EVP_PKEY_√w
();

2552 i‡(
	`EVP_PKEY_assign_DSA
(
evp_key
, 
	`ldns_key_buf2dß_øw
(
key
, 
keyÀn
))) {

2553 
ªsu…
 = 
	`ldns_vîify_ºsig_evp_øw
(
sig
,

2554 
sigÀn
,

2555 
º£t
,

2556 
evp_key
,

2557 
	`EVP_dss1
());

2559 
ªsu…
 = 
LDNS_STATUS_SSL_ERR
;

2561 
	`EVP_PKEY_‰ì
(
evp_key
);

2562  
ªsu…
;

2564 
	}
}

2566 
ldns_°©us


2567 
	$ldns_vîify_ºsig_rßsha1_øw
(* 
sig
, 
size_t
 
sigÀn
,

2568 
ldns_buf„r
* 
º£t
, * 
key
, 
size_t
 
keyÀn
)

2570 
EVP_PKEY
 *
evp_key
;

2571 
ldns_°©us
 
ªsu…
;

2573 
evp_key
 = 
	`EVP_PKEY_√w
();

2574 i‡(
	`EVP_PKEY_assign_RSA
(
evp_key
, 
	`ldns_key_buf2rß_øw
(
key
, 
keyÀn
))) {

2575 
ªsu…
 = 
	`ldns_vîify_ºsig_evp_øw
(
sig
,

2576 
sigÀn
,

2577 
º£t
,

2578 
evp_key
,

2579 
	`EVP_sha1
());

2581 
ªsu…
 = 
LDNS_STATUS_SSL_ERR
;

2583 
	`EVP_PKEY_‰ì
(
evp_key
);

2585  
ªsu…
;

2586 
	}
}

2588 
ldns_°©us


2589 
	$ldns_vîify_ºsig_rßsha256_øw
(* 
sig
,

2590 
size_t
 
sigÀn
,

2591 
ldns_buf„r
* 
º£t
,

2592 * 
key
,

2593 
size_t
 
keyÀn
)

2595 #ifde‡
USE_SHA2


2596 
EVP_PKEY
 *
evp_key
;

2597 
ldns_°©us
 
ªsu…
;

2599 
evp_key
 = 
	`EVP_PKEY_√w
();

2600 i‡(
	`EVP_PKEY_assign_RSA
(
evp_key
, 
	`ldns_key_buf2rß_øw
(
key
, 
keyÀn
))) {

2601 
ªsu…
 = 
	`ldns_vîify_ºsig_evp_øw
(
sig
,

2602 
sigÀn
,

2603 
º£t
,

2604 
evp_key
,

2605 
	`EVP_sha256
());

2607 
ªsu…
 = 
LDNS_STATUS_SSL_ERR
;

2609 
	`EVP_PKEY_‰ì
(
evp_key
);

2611  
ªsu…
;

2614 (Ë
sig
;

2615 (Ë
sigÀn
;

2616 (Ë
º£t
;

2617 (Ë
key
;

2618 (Ë
keyÀn
;

2619  
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
;

2621 
	}
}

2623 
ldns_°©us


2624 
	$ldns_vîify_ºsig_rßsha512_øw
(* 
sig
,

2625 
size_t
 
sigÀn
,

2626 
ldns_buf„r
* 
º£t
,

2627 * 
key
,

2628 
size_t
 
keyÀn
)

2630 #ifde‡
USE_SHA2


2631 
EVP_PKEY
 *
evp_key
;

2632 
ldns_°©us
 
ªsu…
;

2634 
evp_key
 = 
	`EVP_PKEY_√w
();

2635 i‡(
	`EVP_PKEY_assign_RSA
(
evp_key
, 
	`ldns_key_buf2rß_øw
(
key
, 
keyÀn
))) {

2636 
ªsu…
 = 
	`ldns_vîify_ºsig_evp_øw
(
sig
,

2637 
sigÀn
,

2638 
º£t
,

2639 
evp_key
,

2640 
	`EVP_sha512
());

2642 
ªsu…
 = 
LDNS_STATUS_SSL_ERR
;

2644 
	`EVP_PKEY_‰ì
(
evp_key
);

2646  
ªsu…
;

2649 (Ë
sig
;

2650 (Ë
sigÀn
;

2651 (Ë
º£t
;

2652 (Ë
key
;

2653 (Ë
keyÀn
;

2654  
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
;

2656 
	}
}

2659 
ldns_°©us


2660 
	$ldns_vîify_ºsig_rßmd5_øw
(* 
sig
,

2661 
size_t
 
sigÀn
,

2662 
ldns_buf„r
* 
º£t
,

2663 * 
key
,

2664 
size_t
 
keyÀn
)

2666 
EVP_PKEY
 *
evp_key
;

2667 
ldns_°©us
 
ªsu…
;

2669 
evp_key
 = 
	`EVP_PKEY_√w
();

2670 i‡(
	`EVP_PKEY_assign_RSA
(
evp_key
, 
	`ldns_key_buf2rß_øw
(
key
, 
keyÀn
))) {

2671 
ªsu…
 = 
	`ldns_vîify_ºsig_evp_øw
(
sig
,

2672 
sigÀn
,

2673 
º£t
,

2674 
evp_key
,

2675 
	`EVP_md5
());

2677 
ªsu…
 = 
LDNS_STATUS_SSL_ERR
;

2679 
	`EVP_PKEY_‰ì
(
evp_key
);

2681  
ªsu…
;

2682 
	}
}

	@dnssec_zone.c

5 
	~<ldns/c⁄fig.h
>

7 
	~<ldns/ldns.h
>

9 
ldns_dns£c_ºs
 *

10 
	$ldns_dns£c_ºs_√w
()

12 
ldns_dns£c_ºs
 *
√w_ºs
;

13 
√w_ºs
 = 
	`LDNS_MALLOC
(
ldns_dns£c_ºs
);

14 if(!
√w_ºs
Ë 
NULL
;

15 
√w_ºs
->
º
 = 
NULL
;

16 
√w_ºs
->
√xt
 = 
NULL
;

17  
√w_ºs
;

18 
	}
}

20 
INLINE
 

21 
	$ldns_dns£c_ºs_‰ì_öã∫Æ
(
ldns_dns£c_ºs
 *
ºs
, 
dìp
)

23 
ldns_dns£c_ºs
 *
√xt
;

24 
ºs
) {

25 
√xt
 = 
ºs
->next;

26 i‡(
dìp
) {

27 
	`ldns_º_‰ì
(
ºs
->
º
);

29 
	`LDNS_FREE
(
ºs
);

30 
ºs
 = 
√xt
;

32 
	}
}

35 
	$ldns_dns£c_ºs_‰ì
(
ldns_dns£c_ºs
 *
ºs
)

37 
	`ldns_dns£c_ºs_‰ì_öã∫Æ
(
ºs
, 0);

38 
	}
}

41 
	$ldns_dns£c_ºs_dìp_‰ì
(
ldns_dns£c_ºs
 *
ºs
)

43 
	`ldns_dns£c_ºs_‰ì_öã∫Æ
(
ºs
, 1);

44 
	}
}

46 
ldns_°©us


47 
	$ldns_dns£c_ºs_add_º
(
ldns_dns£c_ºs
 *
ºs
, 
ldns_º
 *
º
)

49 
cmp
;

50 
ldns_dns£c_ºs
 *
√w_ºs
;

51 i‡(!
ºs
 || !
º
) {

52  
LDNS_STATUS_ERR
;

57 
cmp
 = 
	`ldns_º_com∑ª
(
ºs
->
º
,Ñr);

58 i‡(
cmp
 < 0) {

59 i‡(
ºs
->
√xt
) {

60  
	`ldns_dns£c_ºs_add_º
(
ºs
->
√xt
, 
º
);

62 
√w_ºs
 = 
	`ldns_dns£c_ºs_√w
();

63 
√w_ºs
->
º
 =Ñr;

64 
ºs
->
√xt
 = 
√w_ºs
;

66 } i‡(
cmp
 > 0) {

69 
√w_ºs
 = 
	`ldns_dns£c_ºs_√w
();

70 
√w_ºs
->
º
 = 
ºs
->rr;

71 
√w_ºs
->
√xt
 = 
ºs
->next;

72 
ºs
->
º
 =Ñr;

73 
ºs
->
√xt
 = 
√w_ºs
;

76  
LDNS_STATUS_OK
;

77 
	}
}

80 
	$ldns_dns£c_ºs_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

81 
ldns_dns£c_ºs
 *
ºs
)

83 i‡(!
ºs
) {

84 i‡((
fmt
->
Êags
 & 
LDNS_COMMENT_LAYOUT
))

85 
	`Ârötf
(
out
, "; <void>");

87 i‡(
ºs
->
º
) {

88 
	`ldns_º_¥öt_fmt
(
out
, 
fmt
, 
ºs
->
º
);

90 i‡(
ºs
->
√xt
) {

91 
	`ldns_dns£c_ºs_¥öt_fmt
(
out
, 
fmt
, 
ºs
->
√xt
);

94 
	}
}

97 
	$ldns_dns£c_ºs_¥öt
(
FILE
 *
out
, 
ldns_dns£c_ºs
 *
ºs
)

99 
	`ldns_dns£c_ºs_¥öt_fmt
(
out
, 
ldns_ouçut_f‹m©_deÁu…
, 
ºs
);

100 
	}
}

103 
ldns_dns£c_º£ts
 *

104 
	$ldns_dns£c_º£ts_√w
()

106 
ldns_dns£c_º£ts
 *
√w_º£ts
;

107 
√w_º£ts
 = 
	`LDNS_MALLOC
(
ldns_dns£c_º£ts
);

108 if(!
√w_º£ts
Ë 
NULL
;

109 
√w_º£ts
->
ºs
 = 
NULL
;

110 
√w_º£ts
->
ty≥
 = 0;

111 
√w_º£ts
->
sig«tuªs
 = 
NULL
;

112 
√w_º£ts
->
√xt
 = 
NULL
;

113  
√w_º£ts
;

114 
	}
}

116 
INLINE
 

117 
	$ldns_dns£c_º£ts_‰ì_öã∫Æ
(
ldns_dns£c_º£ts
 *
º£ts
, 
dìp
)

119 i‡(
º£ts
) {

120 i‡(
º£ts
->
ºs
) {

121 
	`ldns_dns£c_ºs_‰ì_öã∫Æ
(
º£ts
->
ºs
, 
dìp
);

123 i‡(
º£ts
->
√xt
) {

124 
	`ldns_dns£c_º£ts_‰ì_öã∫Æ
(
º£ts
->
√xt
, 
dìp
);

126 i‡(
º£ts
->
sig«tuªs
) {

127 
	`ldns_dns£c_ºs_‰ì_öã∫Æ
(
º£ts
->
sig«tuªs
, 
dìp
);

129 
	`LDNS_FREE
(
º£ts
);

131 
	}
}

134 
	$ldns_dns£c_º£ts_‰ì
(
ldns_dns£c_º£ts
 *
º£ts
)

136 
	`ldns_dns£c_º£ts_‰ì_öã∫Æ
(
º£ts
, 0);

137 
	}
}

140 
	$ldns_dns£c_º£ts_dìp_‰ì
(
ldns_dns£c_º£ts
 *
º£ts
)

142 
	`ldns_dns£c_º£ts_‰ì_öã∫Æ
(
º£ts
, 1);

143 
	}
}

145 
ldns_º_ty≥


146 
	$ldns_dns£c_º£ts_ty≥
(
ldns_dns£c_º£ts
 *
º£ts
)

148 i‡(
º£ts
) {

149  
º£ts
->
ty≥
;

153 
	}
}

155 
ldns_°©us


156 
	$ldns_dns£c_º£ts_£t_ty≥
(
ldns_dns£c_º£ts
 *
º£ts
,

157 
ldns_º_ty≥
 
ty≥
)

159 i‡(
º£ts
) {

160 
º£ts
->
ty≥
 =Åype;

161  
LDNS_STATUS_OK
;

163  
LDNS_STATUS_ERR
;

164 
	}
}

166 
ldns_dns£c_º£ts
 *

167 
	$ldns_dns£c_º£ts_√w_‰m_º
(
ldns_º
 *
º
)

169 
ldns_dns£c_º£ts
 *
√w_º£ts
;

170 
ldns_º_ty≥
 
º_ty≥
;

171 
boﬁ
 
ºsig
;

173 
√w_º£ts
 = 
	`ldns_dns£c_º£ts_√w
();

174 
º_ty≥
 = 
	`ldns_º_gë_ty≥
(
º
);

175 i‡(
º_ty≥
 =
LDNS_RR_TYPE_RRSIG
) {

176 
ºsig
 = 
åue
;

177 
º_ty≥
 = 
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(
º
));

179 
ºsig
 = 
Ál£
;

181 i‡(!
ºsig
) {

182 
√w_º£ts
->
ºs
 = 
	`ldns_dns£c_ºs_√w
();

183 
√w_º£ts
->
ºs
->
º
 =Ñr;

185 
√w_º£ts
->
sig«tuªs
 = 
	`ldns_dns£c_ºs_√w
();

186 
√w_º£ts
->
sig«tuªs
->
º
 =Ñr;

188 
√w_º£ts
->
ty≥
 = 
º_ty≥
;

189  
√w_º£ts
;

190 
	}
}

192 
ldns_°©us


193 
	$ldns_dns£c_º£ts_add_º
(
ldns_dns£c_º£ts
 *
º£ts
, 
ldns_º
 *
º
)

195 
ldns_dns£c_º£ts
 *
√w_º£ts
;

196 
ldns_º_ty≥
 
º_ty≥
;

197 
boﬁ
 
ºsig
 = 
Ál£
;

198 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

200 i‡(!
º£ts
 || !
º
) {

201  
LDNS_STATUS_ERR
;

204 
º_ty≥
 = 
	`ldns_º_gë_ty≥
(
º
);

206 i‡(
º_ty≥
 =
LDNS_RR_TYPE_RRSIG
) {

207 
ºsig
 = 
åue
;

208 
º_ty≥
 = 
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(
º
));

211 i‡(!
º£ts
->
ºs
 &&Ñr£ts->
ty≥
 =0 && !º£ts->
sig«tuªs
) {

212 i‡(!
ºsig
) {

213 
º£ts
->
ºs
 = 
	`ldns_dns£c_ºs_√w
();

214 
º£ts
->
ºs
->
º
 =Ñr;

215 
º£ts
->
ty≥
 = 
º_ty≥
;

217 
º£ts
->
sig«tuªs
 = 
	`ldns_dns£c_ºs_√w
();

218 
º£ts
->
sig«tuªs
->
º
 =Ñr;

219 
º£ts
->
ty≥
 = 
º_ty≥
;

221  
LDNS_STATUS_OK
;

224 i‡(
º_ty≥
 > 
	`ldns_dns£c_º£ts_ty≥
(
º£ts
)) {

225 i‡(
º£ts
->
√xt
) {

226 
ªsu…
 = 
	`ldns_dns£c_º£ts_add_º
(
º£ts
->
√xt
, 
º
);

228 
√w_º£ts
 = 
	`ldns_dns£c_º£ts_√w_‰m_º
(
º
);

229 
º£ts
->
√xt
 = 
√w_º£ts
;

231 } i‡(
º_ty≥
 < 
	`ldns_dns£c_º£ts_ty≥
(
º£ts
)) {

234 
√w_º£ts
 = 
	`ldns_dns£c_º£ts_√w
();

235 
√w_º£ts
->
ºs
 = 
º£ts
->rrs;

236 
√w_º£ts
->
ty≥
 = 
º£ts
->type;

237 
√w_º£ts
->
sig«tuªs
 = 
º£ts
->signatures;

238 
√w_º£ts
->
√xt
 = 
º£ts
->next;

239 i‡(!
ºsig
) {

240 
º£ts
->
ºs
 = 
	`ldns_dns£c_ºs_√w
();

241 
º£ts
->
ºs
->
º
 =Ñr;

242 
º£ts
->
sig«tuªs
 = 
NULL
;

244 
º£ts
->
ºs
 = 
NULL
;

245 
º£ts
->
sig«tuªs
 = 
	`ldns_dns£c_ºs_√w
();

246 
º£ts
->
sig«tuªs
->
º
 =Ñr;

248 
º£ts
->
ty≥
 = 
º_ty≥
;

249 
º£ts
->
√xt
 = 
√w_º£ts
;

252 i‡(
ºsig
) {

253 i‡(
º£ts
->
sig«tuªs
) {

254 
ªsu…
 = 
	`ldns_dns£c_ºs_add_º
(
º£ts
->
sig«tuªs
, 
º
);

256 
º£ts
->
sig«tuªs
 = 
	`ldns_dns£c_ºs_√w
();

257 
º£ts
->
sig«tuªs
->
º
 =Ñr;

260 i‡(
º£ts
->
ºs
) {

261 
ªsu…
 = 
	`ldns_dns£c_ºs_add_º
(
º£ts
->
ºs
, 
º
);

263 
º£ts
->
ºs
 = 
	`ldns_dns£c_ºs_√w
();

264 
º£ts
->
ºs
->
º
 =Ñr;

269  
ªsu…
;

270 
	}
}

273 
	$ldns_dns£c_º£ts_¥öt_sﬂ_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

274 
ldns_dns£c_º£ts
 *
º£ts
,

275 
boﬁ
 
fﬁlow
,

276 
boﬁ
 
show_sﬂ
)

278 i‡(!
º£ts
) {

279 i‡((
fmt
->
Êags
 & 
LDNS_COMMENT_LAYOUT
))

280 
	`Ârötf
(
out
, "; <void>\n");

282 i‡(
º£ts
->
ºs
 &&

283 (
show_sﬂ
 ||

284 
	`ldns_º_gë_ty≥
(
º£ts
->
ºs
->
º
Ë!
LDNS_RR_TYPE_SOA


287 
	`ldns_dns£c_ºs_¥öt_fmt
(
out
, 
fmt
, 
º£ts
->
ºs
);

288 i‡(
º£ts
->
sig«tuªs
) {

289 
	`ldns_dns£c_ºs_¥öt_fmt
(
out
, 
fmt
,

290 
º£ts
->
sig«tuªs
);

293 i‡(
fﬁlow
 && 
º£ts
->
√xt
) {

294 
	`ldns_dns£c_º£ts_¥öt_sﬂ_fmt
(
out
, 
fmt
,

295 
º£ts
->
√xt
, 
fﬁlow
, 
show_sﬂ
);

298 
	}
}

302 
	$ldns_dns£c_º£ts_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

303 
ldns_dns£c_º£ts
 *
º£ts
,

304 
boﬁ
 
fﬁlow
)

306 
	`ldns_dns£c_º£ts_¥öt_sﬂ_fmt
(
out
, 
fmt
, 
º£ts
, 
fﬁlow
, 
åue
);

307 
	}
}

310 
	$ldns_dns£c_º£ts_¥öt
(
FILE
 *
out
, 
ldns_dns£c_º£ts
 *
º£ts
, 
boﬁ
 
fﬁlow
)

312 
	`ldns_dns£c_º£ts_¥öt_fmt
(
out
, 
ldns_ouçut_f‹m©_deÁu…
,

313 
º£ts
, 
fﬁlow
);

314 
	}
}

316 
ldns_dns£c_«me
 *

317 
	$ldns_dns£c_«me_√w
()

319 
ldns_dns£c_«me
 *
√w_«me
;

321 
√w_«me
 = 
	`LDNS_CALLOC
(
ldns_dns£c_«me
, 1);

322 i‡(!
√w_«me
) {

323  
NULL
;

338  
√w_«me
;

339 
	}
}

341 
ldns_dns£c_«me
 *

342 
	$ldns_dns£c_«me_√w_‰m_º
(
ldns_º
 *
º
)

344 
ldns_dns£c_«me
 *
√w_«me
 = 
	`ldns_dns£c_«me_√w
();

346 
√w_«me
->
«me
 = 
	`ldns_º_ow√r
(
º
);

347 if(
	`ldns_dns£c_«me_add_º
(
√w_«me
, 
º
Ë!
LDNS_STATUS_OK
) {

348 
	`ldns_dns£c_«me_‰ì
(
√w_«me
);

349  
NULL
;

352  
√w_«me
;

353 
	}
}

355 
INLINE
 

356 
	$ldns_dns£c_«me_‰ì_öã∫Æ
(
ldns_dns£c_«me
 *
«me
,

357 
dìp
)

359 i‡(
«me
) {

360 i‡(
«me
->
«me_Ælo˚d
) {

361 
	`ldns_rdf_dìp_‰ì
(
«me
->name);

363 i‡(
«me
->
º£ts
) {

364 
	`ldns_dns£c_º£ts_‰ì_öã∫Æ
(
«me
->
º£ts
, 
dìp
);

366 i‡(
«me
->
n£c
 && 
dìp
) {

367 
	`ldns_º_‰ì
(
«me
->
n£c
);

369 i‡(
«me
->
n£c_sig«tuªs
) {

370 
	`ldns_dns£c_ºs_‰ì_öã∫Æ
(
«me
->
n£c_sig«tuªs
, 
dìp
);

372 i‡(
«me
->
hashed_«me
) {

373 i‡(
dìp
) {

374 
	`ldns_rdf_dìp_‰ì
(
«me
->
hashed_«me
);

377 
	`LDNS_FREE
(
«me
);

379 
	}
}

382 
	$ldns_dns£c_«me_‰ì
(
ldns_dns£c_«me
 *
«me
)

384 
	`ldns_dns£c_«me_‰ì_öã∫Æ
(
«me
, 0);

385 
	}
}

388 
	$ldns_dns£c_«me_dìp_‰ì
(
ldns_dns£c_«me
 *
«me
)

390 
	`ldns_dns£c_«me_‰ì_öã∫Æ
(
«me
, 1);

391 
	}
}

393 
ldns_rdf
 *

394 
	$ldns_dns£c_«me_«me
(
ldns_dns£c_«me
 *
«me
)

396 i‡(
«me
) {

397  
«me
->name;

399  
NULL
;

400 
	}
}

402 
boﬁ


403 
	$ldns_dns£c_«me_is_glue
(
ldns_dns£c_«me
 *
«me
)

405 i‡(
«me
) {

406  
«me
->
is_glue
;

408  
Ál£
;

409 
	}
}

412 
	$ldns_dns£c_«me_£t_«me
(
ldns_dns£c_«me
 *
º£t
,

413 
ldns_rdf
 *
d«me
)

415 i‡(
º£t
 && 
d«me
) {

416 
º£t
->
«me
 = 
d«me
;

418 
	}
}

422 
	$ldns_dns£c_«me_£t_n£c
(
ldns_dns£c_«me
 *
º£t
, 
ldns_º
 *
n£c
)

424 i‡(
º£t
 && 
n£c
) {

425 
º£t
->
n£c
 =Çsec;

427 
	}
}

430 
	$ldns_dns£c_«me_cmp
(c⁄° *
a
, c⁄° *
b
)

432 
ldns_dns£c_«me
 *
«
 = (ldns_dns£c_«mê*Ë
a
;

433 
ldns_dns£c_«me
 *
nb
 = (ldns_dns£c_«mê*Ë
b
;

435 i‡(
«
 && 
nb
) {

436  
	`ldns_d«me_com∑ª
(
	`ldns_dns£c_«me_«me
(
«
),

437 
	`ldns_dns£c_«me_«me
(
nb
));

438 } i‡(
«
) {

440 } i‡(
nb
) {

445 
	}
}

447 
ldns_°©us


448 
	$ldns_dns£c_«me_add_º
(
ldns_dns£c_«me
 *
«me
,

449 
ldns_º
 *
º
)

451 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

452 
ldns_º_ty≥
 
º_ty≥
;

453 
ldns_º_ty≥
 
ty≥covîed
 = 0;

457 i‡(!
«me
 || !
º
) {

458  
LDNS_STATUS_ERR
;

461 
º_ty≥
 = 
	`ldns_º_gë_ty≥
(
º
);

463 i‡(
º_ty≥
 =
LDNS_RR_TYPE_RRSIG
) {

464 
ty≥covîed
 = 
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(
º
));

467 i‡(
º_ty≥
 =
LDNS_RR_TYPE_NSEC
 ||

468 
º_ty≥
 =
LDNS_RR_TYPE_NSEC3
) {

470 
«me
->
n£c
 = 
º
;

471 } i‡(
ty≥covîed
 =
LDNS_RR_TYPE_NSEC
 ||

472 
ty≥covîed
 =
LDNS_RR_TYPE_NSEC3
) {

473 i‡(
«me
->
n£c_sig«tuªs
) {

474 
ªsu…
 = 
	`ldns_dns£c_ºs_add_º
(
«me
->
n£c_sig«tuªs
, 
º
);

476 
«me
->
n£c_sig«tuªs
 = 
	`ldns_dns£c_ºs_√w
();

477 
«me
->
n£c_sig«tuªs
->
º
 =Ñr;

481 i‡(
«me
->
º£ts
) {

482 
ªsu…
 = 
	`ldns_dns£c_º£ts_add_º
(
«me
->
º£ts
, 
º
);

484 
«me
->
º£ts
 = 
	`ldns_dns£c_º£ts_√w
();

485 
ªsu…
 = 
	`ldns_dns£c_º£ts_add_º
(
«me
->
º£ts
, 
º
);

488  
ªsu…
;

489 
	}
}

491 
ldns_dns£c_º£ts
 *

492 
	$ldns_dns£c_«me_föd_º£t
(
ldns_dns£c_«me
 *
«me
,

493 
ldns_º_ty≥
 
ty≥
) {

494 
ldns_dns£c_º£ts
 *
ªsu…
;

496 
ªsu…
 = 
«me
->
º£ts
;

497 
ªsu…
) {

498 i‡(
ªsu…
->
ty≥
 ==Åype) {

499  
ªsu…
;

501 
ªsu…
 =Ñesu…->
√xt
;

504  
NULL
;

505 
	}
}

507 
ldns_dns£c_º£ts
 *

508 
	$ldns_dns£c_z⁄e_föd_º£t
(
ldns_dns£c_z⁄e
 *
z⁄e
,

509 
ldns_rdf
 *
d«me
,

510 
ldns_º_ty≥
 
ty≥
)

512 
ldns_rbnode_t
 *
node
;

514 i‡(!
z⁄e
 || !
d«me
) {

515  
NULL
;

518 
node
 = 
	`ldns_rbåì_£¨ch
(
z⁄e
->
«mes
, 
d«me
);

519 i‡(
node
) {

520  
	`ldns_dns£c_«me_föd_º£t
((
ldns_dns£c_«me
 *)
node
->
d©a
,

521 
ty≥
);

523  
NULL
;

525 
	}
}

528 
	$ldns_dns£c_«me_¥öt_sﬂ_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

529 
ldns_dns£c_«me
 *
«me
,

530 
boﬁ
 
show_sﬂ
)

532 i‡(
«me
) {

533 if(
«me
->
º£ts
) {

534 
	`ldns_dns£c_º£ts_¥öt_sﬂ_fmt
(
out
, 
fmt
,

535 
«me
->
º£ts
, 
åue
, 
show_sﬂ
);

536 } i‡((
fmt
->
Êags
 & 
LDNS_COMMENT_LAYOUT
)) {

537 
	`Ârötf
(
out
, ";; EmptyÇonterminal: ");

538 
	`ldns_rdf_¥öt
(
out
, 
«me
->name);

539 
	`Ârötf
(
out
, "\n");

541 if(
«me
->
n£c
) {

542 
	`ldns_º_¥öt_fmt
(
out
, 
fmt
, 
«me
->
n£c
);

544 i‡(
«me
->
n£c_sig«tuªs
) {

545 
	`ldns_dns£c_ºs_¥öt_fmt
(
out
, 
fmt
,

546 
«me
->
n£c_sig«tuªs
);

548 } i‡((
fmt
->
Êags
 & 
LDNS_COMMENT_LAYOUT
)) {

549 
	`Ârötf
(
out
, "; <void>\n");

551 
	}
}

555 
	$ldns_dns£c_«me_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

556 
ldns_dns£c_«me
 *
«me
)

558 
	`ldns_dns£c_«me_¥öt_sﬂ_fmt
(
out
, 
fmt
, 
«me
, 
åue
);

559 
	}
}

562 
	$ldns_dns£c_«me_¥öt
(
FILE
 *
out
, 
ldns_dns£c_«me
 *
«me
)

564 
	`ldns_dns£c_«me_¥öt_fmt
(
out
, 
ldns_ouçut_f‹m©_deÁu…
, 
«me
);

565 
	}
}

568 
ldns_dns£c_z⁄e
 *

569 
	$ldns_dns£c_z⁄e_√w
()

571 
ldns_dns£c_z⁄e
 *
z⁄e
 = 
	`LDNS_MALLOC
(ldns_dnssec_zone);

572 if(!
z⁄e
Ë 
NULL
;

573 
z⁄e
->
sﬂ
 = 
NULL
;

574 
z⁄e
->
«mes
 = 
NULL
;

575 
z⁄e
->
hashed_«mes
 = 
NULL
;

576 
z⁄e
->
_n£c3∑øms
 = 
NULL
;

578  
z⁄e
;

579 
	}
}

581 
boﬁ


582 
	$º_is_ºsig_covîög
(
ldns_º
* 
º
, 
ldns_º_ty≥
 
t
)

584  
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_RRSIG


585 && 
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(
º
)Ë=
t
;

586 
	}
}

594 
	#FASTER_DNSSEC_ZONE_NEW_FRM_FP
 1

	)

596 
ldns_°©us


597 
ldns_dns£c_z⁄e_√w_‰m_Â_l
(
ldns_dns£c_z⁄e
** 
z
, 
FILE
* 
Â
, 
ldns_rdf
* 
‹igö
,

598 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
ATTR_UNUSED
(
c
), * 
löe_ƒ
)

600 
ldns_º
* 
	gcur_º
;

601 
size_t
 
	gi
;

603 
ldns_rdf
 *
	gmy_‹igö
 = 
NULL
;

604 
ldns_rdf
 *
	gmy_¥ev
 = 
NULL
;

606 
ldns_dns£c_z⁄e
 *
	g√wz⁄e
 = 
ldns_dns£c_z⁄e_√w
();

611 
ldns_º_li°
* 
	gtodo_n£c3s
 = 
ldns_º_li°_√w
();

612 
ldns_º_li°
* 
	gtodo_n£c3_ºsigs
 = 
ldns_º_li°_√w
();

614 
ldns_°©us
 
	g°©us
 = 
LDNS_STATUS_MEM_ERR
;

616 #ifde‡
FASTER_DNSSEC_ZONE_NEW_FRM_FP


617 
ldns_z⁄e
* 
	gz⁄e
 = 
NULL
;

618 i‡(
ldns_z⁄e_√w_‰m_Â_l
(&
z⁄e
, 
Â
, 
‹igö
,
âl
, 
c
, 
löe_ƒ
)

619 !
LDNS_STATUS_OK
Ë
îr‹
;

621 
uöt32_t
 
	gmy_âl
 = 
âl
;

624 i‡(!
	g√wz⁄e
 || !
	gtodo_n£c3s
 || !
	gtodo_n£c3_ºsigs
 ) 
	gîr‹
;

626 i‡(
	g‹igö
) {

627 i‡(!(
	gmy_‹igö
 = 
ldns_rdf_˛⁄e
(
‹igö
))Ë
îr‹
;

628 i‡(!(
	gmy_¥ev
 = 
ldns_rdf_˛⁄e
(
‹igö
))Ë
îr‹
;

631 #ifde‡
FASTER_DNSSEC_ZONE_NEW_FRM_FP


632 i‡(
ldns_dns£c_z⁄e_add_º
(
√wz⁄e
, 
ldns_z⁄e_sﬂ
(
z⁄e
))

633 !
LDNS_STATUS_OK
Ë
îr‹
;

635 
	gi
 = 0; i < 
ldns_º_li°_º_cou¡
(
ldns_z⁄e_ºs
(
z⁄e
)); i++) {

636 
	gcur_º
 = 
ldns_º_li°_º
(
ldns_z⁄e_ºs
(
z⁄e
), 
i
);

637 
	g°©us
 = 
LDNS_STATUS_OK
;

639 !
„of
(
Â
)) {

640 
	g°©us
 = 
ldns_º_√w_‰m_Â_l
(&
cur_º
, 
Â
, &
my_âl
, &
my_‹igö
,

641 &
my_¥ev
, 
löe_ƒ
);

644 
	g°©us
) {

645 
	gLDNS_STATUS_OK
:

647 
°©us
 = 
ldns_dns£c_z⁄e_add_º
(
√wz⁄e
, 
cur_º
);

648 i‡(
	g°©us
 ==

649 
LDNS_STATUS_DNSSEC_NSEC3_ORIGINAL_NOT_FOUND
) {

651 i‡(
º_is_ºsig_covîög
(
cur_º
,

652 
LDNS_RR_TYPE_NSEC3
)){

653 
ldns_º_li°_push_º
(
todo_n£c3_ºsigs
,

654 
cur_º
);

656 
ldns_º_li°_push_º
(
todo_n£c3s
,

657 
cur_º
);

659 
	g°©us
 = 
LDNS_STATUS_OK
;

661 } i‡(
	g°©us
 !
LDNS_STATUS_OK
)

662 
îr‹
;

667 
	gLDNS_STATUS_SYNTAX_EMPTY
:

668 
LDNS_STATUS_SYNTAX_TTL
:

669 
LDNS_STATUS_SYNTAX_ORIGIN
:

670 
°©us
 = 
LDNS_STATUS_OK
;

673 
	gLDNS_STATUS_SYNTAX_INCLUDE
:

674 
°©us
 = 
LDNS_STATUS_SYNTAX_INCLUDE_ERR_NOTIMPL
;

678 
îr‹
;

682 i‡(
ldns_º_li°_º_cou¡
(
todo_n£c3s
) > 0) {

683 (Ë
ldns_dns£c_z⁄e_add_em±y_n⁄ãrmöÆs
(
√wz⁄e
);

684 
	gi
 = 0; 
	g°©us
 =
LDNS_STATUS_OK
 &&

685 
i
 < 
ldns_º_li°_º_cou¡
(
todo_n£c3s
); 
	gi
++) {

686 
	gcur_º
 = 
ldns_º_li°_º
(
todo_n£c3s
, 
i
);

687 
	g°©us
 = 
ldns_dns£c_z⁄e_add_º
(
√wz⁄e
, 
cur_º
);

690 i‡(
ldns_º_li°_º_cou¡
(
todo_n£c3_ºsigs
) > 0) {

691 
	gi
 = 0; 
	g°©us
 =
LDNS_STATUS_OK
 &&

692 
i
 < 
ldns_º_li°_º_cou¡
(
todo_n£c3_ºsigs
);

693 
	gi
++){

694 
	gcur_º
 = 
ldns_º_li°_º
(
todo_n£c3_ºsigs
, 
i
);

695 
	g°©us
 = 
ldns_dns£c_z⁄e_add_º
(
√wz⁄e
, 
cur_º
);

699 i‡(
	gz
) {

700 *
	gz
 = 
√wz⁄e
;

701 
	g√wz⁄e
 = 
NULL
;

703 
ldns_dns£c_z⁄e_‰ì
(
√wz⁄e
);

706 
	gîr‹
:

707 #ifde‡
FASTER_DNSSEC_ZONE_NEW_FRM_FP


708 i‡(
z⁄e
) {

709 
ldns_z⁄e_‰ì
(
z⁄e
);

712 
ldns_º_li°_‰ì
(
todo_n£c3_ºsigs
);

713 
ldns_º_li°_‰ì
(
todo_n£c3s
);

715 i‡(
	gmy_‹igö
) {

716 
ldns_rdf_dìp_‰ì
(
my_‹igö
);

718 i‡(
	gmy_¥ev
) {

719 
ldns_rdf_dìp_‰ì
(
my_¥ev
);

721 i‡(
	g√wz⁄e
) {

722 
ldns_dns£c_z⁄e_‰ì
(
√wz⁄e
);

724  
	g°©us
;

727 
ldns_°©us


728 
ldns_dns£c_z⁄e_√w_‰m_Â
(
ldns_dns£c_z⁄e
** 
z
, 
FILE
* 
Â
, 
ldns_rdf
* 
‹igö
,

729 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
	$ATTR_UNUSED
(
c
))

731  
	`ldns_dns£c_z⁄e_√w_‰m_Â_l
(
z
, 
Â
, 
‹igö
, 
âl
, 
c
, 
NULL
);

732 
	}
}

735 
	$ldns_dns£c_«me_node_‰ì
(
ldns_rbnode_t
 *
node
, *
¨g
) {

736 (Ë
¨g
;

737 
	`ldns_dns£c_«me_‰ì
((
ldns_dns£c_«me
 *)
node
->
d©a
);

738 
	`LDNS_FREE
(
node
);

739 
	}
}

742 
	$ldns_dns£c_«me_node_dìp_‰ì
(
ldns_rbnode_t
 *
node
, *
¨g
) {

743 (Ë
¨g
;

744 
	`ldns_dns£c_«me_dìp_‰ì
((
ldns_dns£c_«me
 *)
node
->
d©a
);

745 
	`LDNS_FREE
(
node
);

746 
	}
}

749 
	$ldns_dns£c_z⁄e_‰ì
(
ldns_dns£c_z⁄e
 *
z⁄e
)

751 i‡(
z⁄e
) {

752 i‡(
z⁄e
->
«mes
) {

754 
	`ldns_åavî£_po°‹dî
(
z⁄e
->
«mes
,

755 
ldns_dns£c_«me_node_‰ì
,

756 
NULL
);

757 
	`LDNS_FREE
(
z⁄e
->
«mes
);

759 
	`LDNS_FREE
(
z⁄e
);

761 
	}
}

764 
	$ldns_dns£c_z⁄e_dìp_‰ì
(
ldns_dns£c_z⁄e
 *
z⁄e
)

766 i‡(
z⁄e
) {

767 i‡(
z⁄e
->
«mes
) {

769 
	`ldns_åavî£_po°‹dî
(
z⁄e
->
«mes
,

770 
ldns_dns£c_«me_node_dìp_‰ì
,

771 
NULL
);

772 
	`LDNS_FREE
(
z⁄e
->
«mes
);

774 
	`LDNS_FREE
(
z⁄e
);

776 
	}
}

780 
	$ldns_d«me_com∑ª_v
(c⁄° *
a
, c⁄° *
b
) {

781  
	`ldns_d«me_com∑ª
((
ldns_rdf
 *)
a
, (ldns_rd‡*)
b
);

782 
	}
}

785 
ldns_dns£c_«me_make_hashed_«me
(
ldns_dns£c_z⁄e
 *
z⁄e
,

786 
ldns_dns£c_«me
* 
«me
, 
ldns_º
* 
n£c3º
);

789 
	$ldns_hashed_«mes_node_‰ì
(
ldns_rbnode_t
 *
node
, *
¨g
) {

790 (Ë
¨g
;

791 
	`LDNS_FREE
(
node
);

792 
	}
}

795 
	$ldns_dns£c_z⁄e_hashed_«mes_‰om_n£c3
(

796 
ldns_dns£c_z⁄e
* 
z⁄e
, 
ldns_º
* 
n£c3º
)

798 
ldns_rbnode_t
* 
cuºít_node
;

799 
ldns_dns£c_«me
* 
cuºít_«me
;

801 
	`as£π
(
z⁄e
 !
NULL
);

802 
	`as£π
(
n£c3º
 !
NULL
);

804 i‡(
z⁄e
->
hashed_«mes
) {

805 
	`ldns_åavî£_po°‹dî
(
z⁄e
->
hashed_«mes
,

806 
ldns_hashed_«mes_node_‰ì
, 
NULL
);

807 
	`LDNS_FREE
(
z⁄e
->
hashed_«mes
);

809 
z⁄e
->
_n£c3∑øms
 = 
n£c3º
;

814 
z⁄e
->
hashed_«mes
 = 
	`ldns_rbåì_¸óã
(
ldns_d«me_com∑ª_v
);

815 i‡(
z⁄e
->
hashed_«mes
 =
NULL
) {

818  
cuºít_node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
)

819 ; 
cuºít_node
 !
LDNS_RBTREE_NULL


820 ; 
cuºít_node
 = 
	`ldns_rbåì_√xt
(current_node)

822 
cuºít_«me
 = (
ldns_dns£c_«me
 *Ë
cuºít_node
->
d©a
;

823 
	`ldns_dns£c_«me_make_hashed_«me
(
z⁄e
, 
cuºít_«me
, 
n£c3º
);

826 
	}
}

829 
	$ldns_dns£c_«me_make_hashed_«me
(
ldns_dns£c_z⁄e
 *
z⁄e
,

830 
ldns_dns£c_«me
* 
«me
, 
ldns_º
* 
n£c3º
)

832 
ldns_rbnode_t
* 
√w_node
;

834 
	`as£π
(
«me
 !
NULL
);

835 i‡(! 
z⁄e
->
_n£c3∑øms
) {

836 i‡(! 
n£c3º
) {

839 
	`ldns_dns£c_z⁄e_hashed_«mes_‰om_n£c3
(
z⁄e
, 
n£c3º
);

841 } i‡(! 
n£c3º
) {

842 
n£c3º
 = 
z⁄e
->
_n£c3∑øms
;

844 
«me
->
hashed_«me
 = 
	`ldns_n£c3_hash_«me_‰m_n£c3
(
n£c3º
,Çame->name);

847 i‡((
√w_node
 = 
	`LDNS_MALLOC
(
ldns_rbnode_t
))) {

849 
√w_node
->
key
 = 
«me
->
hashed_«me
;

850 
√w_node
->
d©a
 = 
«me
;

852 i‡(
	`ldns_rbåì_ö£π
(
z⁄e
->
hashed_«mes
, 
√w_node
Ë=
NULL
) {

854 
	`LDNS_FREE
(
√w_node
);

857 
	}
}

860 
ldns_rbnode_t
 *

861 
	$ldns_dns£c_z⁄e_föd_n£c3_‹igöÆ
(
ldns_dns£c_z⁄e
 *
z⁄e
, 
ldns_º
 *
º
) {

862 
ldns_rdf
 *
hashed_«me
;

864 
hashed_«me
 = 
	`ldns_d«me_œbñ
(
	`ldns_º_ow√r
(
º
), 0);

865 i‡(
hashed_«me
 =
NULL
) {

866  
NULL
;

868 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_NSEC3
 && ! 
z⁄e
->
_n£c3∑øms
){

870 
	`ldns_dns£c_z⁄e_hashed_«mes_‰om_n£c3
(
z⁄e
, 
º
);

872 i‡(
z⁄e
->
hashed_«mes
 =
NULL
) {

873 
	`ldns_rdf_dìp_‰ì
(
hashed_«me
);

874  
NULL
;

876  
	`ldns_rbåì_£¨ch
(
z⁄e
->
hashed_«mes
, 
hashed_«me
);

877 
	}
}

879 
ldns_°©us


880 
	$ldns_dns£c_z⁄e_add_º
(
ldns_dns£c_z⁄e
 *
z⁄e
, 
ldns_º
 *
º
)

882 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

883 
ldns_dns£c_«me
 *
cur_«me
;

884 
ldns_rbnode_t
 *
cur_node
;

885 
ldns_º_ty≥
 
ty≥_covîed
 = 0;

887 i‡(!
z⁄e
 || !
º
) {

888  
LDNS_STATUS_ERR
;

891 i‡(!
z⁄e
->
«mes
) {

892 
z⁄e
->
«mes
 = 
	`ldns_rbåì_¸óã
(
ldns_d«me_com∑ª_v
);

893 if(!
z⁄e
->
«mes
Ë 
LDNS_STATUS_MEM_ERR
;

898 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_RRSIG
) {

899 
ty≥_covîed
 = 
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(
º
));

901 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_NSEC3
 ||

902 
ty≥_covîed
 =
LDNS_RR_TYPE_NSEC3
) {

903 
cur_node
 = 
	`ldns_dns£c_z⁄e_föd_n£c3_‹igöÆ
(
z⁄e
, 
º
);

904 i‡(!
cur_node
) {

905  
LDNS_STATUS_DNSSEC_NSEC3_ORIGINAL_NOT_FOUND
;

908 
cur_node
 = 
	`ldns_rbåì_£¨ch
(
z⁄e
->
«mes
, 
	`ldns_º_ow√r
(
º
));

910 i‡(!
cur_node
) {

912 
cur_«me
 = 
	`ldns_dns£c_«me_√w_‰m_º
(
º
);

913 if(!
cur_«me
Ë 
LDNS_STATUS_MEM_ERR
;

914 
cur_node
 = 
	`LDNS_MALLOC
(
ldns_rbnode_t
);

915 if(!
cur_node
) {

916 
	`ldns_dns£c_«me_‰ì
(
cur_«me
);

917  
LDNS_STATUS_MEM_ERR
;

919 
cur_node
->
key
 = 
	`ldns_º_ow√r
(
º
);

920 
cur_node
->
d©a
 = 
cur_«me
;

921 ()
	`ldns_rbåì_ö£π
(
z⁄e
->
«mes
, 
cur_node
);

922 
	`ldns_dns£c_«me_make_hashed_«me
(
z⁄e
, 
cur_«me
, 
NULL
);

924 
cur_«me
 = (
ldns_dns£c_«me
 *Ë
cur_node
->
d©a
;

925 
ªsu…
 = 
	`ldns_dns£c_«me_add_º
(
cur_«me
, 
º
);

927 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_SOA
) {

928 
z⁄e
->
sﬂ
 = 
cur_«me
;

930  
ªsu…
;

931 
	}
}

934 
	$ldns_dns£c_z⁄e_«mes_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

935 
ldns_rbåì_t
 *
åì
,

936 
boﬁ
 
¥öt_sﬂ
)

938 
ldns_rbnode_t
 *
node
;

939 
ldns_dns£c_«me
 *
«me
;

941 
node
 = 
	`ldns_rbåì_fú°
(
åì
);

942 
node
 !
LDNS_RBTREE_NULL
) {

943 
«me
 = (
ldns_dns£c_«me
 *Ë
node
->
d©a
;

944 
	`ldns_dns£c_«me_¥öt_sﬂ_fmt
(
out
, 
fmt
, 
«me
, 
¥öt_sﬂ
);

945 i‡((
fmt
->
Êags
 & 
LDNS_COMMENT_LAYOUT
))

946 
	`Ârötf
(
out
, ";\n");

947 
node
 = 
	`ldns_rbåì_√xt
(node);

949 
	}
}

952 
	$ldns_dns£c_z⁄e_«mes_¥öt
(
FILE
 *
out
, 
ldns_rbåì_t
 *
åì
, 
boﬁ
 
¥öt_sﬂ
)

954 
	`ldns_dns£c_z⁄e_«mes_¥öt_fmt
(
out
, 
ldns_ouçut_f‹m©_deÁu…
,

955 
åì
, 
¥öt_sﬂ
);

956 
	}
}

959 
	$ldns_dns£c_z⁄e_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

960 
ldns_dns£c_z⁄e
 *
z⁄e
)

962 i‡(
z⁄e
) {

963 i‡(
z⁄e
->
sﬂ
) {

964 i‡((
fmt
->
Êags
 & 
LDNS_COMMENT_LAYOUT
)) {

965 
	`Ârötf
(
out
, ";; Zone: ");

966 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_dns£c_«me_«me
(

967 
z⁄e
->
sﬂ
));

968 
	`Ârötf
(
out
, "\n;\n");

970 
	`ldns_dns£c_º£ts_¥öt_fmt
(
out
, 
fmt
,

971 
	`ldns_dns£c_«me_föd_º£t
(

972 
z⁄e
->
sﬂ
,

973 
LDNS_RR_TYPE_SOA
),

974 
Ál£
);

975 i‡((
fmt
->
Êags
 & 
LDNS_COMMENT_LAYOUT
))

976 
	`Ârötf
(
out
, ";\n");

979 i‡(
z⁄e
->
«mes
) {

980 
	`ldns_dns£c_z⁄e_«mes_¥öt_fmt
(
out
, 
fmt
,

981 
z⁄e
->
«mes
, 
Ál£
);

984 
	}
}

987 
	$ldns_dns£c_z⁄e_¥öt
(
FILE
 *
out
, 
ldns_dns£c_z⁄e
 *
z⁄e
)

989 
	`ldns_dns£c_z⁄e_¥öt_fmt
(
out
, 
ldns_ouçut_f‹m©_deÁu…
, 
z⁄e
);

990 
	}
}

992 
ldns_°©us


993 
	$ldns_dns£c_z⁄e_add_em±y_n⁄ãrmöÆs
(
ldns_dns£c_z⁄e
 *
z⁄e
)

995 
ldns_dns£c_«me
 *
√w_«me
;

996 
ldns_rdf
 *
cur_«me
;

997 
ldns_rdf
 *
√xt_«me
;

998 
ldns_rbnode_t
 *
cur_node
, *
√xt_node
, *
√w_node
;

1001 
uöt16_t
 
i
, 
cur_œbñ_cou¡
, 
√xt_œbñ_cou¡
;

1002 
uöt16_t
 
sﬂ_œbñ_cou¡
 = 0;

1003 
ldns_rdf
 *
l1
, *
l2
;

1004 
Õos
;

1006 i‡(!
z⁄e
) {

1007  
LDNS_STATUS_ERR
;

1009 i‡(
z⁄e
->
sﬂ
 && z⁄e->sﬂ->
«me
) {

1010 
sﬂ_œbñ_cou¡
 = 
	`ldns_d«me_œbñ_cou¡
(
z⁄e
->
sﬂ
->
«me
);

1013 
cur_node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
);

1014 
cur_node
 !
LDNS_RBTREE_NULL
) {

1015 
√xt_node
 = 
	`ldns_rbåì_√xt
(
cur_node
);

1018 
√xt_node
 !
LDNS_RBTREE_NULL
 &&

1019 
√xt_node
->
d©a
 &&

1020 ((
ldns_dns£c_«me
 *)
√xt_node
->
d©a
)->
is_glue


1022 
√xt_node
 = 
	`ldns_rbåì_√xt
(next_node);

1025 i‡(
√xt_node
 =
LDNS_RBTREE_NULL
) {

1026 
√xt_node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
);

1028 i‡(! 
cur_node
->
d©a
 || ! 
√xt_node
->data) {

1029  
LDNS_STATUS_ERR
;

1031 
cur_«me
 = ((
ldns_dns£c_«me
 *)
cur_node
->
d©a
)->
«me
;

1032 
√xt_«me
 = ((
ldns_dns£c_«me
 *)
√xt_node
->
d©a
)->
«me
;

1033 
cur_œbñ_cou¡
 = 
	`ldns_d«me_œbñ_cou¡
(
cur_«me
);

1034 
√xt_œbñ_cou¡
 = 
	`ldns_d«me_œbñ_cou¡
(
√xt_«me
);

1043 
i
 = 1; i < 
√xt_œbñ_cou¡
 - 
sﬂ_œbñ_cou¡
; i++) {

1044 
Õos
 = ()
cur_œbñ_cou¡
 - ()
√xt_œbñ_cou¡
 + ()
i
;

1045 i‡(
Õos
 >= 0) {

1046 
l1
 = 
	`ldns_d«me_˛⁄e_‰om
(
cur_«me
, (
uöt8_t
)
Õos
);

1048 
l1
 = 
NULL
;

1050 
l2
 = 
	`ldns_d«me_˛⁄e_‰om
(
√xt_«me
, 
i
);

1052 i‡(!
l1
 || 
	`ldns_d«me_com∑ª
÷1, 
l2
) != 0) {

1056 
√w_«me
 = 
	`ldns_dns£c_«me_√w
();

1057 i‡(!
√w_«me
) {

1058  
LDNS_STATUS_MEM_ERR
;

1060 
√w_«me
->
«me
 = 
	`ldns_d«me_˛⁄e_‰om
(
√xt_«me
,

1061 
i
);

1062 i‡(!
√w_«me
->
«me
) {

1063 
	`ldns_dns£c_«me_‰ì
(
√w_«me
);

1064  
LDNS_STATUS_MEM_ERR
;

1066 
√w_«me
->
«me_Ælo˚d
 = 
åue
;

1067 
√w_node
 = 
	`LDNS_MALLOC
(
ldns_rbnode_t
);

1068 i‡(!
√w_node
) {

1069 
	`ldns_dns£c_«me_‰ì
(
√w_«me
);

1070  
LDNS_STATUS_MEM_ERR
;

1072 
√w_node
->
key
 = 
√w_«me
->
«me
;

1073 
√w_node
->
d©a
 = 
√w_«me
;

1074 ()
	`ldns_rbåì_ö£π
(
z⁄e
->
«mes
, 
√w_node
);

1075 
	`ldns_dns£c_«me_make_hashed_«me
(

1076 
z⁄e
, 
√w_«me
, 
NULL
);

1078 
	`ldns_rdf_dìp_‰ì
(
l1
);

1079 
	`ldns_rdf_dìp_‰ì
(
l2
);

1085 i‡(
√xt_node
 !
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
)) {

1086 
cur_node
 = 
√xt_node
;

1088 
cur_node
 = 
LDNS_RBTREE_NULL
;

1091  
LDNS_STATUS_OK
;

1092 
	}
}

1094 
boﬁ


1095 
	$ldns_dns£c_z⁄e_is_n£c3_›tout
(
ldns_dns£c_z⁄e
* 
z⁄e
)

1097 
ldns_º
* 
n£c3
;

1098 
ldns_rbnode_t
* 
node
;

1100 i‡(
	`ldns_dns£c_«me_föd_º£t
(
z⁄e
->
sﬂ
, 
LDNS_RR_TYPE_NSEC3PARAM
)) {

1101 
node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
);

1102 
node
 !
LDNS_RBTREE_NULL
) {

1103 
n£c3
 = ((
ldns_dns£c_«me
*)
node
->
d©a
)->
n£c
;

1104 i‡(
n£c3
 &&
	`ldns_º_gë_ty≥
(nsec3)

1105 =
LDNS_RR_TYPE_NSEC3
 &&

1106 
	`ldns_n£c3_›tout
(
n£c3
)) {

1107  
åue
;

1109 
node
 = 
	`ldns_rbåì_√xt
(node);

1112  
Ál£
;

1113 
	}
}

	@drill/chasetrace.c

11 
	~"drûl.h
"

12 
	~<ldns/ldns.h
>

23 
ldns_pkt
 *

24 
	$do_åa˚
(
ldns_ªsﬁvî
 *
loˇl_ªs
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
,

25 
ldns_º_˛ass
 
c
)

27 
ldns_ªsﬁvî
 *
ªs
;

28 
ldns_pkt
 *
p
;

29 
ldns_º_li°
 *
√w_nss_a
;

30 
ldns_º_li°
 *
√w_nss_ØØ
;

31 
ldns_º_li°
 *
föÆ_™swî
;

32 
ldns_º_li°
 *
√w_nss
;

33 
ldns_º_li°
 *
ns_addr
;

34 
uöt16_t
 
lo›_cou¡
;

35 
ldns_rdf
 *
p›
;

36 
ldns_°©us
 
°©us
;

37 
size_t
 
i
;

39 
lo›_cou¡
 = 0;

40 
√w_nss_a
 = 
NULL
;

41 
√w_nss_ØØ
 = 
NULL
;

42 
√w_nss
 = 
NULL
;

43 
ns_addr
 = 
NULL
;

44 
föÆ_™swî
 = 
NULL
;

45 
p
 = 
	`ldns_pkt_√w
();

46 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

48 i‡(!
p
) {

49 i‡(
ªs
) {

50 
	`ldns_ªsﬁvî_‰ì
(
ªs
);

52 
	`îr‹
("Memoryállocation failed");

53  
NULL
;

55 i‡(!
ªs
) {

56 
	`ldns_pkt_‰ì
(
p
);

57 
	`îr‹
("Memoryállocation failed");

58  
NULL
;

63 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
,

64 
	`ldns_ªsﬁvî_ù6
(
loˇl_ªs
));

65 
	`ldns_ªsﬁvî_£t_p‹t
(
ªs
,

66 
	`ldns_ªsﬁvî_p‹t
(
loˇl_ªs
));

67 
	`ldns_ªsﬁvî_£t_debug
(
ªs
,

68 
	`ldns_ªsﬁvî_debug
(
loˇl_ªs
));

69 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
,

70 
	`ldns_ªsﬁvî_dns£c
(
loˇl_ªs
));

71 
	`ldns_ªsﬁvî_£t_Áû
(
ªs
,

72 
	`ldns_ªsﬁvî_Áû
(
loˇl_ªs
));

73 
	`ldns_ªsﬁvî_£t_u£vc
(
ªs
,

74 
	`ldns_ªsﬁvî_u£vc
(
loˇl_ªs
));

75 
	`ldns_ªsﬁvî_£t_øndom
(
ªs
,

76 
	`ldns_ªsﬁvî_øndom
(
loˇl_ªs
));

77 
	`ldns_ªsﬁvî_£t_sour˚
(
ªs
,

78 
	`ldns_ªsﬁvî_sour˚
(
loˇl_ªs
));

79 
	`ldns_ªsﬁvî_£t_ªcursive
(
ªs
, 
Ál£
);

82 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
globÆ_dns_roŸ
);

83 i‡(
°©us
 !
LDNS_STATUS_OK
) {

84 
	`Ârötf
(
°dîr
, "Eº‹áddögÑoŸ sîvî†tÿªsﬁvî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

85 
	`ldns_º_li°_¥öt
(
°dout
, 
globÆ_dns_roŸ
);

86 
	`ldns_ªsﬁvî_‰ì
(
ªs
);

87 
	`ldns_pkt_‰ì
(
p
);

88  
NULL
;

92 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
	`ldns_d«me_√w_‰m_°r
("."), 
LDNS_RR_TYPE_NS
, 
c
, 0);

96 i‡(
	`ldns_pkt_em±y
(
p
)) {

97 
	`w¨nög
("NoÑoot server informationÑeceived");

100 i‡(
°©us
 =
LDNS_STATUS_OK
) {

101 i‡(!
	`ldns_pkt_em±y
(
p
)) {

102 
	`drûl_pkt_¥öt
(
°dout
, 
loˇl_ªs
, 
p
);

105 
	`îr‹
("cannot useÜocalÑesolver");

106  
NULL
;

109 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

111 
°©us
 =
LDNS_STATUS_OK
 &&

112 
	`ldns_pkt_ª∂y_ty≥
(
p
Ë=
LDNS_PACKET_REFERRAL
) {

114 i‡(!
p
) {

116  
NULL
;

119 
√w_nss_a
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

120 
LDNS_RR_TYPE_A
, 
LDNS_SECTION_ADDITIONAL
);

121 
√w_nss_ØØ
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

122 
LDNS_RR_TYPE_AAAA
, 
LDNS_SECTION_ADDITIONAL
);

123 
√w_nss
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

124 
LDNS_RR_TYPE_NS
, 
LDNS_SECTION_AUTHORITY
);

126 i‡(
vîbosôy
 != -1) {

127 
	`ldns_º_li°_¥öt
(
°dout
, 
√w_nss
);

130 
	`drûl_pkt_¥öt_foŸî
(
°dout
, 
loˇl_ªs
, 
p
);

133 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
)) { }

137 i‡(!
√w_nss_ØØ
 && !
√w_nss_a
) {

142 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
√w_nss
); i++) {

144 
p›
 = 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
√w_nss
, 
i
), 0);

145 i‡(!
p›
) {

149 
	`ldns_º_li°_¥öt
(
°dout
, 
√w_nss
);

150 
	`ldns_rdf_¥öt
(
°dout
, 
p›
);

152 
ns_addr
 = 
	`ldns_º_li°_ˇt_˛⁄e
(ns_addr,

153 
	`ldns_gë_º_li°_addr_by_«me
(
loˇl_ªs
, 
p›
, 
c
, 0));

156 i‡(
ns_addr
) {

157 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
ns_addr
) !=

158 
LDNS_STATUS_OK
) {

159 
	`îr‹
("ErroráddingÇewÇameservers");

160 
	`ldns_pkt_‰ì
(
p
);

161  
NULL
;

163 
	`ldns_º_li°_‰ì
(
ns_addr
);

165 
	`ldns_º_li°_¥öt
(
°dout
, 
ns_addr
);

166 
	`îr‹
("CouldÇot findÅheÇameserver ipáddr;ábort");

167 
	`ldns_pkt_‰ì
(
p
);

168  
NULL
;

173 i‡(
√w_nss_ØØ
) {

174 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
√w_nss_ØØ
) !=

175 
LDNS_STATUS_OK
) {

176 
	`îr‹
("addingÇewÇameservers");

177 
	`ldns_pkt_‰ì
(
p
);

178  
NULL
;

181 i‡(
√w_nss_a
) {

182 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
√w_nss_a
) !=

183 
LDNS_STATUS_OK
) {

184 
	`îr‹
("addingÇewÇameservers");

185 
	`ldns_pkt_‰ì
(
p
);

186  
NULL
;

190 i‡(
lo›_cou¡
++ > 20) {

192 
	`îr‹
("LooksÜike weáreÜooping");

193 
	`ldns_pkt_‰ì
(
p
);

194  
NULL
;

197 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

198 
√w_nss_ØØ
 = 
NULL
;

199 
√w_nss_a
 = 
NULL
;

200 
ns_addr
 = 
NULL
;

203 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

205 i‡(!
p
) {

206  
NULL
;

209 
√w_nss
 = 
	`ldns_pkt_auth‹ôy
(
p
);

210 
föÆ_™swî
 = 
	`ldns_pkt_™swî
(
p
);

212 i‡(
vîbosôy
 != -1) {

213 
	`ldns_º_li°_¥öt
(
°dout
, 
föÆ_™swî
);

214 
	`ldns_º_li°_¥öt
(
°dout
, 
√w_nss
);

217 
	`drûl_pkt_¥öt_foŸî
(
°dout
, 
loˇl_ªs
, 
p
);

218 
	`ldns_pkt_‰ì
(
p
);

219  
NULL
;

220 
	}
}

231 #ifde‡
HAVE_SSL


232 
ldns_°©us


233 
do_cha£
(
ldns_ªsﬁvî
 *
ªs
,

234 
ldns_rdf
 *
«me
,

235 
ldns_º_ty≥
 
ty≥
,

236 
ldns_º_˛ass
 
c
,

237 
ldns_º_li°
 *
åu°ed_keys
,

238 
ldns_pkt
 *
pkt_o
,

239 
uöt16_t
 
qÊags
,

240 
ldns_º_li°
 * 
ATTR_UNUSED
(
¥ev_key_li°
),

241 
vîbosôy
)

243 
ldns_º_li°
 *
	gº£t
 = 
NULL
;

244 
ldns_°©us
 
	gªsu…
;

245 
ldns_º
 *
	g‹ig_º
 = 
NULL
;

253 
ldns_pkt
 *
	gpkt
;

254 
ldns_°©us
 
	gåì_ªsu…
;

255 
ldns_dns£c_d©a_chaö
 *
	gchaö
;

256 
ldns_dns£c_åu°_åì
 *
	gåì
;

258 c⁄° 
ldns_º_des¸ùt‹
 *
	gdes¸ùt‹
;

259 
	gdes¸ùt‹
 = 
ldns_º_des¸ùt
(
ty≥
);

261 
ldns_d«me2ˇn⁄iˇl
(
«me
);

263 
	gpkt
 = 
ldns_pkt_˛⁄e
(
pkt_o
);

264 i‡(!
	g«me
) {

265 
mesg
("NoÇameÅo chase");

266 
ldns_pkt_‰ì
(
pkt
);

267  
	gLDNS_STATUS_EMPTY_LABEL
;

269 i‡(
	gvîbosôy
 != -1) {

270 
¥ötf
(";; Chasing: ");

271 
ldns_rdf_¥öt
(
°dout
, 
«me
);

272 i‡(
	gdes¸ùt‹
 && des¸ùt‹->
	g_«me
) {

273 
¥ötf
(" %s\n", 
des¸ùt‹
->
_«me
);

275 
¥ötf
("Åy≥ %d\n", 
ty≥
);

279 i‡(!
	gåu°ed_keys
 || 
ldns_º_li°_º_cou¡
(
åu°ed_keys
) < 1) {

280 
w¨nög
("NoÅrusted keys specified");

283 i‡(
	gpkt
) {

284 
	gº£t
 = 
ldns_pkt_º_li°_by_«me_™d_ty≥
(
pkt
,

285 
«me
,

286 
ty≥
,

287 
LDNS_SECTION_ANSWER


289 i‡(!
	gº£t
) {

291 
	gº£t
 = 
ldns_pkt_º_li°_by_«me_™d_ty≥
(
pkt
,

292 
«me
,

293 
ty≥
,

294 
LDNS_SECTION_AUTHORITY


299 i‡(!
	gº£t
) {

300 
	gº£t
 = 
ldns_pkt_º_li°_by_«me_™d_ty≥
(
pkt
,

301 
«me
,

302 
LDNS_RR_TYPE_CNAME
,

303 
LDNS_SECTION_ANSWER


305 i‡(!
	gº£t
) {

307 
	gº£t
 = 
ldns_pkt_º_li°_by_«me_™d_ty≥
(
pkt
,

308 
«me
,

309 
LDNS_RR_TYPE_CNAME
,

310 
LDNS_SECTION_AUTHORITY


316 i‡(
	gvîbosôy
 >= 0) {

317 
Ârötf
(
°dîr
, "%s", 
ldns_gë_îr‹°r_by_id
(
LDNS_STATUS_MEM_ERR
));

318 
Ârötf
(
°dîr
, "\n");

320  
	gLDNS_STATUS_MEM_ERR
;

323 i‡(!
	gº£t
) {

325 
ldns_pkt_‰ì
(
pkt
);

326 
	gpkt
 = 
NULL
;

327 
	gpkt
 = 
ldns_ªsﬁvî_quîy
(
ªs
, 
«me
, 
ty≥
, 
c
, 
qÊags
);

329 i‡(!
	gpkt
) {

330 i‡(
	gvîbosôy
 >= 0) {

331 
Ârötf
(
°dîr
, "%s", 
ldns_gë_îr‹°r_by_id
(
LDNS_STATUS_NETWORK_ERR
));

332 
Ârötf
(
°dîr
, "\n");

334  
	gLDNS_STATUS_NETWORK_ERR
;

336 i‡(
	gvîbosôy
 >= 5) {

337 
ldns_pkt_¥öt
(
°dout
, 
pkt
);

340 
	gº£t
 = 
ldns_pkt_º_li°_by_«me_™d_ty≥
(
pkt
,

341 
«me
,

342 
ty≥
,

343 
LDNS_SECTION_ANSWER


347 
	g‹ig_º
 = 
ldns_º_√w
();

351 i‡(
ldns_pkt_™cou¡
(
pkt
) < 1) {

352 
ldns_º_£t_ty≥
(
‹ig_º
, 
ty≥
);

353 
ldns_º_£t_ow√r
(
‹ig_º
, 
ldns_rdf_˛⁄e
(
«me
));

355 
	gchaö
 = 
ldns_dns£c_buûd_d©a_chaö
(
ªs
, 
qÊags
, 
º£t
, 
pkt
, 
ldns_º_˛⁄e
(
‹ig_º
));

358 
	gchaö
 = 
ldns_dns£c_buûd_d©a_chaö
(
ªs
, 
qÊags
, 
º£t
, 
pkt
, 
NULL
);

361 i‡(
	gvîbosôy
 >= 4) {

362 
¥ötf
("\n\nDNSSEC Data Chain:\n");

363 
ldns_dns£c_d©a_chaö_¥öt
(
°dout
, 
chaö
);

366 
	gªsu…
 = 
LDNS_STATUS_OK
;

368 
	gåì
 = 
ldns_dns£c_dîive_åu°_åì
(
chaö
, 
NULL
);

370 i‡(
	gvîbosôy
 >= 2) {

371 
¥ötf
("\n\nDNSSEC TrustÅree:\n");

372 
ldns_dns£c_åu°_åì_¥öt
(
°dout
, 
åì
, 0, 
åue
);

375 i‡(
ldns_º_li°_º_cou¡
(
åu°ed_keys
) > 0) {

376 
	gåì_ªsu…
 = 
ldns_dns£c_åu°_åì_c⁄èös_keys
(
åì
, 
åu°ed_keys
);

378 i‡(
	gåì_ªsu…
 =
LDNS_STATUS_DNSSEC_EXISTENCE_DENIED
) {

379 i‡(
vîbosôy
 >= 1) {

380 
¥ötf
("Existence denied or verifiably insecure\n");

382 
	gªsu…
 = 
LDNS_STATUS_OK
;

383 } i‡(
	gåì_ªsu…
 !
LDNS_STATUS_OK
) {

384 i‡(
vîbosôy
 >= 1) {

385 
¥ötf
("Nÿåu°ed key†found i¿åì: fú°Éº‹ was: %s\n", 
ldns_gë_îr‹°r_by_id
(
åì_ªsu…
));

387 
	gªsu…
 = 
åì_ªsu…
;

391 i‡(
	gvîbosôy
 >= 0) {

392 
¥ötf
("You haveÇotÖrovidedányÅrusted keys.\n");

396 
ldns_º_‰ì
(
‹ig_º
);

397 
ldns_dns£c_åu°_åì_‰ì
(
åì
);

398 
ldns_dns£c_d©a_chaö_dìp_‰ì
(
chaö
);

400 
ldns_º_li°_dìp_‰ì
(
º£t
);

401 
ldns_pkt_‰ì
(
pkt
);

404  
	gªsu…
;

	@drill/dnssec.c

11 
	~"drûl.h
"

12 
	~<ldns/ldns.h
>

15 
ldns_º_li°
 *

16 
	$gë_º
(
ldns_ªsﬁvî
 *
ªs
, 
ldns_rdf
 *
z«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
)

19 
ldns_pkt
 *
p
;

20 
ldns_º_li°
 *
found
;

22 
p
 = 
	`ldns_pkt_√w
();

23 
found
 = 
NULL
;

25 i‡(
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
z«me
, 
t
, 
c
, 0Ë=
LDNS_STATUS_OK
) {

26 
found
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
t
, 
LDNS_SECTION_ANY_NOQUESTION
);

28 
	`ldns_pkt_‰ì
(
p
);

29  
found
;

30 
	}
}

33 
	$drûl_pkt_¥öt
(
FILE
 *
fd
, 
ldns_ªsﬁvî
 *
r
, 
ldns_pkt
 *
p
)

35 
ldns_º_li°
 *
√w_nss
;

36 
ldns_º_li°
 *
ho°«mes
;

37 *
™swî‰om_°r
;

39 i‡(
vîbosôy
 < 5) {

43 
ho°«mes
 = 
	`ldns_gë_º_li°_«me_by_addr
(
r
, 
	`ldns_pkt_™swî‰om
(
p
), 0, 0);

45 
√w_nss
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

46 
LDNS_RR_TYPE_NS
, 
LDNS_SECTION_ANSWER
);

47 
	`ldns_º_li°_¥öt
(
fd
, 
√w_nss
);

48 
	`ldns_º_li°_dìp_‰ì
(
√w_nss
);

50 
	`Ârötf
(
fd
, ";; Received %d bytes from %s#%d(",

51 (Ë
	`ldns_pkt_size
(
p
),

52 
	`ldns_rdf2°r
(
	`ldns_pkt_™swî‰om
(
p
)),

53 (Ë
	`ldns_ªsﬁvî_p‹t
(
r
));

55 i‡(
ho°«mes
) {

56 
	`ldns_rdf_¥öt
(
fd
,

57 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
ho°«mes
, 0), 0));

58 
	`ldns_º_li°_dìp_‰ì
(
ho°«mes
);

60 
™swî‰om_°r
 = 
	`ldns_rdf2°r
(
	`ldns_pkt_™swî‰om
(
p
));

61 i‡(
™swî‰om_°r
) {

62 
	`Ârötf
(
fd
, "%s", 
™swî‰om_°r
);

63 
	`LDNS_FREE
(
™swî‰om_°r
);

66 
	`Ârötf
(
fd
, "Ëö %u ms\n\n", ()
	`ldns_pkt_quîytime
(
p
));

67 
	}
}

70 
	$drûl_pkt_¥öt_foŸî
(
FILE
 *
fd
, 
ldns_ªsﬁvî
 *
r
, 
ldns_pkt
 *
p
)

72 
ldns_º_li°
 *
ho°«mes
;

73 *
™swî‰om_°r
;

75 i‡(
vîbosôy
 < 5) {

79 
ho°«mes
 = 
	`ldns_gë_º_li°_«me_by_addr
(
r
, 
	`ldns_pkt_™swî‰om
(
p
), 0, 0);

81 
	`Ârötf
(
fd
, ";; Received %d bytes from %s#%d(",

82 (Ë
	`ldns_pkt_size
(
p
),

83 
	`ldns_rdf2°r
(
	`ldns_pkt_™swî‰om
(
p
)),

84 (Ë
	`ldns_ªsﬁvî_p‹t
(
r
));

86 i‡(
ho°«mes
) {

87 
	`ldns_rdf_¥öt
(
fd
,

88 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
ho°«mes
, 0), 0));

89 
	`ldns_º_li°_dìp_‰ì
(
ho°«mes
);

91 
™swî‰om_°r
 = 
	`ldns_rdf2°r
(
	`ldns_pkt_™swî‰om
(
p
));

92 i‡(
™swî‰om_°r
) {

93 
	`Ârötf
(
fd
, "%s", 
™swî‰om_°r
);

94 
	`LDNS_FREE
(
™swî‰om_°r
);

97 
	`Ârötf
(
fd
, "Ëö %u ms\n\n", ()
	`ldns_pkt_quîytime
(
p
));

98 
	}
}

103 
ldns_pkt_ty≥


104 
	$gë_dns£c_º
(
ldns_pkt
 *
p
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
,

105 
ldns_º_li°
 **
ºli°
,Üdns_º_li° **
sig
)

107 
ldns_pkt_ty≥
 
±
 = 
LDNS_PACKET_UNKNOWN
;

108 
ldns_º_li°
 *
sigs
 = 
NULL
;

109 
size_t
 
i
;

111 i‡(!
p
) {

112 i‡(
ºli°
) {

113 *
ºli°
 = 
NULL
;

115  
LDNS_PACKET_UNKNOWN
;

118 
±
 = 
	`ldns_pkt_ª∂y_ty≥
(
p
);

119 i‡(
«me
) {

120 i‡(
ºli°
) {

121 *
ºli°
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
p
, 
«me
, 
t
,

122 
LDNS_SECTION_ANSWER
);

123 i‡(!*
ºli°
) {

124 *
ºli°
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(

125 
p
, 
«me
, 
t
,

126 
LDNS_SECTION_AUTHORITY
);

129 i‡(
sig
) {

130 
sigs
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
p
, 
«me
,

131 
LDNS_RR_TYPE_RRSIG
,

132 
LDNS_SECTION_ANSWER
);

133 i‡(!
sigs
) {

134 
sigs
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(

135 
p
, 
«me
, 
LDNS_RR_TYPE_RRSIG
,

136 
LDNS_SECTION_AUTHORITY
);

141 i‡(
ºli°
) {

142 *
ºli°
 = 
	`ldns_pkt_º_li°_by_ty≥
(

143 
p
, 
t
, 
LDNS_SECTION_AUTHORITY
);

145 i‡(
sig
) {

146 
sigs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

147 
LDNS_RR_TYPE_RRSIG
,

148 
LDNS_SECTION_AUTHORITY
);

151 i‡(
sig
) {

152 *
sig
 = 
	`ldns_º_li°_√w
();

153 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
sigs
); i++) {

155 i‡(
t
 =
	`ldns_rdf2º_ty≥
(
	`ldns_º_ºsig_ty≥covîed
(

156 
	`ldns_º_li°_º
(
sigs
, 
i
)))) {

158 
	`ldns_º_li°_push_º
(*
sig
,

159 
	`ldns_º_˛⁄e
(

160 
	`ldns_º_li°_º
(

161 
sigs
, 
i
)));

165 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

167 i‡(
±
 =
LDNS_PACKET_NXDOMAIN
 ||Öà=
LDNS_PACKET_NODATA
) {

168  
±
;

170  
LDNS_PACKET_ANSWER
;

172 
	}
}

175 
ldns_°©us


176 
	$ldns_vîify_díül
(
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
ty≥
, 
ldns_º_li°
 **
n£c_ºs
,Üdns_º_li° **
n£c_º_sigs
)

178 #ifde‡
HAVE_SSL


179 
uöt16_t
 
n£c_i
;

181 
ldns_º_li°
 *
n£cs
;

182 
ldns_°©us
 
ªsu…
;

184 i‡(
vîbosôy
 >= 5) {

185 
	`¥ötf
("VERIFY DENIAL FROM:\n");

186 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

189 
ªsu…
 = 
LDNS_STATUS_CRYPTO_NO_RRSIG
;

191 
n£cs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
, 
LDNS_RR_TYPE_NSEC
, 
LDNS_SECTION_ANY_NOQUESTION
);

192 i‡(
n£cs
) {

193 
n£c_i
 = 0;Ç£c_ò< 
	`ldns_º_li°_º_cou¡
(
n£cs
);Çsec_i++) {

200 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
n£cs
, 
n£c_i
)), 
«me
) == 0) {

206 i‡(
	`ldns_n£c_bôm≠_covîs_ty≥
(

207 
	`ldns_n£c_gë_bôm≠
(
	`ldns_º_li°_º
(
n£cs
,

208 
n£c_i
)),

209 
ty≥
)) {

211 
ªsu…
 = 
LDNS_STATUS_CRYPTO_NO_RRSIG
;

214 i‡(
vîbosôy
 >= 3) {

215 
	`¥ötf
(";; Existence of data set withÅhisÅype denied by NSEC\n");

218 i‡(
n£c_ºs
 && 
n£c_º_sigs
) {

219 (Ë
	`gë_dns£c_º
(
pkt
, 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
n£cs
, 
n£c_i
)), 
LDNS_RR_TYPE_NSEC
, 
n£c_ºs
, 
n£c_º_sigs
);

221 
	`ldns_º_li°_dìp_‰ì
(
n£cs
);

222  
LDNS_STATUS_OK
;

224 } i‡(
	`ldns_n£c_covîs_«me
(
	`ldns_º_li°_º
(
n£cs
, 
n£c_i
), 
«me
)) {

225 i‡(
vîbosôy
 >= 3) {

226 
	`¥ötf
(";; Existence of data set withÅhisÇame denied by NSEC\n");

228 i‡(
n£c_ºs
 && 
n£c_º_sigs
) {

229 (Ë
	`gë_dns£c_º
(
pkt
, 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
n£cs
, 
n£c_i
)), 
LDNS_RR_TYPE_NSEC
, 
n£c_ºs
, 
n£c_º_sigs
);

231 
	`ldns_º_li°_dìp_‰ì
(
n£cs
);

232  
LDNS_STATUS_OK
;

237 
	`ldns_º_li°_dìp_‰ì
(
n£cs
);

238 } if–(
n£cs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
, 
LDNS_RR_TYPE_NSEC3
, 
LDNS_SECTION_ANY_NOQUESTION
)) ) {

239 
ldns_º_li°
* 
sigs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
, 
LDNS_RR_TYPE_RRSIG
, 
LDNS_SECTION_ANY_NOQUESTION
);

240 
ldns_º
* 
q
 = 
	`ldns_º_√w
();

241 
ldns_º
* 
m©ch
 = 
NULL
;

243 if(!
sigs
) {

244 i‡(
q
) {

245 
	`ldns_º_‰ì
(
q
);

247 
	`ldns_º_li°_dìp_‰ì
(
n£cs
);

248  
LDNS_STATUS_MEM_ERR
;

250 if(!
q
) {

251 
	`ldns_º_li°_dìp_‰ì
(
n£cs
);

252 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

253  
LDNS_STATUS_MEM_ERR
;

255 
	`ldns_º_£t_que°i⁄
(
q
, 1);

256 
	`ldns_º_£t_âl
(
q
, 0);

257 
	`ldns_º_£t_ow√r
(
q
, 
	`ldns_rdf_˛⁄e
(
«me
));

258 if(!
	`ldns_º_ow√r
(
q
)) {

259 
	`ldns_º_‰ì
(
q
);

260 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

261 
	`ldns_º_li°_dìp_‰ì
(
n£cs
);

262  
LDNS_STATUS_MEM_ERR
;

264 
	`ldns_º_£t_ty≥
(
q
, 
ty≥
);

267 
ªsu…
 = 
	`ldns_dns£c_vîify_díül_n£c3_m©ch
(
q
, 
n£cs
, 
sigs
, 
	`ldns_pkt_gë_rcode
(
pkt
), 
ty≥
, 
	`ldns_pkt_™cou¡
’ktË=0, &
m©ch
);

268 i‡(
ªsu…
 =
LDNS_STATUS_OK
 && 
m©ch
 && 
n£c_ºs
 && 
n£c_º_sigs
) {

269 (Ë
	`gë_dns£c_º
(
pkt
, 
	`ldns_º_ow√r
(
m©ch
), 
LDNS_RR_TYPE_NSEC3
, 
n£c_ºs
, 
n£c_º_sigs
);

271 
	`ldns_º_‰ì
(
q
);

272 
	`ldns_º_li°_dìp_‰ì
(
n£cs
);

273 
	`ldns_º_li°_dìp_‰ì
(
sigs
);

275  
ªsu…
;

277 ()
pkt
;

278 ()
«me
;

279 ()
ty≥
;

280 ()
n£c_ºs
;

281 ()
n£c_º_sigs
;

282  
LDNS_STATUS_ERR
;

284 
	}
}

288 
ldns_º
 *

289 
	$ldns_n£c3_exa˘_m©ch
(
ldns_rdf
 *
q«me
, 
ldns_º_ty≥
 
qty≥
, 
ldns_º_li°
 *
n£c3s
) {

290 
uöt8_t
 
Æg‹ôhm
;

291 
uöt32_t
 
ôî©i⁄s
;

292 
uöt8_t
 
ß…_Àngth
;

293 
uöt8_t
 *
ß…
;

295 
ldns_rdf
 *
¢ame
 = 
NULL
, *
hashed_¢ame
 = NULL;

297 
size_t
 
n£c_i
;

298 
ldns_º
 *
n£c
;

299 
ldns_º
 *
ªsu…
 = 
NULL
;

301 c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
;

303 
ldns_rdf
 *
z⁄e_«me
 = 
NULL
;

305 i‡(
vîbosôy
 >= 4) {

306 
	`¥ötf
(";; findingÉxact match for ");

307 
des¸ùt‹
 = 
	`ldns_º_des¸ùt
(
qty≥
);

308 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

309 
	`¥ötf
("%†", 
des¸ùt‹
->
_«me
);

311 
	`¥ötf
("TYPE%d ", 
qty≥
);

313 
	`ldns_rdf_¥öt
(
°dout
, 
q«me
);

314 
	`¥ötf
("\n");

317 i‡(!
q«me
 || !
n£c3s
 || 
	`ldns_º_li°_º_cou¡
(nsec3s) < 1) {

318 i‡(
vîbosôy
 >= 4) {

319 
	`¥ötf
("no qname,Çsec3s orÜistÉmpty\n");

321  
NULL
;

324 
n£c
 = 
	`ldns_º_li°_º
(
n£c3s
, 0);

325 
Æg‹ôhm
 = 
	`ldns_n£c3_Æg‹ôhm
(
n£c
);

326 
ß…_Àngth
 = 
	`ldns_n£c3_ß…_Àngth
(
n£c
);

327 
ß…
 = 
	`ldns_n£c3_ß…_d©a
(
n£c
);

328 
ôî©i⁄s
 = 
	`ldns_n£c3_ôî©i⁄s
(
n£c
);

329 i‡(
ß…
 =
NULL
) {

330 
d⁄e
;

333 
¢ame
 = 
	`ldns_rdf_˛⁄e
(
q«me
);

334 i‡(
¢ame
 =
NULL
) {

335 
d⁄e
;

337 i‡(
vîbosôy
 >= 4) {

338 
	`¥ötf
(";; ownerÇame hashesÅo: ");

340 
hashed_¢ame
 = 
	`ldns_n£c3_hash_«me
(
¢ame
, 
Æg‹ôhm
, 
ôî©i⁄s
, 
ß…_Àngth
, 
ß…
);

341 i‡(
hashed_¢ame
 =
NULL
) {

342 
d⁄e
;

344 
z⁄e_«me
 = 
	`ldns_d«me_À·_ch›
(
	`ldns_º_ow√r
(
n£c
));

345 i‡(
z⁄e_«me
 =
NULL
) {

346 
d⁄e
;

348 i‡(
	`ldns_d«me_ˇt
(
hashed_¢ame
, 
z⁄e_«me
Ë!
LDNS_STATUS_OK
) {

349 
d⁄e
;

352 i‡(
vîbosôy
 >= 4) {

353 
	`ldns_rdf_¥öt
(
°dout
, 
hashed_¢ame
);

354 
	`¥ötf
("\n");

357 
n£c_i
 = 0;Ç£c_ò< 
	`ldns_º_li°_º_cou¡
(
n£c3s
);Çsec_i++) {

358 
n£c
 = 
	`ldns_º_li°_º
(
n£c3s
, 
n£c_i
);

363 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
n£c
), 
hashed_¢ame
) == 0) {

364 
ªsu…
 = 
n£c
;

365 
d⁄e
;

370 
d⁄e
:

371 
	`ldns_rdf_dìp_‰ì
(
z⁄e_«me
);

372 
	`ldns_rdf_dìp_‰ì
(
¢ame
);

373 
	`ldns_rdf_dìp_‰ì
(
hashed_¢ame
);

374 
	`LDNS_FREE
(
ß…
);

376 i‡(
vîbosôy
 >= 4) {

377 i‡(
ªsu…
) {

378 
	`¥ötf
(";; Found.\n");

380 
	`¥ötf
(";; Not foud.\n");

383  
ªsu…
;

384 
	}
}

388 
ldns_rdf
 *

389 
	$ldns_n£c3_˛o£°_í˛o£r
(
ldns_rdf
 *
q«me
, 
ldns_º_ty≥
 
qty≥
, 
ldns_º_li°
 *
n£c3s
)

392 
uöt8_t
 
Æg‹ôhm
;

393 
uöt32_t
 
ôî©i⁄s
;

394 
uöt8_t
 
ß…_Àngth
;

395 
uöt8_t
 *
ß…
;

397 
ldns_rdf
 *
¢ame
 = 
NULL
, *
hashed_¢ame
 = NULL, *
tmp
;

398 
boﬁ
 
Êag
;

400 
boﬁ
 
exa˘_m©ch_found
;

401 
boﬁ
 
ö_ønge_found
;

403 
ldns_rdf
 *
z⁄e_«me
 = 
NULL
;

405 
size_t
 
n£c_i
;

406 
ldns_º
 *
n£c
;

407 
ldns_rdf
 *
ªsu…
 = 
NULL
;

409 i‡(!
q«me
 || !
n£c3s
 || 
	`ldns_º_li°_º_cou¡
(nsec3s) < 1) {

410  
NULL
;

413 i‡(
vîbosôy
 >= 4) {

414 
	`¥ötf
(";; födög clo£°Én˛o£∏f‹Åy≥ %d ", 
qty≥
);

415 
	`ldns_rdf_¥öt
(
°dout
, 
q«me
);

416 
	`¥ötf
("\n");

419 
n£c
 = 
	`ldns_º_li°_º
(
n£c3s
, 0);

420 
Æg‹ôhm
 = 
	`ldns_n£c3_Æg‹ôhm
(
n£c
);

421 
ß…_Àngth
 = 
	`ldns_n£c3_ß…_Àngth
(
n£c
);

422 
ß…
 = 
	`ldns_n£c3_ß…_d©a
(
n£c
);

423 
ôî©i⁄s
 = 
	`ldns_n£c3_ôî©i⁄s
(
n£c
);

424 i‡(
ß…
 =
NULL
) {

425 
d⁄e
;

428 
¢ame
 = 
	`ldns_rdf_˛⁄e
(
q«me
);

429 i‡(
¢ame
 =
NULL
) {

430 
d⁄e
;

433 
Êag
 = 
Ál£
;

435 
z⁄e_«me
 = 
	`ldns_d«me_À·_ch›
(
	`ldns_º_ow√r
(
n£c
));

436 i‡(
z⁄e_«me
 =
NULL
) {

437 
d⁄e
;

441 
	`ldns_d«me_œbñ_cou¡
(
¢ame
) > 0) {

442 
exa˘_m©ch_found
 = 
Ál£
;

443 
ö_ønge_found
 = 
Ál£
;

445 i‡(
vîbosôy
 >= 3) {

446 
	`¥ötf
(";; ");

447 
	`ldns_rdf_¥öt
(
°dout
, 
¢ame
);

448 
	`¥ötf
(" hashesÅo: ");

450 
hashed_¢ame
 = 
	`ldns_n£c3_hash_«me
(
¢ame
, 
Æg‹ôhm
, 
ôî©i⁄s
, 
ß…_Àngth
, 
ß…
);

451 i‡(
hashed_¢ame
 =
NULL
) {

452 
d⁄e
;

455 i‡(
	`ldns_d«me_ˇt
(
hashed_¢ame
, 
z⁄e_«me
Ë!
LDNS_STATUS_OK
){

456 
d⁄e
;

459 i‡(
vîbosôy
 >= 3) {

460 
	`ldns_rdf_¥öt
(
°dout
, 
hashed_¢ame
);

461 
	`¥ötf
("\n");

464 
n£c_i
 = 0;Ç£c_ò< 
	`ldns_º_li°_º_cou¡
(
n£c3s
);Çsec_i++) {

465 
n£c
 = 
	`ldns_º_li°_º
(
n£c3s
, 
n£c_i
);

470 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
n£c
), 
hashed_¢ame
) == 0) {

471 i‡(
vîbosôy
 >= 4) {

472 
	`¥ötf
(";;Éxact match found\n");

474 
exa˘_m©ch_found
 = 
åue
;

475 } i‡(
	`ldns_n£c_covîs_«me
(
n£c
, 
hashed_¢ame
)) {

476 i‡(
vîbosôy
 >= 4) {

477 
	`¥ötf
(";; inÑange ofánÇsec\n");

479 
ö_ønge_found
 = 
åue
;

483 i‡(!
exa˘_m©ch_found
 && 
ö_ønge_found
) {

484 
Êag
 = 
åue
;

485 } i‡(
exa˘_m©ch_found
 && 
Êag
) {

486 
ªsu…
 = 
	`ldns_rdf_˛⁄e
(
¢ame
);

487 } i‡(
exa˘_m©ch_found
 && !
Êag
) {

489 i‡(
vîbosôy
 >= 4) {

490 
	`¥ötf
(";;Åhe closestÉncloser isÅhe sameÇame (ie.Åhis isánÉxact match, ieÅhere isÇo closestÉncloser)\n");

492 
	`ldns_rdf_dìp_‰ì
(
hashed_¢ame
);

493 
d⁄e
;

495 
Êag
 = 
Ál£
;

498 
	`ldns_rdf_dìp_‰ì
(
hashed_¢ame
);

499 
tmp
 = 
¢ame
;

500 
¢ame
 = 
	`ldns_d«me_À·_ch›
(sname);

501 
	`ldns_rdf_dìp_‰ì
(
tmp
);

502 i‡(
¢ame
 =
NULL
) {

503 
d⁄e
;

507 
d⁄e
:

508 
	`LDNS_FREE
(
ß…
);

509 
	`ldns_rdf_dìp_‰ì
(
z⁄e_«me
);

510 
	`ldns_rdf_dìp_‰ì
(
¢ame
);

512 i‡(!
ªsu…
) {

513 i‡(
vîbosôy
 >= 4) {

514 
	`¥ötf
(";;Ço closestÉncloser found\n");

519  
ªsu…
;

520 
	}
}

	@drill/drill.c

10 
	~"drûl.h
"

11 
	~<ldns/ldns.h
>

13 #ifde‡
HAVE_SSL


14 
	~<›ís¶/îr.h
>

17 
	#IP6_ARPA_MAX_LEN
 65

	)

20 
	gvîbosôy
;

23 
	$ußge
(
FILE
 *
°ªam
, c⁄° *
¥og«me
)

25 
	`Ârötf
(
°ªam
, " Ußge: %†«mê[@£rvî] [ty≥] [˛ass]\n", 
¥og«me
);

26 
	`Ârötf
(
°ªam
, "\t<name> can beá domainÇame orán IPáddress (-xÜookups)\n");

27 
	`Ârötf
(
°ªam
, "\t<type> defaultsÅo A\n");

28 
	`Ârötf
(
°ªam
, "\t<class> defaultsÅo IN\n");

29 
	`Ârötf
(
°ªam
, "\n\targuments may beÖlaced inÑandom order\n");

30 
	`Ârötf
(
°ªam
, "\n Options:\n");

31 
	`Ârötf
(
°ªam
, "\t-D\t\tenable DNSSEC (DO bit)\n");

32 #ifde‡
HAVE_SSL


33 
	`Ârötf
(
°ªam
, "\t-T\t\ttrace fromÅheÑoot downÅo <name>\n");

34 
	`Ârötf
(
°ªam
, "\t-S\t\tchase signature(s) from <name>Åoá know key [*]\n");

36 
	`Ârötf
(
°ªam
, "\t-I <address>\tsourceáddressÅo query from\n");

37 
	`Ârötf
(
°ªam
, "\t-V <number>\tverbosity (0-5)\n");

38 
	`Ârötf
(
°ªam
, "\t-Q\t\tquiet mode (overrules -V)\n");

39 
	`Ârötf
(
°ªam
, "\n");

40 
	`Ârötf
(
°ªam
, "\t-f file\t\treadÖacket from fileánd send it\n");

41 
	`Ârötf
(
°ªam
, "\t-i file\t\treadÖacket from fileándÖrint it\n");

42 
	`Ârötf
(
°ªam
, "\t-w file\t\twriteánswerÖacketÅo file\n");

43 
	`Ârötf
(
°ªam
, "\t-q file\t\twrite queryÖacketÅo file\n");

44 
	`Ârötf
(
°ªam
, "\t-h\t\tshowÅhis help\n");

45 
	`Ârötf
(
°ªam
, "\t-v\t\tshow version\n");

46 
	`Ârötf
(
°ªam
, "\n Query options:\n");

47 
	`Ârötf
(
°ªam
, "\t-4\t\tstay on ip4\n");

48 
	`Ârötf
(
°ªam
, "\t-6\t\tstay on ip6\n");

49 
	`Ârötf
(
°ªam
, "\t-a\t\tfallbackÅo EDNS0ánd TCP ifÅheánswer isÅruncated\n");

50 
	`Ârötf
(
°ªam
, "\t-b <bufsize>\tuse <bufsize>ásÅhe buffer size (defaultsÅo 512 b)\n");

51 
	`Ârötf
(
°ªam
, "\t-c <file>\tuse file forÑescursiveÇameserver configuration"

53 
	`Ârötf
(
°ªam
, "\t-k <file>\tspecifyá fileÅhat containsáÅrusted DNSSEC key [**]\n");

54 
	`Ârötf
(
°ªam
, "\t\t\tUsedÅo verifyány signatures inÅhe currentánswer.\n");

55 
	`Ârötf
(
°ªam
, "\t\t\tWhen DNSSECÉnabledÅracing (-TD) or signature\n"

58 
LDNS_TRUST_ANCHOR_FILE
);

59 
	`Ârötf
(
°ªam
, "\t-o <mnemonic>\tset flagsÅo:"

61 
	`Ârötf
(
°ªam
, "\t\t\tlowercase: unset bit, uppercase: set bit\n");

62 
	`Ârötf
(
°ªam
, "\t-p <port>\tuse <port>ásÑemoteÖortÇumber\n");

63 
	`Ârötf
(
°ªam
, "\t-s\t\tshowÅhe DS RR forÉach key ináÖacket\n");

64 
	`Ârötf
(
°ªam
, "\t-u\t\tsendÅhe query with udp (the default)\n");

65 
	`Ârötf
(
°ªam
, "\t-x\t\tdoáÑeverseÜookup\n");

66 
	`Ârötf
(
°ªam
, "\twhen doingá secureÅrace:\n");

67 
	`Ârötf
(
°ªam
, "\t-r <file>\tuse fileásÑoot servers hint file\n");

68 
	`Ârötf
(
°ªam
, "\t-t\t\tsendÅhe query withÅcp (connected)\n");

69 
	`Ârötf
(
°ªam
, "\t-d <domain>\tuse domainásÅhe startÖoint forÅheÅrace\n");

70 
	`Ârötf
(
°ªam
, "\t-y <name:key[:algo]>\tspecifyÇamed base64Åsig key,ánd optionalán\n\t\t\talgorithm (defaultsÅo hmac-md5.sig-alg.reg.int)\n");

71 
	`Ârötf
(
°ªam
, "\t-z\t\tdon'tÑandomizeÅheÇameservers before use\n");

72 
	`Ârötf
(
°ªam
, "\n [*] =Énables/implies DNSSEC\n");

73 
	`Ârötf
(
°ªam
, " [**] = can be given moreÅhan once\n");

74 
	`Ârötf
(
°ªam
, "\nÜdns-team@nlnetlabs.nl | http://www.nlnetlabs.nl/ldns/\n");

75 
	}
}

81 
	$vîsi⁄
(
FILE
 *
°ªam
, c⁄° *
¥og«me
)

83 
	`Ârötf
(
°ªam
, "%†vîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
¥og«me
, 
DRILL_VERSION
, 
	`ldns_vîsi⁄
());

84 
	`Ârötf
(
°ªam
, "Written by NLnet Labs.\n");

85 
	`Ârötf
(
°ªam
, "\nCopyright (c) 2004-2008 NLnet Labs.\n");

86 
	`Ârötf
(
°ªam
, "Licensed underÅheÑevised BSDÜicense.\n");

87 
	`Ârötf
(
°ªam
, "There is NO warranty;ÇotÉven for MERCHANTABILITY or FITNESS\n");

88 
	`Ârötf
(
°ªam
, "FOR A PARTICULAR PURPOSE.\n");

89 
	}
}

97 
	$maö
(
¨gc
, *
¨gv
[])

99 
ldns_ªsﬁvî
 *
ªs
 = 
NULL
;

100 
ldns_ªsﬁvî
 *
cmdlöe_ªs
 = 
NULL
;

101 
ldns_º_li°
 *
cmdlöe_º_li°
 = 
NULL
;

102 
ldns_rdf
 *
cmdlöe_d«me
 = 
NULL
;

103 
ldns_rdf
 *
q«me
, *
q«me_tmp
;

104 
ldns_pkt
 *
pkt
;

105 
ldns_pkt
 *
qpkt
;

106 *
£rv
;

107 *
§c
 = 
NULL
;

108 c⁄° *
«me
;

109 *
«me2
;

110 *
¥og«me
;

111 *
quîy_fûe
 = 
NULL
;

112 *
™swî_fûe
 = 
NULL
;

113 
ldns_buf„r
 *
quîy_buf„r
 = 
NULL
;

114 
ldns_rdf
 *
£rv_rdf
;

115 
ldns_rdf
 *
§c_rdf
 = 
NULL
;

116 
ldns_º_ty≥
 
ty≥
;

117 
ldns_º_˛ass
 
˛as
;

119 
ldns_pkt_›code
 
›code
 = 
LDNS_PACKET_QUERY
;

121 
i
, 
c
;

122 
öt_ty≥
;

123 
öt_˛as
;

124 
PURPOSE
;

125 *
tsig_«me
 = 
NULL
;

126 *
tsig_d©a
 = 
NULL
;

127 *
tsig_Æg‹ôhm
 = 
NULL
;

128 
size_t
 
tsig_£∑øt‹
;

129 
size_t
 
tsig_£∑øt‹2
;

130 
ldns_º
 *
ax‰_º
;

131 
ldns_°©us
 
°©us
;

132 *
ty≥_°r
;

135 
ldns_º_li°
 *
key_li°
 = 
	`ldns_º_li°_√w
();

137 
ldns_º_li°
 *
key_vîifõd
;

140 
uöt16_t
 
qÊags
;

141 
uöt16_t
 
qbuf
;

142 
uöt16_t
 
qp‹t
;

143 
uöt8_t
 
qÁmûy
;

144 
boﬁ
 
qdns£c
;

145 
boﬁ
 
qÁŒback
;

146 
boﬁ
 
qds
;

147 
boﬁ
 
qu£vc
;

148 
boﬁ
 
qøndom
;

150 *
ªsﬁv_c⁄f_fûe
 = 
NULL
;

152 
ldns_rdf
 *
åa˚_°¨t_«me
 = 
NULL
;

154 
ªsu…
 = 0;

156 #ifde‡
USE_WINSOCK


157 
r
;

158 
WSADATA
 
wß_d©a
;

161 
öt_ty≥
 = -1; 
£rv
 = 
NULL
; 
ty≥
 = 0;

162 
öt_˛as
 = -1; 
«me
 = 
NULL
; 
˛as
 = 0;

163 
q«me
 = 
NULL
; 
§c
 = NULL;

164 
¥og«me
 = 
	`°rdup
(
¨gv
[0]);

166 #ifde‡
USE_WINSOCK


167 
r
 = 
	`WSASèπup
(
	`MAKEWORD
(2,2), &
wß_d©a
);

168 if(
r
 != 0) {

169 
	`¥ötf
("Faûed WSASèπup: %d\n", 
r
);

170 
ªsu…
 = 
EXIT_FAILURE
;

171 
exô
;

176 
PURPOSE
 = 
DRILL_QUERY
;

177 
qÊags
 = 
LDNS_RD
;

178 
qp‹t
 = 
LDNS_PORT
;

179 
vîbosôy
 = 2;

180 
qdns£c
 = 
Ál£
;

181 
qÁmûy
 = 
LDNS_RESOLV_INETANY
;

182 
qÁŒback
 = 
Ál£
;

183 
qds
 = 
Ál£
;

184 
qbuf
 = 0;

185 
qu£vc
 = 
Ál£
;

186 
qøndom
 = 
åue
;

187 
key_vîifõd
 = 
NULL
;

189 
	`ldns_öô_øndom
(
NULL
, 0);

191 i‡(
¨gc
 == 0) {

192 
	`ußge
(
°dout
, 
¥og«me
);

193 
ªsu…
 = 
EXIT_FAILURE
;

194 
exô
;

201 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "46ab:c:d:Df:hi:I:k:o:p:q:Qr:sStTuvV:w:xy:z")) != -1) {

202 
c
) {

205 
qÁmûy
 = 
LDNS_RESOLV_INET
;

208 
qÁmûy
 = 
LDNS_RESOLV_INET6
;

211 
qdns£c
 = 
åue
;

214 
§c
 = 
›èrg
;

217 i‡(
PURPOSE
 =
DRILL_CHASE
) {

218 
	`Ârötf
(
°dîr
, "-Tánd -S cannot be usedátÅhe sameÅime.\n");

219 
	`exô
(
EXIT_FAILURE
);

221 
PURPOSE
 = 
DRILL_TRACE
;

223 #ifde‡
HAVE_SSL


225 i‡(
PURPOSE
 =
DRILL_TRACE
) {

226 
	`Ârötf
(
°dîr
, "-Tánd -S cannot be usedátÅhe sameÅime.\n");

227 
	`exô
(
EXIT_FAILURE
);

229 
PURPOSE
 = 
DRILL_CHASE
;

233 i‡(
	`°πok
(
›èrg
, "0123456789"Ë!
NULL
) {

234 
	`Ârötf
(
°dîr
, "-VÉxpectsánÇumberásánárgument.\n");

235 
	`exô
(
EXIT_FAILURE
);

237 
vîbosôy
 = 
	`©oi
(
›èrg
);

240 
vîbosôy
 = -1;

243 
quîy_fûe
 = 
›èrg
;

246 
™swî_fûe
 = 
›èrg
;

247 
PURPOSE
 = 
DRILL_AFROMFILE
;

250 
™swî_fûe
 = 
›èrg
;

253 
quîy_fûe
 = 
›èrg
;

254 
PURPOSE
 = 
DRILL_QTOFILE
;

257 i‡(
globÆ_dns_roŸ
) {

258 
	`Ârötf
(
°dîr
, "There wasálreadyá series ofÑoot servers set\n");

259 
	`exô
(
EXIT_FAILURE
);

261 
globÆ_dns_roŸ
 = 
	`ªad_roŸ_höts
(
›èrg
);

262 i‡(!
globÆ_dns_roŸ
) {

263 
	`Ârötf
(
°dîr
, "U«bÀÅÿªadÑoŸ höt†fûê%s,áb‹tög\n", 
›èrg
);

264 
	`exô
(
EXIT_FAILURE
);

269 
qÁŒback
 = 
åue
;

272 
qbuf
 = (
uöt16_t
)
	`©oi
(
›èrg
);

273 i‡(
qbuf
 == 0) {

274 
	`îr‹
("%s", "<bufsize> couldÇot be converted");

278 
ªsﬁv_c⁄f_fûe
 = 
›èrg
;

281 
qu£vc
 = 
åue
;

284 
°©us
 = 
	`ªad_key_fûe
(
›èrg
,

285 
key_li°
, 
Ál£
);

286 i‡(
°©us
 !
LDNS_STATUS_OK
) {

287 
	`îr‹
("CouldÇŸÖ¨£Åhêkey fûê%s: %s", 
›èrg
, 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

289 
qdns£c
 = 
åue
;

293 i‡(
	`°r°r
(
›èrg
, "QR")) {

294 
	`DRILL_ON
(
qÊags
, 
LDNS_QR
);

296 i‡(
	`°r°r
(
›èrg
, "qr")) {

297 
	`DRILL_OFF
(
qÊags
, 
LDNS_QR
);

299 i‡(
	`°r°r
(
›èrg
, "AA")) {

300 
	`DRILL_ON
(
qÊags
, 
LDNS_AA
);

302 i‡(
	`°r°r
(
›èrg
, "aa")) {

303 
	`DRILL_OFF
(
qÊags
, 
LDNS_AA
);

305 i‡(
	`°r°r
(
›èrg
, "TC")) {

306 
	`DRILL_ON
(
qÊags
, 
LDNS_TC
);

308 i‡(
	`°r°r
(
›èrg
, "tc")) {

309 
	`DRILL_OFF
(
qÊags
, 
LDNS_TC
);

311 i‡(
	`°r°r
(
›èrg
, "RD")) {

312 
	`DRILL_ON
(
qÊags
, 
LDNS_RD
);

314 i‡(
	`°r°r
(
›èrg
, "rd")) {

315 
	`DRILL_OFF
(
qÊags
, 
LDNS_RD
);

317 i‡(
	`°r°r
(
›èrg
, "CD")) {

318 
	`DRILL_ON
(
qÊags
, 
LDNS_CD
);

320 i‡(
	`°r°r
(
›èrg
, "cd")) {

321 
	`DRILL_OFF
(
qÊags
, 
LDNS_CD
);

323 i‡(
	`°r°r
(
›èrg
, "RA")) {

324 
	`DRILL_ON
(
qÊags
, 
LDNS_RA
);

326 i‡(
	`°r°r
(
›èrg
, "ra")) {

327 
	`DRILL_OFF
(
qÊags
, 
LDNS_RA
);

329 i‡(
	`°r°r
(
›èrg
, "AD")) {

330 
	`DRILL_ON
(
qÊags
, 
LDNS_AD
);

332 i‡(
	`°r°r
(
›èrg
, "ad")) {

333 
	`DRILL_OFF
(
qÊags
, 
LDNS_AD
);

337 
qp‹t
 = (
uöt16_t
)
	`©oi
(
›èrg
);

338 i‡(
qp‹t
 == 0) {

339 
	`îr‹
("%s", "<port> couldÇot be converted");

343 
qds
 = 
åue
;

346 
qu£vc
 = 
Ál£
;

349 
	`vîsi⁄
(
°dout
, 
¥og«me
);

350 
ªsu…
 = 
EXIT_SUCCESS
;

351 
exô
;

353 
PURPOSE
 = 
DRILL_REVERSE
;

356 #ifde‡
HAVE_SSL


357 i‡(
	`°rchr
(
›èrg
, ':')) {

358 
tsig_£∑øt‹
 = (
size_t
Ë(
	`°rchr
(
›èrg
, ':') - optarg);

359 i‡(
	`°rchr
(
›èrg
 + 
tsig_£∑øt‹
 + 1, ':')) {

360 
tsig_£∑øt‹2
 = (
size_t
Ë(
	`°rchr
(
›èrg
 + 
tsig_£∑øt‹
 + 1, ':') - optarg);

361 
tsig_Æg‹ôhm
 = 
	`xmÆloc
(
	`°æí
(
›èrg
Ë- 
tsig_£∑øt‹2
);

362 
	`°∫˝y
(
tsig_Æg‹ôhm
, 
›èrg
 + 
tsig_£∑øt‹2
 + 1, 
	`°æí
(optarg) -Åsig_separator2);

363 
tsig_Æg‹ôhm
[
	`°æí
(
›èrg
Ë- 
tsig_£∑øt‹2
 - 1] = '\0';

365 
tsig_£∑øt‹2
 = 
	`°æí
(
›èrg
);

366 
tsig_Æg‹ôhm
 = 
	`xmÆloc
(26);

367 
	`°∫˝y
(
tsig_Æg‹ôhm
, "hmac-md5.sig-alg.reg.int.", 25);

368 
tsig_Æg‹ôhm
[25] = '\0';

370 
tsig_«me
 = 
	`xmÆloc
(
tsig_£∑øt‹
 + 1);

371 
tsig_d©a
 = 
	`xmÆloc
(
tsig_£∑øt‹2
 - 
tsig_£∑øt‹
);

372 
	`°∫˝y
(
tsig_«me
, 
›èrg
, 
tsig_£∑øt‹
);

373 
	`°∫˝y
(
tsig_d©a
, 
›èrg
 + 
tsig_£∑øt‹
 + 1, 
tsig_£∑øt‹2
 -Åsig_separator - 1);

375 
tsig_«me
[
tsig_£∑øt‹
] = '\0';

376 
tsig_d©a
[ 
tsig_£∑øt‹2
 - 
tsig_£∑øt‹
 - 1] = '\0';

379 
	`Ârötf
(
°dîr
, "TSIGÑequested, but SSL isÇot supported\n");

380 
ªsu…
 = 
EXIT_FAILURE
;

381 
exô
;

385 
qøndom
 = 
Ál£
;

388 
åa˚_°¨t_«me
 = 
	`ldns_d«me_√w_‰m_°r
(
›èrg
);

389 i‡(!
åa˚_°¨t_«me
) {

390 
	`Ârötf
(
°dîr
, "U«bÀÅÿ∑r£árgumíàf‹ -%c\n", 
c
);

391 
ªsu…
 = 
EXIT_FAILURE
;

392 
exô
;

396 
	`vîsi⁄
(
°dout
, 
¥og«me
);

397 
	`ußge
(
°dout
, 
¥og«me
);

398 
ªsu…
 = 
EXIT_SUCCESS
;

399 
exô
;

402 
	`Ârötf
(
°dîr
, "Unknow¿¨gumít: -%c, u£ -hÅÿ£êußge\n", 
c
);

403 
ªsu…
 = 
EXIT_FAILURE
;

404 
exô
;

407 
¨gc
 -
›töd
;

408 
¨gv
 +
›töd
;

410 i‡((
PURPOSE
 =
DRILL_CHASE
 || (PURPOSE =
DRILL_TRACE
 && 
qdns£c
)) &&

411 
	`ldns_º_li°_º_cou¡
(
key_li°
) == 0) {

413 (Ë
	`ªad_key_fûe
(
LDNS_TRUST_ANCHOR_FILE
, 
key_li°
, 
åue
);

415 i‡(
	`ldns_º_li°_º_cou¡
(
key_li°
) > 0) {

416 
	`¥ötf
(";; Number ofÅrusted keys: %d\n",

417 (Ë
	`ldns_º_li°_º_cou¡
(
key_li°
));

420 i‡(
PURPOSE
 =
DRILL_TRACE
 && 
qdns£c
) {

421 #ifde‡
HAVE_SSL


422 i‡(
	`ldns_º_li°_º_cou¡
(
key_li°
) == 0) {

423 
	`w¨nög
("%s", "NoÅrusted keys were given. WillÇot beábleÅo verifyáuthenticity!");

425 
PURPOSE
 = 
DRILL_SECTRACE
;

427 
	`Ârötf
(
°dîr
, "ldns hasÇot been compiled with OpenSSL support. SecureÅraceÇotávailable\n");

428 
	`exô
(1);

434 
i
 = 0; i < 
¨gc
; i++) {

437 i‡(
¨gv
[
i
][0] == '@') {

438 i‡(
	`°æí
(
¨gv
[
i
]) == 1) {

439 
	`w¨nög
("%s", "NoÇameserver given");

440 
	`exô
(
EXIT_FAILURE
);

442 
£rv
 = 
¨gv
[
i
] + 1;

446 i‡(
	`°rchr
(
¨gv
[
i
], '.')) {

447 
«me
 = 
¨gv
[
i
];

451 i‡(
öt_ty≥
 == -1) {

452 
ty≥
 = 
	`ldns_gë_º_ty≥_by_«me
(
¨gv
[
i
]);

453 i‡(
ty≥
 != 0) {

454 
öt_ty≥
 = 0;

459 i‡(
öt_˛as
 == -1) {

460 
˛as
 = 
	`ldns_gë_º_˛ass_by_«me
(
¨gv
[
i
]);

461 i‡(
˛as
 != 0) {

462 
öt_˛as
 = 0;

467 
«me
 = 
¨gv
[
i
];

470 i‡(!
«me
) {

471 
«me
 = ".";

472 
öt_ty≥
 = 0;

473 
ty≥
 = 
LDNS_RR_TYPE_NS
;

477 i‡(
öt_˛as
 == -1) {

478 
˛as
 = 
LDNS_RR_CLASS_IN
;

480 i‡(
öt_ty≥
 == -1) {

481 i‡(
PURPOSE
 !
DRILL_REVERSE
) {

482 
ty≥
 = 
LDNS_RR_TYPE_A
;

484 
ty≥
 = 
LDNS_RR_TYPE_PTR
;

488 i‡(
§c
) {

489 
§c_rdf
 = 
	`ldns_rdf_√w_addr_‰m_°r
(
§c
);

490 if(!
§c_rdf
) {

491 
	`Ârötf
(
°dîr
, "-I must be (orÑesolve)Åoá valid IP[v6]áddress.\n");

492 
	`exô
(
EXIT_FAILURE
);

497 i‡(!
£rv
) {

499 
°©us
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
ªs
, 
ªsﬁv_c⁄f_fûe
);

500 i‡(
°©us
 !
LDNS_STATUS_OK
) {

501 
	`w¨nög
("CouldÇot createáÑesolver structure: %s (%s)\n"

503 
	`ldns_gë_îr‹°r_by_id
(
°©us
), 
ªsﬁv_c⁄f_fûe
);

504 
ªsu…
 = 
EXIT_FAILURE
;

505 
exô
;

508 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

509 i‡(!
ªs
 || 
	`°æí
(
£rv
) <= 0) {

510 
	`w¨nög
("CouldÇot createáÑesolver structure");

511 
ªsu…
 = 
EXIT_FAILURE
;

512 
exô
;

515 
£rv_rdf
 = 
	`ldns_rdf_√w_addr_‰m_°r
(
£rv
);

516 i‡(!
£rv_rdf
) {

518 
°©us
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
cmdlöe_ªs
, 
ªsﬁv_c⁄f_fûe
);

520 i‡(
°©us
 !
LDNS_STATUS_OK
) {

521 
	`îr‹
("%s", "@server ip couldÇot be converted");

523 
	`ldns_ªsﬁvî_£t_dns£c
(
cmdlöe_ªs
, 
qdns£c
);

524 
	`ldns_ªsﬁvî_£t_ù6
(
cmdlöe_ªs
, 
qÁmûy
);

525 
	`ldns_ªsﬁvî_£t_ÁŒback
(
cmdlöe_ªs
, 
qÁŒback
);

526 
	`ldns_ªsﬁvî_£t_u£vc
(
cmdlöe_ªs
, 
qu£vc
);

527 
	`ldns_ªsﬁvî_£t_sour˚
(
cmdlöe_ªs
, 
§c_rdf
);

529 
cmdlöe_d«me
 = 
	`ldns_d«me_√w_‰m_°r
(
£rv
);

531 
cmdlöe_º_li°
 = 
	`ldns_gë_º_li°_addr_by_«me
(

532 
cmdlöe_ªs
,

533 
cmdlöe_d«me
,

534 
LDNS_RR_CLASS_IN
,

535 
qÊags
);

536 
	`ldns_rdf_dìp_‰ì
(
cmdlöe_d«me
);

537 i‡(!
cmdlöe_º_li°
) {

539 
	`îr‹
("%†`%s\'", "couldÇŸ födányáddªs†f‹Åhê«me:", 
£rv
);

541 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(

542 
ªs
,

543 
cmdlöe_º_li°


544 Ë!
LDNS_STATUS_OK
) {

545 
	`îr‹
("%s", "pushingÇameserver");

549 i‡(
	`ldns_ªsﬁvî_push_«me£rvî
(
ªs
, 
£rv_rdf
Ë!
LDNS_STATUS_OK
) {

550 
	`îr‹
("%s", "pushingÇameserver");

552 
	`ldns_rdf_dìp_‰ì
(
£rv_rdf
);

557 
	`ldns_ªsﬁvî_£t_p‹t
(
ªs
, 
qp‹t
);

558 
	`ldns_ªsﬁvî_£t_sour˚
(
ªs
, 
§c_rdf
);

559 i‡(
vîbosôy
 >= 5) {

560 
	`ldns_ªsﬁvî_£t_debug
(
ªs
, 
åue
);

562 
	`ldns_ªsﬁvî_£t_debug
(
ªs
, 
Ál£
);

564 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
, 
qdns£c
);

566 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
, 
qÁmûy
);

567 
	`ldns_ªsﬁvî_£t_ÁŒback
(
ªs
, 
qÁŒback
);

568 
	`ldns_ªsﬁvî_£t_u£vc
(
ªs
, 
qu£vc
);

569 
	`ldns_ªsﬁvî_£t_øndom
(
ªs
, 
qøndom
);

570 i‡(
qbuf
 != 0) {

571 
	`ldns_ªsﬁvî_£t_edns_udp_size
(
ªs
, 
qbuf
);

574 i‡(!
«me
 &&

575 
PURPOSE
 !
DRILL_AFROMFILE
 &&

576 !
quîy_fûe


578 
	`ußge
(
°dout
, 
¥og«me
);

579 
ªsu…
 = 
EXIT_FAILURE
;

580 
exô
;

583 i‡(
tsig_«me
 && 
tsig_d©a
) {

584 
	`ldns_ªsﬁvî_£t_tsig_key«me
(
ªs
, 
tsig_«me
);

585 
	`ldns_ªsﬁvî_£t_tsig_keyd©a
(
ªs
, 
tsig_d©a
);

586 
	`ldns_ªsﬁvî_£t_tsig_Æg‹ôhm
(
ªs
, 
tsig_Æg‹ôhm
);

590 
PURPOSE
) {

591 
DRILL_TRACE
:

593 i‡(!
globÆ_dns_roŸ
) {

594 
	`öô_roŸ
();

596 
q«me
 = 
	`ldns_d«me_√w_‰m_°r
(
«me
);

597 i‡(!
q«me
) {

598 
	`îr‹
("%s", "parsing queryÇame");

601 ()
	`do_åa˚
(
ªs
, 
q«me
, 
ty≥
, 
˛as
);

602 
	`˛ór_roŸ
();

604 
DRILL_SECTRACE
:

606 i‡(!
globÆ_dns_roŸ
) {

607 
	`öô_roŸ
();

609 
q«me
 = 
	`ldns_d«me_√w_‰m_°r
(
«me
);

610 i‡(!
q«me
) {

611 
	`îr‹
("%s", "making qname");

614 #ifde‡
HAVE_SSL


615 
ªsu…
 = 
	`do_£cuª_åa˚
(
ªs
, 
q«me
, 
ty≥
, 
˛as
, 
key_li°
, 
åa˚_°¨t_«me
);

617 
	`˛ór_roŸ
();

619 
DRILL_CHASE
:

620 
q«me
 = 
	`ldns_d«me_√w_‰m_°r
(
«me
);

621 i‡(!
q«me
) {

622 
	`îr‹
("%s", "making qname");

625 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
, 
åue
);

626 
	`ldns_ªsﬁvî_£t_dns£c_cd
(
ªs
, 
åue
);

628 
	`ldns_ªsﬁvî_£t_edns_udp_size
(
ªs
, 4096);

629 
pkt
 = 
NULL
;

630 
°©us
 = 
	`ldns_ªsﬁvî_quîy_°©us
(

631 &
pkt
, 
ªs
, 
q«me
, 
ty≥
, 
˛as
, 
qÊags
);

632 i‡(
°©us
 !
LDNS_STATUS_OK
) {

633 
	`îr‹
("error sending query: %s",

634 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

636 i‡(!
pkt
) {

637 i‡(
°©us
 =
LDNS_STATUS_OK
) {

638 
	`îr‹
("%s", "errorÖkt sending");

640 
ªsu…
 = 
EXIT_FAILURE
;

642 i‡(
vîbosôy
 >= 3) {

643 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

646 i‡(!
	`ldns_pkt_™swî
(
pkt
)) {

647 
	`mesg
("Noánswer inÖacket");

649 #ifde‡
HAVE_SSL


650 
	`ldns_ªsﬁvî_£t_dns£c_™ch‹s
(
ªs
, 
	`ldns_º_li°_˛⁄e
(
key_li°
));

651 
ªsu…
 = 
	`do_cha£
(
ªs
, 
q«me
, 
ty≥
,

652 
˛as
, 
key_li°
,

653 
pkt
, 
qÊags
, 
NULL
,

654 
vîbosôy
);

655 i‡(
ªsu…
 =
LDNS_STATUS_OK
) {

656 i‡(
vîbosôy
 != -1) {

657 
	`mesg
("Chase successful");

659 
ªsu…
 = 0;

661 i‡(
vîbosôy
 != -1) {

662 
	`mesg
("Chase failed.");

667 
	`ldns_pkt_‰ì
(
pkt
);

670 
DRILL_AFROMFILE
:

671 
pkt
 = 
	`ªad_hex_pkt
(
™swî_fûe
);

672 i‡(
pkt
) {

673 i‡(
vîbosôy
 != -1) {

674 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

676 
	`ldns_pkt_‰ì
(
pkt
);

680 
DRILL_QTOFILE
:

681 
q«me
 = 
	`ldns_d«me_√w_‰m_°r
(
«me
);

682 i‡(!
q«me
) {

683 
	`îr‹
("%s", "making qname");

686 
°©us
 = 
	`ldns_ªsﬁvî_¥ï¨e_quîy_pkt
(&
qpkt
, 
ªs
, 
q«me
, 
ty≥
, 
˛as
, 
qÊags
);

687 if(
°©us
 !
LDNS_STATUS_OK
) {

688 
	`îr‹
("%s", "making query: %s",

689 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

691 
	`dump_hex
(
qpkt
, 
quîy_fûe
);

692 
	`ldns_pkt_‰ì
(
qpkt
);

694 
DRILL_NSEC
:

696 
DRILL_REVERSE
:

698 i‡(
	`°rchr
(
«me
, ':')) {

699 i‡(
	`°rchr
(
«me
, '.')) {

700 
	`îr‹
("SyntaxÉrror: both '.'ánd ':' seen ináddress\n");

702 
«me2
 = 
	`mÆloc
(
IP6_ARPA_MAX_LEN
 + 20);

703 
c
 = 0;

704 
i
=0; i<()
	`°æí
(
«me
); i++) {

705 i‡(
i
 >
IP6_ARPA_MAX_LEN
) {

706 
	`îr‹
("%s", "reverseárgumentÅoÜong");

708 i‡(
«me
[
i
] == ':') {

709 i‡(
i
 < (Ë
	`°æí
(
«me
) &&Çame[i + 1] == ':') {

710 
	`îr‹
("%s", "::Çot supported (yet)");

712 i‡(
i
 + 2 =(Ë
	`°æí
(
«me
) ||Çame[i + 2] == ':') {

713 
«me2
[
c
++] = '0';

714 
«me2
[
c
++] = '.';

715 
«me2
[
c
++] = '0';

716 
«me2
[
c
++] = '.';

717 
«me2
[
c
++] = '0';

718 
«me2
[
c
++] = '.';

719 } i‡(
i
 + 3 =(Ë
	`°æí
(
«me
) ||Çame[i + 3] == ':') {

720 
«me2
[
c
++] = '0';

721 
«me2
[
c
++] = '.';

722 
«me2
[
c
++] = '0';

723 
«me2
[
c
++] = '.';

724 } i‡(
i
 + 4 =(Ë
	`°æí
(
«me
) ||Çame[i + 4] == ':') {

725 
«me2
[
c
++] = '0';

726 
«me2
[
c
++] = '.';

730 
«me2
[
c
++] = 
«me
[
i
];

731 
«me2
[
c
++] = '.';

734 
«me2
[
c
++] = '\0';

736 
q«me
 = 
	`ldns_d«me_√w_‰m_°r
(
«me2
);

737 
q«me_tmp
 = 
	`ldns_d«me_ªvî£
(
q«me
);

738 
	`ldns_rdf_dìp_‰ì
(
q«me
);

739 
q«me
 = 
q«me_tmp
;

740 
q«me_tmp
 = 
	`ldns_d«me_√w_‰m_°r
("ip6.arpa.");

741 
°©us
 = 
	`ldns_d«me_ˇt
(
q«me
, 
q«me_tmp
);

742 i‡(
°©us
 !
LDNS_STATUS_OK
) {

743 
	`îr‹
("%s", "couldÇŸ cª©êªvî£áddªs†f‹ ip6: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

745 
	`ldns_rdf_dìp_‰ì
(
q«me_tmp
);

747 
	`‰ì
(
«me2
);

749 
q«me
 = 
	`ldns_d«me_√w_‰m_°r
(
«me
);

750 
q«me_tmp
 = 
	`ldns_d«me_ªvî£
(
q«me
);

751 
	`ldns_rdf_dìp_‰ì
(
q«me
);

752 
q«me
 = 
q«me_tmp
;

753 
q«me_tmp
 = 
	`ldns_d«me_√w_‰m_°r
("in-addr.arpa.");

754 
°©us
 = 
	`ldns_d«me_ˇt
(
q«me
, 
q«me_tmp
);

755 i‡(
°©us
 !
LDNS_STATUS_OK
) {

756 
	`îr‹
("%s", "couldÇŸ cª©êªvî£áddªs†f‹ ip4: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

758 
	`ldns_rdf_dìp_‰ì
(
q«me_tmp
);

760 i‡(!
q«me
) {

761 
	`îr‹
("%s", "-x impliesán ipáddress");

765 
pkt
 = 
NULL
;

766 
°©us
 = 
	`ldns_ªsﬁvî_quîy_°©us
(

767 &
pkt
, 
ªs
, 
q«me
, 
ty≥
, 
˛as
, 
qÊags
);

768 i‡(
°©us
 !
LDNS_STATUS_OK
) {

769 
	`îr‹
("error sending query: %s",

770 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

772 i‡(!
pkt
) {

773 i‡(
°©us
 =
LDNS_STATUS_OK
) {

774 
	`îr‹
("%s", "pkt sending");

776 
ªsu…
 = 
EXIT_FAILURE
;

778 i‡(
vîbosôy
 != -1) {

779 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

781 
	`ldns_pkt_‰ì
(
pkt
);

784 
DRILL_QUERY
:

786 i‡(
quîy_fûe
) {

792 
qpkt
 = 
	`ªad_hex_pkt
(
quîy_fûe
);

793 i‡(
qpkt
) {

794 
°©us
 = 
	`ldns_ªsﬁvî_£nd_pkt
(&
pkt
, 
ªs
, 
qpkt
);

795 i‡(
°©us
 !
LDNS_STATUS_OK
) {

796 
	`¥ötf
("Eº‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

797 
	`exô
(1);

801 
pkt
 = 
NULL
;

804 
quîy_buf„r
 = 
	`ªad_hex_buf„r
(
quîy_fûe
);

805 i‡(
quîy_buf„r
) {

806 
°©us
 = 
	`ldns_£nd_buf„r
(&
pkt
, 
ªs
, 
quîy_buf„r
, 
NULL
);

807 
	`ldns_buf„r_‰ì
(
quîy_buf„r
);

808 i‡(
°©us
 !
LDNS_STATUS_OK
) {

809 
	`¥ötf
("Eº‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

810 
	`exô
(1);

813 
	`¥ötf
("NO BUFFER\n");

814 
pkt
 = 
NULL
;

817 
q«me
 = 
	`ldns_d«me_√w_‰m_°r
(
«me
);

818 i‡(!
q«me
) {

819 
	`îr‹
("%s", "error in making qname");

822 i‡(
ty≥
 =
LDNS_RR_TYPE_AXFR
) {

823 
°©us
 = 
	`ldns_ax‰_°¨t
(
ªs
, 
q«me
, 
˛as
);

824 if(
°©us
 !
LDNS_STATUS_OK
) {

825 
	`îr‹
("Error startingáxfr: %s",

826 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

828 
ax‰_º
 = 
	`ldns_ax‰_√xt
(
ªs
);

829 if(!
ax‰_º
) {

830 
	`Ârötf
(
°dîr
, "AXFR failed.\n");

831 
	`ldns_pkt_¥öt
(
°dout
,

832 
	`ldns_ax‰_œ°_pkt
(
ªs
));

833 
exô
;

835 
ax‰_º
) {

836 i‡(
vîbosôy
 != -1) {

837 
	`ldns_º_¥öt
(
°dout
, 
ax‰_º
);

839 
	`ldns_º_‰ì
(
ax‰_º
);

840 
ax‰_º
 = 
	`ldns_ax‰_√xt
(
ªs
);

843 
exô
;

846 
pkt
 = 
NULL
;

847 
°©us
 = 
	`ldns_ªsﬁvî_quîy_°©us
(

848 &
pkt
, 
ªs
, 
q«me
,

849 
ty≥
, 
˛as
, 
qÊags
);

850 i‡(
°©us
 !
LDNS_STATUS_OK
) {

851 
	`îr‹
("error sending query: %s"

852 , 
	`ldns_gë_îr‹°r_by_id
(

853 
°©us
));

858 i‡(!
pkt
) {

859 
	`mesg
("NoÖacketÑeceived");

860 
ªsu…
 = 
EXIT_FAILURE
;

862 i‡(
vîbosôy
 != -1) {

863 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

864 i‡(
	`ldns_pkt_tc
(
pkt
)) {

865 
	`Ârötf
(
°dout
,

867 
	`Ârötf
(
°dout
,

871 i‡(
qds
) {

872 i‡(
vîbosôy
 != -1) {

873 
	`¥öt_ds_of_keys
(
pkt
);

874 
	`¥ötf
("\n");

878 i‡(
	`ldns_º_li°_º_cou¡
(
key_li°
) > 0) {

880 
ldns_º_li°
 *
º£t_vîifõd
;

881 
uöt16_t
 
key_cou¡
;

883 
º£t_vîifõd
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(

884 
pkt
, 
q«me
, 
ty≥
,

885 
LDNS_SECTION_ANY_NOQUESTION
);

887 i‡(
ty≥
 =
LDNS_RR_TYPE_ANY
) {

892 i‡(
vîbosôy
 != -1) {

893 
	`¥ötf
("; ");

894 
	`ldns_º_li°_¥öt
(
°dout
, 
º£t_vîifõd
);

898 #ifde‡
HAVE_SSL


899 
key_vîifõd
 = 
	`ldns_º_li°_√w
();

900 
ªsu…
 = 
	`ldns_pkt_vîify
(
pkt
, 
ty≥
, 
q«me
, 
key_li°
, 
NULL
, 
key_vîifõd
);

902 i‡(
ªsu…
 =
LDNS_STATUS_ERR
) {

904 
ªsu…
 = 
	`ldns_vîify_díül
(
pkt
, 
q«me
, 
ty≥
, 
NULL
, NULL);

905 i‡(
ªsu…
 =
LDNS_STATUS_OK
) {

906 i‡(
vîbosôy
 != -1) {

907 
	`¥ötf
("Existence denied for ");

908 
	`ldns_rdf_¥öt
(
°dout
, 
q«me
);

909 
ty≥_°r
 = 
	`ldns_º_ty≥2°r
(
ty≥
);

910 
	`¥ötf
("\t%s\n", 
ty≥_°r
);

911 
	`LDNS_FREE
(
ty≥_°r
);

914 i‡(
vîbosôy
 != -1) {

915 
	`¥ötf
("Bad data; RR forÇameánd "

921 } i‡(
ªsu…
 =
LDNS_STATUS_OK
) {

922 
key_cou¡
 = 0; key_cou¡ < 
	`ldns_º_li°_º_cou¡
(
key_vîifõd
);

923 
key_cou¡
++) {

924 i‡(
vîbosôy
 != -1) {

925 
	`¥ötf
("; VALIDATED by id = %u, owner = ",

926 ()
	`ldns_ˇlc_keyèg
(

927 
	`ldns_º_li°_º
(
key_vîifõd
, 
key_cou¡
)));

928 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_ow√r
(

929 
	`ldns_º_li°_º
(
key_li°
, 
key_cou¡
)));

930 
	`¥ötf
("\n");

934 
key_cou¡
 = 0; key_cou¡ < 
	`ldns_º_li°_º_cou¡
(
key_li°
);

935 
key_cou¡
++) {

936 i‡(
vîbosôy
 != -1) {

937 
	`¥ötf
("; %s for id = %u, owner = ",

938 
	`ldns_gë_îr‹°r_by_id
(
ªsu…
),

939 ()
	`ldns_ˇlc_keyèg
(

940 
	`ldns_º_li°_º
(
key_li°
, 
key_cou¡
)));

941 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_ow√r
(

943 
	`ldns_º_li°_º
(
key_li°
,

944 
key_cou¡
)));

945 
	`¥ötf
("\n");

949 
	`ldns_º_li°_‰ì
(
key_vîifõd
);

951 (Ë
key_cou¡
;

954 i‡(
™swî_fûe
) {

955 
	`dump_hex
(
pkt
, 
™swî_fûe
);

957 
	`ldns_pkt_‰ì
(
pkt
);

963 
exô
:

964 
	`ldns_rdf_dìp_‰ì
(
q«me
);

965 
	`ldns_rdf_dìp_‰ì
(
§c_rdf
);

966 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

967 
	`ldns_ªsﬁvî_dìp_‰ì
(
cmdlöe_ªs
);

968 
	`ldns_º_li°_dìp_‰ì
(
key_li°
);

969 
	`ldns_º_li°_dìp_‰ì
(
cmdlöe_º_li°
);

970 
	`ldns_rdf_dìp_‰ì
(
åa˚_°¨t_«me
);

971 
	`x‰ì
(
¥og«me
);

972 
	`x‰ì
(
tsig_«me
);

973 
	`x‰ì
(
tsig_d©a
);

974 
	`x‰ì
(
tsig_Æg‹ôhm
);

976 #ifde‡
HAVE_SSL


977 
	`ERR_ªmove_°©e
(0);

978 
	`CRYPTO_˛ónup_Æl_ex_d©a
();

979 
	`ERR_‰ì_°rögs
();

980 
	`EVP_˛ónup
();

982 #ifde‡
USE_WINSOCK


983 
	`WSACÀ™up
();

986  
ªsu…
;

987 
	}
}

	@drill/drill.h

9 #i‚de‡
_DRILL_H_


10 
	#_DRILL_H_


	)

11 
	~"c⁄fig.h
"

13 
	~"drûl_utû.h
"

15 
	#DRILL_VERSION
 
PACKAGE_VERSION


	)

18 
	#DRILL_QUERY
 0

	)

19 
	#DRILL_TRACE
 1

	)

20 
	#DRILL_CHASE
 2

	)

21 
	#DRILL_AFROMFILE
 3

	)

22 
	#DRILL_QTOFILE
 4

	)

23 
	#DRILL_NSEC
 5

	)

24 
	#DRILL_REVERSE
 6

	)

25 
	#DRILL_SECTRACE
 7

	)

27 
	#DRILL_ON
(
VAR
, 
BIT
) \

28 (
VAR
Ë(VARË| (
BIT
)

	)

29 
	#DRILL_OFF
(
VAR
, 
BIT
) \

30 (
VAR
Ë(VARË& ~(
BIT
)

	)

32 
ldns_º_li°
 *
globÆ_dns_roŸ
;

33 
boﬁ
 
qds
;

34 
vîbosôy
;

36 
ldns_pkt
 *
do_åa˚
(
ldns_ªsﬁvî
 *
ªs
,

37 
ldns_rdf
 *
«me
,

38 
ldns_º_ty≥
 
ty≥
,

39 
ldns_º_˛ass
 
c
);

40 
ldns_°©us
 
do_cha£
(
ldns_ªsﬁvî
 *
ªs
,

41 
ldns_rdf
 *
«me
,

42 
ldns_º_ty≥
 
ty≥
,

43 
ldns_º_˛ass
 
c
,

44 
ldns_º_li°
 *
åu°ed_keys
,

45 
ldns_pkt
 *
pkt_o
,

46 
uöt16_t
 
qÊags
,

47 
ldns_º_li°
 *
¥ev_key_li°
,

48 
vîbosôy
);

49 
do_£cuª_åa˚
(
ldns_ªsﬁvî
 *
ªs
,

50 
ldns_rdf
 *
«me
,

51 
ldns_º_ty≥
 
ty≥
,

52 
ldns_º_˛ass
 
c
,

53 
ldns_º_li°
 *
åu°ed_keys
,

54 
ldns_rdf
 *
°¨t_«me
);

56 
ldns_º_li°
 * 
gë_º
(
ldns_ªsﬁvî
 *
ªs
,

57 
ldns_rdf
 *
z«me
,

58 
ldns_º_ty≥
 
t
,

59 
ldns_º_˛ass
 
c
);

61 
drûl_pkt_¥öt
(
FILE
 *
fd
, 
ldns_ªsﬁvî
 *
r
, 
ldns_pkt
 *
p
);

62 
drûl_pkt_¥öt_foŸî
(
FILE
 *
fd
, 
ldns_ªsﬁvî
 *
r
, 
ldns_pkt
 *
p
);

64 
ldns_pkt_ty≥
 
gë_dns£c_º
(
ldns_pkt
 *
p
,

65 
ldns_rdf
 *
«me
,

66 
ldns_º_ty≥
 
t
,

67 
ldns_º_li°
 **
ºli°
,

68 
ldns_º_li°
 **
sig
);

70 
ldns_º
 *
ldns_n£c3_exa˘_m©ch
(
ldns_rdf
 *
q«me
,

71 
ldns_º_ty≥
 
qty≥
,

72 
ldns_º_li°
 *
n£c3s
);

74 
ldns_rdf
 *
ldns_n£c3_˛o£°_í˛o£r
÷dns_rd‡*
q«me
,

75 
ldns_º_ty≥
 
qty≥
,

76 
ldns_º_li°
 *
n£c3s
);

82 
ldns_°©us
 
ldns_vîify_díül
(
ldns_pkt
 *
pkt
,

83 
ldns_rdf
 *
«me
,

84 
ldns_º_ty≥
 
ty≥
,

85 
ldns_º_li°
 **
n£c_ºs
,

86 
ldns_º_li°
 **
n£c_º_sigs
);

88 
ldns_pkt
 *
ªad_hex_pkt
(*
fûíame
);

89 
ldns_buf„r
 *
ªad_hex_buf„r
(*
fûíame
);

90 
öô_roŸ
();

91 
ldns_º_li°
 *
ªad_roŸ_höts
(c⁄° *
fûíame
);

92 
˛ór_roŸ
();

93 
dump_hex
(c⁄° 
ldns_pkt
 *
pkt
, c⁄° *
fûe
);

94 
w¨nög
(c⁄° *
fmt
, ...);

95 
îr‹
(c⁄° *
fmt
, ...);

96 
mesg
(c⁄° *
fmt
, ...);

99 
ªsﬁvî_¥öt_«me£rvîs
(
ldns_ªsﬁvî
 *
r
);

100 
¥öt_dnskey
(
ldns_º_li°
 *
key_li°
);

101 
¥öt_ds
(
ldns_º_li°
 *
ds_li°
);

	@drill/drill_util.c

11 
	~"drûl.h
"

12 
	~<ldns/ldns.h
>

14 
	~<î∫o.h
>

17 
	$ªad_löe
(
FILE
 *
öput
, *
löe
, 
size_t
 
Àn
)

19 
i
;

20 
c
;

22 
i
 = 0; i < ()
Àn
-1; i++) {

23 
c
 = 
	`gëc
(
öput
);

24 i‡(
c
 =
EOF
) {

26 } i‡(
c
 != '\n') {

27 
löe
[
i
] = 
c
;

32 
löe
[
i
] = '\0';

33  
i
;

34 
	}
}

37 
ldns_°©us


38 
	$ªad_key_fûe
(c⁄° *
fûíame
, 
ldns_º_li°
 *
key_li°
, 
boﬁ
 
sûíéy
)

40 
löe_Àn
 = 0;

41 
löe_ƒ
 = 0;

42 
key_cou¡
 = 0;

43 
löe
[
LDNS_MAX_LINELEN
];

44 
ldns_°©us
 
°©us
;

45 
FILE
 *
öput_fûe
;

46 
ldns_º
 *
º
;

48 
öput_fûe
 = 
	`f›í
(
fûíame
, "r");

49 i‡(!
öput_fûe
) {

50 i‡(! 
sûíéy
) {

51 
	`Ârötf
(
°dîr
, "Error opening %s: %s\n",

52 
fûíame
, 
	`°ªº‹
(
î∫o
));

54  
LDNS_STATUS_ERR
;

56 
löe_Àn
 >= 0) {

57 
löe_Àn
 = (Ë
	`ªad_löe
(
öput_fûe
, 
löe
, (line));

58 
löe_ƒ
++;

59 i‡(
löe_Àn
 > 0 && 
löe
[0] != ';') {

60 
°©us
 = 
	`ldns_º_√w_‰m_°r
(&
º
, 
löe
, 0, 
NULL
, NULL);

61 i‡(
°©us
 !
LDNS_STATUS_OK
) {

62 i‡(! 
sûíéy
) {

63 
	`Ârötf
(
°dîr
,

65 "öÜöê%d: %s\n", 
löe_ƒ
,

66 
	`ldns_gë_îr‹°r_by_id
(
°©us
)

69 } i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_DNSKEY
 ||

70 
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_DS
) {

71 
	`ldns_º_li°_push_º
(
key_li°
, 
º
);

72 
key_cou¡
++;

74 
	`ldns_º_‰ì
(
º
);

78 
	`f˛o£
(
öput_fûe
);

79 i‡(
key_cou¡
 > 0) {

80  
LDNS_STATUS_OK
;

83  
LDNS_STATUS_ERR
;

85 
	}
}

87 
ldns_rdf
 *

88 
	$ldns_rdf_√w_addr_‰m_°r
(*
°r
)

90 
ldns_rdf
 *
a
;

92 
a
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_A
, 
°r
);

93 i‡(!
a
) {

95 
a
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_AAAA
, 
°r
);

96 i‡(!
a
) {

97  
NULL
;

100  
a
;

101 
	}
}

103 
ölöe
 

104 
	$loˇl_¥öt_ds
(
FILE
* 
out
, c⁄° * 
¥e
, 
ldns_º
* 
ds
)

106 i‡(
out
 && 
ds
) {

107 
	`Ârötf
(
out
, "%s", 
¥e
);

108 
	`ldns_º_¥öt
(
out
, 
ds
);

109 
	`ldns_º_‰ì
(
ds
);

111 
	}
}

117 
	$¥öt_ds_of_keys
(
ldns_pkt
 *
p
)

119 
ldns_º_li°
 *
keys
;

120 
uöt16_t
 
i
;

121 
ldns_º
 *
ds
;

124 
keys
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_DNSKEY
,

125 
LDNS_SECTION_ANSWER
);

130 i‡(
keys
) {

131 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
keys
); i++) {

132 
	`Ârötf
(
°dout
, ";\n;Équivalent DSÑecords for key %u:\n",

133 ()
	`ldns_ˇlc_keyèg
(
	`ldns_º_li°_º
(
keys
, 
i
)));

135 
ds
 = 
	`ldns_key_º2ds
(
	`ldns_º_li°_º
(
keys
, 
i
), 
LDNS_SHA1
);

136 
	`loˇl_¥öt_ds
(
°dout
, "; sha1: ", 
ds
);

137 
ds
 = 
	`ldns_key_º2ds
(
	`ldns_º_li°_º
(
keys
, 
i
), 
LDNS_SHA256
);

138 
	`loˇl_¥öt_ds
(
°dout
, "; sha256: ", 
ds
);

140 
	`ldns_º_li°_dìp_‰ì
(
keys
);

142 
	}
}

145 
	$¥öt_˛ass_ty≥
(
FILE
 *
Â
, 
ldns_º
 *
r
)

147 
ldns_lookup_èbÀ
 *
…
;

148 
…
 = 
	`ldns_lookup_by_id
(
ldns_º_˛as£s
, 
	`ldns_º_gë_˛ass
(
r
));

149 i‡(
…
) {

150 
	`Ârötf
(
Â
, " %s", 
…
->
«me
);

152 
	`Ârötf
(
Â
, " CLASS%d", 
	`ldns_º_gë_˛ass
(
r
));

155 
	`ldns_º_gë_ty≥
(
r
)) {

156 
LDNS_RR_TYPE_RRSIG
:

157 
	`Ârötf
(
Â
, " RRSIG ");

159 
LDNS_RR_TYPE_DNSKEY
:

160 
	`Ârötf
(
Â
, " DNSKEY ");

162 
LDNS_RR_TYPE_DS
:

163 
	`Ârötf
(
Â
, " DS ");

168 
	}
}

172 
	$¥öt_ds_abbr
(
FILE
 *
Â
, 
ldns_º
 *
ds
)

174 i‡(!
ds
 || (
	`ldns_º_gë_ty≥
(dsË!
LDNS_RR_TYPE_DS
)) {

178 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_ow√r
(
ds
));

179 
	`Ârötf
(
Â
, " %d", ()
	`ldns_º_âl
(
ds
));

180 
	`¥öt_˛ass_ty≥
(
Â
, 
ds
);

181 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
ds
, 0)); 
	`Ârötf
(fp, " ");

182 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
ds
, 1)); 
	`Ârötf
(fp, " ");

183 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
ds
, 2)); 
	`Ârötf
(fp, " ");

184 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
ds
, 3)); 
	`Ârötf
(fp, " ");

185 
	}
}

189 
	$¥öt_ºsig_abbr
(
FILE
 *
Â
, 
ldns_º
 *
sig
) {

190 i‡(!
sig
 || (
	`ldns_º_gë_ty≥
(sigË!
LDNS_RR_TYPE_RRSIG
)) {

194 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_ow√r
(
sig
));

195 
	`Ârötf
(
Â
, " %d", ()
	`ldns_º_âl
(
sig
));

196 
	`¥öt_˛ass_ty≥
(
Â
, 
sig
);

200 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
sig
, 0)); 
	`Ârötf
(fp, " ");

202 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
sig
, 1)); 
	`Ârötf
(fp, " ");

204 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
sig
, 2)); 
	`Ârötf
(fp, " (\n\t\t\t");

206 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
sig
, 4)); 
	`Ârötf
(fp, " ");

208 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
sig
, 5)); 
	`Ârötf
(fp, " ");

210 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
sig
, 6)); 
	`Ârötf
(fp, " ");

212 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
sig
, 7)); 
	`Ârötf
(fp, ")");

213 
	}
}

216 
	$¥öt_dnskey_abbr
(
FILE
 *
Â
, 
ldns_º
 *
key
)

218 i‡(!
key
 || (
	`ldns_º_gë_ty≥
(keyË!
LDNS_RR_TYPE_DNSKEY
)) {

222 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_ow√r
(
key
));

223 
	`Ârötf
(
Â
, " %d", ()
	`ldns_º_âl
(
key
));

224 
	`¥öt_˛ass_ty≥
(
Â
, 
key
);

228 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
key
, 0)); 
	`Ârötf
(fp, " ");

230 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
key
, 1)); 
	`Ârötf
(fp, " ");

232 
	`ldns_rdf_¥öt
(
Â
, 
	`ldns_º_rdf
(
key
, 2));

234 i‡(
	`ldns_rdf2«tive_öt16
(
	`ldns_º_rdf
(
key
, 0)) == 256) {

235 
	`Ârötf
(
Â
, " ;{id = %u (zsk), sizê%db}", ()
	`ldns_ˇlc_keyèg
(
key
),

236 ()
	`ldns_º_dnskey_key_size
(
key
));

239 i‡(
	`ldns_rdf2«tive_öt16
(
	`ldns_º_rdf
(
key
, 0)) == 257) {

240 
	`Ârötf
(
Â
, " ;{id = %u (ksk), sizê%db}", ()
	`ldns_ˇlc_keyèg
(
key
),

241 ()
	`ldns_º_dnskey_key_size
(
key
));

244 
	`Ârötf
(
Â
, " ;{id = %u, sizê%db}", ()
	`ldns_ˇlc_keyèg
(
key
),

245 ()
	`ldns_º_dnskey_key_size
(
key
));

246 
	}
}

249 
	$¥öt_º_li°_abbr
(
FILE
 *
Â
, 
ldns_º_li°
 *
ºli°
, c⁄° *
u§
)

251 
size_t
 
i
;

252 
ldns_º_ty≥
 
ç
;

254 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºli°
); i++) {

255 
ç
 = 
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
ºli°
, 
i
));

256 i‡(
i
 =0 && 
ç
 !
LDNS_RR_TYPE_RRSIG
) {

257 i‡(
u§
) {

258 
	`Ârötf
(
Â
, "%†", 
u§
);

261 
ç
) {

262 
LDNS_RR_TYPE_DNSKEY
:

263 
	`¥öt_dnskey_abbr
(
Â
, 
	`ldns_º_li°_º
(
ºli°
, 
i
));

265 
LDNS_RR_TYPE_RRSIG
:

266 
	`¥öt_ºsig_abbr
(
Â
, 
	`ldns_º_li°_º
(
ºli°
, 
i
));

268 
LDNS_RR_TYPE_DS
:

269 
	`¥öt_ds_abbr
(
Â
, 
	`ldns_º_li°_º
(
ºli°
, 
i
));

275 
	`Âuts
("\n", 
Â
);

277 
	}
}

280 
	$xmÆloc
(
size_t
 
s
)

282 *
p
;

284 
p
 = 
	`mÆloc
(
s
);

285 i‡(!
p
) {

286 
	`¥ötf
("Mem failure\n");

287 
	`exô
(
EXIT_FAILURE
);

289  
p
;

290 
	}
}

293 
	$xªÆloc
(*
p
, 
size_t
 
size
)

295 *
q
;

297 
q
 = 
	`ªÆloc
(
p
, 
size
);

298 i‡(!
q
) {

299 
	`¥ötf
("Mem failure\n");

300 
	`exô
(
EXIT_FAILURE
);

302  
q
;

303 
	}
}

306 
	$x‰ì
(*
p
)

308 i‡(
p
) {

309 
	`‰ì
(
p
);

311 
	}
}

	@drill/drill_util.h

11 #i‚de‡
_DRILL_UTIL_H_


12 
	#_DRILL_UTIL_H_


	)

13 
	~<ldns/ldns.h
>

19 
ldns_°©us
 
ªad_key_fûe
(c⁄° *
fûíame
, 
ldns_º_li°
 *
key_li°
,

20 
boﬁ
 
sûíéy
);

26 
ldns_rdf
 * 
ldns_rdf_√w_addr_‰m_°r
(*);

31 
¥öt_ds_of_keys
(
ldns_pkt
 *
p
);

36 
¥öt_ºsig_abbr
(
FILE
 *
Â
, 
ldns_º
 *
sig
);

40 
¥öt_dnskey_abbr
(
FILE
 *
Â
, 
ldns_º
 *
key
);

44 
¥öt_ds_abbr
(
FILE
 *
Â
, 
ldns_º
 *
ds
);

49 
¥öt_º_li°_abbr
(
FILE
 *
Â
, 
ldns_º_li°
 *
sig
, c⁄° *
u§
);

54 *
xmÆloc
(
size_t
 
s
);

59 *
xªÆloc
(*
p
, 
size_t
 
s
);

64 
x‰ì
(*
q
);

	@drill/error.c

13 
	~"drûl.h
"

14 
	~<ldns/ldns.h
>

17 
	$w¨nög_va_li°
(c⁄° *
fmt
, 
va_li°
 
¨gs
)

19 
	`Ârötf
(
°dîr
, "Warning: ");

20 
	`vÂrötf
(
°dîr
, 
fmt
, 
¨gs
);

21 
	`Ârötf
(
°dîr
, "\n");

22 
	}
}

25 
	$w¨nög
(c⁄° *
fmt
, ...)

27 
va_li°
 
¨gs
;

28 
	`va_°¨t
(
¨gs
, 
fmt
);

29 
	`w¨nög_va_li°
(
fmt
, 
¨gs
);

30 
	`va_íd
(
¨gs
);

31 
	}
}

34 
	$îr‹_va_li°
(c⁄° *
fmt
, 
va_li°
 
¨gs
)

36 
	`Ârötf
(
°dîr
, "Error: ");

37 
	`vÂrötf
(
°dîr
, 
fmt
, 
¨gs
);

38 
	`Ârötf
(
°dîr
, "\n");

39 
	}
}

42 
	$îr‹
(c⁄° *
fmt
, ...)

44 
va_li°
 
¨gs
;

45 
	`va_°¨t
(
¨gs
, 
fmt
);

46 
	`îr‹_va_li°
(
fmt
, 
¨gs
);

47 
	`va_íd
(
¨gs
);

48 
	`exô
(
EXIT_FAILURE
);

49 
	}
}

52 
	$vîbo£_va_li°
(c⁄° *
fmt
, 
va_li°
 
¨gs
)

54 
	`vÂrötf
(
°dout
, 
fmt
, 
¨gs
);

55 
	`Ârötf
(
°dout
, "\n");

56 
	}
}

60 
	$mesg
(c⁄° *
fmt
, ...)

62 
va_li°
 
¨gs
;

63 i‡(
vîbosôy
 == -1) {

66 
	`Ârötf
(
°dout
, ";; ");

67 
	`va_°¨t
(
¨gs
, 
fmt
);

68 
	`vîbo£_va_li°
(
fmt
, 
¨gs
);

69 
	`va_íd
(
¨gs
);

70 
	}
}

74 
	$vîbo£
(c⁄° *
fmt
, ...)

76 
va_li°
 
¨gs
;

77 i‡(
vîbosôy
 < 1) {

81 
	`va_°¨t
(
¨gs
, 
fmt
);

82 
	`vîbo£_va_li°
(
fmt
, 
¨gs
);

83 
	`va_íd
(
¨gs
);

84 
	}
}

88 
	$vvîbo£
(c⁄° *
fmt
, ...)

90 
va_li°
 
¨gs
;

91 i‡(
vîbosôy
 < 2) {

95 
	`va_°¨t
(
¨gs
, 
fmt
);

96 
	`vîbo£_va_li°
(
fmt
, 
¨gs
);

97 
	`va_íd
(
¨gs
);

98 
	}
}

101 
	$debug_va_li°
(c⁄° *
fmt
, 
va_li°
 
¨gs
)

103 
	`vÂrötf
(
°dîr
, 
fmt
, 
¨gs
);

104 
	`Ârötf
(
°dîr
, "\n");

105 
	}
}

108 
	$debug
(c⁄° *
fmt
, ...)

110 
va_li°
 
¨gs
;

111 
	`Ârötf
(
°dîr
, "[DEBUG] ");

112 
	`va_°¨t
(
¨gs
, 
fmt
);

113 
	`debug_va_li°
(
fmt
, 
¨gs
);

114 
	`va_íd
(
¨gs
);

115 
	}
}

	@drill/root.c

11 
	~"drûl.h
"

12 
	~<ldns/ldns.h
>

13 
	~<î∫o.h
>

16 
ldns_º_li°
 *
	gglobÆ_dns_roŸ
 = 
NULL
;

21 
	$öô_roŸ
()

23 
ldns_º
 *
r
;

25 
globÆ_dns_roŸ
 = 
	`ldns_º_li°_√w
();

27 ()
	`ldns_º_√w_‰m_°r
(&
r
, "A.ROOT-SERVERS.NET. 3600000 A 198.41.0.4", 0, 
NULL
, NULL);

28 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

29 ()
	`ldns_º_√w_‰m_°r
(&
r
, "A.ROOT-SERVERS.NET. 3600000 AAAA 2001:503:BA3E::2:30", 0, 
NULL
, NULL);

30 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

31 ()
	`ldns_º_√w_‰m_°r
(&
r
, "B.ROOT-SERVERS.NET. 3600000 A 192.228.79.201", 0, 
NULL
, NULL);

32 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

33 ()
	`ldns_º_√w_‰m_°r
(&
r
, "C.ROOT-SERVERS.NET. 3600000 A 192.33.4.12", 0, 
NULL
, NULL);

34 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

35 ()
	`ldns_º_√w_‰m_°r
(&
r
, "D.ROOT-SERVERS.NET. 3600000 A 128.8.10.90", 0, 
NULL
, NULL);

36 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

37 ()
	`ldns_º_√w_‰m_°r
(&
r
, "E.ROOT-SERVERS.NET. 3600000 A 192.203.230.10", 0, 
NULL
, NULL);

38 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

39 ()
	`ldns_º_√w_‰m_°r
(&
r
, "F.ROOT-SERVERS.NET. 3600000 A 192.5.5.241", 0, 
NULL
, NULL);

40 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

41 ()
	`ldns_º_√w_‰m_°r
(&
r
, "F.ROOT-SERVERS.NET. 3600000 AAAA 2001:500:2F::F", 0, 
NULL
, NULL);

42 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

43 ()
	`ldns_º_√w_‰m_°r
(&
r
, "G.ROOT-SERVERS.NET. 3600000 A 192.112.36.4", 0, 
NULL
, NULL);

44 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

45 ()
	`ldns_º_√w_‰m_°r
(&
r
, "H.ROOT-SERVERS.NET. 3600000 A 128.63.2.53", 0, 
NULL
, NULL);

46 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

47 ()
	`ldns_º_√w_‰m_°r
(&
r
, "H.ROOT-SERVERS.NET. 3600000 AAAA 2001:500:1::803F:235", 0, 
NULL
, NULL);

48 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

49 ()
	`ldns_º_√w_‰m_°r
(&
r
, "I.ROOT-SERVERS.NET. 3600000 A 192.36.148.17", 0, 
NULL
, NULL);

50 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

51 ()
	`ldns_º_√w_‰m_°r
(&
r
, "J.ROOT-SERVERS.NET. 3600000 A 192.58.128.30", 0, 
NULL
, NULL);

52 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

53 ()
	`ldns_º_√w_‰m_°r
(&
r
, "J.ROOT-SERVERS.NET. 3600000 AAAA 2001:503:C27::2:30", 0, 
NULL
, NULL);

54 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

55 ()
	`ldns_º_√w_‰m_°r
(&
r
, "K.ROOT-SERVERS.NET. 3600000 A 193.0.14.129 ", 0, 
NULL
, NULL);

56 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

57 ()
	`ldns_º_√w_‰m_°r
(&
r
, "K.ROOT-SERVERS.NET. 3600000 AAAA 2001:7FD::1", 0, 
NULL
, NULL);

58 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

59 ()
	`ldns_º_√w_‰m_°r
(&
r
, "L.ROOT-SERVERS.NET. 3600000 A 199.7.83.42", 0, 
NULL
, NULL);

60 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

61 ()
	`ldns_º_√w_‰m_°r
(&
r
, "L.ROOT-SERVERS.NET. 3600000 AAAA 2001:500:3::42 ", 0, 
NULL
, NULL);

62 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

63 ()
	`ldns_º_√w_‰m_°r
(&
r
, "M.ROOT-SERVERS.NET. 3600000 A 202.12.27.33", 0, 
NULL
, NULL);

64 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

65 ()
	`ldns_º_√w_‰m_°r
(&
r
, "M.ROOT-SERVERS.NET. 3600000 AAAA 2001:DC3::35", 0, 
NULL
, NULL);

66 
	`ldns_º_li°_push_º
(
globÆ_dns_roŸ
, 
r
);

67 
	}
}

76 
ldns_º_li°
 *

77 
	$ªad_roŸ_höts
(c⁄° *
fûíame
)

79 
FILE
 *
Â
 = 
NULL
;

80 
löe_ƒ
 = 0;

81 
ldns_z⁄e
 *
z
;

82 
ldns_°©us
 
°©us
;

83 
ldns_º_li°
 *
addªs£s
 = 
NULL
;

84 
ldns_º
 *
º
;

85 
size_t
 
i
;

87 
Â
 = 
	`f›í
(
fûíame
, "r");

88 i‡(!
Â
) {

89 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %†f‹Ñódög: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

90  
NULL
;

93 
°©us
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z
, 
Â
, 
NULL
, 0, 0, &
löe_ƒ
);

94 
	`f˛o£
(
Â
);

95 i‡(
°©us
 !
LDNS_STATUS_OK
) {

96 
	`Ârötf
(
°dîr
, "Eº‹ÑódögÑoŸ höt†fûe: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

97  
NULL
;

99 
addªs£s
 = 
	`ldns_º_li°_√w
();

100 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z
)); i++) {

101 
º
 = 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z
), 
i
);

104 i‡–
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_A
 ) {

105 
	`ldns_º_li°_push_º
(
addªs£s
, 
	`ldns_º_˛⁄e
(
º
));

108 i‡–
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_AAAA
) {

109 
	`ldns_º_li°_push_º
(
addªs£s
, 
	`ldns_º_˛⁄e
(
º
));

112 
	`ldns_z⁄e_dìp_‰ì
(
z
);

113  
addªs£s
;

115 
	}
}

119 
	$˛ór_roŸ
()

121 
	`ldns_º_li°_dìp_‰ì
(
globÆ_dns_roŸ
);

122 
	}
}

	@drill/securetrace.c

11 
	~"drûl.h
"

12 
	~<ldns/ldns.h
>

14 
	#SELF
 "[S]"

	)

15 
	#TRUST
 "[T]"

	)

16 
	#BOGUS
 "[B]"

	)

17 
	#UNSIGNED
 "[U]"

	)

23 
ldns_º_li°
 *

24 
	$ds_key_m©ch
(
ldns_º_li°
 *
ds
,Üdns_º_li° *
åu°ed
)

26 
size_t
 
i
, 
j
;

27 
boﬁ
 
m©ch
;

28 
ldns_º
 *
º_i
, *
º_j
;

29 
ldns_º_li°
 *
keys
;

31 i‡(!
åu°ed
 || !
ds
) {

32  
NULL
;

35 
m©ch
 = 
Ál£
;

36 
keys
 = 
	`ldns_º_li°_√w
();

37 i‡(!
keys
) {

38  
NULL
;

41 i‡(!
ds
 || !
åu°ed
) {

42  
NULL
;

45 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
åu°ed
); i++) {

46 
º_i
 = 
	`ldns_º_li°_º
(
åu°ed
, 
i
);

47 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
ds
); j++) {

49 
º_j
 = 
	`ldns_º_li°_º
(
ds
, 
j
);

50 i‡(
	`ldns_º_com∑ª_ds
(
º_i
, 
º_j
)) {

51 
m©ch
 = 
åue
;

53 
	`ldns_º_£t_push_º
(
keys
, 
º_i
);

57 i‡(
m©ch
) {

58  
keys
;

60  
NULL
;

62 
	}
}

65 
ldns_pkt
 *

66 
	$gë_dns£c_pkt
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
)

68 
ldns_pkt
 *
p
 = 
NULL
;

69 
p
 = 
	`ldns_ªsﬁvî_quîy
(
r
, 
«me
, 
t
, 
LDNS_RR_CLASS_IN
, 0);

70 i‡(!
p
) {

71  
NULL
;

73 i‡(
vîbosôy
 >= 5) {

74 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

76  
p
;

78 
	}
}

80 #ifde‡
HAVE_SSL


84 
ldns_pkt_ty≥


85 
	$gë_key
(
ldns_pkt
 *
p
, 
ldns_rdf
 *
≠ex«me
, 
ldns_º_li°
 **
ºli°
,Üdns_º_li° **
›t_sig
)

87  
	`gë_dns£c_º
(
p
, 
≠ex«me
, 
LDNS_RR_TYPE_DNSKEY
, 
ºli°
, 
›t_sig
);

88 
	}
}

93 
ldns_pkt_ty≥


94 
	$gë_ds
(
ldns_pkt
 *
p
, 
ldns_rdf
 *
ow√∫ame
, 
ldns_º_li°
 **
ºli°
,Üdns_º_li° **
›t_sig
)

96  
	`gë_dns£c_º
(
p
, 
ow√∫ame
, 
LDNS_RR_TYPE_DS
, 
ºli°
, 
›t_sig
);

97 
	}
}

101 
	$ªmove_ªsﬁvî_«me£rvîs
(
ldns_ªsﬁvî
 *
ªs
)

103 
ldns_rdf
 *
p›
;

106 (
p›
 = 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
))) {

107 
	`ldns_rdf_dìp_‰ì
(
p›
);

110 
	}
}

113 
	$show_cuºít_«me£rvîs
(
FILE
 *
out
, 
ldns_ªsﬁvî
 *
ªs
)

115 
size_t
 
i
;

116 
	`Ârötf
(
out
, "CurrentÇameservers forÑesolver object:\n");

117 
i
 = 0; i < 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
ªs
); i++) {

118 
	`ldns_rdf_¥öt
(
out
, 
	`ldns_ªsﬁvî_«me£rvîs
(
ªs
)[
i
]);

119 
	`Ârötf
(
out
, "\n");

121 
	}
}

124 #ifde‡
HAVE_SSL


126 
	$do_£cuª_åa˚
(
ldns_ªsﬁvî
 *
loˇl_ªs
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
,

127 
ldns_º_˛ass
 
c
, 
ldns_º_li°
 *
åu°ed_keys
, 
ldns_rdf
 *
°¨t_«me


130 
ldns_ªsﬁvî
 *
ªs
;

131 
ldns_pkt
 *
p
, *
loˇl_p
;

132 
ldns_º_li°
 *
√w_nss
;

133 
ldns_º_li°
 *
ns_addr
;

134 
ldns_rdf
 *
p›
;

135 
ldns_rdf
 **
œbñs
 = 
NULL
;

136 
ldns_°©us
 
°©us
, 
°
;

137 
ssize_t
 
i
;

138 
size_t
 
j
;

139 
size_t
 
k
;

140 
size_t
 
l
;

141 
uöt8_t
 
œbñs_cou¡
 = 0;

144 
ldns_º_li°
 *
key_li°
;

145 
ldns_º_li°
 *
key_sig_li°
;

146 
ldns_º_li°
 *
ds_li°
;

147 
ldns_º_li°
 *
ds_sig_li°
;

148 
ldns_º_li°
 *
c‹ª˘_key_li°
;

149 
ldns_º_li°
 *
åu°ed_ds_ºs
;

150 
boﬁ
 
√w_keys_åu°ed
 = 
Ál£
;

151 
ldns_º_li°
 *
cuºít_c‹ª˘_keys
;

152 
ldns_º_li°
 *
d©a£t
;

154 
ldns_º_li°
 *
n£c_ºs
 = 
NULL
;

155 
ldns_º_li°
 *
n£c_º_sigs
 = 
NULL
;

158 
boﬁ
 
ít
;

159 
ldns_º
 *
n£¸r
;

160 
ldns_rdf
 *
hashed_«me
;

161 
ldns_rdf
 *
œbñ0
;

164 
ldns_º_li°
 *
√w_ns_addr
;

165 
ldns_º_li°
 *
ﬁd_ns_addr
;

166 
ldns_º
 *
ns_º
;

168 
ªsu…
 = 0;

171 c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
;

173 
des¸ùt‹
 = 
	`ldns_º_des¸ùt
(
t
);

175 
√w_nss
 = 
NULL
;

176 
ns_addr
 = 
NULL
;

177 
key_li°
 = 
NULL
;

178 
ds_li°
 = 
NULL
;

180 
p
 = 
NULL
;

181 
loˇl_p
 = 
NULL
;

182 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

183 
key_sig_li°
 = 
NULL
;

184 
ds_sig_li°
 = 
NULL
;

186 i‡(!
ªs
) {

187 
	`îr‹
("Memoryállocation failed");

188 
ªsu…
 = -1;

189  
ªsu…
;

192 
c‹ª˘_key_li°
 = 
	`ldns_º_li°_√w
();

193 i‡(!
c‹ª˘_key_li°
) {

194 
	`îr‹
("Memoryállocation failed");

195 
ªsu…
 = -1;

196  
ªsu…
;

199 
åu°ed_ds_ºs
 = 
	`ldns_º_li°_√w
();

200 i‡(!
åu°ed_ds_ºs
) {

201 
	`îr‹
("Memoryállocation failed");

202 
ªsu…
 = -1;

203  
ªsu…
;

206 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
åu°ed_keys
); j++) {

207 
ldns_º
* 
⁄e_º
 = 
	`ldns_º_li°_º
(
åu°ed_keys
, 
j
);

208 i‡(
	`ldns_º_gë_ty≥
(
⁄e_º
Ë=
LDNS_RR_TYPE_DS
) {

209 
	`ldns_º_li°_push_º
(
åu°ed_ds_ºs
, 
	`ldns_º_˛⁄e
(
⁄e_º
));

214 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
,

215 
	`ldns_ªsﬁvî_ù6
(
loˇl_ªs
));

216 
	`ldns_ªsﬁvî_£t_p‹t
(
ªs
,

217 
	`ldns_ªsﬁvî_p‹t
(
loˇl_ªs
));

218 
	`ldns_ªsﬁvî_£t_debug
(
ªs
,

219 
	`ldns_ªsﬁvî_debug
(
loˇl_ªs
));

220 
	`ldns_ªsﬁvî_£t_Áû
(
ªs
,

221 
	`ldns_ªsﬁvî_Áû
(
loˇl_ªs
));

222 
	`ldns_ªsﬁvî_£t_u£vc
(
ªs
,

223 
	`ldns_ªsﬁvî_u£vc
(
loˇl_ªs
));

224 
	`ldns_ªsﬁvî_£t_øndom
(
ªs
,

225 
	`ldns_ªsﬁvî_øndom
(
loˇl_ªs
));

226 
	`ldns_ªsﬁvî_£t_sour˚
(
ªs
,

227 
	`ldns_ªsﬁvî_sour˚
(
loˇl_ªs
));

228 
	`ldns_ªsﬁvî_£t_ªcursive
(
loˇl_ªs
, 
åue
);

230 
	`ldns_ªsﬁvî_£t_ªcursive
(
ªs
, 
Ál£
);

231 
	`ldns_ªsﬁvî_£t_dns£c_cd
(
ªs
, 
Ál£
);

232 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
, 
åue
);

235 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
globÆ_dns_roŸ
);

236 i‡(
°©us
 !
LDNS_STATUS_OK
) {

237 
	`¥ötf
("ERRRRR: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

238 
	`ldns_º_li°_¥öt
(
°dout
, 
globÆ_dns_roŸ
);

239 
ªsu…
 = 
°©us
;

240 
d⁄e
;

242 
œbñs_cou¡
 = 
	`ldns_d«me_œbñ_cou¡
(
«me
);

243 i‡(
°¨t_«me
) {

244 i‡(
	`ldns_d«me_is_subdomaö
(
«me
, 
°¨t_«me
)) {

245 
œbñs_cou¡
 -
	`ldns_d«me_œbñ_cou¡
(
°¨t_«me
);

247 
	`Ârötf
(
°dîr
, "Error; ");

248 
	`ldns_rdf_¥öt
(
°dîr
, 
«me
);

249 
	`Ârötf
(
°dîr
, " isÇotá subdomain of ");

250 
	`ldns_rdf_¥öt
(
°dîr
, 
°¨t_«me
);

251 
	`Ârötf
(
°dîr
, "\n");

252 
d⁄e
;

255 
œbñs
 = 
	`LDNS_XMALLOC
(
ldns_rdf
*, 
œbñs_cou¡
 + 2);

256 i‡(!
œbñs
) {

257 
d⁄e
;

259 
œbñs
[0] = 
	`ldns_d«me_√w_‰m_°r
(
LDNS_ROOT_LABEL_STR
);

260 
œbñs
[1] = 
	`ldns_rdf_˛⁄e
(
«me
);

261 
i
 = 2 ; i < (
ssize_t
)
œbñs_cou¡
 + 2; i++) {

262 
œbñs
[
i
] = 
	`ldns_d«me_À·_ch›
(labels[i - 1]);

268 
i
 = (
ssize_t
)
œbñs_cou¡
 + 1; i > 0; i--) {

269 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
loˇl_p
, 
ªs
, 
œbñs
[
i
], 
LDNS_RR_TYPE_NS
, 
c
, 0);

271 i‡(
vîbosôy
 >= 5) {

272 
	`ldns_pkt_¥öt
(
°dout
, 
loˇl_p
);

275 
√w_nss
 = 
	`ldns_pkt_º_li°_by_ty≥
(
loˇl_p
,

276 
LDNS_RR_TYPE_NS
, 
LDNS_SECTION_ANSWER
);

277 i‡(!
√w_nss
) {

279 
√w_nss
 = 
	`ldns_pkt_º_li°_by_ty≥
(
loˇl_p
,

280 
LDNS_RR_TYPE_NS
, 
LDNS_SECTION_AUTHORITY
);

286 i‡(
√w_nss
 || 
i
 > 1) {

287 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
√w_nss
); j++) {

288 
ns_º
 = 
	`ldns_º_li°_º
(
√w_nss
, 
j
);

289 
p›
 = 
	`ldns_º_rdf
(
ns_º
, 0);

290 i‡(!
p›
) {

291 
	`¥ötf
("nopo\n");

296 
√w_ns_addr
 = 
NULL
;

297 i‡(
	`ldns_d«me_is_subdomaö
(
p›
, 
œbñs
[
i
])) {

298 
√w_ns_addr
 = 
	`ldns_pkt_º_li°_by_«me_™d_ty≥
(
loˇl_p
, 
p›
, 
LDNS_RR_TYPE_A
, 
LDNS_SECTION_ADDITIONAL
);

300 i‡(!
√w_ns_addr
 || 
	`ldns_º_li°_º_cou¡
(new_ns_addr) == 0) {

301 
√w_ns_addr
 = 
	`ldns_gë_º_li°_addr_by_«me
(
ªs
, 
p›
, 
c
, 0);

303 i‡(!
√w_ns_addr
 || 
	`ldns_º_li°_º_cou¡
(new_ns_addr) == 0) {

304 
√w_ns_addr
 = 
	`ldns_gë_º_li°_addr_by_«me
(
loˇl_ªs
, 
p›
, 
c
, 0);

307 i‡(
√w_ns_addr
) {

308 
ﬁd_ns_addr
 = 
ns_addr
;

309 
ns_addr
 = 
	`ldns_º_li°_ˇt_˛⁄e
“s_addr, 
√w_ns_addr
);

310 
	`ldns_º_li°_dìp_‰ì
(
ﬁd_ns_addr
);

312 
	`ldns_º_li°_dìp_‰ì
(
√w_ns_addr
);

314 
	`ldns_º_li°_dìp_‰ì
(
√w_nss
);

316 i‡(
ns_addr
) {

317 
	`ªmove_ªsﬁvî_«me£rvîs
(
ªs
);

319 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
ns_addr
) !=

320 
LDNS_STATUS_OK
) {

321 
	`îr‹
("ErroráddingÇewÇameservers");

322 
	`ldns_pkt_‰ì
(
loˇl_p
);

323 
d⁄e
;

325 
	`ldns_º_li°_dìp_‰ì
(
ns_addr
);

327 
°©us
 = 
	`ldns_vîify_díül
(
loˇl_p
, 
œbñs
[
i
], 
LDNS_RR_TYPE_NS
, &
n£c_ºs
, &
n£c_º_sigs
);

330 i‡(
vîbosôy
 >= 4) {

331 
	`¥ötf
("NSEC(3) RecordsÅo verify:\n");

332 
	`ldns_º_li°_¥öt
(
°dout
, 
n£c_ºs
);

333 
	`¥ötf
("With signatures:\n");

334 
	`ldns_º_li°_¥öt
(
°dout
, 
n£c_º_sigs
);

335 
	`¥ötf
("correct keys:\n");

336 
	`ldns_º_li°_¥öt
(
°dout
, 
c‹ª˘_key_li°
);

339 i‡(
°©us
 =
LDNS_STATUS_OK
) {

340 i‡((
°
 = 
	`ldns_vîify
(
n£c_ºs
, 
n£c_º_sigs
, 
åu°ed_keys
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

341 
	`Ârötf
(
°dout
, "%†", 
TRUST
);

342 
	`Ârötf
(
°dout
, "Existence denied: ");

343 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
]);

350  
	`Ârötf
(
°dout
, " NS\n");

351 } i‡((
°
 = 
	`ldns_vîify
(
n£c_ºs
, 
n£c_º_sigs
, 
c‹ª˘_key_li°
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

352 
	`Ârötf
(
°dout
, "%†", 
SELF
);

353 
	`Ârötf
(
°dout
, "Existence denied: ");

354 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
]);

362 
	`Ârötf
(
°dout
, " NS\n");

364 
	`Ârötf
(
°dout
, "%†", 
BOGUS
);

365 
ªsu…
 = 1;

366 
	`¥ötf
(";; Error verifying denial ofÉxistence forÇame ");

367 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
]);

375  
	`¥ötf
("NS: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°
));

378 
	`Ârötf
(
°dout
, "%†", 
BOGUS
);

379 
ªsu…
 = 1;

380 
	`¥ötf
(";; Error verifying denial ofÉxistence forÇame ");

381 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
]);

382 
	`¥ötf
("NS: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

386 
ít
 = 
Ál£
;

387 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
n£c_ºs
); j++) {

388 
n£¸r
 = 
	`ldns_º_li°_º
(
n£c_ºs
, 
j
);

390 i‡(
	`ldns_º_gë_ty≥
(
n£¸r
Ë=
LDNS_RR_TYPE_NSEC
 &&

391 
	`ldns_d«me_is_subdomaö
(
	`ldns_º_rdf
(
n£¸r
, 0), 
œbñs
[
i
])) {

392 
ít
 = 
åue
;

395 } i‡(
	`ldns_º_gë_ty≥
(
n£¸r
Ë=
LDNS_RR_TYPE_NSEC3
) {

396 
hashed_«me
 = 
	`ldns_n£c3_hash_«me_‰m_n£c3
(
n£¸r
, 
œbñs
[
i
]);

397 
œbñ0
 = 
	`ldns_d«me_œbñ
(
	`ldns_º_ow√r
(
n£¸r
), 0);

398 i‡(
hashed_«me
 && 
œbñ0
 &&

399 
	`ldns_d«me_com∑ª
(
hashed_«me
, 
œbñ0
) == 0 &&

400 
	`ldns_n£c3_bôm≠
(
n£¸r
Ë=
NULL
) {

401 
ít
 = 
åue
;

403 i‡(
œbñ0
) {

404 
	`LDNS_FREE
(
œbñ0
);

406 i‡(
hashed_«me
) {

407 
	`LDNS_FREE
(
hashed_«me
);

411 i‡(!
ít
) {

412 
	`ldns_º_li°_dìp_‰ì
(
n£c_ºs
);

413 
	`ldns_º_li°_dìp_‰ì
(
n£c_º_sigs
);

414 
	`ldns_pkt_‰ì
(
loˇl_p
);

415 
d⁄e
;

417 
	`¥ötf
(";; There isánÉmptyÇon-terminal here, continue\n");

422 i‡(
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
ªs
) == 0) {

423 
	`îr‹
("NoÇameservers found forÅhisÇode");

424 
d⁄e
;

427 
	`ldns_pkt_‰ì
(
loˇl_p
);

429 
	`Ârötf
(
°dout
, ";; Domain: ");

430 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
]);

431 
	`Ârötf
(
°dout
, "\n");

437 
p
 = 
	`gë_dns£c_pkt
(
ªs
, 
œbñs
[
i
], 
LDNS_RR_TYPE_DNSKEY
);

438 (Ë
	`gë_key
(
p
, 
œbñs
[
i
], &
key_li°
, &
key_sig_li°
);

439 i‡(
key_sig_li°
) {

440 i‡(
key_li°
) {

441 
cuºít_c‹ª˘_keys
 = 
	`ldns_º_li°_√w
();

442 i‡((
°
 = 
	`ldns_vîify
(
key_li°
, 
key_sig_li°
, key_li°, 
cuºít_c‹ª˘_keys
)) ==

443 
LDNS_STATUS_OK
) {

446 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
key_li°
); j++) {

447 
	`ldns_º_li°_push_º
(
c‹ª˘_key_li°
, 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
key_li°
, 
j
)));

453 
√w_keys_åu°ed
 = 
Ál£
;

454 
k
 = 0; k < 
	`ldns_º_li°_º_cou¡
(
cuºít_c‹ª˘_keys
); k++) {

455 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
åu°ed_ds_ºs
); j++) {

456 i‡(
	`ldns_º_com∑ª_ds
(
	`ldns_º_li°_º
(
cuºít_c‹ª˘_keys
, 
k
),

457 
	`ldns_º_li°_º
(
åu°ed_ds_ºs
, 
j
))) {

458 
√w_keys_åu°ed
 = 
åue
;

464 
k
 = 0; k < 
	`ldns_º_li°_º_cou¡
(
cuºít_c‹ª˘_keys
); k++) {

465 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
åu°ed_keys
); j++) {

466 i‡(
	`ldns_º_com∑ª
(
	`ldns_º_li°_º
(
cuºít_c‹ª˘_keys
, 
k
),

467 
	`ldns_º_li°_º
(
åu°ed_keys
, 
j
)) == 0) {

468 
√w_keys_åu°ed
 = 
åue
;

474 i‡(
√w_keys_åu°ed
) {

475 
	`ldns_º_li°_push_º_li°
(
åu°ed_keys
, 
key_li°
);

476 
	`¥öt_º_li°_abbr
(
°dout
, 
key_li°
, 
TRUST
);

477 
	`ldns_º_li°_‰ì
(
key_li°
);

478 
key_li°
 = 
NULL
;

480 i‡(
vîbosôy
 >= 2) {

481 
	`¥ötf
(";; Signature ok butÇo chainÅoáÅrusted key or dsÑecord\n");

483 
	`¥öt_º_li°_abbr
(
°dout
, 
key_li°
, 
SELF
);

484 
	`ldns_º_li°_dìp_‰ì
(
key_li°
);

485 
key_li°
 = 
NULL
;

488 
	`¥öt_º_li°_abbr
(
°dout
, 
key_li°
, 
BOGUS
);

489 
ªsu…
 = 2;

490 
	`ldns_º_li°_dìp_‰ì
(
key_li°
);

491 
key_li°
 = 
NULL
;

493 
	`ldns_º_li°_‰ì
(
cuºít_c‹ª˘_keys
);

494 
cuºít_c‹ª˘_keys
 = 
NULL
;

496 
	`¥ötf
(";; No DNSKEYÑecord found for ");

497 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
]);

498 
	`¥ötf
("\n");

502 
	`ldns_pkt_‰ì
(
p
);

503 
	`ldns_º_li°_dìp_‰ì
(
key_sig_li°
);

504 
key_sig_li°
 = 
NULL
;

507 i‡(
i
 > 1) {

508 
p
 = 
	`gë_dns£c_pkt
(
ªs
, 
œbñs
[
i
-1], 
LDNS_RR_TYPE_DS
);

509 (Ë
	`gë_ds
(
p
, 
œbñs
[
i
-1], &
ds_li°
, &
ds_sig_li°
);

510 i‡(!
ds_li°
) {

511 
	`ldns_pkt_‰ì
(
p
);

512 i‡(
ds_sig_li°
) {

513 
	`ldns_º_li°_dìp_‰ì
(
ds_sig_li°
);

515 
p
 = 
	`gë_dns£c_pkt
(
ªs
, 
«me
, 
LDNS_RR_TYPE_DNSKEY
);

516 (Ë
	`gë_ds
(
p
, 
NULL
, &
ds_li°
, &
ds_sig_li°
);

518 i‡(
ds_sig_li°
) {

519 i‡(
ds_li°
) {

520 i‡(
vîbosôy
 >= 4) {

521 
	`¥ötf
("VERIFYING:\n");

522 
	`¥ötf
("DS LIST:\n");

523 
	`ldns_º_li°_¥öt
(
°dout
, 
ds_li°
);

524 
	`¥ötf
("SIGS:\n");

525 
	`ldns_º_li°_¥öt
(
°dout
, 
ds_sig_li°
);

526 
	`¥ötf
("KEYS:\n");

527 
	`ldns_º_li°_¥öt
(
°dout
, 
c‹ª˘_key_li°
);

530 
cuºít_c‹ª˘_keys
 = 
	`ldns_º_li°_√w
();

532 i‡((
°
 = 
	`ldns_vîify
(
ds_li°
, 
ds_sig_li°
, 
c‹ª˘_key_li°
, 
cuºít_c‹ª˘_keys
)) ==

533 
LDNS_STATUS_OK
) {

536 
√w_keys_åu°ed
 = 
Ál£
;

537 i‡(
vîbosôy
 >= 2) {

538 
	`¥ötf
("Checking if signing key isÅrusted:\n");

540 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
cuºít_c‹ª˘_keys
); j++) {

541 i‡(
vîbosôy
 >= 2) {

542 
	`¥ötf
("New key: ");

543 
	`ldns_º_¥öt
(
°dout
, 
	`ldns_º_li°_º
(
cuºít_c‹ª˘_keys
, 
j
));

545 
k
 = 0; k < 
	`ldns_º_li°_º_cou¡
(
åu°ed_keys
); k++) {

546 i‡(
vîbosôy
 >= 2) {

547 
	`¥ötf
("\tTrusted key: ");

548 
	`ldns_º_¥öt
(
°dout
, 
	`ldns_º_li°_º
(
åu°ed_keys
, 
k
));

550 i‡(
	`ldns_º_com∑ª
(
	`ldns_º_li°_º
(
cuºít_c‹ª˘_keys
, 
j
),

551 
	`ldns_º_li°_º
(
åu°ed_keys
, 
k
)) == 0) {

552 i‡(
vîbosôy
 >= 2) {

553 
	`¥ötf
("Key isÇowÅrusted!\n");

555 
l
 = 0;Ü < 
	`ldns_º_li°_º_cou¡
(
ds_li°
);Ü++) {

556 
	`ldns_º_li°_push_º
(
åu°ed_ds_ºs
, 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
ds_li°
, 
l
)));

557 
√w_keys_åu°ed
 = 
åue
;

562 i‡(
√w_keys_åu°ed
) {

563 
	`¥öt_º_li°_abbr
(
°dout
, 
ds_li°
, 
TRUST
);

565 
	`¥öt_º_li°_abbr
(
°dout
, 
ds_li°
, 
SELF
);

568 
ªsu…
 = 3;

569 
	`¥öt_º_li°_abbr
(
°dout
, 
ds_li°
, 
BOGUS
);

572 
	`ldns_º_li°_‰ì
(
cuºít_c‹ª˘_keys
);

573 
cuºít_c‹ª˘_keys
 = 
NULL
;

576 
	`ldns_pkt_‰ì
(
p
);

577 
	`ldns_º_li°_dìp_‰ì
(
ds_sig_li°
);

578 
p
 = 
	`gë_dns£c_pkt
(
ªs
, 
œbñs
[
i
-1], 
LDNS_RR_TYPE_DS
);

579 (Ë
	`gë_ds
(
p
, 
œbñs
[
i
-1], &
ds_li°
, &
ds_sig_li°
);

581 
°©us
 = 
	`ldns_vîify_díül
(
p
, 
œbñs
[
i
-1], 
LDNS_RR_TYPE_DS
, &
n£c_ºs
, &
n£c_º_sigs
);

583 i‡(
vîbosôy
 >= 4) {

584 
	`¥ötf
("NSEC(3) RecordsÅo verify:\n");

585 
	`ldns_º_li°_¥öt
(
°dout
, 
n£c_ºs
);

586 
	`¥ötf
("With signatures:\n");

587 
	`ldns_º_li°_¥öt
(
°dout
, 
n£c_º_sigs
);

588 
	`¥ötf
("correct keys:\n");

589 
	`ldns_º_li°_¥öt
(
°dout
, 
c‹ª˘_key_li°
);

592 i‡(
°©us
 =
LDNS_STATUS_OK
) {

593 i‡((
°
 = 
	`ldns_vîify
(
n£c_ºs
, 
n£c_º_sigs
, 
åu°ed_keys
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

594 
	`Ârötf
(
°dout
, "%†", 
TRUST
);

595 
	`Ârötf
(
°dout
, "Existence denied: ");

596 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
-1]);

597 
	`¥ötf
(" DS");

598 
	`Ârötf
(
°dout
, "\n");

599 } i‡((
°
 = 
	`ldns_vîify
(
n£c_ºs
, 
n£c_º_sigs
, 
c‹ª˘_key_li°
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

600 
	`Ârötf
(
°dout
, "%†", 
SELF
);

601 
	`Ârötf
(
°dout
, "Existence denied: ");

602 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
-1]);

603 
	`¥ötf
(" DS");

604 
	`Ârötf
(
°dout
, "\n");

606 
ªsu…
 = 4;

607 
	`Ârötf
(
°dout
, "%†", 
BOGUS
);

608 
	`¥ötf
("Error verifying denial ofÉxistence for ");

609 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
-1]);

610 
	`¥ötf
(" DS");

611 
	`¥ötf
(": %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°
));

616 i‡(
°©us
 =
LDNS_STATUS_CRYPTO_NO_RRSIG
) {

617 
	`¥ötf
(";; No DS for ");

618 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
 - 1]);

620 
	`¥ötf
("[B] UnableÅo verify denial ofÉxistence for ");

621 
	`ldns_rdf_¥öt
(
°dout
, 
œbñs
[
i
 - 1]);

622 
	`¥ötf
(" DS: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

625 i‡(
vîbosôy
 >= 2) {

626 
	`¥ötf
(";; No dsÑecord for delegation\n");

630 
	`ldns_º_li°_dìp_‰ì
(
ds_li°
);

631 
	`ldns_pkt_‰ì
(
p
);

634 
p
 = 
	`gë_dns£c_pkt
(
ªs
, 
œbñs
[
i
], 
t
);

635 (Ë
	`gë_dns£c_º
(
p
, 
œbñs
[
i
], 
t
, &
d©a£t
, &
key_sig_li°
);

636 i‡(
d©a£t
 && 
	`ldns_º_li°_º_cou¡
(dataset) > 0) {

637 i‡(
key_sig_li°
 && 
	`ldns_º_li°_º_cou¡
(key_sig_list) > 0) {

640 i‡((
°
 = 
	`ldns_vîify
(
d©a£t
, 
key_sig_li°
, 
åu°ed_keys
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

641 
	`Ârötf
(
°dout
, "%†", 
TRUST
);

642 
	`ldns_º_li°_¥öt
(
°dout
, 
d©a£t
);

643 } i‡((
°
 = 
	`ldns_vîify
(
d©a£t
, 
key_sig_li°
, 
c‹ª˘_key_li°
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

644 
	`Ârötf
(
°dout
, "%†", 
SELF
);

645 
	`ldns_º_li°_¥öt
(
°dout
, 
d©a£t
);

647 
ªsu…
 = 5;

648 
	`Ârötf
(
°dout
, "%†", 
BOGUS
);

649 
	`ldns_º_li°_¥öt
(
°dout
, 
d©a£t
);

650 
	`¥ötf
(";; Eº‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°
));

653 
	`Ârötf
(
°dout
, "%†", 
UNSIGNED
);

654 
	`ldns_º_li°_¥öt
(
°dout
, 
d©a£t
);

656 
	`ldns_º_li°_dìp_‰ì
(
d©a£t
);

658 
°©us
 = 
	`ldns_vîify_díül
(
p
, 
«me
, 
t
, &
n£c_ºs
, &
n£c_º_sigs
);

659 i‡(
°©us
 =
LDNS_STATUS_OK
) {

661 i‡(
vîbosôy
 >= 5) {

662 
	`¥ötf
("NSEC(3) RecordsÅo verify:\n");

663 
	`ldns_º_li°_¥öt
(
°dout
, 
n£c_ºs
);

664 
	`¥ötf
("With signatures:\n");

665 
	`ldns_º_li°_¥öt
(
°dout
, 
n£c_º_sigs
);

666 
	`¥ötf
("correct keys:\n");

667 
	`ldns_º_li°_¥öt
(
°dout
, 
c‹ª˘_key_li°
);

673 i‡((
°
 = 
	`ldns_vîify
(
n£c_ºs
, 
n£c_º_sigs
, 
åu°ed_keys
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

674 
	`Ârötf
(
°dout
, "%†", 
TRUST
);

675 
	`Ârötf
(
°dout
, "Existence denied: ");

676 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

677 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

678 
	`¥ötf
(" %s", 
des¸ùt‹
->
_«me
);

680 
	`¥ötf
(" TYPE%u", 
t
);

682 
	`Ârötf
(
°dout
, "\n");

683 } i‡((
°
 = 
	`ldns_vîify
(
n£c_ºs
, 
n£c_º_sigs
, 
c‹ª˘_key_li°
, 
NULL
)Ë=
LDNS_STATUS_OK
) {

684 
	`Ârötf
(
°dout
, "%†", 
SELF
);

685 
	`Ârötf
(
°dout
, "Existence denied: ");

686 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

687 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

688 
	`¥ötf
(" %s", 
des¸ùt‹
->
_«me
);

690 
	`¥ötf
(" TYPE%u", 
t
);

692 
	`Ârötf
(
°dout
, "\n");

694 
ªsu…
 = 6;

695 
	`Ârötf
(
°dout
, "%†", 
BOGUS
);

696 
	`¥ötf
("Error verifying denial ofÉxistence for ");

697 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

698 
	`¥ötf
("Åype ");

699 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

700 
	`¥ötf
("%s", 
des¸ùt‹
->
_«me
);

702 
	`¥ötf
("TYPE%u", 
t
);

704 
	`¥ötf
(": %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°
));

707 
	`ldns_º_li°_dìp_‰ì
(
n£c_ºs
);

708 
	`ldns_º_li°_dìp_‰ì
(
n£c_º_sigs
);

712 i‡(
°©us
 =
LDNS_STATUS_CRYPTO_NO_RRSIG
) {

713 
	`¥ötf
("%†", 
UNSIGNED
);

714 
	`¥ötf
("No data found for: ");

715 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

716 
	`¥ötf
("Åype ");

717 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

718 
	`¥ötf
("%s", 
des¸ùt‹
->
_«me
);

720 
	`¥ötf
("TYPE%u", 
t
);

722 
	`¥ötf
("\n");

724 
	`¥ötf
("[B] UnableÅo verify denial ofÉxistence for ");

725 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

726 
	`¥ötf
("Åype ");

727 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

728 
	`¥ötf
("%s", 
des¸ùt‹
->
_«me
);

730 
	`¥ötf
("TYPE%u", 
t
);

732 
	`¥ötf
("\n");

737 
	`ldns_pkt_‰ì
(
p
);

740 
√w_nss
 = 
NULL
;

741 
ns_addr
 = 
NULL
;

742 
	`ldns_º_li°_dìp_‰ì
(
key_li°
);

743 
key_li°
 = 
NULL
;

744 
	`ldns_º_li°_dìp_‰ì
(
key_sig_li°
);

745 
key_sig_li°
 = 
NULL
;

746 
ds_li°
 = 
NULL
;

747 
	`ldns_º_li°_dìp_‰ì
(
ds_sig_li°
);

748 
ds_sig_li°
 = 
NULL
;

750 
	`¥ötf
(";;" 
SELF
 " sñ‡sig OK; " 
BOGUS
 " bogus; " 
TRUST
 "Årusted\n");

758 
d⁄e
:

759 
	`ldns_º_li°_dìp_‰ì
(
åu°ed_ds_ºs
);

760 
	`ldns_º_li°_dìp_‰ì
(
c‹ª˘_key_li°
);

761 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

762 i‡(
œbñs
) {

763 
i
 = 0 ; i < (
ssize_t
)
œbñs_cou¡
 + 2; i++) {

764 
	`ldns_rdf_dìp_‰ì
(
œbñs
[
i
]);

766 
	`LDNS_FREE
(
œbñs
);

768  
ªsu…
;

769 
	}
}

	@drill/work.c

10 
	~"drûl.h
"

11 
	~<ldns/ldns.h
>

21 
size_t


22 
	$hex°r2bö
(*
hex°r
, 
Àn
, 
uöt8_t
 *
buf
, 
size_t
 
off£t
, size_à
buf_Àn
)

24 
c
;

25 
i
;

26 
uöt8_t
 
öt8
 = 0;

27 
£c
 = 0;

28 
size_t
 
buÂos
 = 0;

30 i‡(
Àn
 % 2 != 0) {

34 
i
=0; i<
Àn
; i++) {

35 
c
 = 
hex°r
[
i
];

38 i‡(
c
 != ' ') {

39 i‡(
c
 >= '0' && c <= '9') {

40 
öt8
 +
c
 & 0x0f;

41 } i‡(
c
 >= 'a' && c <= 'z') {

42 
öt8
 +(
c
 & 0x0f) + 9;

43 } i‡(
c
 >= 'A' && c <= 'Z') {

44 
öt8
 +(
c
 & 0x0f) + 9;

49 i‡(
£c
 == 0) {

50 
öt8
 = int8 << 4;

51 
£c
 = 1;

53 i‡(
buÂos
 + 
off£t
 + 1 <
buf_Àn
) {

54 
buf
[
buÂos
+
off£t
] = 
öt8
;

55 
öt8
 = 0;

56 
£c
 = 0;

57 
buÂos
++;

59 
	`îr‹
("BufferÅoo small in hexstr2bin");

64  
buÂos
;

65 
	}
}

67 
size_t


68 
	$∑ckëbuf‰omfûe
(*
fûíame
, 
uöt8_t
 *
wúe
)

70 
FILE
 *
Â
 = 
NULL
;

71 
c
;

78 
°©e
 = 0;

79 
uöt8_t
 *
hexbuf
 = 
	`xmÆloc
(
LDNS_MAX_PACKETLEN
);

80 
hexbuÂos
 = 0;

81 
size_t
 
wúñí
;

83 i‡(
	`°∫cmp
(
fûíame
, "-", 2) == 0) {

84 
Â
 = 
°dö
;

86 
Â
 = 
	`f›í
(
fûíame
, "r");

88 i‡(
Â
 =
NULL
) {

89 
	`≥º‹
("UnableÅo open file forÑeading");

90 
	`x‰ì
(
hexbuf
);

96 
c
 = 
	`fgëc
(
Â
);

97 
c
 !
EOF
 && 
hexbuÂos
 < 
LDNS_MAX_PACKETLEN
) {

98 i‡(
°©e
 < 2 && !
	`ißscii
(
c
)) {

100 
°©e
 = 2;

102 
°©e
) {

104 i‡–(
c
 >= '0' && c <= '9') ||

105 (
c
 >= 'a' && c <= 'f') ||

106 (
c
 >= 'A' && c <= 'F') )

108 
hexbuf
[
hexbuÂos
] = (
uöt8_t
Ë
c
;

109 
hexbuÂos
++;

110 } i‡(
c
 == ';') {

111 
°©e
 = 1;

112 } i‡(
c
 == ' ' || c == '\t' || c == '\n') {

117 i‡(
c
 ='\n' || c =
EOF
) {

118 
°©e
 = 0;

122 
hexbuf
[
hexbuÂos
] = (
uöt8_t
Ë
c
;

123 
hexbuÂos
++;

126 
c
 = 
	`fgëc
(
Â
);

129 i‡(
c
 =
EOF
) {

142 i‡(
hexbuÂos
 >
LDNS_MAX_PACKETLEN
) {

147 i‡(
hexbuÂos
 % 2 != 0) {

148 
hexbuf
[
hexbuÂos
] = (
uöt8_t
) '0';

149 
hexbuÂos
++;

152 i‡(
°©e
 < 2) {

153 
wúñí
 = 
	`hex°r2bö
((*Ë
hexbuf
,

154 
hexbuÂos
,

155 
wúe
,

157 
LDNS_MAX_PACKETLEN
);

159 
	`mem˝y
(
wúe
, 
hexbuf
, (
size_t
Ë
hexbuÂos
);

160 
wúñí
 = (
size_t
Ë
hexbuÂos
;

162 i‡(
Â
 !
°dö
) {

163 
	`f˛o£
(
Â
);

165 
	`x‰ì
(
hexbuf
);

166  
wúñí
;

167 
	}
}

169 
ldns_buf„r
 *

170 
	$ªad_hex_buf„r
(*
fûíame
)

172 
uöt8_t
 *
wúe
;

173 
size_t
 
wúesize
;

174 
ldns_buf„r
 *
ªsu…_buf„r
 = 
NULL
;

177 
wúe
 = 
	`xmÆloc
(
LDNS_MAX_PACKETLEN
);

179 
wúesize
 = 
	`∑ckëbuf‰omfûe
(
fûíame
, 
wúe
);

181 
ªsu…_buf„r
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

182 
	`ldns_buf„r_√w_‰m_d©a
(
ªsu…_buf„r
, 
wúe
, 
wúesize
);

183 
	`ldns_buf„r_£t_posôi⁄
(
ªsu…_buf„r
, 
	`ldns_buf„r_ˇ∑côy
(result_buffer));

184 
	`x‰ì
(
wúe
);

186  
ªsu…_buf„r
;

187 
	}
}

189 
ldns_pkt
 *

190 
	$ªad_hex_pkt
(*
fûíame
)

192 
uöt8_t
 *
wúe
;

193 
size_t
 
wúesize
;

195 
ldns_pkt
 *
pkt
 = 
NULL
;

197 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_ERR
;

199 
wúe
 = 
	`xmÆloc
(
LDNS_MAX_PACKETLEN
);

201 
wúesize
 = 
	`∑ckëbuf‰omfûe
(
fûíame
, 
wúe
);

203 i‡(
wúesize
 > 0) {

204 
°©us
 = 
	`ldns_wúe2pkt
(&
pkt
, 
wúe
, 
wúesize
);

207 
	`x‰ì
(
wúe
);

209 i‡(
°©us
 =
LDNS_STATUS_OK
) {

210  
pkt
;

212 
	`Ârötf
(
°dîr
, "ErrorÖarsing hex file: %s\n",

213 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

214  
NULL
;

216 
	}
}

219 
	$dump_hex
(c⁄° 
ldns_pkt
 *
pkt
, c⁄° *
fûíame
)

221 
uöt8_t
 *
wúe
 = 
NULL
;

222 
size_t
 
size
, 
i
;

223 
FILE
 *
Â
;

224 
ldns_°©us
 
°©us
;

226 
Â
 = 
	`f›í
(
fûíame
, "w");

228 i‡(
Â
 =
NULL
) {

229 
	`îr‹
("U«bÀÅÿ›í %†f‹ wrôög", 
fûíame
);

233 
°©us
 = 
	`ldns_pkt2wúe
(&
wúe
, 
pkt
, &
size
);

235 i‡(
°©us
 !
LDNS_STATUS_OK
) {

236 
	`îr‹
("U«bÀÅÿc⁄vîà∑ckë:Éº‹ codê%u", 
°©us
);

237 
	`LDNS_FREE
(
wúe
);

238 
	`f˛o£
(
Â
);

242 
	`Ârötf
(
Â
, "; 0");

243 
i
 = 1; i < 20; i++) {

244 
	`Ârötf
(
Â
, " %2u", (Ë
i
);

246 
	`Ârötf
(
Â
, "\n");

247 
	`Ârötf
(
Â
, ";--");

248 
i
 = 1; i < 20; i++) {

249 
	`Ârötf
(
Â
, " --");

251 
	`Ârötf
(
Â
, "\n");

252 
i
 = 0; i < 
size
; i++) {

253 i‡(
i
 % 20 == 0 && i > 0) {

254 
	`Ârötf
(
Â
, "\t;\t%4u-%4u\n", (Ë
i
-19, () i);

256 
	`Ârötf
(
Â
, " %02x", ()
wúe
[
i
]);

258 
	`Ârötf
(
Â
, "\n");

259 
	`f˛o£
(
Â
);

260 
	`LDNS_FREE
(
wúe
);

261 
	}
}

	@duration.c

40 
	~<ldns/c⁄fig.h
>

41 
	~<ldns/duøti⁄.h
>

43 
	~<°dio.h
>

44 
	~<°dlib.h
>

45 
	~<°rög.h
>

46 
	~<time.h
>

53 
ldns_duøti⁄_ty≥
*

54 
	$ldns_duøti⁄_¸óã
()

56 
ldns_duøti⁄_ty≥
* 
duøti⁄
;

58 
duøti⁄
 = 
	`mÆloc
((
ldns_duøti⁄_ty≥
));

59 i‡(!
duøti⁄
) {

60  
NULL
;

62 
duøti⁄
->
yórs
 = 0;

63 
duøti⁄
->
m⁄ths
 = 0;

64 
duøti⁄
->
wìks
 = 0;

65 
duøti⁄
->
days
 = 0;

66 
duøti⁄
->
hours
 = 0;

67 
duøti⁄
->
möuãs
 = 0;

68 
duøti⁄
->
£c⁄ds
 = 0;

69  
duøti⁄
;

70 
	}
}

78 
	$ldns_duøti⁄_com∑ª
(
ldns_duøti⁄_ty≥
* 
d1
,Üdns_duøti⁄_ty≥* 
d2
)

80 i‡(!
d1
 && !
d2
) {

83 i‡(!
d1
 || !
d2
) {

84  
d1
?-1:1;

87 i‡(
d1
->
yórs
 !
d2
->years) {

88  (Ë(
d1
->
yórs
 - 
d2
->years);

90 i‡(
d1
->
m⁄ths
 !
d2
->months) {

91  (Ë(
d1
->
m⁄ths
 - 
d2
->months);

93 i‡(
d1
->
wìks
 !
d2
->weeks) {

94  (Ë(
d1
->
wìks
 - 
d2
->weeks);

96 i‡(
d1
->
days
 !
d2
->days) {

97  (Ë(
d1
->
days
 - 
d2
->days);

99 i‡(
d1
->
hours
 !
d2
->hours) {

100  (Ë(
d1
->
hours
 - 
d2
->hours);

102 i‡(
d1
->
möuãs
 !
d2
->minutes) {

103  (Ë(
d1
->
möuãs
 - 
d2
->minutes);

105 i‡(
d1
->
£c⁄ds
 !
d2
->seconds) {

106  (Ë(
d1
->
£c⁄ds
 - 
d2
->seconds);

110 
	}
}

117 
ldns_duøti⁄_ty≥
*

118 
	$ldns_duøti⁄_¸óã_‰om_°rög
(c⁄° * 
°r
)

120 
ldns_duøti⁄_ty≥
* 
duøti⁄
 = 
	`ldns_duøti⁄_¸óã
();

121 * 
P
, *
X
, *
T
, *
W
;

122 
nŸ_wìks
 = 0;

124 i‡(!
duøti⁄
) {

125  
NULL
;

127 i‡(!
°r
) {

128  
duøti⁄
;

131 
P
 = 
	`°rchr
(
°r
, 'P');

132 i‡(!
P
) {

133 
	`ldns_duøti⁄_˛ónup
(
duøti⁄
);

134  
NULL
;

137 
T
 = 
	`°rchr
(
°r
, 'T');

138 
X
 = 
	`°rchr
(
°r
, 'Y');

139 i‡(
X
) {

140 
duøti⁄
->
yórs
 = (
time_t
Ë
	`©oi
(
°r
+1);

141 
°r
 = 
X
;

142 
nŸ_wìks
 = 1;

144 
X
 = 
	`°rchr
(
°r
, 'M');

145 i‡(
X
 && (!
T
 || (
size_t
Ë(X-
P
) < (size_t) (T-P))) {

146 
duøti⁄
->
m⁄ths
 = (
time_t
Ë
	`©oi
(
°r
+1);

147 
°r
 = 
X
;

148 
nŸ_wìks
 = 1;

150 
X
 = 
	`°rchr
(
°r
, 'D');

151 i‡(
X
) {

152 
duøti⁄
->
days
 = (
time_t
Ë
	`©oi
(
°r
+1);

153 
°r
 = 
X
;

154 
nŸ_wìks
 = 1;

156 i‡(
T
) {

157 
°r
 = 
T
;

158 
nŸ_wìks
 = 1;

160 
X
 = 
	`°rchr
(
°r
, 'H');

161 i‡(
X
 && 
T
) {

162 
duøti⁄
->
hours
 = (
time_t
Ë
	`©oi
(
°r
+1);

163 
°r
 = 
X
;

164 
nŸ_wìks
 = 1;

166 
X
 = 
	`°ºchr
(
°r
, 'M');

167 i‡(
X
 && 
T
 && (
size_t
Ë(X-
P
) > (size_t) (T-P)) {

168 
duøti⁄
->
möuãs
 = (
time_t
Ë
	`©oi
(
°r
+1);

169 
°r
 = 
X
;

170 
nŸ_wìks
 = 1;

172 
X
 = 
	`°rchr
(
°r
, 'S');

173 i‡(
X
 && 
T
) {

174 
duøti⁄
->
£c⁄ds
 = (
time_t
Ë
	`©oi
(
°r
+1);

175 
°r
 = 
X
;

176 
nŸ_wìks
 = 1;

179 
W
 = 
	`°rchr
(
°r
, 'W');

180 i‡(
W
) {

181 i‡(
nŸ_wìks
) {

182 
	`ldns_duøti⁄_˛ónup
(
duøti⁄
);

183  
NULL
;

185 
duøti⁄
->
wìks
 = (
time_t
Ë
	`©oi
(
°r
+1);

186 
°r
 = 
W
;

189  
duøti⁄
;

190 
	}
}

197 
size_t


198 
	$digôs_ö_numbî
(
time_t
 
duøti⁄
)

200 
uöt32_t
 
≥riod
 = (uöt32_tË
duøti⁄
;

201 
size_t
 
cou¡
 = 0;

203 
≥riod
 > 0) {

204 
cou¡
++;

205 
≥riod
 /= 10;

207  
cou¡
;

208 
	}
}

216 
	$ldns_duøti⁄2°rög
(
ldns_duøti⁄_ty≥
* 
duøti⁄
)

218 * 
°r
 = 
NULL
, *
num
 = NULL;

219 
size_t
 
cou¡
 = 2;

220 
T
 = 0;

222 i‡(!
duøti⁄
) {

223  
NULL
;

226 i‡(
duøti⁄
->
yórs
 > 0) {

227 
cou¡
 = cou¡ + 1 + 
	`digôs_ö_numbî
(
duøti⁄
->
yórs
);

229 i‡(
duøti⁄
->
m⁄ths
 > 0) {

230 
cou¡
 = cou¡ + 1 + 
	`digôs_ö_numbî
(
duøti⁄
->
m⁄ths
);

232 i‡(
duøti⁄
->
wìks
 > 0) {

233 
cou¡
 = cou¡ + 1 + 
	`digôs_ö_numbî
(
duøti⁄
->
wìks
);

235 i‡(
duøti⁄
->
days
 > 0) {

236 
cou¡
 = cou¡ + 1 + 
	`digôs_ö_numbî
(
duøti⁄
->
days
);

238 i‡(
duøti⁄
->
hours
 > 0) {

239 
cou¡
 = cou¡ + 1 + 
	`digôs_ö_numbî
(
duøti⁄
->
hours
);

240 
T
 = 1;

242 i‡(
duøti⁄
->
möuãs
 > 0) {

243 
cou¡
 = cou¡ + 1 + 
	`digôs_ö_numbî
(
duøti⁄
->
möuãs
);

244 
T
 = 1;

246 i‡(
duøti⁄
->
£c⁄ds
 > 0) {

247 
cou¡
 = cou¡ + 1 + 
	`digôs_ö_numbî
(
duøti⁄
->
£c⁄ds
);

248 
T
 = 1;

250 i‡(
T
) {

251 
cou¡
++;

254 
°r
 = (*Ë
	`ˇŒoc
(
cou¡
, ());

255 
°r
[0] = 'P';

256 
°r
[1] = '\0';

258 i‡(
duøti⁄
->
yórs
 > 0) {

259 
cou¡
 = 
	`digôs_ö_numbî
(
duøti⁄
->
yórs
);

260 
num
 = (*Ë
	`ˇŒoc
(
cou¡
+2, ());

261 
	`¢¥ötf
(
num
, 
cou¡
+2, "%uY", (Ë
duøti⁄
->
yórs
);

262 
°r
 = 
	`°∫ˇt
(°r, 
num
, 
cou¡
+2);

263 
	`‰ì
((*Ë
num
);

265 i‡(
duøti⁄
->
m⁄ths
 > 0) {

266 
cou¡
 = 
	`digôs_ö_numbî
(
duøti⁄
->
m⁄ths
);

267 
num
 = (*Ë
	`ˇŒoc
(
cou¡
+2, ());

268 
	`¢¥ötf
(
num
, 
cou¡
+2, "%uM", (Ë
duøti⁄
->
m⁄ths
);

269 
°r
 = 
	`°∫ˇt
(°r, 
num
, 
cou¡
+2);

270 
	`‰ì
((*Ë
num
);

272 i‡(
duøti⁄
->
wìks
 > 0) {

273 
cou¡
 = 
	`digôs_ö_numbî
(
duøti⁄
->
wìks
);

274 
num
 = (*Ë
	`ˇŒoc
(
cou¡
+2, ());

275 
	`¢¥ötf
(
num
, 
cou¡
+2, "%uW", (Ë
duøti⁄
->
wìks
);

276 
°r
 = 
	`°∫ˇt
(°r, 
num
, 
cou¡
+2);

277 
	`‰ì
((*Ë
num
);

279 i‡(
duøti⁄
->
days
 > 0) {

280 
cou¡
 = 
	`digôs_ö_numbî
(
duøti⁄
->
days
);

281 
num
 = (*Ë
	`ˇŒoc
(
cou¡
+2, ());

282 
	`¢¥ötf
(
num
, 
cou¡
+2, "%uD", (Ë
duøti⁄
->
days
);

283 
°r
 = 
	`°∫ˇt
(°r, 
num
, 
cou¡
+2);

284 
	`‰ì
((*Ë
num
);

286 i‡(
T
) {

287 
°r
 = 
	`°∫ˇt
(str, "T", 1);

289 i‡(
duøti⁄
->
hours
 > 0) {

290 
cou¡
 = 
	`digôs_ö_numbî
(
duøti⁄
->
hours
);

291 
num
 = (*Ë
	`ˇŒoc
(
cou¡
+2, ());

292 
	`¢¥ötf
(
num
, 
cou¡
+2, "%uH", (Ë
duøti⁄
->
hours
);

293 
°r
 = 
	`°∫ˇt
(°r, 
num
, 
cou¡
+2);

294 
	`‰ì
((*Ë
num
);

296 i‡(
duøti⁄
->
möuãs
 > 0) {

297 
cou¡
 = 
	`digôs_ö_numbî
(
duøti⁄
->
möuãs
);

298 
num
 = (*Ë
	`ˇŒoc
(
cou¡
+2, ());

299 
	`¢¥ötf
(
num
, 
cou¡
+2, "%uM", (Ë
duøti⁄
->
möuãs
);

300 
°r
 = 
	`°∫ˇt
(°r, 
num
, 
cou¡
+2);

301 
	`‰ì
((*Ë
num
);

303 i‡(
duøti⁄
->
£c⁄ds
 > 0) {

304 
cou¡
 = 
	`digôs_ö_numbî
(
duøti⁄
->
£c⁄ds
);

305 
num
 = (*Ë
	`ˇŒoc
(
cou¡
+2, ());

306 
	`¢¥ötf
(
num
, 
cou¡
+2, "%uS", (Ë
duøti⁄
->
£c⁄ds
);

307 
°r
 = 
	`°∫ˇt
(°r, 
num
, 
cou¡
+2);

308 
	`‰ì
((*Ë
num
);

310  
°r
;

311 
	}
}

318 
time_t


319 
	$ldns_duøti⁄2time
(
ldns_duøti⁄_ty≥
* 
duøti⁄
)

321 
time_t
 
≥riod
 = 0;

323 i‡(
duøti⁄
) {

324 
≥riod
 +(
duøti⁄
->
£c⁄ds
);

325 
≥riod
 +(
duøti⁄
->
möuãs
)*60;

326 
≥riod
 +(
duøti⁄
->
hours
)*3600;

327 
≥riod
 +(
duøti⁄
->
days
)*86400;

328 
≥riod
 +(
duøti⁄
->
wìks
)*86400*7;

329 
≥riod
 +(
duøti⁄
->
m⁄ths
)*86400*31;

330 
≥riod
 +(
duøti⁄
->
yórs
)*86400*365;

338  
≥riod
;

339 
	}
}

347 
	$ldns_duøti⁄_˛ónup
(
ldns_duøti⁄_ty≥
* 
duøti⁄
)

349 i‡(!
duøti⁄
) {

352 
	`‰ì
(
duøti⁄
);

354 
	}
}

	@error.c

11 
	~<ldns/c⁄fig.h
>

13 
	~<ldns/ldns.h
>

15 
ldns_lookup_èbÀ
 
	gldns_îr‹_°r
[] = {

16 { 
LDNS_STATUS_OK
, "All OK" },

17 { 
LDNS_STATUS_EMPTY_LABEL
, "EmptyÜabel" },

18 { 
LDNS_STATUS_LABEL_OVERFLOW
, "LabelÜength overflow" },

19 { 
LDNS_STATUS_DOMAINNAME_OVERFLOW
, "DomainnameÜength overflow" },

20 { 
LDNS_STATUS_DOMAINNAME_UNDERFLOW
, "DomainnameÜength underflow (zeroÜength)" },

21 { 
LDNS_STATUS_DDD_OVERFLOW
, "\\DDD sequence overflow (>255)" },

22 { 
LDNS_STATUS_PACKET_OVERFLOW
, "Packet size overflow" },

23 { 
LDNS_STATUS_INVALID_POINTER
, "Invalid compressionÖointer" },

24 { 
LDNS_STATUS_MEM_ERR
, "General memoryÉrror" },

25 { 
LDNS_STATUS_INTERNAL_ERR
, "InternalÉrror,Åhis shouldÇot happen" },

26 { 
LDNS_STATUS_SSL_ERR
, "Error in SSLÜibrary" },

27 { 
LDNS_STATUS_ERR
, "General LDNSÉrror" },

28 { 
LDNS_STATUS_INVALID_INT
, "ConversionÉrror, integerÉxpected" },

29 { 
LDNS_STATUS_INVALID_IP4
, "ConversionÉrror, ip4áddrÉxpected" },

30 { 
LDNS_STATUS_INVALID_IP6
, "ConversionÉrror, ip6áddrÉxpected" },

31 { 
LDNS_STATUS_INVALID_STR
, "ConversionÉrror, stringÉxpected" },

32 { 
LDNS_STATUS_INVALID_B32_EXT
, "ConversionÉrror, b32ÉxtÉncodingÉxpected" },

33 { 
LDNS_STATUS_INVALID_B64
, "ConversionÉrror, b64ÉncodingÉxpected" },

34 { 
LDNS_STATUS_INVALID_HEX
, "ConversionÉrror, hexÉncodingÉxpected" },

35 { 
LDNS_STATUS_INVALID_TIME
, "ConversionÉrror,ÅimeÉncodingÉxpected" },

36 { 
LDNS_STATUS_NETWORK_ERR
, "CouldÇot send orÑeceive, because ofÇetworkÉrror" },

37 { 
LDNS_STATUS_ADDRESS_ERR
, "CouldÇot start AXFR, because ofáddressÉrror" },

38 { 
LDNS_STATUS_FILE_ERR
, "CouldÇot openÅhe files" },

39 { 
LDNS_STATUS_UNKNOWN_INET
, "Uknownáddress family" },

40 { 
LDNS_STATUS_NOT_IMPL
, "This function isÇot implemented (yet),ÖleaseÇotifyÅhe developers - orÇot..." },

41 { 
LDNS_STATUS_NULL
, "Supplied valueÖointerÇull" },

42 { 
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
, "Unknown cryptographicálgorithm" },

43 { 
LDNS_STATUS_CRYPTO_ALGO_NOT_IMPL
, "CryptographicálgorithmÇot implemented" },

44 { 
LDNS_STATUS_CRYPTO_NO_RRSIG
, "No DNSSEC signature(s)" },

45 { 
LDNS_STATUS_CRYPTO_NO_DNSKEY
, "No DNSSECÖublic key(s)" },

46 { 
LDNS_STATUS_CRYPTO_TYPE_COVERED_ERR
, "The signature doesÇot coverÅhis RRset" },

47 { 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DNSKEY
, "No signatures found forÅrusted DNSSECÖublic key(s)" },

48 { 
LDNS_STATUS_CRYPTO_NO_DS
, "No DSÑecord(s)" },

49 { 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DS
, "CouldÇot validate DSÑecord(s)" },

50 { 
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
, "No keys withÅhe keytagándálgorithm fromÅhe RRSIG found" },

51 { 
LDNS_STATUS_CRYPTO_VALIDATED
, "Valid DNSSEC signature" },

52 { 
LDNS_STATUS_CRYPTO_BOGUS
, "Bogus DNSSEC signature" },

53 { 
LDNS_STATUS_CRYPTO_SIG_EXPIRED
, "DNSSEC signature hasÉxpired" },

54 { 
LDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED
, "DNSSEC signatureÇot incepted yet" },

55 { 
LDNS_STATUS_CRYPTO_TSIG_BOGUS
, "Bogus TSIG signature" },

56 { 
LDNS_STATUS_CRYPTO_TSIG_ERR
, "CouldÇot create TSIG signature" },

57 { 
LDNS_STATUS_CRYPTO_EXPIRATION_BEFORE_INCEPTION
, "DNSSEC signature hasÉxpiration dateÉarlierÅhan inception date" },

58 { 
LDNS_STATUS_ENGINE_KEY_NOT_LOADED
, "UnableÅoÜoadÖrivate key fromÉngine" },

59 { 
LDNS_STATUS_NSEC3_ERR
, "Error in NSEC3 denial ofÉxistenceÖroof" },

60 { 
LDNS_STATUS_RES_NO_NS
, "No (valid)Çameservers defined inÅheÑesolver" },

61 { 
LDNS_STATUS_RES_QUERY
, "No correct query givenÅoÑesolver" },

62 { 
LDNS_STATUS_WIRE_INCOMPLETE_HEADER
, "header section incomplete" },

63 { 
LDNS_STATUS_WIRE_INCOMPLETE_QUESTION
, "question section incomplete" },

64 { 
LDNS_STATUS_WIRE_INCOMPLETE_ANSWER
, "answer section incomplete" },

65 { 
LDNS_STATUS_WIRE_INCOMPLETE_AUTHORITY
, "authority section incomplete" },

66 { 
LDNS_STATUS_WIRE_INCOMPLETE_ADDITIONAL
, "additional section incomplete" },

67 { 
LDNS_STATUS_NO_DATA
, "No data" },

68 { 
LDNS_STATUS_EXISTS_ERR
, "ElementálreadyÉxists" },

69 { 
LDNS_STATUS_CERT_BAD_ALGORITHM
, "BadálgorithmÅype for CERTÑecord" },

70 { 
LDNS_STATUS_SYNTAX_TYPE_ERR
, "SyntaxÉrror, couldÇotÖarseÅhe RR'sÅype" },

71 { 
LDNS_STATUS_SYNTAX_CLASS_ERR
, "SyntaxÉrror, couldÇotÖarseÅhe RR's class" },

72 { 
LDNS_STATUS_SYNTAX_TTL_ERR
, "SyntaxÉrror, couldÇotÖarseÅhe RR's TTL" },

73 { 
LDNS_STATUS_SYNTAX_INCLUDE_ERR_NOTIMPL
, "SyntaxÉrror, $INCLUDEÇot implemented" },

74 { 
LDNS_STATUS_SYNTAX_RDATA_ERR
, "SyntaxÉrror, couldÇotÖarseÅhe RR'sÑdata" },

75 { 
LDNS_STATUS_SYNTAX_DNAME_ERR
, "SyntaxÉrror, couldÇotÖarseÅhe RR's dname(s)" },

76 { 
LDNS_STATUS_SYNTAX_VERSION_ERR
, "SyntaxÉrror, version mismatch" },

77 { 
LDNS_STATUS_SYNTAX_ALG_ERR
, "SyntaxÉrror,álgorithm unknown orÇonÖarseable" },

78 { 
LDNS_STATUS_SYNTAX_KEYWORD_ERR
, "SyntaxÉrror, unknown keyword in input" },

79 { 
LDNS_STATUS_SYNTAX_ERR
, "SyntaxÉrror, couldÇotÖarseÅhe RR" },

80 { 
LDNS_STATUS_SYNTAX_EMPTY
, "EmptyÜine wasÑeturned" },

81 { 
LDNS_STATUS_SYNTAX_TTL
, "$TTL directive was seen inÅhe zone" },

82 { 
LDNS_STATUS_SYNTAX_ORIGIN
, "$ORIGIN directive was seen inÅhe zone" },

83 { 
LDNS_STATUS_SYNTAX_INCLUDE
, "$INCLUDE directive was seen inÅhe zone" },

84 { 
LDNS_STATUS_SYNTAX_ITERATIONS_OVERFLOW
, "Iterations count for NSEC3Ñecord higherÅhan maximum" },

85 { 
LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
, "SyntaxÉrror, valueÉxpected" },

86 { 
LDNS_STATUS_SYNTAX_INTEGER_OVERFLOW
, "SyntaxÉrror, integer valueÅooÜarge" },

87 { 
LDNS_STATUS_SYNTAX_BAD_ESCAPE
, "SyntaxÉrror, badÉscape sequence" },

88 { 
LDNS_STATUS_SOCKET_ERROR
, "Error creating socket" },

89 { 
LDNS_STATUS_DNSSEC_EXISTENCE_DENIED
, "Existence denied by NSEC" },

90 { 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
, "RRÇot covered byÅhe given NSEC RRs" },

91 { 
LDNS_STATUS_DNSSEC_NSEC_WILDCARD_NOT_COVERED
, "wildcardÇot covered byÅhe given NSEC RRs" },

92 { 
LDNS_STATUS_DNSSEC_NSEC3_ORIGINAL_NOT_FOUND
, "original of NSEC3 hashedÇame couldÇot be found" },

93 { 
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
, "The RRSIG hasÅo fewÑdata fields" },

94 { 
LDNS_STATUS_MISSING_RDATA_FIELDS_KEY
, "The DNSKEY hasÅo fewÑdata fields" },

95 { 
LDNS_STATUS_CRYPTO_SIG_EXPIRED_WITHIN_MARGIN
,

97 { 
LDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED_WITHIN_MARGIN
,

99 { 
LDNS_STATUS_DANE_UNKNOWN_CERTIFICATE_USAGE
,

101 { 
LDNS_STATUS_DANE_UNKNOWN_SELECTOR
, "Unknown TLSA Selector" },

102 { 
LDNS_STATUS_DANE_UNKNOWN_MATCHING_TYPE
,

104 { 
LDNS_STATUS_DANE_UNKNOWN_PROTOCOL
,

106 { 
LDNS_STATUS_DANE_UNKNOWN_TRANSPORT
,

108 { 
LDNS_STATUS_DANE_MISSING_EXTRA_CERTS
,

110 { 
LDNS_STATUS_DANE_EXTRA_CERTS_NOT_USED
,

112 { 
LDNS_STATUS_DANE_OFFSET_OUT_OF_RANGE
,

114 { 
LDNS_STATUS_DANE_INSECURE
,

116 { 
LDNS_STATUS_DANE_BOGUS
,

118 { 
LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH
,

121 { 
LDNS_STATUS_DANE_NON_CA_CERTIFICATE
,

123 { 
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
,

125 { 
LDNS_STATUS_DANE_PKIX_NO_SELF_SIGNED_TRUST_ANCHOR
,

128 { 
LDNS_STATUS_INVALID_ILNP64
,

130 { 
LDNS_STATUS_INVALID_EUI48
,

133 { 
LDNS_STATUS_INVALID_EUI64
,

136 { 
LDNS_STATUS_WIRE_RDATA_ERR
, "invalidÑdata in wire format" },

137 { 
LDNS_STATUS_INVALID_TAG
,

140 { 
LDNS_STATUS_TYPE_NOT_IN_BITMAP
,

143 { 
LDNS_STATUS_INVALID_RDF_TYPE
,

145 { 
LDNS_STATUS_RDATA_OVERFLOW
, "Rdata size overflow" },

146 { 0, 
NULL
 }

150 
	$ldns_gë_îr‹°r_by_id
(
ldns_°©us
 
îr
)

152 
ldns_lookup_èbÀ
 *
…
;

154 
…
 = 
	`ldns_lookup_by_id
(
ldns_îr‹_°r
, 
îr
);

156 i‡(
…
) {

157  
…
->
«me
;

159  
NULL
;

160 
	}
}

	@examples/fake-rfc2553.h

39 #i‚de‡
_FAKE_RFC2553_H


40 
	#_FAKE_RFC2553_H


	)

42 
	~<sys/ty≥s.h
>

43 
	~<sys/sockë.h
>

44 
	~<√tdb.h
>

45 
	~<limôs.h
>

50 #i‚de‡
HAVE_STRUCT_SOCKADDR_STORAGE


51 #i‚de‡
_SS_MAXSIZE


52 
	#_SS_MAXSIZE
 128

	)

53 
	#_SS_PADSIZE
 (
_SS_MAXSIZE
 -  (
sockaddr
))

	)

54 
	ssockaddr_°‹age
 {

55 
sockaddr
 
	mss_ß
;

56 
	m__ss_∑d2
[
_SS_PADSIZE
];

58 
	#ss_Ámûy
 
ss_ß
.
ß_Ámûy


	)

62 #i‚de‡
IN6_IS_ADDR_LOOPBACK


63 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

64 (((
uöt32_t
 *)(
a
))[0] == 0 && ((uint32_t *)(a))[1] == 0 && \

65 ((
uöt32_t
 *)(
a
))[2] =0 && ((uöt32_à*)◊))[3] =
	`ht⁄l
(1))

	)

68 #i‚de‡
HAVE_STRUCT_IN6_ADDR


69 
	sö6_addr
 {

70 
uöt8_t
 
	ms6_addr
[16];

74 #i‚de‡
HAVE_STRUCT_SOCKADDR_IN6


75 
	ssockaddr_ö6
 {

76 
	msö6_Ámûy
;

77 
uöt16_t
 
	msö6_p‹t
;

78 
uöt32_t
 
	msö6_Êowöfo
;

79 
ö6_addr
 
	msö6_addr
;

83 #i‚de‡
AF_INET6


85 
	#AF_INET6
 
AF_MAX


	)

92 #i‚de‡
NI_NUMERICHOST


93 
	#NI_NUMERICHOST
 (1)

	)

95 #i‚de‡
NI_NAMEREQD


96 
	#NI_NAMEREQD
 (1<<1)

	)

98 #i‚de‡
NI_NUMERICSERV


99 
	#NI_NUMERICSERV
 (1<<2)

	)

102 #i‚de‡
AI_PASSIVE


103 
	#AI_PASSIVE
 (1)

	)

105 #i‚de‡
AI_CANONNAME


106 
	#AI_CANONNAME
 (1<<1)

	)

108 #i‚de‡
AI_NUMERICHOST


109 
	#AI_NUMERICHOST
 (1<<2)

	)

112 #i‚de‡
NI_MAXSERV


113 
	#NI_MAXSERV
 32

	)

115 #i‚de‡
NI_MAXHOST


116 
	#NI_MAXHOST
 1025

	)

119 #i‚de‡
INT_MAX


120 
	#INT_MAX
 0xffffffff

	)

123 #i‚de‡
EAI_NODATA


124 
	#EAI_NODATA
 (
INT_MAX
 - 1)

	)

126 #i‚de‡
EAI_MEMORY


127 
	#EAI_MEMORY
 (
INT_MAX
 - 2)

	)

129 #i‚de‡
EAI_NONAME


130 
	#EAI_NONAME
 (
INT_MAX
 - 3)

	)

132 #i‚de‡
EAI_SYSTEM


133 
	#EAI_SYSTEM
 (
INT_MAX
 - 4)

	)

136 #i‚de‡
HAVE_STRUCT_ADDRINFO


137 
	saddröfo
 {

138 
	mai_Êags
;

139 
	mai_Ámûy
;

140 
	mai_sockty≥
;

141 
	mai_¥Ÿocﬁ
;

142 
size_t
 
	mai_addæí
;

143 *
	mai_ˇn⁄«me
;

144 
sockaddr
 *
	mai_addr
;

145 
addröfo
 *
	mai_√xt
;

149 #i‚de‡
HAVE_GETADDRINFO


150 #ifde‡
gëaddröfo


151 #unde‡
gëaddröfo


153 
	#gëaddröfo
(
a
,
b
,
c
,
d
Ë(
	`ssh_gëaddröfo
◊,b,c,d))

	)

154 
gëaddröfo
(const *, const *,

155 c⁄° 
addröfo
 *, addrinfo **);

158 #i‡!
deföed
(
HAVE_GAI_STRERROR
Ë&& !deföed(
HAVE_CONST_GAI_STRERROR_PROTO
)

159 
	#gai_°ªº‹
(
a
Ë(
	`ssh_gai_°ªº‹
◊))

	)

160 *
gai_°ªº‹
();

163 #i‚de‡
HAVE_FREEADDRINFO


164 
	#‰ìaddröfo
(
a
Ë(
	`ssh_‰ìaddröfo
◊))

	)

165 
‰ìaddröfo
(
addröfo
 *);

168 #i‚de‡
HAVE_GETNAMEINFO


169 
	#gë«meöfo
(
a
,
b
,
c
,
d
,
e
,
f
,
g
Ë(
	`ssh_gë«meöfo
◊,b,c,d,e,f,g))

	)

170 
gë«meöfo
(c⁄° 
sockaddr
 *, 
size_t
, *, size_t,

171 *, 
size_t
, );

	@examples/ldns-chaos.c

10 
	~"c⁄fig.h
"

12 
	~<ldns/ldns.h
>

15 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

16 
	`Ârötf
(
Â
, "%†£rvî\n", 
¥og
);

17 
	`Ârötf
(
Â
, "Örint out some informationábout server\n");

19 
	}
}

22 
	$maö
(
¨gc
, *
¨gv
[])

24 
ldns_ªsﬁvî
 *
ªs
;

25 
ldns_rdf
 *
«me
;

26 
ldns_rdf
 *
vîsi⁄
, *
id
;

27 
ldns_pkt
 *
p
;

28 
ldns_º_li°
 *
addr
;

29 
ldns_º_li°
 *
öfo
;

30 
ldns_°©us
 
s
;

31 
ldns_rdf
 *
p›
;

32 
size_t
 
i
;

34 i‡(
¨gc
 != 2) {

35 
	`ußge
(
°dout
, 
¨gv
[0]);

36 
	`exô
(
EXIT_FAILURE
);

39 
«me
 = 
	`ldns_d«me_√w_‰m_°r
(
¨gv
[1]);

40 i‡(!
«me
) {

41 
	`ußge
(
°dout
, 
¨gv
[0]);

42 
	`exô
(
EXIT_FAILURE
);

47 
vîsi⁄
 = 
	`ldns_d«me_√w_‰m_°r
("version.bind");

48 
id
 = 
	`ldns_d«me_√w_‰m_°r
("hostname.bind");

51 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
ªs
, 
NULL
);

52 i‡(
s
 !
LDNS_STATUS_OK
) {

53 
	`ldns_rdf_dìp_‰ì
(
«me
);

54 
	`exô
(
EXIT_FAILURE
);

56 
	`ldns_ªsﬁvî_£t_ªåy
(
ªs
, 1);

59 
addr
 = 
	`ldns_gë_º_li°_addr_by_«me
(
ªs
, 
«me
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

60 i‡(!
addr
) {

61 
	`Ârötf
(
°dîr
, " *** couldÇŸ gëá¿addªs†f‹ %s\n", 
¨gv
[1]);

62 
	`ldns_rdf_dìp_‰ì
(
«me
);

63 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

64 
	`exô
(
EXIT_FAILURE
);

68 (
p›
 = 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
))Ë{ 
	`ldns_rdf_dìp_‰ì
(pop); }

72 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
addr
); i++) {

73 i‡(
i
 > 0) {

74 
	`Ârötf
(
°dout
, "\n");

77 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º
(
ªs
,

78 
	`ldns_º_li°_º
(
addr
, 
i
)Ë!
LDNS_STATUS_OK
) {

79 
	`¥ötf
("ErroráddingÇameserverÅoÑesolver\n");

82 
	`ldns_º_¥öt
(
°dout
, 
	`ldns_º_li°_º
(
addr
, 
i
));

83 
	`Ârötf
(
°dout
, "\n");

85 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
vîsi⁄
, 
LDNS_RR_TYPE_TXT
,

86 
LDNS_RR_CLASS_CH
, 
LDNS_RD
);

87 i‡(
p
) {

88 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

89 
öfo
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

90 
LDNS_RR_TYPE_TXT
, 
LDNS_SECTION_ANSWER
);

92 i‡(
öfo
) {

93 
	`ldns_º_li°_¥öt
(
°dout
, 
öfo
);

94 
	`ldns_º_li°_dìp_‰ì
(
öfo
);

96 
	`¥ötf
(" *** versionÑetrieval failed\n");

98 
	`ldns_pkt_‰ì
(
p
);

100 
	`¥ötf
(" *** query failed\n");

103 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
id
, 
LDNS_RR_TYPE_TXT
,

104 
LDNS_RR_CLASS_CH
, 
LDNS_RD
);

105 i‡(
p
) {

106 
öfo
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

107 
LDNS_RR_TYPE_TXT
, 
LDNS_SECTION_ANSWER
);

108 i‡(
öfo
) {

109 
	`ldns_º_li°_¥öt
(
°dout
, 
öfo
);

110 
	`ldns_º_li°_dìp_‰ì
(
öfo
);

112 
	`¥ötf
(" *** idÑetrieval failed\n");

114 
	`ldns_pkt_‰ì
(
p
);

116 
	`¥ötf
(" *** query failed for\n");

118 
	`ldns_rdf_dìp_‰ì
(
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
));

122 
	`ldns_rdf_dìp_‰ì
(
«me
);

123 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

124 
	`exô
(
EXIT_SUCCESS
);

125 
	}
}

	@examples/ldns-compare-zones.c

11 
	~"c⁄fig.h
"

12 
	~<uni°d.h
>

13 
	~<°dlib.h
>

14 
	~<°d¨g.h
>

15 
	~<time.h
>

17 
	~<ldns/ldns.h
>

19 
	~<î∫o.h
>

21 
	#OP_INS
 '+'

	)

22 
	#OP_DEL
 '-'

	)

23 
	#OP_CHG
 '~'

	)

26 
	$ußge
(*
¥og
)

28 
	`¥ötf
("Usage: %s [-v] [-i] [-d] [-c] [-s] <zonefile1> <zonefile2>\n",

29 
¥og
);

30 
	`¥ötf
(" -i -Örint inserted\n");

31 
	`¥ötf
(" -d -Örint deleted\n");

32 
	`¥ötf
(" -c -Örint changed\n");

33 
	`¥ötf
(" -a -Örintáll differences (-i -d -c)\n");

34 
	`¥ötf
(" -s - doÇotÉxclude SOAÑecord from comparison\n");

35 
	`¥ötf
(" -z - doÇot sort zones\n");

36 
	`¥ötf
(" -h - show usageándÉxit\n");

37 
	`¥ötf
(" -v - showÅhe versionándÉxit\n");

38 
	}
}

41 
	$maö
(
¨gc
, **
¨gv
)

43 *
‚1
, *
‚2
;

44 
FILE
 *
Â1
, *
Â2
;

45 
ldns_z⁄e
 *
z1
, *
z2
;

46 
ldns_°©us
 
s
;

47 
size_t
 
i
 , 
j
;

48 
ldns_º_li°
 *
ºl1
, *
ºl2
;

49 
º_cmp
, 
º_chg
 = 0;

50 
ldns_º
 *
º1
 = 
NULL
, *
º2
 = NULL, *
ºx
 = NULL;

51 
löe_ƒ1
 = 0, 
löe_ƒ2
 = 0;

52 
size_t
 
ºc1
 , 
ºc2
;

53 
size_t
 
num_ös
 = 0, 
num_dñ
 = 0, 
num_chg
 = 0;

54 
c
;

55 
boﬁ
 
›t_dñëed
 = 
Ál£
, 
›t_ö£πed
 = fÆ£, 
›t_ch™ged
 = false;

56 
boﬁ
 
s‹t
 = 
åue
, 
öc_sﬂ
 = 
Ál£
;

57 
›
 = 0;

59 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "ahvdicsz")) != -1) {

60 
c
) {

62 
	`ußge
(
¨gv
[0]);

63 
	`exô
(
EXIT_SUCCESS
);

66 
	`¥ötf
("%s version %s (ldns version %s)\n",

67 
¨gv
[0],

68 
LDNS_VERSION
,

69 
	`ldns_vîsi⁄
());

70 
	`exô
(
EXIT_SUCCESS
);

73 
öc_sﬂ
 = 
åue
;

76 
s‹t
 = 
Ál£
;

79 
›t_dñëed
 = 
åue
;

82 
›t_ö£πed
 = 
åue
;

85 
›t_ch™ged
 = 
åue
;

88 
›t_dñëed
 = 
åue
;

89 
›t_ö£πed
 = 
åue
;

90 
›t_ch™ged
 = 
åue
;

95 
¨gc
 -
›töd
;

96 
¨gv
 +
›töd
;

98 i‡(
¨gc
 != 2) {

99 
¨gc
 -
›töd
;

100 
¨gv
 -
›töd
;

101 
	`ußge
(
¨gv
[0]);

102 
	`exô
(
EXIT_FAILURE
);

104 
‚1
 = 
¨gv
[0];

105 
Â1
 = 
	`f›í
(
‚1
, "r");

106 i‡(!
Â1
) {

107 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
‚1
, 
	`°ªº‹
(
î∫o
));

108 
	`exô
(
EXIT_FAILURE
);

111 
s
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z1
, 
Â1
, 
NULL
, 0,

112 
LDNS_RR_CLASS_IN
, &
löe_ƒ1
);

113 i‡(
s
 !
LDNS_STATUS_OK
) {

114 
	`f˛o£
(
Â1
);

115 
	`Ârötf
(
°dîr
, "%s: %sát %d\n",

116 
‚1
,

117 
	`ldns_gë_îr‹°r_by_id
(
s
),

118 
löe_ƒ1
);

119 
	`exô
(
EXIT_FAILURE
);

121 
	`f˛o£
(
Â1
);

123 
‚2
 = 
¨gv
[1];

124 
Â2
 = 
	`f›í
(
‚2
, "r");

125 i‡(!
Â2
) {

126 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
‚2
, 
	`°ªº‹
(
î∫o
));

127 
	`exô
(
EXIT_FAILURE
);

130 
s
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z2
, 
Â2
, 
NULL
, 0,

131 
LDNS_RR_CLASS_IN
, &
löe_ƒ2
);

132 i‡(
s
 !
LDNS_STATUS_OK
) {

133 
	`ldns_z⁄e_dìp_‰ì
(
z1
);

134 
	`f˛o£
(
Â2
);

135 
	`Ârötf
(
°dîr
, "%s: %sát %d\n",

136 
‚2
,

137 
	`ldns_gë_îr‹°r_by_id
(
s
),

138 
löe_ƒ2
);

139 
	`exô
(
EXIT_FAILURE
);

141 
	`f˛o£
(
Â2
);

143 
ºl1
 = 
	`ldns_z⁄e_ºs
(
z1
);

144 
ºc1
 = 
	`ldns_º_li°_º_cou¡
(
ºl1
);

146 
ºl2
 = 
	`ldns_z⁄e_ºs
(
z2
);

147 
ºc2
 = 
	`ldns_º_li°_º_cou¡
(
ºl2
);

149 i‡(
s‹t
) {

151 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_z⁄e_sﬂ
(
z1
));

152 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z1
)); i++) {

153 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z1
), 
i
));

156 
	`ldns_z⁄e_s‹t
(
z1
);

158 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_z⁄e_sﬂ
(
z2
));

159 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z2
)); i++) {

160 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z2
), 
i
));

163 
	`ldns_z⁄e_s‹t
(
z2
);

166 if(
öc_sﬂ
) {

167 
ldns_º_li°
* 
wsﬂ
 = 
	`ldns_º_li°_√w
();

168 
	`ldns_º_li°_push_º
(
wsﬂ
, 
	`ldns_z⁄e_sﬂ
(
z1
));

169 
	`ldns_º_li°_ˇt
(
wsﬂ
, 
ºl1
);

170 
ºl1
 = 
wsﬂ
;

171 
ºc1
 = 
	`ldns_º_li°_º_cou¡
(
ºl1
);

172 
wsﬂ
 = 
	`ldns_º_li°_√w
();

173 
	`ldns_º_li°_push_º
(
wsﬂ
, 
	`ldns_z⁄e_sﬂ
(
z2
));

174 
	`ldns_º_li°_ˇt
(
wsﬂ
, 
ºl2
);

175 
ºl2
 = 
wsﬂ
;

176 
ºc2
 = 
	`ldns_º_li°_º_cou¡
(
ºl2
);

177 if(
s‹t
) {

178 
	`ldns_º_li°_s‹t
(
ºl1
);

179 
	`ldns_º_li°_s‹t
(
ºl2
);

189 
i
 = 0, 
j
 = 0; i < 
ºc1
 || j < 
ºc2
;) {

190 
º_cmp
 = 0;

191 i‡(
i
 < 
ºc1
 && 
j
 < 
ºc2
) {

192 
º1
 = 
	`ldns_º_li°_º
(
ºl1
, 
i
);

193 
º2
 = 
	`ldns_º_li°_º
(
ºl2
, 
j
);

194 
º_cmp
 = 
	`ldns_º_com∑ª
(
º1
, 
º2
);

197 i‡(
º_cmp
 == 0) {

198 
i
++;

199 
j
++;

202 
º_chg
 = 
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
º1
),

203 
	`ldns_º_ow√r
(
º2
));

204 } i‡(
i
 >
ºc1
) {

208 
º1
 = 
NULL
;

209 
º2
 = 
	`ldns_º_li°_º
(
ºl2
, 
j
);

210 
º_chg
 = 
º_cmp
 = 1;

211 } i‡(
j
 >
ºc2
) {

215 
º1
 = 
	`ldns_º_li°_º
(
ºl1
, 
i
);

216 
º2
 = 
NULL
;

217 
º_chg
 = 
º_cmp
 = -1;

219 i‡(
º_cmp
 < 0) {

220 
i
++;

221 i‡((
ºx
 !
NULL
Ë&& (
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
º1
),

222 
	`ldns_º_ow√r
(
ºx
)

225 
ºx
 = 
NULL
;

227 i‡(
ºx
 =
NULL
) {

228 i‡(
º_chg
 == 0) {

229 
num_chg
++;

230 
›
 = 
OP_CHG
;

232 
num_dñ
++;

233 
›
 = 
OP_DEL
;

235 
ºx
 = 
º1
;

237 i‡(((
›
 =
OP_DEL
Ë&& 
›t_dñëed
) ||

238 ((
›
 =
OP_CHG
Ë&& 
›t_ch™ged
)) {

239 
	`¥ötf
("%c-", 
›
);

240 
	`ldns_º_¥öt
(
°dout
, 
º1
);

242 } i‡(
º_cmp
 > 0) {

243 
j
++;

244 i‡((
ºx
 !
NULL
Ë&& (
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
º2
),

245 
	`ldns_º_ow√r
(
ºx
)

247 
ºx
 = 
NULL
;

249 i‡(
ºx
 =
NULL
) {

250 i‡(
º_chg
 == 0) {

251 
num_chg
++;

252 
›
 = 
OP_CHG
;

254 
num_ös
++;

255 
›
 = 
OP_INS
;

258 
ºx
 = 
º2
;

260 i‡(((
›
 =
OP_INS
Ë&& 
›t_ö£πed
) ||

261 ((
›
 =
OP_CHG
Ë&& 
›t_ch™ged
)) {

262 
	`¥ötf
("%c+", 
›
);

263 
	`ldns_º_¥öt
(
°dout
, 
º2
);

268 
	`¥ötf
("\t%c%u\t%c%u\t%c%u\n",

269 
OP_INS
,

270 (Ë
num_ös
,

271 
OP_DEL
,

272 (Ë
num_dñ
,

273 
OP_CHG
,

274 (Ë
num_chg
);

277 if(
öc_sﬂ
) {

278 
	`ldns_º_li°_‰ì
(
ºl1
);

279 
	`ldns_º_li°_‰ì
(
ºl2
);

281 
	`ldns_z⁄e_dìp_‰ì
(
z2
);

282 
	`ldns_z⁄e_dìp_‰ì
(
z1
);

285 
	}
}

	@examples/ldns-dane.c

14 
	~"c⁄fig.h
"

15 
	~<uni°d.h
>

16 
	~<°dlib.h
>

17 
	~<sys/ty≥s.h
>

19 #ifde‡
HAVE_NETINET_IN_H


20 
	~<√töë/ö.h
>

22 #ifde‡
HAVE_SYS_SOCKET_H


23 
	~<sys/sockë.h
>

25 #ifde‡
HAVE_NETDB_H


26 
	~<√tdb.h
>

28 #ifde‡
HAVE_ARPA_INET_H


29 
	~<¨∑/öë.h
>

31 
	~<sys/time.h
>

32 
	~<î∫o.h
>

33 
	~<f˙é.h
>

35 
	~<ldns/ldns.h
>

36 
	~<î∫o.h
>

38 #ifde‡
USE_DANE


39 #ifde‡
HAVE_SSL


40 
	~<›ís¶/s¶.h
>

41 
	~<›ís¶/îr.h
>

42 
	~<›ís¶/x509v3.h
>

44 #i‚de‡
IPPROTO_SCTP


45 
	#IPPROTO_SCTP
 132

	)

48 
	#LDNS_ERR
(
code
, 
msg
Ëdÿ{ i‡(codê!
LDNS_STATUS_OK
) \

49 
	`ldns_îr
(
msg
, 
code
); } 
Ál£
)

	)

50 
	#MEMERR
(
msg
Ëdÿ{ 
	`Ârötf
(
°dîr
, "memoryÉrror in %s\n", msg); \

51 
	`exô
(
EXIT_FAILURE
); } 
Ál£
)

	)

52 
	#BUFSIZE
 16384

	)

57 
	#NO_TLSAS_EXIT_STATUS
 2

	)

62 
	$¥öt_ußge
(c⁄° * 
¥og«me
)

64 
	`¥ötf
("Ußge: %†[OPTIONS] vîify <«me> <p‹t>\n", 
¥og«me
);

65 
	`¥ötf
(" or: %†[OPTIONS] -à<éßfûe> vîify\n", 
¥og«me
);

66 
	`¥ötf
("\n\tVerifyÅhe TLS connectionát <name>:<port> or"

69 
	`¥ötf
("\n or: %s [OPTIONS] create <name> <port> [<usage> "

70 "[<£À˘‹> [<ty≥>]]]\n", 
¥og«me
);

71 
	`¥ötf
("\n\tUseÅhe TLS connection(s)Åo <name> <port> "

75 
	`¥ötf
("\n\t<usage>"

80 
	`¥ötf
("\n\t<selector>"

83 
	`¥ötf
("\n\t<type>"

88 
	`¥ötf
("OPTIONS:\n");

89 
	`¥ötf
("\t-h\t\tshowÅhisÅext\n");

90 
	`¥ötf
("\t-4\t\tTLS connect IPv4 only\n");

91 
	`¥ötf
("\t-6\t\tTLS connect IPv6 only\n");

92 
	`¥ötf
("\t-a <address>\t"

94 
	`¥ötf
("\t-b\t\t"

97 
	`¥ötf
("\t-c <certfile>\t"

101 
	`¥ötf
("\t-d\t\tassume DNSSEC validityÉven when insecure or bogus\n");

102 
	`¥ötf
("\t-f <CAfile>\tuse CAfileÅo validate\n");

103 #i‡
HAVE_DANE_CA_FILE


104 
	`¥ötf
("\t\t\tDeÁu… i†%s\n", 
LDNS_DANE_CA_FILE
);

106 
	`¥ötf
("\t-i\t\tinteractáfter connecting\n");

107 
	`¥ötf
("\t-k <keyfile>\t"

111 
	`¥ötf
("\t\t\tDeÁu… i†%s\n", 
LDNS_TRUST_ANCHOR_FILE
);

112 
	`¥ötf
("\t-n\t\tdo *not* verify serverÇame in certificate\n");

113 
	`¥ötf
("\t-o <offset>\t"

117 
	`¥ötf
("\t-p <CApath>\t"

120 #i‡
HAVE_DANE_CA_PATH


121 
	`¥ötf
("\t\t\tDeÁu…†i†%s\n", 
LDNS_DANE_CA_PATH
);

123 
	`¥ötf
("\t-s\t\tassume PKIX validity\n");

124 
	`¥ötf
("\t-S\t\tChase signature(s)Åoá known key\n");

125 
	`¥ötf
("\t-t <tlsafile>\tdoÇot use DNS, "

128 
	`¥ötf
("\t-T\t\tReturnÉxit status 2 for PKIX validated connections\n"

130 
	`¥ötf
("\t-u\t\tuse UDPÅransport instead of TCP\n");

131 
	`¥ötf
("\t-v\t\tshow versionándÉxit\n");

133 
	`exô
(
EXIT_SUCCESS
);

134 
	}
}

137 
	$d™e_öt_wôhö_ønge
(c⁄° * 
¨g
, 
max
, c⁄° * 
«me
)

139 * 
íd±r
;

140 
vÆ
 = 
	`°πﬁ
(
¨g
, &
íd±r
, 10);

142 i‡((
vÆ
 < 0 || vÆ > 
max
)

143 || (
î∫o
 !0 && 
vÆ
 == 0)

144 || 
íd±r
 =
¨g


145 || *
íd±r
 != '\0'

147 
	`Ârötf
(
°dîr
, "<%s> should bêöÑ™gê[0-%d]\n", 
«me
, 
max
);

148 
	`exô
(
EXIT_FAILURE
);

150  
vÆ
;

151 
	}
}

153 
	sd™e_∑øm_choi˚_°ru˘
 {

154 c⁄° * 
	m«me
;

155 
	mnumbî
;

157 
d™e_∑øm_choi˚_°ru˘
 
	td™e_∑øm_choi˚
;

159 
d™e_∑øm_choi˚
 
	gd™e_˚πifiˇã_ußge_èbÀ
[] = {

169 { 
NULL
, -1 }

172 
d™e_∑øm_choi˚
 
	gd™e_£À˘‹_èbÀ
[] = {

180 { 
NULL
, -1 }

184 
	$d™e_öt_wôhö_ønge_èbÀ
(c⁄° * 
¨g
, 
max
, c⁄° * 
«me
,

185 
d™e_∑øm_choi˚
 
èbÀ
[])

187 
d™e_∑øm_choi˚
* 
t
;

189 i‡(*
¨g
) {

190 
t
 = 
èbÀ
;Å->
«me
;Å++) {

191 i‡(
	`°∫ˇ£cmp
(
¨g
, 
t
->
«me
, 
	`°æí
(arg)) == 0) {

192  
t
->
numbî
;

196  
	`d™e_öt_wôhö_ønge
(
¨g
, 
max
, 
«me
);

197 
	}
}

200 
	$s¶_îr
(c⁄° * 
s
)

202 
	`Ârötf
(
°dîr
, "îr‹: %s\n", 
s
);

203 
	`ERR_¥öt_îr‹s_Â
(
°dîr
);

204 
	`exô
(
EXIT_FAILURE
);

205 
	}
}

208 
	$ldns_îr
(c⁄° * 
s
, 
ldns_°©us
 
îr
)

210 i‡(
îr
 =
LDNS_STATUS_SSL_ERR
) {

211 
	`s¶_îr
(
s
);

213 
	`Ârötf
(
°dîr
, "%s: %s\n", 
s
, 
	`ldns_gë_îr‹°r_by_id
(
îr
));

214 
	`exô
(
EXIT_FAILURE
);

216 
	}
}

218 
ldns_°©us


219 
s¶_c⁄√˘_™d_gë_˚π_chaö
(

220 
X509
** 
˚π
, 
STACK_OF
(X509)** 
exåa_˚πs
,

221 
SSL
* 
s¶
, c⁄° * 
«me_°r
,

222 
ldns_rdf
* 
addªss
, 
uöt16_t
 
p‹t
,

223 
ldns_d™e_å™•‹t
 
å™•‹t
)

225 
sockaddr_°‹age
 *
	ga
 = 
NULL
;

226 
size_t
 
	ga_Àn
 = 0;

227 
	gsock
;

228 
	gr
;

230 
as£π
(
˚π
 !
NULL
);

231 
as£π
(
exåa_˚πs
 !
NULL
);

233 
	ga
 = 
ldns_rdf2«tive_sockaddr_°‹age
(
addªss
, 
p‹t
, &
a_Àn
);

234 
	gå™•‹t
) {

235 
	gLDNS_DANE_TRANSPORT_TCP
:

237 
sock
 = 
sockë
(()((
sockaddr
*)
a
)->
ß_Ámûy
,

238 
SOCK_STREAM
, 
IPPROTO_TCP
);

241 
	gLDNS_DANE_TRANSPORT_UDP
:

243 
sock
 = 
sockë
(()((
sockaddr
*)
a
)->
ß_Ámûy
,

244 
SOCK_DGRAM
, 
IPPROTO_UDP
);

247 
	gLDNS_DANE_TRANSPORT_SCTP
:

249 
sock
 = 
sockë
(()((
sockaddr
*)
a
)->
ß_Ámûy
,

250 
SOCK_STREAM
, 
IPPROTO_SCTP
);

254 
LDNS_FREE
(
a
);

255  
	gLDNS_STATUS_DANE_UNKNOWN_TRANSPORT
;

257 i‡(
	gsock
 == -1) {

258 
LDNS_FREE
(
a
);

259  
	gLDNS_STATUS_NETWORK_ERR
;

261 i‡(
c⁄√˘
(
sock
, (
sockaddr
*)
a
, (
sockÀn_t
)
a_Àn
) == -1) {

262 
LDNS_FREE
(
a
);

263  
	gLDNS_STATUS_NETWORK_ERR
;

265 
LDNS_FREE
(
a
);

266 i‡(! 
SSL_˛ór
(
s¶
)) {

267 
˛o£
(
sock
);

268 
Ârötf
(
°dîr
, "SSL_clear\n");

269  
	gLDNS_STATUS_SSL_ERR
;

271 #ifde‡
SSL_CTRL_SET_TLSEXT_HOSTNAME


272 (Ë
SSL_£t_é£xt_ho°_«me
(
s¶
, 
«me_°r
);

274 
SSL_£t_c⁄√˘_°©e
(
s¶
);

275 (Ë
SSL_£t_mode
(
s¶
, 
SSL_MODE_AUTO_RETRY
);

276 i‡(! 
SSL_£t_fd
(
s¶
, 
sock
)) {

277 
˛o£
(
sock
);

278 
Ârötf
(
°dîr
, "SSL_set_fd\n");

279  
	gLDNS_STATUS_SSL_ERR
;

282 
ERR_˛ór_îr‹
();

283 i‡((
	gr
 = 
SSL_do_h™dshake
(
s¶
)) == 1) {

286 
	gr
 = 
SSL_gë_îr‹
(
s¶
, 
r
);

287 i‡(
	gr
 !
SSL_ERROR_WANT_READ
 && 
r
 !
SSL_ERROR_WANT_WRITE
) {

288 
Ârötf
(
°dîr
, "h™dshakög SSL_gë_îr‹: %d\n", 
r
);

289  
	gLDNS_STATUS_SSL_ERR
;

292 *
	g˚π
 = 
SSL_gë_≥î_˚πifiˇã
(
s¶
);

293 *
	gexåa_˚πs
 = 
SSL_gë_≥î_˚π_chaö
(
s¶
);

295  
	gLDNS_STATUS_OK
;

300 
	$s¶_öãø˘
(
SSL
* 
s¶
)

302 
fd_£t
 
rfds
;

303 
maxfd
;

304 
sock
;

305 
r
;

307 
buf
[
BUFSIZE
];

308 * 
buÂå
;

309 
to_wrôe
;

310 
wrôãn
;

312 
sock
 = 
	`SSL_gë_fd
(
s¶
);

313 i‡(
sock
 == -1) {

316 
maxfd
 = (
STDIN_FILENO
 > 
sock
 ? STDIN_FILENO : sock) + 1;

318 #i‚de‡
S_SPLINT_S


319 
	`FD_ZERO
(&
rfds
);

321 
	`FD_SET
(
sock
, &
rfds
);

322 
	`FD_SET
(
STDIN_FILENO
, &
rfds
);

324 
r
 = 
	`£À˘
(
maxfd
, &
rfds
, 
NULL
, NULL, NULL);

325 i‡(
r
 == -1) {

326 
	`≥º‹
("select");

329 i‡(
	`FD_ISSET
(
sock
, &
rfds
)) {

330 
to_wrôe
 = 
	`SSL_ªad
(
s¶
, 
buf
, 
BUFSIZE
);

331 i‡(
to_wrôe
 <= 0) {

332 
r
 = 
	`SSL_gë_îr‹
(
s¶
, 
to_wrôe
);

333 i‡(
r
 !
SSL_ERROR_ZERO_RETURN
) {

334 
	`Ârötf
(
°dîr
,

336 " %d\n", 
r
);

340 
buÂå
 = 
buf
;

341 
to_wrôe
 > 0) {

342 
wrôãn
 = (Ë
	`fwrôe
(
buÂå
, 1,

343 (
size_t
Ë
to_wrôe
, 
°dout
);

344 i‡(
wrôãn
 == 0) {

345 
	`≥º‹
("fwrite");

348 
to_wrôe
 -
wrôãn
;

349 
buÂå
 +
wrôãn
;

353 i‡(
	`FD_ISSET
(
STDIN_FILENO
, &
rfds
)) {

354 
to_wrôe
 = (Ë
	`ªad
(
STDIN_FILENO
, 
buf
, 
BUFSIZE
 - 1);

355 i‡(
to_wrôe
 <= 0) {

356 i‡(
to_wrôe
 == -1) {

357 
	`≥º‹
("read");

361 i‡(
buf
[
to_wrôe
 - 1] == '\n') {

362 
buf
[
to_wrôe
 - 1] = '\r';

363 
buf
[
to_wrôe
 ] = '\n';

364 
to_wrôe
 += 1;

366 
buÂå
 = 
buf
;

367 
to_wrôe
 > 0) {

368 
wrôãn
 = 
	`SSL_wrôe
(
s¶
, 
buÂå
, 
to_wrôe
);

369 i‡(
wrôãn
 <= 0) {

370 
r
 = 
	`SSL_gë_îr‹
(
s¶
, 
to_wrôe
);

371 i‡(
r
 !
SSL_ERROR_ZERO_RETURN
) {

372 
	`Ârötf
(
°dîr
,

374 ": %d\n", 
r
);

378 
to_wrôe
 -
wrôãn
;

379 
buÂå
 +
wrôãn
;

384 
	}
}

387 
ldns_º_li°
*

388 
	$º_li°_fûãr_º_ty≥
(
ldns_º_li°
* 
l
, 
ldns_º_ty≥
 
t
)

390 
size_t
 
i
;

391 
ldns_º
* 
º
;

392 
ldns_º_li°
* 
r
 = 
	`ldns_º_li°_√w
();

394 i‡(
r
 =
NULL
) {

395  
r
;

397 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
l
); i++) {

398 
º
 = 
	`ldns_º_li°_º
(
l
, 
i
);

399 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
t
) {

400 i‡(! 
	`ldns_º_li°_push_º
(
r
, 
º
)) {

401 
	`ldns_º_li°_‰ì
(
r
);

402  
NULL
;

406  
r
;

407 
	}
}

417 
ldns_º_li°
*

418 
	$d™e_no_pkix_å™sf‹m
(c⁄° 
ldns_º_li°
* 
éas
)

420 
size_t
 
i
;

421 
ldns_º
* 
º
;

422 
ldns_º
* 
√w_º
;

423 
ldns_rdf
* 
rdf
;

424 
ldns_º_li°
* 
r
 = 
	`ldns_º_li°_√w
();

426 i‡(
r
 =
NULL
) {

427  
r
;

429 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
éas
); i++) {

430 
º
 = 
	`ldns_º_li°_º
(
éas
, 
i
);

431 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_TLSA
) {

433 
√w_º
 = 
	`ldns_º_˛⁄e
(
º
);

434 i‡(!
√w_º
) {

435 
	`ldns_º_li°_dìp_‰ì
(
r
);

436  
NULL
;

438 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
√w_º
, 0))) {

440 
LDNS_TLSA_USAGE_CA_CONSTRAINT
:

442 
rdf
 = 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
,

443 (
uöt8_t
Ë
LDNS_TLSA_USAGE_TRUST_ANCHOR_ASSERTION
);

444 i‡(! 
rdf
) {

445 
	`ldns_º_‰ì
(
√w_º
);

446 
	`ldns_º_li°_dìp_‰ì
(
r
);

447  
NULL
;

449 (Ë
	`ldns_º_£t_rdf
(
√w_º
, 
rdf
, 0);

453 
LDNS_TLSA_USAGE_SERVICE_CERTIFICATE_CONSTRAINT
:

455 
rdf
 = 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
,

456 (
uöt8_t
Ë
LDNS_TLSA_USAGE_DOMAIN_ISSUED_CERTIFICATE
);

457 i‡(! 
rdf
) {

458 
	`ldns_º_‰ì
(
√w_º
);

459 
	`ldns_º_li°_dìp_‰ì
(
r
);

460  
NULL
;

462 (Ë
	`ldns_º_£t_rdf
(
√w_º
, 
rdf
, 0);

469 i‡(! 
	`ldns_º_li°_push_º
(
r
, 
√w_º
)) {

470 
	`ldns_º_‰ì
(
√w_º
);

471 
	`ldns_º_li°_dìp_‰ì
(
r
);

472  
NULL
;

476  
r
;

477 
	}
}

480 
	$¥öt_º_as_TYPEXXX
(
FILE
* 
out
, 
ldns_º
* 
º
)

482 
size_t
 
i
, 
sz
;

483 
ldns_°©us
 
s
;

484 
ldns_buf„r
* 
buf
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

485 * 
°r
;

487 
	`ldns_buf„r_˛ór
(
buf
);

488 
s
 = 
	`ldns_rdf2buf„r_°r_d«me
(
buf
, 
	`ldns_º_ow√r
(
º
));

489 
	`LDNS_ERR
(
s
, "couldÇotÜdns_rdf2buffer_str_dname");

490 
	`ldns_buf„r_¥ötf
(
buf
, "\t%d", 
	`ldns_º_âl
(
º
));

491 
	`ldns_buf„r_¥ötf
(
buf
, "\t");

492 
s
 = 
	`ldns_º_˛ass2buf„r_°r
(
buf
, 
	`ldns_º_gë_˛ass
(
º
));

493 
	`LDNS_ERR
(
s
, "couldÇotÜdns_rr_class2buffer_str");

494 
	`ldns_buf„r_¥ötf
(
buf
, "\tTYPE%d", 
	`ldns_º_gë_ty≥
(
º
));

495 
sz
 = 0;

496 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

497 
sz
 +
	`ldns_rdf_size
(
	`ldns_º_rdf
(
º
, 
i
));

499 
	`ldns_buf„r_¥ötf
(
buf
, "\t\\# %d ", 
sz
);

500 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

501 
s
 = 
	`ldns_rdf2buf„r_°r_hex
(
buf
, 
	`ldns_º_rdf
(
º
, 
i
));

502 
	`LDNS_ERR
(
s
, "couldÇotÜdns_rdf2buffer_str_hex");

504 
°r
 = 
	`ldns_buf„r_exp‹t2°r
(
buf
);

505 
	`ldns_buf„r_‰ì
(
buf
);

506 
	`Ârötf
(
out
, "%s\n", 
°r
);

507 
	`LDNS_FREE
(
°r
);

508 
	}
}

511 
	$¥öt_º_li°_as_TYPEXXX
(
FILE
* 
out
, 
ldns_º_li°
* 
l
)

513 
size_t
 
i
;

515 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
l
); i++) {

516 
	`¥öt_º_as_TYPEXXX
(
out
, 
	`ldns_º_li°_º
(
l
, 
i
));

518 
	}
}

520 
ldns_°©us


521 
	$ªad_key_fûe
(c⁄° *
fûíame
, 
ldns_º_li°
 *
keys
)

523 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_ERR
;

524 
ldns_º
 *
º
;

525 
FILE
 *
Â
;

526 
uöt32_t
 
my_âl
 = 0;

527 
ldns_rdf
 *
my_‹igö
 = 
NULL
;

528 
ldns_rdf
 *
my_¥ev
 = 
NULL
;

529 
löe_ƒ
;

531 i‡(!(
Â
 = 
	`f›í
(
fûíame
, "r"))) {

532  
LDNS_STATUS_FILE_ERR
;

534 !
	`„of
(
Â
)) {

535 
°©us
 = 
	`ldns_º_√w_‰m_Â_l
(&
º
, 
Â
, &
my_âl
, &
my_‹igö
,

536 &
my_¥ev
, &
löe_ƒ
);

538 i‡(
°©us
 =
LDNS_STATUS_OK
) {

540 i‡–
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_DS


541 || 
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_DNSKEY
)

543 
	`ldns_º_li°_push_º
(
keys
, 
º
);

545 } i‡–
°©us
 =
LDNS_STATUS_SYNTAX_EMPTY


546 || 
°©us
 =
LDNS_STATUS_SYNTAX_TTL


547 || 
°©us
 =
LDNS_STATUS_SYNTAX_ORIGIN


548 || 
°©us
 =
LDNS_STATUS_SYNTAX_INCLUDE
)

550 
°©us
 = 
LDNS_STATUS_OK
;

554 
	`f˛o£
(
Â
);

555  
°©us
;

556 
	}
}

559 
ldns_°©us


560 
	$d™e_£tup_ªsﬁvî
(
ldns_ªsﬁvî
** 
ªs
,

561 
ldns_º_li°
* 
keys
, 
boﬁ
 
dns£c_off
)

563 
ldns_°©us
 
s
;

565 
	`as£π
(
ªs
 !
NULL
);

567 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(
ªs
, 
NULL
);

568 i‡(
s
 =
LDNS_STATUS_OK
) {

569 
	`ldns_ªsﬁvî_£t_dns£c
(*
ªs
, ! 
dns£c_off
);

571 i‡(
keys
 && 
	`ldns_º_li°_º_cou¡
(keys) > 0) {

573 
	`ldns_ªsﬁvî_£t_dns£c_™ch‹s
(*
ªs
, 
keys
);

574 
	`ldns_ªsﬁvî_£t_dns£c_cd
(*
ªs
, 
åue
);

577  
s
;

578 
	}
}

581 
ldns_°©us


582 
	$d™e_quîy
(
ldns_º_li°
** 
ºs
, 
ldns_ªsﬁvî
* 
r
,

583 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
,

584 
boﬁ
 
ö£cuª_is_ok
)

586 
ldns_pkt
* 
p
 = 
NULL
;

587 
ldns_º_li°
* 
keys
 = 
NULL
;

588 
ldns_º_li°
* 
ºsigs
 = 
NULL
;

589 
ldns_rdf
* 
sig«me
 = 
NULL
;

590 
ldns_°©us
 
s
;

592 
	`as£π
(
ºs
 !
NULL
);

594 
p
 = 
	`ldns_ªsﬁvî_quîy
(
r
, 
«me
, 
t
, 
c
, 
LDNS_RD
);

595 i‡(! 
p
) {

596  
LDNS_STATUS_MEM_ERR
;

598 *
ºs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
t
, 
LDNS_SECTION_ANSWER
);

600 i‡(! 
	`ldns_ªsﬁvî_dns£c
(
r
)) {

602 
	`ldns_pkt_‰ì
(
p
);

603  
LDNS_STATUS_OK
;

605 i‡(
	`ldns_º_li°_º_cou¡
(*
ºs
) == 0) {

607 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë=
LDNS_RCODE_SERVFAIL
) {

609 
	`ldns_pkt_‰ì
(
p
);

610  
LDNS_STATUS_DANE_BOGUS
;

612 
	`ldns_pkt_‰ì
(
p
);

613  
LDNS_STATUS_OK
;

618 i‡(! 
	`ldns_pkt_cd
(
p
)) {

620 i‡(! 
	`ldns_pkt_ad
(
p
)) {

622 
ö£cuª
;

624 
	`ldns_pkt_‰ì
(
p
);

625  
LDNS_STATUS_OK
;

632 
ºsigs
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

633 
LDNS_RR_TYPE_RRSIG
,

634 
LDNS_SECTION_ANSWER
);

636 i‡(! 
ºsigs
 || 
	`ldns_º_li°_º_cou¡
(rrsigs) == 0) {

637 
ö£cuª
;

640 
sig«me
 = 
	`ldns_º_ºsig_sig«me
(
	`ldns_º_li°_º
(
ºsigs
, 0));

641 i‡(! 
sig«me
) {

642 
s
 = 
LDNS_STATUS_ERR
;

643 
îr‹
;

646 
s
 = 
	`ldns_vîify
(*
ºs
, 
ºsigs
, 
	`ldns_ªsﬁvî_dns£c_™ch‹s
(
r
), 
NULL
);

647 i‡(
s
 =
LDNS_STATUS_OK
) {

648 
˛ónup
;

651 
keys
 = 
	`ldns_„tch_vÆid_domaö_keys
(
r
, 
sig«me
,

652 
	`ldns_ªsﬁvî_dns£c_™ch‹s
(
r
), &
s
);

654 i‡(
s
 !
LDNS_STATUS_OK
) {

655 
îr‹
;

657 i‡(
	`ldns_º_li°_º_cou¡
(
keys
) == 0) {

658 
ö£cuª
;

660 
s
 = 
	`ldns_vîify
(*
ºs
, 
ºsigs
, 
keys
, 
NULL
);

661 
s
) {

662 
LDNS_STATUS_CRYPTO_BOGUS
: 
bogus
;

663 
LDNS_STATUS_OK
 : 
˛ónup
;

666 
ö£cuª
:

667 
s
 = 
LDNS_STATUS_DANE_INSECURE
;

668 
bogus
:

669 i‡(! 
ö£cuª_is_ok
) {

670 
îr‹
:

671 
	`ldns_º_li°_dìp_‰ì
(*
ºs
);

672 *
ºs
 = 
	`ldns_º_li°_√w
();

674 
˛ónup
:

675 i‡(
keys
) {

676 
	`ldns_º_li°_dìp_‰ì
(
keys
);

678 i‡(
ºsigs
) {

679 
	`ldns_º_li°_dìp_‰ì
(
ºsigs
);

681 
	`ldns_pkt_‰ì
(
p
);

682  
s
;

683 
	}
}

686 
ldns_º_li°
*

687 
	$d™e_lookup_addªs£s
(
ldns_ªsﬁvî
* 
ªs
, 
ldns_rdf
* 
d«me
,

688 
ai_Ámûy
)

690 
ldns_°©us
 
s
;

691 
ldns_º_li°
 *
as
 = 
NULL
;

692 
ldns_º_li°
 *
Øas
 = 
NULL
;

693 
ldns_º_li°
 *
r
 = 
	`ldns_º_li°_√w
();

695 i‡(
r
 =
NULL
) {

696 
	`MEMERR
("ldns_rr_list_new");

698 i‡(
ai_Ámûy
 =
AF_UNSPEC
 ||ái_Ámûy =
AF_INET
) {

700 
s
 = 
	`d™e_quîy
(&
as
, 
ªs
,

701 
d«me
, 
LDNS_RR_TYPE_A
, 
LDNS_RR_CLASS_IN
,

702 
åue
);

704 i‡(
s
 =
LDNS_STATUS_DANE_INSECURE
 &&

705 
	`ldns_º_li°_º_cou¡
(
as
) > 0) {

706 
	`Ârötf
(
°dîr
, "Warning! Insecure IPv4áddresses. "

709 } i‡(
s
 =
LDNS_STATUS_DANE_BOGUS
 ||

710 
LDNS_STATUS_CRYPTO_BOGUS
 =
s
) {

711 
	`Ârötf
(
°dîr
, "Warning! Bogus IPv4áddresses. "

713 
	`ldns_º_li°_dìp_‰ì
(
as
);

714 
as
 = 
	`ldns_º_li°_√w
();

716 } i‡(
s
 !
LDNS_STATUS_OK
) {

717 
	`LDNS_ERR
(
s
, "dane_query");

720 i‡(! 
	`ldns_º_li°_push_º_li°
(
r
, 
as
)) {

721 
	`MEMERR
("ldns_rr_list_push_rr_list");

724 i‡(
ai_Ámûy
 =
AF_UNSPEC
 ||ái_Ámûy =
AF_INET6
) {

726 
s
 = 
	`d™e_quîy
(&
Øas
, 
ªs
,

727 
d«me
, 
LDNS_RR_TYPE_AAAA
, 
LDNS_RR_CLASS_IN
,

728 
åue
);

730 i‡(
s
 =
LDNS_STATUS_DANE_INSECURE
 &&

731 
	`ldns_º_li°_º_cou¡
(
Øas
) > 0) {

732 
	`Ârötf
(
°dîr
, "Warning! Insecure IPv6áddresses. "

735 } i‡(
s
 =
LDNS_STATUS_DANE_BOGUS
 ||

736 
LDNS_STATUS_CRYPTO_BOGUS
 =
s
) {

737 
	`Ârötf
(
°dîr
, "Warning! Bogus IPv6áddresses. "

739 
	`ldns_º_li°_dìp_‰ì
(
Øas
);

740 
Øas
 = 
	`ldns_º_li°_√w
();

742 } i‡(
s
 !
LDNS_STATUS_OK
) {

743 
	`LDNS_ERR
(
s
, "dane_query");

746 i‡(! 
	`ldns_º_li°_push_º_li°
(
r
, 
Øas
)) {

747 
	`MEMERR
("ldns_rr_list_push_rr_list");

750  
r
;

751 
	}
}

753 
ldns_°©us


754 
	$d™e_ªad_éßs_‰om_fûe
(
ldns_º_li°
** 
éßs
,

755 * 
fûíame
, 
ldns_rdf
* 
‹igö
)

757 
FILE
* 
Â
 = 
NULL
;

758 
ldns_º
* 
º
 = 
NULL
;

759 
ldns_rdf
 *
my_‹igö
 = 
NULL
;

760 
ldns_rdf
 *
my_¥ev
 = 
NULL
;

761 
ldns_rdf
 *
‹igö_lc
 = 
NULL
;

762 
löe_ƒ
;

763 
ldns_°©us
 
s
 = 
LDNS_STATUS_MEM_ERR
;

765 
	`as£π
(
éßs
 !
NULL
);

766 
	`as£π
(
fûíame
 !
NULL
);

768 i‡(
	`°rcmp
(
fûíame
, "-") == 0) {

769 
Â
 = 
°dö
;

771 
Â
 = 
	`f›í
(
fûíame
, "r");

772 i‡(!
Â
) {

773 
	`Ârötf
(
°dîr
, "UnableÅo open %s: %s\n",

774 
fûíame
, 
	`°ªº‹
(
î∫o
));

775 
	`exô
(
EXIT_FAILURE
);

778 i‡(
‹igö
) {

779 
my_‹igö
 = 
	`ldns_rdf_˛⁄e
(
‹igö
);

780 i‡(! 
my_‹igö
) {

781 
îr‹
;

783 
my_¥ev
 = 
	`ldns_rdf_˛⁄e
(
‹igö
);

784 i‡(! 
my_¥ev
) {

785 
îr‹
;

787 
‹igö_lc
 = 
	`ldns_rdf_˛⁄e
(
‹igö
);

788 i‡(! 
‹igö_lc
) {

789 
îr‹
;

791 
	`ldns_d«me2ˇn⁄iˇl
(
‹igö_lc
);

793 *
éßs
 = 
	`ldns_º_li°_√w
();

794 i‡(! *
éßs
) {

795 
îr‹
;

797 ! 
	`„of
(
Â
)) {

798 
s
 = 
	`ldns_º_√w_‰m_Â_l
(&
º
, 
Â
, 
NULL
,

799 &
my_‹igö
, &
my_¥ev
, &
löe_ƒ
);

800 i‡(
s
 !
LDNS_STATUS_OK
) {

801 
îr‹
;

803 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_TLSA
) {

804 
	`ldns_d«me2ˇn⁄iˇl
(
	`ldns_º_ow√r
(
º
));

805 i‡(! 
‹igö
 || 
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
º
),

806 
‹igö_lc
) == 0) {

807 i‡(
	`ldns_º_li°_push_º
(*
éßs
, 
º
)) {

810 
s
 = 
LDNS_STATUS_MEM_ERR
;

811 
îr‹
;

815 
	`ldns_º_‰ì
(
º
);

818 
	`ldns_rdf_dìp_‰ì
(
‹igö_lc
);

819 
	`ldns_rdf_dìp_‰ì
(
my_¥ev
);

820 
	`ldns_rdf_dìp_‰ì
(
my_‹igö
);

821 
	`f˛o£
(
Â
);

823  
LDNS_STATUS_OK
;

825 
îr‹
:

826 i‡(*
éßs
) {

827 
	`ldns_º_li°_dìp_‰ì
(*
éßs
);

828 *
éßs
 = 
NULL
;

830 i‡(
‹igö_lc
) {

831 
	`ldns_rdf_dìp_‰ì
(
‹igö_lc
);

833 i‡(
my_¥ev
) {

834 
	`ldns_rdf_dìp_‰ì
(
my_¥ev
);

836 i‡(
my_‹igö
) {

837 
	`ldns_rdf_dìp_‰ì
(
my_‹igö
);

839 i‡(
Â
 && f∞!
°dö
) {

840 
	`f˛o£
(
Â
);

842  
s
;

843 
	}
}

845 
boﬁ


846 
	$d™e_wûdˇrd_œbñ_cmp
(
uöt8_t
 
iw
, c⁄° * 
w
, uöt8_à
û
, c⁄° * 
l
)

848 i‡(
iw
 == 0) {

849 i‡(
û
 == 0) {

850  
åue
;

852  
Ál£
;

855 i‡(*
w
 == '*') {

856 i‡(
iw
 == 1) {

858  
åue
;

860 
û
 > 0) {

862 i‡(
w
[1] =*
l
) {

865 i‡(
	`d™e_wûdˇrd_œbñ_cmp
(

866 
iw
 - 1, 
w
 + 1,

867 
û
 , 
l
)) {

868  
åue
;

871 
l
 += 1;

872 
û
 -= 1;

876 
û
 > 0 && 
iw
 > 0 && *
w
 !'*' && *w =*
l
) {

877 
w
 += 1;

878 
l
 += 1;

879 
û
 -= 1;

880 
iw
 -= 1;

882 } 
iw
 > 0 && *
w
 == '*' &&

883 (
û
 > 0 || 
iw
 == 1));

885  
iw
 =0 && 
û
 == 0;

886 
	}
}

888 
boﬁ


889 
	$d™e_œbñ_m©ches_œbñ
(
ldns_rdf
* 
w
,Üdns_rdf* 
l
)

891 
uöt8_t
 
iw
;

892 
uöt8_t
 
û
;

894 
iw
 = 
	`ldns_rdf_d©a
(
w
)[0];

895 
û
 = 
	`ldns_rdf_d©a
(
l
)[0];

896  
	`d™e_wûdˇrd_œbñ_cmp
(

897 
iw
, (c⁄° *)
	`ldns_rdf_d©a
(
w
) + 1,

898 
û
, (c⁄° *)
	`ldns_rdf_d©a
(
l
) + 1);

899 
	}
}

901 
boﬁ


902 
	$d™e_«me_m©ches_£rvî_«me
(c⁄° * 
«me_°r
, 
ldns_rdf
* 
£rvî_«me
)

904 
ldns_rdf
* 
«me
;

905 
uöt8_t
 
¬
, 
ns
, 
i
;

906 
ldns_rdf
* 
 
;

907 
ldns_rdf
* 
ls
;

909 
«me
 = 
	`ldns_d«me_√w_‰m_°r
((c⁄° *)
«me_°r
);

910 i‡(! 
«me
) {

911 
	`LDNS_ERR
(
LDNS_STATUS_ERR
, "ldns_dname_new_frm_str");

913 
¬
 = 
	`ldns_d«me_œbñ_cou¡
(
«me
);

914 
ns
 = 
	`ldns_d«me_œbñ_cou¡
(
£rvî_«me
);

915 i‡(
¬
 !
ns
) {

916 
	`ldns_rdf_‰ì
(
«me
);

917  
Ál£
;

919 
	`ldns_d«me2ˇn⁄iˇl
(
«me
);

920 
i
 = 0; i < 
¬
; i++) {

921 
 
 = 
	`ldns_d«me_œbñ
(
«me
, 
i
);

922 i‡(! 
 
) {

923  
Ál£
;

925 
ls
 = 
	`ldns_d«me_œbñ
(
£rvî_«me
, 
i
);

926 i‡(! 
ls
) {

927 
	`ldns_rdf_‰ì
(
 
);

928  
Ál£
;

930 i‡(! 
	`d™e_œbñ_m©ches_œbñ
(
 
, 
ls
)) {

931 
	`ldns_rdf_‰ì
(
 
);

932 
	`ldns_rdf_‰ì
(
ls
);

933  
Ál£
;

935 
	`ldns_rdf_‰ì
(
 
);

936 
	`ldns_rdf_‰ì
(
ls
);

938  
åue
;

939 
	}
}

941 
boﬁ


942 
	$d™e_X509_™y_subje˘_Æt_«me_m©ches_£rvî_«me
(

943 
X509
 *
˚π
, 
ldns_rdf
* 
£rvî_«me
)

945 
GENERAL_NAMES
* 
«mes
;

946 
GENERAL_NAME
* 
«me
;

947 * 
subje˘_Æt_«me_°r
 = 
NULL
;

948 
i
, 
n
;

950 
«mes
 = 
	`X509_gë_ext_d2i
(
˚π
, 
NID_subje˘_Æt_«me
, 0, 0 );

951 i‡(! 
«mes
) {

952  
Ál£
;

954 
n
 = 
	`sk_GENERAL_NAME_num
(
«mes
);

955 
i
 = 0; i < 
n
; i++) {

956 
«me
 = 
	`sk_GENERAL_NAME_vÆue
(
«mes
, 
i
);

957 i‡(
«me
->
ty≥
 =
GEN_DNS
) {

958 (Ë
	`ASN1_STRING_to_UTF8
(&
subje˘_Æt_«me_°r
,

959 
«me
->
d
.
dNSName
);

960 i‡(
subje˘_Æt_«me_°r
) {

961 i‡(
	`d™e_«me_m©ches_£rvî_«me
((*)

962 
subje˘_Æt_«me_°r
,

963 
£rvî_«me
)) {

964 
	`OPENSSL_‰ì
(
subje˘_Æt_«me_°r
);

965  
åue
;

967 
	`OPENSSL_‰ì
(
subje˘_Æt_«me_°r
);

972  
Ál£
;

973 
	}
}

975 
boﬁ


976 
	$d™e_X509_subje˘_«me_m©ches_£rvî_«me
(
X509
 *
˚π
, 
ldns_rdf
* 
£rvî_«me
)

978 
X509_NAME
* 
subje˘_«me
;

979 
i
;

980 
X509_NAME_ENTRY
* 
íåy
;

981 
ASN1_STRING
* 
íåy_d©a
;

982 * 
subje˘_«me_°r
 = 
NULL
;

983 
boﬁ
 
r
;

985 
subje˘_«me
 = 
	`X509_gë_subje˘_«me
(
˚π
);

986 i‡(! 
subje˘_«me
 ) {

987 
	`s¶_îr
("couldÇot X509_get_subject_name");

989 
i
 = 
	`X509_NAME_gë_ödex_by_NID
(
subje˘_«me
, 
NID_comm⁄Name
, -1);

990 
íåy
 = 
	`X509_NAME_gë_íåy
(
subje˘_«me
, 
i
);

991 
íåy_d©a
 = 
	`X509_NAME_ENTRY_gë_d©a
(
íåy
);

992 (Ë
	`ASN1_STRING_to_UTF8
(&
subje˘_«me_°r
, 
íåy_d©a
);

993 i‡(
subje˘_«me_°r
) {

994 
r
 = 
	`d™e_«me_m©ches_£rvî_«me
(

995 (*)
subje˘_«me_°r
, 
£rvî_«me
);

996 
	`OPENSSL_‰ì
(
subje˘_«me_°r
);

997  
r
;

999  
Ál£
;

1001 
	}
}

1003 
boﬁ


1004 
	$d™e_vîify_£rvî_«me
(
X509
* 
˚π
, 
ldns_rdf
* 
£rvî_«me
)

1006 
ldns_rdf
* 
£rvî_«me_lc
;

1007 
boﬁ
 
r
;

1008 
£rvî_«me_lc
 = 
	`ldns_rdf_˛⁄e
(
£rvî_«me
);

1009 i‡(! 
£rvî_«me_lc
) {

1010 
	`LDNS_ERR
(
LDNS_STATUS_MEM_ERR
, "ldns_rdf_clone");

1012 
	`ldns_d«me2ˇn⁄iˇl
(
£rvî_«me_lc
);

1013 
r
 = 
	`d™e_X509_™y_subje˘_Æt_«me_m©ches_£rvî_«me
(

1014 
˚π
, 
£rvî_«me_lc
) ||

1015 
	`d™e_X509_subje˘_«me_m©ches_£rvî_«me
(

1016 
˚π
, 
£rvî_«me_lc
);

1017 
	`ldns_rdf_‰ì
(
£rvî_«me_lc
);

1018  
r
;

1019 
	}
}

1022 
d™e_¸óã
(
ldns_º_li°
* 
éßs
, 
ldns_rdf
* 
éß_ow√r
,

1023 
ldns_éß_˚πifiˇã_ußge
 
˚πifiˇã_ußge
, 
off£t
,

1024 
ldns_éß_£À˘‹
 
£À˘‹
,

1025 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
,

1026 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

1027 
X509_STORE
* 
vÆid©e_°‹e
,

1028 
boﬁ
 
vîify_£rvî_«me
, 
ldns_rdf
* 
«me
)

1030 
ldns_°©us
 
	gs
;

1031 
X509
* 
	g£À˘ed_˚π
;

1032 
ldns_º
* 
	géß_º
;

1034 i‡(
	gvîify_£rvî_«me
 && ! 
d™e_vîify_£rvî_«me
(
˚π
, 
«me
)) {

1035 
Ârötf
(
°dîr
, "The certificate doesÇot matchÅhe "

1037 
exô
(
EXIT_FAILURE
);

1040 
	gs
 = 
ldns_d™e_£À˘_˚πifiˇã
(&
£À˘ed_˚π
,

1041 
˚π
, 
exåa_˚πs
, 
vÆid©e_°‹e
,

1042 
˚πifiˇã_ußge
, 
off£t
);

1043 
LDNS_ERR
(
s
, "couldÇot select certificate");

1045 
	gs
 = 
ldns_d™e_¸óã_éß_º
(&
éß_º
,

1046 
˚πifiˇã_ußge
, 
£À˘‹
, 
m©chög_ty≥
,

1047 
£À˘ed_˚π
);

1048 
LDNS_ERR
(
s
, "couldÇot createÅlsaÑr");

1050 
ldns_º_£t_ow√r
(
éß_º
, 
éß_ow√r
);

1052 i‡(! 
ldns_º_li°_c⁄èös_º
(
éßs
, 
éß_º
)) {

1053 i‡(! 
ldns_º_li°_push_º
(
éßs
, 
éß_º
)) {

1054 
MEMERR
("ldns_rr_list_push_rr");

1059 
boﬁ


1060 
d™e_vîify
(
ldns_º_li°
* 
éßs
, 
ldns_rdf
* 
addªss
,

1061 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

1062 
X509_STORE
* 
vÆid©e_°‹e
,

1063 
boﬁ
 
vîify_£rvî_«me
, 
ldns_rdf
* 
«me
,

1064 
boﬁ
 
assume_pkix_vÆidôy
)

1066 
ldns_°©us
 
	gs
;

1067 * 
	gaddªss_°r
 = 
NULL
;

1069 
	gs
 = 
ldns_d™e_vîify
(
éßs
, 
˚π
, 
exåa_˚πs
, 
vÆid©e_°‹e
);

1070 i‡(
	gaddªss
) {

1071 
	gaddªss_°r
 = 
ldns_rdf2°r
(
addªss
);

1072 
Ârötf
(
°dout
, "%s", 
addªss_°r
 ?áddress_str : "<address>");

1073 
‰ì
(
addªss_°r
);

1075 
X509_NAME_¥öt_ex_Â
(
°dout
,

1076 
X509_gë_subje˘_«me
(
˚π
), 0, 0);

1078 i‡(
	gs
 =
LDNS_STATUS_OK
) {

1079 i‡(
vîify_£rvî_«me
 &&

1080 ! 
d™e_vîify_£rvî_«me
(
˚π
, 
«me
)) {

1082 
Ârötf
(
°dout
, " didÇot dane-validate, because:"

1085  
	gÁl£
;

1087 
Ârötf
(
°dout
, " dane-validated successfully\n");

1088  
	gåue
;

1089 } i‡(
	gassume_pkix_vÆidôy
 &&

1090 
	gs
 =
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
) {

1091 
Ârötf
(
°dout
, " dane-validated successfully,"

1093  
	gåue
;

1095 
Ârötf
(
°dout
, " didÇot dane-validate, because: %s\n",

1096 
ldns_gë_îr‹°r_by_id
(
s
));

1097  
	gÁl£
;

1102 
	$maö
(
¨gc
, * c⁄°* 
¨gv
)

1104 
c
;

1105 íum { 
UNDETERMINED
, 
VERIFY
, 
CREATE
 } 
mode
 = UNDETERMINED;

1107 
ldns_°©us
 
s
;

1108 
size_t
 
i
;

1110 
boﬁ
 
¥öt_éß_as_ty≥52
 = 
Ál£
;

1111 
boﬁ
 
assume_dns£c_vÆidôy
 = 
Ál£
;

1112 
boﬁ
 
assume_pkix_vÆidôy
 = 
Ál£
;

1113 
boﬁ
 
vîify_£rvî_«me
 = 
åue
;

1114 
boﬁ
 
öãø˘
 = 
Ál£
;

1116 #i‡
HAVE_DANE_CA_FILE


1117 c⁄° * 
CAfûe
 = 
LDNS_DANE_CA_FILE
;

1119 c⁄° * 
CAfûe
 = 
NULL
;

1121 #i‡
HAVE_DANE_CA_PATH


1122 c⁄° * 
CA∑th
 = 
LDNS_DANE_CA_PATH
;

1124 c⁄° * 
CA∑th
 = 
NULL
;

1126 * 
˚π_fûe
 = 
NULL
;

1127 
X509
* 
˚π
 = 
NULL
;

1128 
	`STACK_OF
(
X509
)* 
exåa_˚πs
 = 
NULL
;

1130 
ldns_º_li°
* 
keys
 = 
	`ldns_º_li°_√w
();

1131 
size_t
 
nkeys
 = 0;

1132 
boﬁ
 
do_sigcha£
 = 
Ál£
;

1134 
ldns_º_li°
* 
addªs£s
 = 
	`ldns_º_li°_√w
();

1135 
ldns_º
* 
addªss_º
;

1136 
ldns_rdf
* 
addªss
;

1138 
ai_Ámûy
 = 
AF_UNSPEC
;

1139 
å™•‹t
 = 
LDNS_DANE_TRANSPORT_TCP
;

1141 * 
«me_°r
 = 
NULL
;

1142 
ldns_rdf
* 
«me
;

1143 
uöt16_t
 
p‹t
 = 0;

1145 
ldns_ªsﬁvî
* 
ªs
 = 
NULL
;

1146 
ldns_rdf
* 
éß_ow√r
 = 
NULL
;

1147 * 
éß_ow√r_°r
 = 
NULL
;

1148 
ldns_º_li°
* 
éßs
 = 
NULL
;

1149 * 
éßs_fûe
 = 
NULL
;

1152 
ldns_rdf
* 
p‹t_rdf
 = 
NULL
;

1153 * 
p‹t_°r
 = 
NULL
;

1154 
ldns_rdf
* 
å™•‹t_rdf
 = 
NULL
;

1155 * 
å™•‹t_°r
 = 
NULL
;

1157 
ldns_º_li°
* 
‹igöÆs
 = 
NULL
;

1162 
ldns_éß_˚πifiˇã_ußge
 
˚πifiˇã_ußge
 = 666;

1163 
off£t
 = -1;

1164 
ldns_éß_£À˘‹
 
£À˘‹
 = 666;

1165 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
 = 666;

1168 
X509_STORE
 *
°‹e
 = 
NULL
;

1170 
SSL_CTX
* 
˘x
 = 
NULL
;

1171 
SSL
* 
s¶
 = 
NULL
;

1173 
no_éßs_exô_°©us
 = 
EXIT_SUCCESS
;

1174 
exô_suc˚ss
 = 
EXIT_SUCCESS
;

1176 
boﬁ
 
suc˚ss
 = 
åue
;

1178 i‡(! 
keys
 || ! 
addªs£s
) {

1179 
	`MEMERR
("ldns_rr_list_new");

1181 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "46a:bc:df:hik:no:p:sSt:TuvV:")) != -1){

1182 
c
) {

1184 
	`¥öt_ußge
("ldns-dane");

1187 
ai_Ámûy
 = 
AF_INET
;

1190 
ai_Ámûy
 = 
AF_INET6
;

1193 
s
 = 
	`ldns_°r2rdf_a
(&
addªss
, 
›èrg
);

1194 i‡(
s
 =
LDNS_STATUS_OK
) {

1195 
addªss_º
 = 
	`ldns_º_√w_‰m_ty≥
(

1196 
LDNS_RR_TYPE_A
);

1198 
s
 = 
	`ldns_°r2rdf_ØØ
(&
addªss
, 
›èrg
);

1199 i‡(
s
 =
LDNS_STATUS_OK
) {

1200 
addªss_º
 = 
	`ldns_º_√w_‰m_ty≥
(

1201 
LDNS_RR_TYPE_AAAA
);

1203 
	`Ârötf
(
°dîr
,

1206 
›èrg
);

1207 
	`exô
(
EXIT_FAILURE
);

1210 (Ë
	`ldns_º_a_£t_addªss
(
addªss_º
, 
addªss
);

1211 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
addªs£s
); i++){

1212 i‡(
	`ldns_rdf_com∑ª
(
addªss
,

1213 
	`ldns_º_a_addªss
(

1214 
	`ldns_º_li°_º
(
addªs£s
, 
i
))) == 0) {

1218 i‡(
i
 >
	`ldns_º_li°_º_cou¡
(
addªs£s
)) {

1219 i‡(! 
	`ldns_º_li°_push_º
(
addªs£s
,

1220 
addªss_º
)) {

1221 
	`MEMERR
("ldns_rr_list_push_rr");

1226 
¥öt_éß_as_ty≥52
 = 
åue
;

1230 
˚π_fûe
 = 
›èrg
;

1233 
assume_dns£c_vÆidôy
 = 
åue
;

1236 
CAfûe
 = 
›èrg
;

1239 
öãø˘
 = 
åue
;

1242 
s
 = 
	`ªad_key_fûe
(
›èrg
, 
keys
);

1243 i‡(
s
 =
LDNS_STATUS_FILE_ERR
) {

1244 
	`Ârötf
(
°dîr
, "Error opening %s: %s\n",

1245 
›èrg
, 
	`°ªº‹
(
î∫o
));

1247 
	`LDNS_ERR
(
s
, "CouldÇotÖarse key file");

1248 i‡(
	`ldns_º_li°_º_cou¡
(
keys
Ë=
nkeys
) {

1249 
	`Ârötf
(
°dîr
, "No keys found in file"

1250 " %s\n", 
›èrg
);

1251 
	`exô
(
EXIT_FAILURE
);

1253 
nkeys
 = 
	`ldns_º_li°_º_cou¡
(
keys
);

1256 
vîify_£rvî_«me
 = 
Ál£
;

1259 
off£t
 = 
	`©oi
(
›èrg
);

1262 
CA∑th
 = 
›èrg
;

1265 
assume_pkix_vÆidôy
 = 
åue
;

1268 
do_sigcha£
 = 
åue
;

1271 
éßs_fûe
 = 
›èrg
;

1274 
no_éßs_exô_°©us
 = 
NO_TLSAS_EXIT_STATUS
;

1277 
å™•‹t
 = 
LDNS_DANE_TRANSPORT_UDP
;

1280 
	`¥ötf
("ldns-dane version %s (ldns version %s)\n",

1281 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

1282 
	`exô
(
EXIT_SUCCESS
);

1294 i‡(
	`ldns_º_li°_º_cou¡
(
addªs£s
) > 0 &&

1295 
ai_Ámûy
 !
AF_UNSPEC
) {

1296 
‹igöÆs
 = 
addªs£s
;

1297 
addªs£s
 = 
	`º_li°_fûãr_º_ty≥
(
‹igöÆs
,

1298 (
ai_Ámûy
 =
AF_INET


1299 ? 
LDNS_RR_TYPE_A
 : 
LDNS_RR_TYPE_AAAA
));

1300 
	`ldns_º_li°_‰ì
(
‹igöÆs
);

1301 i‡(
addªs£s
 =
NULL
) {

1302 
	`MEMERR
("rr_list_filter_rr_type");

1304 i‡(
	`ldns_º_li°_º_cou¡
(
addªs£s
) == 0) {

1305 
	`Ârötf
(
°dîr
,

1307 
	`exô
(
EXIT_FAILURE
);

1311 i‡(
do_sigcha£
) {

1312 i‡(
nkeys
 == 0) {

1313 (Ë
	`ªad_key_fûe
(
LDNS_TRUST_ANCHOR_FILE
, 
keys
);

1314 
nkeys
 = 
	`ldns_º_li°_º_cou¡
(
keys
);

1316 i‡(
nkeys
 == 0) {

1317 
	`Ârötf
(
°dîr
, "UnableÅo chase "

1319 
	`exô
(
EXIT_FAILURE
);

1323 
keys
 = 
NULL
;

1326 
¨gc
 -
›töd
;

1327 
¨gv
 +
›töd
;

1329 i‡(
¨gc
 == 0) {

1331 
	`¥öt_ußge
("ldns-dane");

1333 i‡(
	`°∫ˇ£cmp
(*
¨gv
, "¸óã", 
	`°æí
(*argv)) == 0) {

1335 
mode
 = 
CREATE
;

1336 
¨gc
--;

1337 
¨gv
++;

1339 } i‡(
	`°∫ˇ£cmp
(*
¨gv
, "vîify", 
	`°æí
(*argv)) == 0) {

1341 
mode
 = 
VERIFY
;

1342 
¨gc
--;

1343 
¨gv
++;

1346 
	`Ârötf
(
°dîr
, "Specify create or verify mode\n");

1347 
	`exô
(
EXIT_FAILURE
);

1350 i‡(
mode
 =
VERIFY
 && 
¨gc
 == 0) {

1352 i‡(! 
éßs_fûe
) {

1353 
	`Ârötf
(
°dîr
, "ERROR! Nothing givenÅo verify\n");

1354 
	`exô
(
EXIT_FAILURE
);

1356 
s
 = 
	`d™e_ªad_éßs_‰om_fûe
(&
éßs
, 
éßs_fûe
, 
NULL
);

1357 
	`LDNS_ERR
(
s
, "couldÇotÑeadÅlsas from file");

1361 i‡(
	`ldns_º_li°_º_cou¡
(
éßs
) == 0) {

1363 
	`Ârötf
(
°dîr
, "ERROR! No TLSAÑecordsÅoÉxtract "

1366 
	`exô
(
EXIT_FAILURE
);

1368 
éß_ow√r
 = 
	`ldns_º_li°_ow√r
(
éßs
);

1369 i‡(
	`ldns_d«me_œbñ_cou¡
(
éß_ow√r
) < 2) {

1370 
	`Ârötf
(
°dîr
, "ERROR! To fewÜabels in TLSA owner\n");

1371 
	`exô
(
EXIT_FAILURE
);

1374 
s
 = 
LDNS_STATUS_MEM_ERR
;

1375 
p‹t_rdf
 = 
	`ldns_d«me_œbñ
(
éß_ow√r
, 0);

1376 i‡(! 
p‹t_rdf
) {

1379 
p‹t_°r
 = 
	`ldns_rdf2°r
(
p‹t_rdf
);

1380 i‡(! 
p‹t_°r
) {

1383 i‡(*
p‹t_°r
 != '_') {

1384 
	`Ârötf
(
°dîr
, "ERROR! Badly formatted "

1387 
	`exô
(
EXIT_FAILURE
);

1389 i‡(
p‹t_°r
[
	`°æí
(port_str) - 1] == '.') {

1390 
p‹t_°r
[
	`°æí
(port_str) - 1] = '\000';

1392 
p‹t
 = (
uöt16_t
Ë
	`d™e_öt_wôhö_ønge
(

1393 
p‹t_°r
 + 1, 65535, "port");

1394 
s
 = 
LDNS_STATUS_OK
;

1395 } 
Ál£
);

1396 
	`LDNS_ERR
(
s
, "couldÇotÉxtract serviceÖort from TLSA owner");

1399 
s
 = 
LDNS_STATUS_MEM_ERR
;

1400 
å™•‹t_rdf
 = 
	`ldns_d«me_œbñ
(
éß_ow√r
, 1);

1401 i‡(! 
å™•‹t_rdf
) {

1404 
å™•‹t_°r
 = 
	`ldns_rdf2°r
(
å™•‹t_rdf
);

1405 i‡(! 
å™•‹t_°r
) {

1408 i‡(
å™•‹t_°r
[
	`°æí
(transport_str) - 1] == '.') {

1409 
å™•‹t_°r
[
	`°æí
(transport_str) - 1] =

1412 i‡(
	`°rcmp
(
å™•‹t_°r
, "_tcp") == 0) {

1414 
å™•‹t
 = 
LDNS_DANE_TRANSPORT_TCP
;

1416 } i‡(
	`°rcmp
(
å™•‹t_°r
, "_udp") == 0) {

1418 
å™•‹t
 = 
LDNS_DANE_TRANSPORT_UDP
;

1420 } i‡(
	`°rcmp
(
å™•‹t_°r
, "_sctp") == 0) {

1422 
å™•‹t
 = 
LDNS_DANE_TRANSPORT_SCTP
;

1425 
	`Ârötf
(
°dîr
, "ERROR! Badly formatted "

1428 
	`exô
(
EXIT_FAILURE
);

1430 
s
 = 
LDNS_STATUS_OK
;

1432 } 
Ál£
);

1433 
	`LDNS_ERR
(
s
, "couldÇotÉxtractÅransport from TLSA owner");

1435 
éß_ow√r_°r
 = 
	`ldns_rdf2°r
(
éß_ow√r
);

1436 i‡(! 
éß_ow√r_°r
) {

1437 
	`MEMERR
("ldns_rdf2str");

1439 
«me
 = 
	`ldns_d«me_˛⁄e_‰om
(
éß_ow√r
, 2);

1440 i‡(! 
«me
) {

1441 
	`MEMERR
("ldns_dname_clone_from");

1443 
«me_°r
 = 
	`ldns_rdf2°r
(
«me
);

1444 i‡(! 
«me_°r
) {

1445 
	`MEMERR
("ldns_rdf2str");

1449 } i‡(
¨gc
 < 2) {

1451 
	`¥öt_ußge
("ldns-dane");

1454 
«me_°r
 = *
¨gv
++; 
¨gc
--;

1455 
s
 = 
	`ldns_°r2rdf_d«me
(&
«me
, 
«me_°r
);

1456 
	`LDNS_ERR
(
s
, "couldÇotÜdns_str2rdf_dname");

1458 
p‹t
 = (
uöt16_t
)
	`d™e_öt_wôhö_ønge
(*
¨gv
++, 65535, "port");

1459 --
¨gc
;

1461 
s
 = 
	`ldns_d™e_¸óã_éß_ow√r
(&
éß_ow√r
,

1462 
«me
, 
p‹t
, 
å™•‹t
);

1463 
	`LDNS_ERR
(
s
, "couldÇot create TLSA ownerÇame");

1464 
éß_ow√r_°r
 = 
	`ldns_rdf2°r
(
éß_ow√r
);

1465 i‡(! 
éß_ow√r_°r
) {

1466 
	`MEMERR
("ldns_rdf2str");

1470 
mode
) {

1471 
VERIFY
:

1472 i‡(
¨gc
 > 0) {

1474 
	`¥öt_ußge
("ldns-dane");

1476 i‡(
éßs_fûe
) {

1478 
s
 = 
	`d™e_ªad_éßs_‰om_fûe
(&
éßs
, 
éßs_fûe
,

1479 
éß_ow√r
);

1480 
	`LDNS_ERR
(
s
, "couldÇotÑeadÅlas from file");

1483 
s
 = 
	`d™e_£tup_ªsﬁvî
(&
ªs
, 
keys
,

1484 
assume_dns£c_vÆidôy
);

1485 
	`LDNS_ERR
(
s
, "couldÇot dane_setup_resolver");

1486 
s
 = 
	`d™e_quîy
(&
éßs
, 
ªs
, 
éß_ow√r
,

1487 
LDNS_RR_TYPE_TLSA
, 
LDNS_RR_CLASS_IN
,

1488 
Ál£
);

1489 
	`ldns_ªsﬁvî_‰ì
(
ªs
);

1492 i‡(
s
 =
LDNS_STATUS_DANE_INSECURE
) {

1494 
	`Ârötf
(
°dîr
, "Warning! TLSAÑecords for %s "

1499 "u£Åhê-d o±i⁄.\n", 
éß_ow√r_°r
);

1501 
exô_suc˚ss
 = 
no_éßs_exô_°©us
;

1503 } i‡(
s
 !
LDNS_STATUS_OK
) {

1505 
	`ldns_îr
("d™e_quîy", 
s
);

1507 } i‡(
	`ldns_º_li°_º_cou¡
(
éßs
) == 0) {

1509 
	`Ârötf
(
°dîr
, "Warning! No TLSAÑecords for %s "

1512 "≥rf‹med.\n", 
	`ldns_rdf2°r
(
éß_ow√r
));

1514 
exô_suc˚ss
 = 
no_éßs_exô_°©us
;

1516 } i‡(
assume_pkix_vÆidôy
) {

1522 
‹igöÆs
 = 
éßs
;

1523 
éßs
 = 
	`d™e_no_pkix_å™sf‹m
(
‹igöÆs
);

1528 
CREATE
:

1529 i‡(
¨gc
 > 0) {

1530 
˚πifiˇã_ußge
 = 
	`d™e_öt_wôhö_ønge_èbÀ
(

1531 *
¨gv
++, 3, "certificate usage",

1532 
d™e_˚πifiˇã_ußge_èbÀ
);

1533 
¨gc
--;

1535 
˚πifiˇã_ußge
 =

1536 
LDNS_TLSA_USAGE_DOMAIN_ISSUED_CERTIFICATE
;

1538 i‡(
¨gc
 > 0) {

1539 
£À˘‹
 = 
	`d™e_öt_wôhö_ønge_èbÀ
(

1540 *
¨gv
++, 1, "selector",

1541 
d™e_£À˘‹_èbÀ
);

1542 
¨gc
--;

1544 
£À˘‹
 = 
LDNS_TLSA_SELECTOR_FULL_CERTIFICATE
;

1546 i‡(
¨gc
 > 0) {

1547 i‡(*
¨gv
 &&

1548 (
	`°∫ˇ£cmp
(*
¨gv
, "no-hash-used",

1549 
	`°æí
(*
¨gv
)) == 0 ||

1550 
	`°∫ˇ£cmp
(*
¨gv
, "no hash used",

1551 
	`°æí
(*
¨gv
)) == 0 )) {

1552 
m©chög_ty≥
 =

1553 
LDNS_TLSA_MATCHING_TYPE_NO_HASH_USED
;

1555 } i‡(
	`°rˇ£cmp
(*
¨gv
, "sha256") == 0 ||

1556 
	`°rˇ£cmp
(*
¨gv
, "sha-256") == 0) {

1558 
m©chög_ty≥
 = 
LDNS_TLSA_MATCHING_TYPE_SHA256
;

1560 } i‡(
	`°rˇ£cmp
(*
¨gv
, "sha512") == 0 ||

1561 
	`°rˇ£cmp
(*
¨gv
, "sha-512") == 0) {

1563 
m©chög_ty≥
 = 
LDNS_TLSA_MATCHING_TYPE_SHA512
;

1566 
m©chög_ty≥
 = 
	`d™e_öt_wôhö_ønge
(

1567 *
¨gv
, 2, "matchingÅype");

1569 
¨gv
++;

1570 
¨gc
--;

1572 
m©chög_ty≥
 = 
LDNS_TLSA_MATCHING_TYPE_SHA256
;

1574 i‡(
¨gc
 > 0) {

1576 
	`¥öt_ußge
("ldns-dane");

1578 i‡((
˚πifiˇã_ußge
 =
LDNS_TLSA_USAGE_CA_CONSTRAINT
 ||

1579 
˚πifiˇã_ußge
 ==

1580 
LDNS_TLSA_USAGE_SERVICE_CERTIFICATE_CONSTRAINT
) &&

1581 ! 
CAfûe
 && ! 
CA∑th
 && ! 
assume_pkix_vÆidôy
) {

1583 
	`Ârötf
(
°dîr
,

1595 
	`exô
(
EXIT_FAILURE
);

1597 
éßs
 = 
	`ldns_º_li°_√w
();

1600 
	`Ârötf
(
°dîr
, "Unreachable code\n");

1601 
	`as£π
(0);

1605 
	`SSL_lﬂd_îr‹_°rögs
();

1606 
	`SSL_libøry_öô
();

1609 i‡(! 
assume_pkix_vÆidôy
 || 
CAfûe
 || 
CA∑th
) {

1610 
°‹e
 = 
	`X509_STORE_√w
();

1611 i‡(! 
°‹e
) {

1612 
	`s¶_îr
("couldÇot X509_STORE_new");

1614 i‡((
CAfûe
 || 
CA∑th
Ë&& 
	`X509_STORE_lﬂd_loˇti⁄s
(

1615 
°‹e
, 
CAfûe
, 
CA∑th
) != 1) {

1616 
	`s¶_îr
("errorÜoading CA certificates");

1620 
˘x
 = 
	`SSL_CTX_√w
(
	`SSLv23_˛õ¡_mëhod
());

1621 i‡(! 
˘x
) {

1622 
	`s¶_îr
("couldÇot SSL_CTX_new");

1624 i‡(
˚π_fûe
 &&

1625 
	`SSL_CTX_u£_˚πifiˇã_chaö_fûe
(
˘x
, 
˚π_fûe
) != 1) {

1626 
	`s¶_îr
("errorÜoading certificate");

1629 i‡(
˚π_fûe
) {

1631 
s¶
 = 
	`SSL_√w
(
˘x
);

1632 i‡(! 
s¶
) {

1633 
	`s¶_îr
("couldÇot SSL_new");

1635 
˚π
 = 
	`SSL_gë_˚πifiˇã
(
s¶
);

1636 i‡(! 
˚π
) {

1637 
	`s¶_îr
("couldÇot SSL_get_certificate");

1639 #i‚de‡
S_SPLINT_S


1640 
exåa_˚πs
 = 
˘x
->extra_certs;

1643 
mode
) {

1644 
CREATE
: 
	`d™e_¸óã
(
éßs
, 
éß_ow√r
, 
˚πifiˇã_ußge
,

1645 
off£t
, 
£À˘‹
, 
m©chög_ty≥
,

1646 
˚π
, 
exåa_˚πs
, 
°‹e
,

1647 
vîify_£rvî_«me
, 
«me
);

1649 
VERIFY
: i‡(! 
	`d™e_vîify
(
éßs
, 
NULL
,

1650 
˚π
, 
exåa_˚πs
, 
°‹e
,

1651 
vîify_£rvî_«me
, 
«me
,

1652 
assume_pkix_vÆidôy
)) {

1653 
suc˚ss
 = 
Ál£
;

1658 
	`SSL_‰ì
(
s¶
);

1663 i‡(
	`ldns_º_li°_º_cou¡
(
addªs£s
) == 0) {

1664 
s
 = 
	`d™e_£tup_ªsﬁvî
(&
ªs
, 
keys
,

1665 
assume_dns£c_vÆidôy
);

1666 
	`LDNS_ERR
(
s
, "couldÇot dane_setup_resolver");

1667 
	`ldns_º_li°_‰ì
(
addªs£s
);

1668 
addªs£s
 =
	`d™e_lookup_addªs£s
(
ªs
, 
«me
, 
ai_Ámûy
);

1669 
	`ldns_ªsﬁvî_‰ì
(
ªs
);

1671 i‡(
	`ldns_º_li°_º_cou¡
(
addªs£s
) == 0) {

1672 
	`Ârötf
(
°dîr
, "Nÿaddªs£†f‹ %s\n", 
«me_°r
);

1673 
	`exô
(
EXIT_FAILURE
);

1677 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
addªs£s
); i++) {

1679 
s¶
 = 
	`SSL_√w
(
˘x
);

1680 i‡(! 
s¶
) {

1681 
	`s¶_îr
("couldÇot SSL_new");

1683 
addªss
 = 
	`ldns_º_a_addªss
(

1684 
	`ldns_º_li°_º
(
addªs£s
, 
i
));

1685 
	`as£π
(
addªss
 !
NULL
);

1687 
s
 = 
	`s¶_c⁄√˘_™d_gë_˚π_chaö
(&
˚π
, &
exåa_˚πs
,

1688 
s¶
, 
«me_°r
, 
addªss
,
p‹t
, 
å™•‹t
);

1689 i‡(
s
 =
LDNS_STATUS_NETWORK_ERR
) {

1690 
	`Ârötf
(
°dîr
, "CouldÇot connectÅo ");

1691 
	`ldns_rdf_¥öt
(
°dîr
, 
addªss
);

1692 
	`Ârötf
(
°dîr
, " %d\n", (Ë
p‹t
);

1695 
suc˚ss
 = 
Ál£
;

1698 
	`LDNS_ERR
(
s
, "couldÇot get cert chain from ssl");

1699 
mode
) {

1701 
CREATE
: 
	`d™e_¸óã
(
éßs
, 
éß_ow√r
,

1702 
˚πifiˇã_ußge
, 
off£t
,

1703 
£À˘‹
, 
m©chög_ty≥
,

1704 
˚π
, 
exåa_˚πs
, 
°‹e
,

1705 
vîify_£rvî_«me
, 
«me
);

1708 
VERIFY
: i‡(! 
	`d™e_vîify
(
éßs
, 
addªss
,

1709 
˚π
, 
exåa_˚πs
, 
°‹e
,

1710 
vîify_£rvî_«me
, 
«me
,

1711 
assume_pkix_vÆidôy
)) {

1712 
suc˚ss
 = 
Ál£
;

1714 } i‡(
öãø˘
) {

1715 
	`s¶_öãø˘
(
s¶
);

1720 
	`SSL_shutdown
(
s¶
) == 0);

1721 
	`SSL_‰ì
(
s¶
);

1725 i‡(
mode
 =
CREATE
) {

1726 i‡(
¥öt_éß_as_ty≥52
) {

1727 
	`¥öt_º_li°_as_TYPEXXX
(
°dout
, 
éßs
);

1729 
	`ldns_º_li°_¥öt
(
°dout
, 
éßs
);

1732 
	`ldns_º_li°_dìp_‰ì
(
éßs
);

1735 
	`SSL_CTX_‰ì
(
˘x
);

1737 i‡(
°‹e
) {

1738 
	`X509_STORE_‰ì
(
°‹e
);

1740 i‡(
éß_ow√r_°r
) {

1741 
	`LDNS_FREE
(
éß_ow√r_°r
);

1743 i‡(
éß_ow√r
) {

1744 
	`ldns_rdf_‰ì
(
éß_ow√r
);

1746 i‡(
addªs£s
) {

1747 
	`ldns_º_li°_dìp_‰ì
(
addªs£s
);

1749 i‡(
suc˚ss
) {

1750 
	`exô
(
exô_suc˚ss
);

1752 
	`exô
(
EXIT_FAILURE
);

1754 
	}
}

1758 
	$maö
(
¨gc
, **
¨gv
)

1760 
	`Ârötf
(
°dîr
, "ldns-daneÇeeds OpenSSL support, "

1763 
	}
}

1769 
	$maö
(
¨gc
, **
¨gv
)

1771 
	`Ârötf
(
°dîr
, "dane support was disabled withÅhis build ofÜdns, "

1774 
	}
}

	@examples/ldns-dpa.c

9 
	~"c⁄fig.h
"

11 
	~<ldns/ldns.h
>

13 #ifde‡
HAVE_PCAP_H


14 #ifde‡
HAVE_LIBPCAP


15 
	~"ldns-d∑.h
"

17 #ifde‡
HAVE_NETINET_IP6_H


18 
	~<√töë/ù6.h
>

20 
	~<î∫o.h
>

22 #i‚de‡
IP_OFFMASK


23 
	#IP_OFFMASK
 0x1fff

	)

26 
	gvîbosôy
 = 1;

28 
	#ETHER_HEADER_LENGTH
 14

	)

29 
	#UDP_HEADER_LENGTH
 8

	)

30 
	#IP6_HEADER_LENGTH
 40

	)

33 #i‚de‡
ETHERTYPE_IPV6


34 
	#ETHERTYPE_IPV6
 0x86dd

	)

37 
	#MAX_MATCHES
 20

	)

38 
	#MAX_OPERATORS
 7

	)

42 
boﬁ
 
	gshow_fûãr_m©ches
 = 
Ál£
;

43 
size_t
 
	gtŸÆ_ƒ_of_dns_∑ckës
 = 0;

44 
size_t
 
	gtŸÆ_ƒ_of_fûãªd_∑ckës
 = 0;

45 
size_t
 
	gnŸ_ù_∑ckës
 = 0;

46 
size_t
 
	gbad_dns_∑ckës
 = 0;

47 
size_t
 
	g¨p_∑ckës
 = 0;

48 
size_t
 
	gudp_∑ckës
 = 0;

49 
size_t
 
	gt˝_∑ckës
 = 0;

50 
size_t
 
	g‰agmíãd_∑ckës
 = 0;

51 
size_t
 
	glo°_∑ckë_‰agmíts
 = 0;

52 
FILE
 *
	ghexdumpfûe
 = 
NULL
;

53 
pˇp_dum≥r_t
 *
	gdum≥r
 = 
NULL
;

54 
pˇp_dum≥r_t
 *
	gnŸ_ù_dump
 = 
NULL
;

55 
pˇp_dum≥r_t
 *
	gbad_dns_dump
 = 
NULL
;

59 
	s‰agmít_∑π
 {

60 
uöt16_t
 
	mù_id
;

61 
uöt8_t
 
	md©a
[65536];

62 
size_t
 
	mcur_Àn
;

65 
‰agmít_∑π
 *
	g‰agmít_p
;

75 
	eíum_m©ch_ids
 {

76 
	mMATCH_ID
,

77 
	mMATCH_OPCODE
,

78 
	mMATCH_RCODE
,

79 
	mMATCH_PACKETSIZE
,

80 
	mMATCH_QR
,

81 
	mMATCH_TC
,

82 
	mMATCH_AD
,

83 
	mMATCH_CD
,

84 
	mMATCH_RD
,

85 
	mMATCH_EDNS
,

86 
	mMATCH_EDNS_PACKETSIZE
,

87 
	mMATCH_DO
,

88 
	mMATCH_QUESTION_SIZE
,

89 
	mMATCH_ANSWER_SIZE
,

90 
	mMATCH_AUTHORITY_SIZE
,

91 
	mMATCH_ADDITIONAL_SIZE
,

92 
	mMATCH_SRC_ADDRESS
,

93 
	mMATCH_DST_ADDRESS
,

94 
	mMATCH_TIMESTAMP
,

95 
	mMATCH_QUERY
,

96 
	mMATCH_QTYPE
,

97 
	mMATCH_QNAME
,

98 
	mMATCH_ANSWER
,

99 
	mMATCH_AUTHORITY
,

100 
	mMATCH_ADDITIONAL
,

101 
	mMATCH_LAST


103 
íum_m©ch_ids
 
	tm©ch_id
;

105 
	eíum_cou¡î_ty≥s
 {

106 
	mTYPE_INT
,

107 
	mTYPE_BOOL
,

108 
	mTYPE_OPCODE
,

109 
	mTYPE_RCODE
,

110 
	mTYPE_STRING
,

111 
	mTYPE_TIMESTAMP
,

112 
	mTYPE_ADDRESS
,

113 
	mTYPE_RR
,

114 
	mTYPE_RR_TYPE
,

115 
	mTYPE_LAST


117 
íum_cou¡î_ty≥s
 
	tcou¡î_ty≥
;

119 c⁄° 
ldns_lookup_èbÀ
 
	g…_ty≥s
[] = {

120 {
TYPE_INT
, "int" },

121 {
TYPE_BOOL
, "bool" },

122 {
TYPE_OPCODE
, "opcode" },

123 {
TYPE_RCODE
, "rcode" },

124 {
TYPE_STRING
, "string" },

125 {
TYPE_TIMESTAMP
, "timestamp" },

126 {
TYPE_ADDRESS
, "address" },

127 {
TYPE_RR
, "rr" },

128 { 0, 
NULL
 }

131 
	eíum_ty≥_›î©‹s
 {

132 
	mOP_EQUAL
,

133 
	mOP_NOTEQUAL
,

134 
	mOP_GREATER
,

135 
	mOP_LESSER
,

136 
	mOP_GREATEREQUAL
,

137 
	mOP_LESSEREQUAL
,

138 
	mOP_CONTAINS
,

139 
	mOP_LAST


141 
íum_ty≥_›î©‹s
 
	tty≥_›î©‹
;

143 c⁄° 
ldns_lookup_èbÀ
 
	g…_›î©‹s
[] = {

144 { 
OP_EQUAL
, "=" },

145 { 
OP_NOTEQUAL
, "!=" },

146 { 
OP_GREATER
, ">" },

147 { 
OP_LESSER
, "<" },

148 { 
OP_GREATEREQUAL
, ">=" },

149 { 
OP_LESSEREQUAL
, "<=" },

150 { 
OP_CONTAINS
, "~=" },

151 { 0, 
NULL
 }

154 c⁄° *
	$gë_›_°r
(
ty≥_›î©‹
 
›
) {

155 c⁄° 
ldns_lookup_èbÀ
 *
…
;

156 
…
 = 
	`ldns_lookup_by_id
((
ldns_lookup_èbÀ
 *Ë
…_›î©‹s
, 
›
);

157 i‡(
…
) {

158  
…
->
«me
;

160 
	`Ârötf
(
°dîr
, "Unknow¿›î©‹ id: %u\n", 
›
);

161 
	`exô
(1);

163 
	}
}

165 
ty≥_›î©‹


166 
	$gë_›_id
(*
›_°r
)

168 c⁄° 
ldns_lookup_èbÀ
 *
…
;

169 
…
 = 
	`ldns_lookup_by_«me
((
ldns_lookup_èbÀ
 *Ë
…_›î©‹s
, 
›_°r
);

170 i‡(
…
) {

171  (
ty≥_›î©‹
Ë
…
->
id
;

173 
	`Ârötf
(
°dîr
, "Unknow¿›î©‹: %s\n", 
›_°r
);

174 
	`exô
(1);

176 
	}
}

178 
	s°ru˘_ty≥_›î©‹s
 {

179 
cou¡î_ty≥
 
	mty≥
;

180 
size_t
 
	m›î©‹_cou¡
;

181 
ty≥_›î©‹
 
	m›î©‹s
[10];

183 
°ru˘_ty≥_›î©‹s
 
	tty≥_›î©‹s
;

185 c⁄° 
ty≥_›î©‹s
 
	gc⁄°_ty≥_›î©‹s
[] = {

186 { 
TYPE_INT
, 6, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 
OP_GREATER
, 
OP_LESSER
, 
OP_GREATEREQUAL
, 
OP_LESSEREQUAL
, 0, 0, 0, 0 } },

187 { 
TYPE_BOOL
, 2, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 0, 0, 0, 0, 0, 0, 0, 0} },

188 { 
TYPE_OPCODE
, 2, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 0, 0, 0, 0, 0, 0, 0, 0} },

189 { 
TYPE_RCODE
, 2, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 0, 0, 0, 0, 0, 0, 0, 0} },

190 { 
TYPE_STRING
, 3, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 
OP_CONTAINS
, 0, 0, 0, 0, 0, 0, 0} },

191 { 
TYPE_TIMESTAMP
, 6, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 
OP_GREATER
, 
OP_LESSER
, 
OP_GREATEREQUAL
, 
OP_LESSEREQUAL
, 0, 0, 0, 0 } },

192 { 
TYPE_ADDRESS
, 3, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 
OP_CONTAINS
, 0, 0, 0, 0, 0, 0, 0} },

193 { 
TYPE_RR
, 3, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 
OP_CONTAINS
, 0, 0, 0, 0, 0, 0, 0} },

194 { 
TYPE_RR_TYPE
, 6, { 
OP_EQUAL
, 
OP_NOTEQUAL
, 
OP_GREATER
, 
OP_LESSER
, 
OP_GREATEREQUAL
, 
OP_LESSEREQUAL
, 0, 0, 0, 0 } },

198 c⁄° 
ty≥_›î©‹s
 *

199 
	$gë_ty≥_›î©‹s
(
cou¡î_ty≥
 
ty≥
) {

200 c⁄° 
ty≥_›î©‹s
 *
to
 = 
c⁄°_ty≥_›î©‹s
;

201 
to
) {

202 i‡(
to
->
ty≥
 ==Åype) {

203  
to
;

205 
to
++;

207  
NULL
;

208 
	}
}

210 
	s°ru˘_m©ch_èbÀ
 {

211 
m©ch_id
 
	mid
;

212 c⁄° *
	m«me
;

213 c⁄° *
	mdes¸ùti⁄
;

214 c⁄° 
cou¡î_ty≥
 
	mty≥
;

216 
°ru˘_m©ch_èbÀ
 
	tm©ch_èbÀ
;

221 c⁄° 
m©ch_èbÀ
 
	gm©ches
[] = {

222 { 
MATCH_QUERY
, "quîy", "SåögÑïª£¡©i⁄ o‡thêquîy RR", 
TYPE_RR
 },

223 { 
MATCH_QTYPE
, "qty≥", "RR Ty≥ o‡thêque°i⁄ RR, i‡¥e£¡", 
TYPE_RR_TYPE
 },

224 { 
MATCH_QNAME
, "q«me", "Ow√∏«mêo‡thêque°i⁄ RR, i‡¥e£¡", 
TYPE_STRING
 },

225 { 
MATCH_SRC_ADDRESS
, "§ˇddªss", "addªs†thê∑ckë wa†£¡ from", 
TYPE_ADDRESS
 },

226 { 
MATCH_TIMESTAMP
, "time°amp", "timêthê∑ckë wa†£¡", 
TYPE_TIMESTAMP
 },

227 { 
MATCH_DST_ADDRESS
, "d°addªss", "addªs†thê∑ckë wa†£¡Åo", 
TYPE_ADDRESS
 },

228 { 
MATCH_EDNS_PACKETSIZE
, "edns-∑ckësize", "∑ckë†sizê•ecifõd i¿edn†º", 
TYPE_INT
 },

229 { 
MATCH_ID
, "id", "id o‡thê∑ckë", 
TYPE_INT
 },

230 { 
MATCH_OPCODE
, "›code", "›codêo‡∑ckë (rfc1035)", 
TYPE_OPCODE
 },

231 { 
MATCH_RCODE
, "rcode", "ª•⁄£ codêo‡∑ckë", 
TYPE_RCODE
 },

232 { 
MATCH_PACKETSIZE
, "∑ckësize", "sizêo‡∑ckë i¿byãs", 
TYPE_INT
 },

233 { 
MATCH_QR
, "qr", "vÆuêo‡q∏bô", 
TYPE_BOOL
 },

234 { 
MATCH_TC
, "tc", "vÆuêo‡t¯bô", 
TYPE_BOOL
 },

235 { 
MATCH_AD
, "ad", "vÆuêo‡ad bô", 
TYPE_BOOL
 },

236 { 
MATCH_CD
, "cd", "vÆuêo‡cd bô", 
TYPE_BOOL
 },

237 { 
MATCH_RD
, "rd", "vÆuêo‡rd bô", 
TYPE_BOOL
 },

238 { 
MATCH_EDNS
, "edns", "exi°í˚ o‡edn†º", 
TYPE_BOOL
 },

239 { 
MATCH_DO
, "do", "vÆuêo‡dÿbô", 
TYPE_BOOL
 },

240 { 
MATCH_QUESTION_SIZE
, "que°i⁄size", "numbî o‡º†öÅhêque°i⁄ se˘i⁄", 
TYPE_INT
 },

241 { 
MATCH_ANSWER_SIZE
, "™swîsize", "numbî o‡º†öÅhê™swî se˘i⁄", 
TYPE_INT
 },

242 { 
MATCH_AUTHORITY_SIZE
, "auth‹ôysize", "numbî o‡º†öÅhêauth‹ôy se˘i⁄", 
TYPE_INT
 },

243 { 
MATCH_ADDITIONAL_SIZE
, "addôi⁄Æsize", "numbî o‡º†öÅhêaddôi⁄Æ se˘i⁄", 
TYPE_INT
 },

244 { 
MATCH_ANSWER
, "™swî", "SåögÑïª£¡©i⁄ o‡thê™swî RRs", 
TYPE_RR
 },

245 { 
MATCH_AUTHORITY
, "auth‹ôy", "SåögÑïª£¡©i⁄ o‡thêauth‹ôy RRs", 
TYPE_RR
 },

246 { 
MATCH_ADDITIONAL
, "addôi⁄Æ", "SåögÑïª£¡©i⁄ o‡thêaddôi⁄Æ RRs", 
TYPE_RR
 },

247 { 0, 
NULL
 , NULL, 
TYPE_INT
}

250 
	eíum_m©ch_ex¥essi⁄_›î©‹s
 {

251 
	mMATCH_EXPR_OR
,

252 
	mMATCH_EXPR_AND
,

253 
	mMATCH_EXPR_LEAF


255 
íum_m©ch_ex¥essi⁄_›î©‹s
 
	tm©ch_ex¥essi⁄_›î©‹
;

257 
	s°ru˘_m©ch_›î©i⁄
 {

258 
m©ch_id
 
	mid
;

259 
ty≥_›î©‹
 
	m›î©‹
;

260 *
	mvÆue
;

262 
°ru˘_m©ch_›î©i⁄
 
	tm©ch_›î©i⁄
;

264 
°ru˘_m©ch_ex¥essi⁄
 
	tm©ch_ex¥essi⁄
;

265 
	s°ru˘_m©ch_ex¥essi⁄
 {

267 
m©ch_ex¥essi⁄_›î©‹
 
	m›
;

268 
m©ch_ex¥essi⁄
 *
	mÀ·
;

269 
m©ch_ex¥essi⁄
 *
	mright
;

270 
m©ch_›î©i⁄
 *
	mm©ch
;

271 
size_t
 
	mcou¡
;

274 
°ru˘_m©ch_cou¡îs
 
	tm©ch_cou¡îs
;

275 
	s°ru˘_m©ch_cou¡îs
 {

280 
m©ch_ex¥essi⁄
 *
	mm©ch
;

281 
m©ch_cou¡îs
 *
	mÀ·
;

282 
m©ch_cou¡îs
 *
	mright
;

285 
m©ch_èbÀ
 *

286 
	$gë_m©ch_by_«me
(*
«me
) {

287 
m©ch_èbÀ
 *
mt
 = (m©ch_èbÀ *Ë
m©ches
;

288 i‡(
«me
) {

289 
mt
->
«me
 !
NULL
) {

290 i‡(
	`°rˇ£cmp
(
«me
, 
mt
->name) == 0) {

291  
mt
;

293 
mt
++;

296  
NULL
;

297 
	}
}

299 
m©ch_èbÀ
 *

300 
	$gë_m©ch_by_id
(
m©ch_id
 
id
) {

301 
m©ch_èbÀ
 *
mt
 = (m©ch_èbÀ *Ë
m©ches
;

303 
mt
->
«me
 !
NULL
) {

304 i‡(
mt
->
id
 == id) {

305  
mt
;

307 
mt
++;

309  
NULL
;

310 
	}
}

313 
	$gë_m©ch_«me_°r
(
m©ch_id
 
id
) {

314 
m©ch_èbÀ
 *
mt
 = 
	`gë_m©ch_by_id
(
id
);

315 i‡(
mt
) {

316  
mt
->
«me
;

318 
	`Ârötf
(
°dîr
, "Unknow¿m©ch id: %u\n", 
id
);

319 
	`exô
(1);

322 
	}
}

325 
	$¥öt_m©ch_›î©i⁄
(
FILE
 *
ouçut
, 
m©ch_›î©i⁄
 *
mc
)

327 
m©ch_èbÀ
 *
mt
 = 
NULL
;

328 
ldns_lookup_èbÀ
 *
…
;

329 
timevÆ
 
time
;

330 
time_t
 
time_â
;

331 
vÆue
;

332 
size_t
 
pos
;

333 *
tmp
, *
tmp2
;

335 i‡(
mc
) {

336 
mt
 = 
	`gë_m©ch_by_id
(
mc
->
id
);

338 i‡(
mt
) {

339 
	`Ârötf
(
ouçut
, "%†%†",
mt
->
«me
, 
	`gë_›_°r
(
mc
->
›î©‹
));

341 
mt
->
ty≥
) {

342 
TYPE_INT
:

343 
TYPE_STRING
:

344 
TYPE_ADDRESS
:

345 
TYPE_RR
:

346 
	`Ârötf
(
ouçut
, "'%s'", 
mc
->
vÆue
);

348 
TYPE_BOOL
:

349 i‡(
	`°∫cmp
(
mc
->
vÆue
, "1", 2) == 0) {

350 
	`Ârötf
(
ouçut
,"'true'");

352 
	`Ârötf
(
ouçut
,"'false'");

355 
TYPE_OPCODE
:

356 
vÆue
 = 
	`©oi
(
mc
->value);

357 
…
 = 
	`ldns_lookup_by_id
(
ldns_›codes
, 
vÆue
);

358 i‡(
…
) {

359 
	`Ârötf
(
ouçut
, "%s", 
…
->
«me
);

361 
	`Ârötf
(
ouçut
, "%s", 
mc
->
vÆue
);

364 
TYPE_RCODE
:

365 
vÆue
 = 
	`©oi
(
mc
->value);

366 
…
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
, 
vÆue
);

367 i‡(
…
) {

368 
	`Ârötf
(
ouçut
, "%s", 
…
->
«me
);

370 
	`Ârötf
(
ouçut
, "%s", 
mc
->
vÆue
);

373 
TYPE_TIMESTAMP
:

374 #i‚de‡
S_SPLINT_S


375 
time
.
tv_£c
 = (Ë
	`©ﬁ
(
mc
->
vÆue
);

377 
time_â
 = (
time_t
)
time
.
tv_£c
;

378 
tmp
 = 
	`˘ime
(&
time_â
);

379 
tmp2
 = 
	`mÆloc
(
	`°æí
(
tmp
) + 1);

380 
pos
 = 0;Öo†< 
	`°æí
(
tmp
);Öos++) {

381 i‡(
tmp
[
pos
] == '\n') {

382 
tmp2
[
pos
] = '\0';

384 
tmp2
[
pos
] = 
tmp
[pos];

387 
tmp2
[
pos
] = '\0';

388 
	`Ârötf
(
ouçut
, "%s", 
tmp2
);

389 
	`‰ì
(
tmp2
);

392 
	`Ârötf
(
ouçut
, "'%s'", 
mc
->
vÆue
);

396 
	`Ârötf
(
ouçut
, "%u %†'%s'", 
mc
->
id
, 
	`gë_›_°r
(mc->
›î©‹
), mc->
vÆue
);

399 
	`Ârötf
(
ouçut
, "(nil)");

401 
	}
}

404 
	$¥öt_m©ch_ex¥essi⁄
(
FILE
 *
ouçut
, 
m©ch_ex¥essi⁄
 *
ex¥
)

406 i‡(
ex¥
) {

407 
ex¥
->
›
) {

408 
MATCH_EXPR_OR
:

409 
	`Ârötf
(
ouçut
, "(");

410 
	`¥öt_m©ch_ex¥essi⁄
(
ouçut
, 
ex¥
->
À·
);

411 
	`Ârötf
(
ouçut
, " | ");

412 
	`¥öt_m©ch_ex¥essi⁄
(
ouçut
, 
ex¥
->
right
);

413 
	`Ârötf
(
ouçut
, ")");

415 
MATCH_EXPR_AND
:

416 
	`Ârötf
(
ouçut
, "(");

417 
	`¥öt_m©ch_ex¥essi⁄
(
ouçut
, 
ex¥
->
À·
);

418 
	`Ârötf
(
ouçut
, " & ");

419 
	`¥öt_m©ch_ex¥essi⁄
(
ouçut
, 
ex¥
->
right
);

420 
	`Ârötf
(
ouçut
, ")");

422 
MATCH_EXPR_LEAF
:

423 
	`¥öt_m©ch_›î©i⁄
(
ouçut
, 
ex¥
->
m©ch
);

430 
	`Ârötf
(
ouçut
, "(");

431 i‡(
ex¥
->
À·
) {

432 
	`¥öt_m©ch_ex¥essi⁄
(
ouçut
, 
ex¥
->
À·
);

434 
	`Ârötf
(
ouçut
, " ? ");

435 i‡(
ex¥
->
right
) {

436 
	`¥öt_m©ch_ex¥essi⁄
(
ouçut
, 
ex¥
->
right
);

438 
	`Ârötf
(
ouçut
, ") _");

439 i‡(
ex¥
->
m©ch
) {

440 
	`¥öt_m©ch_›î©i⁄
(
ouçut
, 
ex¥
->
m©ch
);

442 
	`Ârötf
(
ouçut
, "_");

445 
	`¥ötf
("(nil)");

447 
	}
}

450 
	$¥öt_cou¡îs
(
FILE
 *
ouçut
, 
m©ch_cou¡îs
 *
cou¡îs
, 
boﬁ
 
show_≥r˚¡ages
, 
size_t
 
tŸÆ
, 
cou¡_möimum
)

452 
≥r˚¡age
;

454 i‡(!
cou¡îs
 || !
ouçut
) {

458 i‡(
cou¡îs
->
À·
) {

459 
	`¥öt_cou¡îs
(
ouçut
, 
cou¡îs
->
À·
, 
show_≥r˚¡ages
, 
tŸÆ
, 
cou¡_möimum
);

461 i‡(
cou¡îs
->
m©ch
) {

462 i‡(
cou¡_möimum
 < (Ë
cou¡îs
->
m©ch
->
cou¡
) {

463 
	`¥öt_m©ch_ex¥essi⁄
(
ouçut
, 
cou¡îs
->
m©ch
);

464 
	`¥ötf
(": %u", (Ë
cou¡îs
->
m©ch
->
cou¡
);

465 i‡(
show_≥r˚¡ages
) {

466 
≥r˚¡age
 = (Ë
cou¡îs
->
m©ch
->
cou¡
 / (Ë
tŸÆ
 * 100.0;

467 
	`¥ötf
(" (%.2f%%)", 
≥r˚¡age
);

469 
	`¥ötf
("\n");

472 i‡(
cou¡îs
->
right
) {

473 
	`¥öt_cou¡îs
(
ouçut
, 
cou¡îs
->
right
, 
show_≥r˚¡ages
, 
tŸÆ
, 
cou¡_möimum
);

477 
	}
}

480 
	$ldns_pkt2fûe_hex
(
FILE
 *
Â
, c⁄° 
ldns_pkt
 *
pkt
)

482 
uöt8_t
 *
wúe
;

483 
size_t
 
size
, 
i
;

484 
ldns_°©us
 
°©us
;

486 
°©us
 = 
	`ldns_pkt2wúe
(&
wúe
, 
pkt
, &
size
);

488 i‡(
°©us
 !
LDNS_STATUS_OK
) {

489 
	`Ârötf
(
°dîr
, "U«bÀÅÿc⁄vîà∑ckë:Éº‹ codê%u", 
°©us
);

493 
	`Ârötf
(
Â
, "; 0");

494 
i
 = 1; i < 20; i++) {

495 
	`Ârötf
(
Â
, " %2u", (Ë
i
);

497 
	`Ârötf
(
Â
, "\n");

498 
	`Ârötf
(
Â
, ";--");

499 
i
 = 1; i < 20; i++) {

500 
	`Ârötf
(
Â
, " --");

502 
	`Ârötf
(
Â
, "\n");

503 
i
 = 0; i < 
size
; i++) {

504 i‡(
i
 % 20 == 0 && i > 0) {

505 
	`Ârötf
(
Â
, "\t; %4u-%4u\n", (Ë
i
-19, () i);

507 
	`Ârötf
(
Â
, " %02x", ()
wúe
[
i
]);

509 
	`Ârötf
(
Â
, "\n\n");

510 
	}
}

517 
size_t


518 
	$ˇlcuœã_tŸÆ_vÆue
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

520 
size_t
 
ªsu…
 = 0;

522 i‡(!
cou¡îs
) {

526 i‡(
cou¡îs
->
m©ch
->m©ch->
id
 =
cur
->id) {

527 
ªsu…
 = (
size_t
Ë
	`©ﬁ
(
cou¡îs
->
m©ch
->m©ch->
vÆue
Ë* cou¡îs->m©ch->
cou¡
;

530 i‡(
cou¡îs
->
À·
) {

531 
ªsu…
 +
	`ˇlcuœã_tŸÆ_vÆue
(
cou¡îs
->
À·
, 
cur
);

533 i‡(
cou¡îs
->
right
) {

534 
ªsu…
 +
	`ˇlcuœã_tŸÆ_vÆue
(
cou¡îs
->
right
, 
cur
);

537  
ªsu…
;

538 
	}
}

540 
size_t


541 
	$ˇlcuœã_tŸÆ_cou¡_m©ches
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

543 
size_t
 
ªsu…
 = 0;

545 i‡(!
cou¡îs
) {

549 i‡(
cou¡îs
->
m©ch
->m©ch->
id
 =
cur
->id) {

550 
ªsu…
 = 1;

553 i‡(
cou¡îs
->
À·
) {

558 i‡(
cur
->
id
 =
MATCH_TIMESTAMP
) {

559 
ªsu…
 +(
size_t
Ë
	`abs
((Ë(
	`©ﬁ
(
cou¡îs
->
m©ch
->m©ch->
vÆue
Ë-átﬁ(cou¡îs->
À·
->match->match->value))) - 1;

561 
ªsu…
 +
	`ˇlcuœã_tŸÆ_cou¡_m©ches
(
cou¡îs
->
À·
, 
cur
);

563 i‡(
cou¡îs
->
right
) {

564 i‡(
cur
->
id
 =
MATCH_TIMESTAMP
) {

565 
ªsu…
 +(
size_t
Ë
	`abs
((Ë(
	`©ﬁ
(
cou¡îs
->
right
->
m©ch
->m©ch->
vÆue
) -átol(counters->match->match->value))) - 1;

567 
ªsu…
 +
	`ˇlcuœã_tŸÆ_cou¡_m©ches
(
cou¡îs
->
right
, 
cur
);

570  
ªsu…
;

571 
	}
}

577 
boﬁ


578 
	$has_¥evious_m©ch
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

580 i‡(!
cou¡îs
) {

581  
Ál£
;

584 i‡(
cou¡îs
->
À·
) {

585 i‡(
cou¡îs
->
À·
->
m©ch
->m©ch->
id
 =
cur
->id) {

586  
åue
;

587 } i‡(
	`has_¥evious_m©ch
(
cou¡îs
->
À·
, 
cur
)) {

588  
åue
;

589 } i‡(
cou¡îs
->
À·
->
right
) {

590 i‡(
cou¡îs
->
À·
->
right
->
m©ch
->m©ch->
id
 =
cur
->id) {

591  
åue
;

592 } i‡(
	`has_¥evious_m©ch
(
cou¡îs
->
À·
->
right
, 
cur
)) {

593  
åue
;

597  
Ál£
;

598 
	}
}

604 
boﬁ


605 
	$has_√xt_m©ch
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

607 i‡(!
cou¡îs
) {

608  
Ál£
;

611 i‡(
cou¡îs
->
right
) {

612 i‡(
cou¡îs
->
right
->
m©ch
->m©ch->
id
 =
cur
->id) {

613  
åue
;

614 } i‡(
	`has_√xt_m©ch
(
cou¡îs
->
right
, 
cur
)) {

615  
åue
;

616 } i‡(
cou¡îs
->
right
->
À·
) {

617 i‡(
cou¡îs
->
right
->
À·
->
m©ch
->m©ch->
id
 =
cur
->id) {

618  
åue
;

619 } i‡(
	`has_√xt_m©ch
(
cou¡îs
->
right
->
À·
, 
cur
)) {

620  
åue
;

624  
Ál£
;

625 
	}
}

631 
m©ch_ex¥essi⁄
 *

632 
	$gë_fú°_m©ch_ex¥essi⁄
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

634 i‡(!
cou¡îs
) {

635  
NULL
;

638 i‡(
	`has_¥evious_m©ch
(
cou¡îs
, 
cur
)) {

639  
	`gë_fú°_m©ch_ex¥essi⁄
(
cou¡îs
->
À·
, 
cur
);

640 } i‡(
cou¡îs
->
m©ch
->m©ch->
id
 =
cur
->id) {

641  
cou¡îs
->
m©ch
;

642 } i‡(
cou¡îs
->
right
) {

643  
	`gë_fú°_m©ch_ex¥essi⁄
(
cou¡îs
->
right
, 
cur
);

645  
NULL
;

647 
	}
}

653 
m©ch_ex¥essi⁄
 *

654 
	$gë_£c⁄d_m©ch_ex¥essi⁄
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

656 i‡(!
cou¡îs
) {

657  
NULL
;

660 i‡(
	`has_¥evious_m©ch
(
cou¡îs
, 
cur
)) {

661 i‡(
	`has_¥evious_m©ch
(
cou¡îs
->
À·
, 
cur
)) {

662  
	`gë_£c⁄d_m©ch_ex¥essi⁄
(
cou¡îs
->
À·
, 
cur
);

664  
cou¡îs
->
À·
->
m©ch
;

669  } i‡(
cou¡îs
->
right
) {

670  
	`gë_fú°_m©ch_ex¥essi⁄
(
cou¡îs
->
right
, 
cur
);

672  
NULL
;

674 
	}
}

680 
m©ch_ex¥essi⁄
 *

681 
	$gë_œ°_m©ch_ex¥essi⁄
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

683 i‡(!
cou¡îs
) {

684  
NULL
;

687 i‡(
	`has_√xt_m©ch
(
cou¡îs
, 
cur
)) {

688  
	`gë_œ°_m©ch_ex¥essi⁄
(
cou¡îs
->
right
, 
cur
);

689 } i‡(
cou¡îs
->
m©ch
->m©ch->
id
 =
cur
->id) {

690  
cou¡îs
->
m©ch
;

691 } i‡(
cou¡îs
->
À·
) {

692  
	`gë_œ°_m©ch_ex¥essi⁄
(
cou¡îs
->
À·
, 
cur
);

694  
NULL
;

696 
	}
}

702 
m©ch_ex¥essi⁄
 *

703 
	$gë_œ°_but_⁄e_m©ch_ex¥essi⁄
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

705 i‡(!
cou¡îs
) {

706  
NULL
;

709 i‡(
	`has_√xt_m©ch
(
cou¡îs
, 
cur
)) {

710 i‡(
	`has_√xt_m©ch
(
cou¡îs
->
right
, 
cur
)) {

711  
	`gë_œ°_but_⁄e_m©ch_ex¥essi⁄
(
cou¡îs
->
right
, 
cur
);

713  
cou¡îs
->
m©ch
;

718  } i‡(
cou¡îs
->
À·
) {

719  
	`gë_œ°_m©ch_ex¥essi⁄
(
cou¡îs
->
right
, 
cur
);

721  
NULL
;

723 
	}
}

725 
size_t


726 
	$gë_fú°_cou¡
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

728 
m©ch_ex¥essi⁄
 *
o
 = 
	`gë_fú°_m©ch_ex¥essi⁄
(
cou¡îs
, 
cur
);

729 i‡(
o
) {

730  
o
->
cou¡
;

734 
	}
}

736 
size_t


737 
	$gë_œ°_cou¡
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

739 
m©ch_ex¥essi⁄
 *
o
 = 
	`gë_œ°_m©ch_ex¥essi⁄
(
cou¡îs
, 
cur
);

740 i‡(
o
) {

741  
o
->
cou¡
;

745 
	}
}

748 
size_t


749 
	$ˇlcuœã_tŸÆ_cou¡
(
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

751 
size_t
 
ªsu…
 = 0;

753 i‡(!
cou¡îs
) {

757 i‡(
cou¡îs
->
m©ch
->m©ch->
id
 =
cur
->id) {

758 
ªsu…
 = 
cou¡îs
->
m©ch
->
cou¡
;

761 i‡(
cou¡îs
->
À·
) {

762 
ªsu…
 +
	`ˇlcuœã_tŸÆ_cou¡
(
cou¡îs
->
À·
, 
cur
);

764 i‡(
cou¡îs
->
right
) {

765 
ªsu…
 +
	`ˇlcuœã_tŸÆ_cou¡
(
cou¡îs
->
right
, 
cur
);

768  
ªsu…
;

769 
	}
}

772 
	$¥öt_cou¡î_avîages
(
FILE
 *
ouçut
, 
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
)

774 
size_t
 
tŸÆ_vÆue
;

775 
size_t
 
tŸÆ_cou¡
;

776 
m©ch_èbÀ
 *
mt
;

778 i‡(!
cou¡îs
 || !
ouçut
) {

782 i‡(!
cur
) {

783 
cur
 = 
cou¡îs
->
m©ch
->match;

784 
mt
 = 
	`gë_m©ch_by_id
(
cur
->
id
);

785 
tŸÆ_vÆue
 = 
	`ˇlcuœã_tŸÆ_vÆue
(
cou¡îs
, 
cur
);

786 
tŸÆ_cou¡
 = 
	`ˇlcuœã_tŸÆ_cou¡
(
cou¡îs
, 
cur
);

787 
	`¥ötf
("Avîagêf‹ %s: (%u / %uË%.02f\n", 
mt
->
«me
, (Ë
tŸÆ_vÆue
, (Ë
tŸÆ_cou¡
, ()Åotal_value / ()Åotal_count);

788 i‡(
cou¡îs
->
À·
) {

789 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
À·
, 
cur
);

791 i‡(
cou¡îs
->
right
) {

792 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
right
, 
cur
);

795 i‡(
cou¡îs
->
À·
) {

796 i‡(
cou¡îs
->
À·
->
m©ch
->m©ch->
id
 !
cur
->id) {

797 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
À·
, 
NULL
);

800 i‡(
cou¡îs
->
right
) {

801 i‡(
cou¡îs
->
right
->
m©ch
->m©ch->
id
 !
cur
->id) {

802 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
right
, 
NULL
);

808 
	}
}

811 
	$¥öt_cou¡î_avîage_cou¡
(
FILE
 *
ouçut
, 
m©ch_cou¡îs
 *
cou¡îs
, 
m©ch_›î©i⁄
 *
cur
, 
boﬁ
 
ªmove_fú°_œ°
)

813 
size_t
 
tŸÆ_m©ches
;

814 
size_t
 
tŸÆ_cou¡
;

815 
m©ch_èbÀ
 *
mt
;

817 i‡(!
cou¡îs
 || !
ouçut
) {

821 i‡(!
cur
) {

822 
cur
 = 
cou¡îs
->
m©ch
->match;

823 
mt
 = 
	`gë_m©ch_by_id
(
cur
->
id
);

824 
tŸÆ_m©ches
 = 
	`ˇlcuœã_tŸÆ_cou¡_m©ches
(
cou¡îs
, 
cur
);

825 
tŸÆ_cou¡
 = 
	`ˇlcuœã_tŸÆ_cou¡
(
cou¡îs
, 
cur
);

827 i‡(
ªmove_fú°_œ°
) {

828 
tŸÆ_cou¡
 -
	`gë_fú°_cou¡
(
cou¡îs
, 
cur
);

829 
tŸÆ_cou¡
 -
	`gë_œ°_cou¡
(
cou¡îs
, 
cur
);

830 
	`¥ötf
("Removög fú° cou¡ fromávîage: %u\n", (Ë
	`gë_fú°_cou¡
(
cou¡îs
,
cur
));

831 
	`¥ötf
("RemovögÜa° cou¡ fromávîage: %u\n", (Ë
	`gë_œ°_cou¡
(
cou¡îs
,
cur
));

835 i‡(
cur
->
id
 =
MATCH_TIMESTAMP
) {

836 i‡(
	`gë_fú°_m©ch_ex¥essi⁄
(
cou¡îs
, 
cur
Ë&& 
	`gë_£c⁄d_m©ch_ex¥essi⁄
(counters, cur)) {

837 
tŸÆ_m©ches
 -
	`©ﬁ
(
	`gë_£c⁄d_m©ch_ex¥essi⁄
(
cou¡îs
, 
cur
)->
m©ch
->
vÆue
Ë-átﬁ(
	`gë_fú°_m©ch_ex¥essi⁄
(counters, cur)->match->value);

839 i‡(
	`gë_œ°_m©ch_ex¥essi⁄
(
cou¡îs
, 
cur
Ë&& 
	`gë_œ°_but_⁄e_m©ch_ex¥essi⁄
(counters, cur)) {

840 
tŸÆ_m©ches
 -
	`©ﬁ
(
	`gë_œ°_m©ch_ex¥essi⁄
(
cou¡îs
, 
cur
)->
m©ch
->
vÆue
Ë-átﬁ(
	`gë_œ°_but_⁄e_m©ch_ex¥essi⁄
(counters, cur)->match->value);

843 
tŸÆ_m©ches
 -= 2;

846 
	`¥ötf
("Avîagêcou¡ f‹ %s: (%u / %uË%.02f\n", 
mt
->
«me
, (Ë
tŸÆ_cou¡
, (Ë
tŸÆ_m©ches
, ()Åotal_count / ()Åotal_matches);

847 i‡(
cou¡îs
->
À·
) {

848 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
À·
, 
cur
);

850 i‡(
cou¡îs
->
right
) {

851 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
right
, 
cur
);

854 i‡(
cou¡îs
->
À·
) {

855 i‡(
cou¡îs
->
À·
->
m©ch
->m©ch->
id
 !
cur
->id) {

856 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
À·
, 
NULL
);

859 i‡(
cou¡îs
->
right
) {

860 i‡(
cou¡îs
->
right
->
m©ch
->m©ch->
id
 !
cur
->id) {

861 
	`¥öt_cou¡î_avîages
(
ouçut
, 
cou¡îs
->
right
, 
NULL
);

867 
	}
}

869 
boﬁ


870 
	$m©ch_öt
(
ty≥_›î©‹
 
›î©‹
,

871 *
vÆue
,

872 *
mvÆue
)

874 
a
, 
b
;

876 i‡(!
vÆue
 || !
mvÆue
) {

877  
Ál£
;

880 
a
 = 
	`©oi
(
vÆue
);

881 
b
 = 
	`©oi
(
mvÆue
);

883 
›î©‹
) {

884 
OP_EQUAL
:

885  
a
 =
b
;

887 
OP_NOTEQUAL
:

888  
a
 !
b
;

890 
OP_GREATER
:

891  
a
 > 
b
;

893 
OP_LESSER
:

894  
a
 < 
b
;

896 
OP_GREATEREQUAL
:

897  
a
 >
b
;

899 
OP_LESSEREQUAL
:

900  
a
 <
b
;

903 
	`Ârötf
(
°dîr
, "Unknow¿›î©‹: %u\n", 
›î©‹
);

904 
	`exô
(2);

906 
	}
}

908 
boﬁ


909 
	$m©ch_›code
(
ty≥_›î©‹
 
›î©‹
,

910 *
vÆue
,

911 *
mvÆue
)

913 
ldns_pkt_›code
 
a
, 
b
;

914 
i
;

915 
ldns_lookup_èbÀ
 *
…
;

918 
…
 = 
	`ldns_lookup_by_«me
(
ldns_›codes
, 
vÆue
);

919 i‡(
…
) {

920 
a
 = 
…
->
id
;

922 
i
 = 
	`©oi
(
vÆue
);

923 i‡(
i
 >0 && !
	`isdigô
(
vÆue
[0]) == 0) {

924 
…
 = 
	`ldns_lookup_by_id
(
ldns_›codes
, 
i
);

925 i‡(
…
) {

926 
a
 = 
…
->
id
;

928 
	`Ârötf
(
°dîr
, "Unknow¿›code: %s\n", 
vÆue
);

929 
	`exô
(1);

930  
Ál£
;

933 
	`Ârötf
(
°dîr
, "Unknow¿›code: %s\n", 
vÆue
);

934 
	`exô
(1);

935  
Ál£
;

939 
…
 = 
	`ldns_lookup_by_«me
(
ldns_›codes
, 
mvÆue
);

940 i‡(
…
) {

941 
b
 = 
…
->
id
;

943 
i
 = 
	`©oi
(
mvÆue
);

944 i‡(
i
 >0 && !
	`isdigô
(
mvÆue
[0]) == 0) {

945 
…
 = 
	`ldns_lookup_by_id
(
ldns_›codes
, 
i
);

946 i‡(
…
) {

947 
b
 = 
…
->
id
;

949 
	`Ârötf
(
°dîr
, "Unknow¿›code: %s\n", 
mvÆue
);

950 
	`exô
(1);

951  
Ál£
;

954 
	`Ârötf
(
°dîr
, "Unknow¿›code: %s\n", 
mvÆue
);

955 
	`exô
(1);

956  
Ál£
;

960 
›î©‹
) {

961 
OP_EQUAL
:

962  
a
 =
b
;

964 
OP_NOTEQUAL
:

965  
a
 !
b
;

968 
	`Ârötf
(
°dîr
, "Eº‹ bad o≥øt‹ f‹ opcode: %s\n", 
	`gë_›_°r
(
›î©‹
));

969  
Ál£
;

972 
	}
}

974 
boﬁ


975 
	$m©ch_°r
(
ty≥_›î©‹
 
›î©‹
,

976 *
vÆue
,

977 *
mvÆue
)

979 *
vÆuedup
, *
mvÆuedup
;

980 
size_t
 
i
;

981 
boﬁ
 
ªsu…
;

983 i‡(
›î©‹
 =
OP_CONTAINS
) {

987 
vÆuedup
 = 
	`°rdup
(
vÆue
);

988 
mvÆuedup
 = 
	`°rdup
(
mvÆue
);

989 
i
 = 0; i < 
	`°æí
(
vÆuedup
); i++) {

990 
vÆuedup
[
i
] = 
	`tﬁowî
(valuedup[i]);

992 
i
 = 0; i < 
	`°æí
(
mvÆuedup
); i++) {

993 
mvÆuedup
[
i
] = 
	`tﬁowî
(mvaluedup[i]);

995 
ªsu…
 = 
	`°r°r
(
vÆuedup
, 
mvÆuedup
) != 0;

996 
	`‰ì
(
vÆuedup
);

997 
	`‰ì
(
mvÆuedup
);

998  
ªsu…
;

999 } i‡(
›î©‹
 =
OP_EQUAL
) {

1000  
	`°rcmp
(
vÆue
, 
mvÆue
) == 0;

1002  
	`°rcmp
(
vÆue
, 
mvÆue
) != 0;

1004 
	}
}

1006 
boﬁ


1007 
	$m©ch_º_ty≥
(
ty≥_›î©‹
 
›î©‹
,

1008 *
vÆue
,

1009 *
mvÆue
)

1011 
ldns_º_ty≥
 
a
,
b
;

1013 
a
 = 
	`ldns_gë_º_ty≥_by_«me
(
vÆue
);

1014 
b
 = 
	`ldns_gë_º_ty≥_by_«me
(
mvÆue
);

1016 
›î©‹
) {

1017 
OP_EQUAL
:

1018  
a
 =
b
;

1020 
OP_NOTEQUAL
:

1021  
a
 !
b
;

1023 
OP_GREATER
:

1024  
a
 > 
b
;

1026 
OP_LESSER
:

1027  
a
 < 
b
;

1029 
OP_GREATEREQUAL
:

1030  
a
 >
b
;

1032 
OP_LESSEREQUAL
:

1033  
a
 <
b
;

1036 
	`Ârötf
(
°dîr
, "Unknow¿›î©‹: %u\n", 
›î©‹
);

1037 
	`exô
(2);

1039 
	}
}

1041 
boﬁ


1042 
	$m©ch_rcode
(
ty≥_›î©‹
 
›î©‹
,

1043 *
vÆue
,

1044 *
mvÆue
)

1046 
a
, 
b
;

1047 
i
;

1048 
ldns_lookup_èbÀ
 *
…
;

1051 
…
 = 
	`ldns_lookup_by_«me
(
ldns_rcodes
, 
vÆue
);

1052 i‡(
…
) {

1053 
a
 = 
…
->
id
;

1055 
i
 = 
	`©oi
(
vÆue
);

1056 i‡(
i
 >0 && !
	`isdigô
(
vÆue
[0]) == 0) {

1057 
…
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
, 
i
);

1058 i‡(
…
) {

1059 
a
 = 
…
->
id
;

1061 
	`Ârötf
(
°dîr
, "Unknow¿rcode: %s\n", 
vÆue
);

1062 
	`exô
(1);

1063  
Ál£
;

1066 
	`Ârötf
(
°dîr
, "Unknow¿rcode: %s\n", 
vÆue
);

1067 
	`exô
(1);

1068  
Ál£
;

1072 
…
 = 
	`ldns_lookup_by_«me
(
ldns_rcodes
, 
mvÆue
);

1073 i‡(
…
) {

1074 
b
 = 
…
->
id
;

1076 
i
 = 
	`©oi
(
mvÆue
);

1078 i‡(
i
 >0 && !
	`isdigô
(
mvÆue
[0]) == 0) {

1079 
…
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
, 
i
);

1080 i‡(
…
) {

1081 
b
 = 
…
->
id
;

1083 
	`Ârötf
(
°dîr
, "Unknow¿rcode: %s\n", 
mvÆue
);

1084 
	`exô
(1);

1085  
Ál£
;

1088 
	`Ârötf
(
°dîr
, "Unknow¿rcode: %s\n", 
mvÆue
);

1089 
	`exô
(1);

1090  
Ál£
;

1094 
›î©‹
) {

1095 
OP_EQUAL
:

1096  
a
 =
b
;

1098 
OP_NOTEQUAL
:

1099  
a
 !
b
;

1102 
	`Ârötf
(
°dîr
, "Eº‹ bad o≥øt‹ f‹Ñcode: %s\n", 
	`gë_›_°r
(
›î©‹
));

1103  
Ál£
;

1106 
	}
}

1108 
boﬁ


1109 
	$vÆue_m©ches
(
m©ch_id
 
id
,

1110 
ty≥_›î©‹
 
›î©‹
,

1111 *
vÆue
,

1112 *
mvÆue
)

1114 
ªsu…
;

1116 i‡(
vîbosôy
 >= 5) {

1117 
	`¥ötf
("M©ch %s: %†%†%s: ", 
	`gë_m©ch_«me_°r
(
id
), 
vÆue
, 
	`gë_›_°r
(
›î©‹
), 
mvÆue
);

1119 
id
) {

1120 
MATCH_OPCODE
:

1121 
ªsu…
 = 
	`m©ch_›code
(
›î©‹
, 
vÆue
, 
mvÆue
);

1123 
MATCH_RCODE
:

1124 
ªsu…
 = 
	`m©ch_rcode
(
›î©‹
, 
vÆue
, 
mvÆue
);

1126 
MATCH_ID
:

1127 
MATCH_QR
:

1128 
MATCH_TC
:

1129 
MATCH_AD
:

1130 
MATCH_CD
:

1131 
MATCH_RD
:

1132 
MATCH_DO
:

1133 
MATCH_PACKETSIZE
:

1134 
MATCH_EDNS
:

1135 
MATCH_EDNS_PACKETSIZE
:

1136 
MATCH_QUESTION_SIZE
:

1137 
MATCH_ANSWER_SIZE
:

1138 
MATCH_AUTHORITY_SIZE
:

1139 
MATCH_ADDITIONAL_SIZE
:

1140 
MATCH_TIMESTAMP
:

1141 
ªsu…
 = 
	`m©ch_öt
(
›î©‹
, 
vÆue
, 
mvÆue
);

1143 
MATCH_QUERY
:

1144 
MATCH_QNAME
:

1145 
MATCH_ANSWER
:

1146 
MATCH_AUTHORITY
:

1147 
MATCH_ADDITIONAL
:

1148 
ªsu…
 = 
	`m©ch_°r
(
›î©‹
, 
vÆue
, 
mvÆue
);

1150 
MATCH_SRC_ADDRESS
:

1151 
MATCH_DST_ADDRESS
:

1152 
ªsu…
 = 
	`m©ch_°r
(
›î©‹
, 
vÆue
, 
mvÆue
);

1154 
MATCH_QTYPE
:

1155 
ªsu…
 = 
	`m©ch_º_ty≥
(
›î©‹
, 
vÆue
, 
mvÆue
);

1158 
	`Ârötf
(
°dîr
, "Eº‹: vÆue_m©ches(Ëf‹ o≥øt‹ %†nŸ im∂emíãd yë.\n", 
	`gë_›_°r
((
ty≥_›î©‹
Ë
id
));

1159 
	`exô
(3);

1161 i‡(
vîbosôy
 >= 5) {

1162 i‡(
ªsu…
) {

1163 
	`¥ötf
("true\n");

1165 
	`¥ötf
("false\n");

1168  
ªsu…
;

1169 
	}
}

1172 
	$gë_°rög_vÆue
(
m©ch_id
 
id
, 
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
§c_addr
,Üdns_rd‡*
d°_addr
)

1174 *
vÆ
;

1175 
m©ch_èbÀ
 *
mt
;

1176 
size_t
 
vÆsize
 = 100;

1178 
vÆ
 = 
	`mÆloc
(
vÆsize
);

1179 
	`mem£t
(
vÆ
, 0, 
vÆsize
);

1181 
id
) {

1182 
MATCH_QR
:

1183 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_qr
(
pkt
));

1185 
MATCH_ID
:

1186 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_id
(
pkt
));

1188 
MATCH_OPCODE
:

1189 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_gë_›code
(
pkt
));

1191 
MATCH_RCODE
:

1192 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_gë_rcode
(
pkt
));

1194 
MATCH_PACKETSIZE
:

1195 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_size
(
pkt
));

1197 
MATCH_TC
:

1198 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_tc
(
pkt
));

1200 
MATCH_AD
:

1201 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_ad
(
pkt
));

1203 
MATCH_CD
:

1204 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_cd
(
pkt
));

1206 
MATCH_RD
:

1207 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_rd
(
pkt
));

1209 
MATCH_EDNS
:

1210 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_edns
(
pkt
));

1212 
MATCH_EDNS_PACKETSIZE
:

1213 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_edns_udp_size
(
pkt
));

1215 
MATCH_DO
:

1216 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_edns_do
(
pkt
));

1218 
MATCH_QUESTION_SIZE
:

1219 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_qdcou¡
(
pkt
));

1221 
MATCH_ANSWER_SIZE
:

1222 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_™cou¡
(
pkt
));

1224 
MATCH_AUTHORITY_SIZE
:

1225 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_nscou¡
(
pkt
));

1227 
MATCH_ADDITIONAL_SIZE
:

1228 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_¨cou¡
(
pkt
));

1230 
MATCH_SRC_ADDRESS
:

1231 
	`‰ì
(
vÆ
);

1232 
vÆ
 = 
	`ldns_rdf2°r
(
§c_addr
);

1234 
MATCH_DST_ADDRESS
:

1235 
	`‰ì
(
vÆ
);

1236 
vÆ
 = 
	`ldns_rdf2°r
(
d°_addr
);

1238 
MATCH_TIMESTAMP
:

1239 
	`¢¥ötf
(
vÆ
, 
vÆsize
, "%u", (Ë
	`ldns_pkt_time°amp
(
pkt
).
tv_£c
);

1241 
MATCH_QUERY
:

1242 i‡(
	`ldns_pkt_qdcou¡
(
pkt
) > 0) {

1243 
	`‰ì
(
vÆ
);

1244 
vÆ
 = 
	`ldns_º2°r
(
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
pkt
), 0));

1246 i‡(
	`°rchr
(
vÆ
, '\n')) {

1247 *(
	`°rchr
(
vÆ
, '\n')) = '\0';

1250 
vÆ
[0] = '\0';

1253 
MATCH_QNAME
:

1254 i‡(
	`ldns_pkt_qdcou¡
(
pkt
) > 0) {

1255 
	`‰ì
(
vÆ
);

1256 
vÆ
 = 
	`ldns_rdf2°r
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
pkt
), 0)));

1258 i‡(
	`°rchr
(
vÆ
, '\n')) {

1259 *(
	`°rchr
(
vÆ
, '\n')) = '\0';

1262 
vÆ
[0] = '\0';

1265 
MATCH_QTYPE
:

1266 i‡(
	`ldns_pkt_qdcou¡
(
pkt
) > 0) {

1267 
	`‰ì
(
vÆ
);

1268 
vÆ
 = 
	`ldns_º_ty≥2°r
(
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
pkt
), 0)));

1270 
vÆ
[0] = '\0';

1273 
MATCH_ANSWER
:

1274 i‡(
	`ldns_pkt_™cou¡
(
pkt
) > 0) {

1275 
	`‰ì
(
vÆ
);

1276 
vÆ
 = 
	`ldns_º_li°2°r
(
	`ldns_pkt_™swî
(
pkt
));

1278 
vÆ
[0] = '\0';

1281 
MATCH_AUTHORITY
:

1282 i‡(
	`ldns_pkt_nscou¡
(
pkt
) > 0) {

1283 
	`‰ì
(
vÆ
);

1284 
vÆ
 = 
	`ldns_º_li°2°r
(
	`ldns_pkt_auth‹ôy
(
pkt
));

1286 
vÆ
[0] = '\0';

1289 
MATCH_ADDITIONAL
:

1290 i‡(
	`ldns_pkt_¨cou¡
(
pkt
) > 0) {

1291 
	`‰ì
(
vÆ
);

1292 
vÆ
 = 
	`ldns_º_li°2°r
(
	`ldns_pkt_addôi⁄Æ
(
pkt
));

1294 
vÆ
[0] = '\0';

1298 
mt
 = 
	`gë_m©ch_by_id
(
id
);

1299 i‡(!
mt
) {

1300 
	`¥ötf
("ERROR UNKNOWN MATCH_TABLE ID %u\n", 
id
);

1301 
	`exô
(1);

1303 
	`¥ötf
("M©chî f‹ %†nŸ im∂emíãd yë\n", 
mt
->
«me
);

1304 
	`exô
(1);

1305  
NULL
;

1308  
vÆ
;

1309 
	}
}

1311 
boﬁ


1312 
	$m©ch_∑ckë_to_›î©i⁄
(
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
§c_addr
,Üdns_rd‡*
d°_addr
, 
m©ch_›î©i⁄
 *
›î©i⁄
)

1314 
boﬁ
 
ªsu…
;

1315 *
vÆ
;

1317 i‡(!
pkt
 || !
›î©i⁄
) {

1318  
Ál£
;

1320 
vÆ
 = 
	`gë_°rög_vÆue
(
›î©i⁄
->
id
, 
pkt
, 
§c_addr
, 
d°_addr
);

1321 i‡(!
vÆ
) {

1322  
Ál£
;

1324 
ªsu…
 = 
	`vÆue_m©ches
(
›î©i⁄
->
id
, o≥øti⁄->
›î©‹
, 
vÆ
, o≥øti⁄->
vÆue
);

1325 
	`‰ì
(
vÆ
);

1326  
ªsu…
;

1328 
	}
}

1331 
	$m©ch_›î©i⁄_com∑ª
(c⁄° *
a
, c⁄° *
b
)

1333 
m©ch_›î©i⁄
 *
mﬂ
, *
mob
;

1334 
m©ch_èbÀ
 *
mt
;

1335 
ü
, 
ib
;

1337 i‡(!
a
) {

1339 } i‡(!
b
) {

1342 
mﬂ
 = (
m©ch_›î©i⁄
 *Ë
a
;

1343 
mob
 = (
m©ch_›î©i⁄
 *Ë
b
;

1345 i‡(
mﬂ
->
id
 < 
mob
->id) {

1347 } i‡(
mﬂ
->
id
 > 
mob
->id) {

1350 i‡(
mﬂ
->
›î©‹
 < 
mob
->operator) {

1352 } i‡(
mﬂ
->
›î©‹
 > 
mob
->operator) {

1355 
mt
 = 
	`gë_m©ch_by_id
(
mﬂ
->
id
);

1356 i‡(
mt
) {

1357 
mt
->
ty≥
) {

1358 
TYPE_INT
:

1359 
TYPE_TIMESTAMP
:

1360 
TYPE_BOOL
:

1361 
TYPE_OPCODE
:

1362 
TYPE_RCODE
:

1363 
ü
 = 
	`©ﬁ
(
mﬂ
->
vÆue
);

1364 
ib
 = 
	`©ﬁ
(
mob
->
vÆue
);

1365  
ü
 - 
ib
;

1367 
TYPE_STRING
:

1368 
TYPE_ADDRESS
:

1369 
TYPE_RR
:

1371  
	`°rcmp
(
mﬂ
->
vÆue
, 
mob
->value);

1375  
	`°rcmp
(
mﬂ
->
vÆue
, 
mob
->value);

1380 
	}
}

1383 
	$m©ch_ex¥essi⁄_com∑ª
(c⁄° *
a
, c⁄° *
b
)

1385 
m©ch_ex¥essi⁄
 *
mó
, *
meb
;

1387 i‡(!
a
) {

1389 } i‡(!
b
) {

1392 
mó
 = (
m©ch_ex¥essi⁄
 *Ë
a
;

1393 
meb
 = (
m©ch_ex¥essi⁄
 *Ë
b
;

1395 i‡(
mó
->
›
 < 
meb
->op) {

1397 } i‡(
mó
->
›
 > 
meb
->op) {

1400 
mó
->
›
) {

1401 
MATCH_EXPR_AND
:

1402 
MATCH_EXPR_OR
:

1403 i‡(
	`m©ch_ex¥essi⁄_com∑ª
(
mó
->
À·
, 
meb
->left) < 0) {

1405 } i‡(
	`m©ch_ex¥essi⁄_com∑ª
(
mó
->
À·
, 
meb
->left) > 0) {

1408  
	`m©ch_ex¥essi⁄_com∑ª
(
mó
->
right
, 
meb
->right);

1411 
MATCH_EXPR_LEAF
:

1412  
	`m©ch_›î©i⁄_com∑ª
(
mó
->
m©ch
, 
meb
->match);

1415 
	`Ârötf
(
°dîr
, "Unknow¿M©ch Ex¥essi⁄Üogi¯›î©‹: %u\n", 
mó
->
›
);

1416 
	`exô
(1);

1420 
	}
}

1426 
	$add_m©ch_cou¡î
(
m©ch_cou¡îs
 *
cou¡îs
,

1427 
m©ch_ex¥essi⁄
 *
ex¥
,

1428 
boﬁ
 
cou¡
)

1430 
cmp
;

1431 
m©ch_cou¡îs
 *
√w
;

1433 i‡(!
cou¡îs
 || !
ex¥
) {

1436 i‡(
cou¡îs
->
m©ch
) {

1437 
cmp
 = 
	`m©ch_ex¥essi⁄_com∑ª
(
cou¡îs
->
m©ch
,

1438 
ex¥
);

1439 i‡(
cmp
 > 0) {

1440 i‡(
cou¡îs
->
À·
) {

1441  
	`add_m©ch_cou¡î
(
cou¡îs
->
À·
,

1442 
ex¥
,

1443 
cou¡
);

1445 
√w
 = 
	`mÆloc
((
m©ch_cou¡îs
));

1446 
√w
->
À·
 = 
NULL
;

1447 
√w
->
right
 = 
NULL
;

1448 
√w
->
m©ch
 = 
ex¥
;

1449 
cou¡îs
->
À·
 = 
√w
;

1452 } i‡(
cmp
 < 0) {

1453 i‡(
cou¡îs
->
right
) {

1454  
	`add_m©ch_cou¡î
(
cou¡îs
->
right
,

1455 
ex¥
,

1456 
cou¡
);

1458 
√w
 = 
	`mÆloc
((
m©ch_cou¡îs
));

1459 
√w
->
À·
 = 
NULL
;

1460 
√w
->
right
 = 
NULL
;

1461 
√w
->
m©ch
 = 
ex¥
;

1462 
cou¡îs
->
right
 = 
√w
;

1467 i‡(
cou¡
) {

1468 
cou¡îs
->
m©ch
->
cou¡
++;

1474 
cou¡îs
->
m©ch
 = 
ex¥
;

1478 
	}
}

1480 
boﬁ


1481 
	$m©ch_dns_∑ckë_to_ex¥
(
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
§c_addr
,Üdns_rd‡*
d°_addr
, 
m©ch_ex¥essi⁄
 *
ex¥
)

1483 
boﬁ
 
ªsu…
;

1485 i‡(!
pkt
 || !
ex¥
) {

1486  
Ál£
;

1489 
ex¥
->
›
) {

1490 
MATCH_EXPR_OR
:

1491 
ªsu…
 = (
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
ex¥
->
À·
) ||

1492 
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
ex¥
->
right
));

1494 
MATCH_EXPR_AND
:

1495 
ªsu…
 = (
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
ex¥
->
À·
) &&

1496 
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
ex¥
->
right
));

1498 
MATCH_EXPR_LEAF
:

1499 
ªsu…
 = 
	`m©ch_∑ckë_to_›î©i⁄
(
pkt
, 
§c_addr
, 
d°_addr
, 
ex¥
->
m©ch
);

1502 
	`Ârötf
(
°dîr
, "Eº‹, unknow¿ex¥essi⁄ o≥øt‹ %u\n", 
ex¥
->
›
);

1503 
	`Ârötf
(
°dîr
, "fullÉxpression:\n");

1504 
	`¥öt_m©ch_ex¥essi⁄
(
°dîr
, 
ex¥
);

1505 
	`Ârötf
(
°dîr
, "\n");

1506 
	`exô
(1);

1509 i‡(
ªsu…
) {

1510 i‡(
vîbosôy
 >= 5) {

1511 
	`¥ötf
("Found Match:\n");

1512 
	`¥öt_m©ch_ex¥essi⁄
(
°dout
, 
ex¥
);

1513 
	`¥ötf
("\nCou¡Çow %u\n", (Ë
ex¥
->
cou¡
);

1515 
ex¥
->
cou¡
++;

1518  
ªsu…
;

1519 
	}
}

1522 
	$‰ì_m©ch_›î©i⁄
(
m©ch_›î©i⁄
 *
›î©i⁄
)

1524 i‡(
›î©i⁄
) {

1525 i‡(
›î©i⁄
->
vÆue
) {

1526 
	`‰ì
(
›î©i⁄
->
vÆue
);

1528 
	`‰ì
(
›î©i⁄
);

1530 
	}
}

1533 
	$‰ì_m©ch_ex¥essi⁄
(
m©ch_ex¥essi⁄
 *
ex¥
)

1535 i‡(
ex¥
) {

1536 
ex¥
->
›
) {

1537 
MATCH_EXPR_OR
:

1538 
MATCH_EXPR_AND
:

1539 
	`‰ì_m©ch_ex¥essi⁄
(
ex¥
->
À·
);

1540 
	`‰ì_m©ch_ex¥essi⁄
(
ex¥
->
right
);

1542 
MATCH_EXPR_LEAF
:

1543 
	`‰ì_m©ch_›î©i⁄
(
ex¥
->
m©ch
);

1546 
	`‰ì
(
ex¥
);

1548 
	}
}

1551 
	$‰ì_cou¡îs
(
m©ch_cou¡îs
 *
cou¡îs
)

1553 i‡(
cou¡îs
) {

1554 i‡(
cou¡îs
->
À·
) {

1555 
	`‰ì_cou¡îs
(
cou¡îs
->
À·
);

1557 i‡(
cou¡îs
->
m©ch
) {

1558 
	`‰ì_m©ch_ex¥essi⁄
(
cou¡îs
->
m©ch
);

1560 i‡(
cou¡îs
->
right
) {

1561 
	`‰ì_cou¡îs
(
cou¡îs
->
right
);

1563 
	`‰ì
(
cou¡îs
);

1565 
	}
}

1568 
	$m©ch_pkt_cou¡îs
(
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
§c_addr
,Üdns_rd‡*
d°_addr
, 
m©ch_cou¡îs
 *
cou¡s
)

1570 i‡(
cou¡s
->
À·
) {

1571 
	`m©ch_pkt_cou¡îs
(
pkt
, 
§c_addr
, 
d°_addr
, 
cou¡s
->
À·
);

1573 i‡(
cou¡s
->
m©ch
) {

1574 i‡(
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
cou¡s
->
m©ch
)) {

1580 i‡(
cou¡s
->
right
) {

1581 
	`m©ch_pkt_cou¡îs
(
pkt
, 
§c_addr
, 
d°_addr
, 
cou¡s
->
right
);

1583 
	}
}

1586 
	$m©ch_pkt_uniques
(
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
§c_addr
,Üdns_rd‡*
d°_addr
, 
m©ch_cou¡îs
 *
uniques
, 
m©ch_id
 
unique_ids
[], 
size_t
 
unique_id_cou¡
)

1588 
m©ch_ex¥essi⁄
 *
me
;

1589 
size_t
 
i
;

1590 
m©ch_›î©i⁄
 *
mo
;

1591 
add_ªsu…
;

1593 
i
 = 0; i < 
unique_id_cou¡
; i++) {

1594 
mo
 = 
	`mÆloc
((
m©ch_›î©i⁄
));

1595 
mo
->
id
 = 
unique_ids
[
i
];

1596 
mo
->
›î©‹
 = 
OP_EQUAL
;

1597 
mo
->
vÆue
 = 
	`gë_°rög_vÆue
(mo->
id
, 
pkt
, 
§c_addr
, 
d°_addr
);

1599 
me
 = 
	`mÆloc
((
m©ch_ex¥essi⁄
));

1600 
me
->
›
 = 
MATCH_EXPR_LEAF
;

1601 
me
->
À·
 = 
NULL
;

1602 
me
->
right
 = 
NULL
;

1603 
me
->
m©ch
 = 
mo
;

1604 
me
->
cou¡
 = 1;

1606 
add_ªsu…
 = 
	`add_m©ch_cou¡î
(
uniques
, 
me
, 
åue
);

1608 i‡(
add_ªsu…
 == 1) {

1609 
	`‰ì_m©ch_ex¥essi⁄
(
me
);

1614 
size_t
 
i
, 
j
;

1615 
boﬁ
 
found
;

1616 
m©ch_ex¥essi⁄
 *
me
;

1617 
m©ch_›î©i⁄
 *
mo
;

1621 
found
 = 
Ál£
;

1622 
j
 = 0; j < 
uniques
->
size
; j++) {

1623 i‡(
uniques
->
cou¡î
[
j
]->
m©ch
->
id
 =
unique_ids
[
i
]) {

1624 i‡(
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
uniques
->
cou¡î
[
j
])) {

1625 
found
 = 
åue
;

1629 i‡(!
found
) {

1630 
mo
 = 
	`mÆloc
((
m©ch_›î©i⁄
));

1631 
mo
->
id
 = 
unique_ids
[
i
];

1632 
mo
->
›î©‹
 = 
OP_EQUAL
;

1633 
mo
->
vÆue
 = 
	`gë_°rög_vÆue
(mo->
id
, 
pkt
, 
§c_addr
, 
d°_addr
);

1635 
me
 = 
	`mÆloc
((
m©ch_ex¥essi⁄
));

1636 
me
->
m©ch
 = 
mo
;

1637 
me
->
›
 = 
MATCH_EXPR_LEAF
;

1638 
me
->
À·
 = 
NULL
;

1639 
me
->
right
 = 
NULL
;

1640 
me
->
cou¡
 = 1;

1642 
	`add_cou¡î
(
uniques
, 
me
);

1644 
	}
}

1648 
m©ch_ex¥essi⁄
 *

1649 
	$∑r£_m©ch_ex¥essi⁄
(*
°rög
)

1651 
m©ch_ex¥essi⁄
 *
ex¥
;

1652 
size_t
 
i
,
j
;

1653 
size_t
 
À·°¨t
, 
À·íd
 = 0;

1654 *
À·_°r
, *
›
, *
vÆ
;

1655 
m©ch_èbÀ
 *
mt
;

1656 
m©ch_›î©i⁄
 *
mo
 = 
NULL
;

1657 c⁄° 
ty≥_›î©‹s
 *
tos
;

1658 
m©ch_ex¥essi⁄
 *
ªsu…
;

1659 
ldns_lookup_èbÀ
 *
…
 = 
NULL
;

1662 *
°r
 = 
	`mÆloc
(
	`°æí
(
°rög
) + 1);

1664 
j
 = 0;

1665 
i
 = 0; i < 
	`°æí
(
°rög
); i++) {

1666 if(!
	`is•a˚
(
°rög
[
i
])) {

1667 
°r
[
j
] = 
°rög
[
i
];

1668 
j
++;

1671 
°r
[
j
] = '\0';

1673 
ex¥
 = 
	`mÆloc
((
m©ch_ex¥essi⁄
));

1674 
ex¥
->
À·
 = 
NULL
;

1675 
ex¥
->
right
 = 
NULL
;

1676 
ex¥
->
m©ch
 = 
NULL
;

1677 
ex¥
->
cou¡
 = 0;

1678 
À·°¨t
 = 0;

1679 
i
 = 0; i < 
	`°æí
(
°r
); i++) {

1680 i‡(
°r
[
i
] == '&') {

1681 
ex¥
->
›
 = 
MATCH_EXPR_AND
;

1682 i‡(!
ex¥
->
À·
) {

1683 
À·_°r
 = 
	`mÆloc
(
À·íd
 - 
À·°¨t
 + 2);

1684 
	`°∫˝y
(
À·_°r
, &
°r
[
À·°¨t
], 
À·íd
-leftstart+1);

1685 
À·_°r
[
À·íd
 - 
À·°¨t
 + 1] = '\0';

1686 
ex¥
->
À·
 = 
	`∑r£_m©ch_ex¥essi⁄
(
À·_°r
);

1687 
	`‰ì
(
À·_°r
);

1689 
ex¥
->
right
 = 
	`∑r£_m©ch_ex¥essi⁄
(&
°r
[
i
+1]);

1690 i‡(
ex¥
->
À·
 &&Éx¥->
right
) {

1691 
ªsu…
 = 
ex¥
;

1692 
d⁄e
;

1694 
ªsu…
 = 
NULL
;

1695 
d⁄e
;

1697 } i‡(
°r
[
i
] == '|') {

1698 
ex¥
->
›
 = 
MATCH_EXPR_OR
;

1699 i‡(!
ex¥
->
À·
) {

1700 
À·_°r
 = 
	`mÆloc
(
À·íd
 - 
À·°¨t
 + 2);

1701 
	`°∫˝y
(
À·_°r
, &
°r
[
À·°¨t
], 
À·íd
-leftstart+1);

1702 
À·_°r
[
À·íd
 - 
À·°¨t
 + 1] = '\0';

1703 
ex¥
->
À·
 = 
	`∑r£_m©ch_ex¥essi⁄
(
À·_°r
);

1704 
	`‰ì
(
À·_°r
);

1706 
ex¥
->
right
 = 
	`∑r£_m©ch_ex¥essi⁄
(&
°r
[
i
+1]);

1707 
ex¥
->
cou¡
 = 0;

1708 i‡(
ex¥
->
À·
 &&Éx¥->
right
) {

1709 
ªsu…
 = 
ex¥
;

1710 
d⁄e
;

1712 
ªsu…
 = 
NULL
;

1713 
d⁄e
;

1715 } i‡(
°r
[
i
] == '(') {

1716 
À·°¨t
 = 
i
 + 1;

1717 
j
 = 1;

1718 
j
 > 0) {

1719 
i
++;

1720 i‡(
i
 > 
	`°æí
(
°r
)) {

1721 
	`¥ötf
("∑r£Éº‹:Çÿ˛osög bøckë: %s\n", 
°r
);

1722 
	`¥ötf
(" ");

1723 
j
 = 0; j < 
À·°¨t
 - 1; j++) {

1724 
	`¥ötf
(" ");

1726 
	`¥ötf
("^\n");

1727 
ªsu…
 = 
NULL
;

1728 
d⁄e
;

1730 i‡(
°r
[
i
] == ')') {

1731 
j
--;

1732 } i‡(
°r
[
i
] == '(') {

1733 
j
++;

1737 
À·íd
 = 
i
-1;

1738 
À·_°r
 = 
	`mÆloc
(
À·íd
 - 
À·°¨t
 + 1);

1739 
	`°∫˝y
(
À·_°r
, &
°r
[
À·°¨t
], 
À·íd
 -Üeftstart + 1);

1740 
ex¥
->
À·
 = 
	`∑r£_m©ch_ex¥essi⁄
(
À·_°r
);

1741 
	`‰ì
(
À·_°r
);

1742 i‡(
i
 >
	`°æí
(
°r
)-1) {

1743 
ªsu…
 = 
ex¥
->
À·
;

1744 
d⁄e
;

1746 } i‡(
°r
[
i
] == ')') {

1747 
	`¥ötf
("parseÉrror: ) without (\n");

1748 
ªsu…
 = 
NULL
;

1749 
d⁄e
;

1751 
À·íd
 = 
i
;

1757 
i
 = 0; i < 
	`°æí
(
°r
); i++) {

1758 i‡(
°r
[
i
] == '=' ||

1759 
°r
[
i
] == '>' ||

1760 
°r
[
i
] == '<' ||

1761 
°r
[
i
] == '!' ||

1762 
°r
[
i
] == '~'

1764 
À·íd
 = 
i
-1;

1765 
›
 = 
	`mÆloc
(3);

1766 
j
 = 0;

1767 
›
[
j
] = 
°r
[
i
];

1768 
i
++;

1769 
j
++;

1771 i‡(
i
 > 
	`°æí
(
°r
)) {

1772 
	`¥ötf
("∑r£Éº‹Çÿrighàh™d side: %s\n", 
°r
);

1773 
ªsu…
 = 
NULL
;

1774 
d⁄e
;

1776 i‡(
°r
[
i
] == '=' ||

1777 
°r
[
i
] == '>' ||

1778 
°r
[
i
] == '<' ||

1779 
°r
[
i
] == '!' ||

1780 
°r
[
i
] == '~'

1782 
›
[
j
] = 
°r
[
i
];

1783 
i
++;

1784 
j
++;

1785 i‡(
i
 > 
	`°æí
(
°r
)) {

1786 
	`¥ötf
("∑r£Éº‹Çÿrighàh™d side: %s\n", 
°r
);

1787 
ªsu…
 = 
NULL
;

1788 
d⁄e
;

1791 
›
[
j
] = '\0';

1792 
À·_°r
 = 
	`mÆloc
(
À·íd
 - 
À·°¨t
 + 2);

1793 
	`°∫˝y
(
À·_°r
, &
°r
[
À·°¨t
], 
À·íd
 -Üeftstart + 1);

1794 
À·_°r
[
À·íd
 - 
À·°¨t
 + 1] = '\0';

1795 
mt
 = 
	`gë_m©ch_by_«me
(
À·_°r
);

1796 i‡(!
mt
) {

1797 
	`¥ötf
("∑r£Éº‹: unknow¿m©chÇame: %s\n", 
À·_°r
);

1798 
ªsu…
 = 
NULL
;

1799 
d⁄e
;

1802 
tos
 = 
	`gë_ty≥_›î©‹s
(
mt
->
ty≥
);

1803 
j
 = 0; j < 
tos
->
›î©‹_cou¡
; j++) {

1804 i‡(
	`gë_›_id
(
›
Ë=
tos
->
›î©‹s
[
j
]) {

1805 
mo
 = 
	`mÆloc
((
m©ch_›î©i⁄
));

1806 
mo
->
id
 = 
mt
->id;

1807 
mo
->
›î©‹
 = 
	`gë_›_id
(
›
);

1808 
mt
->
ty≥
) {

1809 
TYPE_BOOL
:

1810 
vÆ
 = 
	`mÆloc
(2);

1811 i‡(
	`°∫cmp
(&
°r
[
i
], "true", 5) == 0 ||

1812 
	`°∫cmp
(&
°r
[
i
], "TRUE", 5) == 0 ||

1813 
	`°∫cmp
(&
°r
[
i
], "True", 5) == 0 ||

1814 
	`°∫cmp
(&
°r
[
i
], "1", 2) == 0

1816 
vÆ
[0] = '1';

1817 
vÆ
[1] = '\0';

1818 } i‡(
	`°∫cmp
(&
°r
[
i
], "false", 5) == 0 ||

1819 
	`°∫cmp
(&
°r
[
i
], "FALSE", 5) == 0 ||

1820 
	`°∫cmp
(&
°r
[
i
], "False", 5) == 0 ||

1821 
	`°∫cmp
(&
°r
[
i
], "0", 2) == 0

1824 
vÆ
[0] = '0';

1826 
	`Ârötf
(
°dîr
, "Bad vÆuêf‹ boﬁ: %s\n", &
°r
[
i
]);

1827 
	`exô
(
EXIT_FAILURE
);

1829 
vÆ
[1] = '\0';

1831 
TYPE_RR
:

1848 
vÆ
 = 
	`°rdup
(&
°r
[
i
]);

1850 
TYPE_OPCODE
:

1851 
…
 = 
	`ldns_lookup_by_«me
(
ldns_›codes
, &
°r
[
i
]);

1852 i‡(
…
) {

1853 
vÆ
 = 
	`mÆloc
(4);

1854 
	`¢¥ötf
(
vÆ
, 3, "%u", (Ë
…
->
id
);

1856 
vÆ
 = 
	`°rdup
(&
°r
[
i
]);

1859 
TYPE_RCODE
:

1860 
…
 = 
	`ldns_lookup_by_«me
(
ldns_rcodes
, &
°r
[
i
]);

1861 i‡(
…
) {

1862 
vÆ
 = 
	`mÆloc
(4);

1863 
	`¢¥ötf
(
vÆ
, 3, "%u", (Ë
…
->
id
);

1865 
vÆ
 = 
	`°rdup
(&
°r
[
i
]);

1869 
vÆ
 = 
	`°rdup
(&
°r
[
i
]);

1872 
mo
->
vÆue
 = 
vÆ
;

1875 i‡(!
mo
) {

1876 
	`¥ötf
("∑r£Éº‹: o≥øt‹ %†nŸáŒowed f‹ m©ch %s\n", 
›
, 
À·_°r
);

1877 
ªsu…
 = 
NULL
;

1878 
d⁄e
;

1881 
	`‰ì
(
À·_°r
);

1882 
	`‰ì
(
›
);

1883 
ex¥
->
m©ch
 = 
mo
;

1884 
ex¥
->
›
 = 
MATCH_EXPR_LEAF
;

1885 
ªsu…
 = 
ex¥
;

1886 
d⁄e
;

1890 
ªsu…
 = 
NULL
;

1892 
d⁄e
:

1893 
	`‰ì
(
°r
);

1894 i‡(!
ªsu…
) {

1895 
	`‰ì_m©ch_ex¥essi⁄
(
ex¥
);

1897  
ªsu…
;

1899 
	}
}

1902 
	$ußge
(
FILE
 *
ouçut
)

1904 
	`Ârötf
(
ouçut
, "Usage:Üdns-dpa [OPTIONS] <pcap file>\n");

1905 
	`Ârötf
(
ouçut
, "Options:\n");

1906 
	`Ârötf
(
ouçut
, "\t-c <exprlist>:\tCount occurrences of matchingÉxpressions\n");

1907 
	`Ârötf
(
ouçut
, "\t-f <expression>:\tFilter occurrences of matchingÉxpressions\n");

1908 
	`Ârötf
(
ouçut
, "\t-h:\t\tshowÅhis help\n");

1909 
	`Ârötf
(
ouçut
, "\t-p:\t\tshowÖercentage of -uánd -c values (ofÅheÅotal of\n\t\t\tmatching onÅhe -f filter. ifÇo filter is given,\n\t\t\tpercentagesáre onáll correct dnsÖackets)\n");

1910 
	`Ârötf
(
ouçut
, "\t-of <file>:\tWriteÖcapÖacketsÅhat matchÅhe -f flagÅo file\n");

1911 
	`Ârötf
(
ouçut
, "\t-ofh <file>:\tWriteÖcapÖacketsÅhat matchÅhe -f flagÅo file\n\t\tiná hexadecimal formatÑeadable by drill\n");

1912 
	`Ârötf
(
ouçut
, "\t-s:\t\tshowÖossible matchÇames\n");

1913 
	`Ârötf
(
ouçut
, "\t-s <matchname>:\tshowÖossible match operatorsánd values for <name>\n");

1914 
	`Ârötf
(
ouçut
, "\t-sf:\t\tPrintÖacketÅhat match -f. IfÇo -f is given,Örint\n\t\t\tall dnsÖackets\n");

1915 
	`Ârötf
(
ouçut
, "\t-u <matchnamelist>:\tCountáll occurrences of matchname\n");

1916 
	`Ârötf
(
ouçut
, "\t-ua:\t\tShowáverage value ofÉvery -u matchname\n");

1917 
	`Ârötf
(
ouçut
, "\t-uac:\t\tShowáverage count ofÉvery -u matchname\n");

1918 
	`Ârötf
(
ouçut
, "\t-um <number>:\tOnly show -uÑesultsÅhat occured moreÅhanÇumberÅimes\n");

1919 
	`Ârötf
(
ouçut
, "\t-v <level>:\tbe more verbose\n");

1920 
	`Ârötf
(
ouçut
, "\t-notip <file>:\tDumpÖcapÖacketsÅhat wereÇotÑecognizedás\n\t\t\tIPÖacketsÅo file\n");

1921 
	`Ârötf
(
ouçut
, "\t-baddns <file>:\tDump mangled dnsÖacketsÅo file\n");

1922 
	`Ârötf
(
ouçut
, "\t-version:\tShowÅhe versionándÉxit\n");

1923 
	`Ârötf
(
ouçut
, "\n");

1924 
	`Ârötf
(
ouçut
, "The filename '-' stands for stdin or stdout, so you can use \"-of -\" if you wantÅoÖipeÅhe outputÅoánotherÖrocess\n");

1925 
	`Ârötf
(
ouçut
, "\n");

1926 
	`Ârötf
(
ouçut
, "A <list> isá comma separatedÜist of items\n");

1927 
	`Ârötf
(
ouçut
, "\n");

1928 
	`Ârötf
(
ouçut
, "AnÉxpression hasÅhe following form:\n");

1929 
	`Ârötf
(
ouçut
, "<expr>:\t(<expr>)\n");

1930 
	`Ârötf
(
ouçut
, "\t<expr> | <expr>\n");

1931 
	`Ârötf
(
ouçut
, "\t<expr> & <expr>\n");

1932 
	`Ârötf
(
ouçut
, "\t<match>\n");

1933 
	`Ârötf
(
ouçut
, "\n");

1934 
	`Ârötf
(
ouçut
, "<match>:\t<matchname> <operator> <value>\n");

1935 
	`Ârötf
(
ouçut
, "\n");

1936 
	`Ârötf
(
ouçut
, "SeeÅhe -s option forÖossible matchnames, operatorsánd values.\n");

1937 
	}
}

1940 
	$show_m©ch_«mes
(*
«me
)

1942 
size_t
 
j
;

1943 
m©ch_èbÀ
 *
mt
;

1944 
ldns_lookup_èbÀ
 *
…
;

1945 c⁄° 
ty≥_›î©‹s
 *
tos
;

1946 *
°r
;

1947 
size_t
 
i
;

1949 i‡(
«me
) {

1950 
mt
 = 
	`gë_m©ch_by_«me
(
«me
);

1951 i‡(
mt
) {

1952 
	`¥ötf
("%s:\n", 
mt
->
«me
);

1953 
	`¥ötf
("\t%s.\n", 
mt
->
des¸ùti⁄
);

1954 
	`¥ötf
("\toperators: ");

1955 
	`¥ötf
("\t");

1956 
tos
 = 
	`gë_ty≥_›î©‹s
(
mt
->
ty≥
);

1957 i‡(
tos
) {

1958 
j
 = 0; j < 
tos
->
›î©‹_cou¡
; j++) {

1959 
	`¥ötf
("%†", 
	`gë_›_°r
(
tos
->
›î©‹s
[
j
]));

1970 
	`¥ötf
("unknownÅype");

1973 
	`¥ötf
("\n");

1974 
	`¥ötf
("\tValues:\n");

1975 
mt
->
ty≥
) {

1976 
TYPE_INT
:

1977 
	`¥ötf
("\t\t<Integer>\n");

1979 
TYPE_BOOL
:

1980 
	`¥ötf
("\t\t0\n");

1981 
	`¥ötf
("\t\t1\n");

1982 
	`¥ötf
("\t\ttrue\n");

1983 
	`¥ötf
("\t\tfalse\n");

1985 
TYPE_OPCODE
:

1986 
	`¥ötf
("\t\t<Integer>\n");

1987 
…
 = 
ldns_›codes
;

1988 
…
->
«me
 !
NULL
) {

1989 
	`¥ötf
("\t\t%s\n", 
…
->
«me
);

1990 
…
++;

1993 
TYPE_RCODE
:

1994 
	`¥ötf
("\t\t<Integer>\n");

1995 
…
 = 
ldns_rcodes
;

1996 
…
->
«me
 !
NULL
) {

1997 
	`¥ötf
("\t\t%s\n", 
…
->
«me
);

1998 
…
++;

2001 
TYPE_STRING
:

2002 
	`¥ötf
("\t\t<String>\n");

2004 
TYPE_TIMESTAMP
:

2005 
	`¥ötf
("\t\t<Integer> (seconds sinceÉpoch)\n");

2007 
TYPE_ADDRESS
:

2008 
	`¥ötf
("\t\t<IPáddress>\n");

2010 
TYPE_RR
:

2011 
	`¥ötf
("\t\t<Resource Record>\n");

2017 
	`¥ötf
("Unknow¿m©chÇame: %s\n", 
«me
);

2020 
mt
 = (
m©ch_èbÀ
 *Ë
m©ches
;

2021 
mt
->
«me
 !
NULL
) {

2022 
°r
 = (*Ë
mt
->
«me
;

2023 
	`¥ötf
("%s:", 
°r
);

2024 
i
 = 
	`°æí
(
°r
) + 1;

2025 
i
 < 24) {

2026 
	`¥ötf
(" ");

2027 
i
++;

2029 
	`¥ötf
("%s\n", 
mt
->
des¸ùti⁄
);

2030 
mt
++;

2033 
	}
}

2036 
	$h™dÀ_ëhî_∑ckë
(c⁄° 
u_ch¨
 *
d©a
, 
pˇp_pkthdr
 
cur_hdr
, 
m©ch_cou¡îs
 *
cou¡
, 
m©ch_ex¥essi⁄
 *
m©ch_ex¥
, m©ch_cou¡î†*
uniques
, 
m©ch_id
 
unique_ids
[], 
size_t
 
unique_id_cou¡
)

2038 
ëhî_hódî
 *
ïå
;

2039 
ù
 *
ùå
;

2040 
ù6_hdr
 *ip6_hdr;

2041 
ù_hdr_size
;

2042 
uöt8_t
 
¥Ÿocﬁ
;

2043 
size_t
 
d©a_off£t
 = 0;

2044 
ldns_rdf
 *
§c_addr
, *
d°_addr
;

2045 
uöt8_t
 *
≠
;

2046 *
a°r
;

2047 
bpf_u_öt32
 
Àn
 = 
cur_hdr
.
ˇ∂í
;

2048 
timevÆ
 
time°amp
;

2049 
uöt16_t
 
ù_Êags
;

2050 
uöt16_t
 
ù_Àn
;

2051 
uöt16_t
 
ù_id
;

2052 
uöt16_t
 
ù_f_off£t
;

2053 c⁄° 
u_ch¨
 *
√wd©a
 = 
NULL
;

2058 
uöt8_t
 *
dn•kt
;

2060 
ldns_pkt
 *
pkt
;

2061 
ldns_°©us
 
°©us
;

2064 
ïå
 = (
ëhî_hódî
 *Ë
d©a
;

2066 i‡(
	`¡ohs
 (
ïå
->
ëhî_ty≥
Ë=
ETHERTYPE_IP
)

2068 i‡(
vîbosôy
 >= 5) {

2069 
	`¥ötf
("EthernetÅype hex:%x dec:%u isán IPÖacket\n",

2070 (Ë
	`¡ohs
(
ïå
->
ëhî_ty≥
),

2071 (Ë
	`¡ohs
(
ïå
->
ëhî_ty≥
));

2074 
d©a_off£t
 = 
ETHER_HEADER_LENGTH
;

2075 
ùå
 = (
ù
 *Ë(
d©a
 + 
d©a_off£t
);

2079 
ù_Êags
 = 
	`ldns_ªad_uöt16
(&(
ùå
->
ù_off
));

2080 
ù_id
 = 
	`ldns_ªad_uöt16
(&(
ùå
->ip_id));

2081 
ù_Àn
 = 
	`ldns_ªad_uöt16
(&(
ùå
->ip_len));

2082 
ù_f_off£t
 = (
ù_Êags
 & 
IP_OFFMASK
)*8;

2083 i‡(
ù_Êags
 & 
IP_MF
 && 
ù_f_off£t
 == 0) {

2085 
‰agmít_p
->
ù_id
 = ip_id;

2086 
	`mem£t
(
‰agmít_p
->
d©a
, 0, 65535);

2087 
	`mem˝y
(
‰agmít_p
->
d©a
, 
ùå
, 
ù_Àn
);

2088 
‰agmít_p
->
cur_Àn
 = 
ù_Àn
 + 20;

2100 i‡(
ù_Êags
 & 
IP_MF
 && 
ù_f_off£t
 != 0) {

2102 i‡(
ù_id
 =
‰agmít_p
->ip_id) {

2104 
	`mem˝y
(
‰agmít_p
->
d©a
 + (
ù_f_off£t
Ë+ 20, d©a+
d©a_off£t
+20, 
ù_Àn
 - (
ùå
->
ù_hl
)*4);

2106 
‰agmít_p
->
cur_Àn
 = føgmít_p->cur_À¿+ 
ù_Àn
 - 20;

2120 
lo°_∑ckë_‰agmíts
++;

2124 i‡(!(
ù_Êags
 & 
IP_MF
Ë&& 
ù_f_off£t
 != 0) {

2126 i‡(
ù_id
 =
‰agmít_p
->ip_id) {

2128 
	`mem˝y
(
‰agmít_p
->
d©a
 + 
ù_f_off£t
 + 20, d©a+
d©a_off£t
+20, 
ù_Àn
 - 20);

2129 
‰agmít_p
->
cur_Àn
 = føgmít_p->cur_À¿+ 
ù_Àn
 - 20;

2130 
ùå
 = (
ù
 *Ë
‰agmít_p
->
d©a
;

2131 
√wd©a
 = 
	`mÆloc
(
‰agmít_p
->
cur_Àn
 + 
d©a_off£t
);

2132 i‡(!
√wd©a
) {

2133 
	`¥ötf
("Malloc failed, out of mem?\n");

2134 
	`exô
(4);

2136 
	`mem˝y
((*Ë
√wd©a
, 
d©a
, 
d©a_off£t
);

2137 
	`mem˝y
((*Ë
√wd©a
+
d©a_off£t
, 
‰agmít_p
->
d©a
, føgmít_p->
cur_Àn
);

2138 
ùå
->
ù_Àn
 = (
u_sh‹t
Ë
	`ldns_ªad_uöt16
(&(
‰agmít_p
->
cur_Àn
));

2139 
ùå
->
ù_off
 = 0;

2140 
Àn
 = (
bpf_u_öt32
Ë
‰agmít_p
->
cur_Àn
;

2141 
cur_hdr
.
ˇ∂í
 = 
Àn
;

2142 
‰agmít_p
->
ù_id
 = 0;

2143 
‰agmíãd_∑ckës
++;

2155 
lo°_∑ckë_‰agmíts
++;

2159 
√wd©a
 = 
d©a
;

2169 
≠
 = (
uöt8_t
 *Ë&(
ùå
->
ù_§c
);

2170 
a°r
 = 
	`mÆloc
(
INET_ADDRSTRLEN
);

2171 i‡(
	`öë_¡›
(
AF_INET
, 
≠
, 
a°r
, 
INET_ADDRSTRLEN
)) {

2172 i‡(
	`ldns_°r2rdf_a
(&
§c_addr
, 
a°r
Ë=
LDNS_STATUS_OK
) {

2175 
	`‰ì
(
a°r
);

2177 
≠
 = (
uöt8_t
 *Ë&(
ùå
->
ù_d°
);

2178 
a°r
 = 
	`mÆloc
(
INET_ADDRSTRLEN
);

2179 i‡(
	`öë_¡›
(
AF_INET
, 
≠
, 
a°r
, 
INET_ADDRSTRLEN
)) {

2180 i‡(
	`ldns_°r2rdf_a
(&
d°_addr
, 
a°r
Ë=
LDNS_STATUS_OK
) {

2183 
	`‰ì
(
a°r
);

2186 
ù_hdr_size
 = (Ë
ùå
->
ù_hl
 * 4;

2187 
¥Ÿocﬁ
 = (
uöt8_t
Ë
ùå
->
ù_p
;

2189 
d©a_off£t
 +
ù_hdr_size
;

2191 i‡(
¥Ÿocﬁ
 =
IPPROTO_UDP
) {

2192 
udp_∑ckës
++;

2193 
d©a_off£t
 +
UDP_HEADER_LENGTH
;

2195 
dn•kt
 = (
uöt8_t
 *Ë(
√wd©a
 + 
d©a_off£t
);

2201 
°©us
 = 
	`ldns_wúe2pkt
(&
pkt
, 
dn•kt
, 
Àn
 - 
d©a_off£t
);

2203 i‡(
°©us
 !
LDNS_STATUS_OK
) {

2204 i‡(
vîbosôy
 >= 3) {

2205 
	`¥ötf
("Nÿdn†∑ckë: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

2207 i‡(
vîbosôy
 >= 5) {

2208 
ù_Àn
 = 0; ip_À¿< 
Àn
 - 
d©a_off£t
; ip_len++) {

2209 i‡(
ù_Àn
 > 0 && ip_len % 20 == 0) {

2210 
	`¥ötf
("\t; %u - %u\n", (Ë
ù_Àn
 - 19, () ip_len);

2212 
	`¥ötf
("%02x ", (Ë
dn•kt
[
ù_Àn
]);

2214 
	`¥ötf
("\t; ??? - %u\n", (Ë
ù_Àn
);

2217 
bad_dns_∑ckës
++;

2218 i‡(
bad_dns_dump
) {

2219 
	`pˇp_dump
((
u_ch¨
 *)
bad_dns_dump
, &
cur_hdr
, 
√wd©a
);

2222 
time°amp
.
tv_£c
 = 
cur_hdr
.
ts
.tv_sec;

2223 
time°amp
.
tv_u£c
 = 
cur_hdr
.
ts
.tv_usec;

2224 
	`ldns_pkt_£t_time°amp
(
pkt
, 
time°amp
);

2226 i‡(
vîbosôy
 >= 4) {

2227 
	`¥ötf
("DNSÖacket\n");

2228 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

2229 
	`¥ötf
("\n\n");

2232 
tŸÆ_ƒ_of_dns_∑ckës
++;

2234 i‡(
m©ch_ex¥
) {

2235 i‡(
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
m©ch_ex¥
)) {

2237 i‡(
dum≥r
) {

2238 
	`pˇp_dump
((
u_ch¨
 *)
dum≥r
, &
cur_hdr
, 
d©a
);

2240 i‡(
hexdumpfûe
) {

2241 
	`Ârötf
(
hexdumpfûe
, ";; %u\n", (Ë
tŸÆ_ƒ_of_dns_∑ckës
);

2242 
	`ldns_pkt2fûe_hex
(
hexdumpfûe
, 
pkt
);

2244 i‡(
show_fûãr_m©ches
) {

2245 
	`¥ötf
(";; From: ");

2246 
	`ldns_rdf_¥öt
(
°dout
, 
§c_addr
);

2247 
	`¥ötf
("\n");

2248 
	`¥ötf
(";; To: ");

2249 
	`ldns_rdf_¥öt
(
°dout
, 
d°_addr
);

2250 
	`¥ötf
("\n");

2251 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

2252 
	`¥ötf
("------------------------------------------------------------\n\n");

2255 
	`ldns_pkt_‰ì
(
pkt
);

2256 
	`ldns_rdf_dìp_‰ì
(
§c_addr
);

2257 
	`ldns_rdf_dìp_‰ì
(
d°_addr
);

2261 i‡(
dum≥r
) {

2262 
	`pˇp_dump
((
u_ch¨
 *)
dum≥r
, &
cur_hdr
, 
d©a
);

2264 i‡(
hexdumpfûe
) {

2265 
	`Ârötf
(
hexdumpfûe
, ";; %u\n", (Ë
tŸÆ_ƒ_of_dns_∑ckës
);

2266 
	`ldns_pkt2fûe_hex
(
hexdumpfûe
, 
pkt
);

2268 i‡(
show_fûãr_m©ches
) {

2269 
	`¥ötf
(";; From: ");

2270 
	`ldns_rdf_¥öt
(
°dout
, 
§c_addr
);

2271 
	`¥ötf
("\n");

2272 
	`¥ötf
(";; To: ");

2273 
	`ldns_rdf_¥öt
(
°dout
, 
d°_addr
);

2274 
	`¥ötf
("\n");

2275 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

2276 
	`¥ötf
("------------------------------------------------------------\n\n");

2281 
tŸÆ_ƒ_of_fûãªd_∑ckës
++;

2283 
	`m©ch_pkt_cou¡îs
(
pkt
, 
§c_addr
, 
d°_addr
, 
cou¡
);

2284 
	`m©ch_pkt_uniques
(
pkt
, 
§c_addr
, 
d°_addr
, 
uniques
, 
unique_ids
, 
unique_id_cou¡
);

2286 
	`ldns_pkt_‰ì
(
pkt
);

2287 
pkt
 = 
NULL
;

2289 
	`ldns_rdf_dìp_‰ì
(
§c_addr
);

2290 
	`ldns_rdf_dìp_‰ì
(
d°_addr
);

2292 } i‡(
¥Ÿocﬁ
 =
IPPROTO_TCP
) {

2294 
t˝_∑ckës
++;

2297 } i‡(
	`¡ohs
 (
ïå
->
ëhî_ty≥
Ë=
ETHERTYPE_IPV6
) {

2303 
d©a_off£t
 = 
ETHER_HEADER_LENGTH
;

2304 
ù6_hdr
 = (ù6_hd∏*Ë(
d©a
 + 
d©a_off£t
);

2306 
√wd©a
 = 
d©a
;

2310 
≠
 = (
uöt8_t
 *Ë&(
ù6_hdr
->
ù6_§c
);

2311 
a°r
 = 
	`mÆloc
(
INET6_ADDRSTRLEN
);

2312 i‡(
	`öë_¡›
(
AF_INET6
, 
≠
, 
a°r
, 
INET6_ADDRSTRLEN
)) {

2313 i‡(
	`ldns_°r2rdf_ØØ
(&
§c_addr
, 
a°r
Ë=
LDNS_STATUS_OK
) {

2316 
	`‰ì
(
a°r
);

2318 
≠
 = (
uöt8_t
 *Ë&(
ù6_hdr
->
ù6_d°
);

2319 
a°r
 = 
	`mÆloc
(
INET6_ADDRSTRLEN
);

2320 i‡(
	`öë_¡›
(
AF_INET6
, 
≠
, 
a°r
, 
INET6_ADDRSTRLEN
)) {

2321 i‡(
	`ldns_°r2rdf_ØØ
(&
d°_addr
, 
a°r
Ë=
LDNS_STATUS_OK
) {

2324 
	`‰ì
(
a°r
);

2327 
ù_hdr_size
 = 
IP6_HEADER_LENGTH
;

2328 
¥Ÿocﬁ
 = (
uöt8_t
Ë
ù6_hdr
->
ù6_˘lun
.
ù6_un1
.
ù6_un1_nxt
;

2330 
d©a_off£t
 +
ù_hdr_size
;

2332 i‡(
¥Ÿocﬁ
 =
IPPROTO_UDP
) {

2333 
udp_∑ckës
++;

2335 
d©a_off£t
 +
UDP_HEADER_LENGTH
;

2337 
dn•kt
 = (
uöt8_t
 *Ë(
√wd©a
 + 
d©a_off£t
);

2341 
°©us
 = 
	`ldns_wúe2pkt
(&
pkt
, 
dn•kt
, 
Àn
 - 
d©a_off£t
);

2343 i‡(
°©us
 !
LDNS_STATUS_OK
) {

2344 i‡(
vîbosôy
 >= 3) {

2345 
	`¥ötf
("Nÿdn†∑ckë: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

2347 
bad_dns_∑ckës
++;

2348 i‡(
bad_dns_dump
) {

2349 
	`pˇp_dump
((
u_ch¨
 *)
bad_dns_dump
, &
cur_hdr
, 
√wd©a
);

2352 
time°amp
.
tv_£c
 = 
cur_hdr
.
ts
.tv_sec;

2353 
time°amp
.
tv_u£c
 = 
cur_hdr
.
ts
.tv_usec;

2354 
	`ldns_pkt_£t_time°amp
(
pkt
, 
time°amp
);

2356 i‡(
vîbosôy
 >= 4) {

2357 
	`¥ötf
("DNSÖacket\n");

2358 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

2359 
	`¥ötf
("\n\n");

2362 
tŸÆ_ƒ_of_dns_∑ckës
++;

2364 i‡(
m©ch_ex¥
) {

2365 i‡(
	`m©ch_dns_∑ckë_to_ex¥
(
pkt
, 
§c_addr
, 
d°_addr
, 
m©ch_ex¥
)) {

2367 i‡(
dum≥r
) {

2368 
	`pˇp_dump
((
u_ch¨
 *)
dum≥r
, &
cur_hdr
, 
d©a
);

2370 i‡(
show_fûãr_m©ches
) {

2371 
	`¥ötf
(";; From: ");

2372 
	`ldns_rdf_¥öt
(
°dout
, 
§c_addr
);

2373 
	`¥ötf
("\n");

2374 
	`¥ötf
(";; To: ");

2375 
	`ldns_rdf_¥öt
(
°dout
, 
d°_addr
);

2376 
	`¥ötf
("\n");

2377 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

2378 
	`¥ötf
("------------------------------------------------------------\n\n");

2381 
	`ldns_pkt_‰ì
(
pkt
);

2382 
	`ldns_rdf_dìp_‰ì
(
§c_addr
);

2383 
	`ldns_rdf_dìp_‰ì
(
d°_addr
);

2387 i‡(
show_fûãr_m©ches
) {

2388 
	`¥ötf
(";; From: ");

2389 
	`ldns_rdf_¥öt
(
°dout
, 
§c_addr
);

2390 
	`¥ötf
("\n");

2391 
	`¥ötf
(";; To: ");

2392 
	`ldns_rdf_¥öt
(
°dout
, 
d°_addr
);

2393 
	`¥ötf
("\n");

2394 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

2395 
	`¥ötf
("------------------------------------------------------------\n\n");

2400 
tŸÆ_ƒ_of_fûãªd_∑ckës
++;

2402 
	`m©ch_pkt_cou¡îs
(
pkt
, 
§c_addr
, 
d°_addr
, 
cou¡
);

2403 
	`m©ch_pkt_uniques
(
pkt
, 
§c_addr
, 
d°_addr
, 
uniques
, 
unique_ids
, 
unique_id_cou¡
);

2405 
	`ldns_pkt_‰ì
(
pkt
);

2406 
pkt
 = 
NULL
;

2408 
	`ldns_rdf_dìp_‰ì
(
§c_addr
);

2409 
	`ldns_rdf_dìp_‰ì
(
d°_addr
);

2411 } i‡(
¥Ÿocﬁ
 =
IPPROTO_TCP
) {

2413 
t˝_∑ckës
++;

2415 
	`¥ötf
("ùv6 unknow¿√xàhódîÅy≥: %u\n", (Ë
¥Ÿocﬁ
);

2420 } i‡(
	`¡ohs
 (
ïå
->
ëhî_ty≥
Ë=
ETHERTYPE_ARP
) {

2421 i‡(
vîbosôy
 >= 5) {

2422 
	`¥ötf
("EthernetÅype hex:%x dec:%u isán ARPÖacket\n",

2423 (Ë
	`¡ohs
(
ïå
->
ëhî_ty≥
),

2424 (Ë
	`¡ohs
(
ïå
->
ëhî_ty≥
));

2426 
¨p_∑ckës
++;

2428 
	`¥ötf
("Ethî√àty≥ %xÇŸ IP\n", (Ë
	`¡ohs
(
ïå
->
ëhî_ty≥
));

2429 i‡(
vîbosôy
 >= 5) {

2430 
	`¥ötf
("Ethî√àty≥ %xÇŸ IP\n", (Ë
	`¡ohs
(
ïå
->
ëhî_ty≥
));

2432 
nŸ_ù_∑ckës
++;

2433 i‡(
nŸ_ù_dump
) {

2434 
	`pˇp_dump
((
u_ch¨
 *)
nŸ_ù_dump
, &
cur_hdr
, 
d©a
);

2439 
	}
}

2441 
boﬁ


2442 
	$∑r£_m©ch_li°
(
m©ch_cou¡îs
 *
cou¡îs
, *
°rög
)

2444 
size_t
 
i
;

2445 
m©ch_ex¥essi⁄
 *
ex¥
;

2447 
size_t
 
œ°pos
 = 0;

2448 *
sub°rög
;

2452 
i
 = 0; i < 
	`°æí
(
°rög
); i++) {

2453 i‡(
°rög
[
i
] == ',') {

2454 i‡(
i
<2) {

2455 
	`Ârötf
(
°dîr
, "Matchlist cannot start with ,\n");

2456  
Ál£
;

2458 
sub°rög
 = 
	`mÆloc
(
	`°æí
(
°rög
)+1);

2459 
	`°∫˝y
(
sub°rög
, &
°rög
[
œ°pos
], 
i
 -Üastpos + 1);

2460 
sub°rög
[
i
 - 
œ°pos
] = '\0';

2461 
ex¥
 = 
	`∑r£_m©ch_ex¥essi⁄
(
sub°rög
);

2462 i‡(!
ex¥
) {

2463  
Ál£
;

2465 
	`‰ì
(
sub°rög
);

2472 
	`add_m©ch_cou¡î
(
cou¡îs
, 
ex¥
, 
Ál£
);

2473 
œ°pos
 = 
i
+1;

2477 
sub°rög
 = 
	`mÆloc
(
	`°æí
(
°rög
) + 1);

2478 
	`°∫˝y
(
sub°rög
, &
°rög
[
œ°pos
], 
i
 -Üastpos + 1);

2479 
sub°rög
[
i
 - 
œ°pos
] = '\0';

2480 
ex¥
 = 
	`∑r£_m©ch_ex¥essi⁄
(
sub°rög
);

2482 i‡(!
ex¥
) {

2483 
	`Ârötf
(
°dîr
, "Bad m©ch: %s\n", 
sub°rög
);

2484  
Ál£
;

2486 
	`‰ì
(
sub°rög
);

2493 
	`add_m©ch_cou¡î
(
cou¡îs
, 
ex¥
, 
Ál£
);

2494  
åue
;

2495 
	}
}

2497 
boﬁ


2498 
	$∑r£_uniques
(
m©ch_id
 
ids
[], 
size_t
 *
cou¡
, *
°rög
)

2500 
size_t
 
i
, 
j
, 
œ°pos
;

2501 *
°r
, *
°Ω¨t
;

2502 
m©ch_èbÀ
 *
mt
;

2505 
°r
 = 
	`mÆloc
(
	`°æí
(
°rög
) + 1);

2506 
j
 = 0;

2507 
i
 = 0; i < 
	`°æí
(
°rög
); i++) {

2508 i‡(!
	`is•a˚
(
°rög
[
i
])) {

2509 
°r
[
j
] = 
°rög
[
i
];

2510 
j
++;

2513 
°r
[
j
] = '\0';

2515 
œ°pos
 = 0;

2516 
i
 = 0; i <
	`°æí
(
°r
); i++) {

2517 i‡(
°r
[
i
] =',' || i >
	`°æí
(str)) {

2518 
°Ω¨t
 = 
	`mÆloc
(
i
 - 
œ°pos
 + 1);

2519 
	`°∫˝y
(
°Ω¨t
, &
°r
[
œ°pos
], 
i
 -Üastpos);

2520 
°Ω¨t
[
i
 - 
œ°pos
] = '\0';

2521 i‡((
mt
 = 
	`gë_m©ch_by_«me
(
°Ω¨t
))) {

2522 
ids
[*
cou¡
] = 
mt
->
id
;

2523 *
cou¡
 = *count + 1;

2525 
	`¥ötf
("Eº‹Ö¨sög m©chÜi°; unknow¿m©chÇame: %s\n", 
°Ω¨t
);

2526  
Ál£
;

2528 
	`‰ì
(
°Ω¨t
);

2529 
œ°pos
 = 
i
 + 1;

2532 i‡(
i
 > 
œ°pos
) {

2533 
°Ω¨t
 = 
	`mÆloc
(
i
 - 
œ°pos
 + 1);

2534 
	`°∫˝y
(
°Ω¨t
, &
°r
[
œ°pos
], 
i
 -Üastpos);

2535 
°Ω¨t
[
i
 - 
œ°pos
] = '\0';

2536 i‡((
mt
 = 
	`gë_m©ch_by_«me
(
°Ω¨t
))) {

2537 
ids
[*
cou¡
] = 
mt
->
id
;

2538 *
cou¡
 = *count + 1;

2540 
	`¥ötf
("Eº‹Ö¨sög m©chÜi°; unknow¿m©chÇame: %s\n", 
°Ω¨t
);

2541  
Ál£
;

2543 
	`‰ì
(
°Ω¨t
);

2544 
œ°pos
 = 
i
 + 1;

2546 
	`‰ì
(
°r
);

2547  
åue
;

2548 
	}
}

2550 
	$maö
(
¨gc
, *
¨gv
[]) {

2552 
i
;

2553 
°©us
 = 
EXIT_SUCCESS
;

2554 
m©ch_cou¡îs
 *
cou¡
 = 
	`mÆloc
((match_counters));

2555 c⁄° *
öputfûe
 = 
NULL
;

2556 
îrbuf
[
PCAP_ERRBUF_SIZE
];

2557 
pˇp_t
 *
pc
 = 
NULL
;

2558 c⁄° 
u_ch¨
 *
cur
;

2559 
pˇp_pkthdr
 
cur_hdr
;

2560 
m©ch_ex¥essi⁄
 *
ex¥
 = 
NULL
;

2561 
m©ch_id
 
unique_ids
[
MAX_MATCHES
];

2562 
size_t
 
unique_id_cou¡
 = 0;

2563 
m©ch_cou¡îs
 *
uniques
 = 
	`mÆloc
((match_counters));

2564 *
dumpfûe
 = 
NULL
;

2565 *
hexdumpfûíame
 = 
NULL
;

2566 *
nŸ_ù_dumpfûe
 = 
NULL
;

2567 *
bad_dns_dumpfûe
 = 
NULL
;

2569 
boﬁ
 
show_≥r˚¡ages
 = 
Ál£
;

2570 
boﬁ
 
show_avîages
 = 
Ál£
;

2571 
boﬁ
 
show_avîage_cou¡
 = 
Ál£
;

2572 
unique_möimum
 = 0;

2574 
cou¡
->
À·
 = 
NULL
;

2575 
cou¡
->
m©ch
 = 
NULL
;

2576 
cou¡
->
right
 = 
NULL
;

2577 
uniques
->
À·
 = 
NULL
;

2578 
uniques
->
m©ch
 = 
NULL
;

2579 
uniques
->
right
 = 
NULL
;

2581 
‰agmít_p
 = 
	`mÆloc
((
‰agmít_∑π
));

2582 
‰agmít_p
->
ù_id
 = 0;

2583 
‰agmít_p
->
cur_Àn
 = 0;

2585 
i
 = 1; i < 
¨gc
; i++) {

2587 i‡(
	`°∫cmp
(
¨gv
[
i
], "-baddns", 8) == 0) {

2588 i‡(
i
 + 1 < 
¨gc
) {

2589 
bad_dns_dumpfûe
 = 
¨gv
[
i
 + 1];

2590 
i
++;

2592 
	`ußge
(
°dîr
);

2593 
°©us
 = 
EXIT_FAILURE
;

2594 
exô
;

2596 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-notip", 7) == 0) {

2597 i‡(
i
 + 1 < 
¨gc
) {

2598 
nŸ_ù_dumpfûe
 = 
¨gv
[
i
 + 1];

2599 
i
++;

2601 
	`ußge
(
°dîr
);

2602 
°©us
 = 
EXIT_FAILURE
;

2603 
exô
;

2605 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-c", 3) == 0) {

2606 i‡(
i
 + 1 < 
¨gc
) {

2607 i‡(!
	`∑r£_m©ch_li°
(
cou¡
, 
¨gv
[
i
 + 1])) {

2608 
°©us
 = 
EXIT_FAILURE
;

2609 
exô
;

2611 
i
++;

2613 
	`ußge
(
°dîr
);

2614 
°©us
 = 
EXIT_FAILURE
;

2615 
exô
;

2617 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-f", 3) == 0) {

2618 i‡(
i
 + 1 < 
¨gc
) {

2619 i‡(
ex¥
 || 
	`°rchr
(
¨gv
[
i
+1], ',')) {

2620 
	`Ârötf
(
°dîr
, "You can only specify 1 filterÉxpression.\n");

2621 
°©us
 = 
EXIT_FAILURE
;

2622 
exô
;

2624 
ex¥
 = 
	`∑r£_m©ch_ex¥essi⁄
(
¨gv
[
i
 + 1]);

2625 
i
++;

2627 
	`ußge
(
°dîr
);

2628 
°©us
 = 
EXIT_FAILURE
;

2629 
exô
;

2631 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-h", 3) == 0) {

2632 
	`ußge
(
°dout
);

2633 
°©us
 = 
EXIT_SUCCESS
;

2634 
exô
;

2635 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-p", 3) == 0) {

2636 
show_≥r˚¡ages
 = 
åue
;

2637 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-of", 4) == 0) {

2638 i‡(
i
 + 1 < 
¨gc
) {

2639 
dumpfûe
 = 
¨gv
[
i
 + 1];

2640 
i
++;

2642 
	`ußge
(
°dîr
);

2643 
°©us
 = 
EXIT_FAILURE
;

2644 
exô
;

2646 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-ofh", 5) == 0) {

2647 i‡(
i
 + 1 < 
¨gc
) {

2648 
hexdumpfûíame
 = 
¨gv
[
i
 + 1];

2649 
i
++;

2651 
	`ußge
(
°dîr
);

2652 
°©us
 = 
EXIT_FAILURE
;

2653 
exô
;

2655 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-s", 3) == 0) {

2656 i‡(
i
 + 1 < 
¨gc
) {

2657 
	`show_m©ch_«mes
(
¨gv
[
i
 + 1]);

2659 
	`show_m©ch_«mes
(
NULL
);

2661 
°©us
 = 
EXIT_SUCCESS
;

2662 
exô
;

2663 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-sf", 4) == 0) {

2664 
show_fûãr_m©ches
 = 
åue
;

2665 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-u", 3) == 0) {

2666 i‡(
i
 + 1 < 
¨gc
) {

2667 i‡(!
	`∑r£_uniques
(
unique_ids
, &
unique_id_cou¡
, 
¨gv
[
i
 + 1])) {

2668 
°©us
 = 
EXIT_FAILURE
;

2669 
exô
;

2671 
i
++;

2673 
	`ußge
(
°dîr
);

2674 
°©us
 = 
EXIT_FAILURE
;

2675 
exô
;

2677 } i‡(
	`°rcmp
("-ua", 
¨gv
[
i
]) == 0) {

2678 
show_avîages
 = 
åue
;

2679 } i‡(
	`°rcmp
("-uac", 
¨gv
[
i
]) == 0) {

2680 
show_avîage_cou¡
 = 
åue
;

2681 } i‡(
	`°rcmp
("-um", 
¨gv
[
i
]) == 0) {

2682 i‡(
i
 + 1 < 
¨gc
) {

2683 
unique_möimum
 = 
	`©oi
(
¨gv
[
i
+1]);

2684 
i
++;

2686 
	`Ârötf
(
°dîr
, "-umÑequiresánárgument");

2687 
	`ußge
(
°dîr
);

2688 
°©us
 = 
EXIT_FAILURE
;

2689 
exô
;

2691 } i‡(
	`°rcmp
("-v", 
¨gv
[
i
]) == 0) {

2692 
i
++;

2693 i‡(
i
 < 
¨gc
) {

2694 
vîbosôy
 = 
	`©oi
(
¨gv
[
i
]);

2696 } i‡(
	`°rcmp
("-vîsi⁄", 
¨gv
[
i
]) == 0) {

2697 
	`¥ötf
("dn†∑ckëá«lyzî, vîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

2698 
exô
;

2700 i‡(
öputfûe
) {

2701 
	`Ârötf
(
°dîr
, "You can only specify 1 input file\n");

2702 
	`exô
(1);

2704 
öputfûe
 = 
¨gv
[
i
];

2708 i‡(!
öputfûe
) {

2709 
öputfûe
 = "-";

2712 i‡(
vîbosôy
 >= 5) {

2713 
	`¥ötf
("Filter:\n");

2714 
	`¥öt_m©ch_ex¥essi⁄
(
°dout
, 
ex¥
);

2715 
	`¥ötf
("\n\n");

2718 
pc
 = 
	`pˇp_›í_ofÊöe
(
öputfûe
, 
îrbuf
);

2720 i‡(!
pc
) {

2721 i‡(
î∫o
 != 0) {

2722 
	`¥ötf
("Eº‹ o≥nögÖˇ∞fûê%s: %s\n", 
öputfûe
, 
îrbuf
);

2723 
	`exô
(1);

2725 
showªsu…
;

2729 i‡(
dumpfûe
) {

2730 
dum≥r
 = 
	`pˇp_dump_›í
(
pc
, 
dumpfûe
);

2732 i‡(!
dum≥r
) {

2733 
	`¥ötf
("Eº‹ o≥nögÖˇ∞dum∞fûê%s: %s\n", 
dumpfûe
, 
îrbuf
);

2734 
	`exô
(1);

2738 i‡(
hexdumpfûíame
) {

2739 i‡(
	`°∫cmp
(
hexdumpfûíame
, "-", 2) != 0) {

2740 
	`¥ötf
("hexdump is file\n");

2741 
hexdumpfûe
 = 
	`f›í
(
hexdumpfûíame
, "w");

2743 
	`¥ötf
("hexdump is stdout\n");

2744 
hexdumpfûe
 = 
°dout
;

2747 i‡(!
hexdumpfûe
) {

2748 
	`¥ötf
("Eº‹ o≥nög hex dum∞fûê%s: %s\n", 
hexdumpfûíame
, 
	`°ªº‹
(
î∫o
));

2749 
	`exô
(1);

2753 i‡(
nŸ_ù_dumpfûe
) {

2754 
nŸ_ù_dump
 = 
	`pˇp_dump_›í
(
pc
, 
nŸ_ù_dumpfûe
);

2755 i‡(!
nŸ_ù_dump
) {

2756 
	`¥ötf
("Eº‹ o≥nögÖˇ∞dum∞fûêNOT_IP: %s\n", 
îrbuf
);

2759 i‡(
bad_dns_dumpfûe
) {

2760 
bad_dns_dump
 = 
	`pˇp_dump_›í
(
pc
, 
bad_dns_dumpfûe
);

2761 i‡(!
bad_dns_dump
) {

2762 
	`¥ötf
("Eº‹ o≥nögÖˇ∞dum∞fûêNOT_IP: %s\n", 
îrbuf
);

2766 (
cur
 = 
	`pˇp_√xt
(
pc
, &
cur_hdr
))) {

2767 i‡(
vîbosôy
 >= 5) {

2768 
	`¥ötf
("\n\n\n[PKT_HDR] c≠Àn: %u \éí: %u\n", ()
cur_hdr
.
ˇ∂í
, ()cur_hdr.
Àn
);

2770 
	`h™dÀ_ëhî_∑ckë
(
cur
, 
cur_hdr
, 
cou¡
, 
ex¥
, 
uniques
, 
unique_ids
, 
unique_id_cou¡
);

2773 i‡(
nŸ_ù_dump
) {

2774 
	`pˇp_dump_˛o£
(
nŸ_ù_dump
);

2777 i‡(
bad_dns_dump
) {

2778 
	`pˇp_dump_˛o£
(
bad_dns_dump
);

2781 i‡(
dum≥r
) {

2782 
	`pˇp_dump_˛o£
(
dum≥r
);

2785 i‡(
hexdumpfûe
 && hexdumpfûê!
°dout
) {

2786 
	`f˛o£
(
hexdumpfûe
);

2789 
	`pˇp_˛o£
(
pc
);

2791 
showªsu…
:

2792 i‡(
show_≥r˚¡ages
) {

2793 
	`Ârötf
(
°dout
, "Packë†th©áªÇŸ IP: %u\n", (Ë
nŸ_ù_∑ckës
);

2794 
	`Ârötf
(
°dout
, "bad dn†∑ckës: %u\n", (Ë
bad_dns_∑ckës
);

2795 
	`Ârötf
(
°dout
, "¨∞∑ckës: %u\n", (Ë
¨p_∑ckës
);

2796 
	`Ârötf
(
°dout
, "ud∞∑ckës: %u\n", (Ë
udp_∑ckës
);

2797 
	`Ârötf
(
°dout
, "t˝Öackë†(skù≥d): %u\n", (Ë
t˝_∑ckës
);

2798 
	`Ârötf
(
°dout
, "ªas£mbÀd føgmíãdÖackës: %u\n", (Ë
‰agmíãd_∑ckës
);

2799 
	`Ârötf
(
°dout
, "∑ckë føgmít†lo°: %u\n", (Ë
lo°_∑ckë_‰agmíts
);

2800 
	`Ârötf
(
°dout
, "TŸÆÇumbî o‡DNSÖackës: %u\n", (Ë
tŸÆ_ƒ_of_dns_∑ckës
);

2801 
	`Ârötf
(
°dout
, "TŸÆÇumbî o‡DNSÖackë†a·î fûãr: %u\n", (Ë
tŸÆ_ƒ_of_fûãªd_∑ckës
);

2803 i‡(
cou¡
->
m©ch
) {

2804 
	`¥öt_cou¡îs
(
°dout
, 
cou¡
, 
show_≥r˚¡ages
, 
tŸÆ_ƒ_of_fûãªd_∑ckës
, 0);

2806 i‡(
uniques
->
m©ch
) {

2807 
	`¥öt_cou¡îs
(
°dout
, 
uniques
, 
show_≥r˚¡ages
, 
tŸÆ_ƒ_of_fûãªd_∑ckës
, 
unique_möimum
);

2808 i‡(
show_avîages
) {

2809 
	`¥öt_cou¡î_avîages
(
°dout
, 
uniques
, 
NULL
);

2811 i‡(
show_avîage_cou¡
) {

2812 
	`¥öt_cou¡î_avîage_cou¡
(
°dout
, 
uniques
, 
NULL
, 
åue
);

2816 
exô
:

2818 
	`‰ì_m©ch_ex¥essi⁄
(
ex¥
);

2819 
	`‰ì_cou¡îs
(
cou¡
);

2820 
	`‰ì_cou¡îs
(
uniques
);

2822  
°©us
;

2823 
	}
}

2826 
	$maö
() {

2827 
	`Ârötf
(
°dîr
, "ldns-dpa wasÇot built becauseÅhere isÇoÖcapÜibrary onÅhis system, orÅhere wasÇoÖcap header fileát compilationÅime. Please installÖcapándÑebuild.\n");

2829 
	}
}

2832 
	$maö
() {

2833 
	`Ârötf
(
°dîr
, "ldns-dpa wasÇot built becauseÅhere isÇoÖcapÜibrary onÅhis system, orÅhere wasÇoÖcap header fileát compilationÅime. Please installÖcapándÑebuild.\n");

2835 
	}
}

	@examples/ldns-dpa.h

1 
	~<°dio.h
>

2 
	~<°rög.h
>

3 
	~<uni°d.h
>

4 
	~<as£π.h
>

6 #i‡
STDC_HEADERS


7 
	~<°dlib.h
>

8 
	~<°ddef.h
>

11 #ifde‡
HAVE_STDINT_H


12 
	~<°döt.h
>

15 #ifde‡
HAVE_SYS_SOCKET_H


16 
	~<sys/sockë.h
>

19 #ifde‡
HAVE_NETINET_IN_H


20 
	~<√töë/ö.h
>

23 #ifde‡
HAVE_ARPA_INET_H


24 
	~<¨∑/öë.h
>

27 #ifde‡
HAVE_NETINET_UDP_H


28 
	~<√töë/udp.h
>

31 #ifde‡
HAVE_TIME_H


32 
	~<time.h
>

35 #ifde‡
HAVE_PCAP_H


36 
	~<pˇp.h
>

39 #ifde‡
HAVE_NETINET_IN_SYSTM_H


40 
	~<√töë/ö_sy°m.h
>

43 #ifde‡
HAVE_NETINET_IP_H


44 
	~<√töë/ù.h
>

47 #ifde‡
HAVE_NET_IF_H


48 
	~<√t/if.h
>

51 #ifde‡
HAVE_NETINET_IF_ETHER_H


52 
	~<√töë/if_ëhî.h
>

55 #ifde‡
HAVE_WINSOCK2_H


56 
	#USE_WINSOCK
 1

	)

57 
	~<wösock2.h
>

60 #ifde‡
HAVE_WS2TCPIP_H


61 
	~<ws2t˝ù.h
>

64 #i‚de‡
HAVE_GETADDRINFO


65 
	~<Áke-rfc2553.h
>

68 #i‚de‡
HAVE_RANDOM


70 
	#øndom
 
ønd


	)

73 #i‚de‡
HAVE_SRANDOM


75 
	#§™dom
 
§™d


	)

78 *
›èrg
;

79 
›töd
, 
›ãº
;

81 #i‚de‡
EXIT_FAILURE


82 
	#EXIT_FAILURE
 1

	)

84 #i‚de‡
EXIT_SUCCESS


85 
	#EXIT_SUCCESS
 0

	)

88 #ifde‡
S_SPLINT_S


89 
	#FD_ZERO
(
a
Ë

	)

90 
	#FD_SET
(
a
,
b
Ë

	)

	@examples/ldns-gen-zone.c

11 
	~"c⁄fig.h
"

12 
	~<uni°d.h
>

13 
	~<°dlib.h
>

14 
	~<ldns/ldns.h
>

15 
	~<î∫o.h
>

17 
	#NUM_DS
 4

	)

18 
	#ALGO
 8

	)

19 
	#DIGESTTYPE
 2

	)

27 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

28 
	`Ârötf
(
Â
, "\n\nUßge: %†[-hsv] [-≠ NUM] [-ÿORIGIN] [<z⁄efûe>]\n", 
¥og
);

29 
	`Ârötf
(
Â
, "\tReadsá zonefileándádd someártificial NS RRsetsánd DSÑecords.\n");

30 
	`Ârötf
(
Â
, "\tIfÇo zonefile is given,Åhe zone isÑead from stdin.\n");

31 
	`Ârötf
(
Â
, "\t-a <NUM>ádd NUMártifical delegations (NS RRSets)Åo output.\n");

32 
	`Ârötf
(
Â
, "\t-∞<NUM>ádd NUMÖî˚¡ o‡DS RR£t'†tÿthêNS RR£t†(1-%d RR'†≥∏DS RR£t).\n", 
NUM_DS
);

33 
	`Ârötf
(
Â
, "\t-o ORIGIN setsán $ORIGIN, which can be handy ifÅhe one inÅhe zonefile is setÅo @.\n");

34 
	`Ârötf
(
Â
, "\t-s if input zone file isálready sortedánd canonicalized (ieállÜowercase),\n\t useÅhis optionÅo speedÅhings up while inserting DSÑecords.\n");

35 
	`Ârötf
(
Â
, "\t-h showÅhisÅext.\n");

36 
	`Ârötf
(
Â
, "\t-v showsÅhe versionándÉxits.\n");

37 
	`Ârötf
(
Â
, "\nifÇo file is given standard input isÑead.\n\n");

38 
	}
}

45 
	$ö£π_ds
(
ldns_rdf
 *
dsow√r
, 
uöt32_t
 
âl
)

47 
d
, 
d§™d
;

48 
keyèg
 = 0;

49 *
dsow√r°r
;

50 
dige°°r
[70];

55 
d§™d
 = 1+
	`ønd
(Ë% 
NUM_DS
;

56 
d
 = 0; d < 
d§™d
; d++) {

57 
keyèg
 = 1+
	`ønd
() % 65535;

64 
	`¢¥ötf
(
dige°°r
, 65,

66 (Ë
	`ønd
()%
RAND_MAX
, ()Ñand()%RAND_MAX, ()Ñand()%RAND_MAX,

67 (Ë
	`ønd
()%
RAND_MAX
, ()Ñand()%RAND_MAX, ()Ñand()%RAND_MAX,

68 (Ë
	`ønd
()%
RAND_MAX
, ()Ñand()%RAND_MAX, ()Ñand()%RAND_MAX,

69 (Ë
	`ønd
()%
RAND_MAX
, ()Ñand()%RAND_MAX, ()Ñand()%RAND_MAX,

70 (Ë
	`ønd
()%
RAND_MAX
, ()Ñand()%RAND_MAX, ()Ñand()%RAND_MAX,

71 (Ë
	`ønd
()%
RAND_MAX
);

72 
dsow√r°r
 = 
	`ldns_rdf2°r
(
dsow√r
);

73 
	`Ârötf
(
°dout
, "%s\t%u\tIN\tDS\t%d %d %d %s\n", 
dsow√r°r
, (Ë
âl
, 
keyèg
, 
ALGO
, 
DIGESTTYPE
, 
dige°°r
);

75  
d§™d
;

76 
	}
}

79 
	$maö
(
¨gc
, **
¨gv
) {

80 *
fûíame
, *
º°r
, *
ow√r°r
;

81 c⁄° *
˛as°y≥°r1
 = "IN NSÇs1.example.com.";

82 c⁄° *
˛as°y≥°r2
 = "IN NSÇs2.example.com.";

83 c⁄° 
size_t
 
˛as°y≥Àn
 = 
	`°æí
(
˛as°y≥°r1
);

85 c⁄° *
puny°r
 = "xn--fake-rr";

86 c⁄° 
size_t
 
punyÀn
 = 
	`°æí
(
puny°r
);

87 
size_t
 
º°æí
, 
ow√æí
;

88 
FILE
 *
Â
;

89 
c
, 
n§™d
;

90 
uöt32_t
 
âl
;

91 
cou¡a
,
cou¡d
,
cou¡r
;

92 
ldns_z⁄e
 *
z
;

93 
ldns_rdf
 *
‹igö
 = 
NULL
;

94 
löe_ƒ
 = 0;

95 
addºs
 = 0;

96 
d•îc
 = 0;

97 
boﬁ
 
ˇn⁄iˇlize
 = 
åue
;

98 
boﬁ
 
s‹t
 = 
åue
;

99 
boﬁ
 
do_ds
 = 
Ál£
;

100 
ldns_°©us
 
s
;

101 
size_t
 
i
;

102 
ldns_º_li°
 *
º£t_li°
;

103 
ldns_rdf
 *
ow√r
;

104 
ldns_º_ty≥
 
cur_º_ty≥
;

105 
ldns_º
 *
cur_º
;

106 
ldns_°©us
 
°©us
;

108 
cou¡a
 = 
cou¡d
 = 
cou¡r
 = 0;

113 
	`§™d
(()
	`time
(
NULL
));

118 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "a:p:shvo:")) != -1) {

119 
c
) {

121 
addºs
 = 
	`©oi
(
›èrg
);

122 i‡(
addºs
 <= 0) {

123 
	`Ârötf
(
°dîr
, "error\n");

124 
	`exô
(
EXIT_FAILURE
);

128 
‹igö
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
›èrg
);

129 i‡(!
‹igö
) {

130 
	`Ârötf
(
°dîr
, "îr‹: cª©ög origö from -ÿ%†Áûed.\n", 
›èrg
);

131 
	`exô
(
EXIT_FAILURE
);

135 
d•îc
 = 
	`©oi
(
›èrg
);

136 i‡(
d•îc
 < 0 || dsperc > 100) {

137 
	`Ârötf
(
°dîr
, "error:Öercentage of signed delegations must be between [0-100].\n");

138 
	`exô
(
EXIT_FAILURE
);

140 
do_ds
 = 
åue
;

143 
s‹t
 = 
Ál£
;

144 
ˇn⁄iˇlize
 = 
Ál£
;

147 
	`ußge
(
°dout
, 
¨gv
[0]);

148 
	`exô
(
EXIT_SUCCESS
);

150 
	`Ârötf
(
°dout
, "ldns-gí-z⁄êvîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

151 
	`exô
(
EXIT_SUCCESS
);

153 
	`Ârötf
(
°dîr
, "\nTry -h for more information.\n\n");

154 
	`exô
(
EXIT_FAILURE
);

157 
¨gc
 -
›töd
;

158 
¨gv
 +
›töd
;

163 i‡(
¨gc
 == 0) {

164 
Â
 = 
°dö
;

166 
fûíame
 = 
¨gv
[0];

167 
Â
 = 
	`f›í
(
fûíame
, "r");

168 i‡(!
Â
) {

169 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
fûíame
, 
	`°ªº‹
 (
î∫o
));

170 
	`exô
(
EXIT_FAILURE
);

173 
s
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z
, 
Â
, 
‹igö
, 0, 
LDNS_RR_CLASS_IN
, &
löe_ƒ
);

174 i‡(
s
 !
LDNS_STATUS_OK
) {

175 
	`Ârötf
(
°dîr
, "%†© %d\n", 
	`ldns_gë_îr‹°r_by_id
(
s
), 
löe_ƒ
);

176 
	`exô
(
EXIT_FAILURE
);

178 i‡(!
	`ldns_z⁄e_sﬂ
(
z
)) {

179 
	`Ârötf
(
°dîr
, "No zone data seen\n");

180 
	`exô
(
EXIT_FAILURE
);

183 
âl
 = 
	`ldns_º_âl
(
	`ldns_z⁄e_sﬂ
(
z
));

184 i‡(!
‹igö
) {

185 
‹igö
 = 
	`ldns_º_ow√r
(
	`ldns_z⁄e_sﬂ
(
z
));

188 
ow√r°r
 = 
	`ldns_rdf2°r
(
‹igö
);

189 i‡(!
ow√r°r
) {

190 
	`Ârötf
(
°dîr
, "ldns_rdf2str(origin) failed\n");

191 
	`exô
(
EXIT_FAILURE
);

193 
ow√æí
 = 
	`°æí
(
ow√r°r
);

195 
	`ldns_º_¥öt
(
°dout
, 
	`ldns_z⁄e_sﬂ
(
z
));

197 i‡(
addºs
 > 0) {

198 
addºs
 > 
cou¡a
) {

199 
cou¡a
++;

200 
º°æí
 = 
punyÀn
 + 
ow√æí
 + 
˛as°y≥Àn
 + 4;

201 
º°æí
 *= 2;

202 
º°r
 = (*)
	`mÆloc
(
º°æí
);

203 i‡(!
º°r
) {

204 
	`Ârötf
(
°dîr
, "malloc() failed: Out of memory\n");

205 
	`exô
(
EXIT_FAILURE
);

207 ()
	`¢¥ötf
(
º°r
, 
º°æí
, "%s%d.%†%u %s", 
puny°r
, 
cou¡a
,

208 
ow√r°r
, (Ë
âl
, 
˛as°y≥°r1
);

209 
°©us
 = 
	`ldns_º_√w_‰m_°r
(&
cur_º
, 
º°r
, 0, 
NULL
, NULL);

210 i‡(
°©us
 =
LDNS_STATUS_OK
) {

211 
	`ldns_º_¥öt
(
°dout
, 
cur_º
);

212 
	`ldns_º_‰ì
(
cur_º
);

214 
	`Ârötf
(
°dîr
, "ldns_rr_new_frm_str() failed\n");

215 
	`exô
(
EXIT_FAILURE
);

218 ()
	`¢¥ötf
(
º°r
, 
º°æí
, "%s%d.%†%u %s", 
puny°r
, 
cou¡a
,

219 
ow√r°r
, (Ë
âl
, 
˛as°y≥°r2
);

220 
°©us
 = 
	`ldns_º_√w_‰m_°r
(&
cur_º
, 
º°r
, 0, 
NULL
, NULL);

221 i‡(
°©us
 =
LDNS_STATUS_OK
) {

222 
	`ldns_º_¥öt
(
°dout
, 
cur_º
);

224 
	`Ârötf
(
°dîr
, "ldns_rr_new_frm_str() failed\n");

225 
	`exô
(
EXIT_FAILURE
);

228 
	`‰ì
(
º°r
);

231 i‡(
do_ds
) {

237 
n§™d
 = 
	`ønd
() % 100;

238 i‡(
n§™d
 < 
d•îc
) {

239 
ow√r
 = 
	`ldns_º_ow√r
(
cur_º
);

240 
âl
 = 
	`ldns_º_âl
(
cur_º
);

241 
cou¡d
 +
	`ö£π_ds
(
ow√r
, 
âl
);

244 
	`ldns_º_‰ì
(
cur_º
);

248 i‡(!
do_ds
) {

249 
	`ldns_º_li°_¥öt
(
°dout
, 
	`ldns_z⁄e_ºs
(
z
));

255 i‡(
ˇn⁄iˇlize
) {

256 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_z⁄e_sﬂ
(
z
));

257 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z
)); i++) {

258 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z
), 
i
));

262 i‡(
s‹t
) {

263 
	`ldns_z⁄e_s‹t
(
z
);

269 (
º£t_li°
 = 
	`ldns_º_li°_p›_º£t
(
	`ldns_z⁄e_ºs
(
z
)))) {

270 
ow√r
 = 
	`ldns_º_li°_ow√r
(
º£t_li°
);

271 
cur_º_ty≥
 = 
	`ldns_º_li°_ty≥
(
º£t_li°
);

275 
cur_º
 = 
	`ldns_º_li°_p›_º
(
º£t_li°
);

276 
cur_º
) {

277 
âl
 = 
	`ldns_º_âl
(
cur_º
);

278 
	`Ârötf
(
°dout
, "%s", 
	`ldns_º2°r
(
cur_º
));

279 
cur_º
 = 
	`ldns_º_li°_p›_º
(
º£t_li°
);

285 
n§™d
 = 
	`ønd
() % 100;

286 i‡(
n§™d
 == 0) {

287 
n§™d
 = 100;

290 i‡((
cur_º_ty≥
 =
LDNS_RR_TYPE_NS
) &&

291 (
	`ldns_rdf_com∑ª
(
ow√r
, 
‹igö
Ë!0Ë&& (
n§™d
 < 
d•îc
)) {

295 
cou¡r
++;

296 
cou¡d
 +
	`ö£π_ds
(
ow√r
, 
âl
);

298 
	`ldns_º_li°_‰ì
(
º£t_li°
);

299 
	`ldns_rdf_‰ì
(
ow√r
);

306 
	`f˛o£
(
Â
);

307 
	`Ârötf
(
°dout
, ";; Added %d DSÑecords (percentage was %d)Åo %d NS RRset's (from input-zone: %d, fromádded: %d)\n;;Üines in original input-zone: %d\n",

308 
cou¡d
, 
d•îc
, 
cou¡a
 + 
cou¡r
, cou¡r, cou¡a, 
löe_ƒ
);

309 
	`exô
(
EXIT_SUCCESS
);

310 
	}
}

	@examples/ldns-key2ds.c

9 
	~"c⁄fig.h
"

11 
	~<ldns/ldns.h
>

13 
	~<î∫o.h
>

16 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

17 
	`Ârötf
(
Â
, "%†[-‚] [-1|-2] keyfûe\n", 
¥og
);

18 
	`Ârötf
(
Â
, " Generateá DS RR fromÅhe DNSKEYS in keyfile\n");

19 
	`Ârötf
(
Â
, " The following file will be created: ");

20 
	`Ârötf
(
Â
, "K<name>+<alg>+<id>.ds\n");

21 
	`Ârötf
(
Â
, " The baseÇame (K<name>+<alg>+<id> will beÖrintedÅo stdout\n");

22 
	`Ârötf
(
Â
, "Options:\n");

23 
	`Ârötf
(
Â
, " -f: ignore SEP flag (i.e. make DSÑecords forány key)\n");

24 
	`Ârötf
(
Â
, " -n: doÇot write DSÑecordsÅo file(s) butÅo stdout\n");

25 
	`Ârötf
(
Â
, " (default) use similar hashÅoÅhe keyálgorithm.\n");

26 
	`Ârötf
(
Â
, " -1: use SHA1 forÅhe DS hash\n");

27 
	`Ârötf
(
Â
, " -2: use SHA256 forÅhe DS hash\n");

28 #ifde‡
USE_GOST


29 
	`Ârötf
(
Â
, " -g: use GOST forÅhe DS hash\n");

31 #ifde‡
USE_ECDSA


32 
	`Ârötf
(
Â
, " -4: use SHA384 forÅhe DS hash\n");

34 
	}
}

37 
	$is_suôabÀ_dnskey
(
ldns_º
 *
º
, 
£p_⁄ly
)

39 i‡(!
º
 || 
	`ldns_º_gë_ty≥
‘rË!
LDNS_RR_TYPE_DNSKEY
) {

42  !
£p_⁄ly
 ||

43 (
	`ldns_rdf2«tive_öt16
(
	`ldns_º_dnskey_Êags
(
º
)) &

44 
LDNS_KEY_SEP_KEY
);

45 
	}
}

47 
ldns_hash


48 
	$suôabÀ_hash
(
ldns_signög_Æg‹ôhm
 
Æg‹ôhm
)

50 
Æg‹ôhm
) {

51 
LDNS_SIGN_RSASHA256
:

52 
LDNS_SIGN_RSASHA512
:

53  
LDNS_SHA256
;

54 
LDNS_SIGN_ECC_GOST
:

55 #ifde‡
USE_GOST


56  
LDNS_HASH_GOST
;

58  
LDNS_SHA256
;

60 #ifde‡
USE_ECDSA


61 
LDNS_SIGN_ECDSAP256SHA256
:

62  
LDNS_SHA256
;

63 
LDNS_SIGN_ECDSAP384SHA384
:

64  
LDNS_SHA384
;

68  
LDNS_SHA1
;

69 
	}
}

72 
	$maö
(
¨gc
, *
¨gv
[])

74 
FILE
 *
keyÂ
, *
dsÂ
;

75 *
key«me
;

76 *
d¢ame
;

77 *
ow√r
;

78 
ldns_º
 *
k
, *
ds
;

79 
ldns_signög_Æg‹ôhm
 
Æg
;

80 
ldns_hash
 
h
;

81 
simû¨_hash
=1;

82 *
¥ogøm
 = 
¨gv
[0];

83 
nofûe
 = 0;

84 
ldns_rdf
 *
‹igö
 = 
NULL
;

85 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

86 
£p_⁄ly
 = 1;

88 
Æg
 = 0;

89 
h
 = 
LDNS_SHA1
;

91 
¨gv
++, 
¨gc
--;

92 
¨gc
 && 
¨gv
[0][0] == '-') {

93 i‡(
	`°rcmp
(
¨gv
[0], "-1") == 0) {

94 
h
 = 
LDNS_SHA1
;

95 
simû¨_hash
 = 0;

97 i‡(
	`°rcmp
(
¨gv
[0], "-2") == 0) {

98 
h
 = 
LDNS_SHA256
;

99 
simû¨_hash
 = 0;

101 #ifde‡
USE_GOST


102 i‡(
	`°rcmp
(
¨gv
[0], "-g") == 0) {

103 if(!
	`ldns_key_EVP_lﬂd_go°_id
()) {

104 
	`Ârötf
(
°dîr
, "error:Üibcrypto doesÇotÖrovide GOST\n");

105 
	`exô
(
EXIT_FAILURE
);

107 
h
 = 
LDNS_HASH_GOST
;

108 
simû¨_hash
 = 0;

111 #ifde‡
USE_ECDSA


112 i‡(
	`°rcmp
(
¨gv
[0], "-4") == 0) {

113 
h
 = 
LDNS_SHA384
;

114 
simû¨_hash
 = 0;

117 i‡(
	`°rcmp
(
¨gv
[0], "-f") == 0) {

118 
£p_⁄ly
 = 0;

120 i‡(
	`°rcmp
(
¨gv
[0], "-n") == 0) {

121 
nofûe
=1;

123 
¨gv
++, 
¨gc
--;

126 i‡(
¨gc
 != 1) {

127 
	`ußge
(
°dîr
, 
¥ogøm
);

128 
	`exô
(
EXIT_FAILURE
);

130 
key«me
 = 
	`°rdup
(
¨gv
[0]);

132 
keyÂ
 = 
	`f›í
(
key«me
, "r");

133 i‡(!
keyÂ
) {

134 
	`Ârötf
(
°dîr
, "FaûedÅÿ›íÖubli¯key fûê%s: %s\n", 
key«me
,

135 
	`°ªº‹
(
î∫o
));

136 
	`exô
(
EXIT_FAILURE
);

139 
ªsu…
 =
LDNS_STATUS_OK
) {

140 
ªsu…
 = 
	`ldns_º_√w_‰m_Â
(&
k
, 
keyÂ
, 0, &
‹igö
, 
NULL
);

141 
ªsu…
 =
LDNS_STATUS_SYNTAX_ORIGIN
 ||

142 
ªsu…
 =
LDNS_STATUS_SYNTAX_TTL
 ||

143 (
ªsu…
 =
LDNS_STATUS_OK
 && !
	`is_suôabÀ_dnskey
(
k
, 
£p_⁄ly
))

145 i‡(
ªsu…
 =
LDNS_STATUS_OK
) {

146 
	`ldns_º_‰ì
(
k
);

148 
ªsu…
 = 
	`ldns_º_√w_‰m_Â
(&
k
, 
keyÂ
, 0, &
‹igö
, 
NULL
);

150 i‡(
ªsu…
 =
LDNS_STATUS_SYNTAX_EMPTY
) {

154 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

155 
	`Ârötf
(
°dîr
, "CouldÇŸÑódÖubli¯key from fûê%s: %s\n", 
key«me
, 
	`ldns_gë_îr‹°r_by_id
(
ªsu…
));

156 
	`exô
(
EXIT_FAILURE
);

159 
ow√r
 = 
	`ldns_rdf2°r
(
	`ldns_º_ow√r
(
k
));

160 
Æg
 = 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_dnskey_Æg‹ôhm
(
k
));

161 if(
simû¨_hash
)

162 
h
 = 
	`suôabÀ_hash
(
Æg
);

164 
ds
 = 
	`ldns_key_º2ds
(
k
, 
h
);

165 i‡(!
ds
) {

166 
	`Ârötf
(
°dîr
, "ConversionÅoá DS RR failed\n");

167 
	`ldns_º_‰ì
(
k
);

168 
	`‰ì
(
ow√r
);

169 
	`exô
(
EXIT_FAILURE
);

173 
d¢ame
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
ow√r
) + 16);

174 
	`¢¥ötf
(
d¢ame
, 
	`°æí
(
ow√r
Ë+ 15, "K%s+%03u+%05u.ds", ow√r, 
Æg
, (Ë
	`ldns_ˇlc_keyèg
(
k
));

176 i‡(
nofûe
)

177 
	`ldns_º_¥öt
(
°dout
,
ds
);

179 
dsÂ
 = 
	`f›í
(
d¢ame
, "w");

180 i‡(!
dsÂ
) {

181 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
d¢ame
, 
	`°ªº‹
(
î∫o
));

182 
	`exô
(
EXIT_FAILURE
);

184 
	`ldns_º_¥öt
(
dsÂ
, 
ds
);

185 
	`f˛o£
(
dsÂ
);

186 
	`Ârötf
(
°dout
, "K%s+%03u+%05u\n", 
ow√r
, 
Æg
, (Ë
	`ldns_ˇlc_keyèg
(
k
));

190 
	`ldns_º_‰ì
(
ds
);

191 
	`ldns_º_‰ì
(
k
);

192 
	`‰ì
(
ow√r
);

193 
	`LDNS_FREE
(
d¢ame
);

195 
	`f˛o£
(
keyÂ
);

196 
	`‰ì
(
key«me
);

197 
	`exô
(
EXIT_SUCCESS
);

198 
	}
}

	@examples/ldns-keyfetcher.c

10 
	~"c⁄fig.h
"

11 
	~<ldns/ldns.h
>

12 
	~<î∫o.h
>

14 
	gvîbosôy
 = 0;

16 
uöt8_t
 
	gaddªss_Ámûy
 = 0;

17 
boﬁ
 
	g°‹e_ö_fûe
 = 
Ál£
;

20 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

21 
	`Ârötf
(
Â
, "%†domaö\n", 
¥og
);

22 
	`Ârötf
(
Â
, "ÑetrieveÅhe dnskeys forá domain\n");

23 
	`Ârötf
(
Â
, "Options:\n");

24 
	`Ârötf
(
Â
, "-4\t\tUse IPv4 only\n");

25 
	`Ârötf
(
Â
, "-6\t\tUse IPv6 only\n");

26 
	`Ârötf
(
Â
, "-h\t\tShowÅhis help\n");

27 
	`Ârötf
(
Â
, "-i\t\tInsecurer mode; don't do checks, just query forÅhe keys\n");

28 
	`Ârötf
(
Â
, "-r <file>\tUse fileÅoÑeadÑoot hints from\n");

29 
	`Ârötf
(
Â
, "-s\t\tDon'tÖrintÅhe keys but storeÅhem in files\n\t\tcalled K<file>.+<alg>.+<keytag>.key\n");

30 
	`Ârötf
(
Â
, "-v <int>\tVerbosityÜevel (0-5,Çot verbose-very verbose)\n");

31 
	}
}

33 
ldns_º_li°
 *

34 
	$ªåõve_dnskeys
(
ldns_ªsﬁvî
 *
loˇl_ªs
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
,

35 
ldns_º_˛ass
 
c
, 
ldns_º_li°
 *
dns_roŸ
)

37 
ldns_ªsﬁvî
 *
ªs
;

38 
ldns_pkt
 *
p
;

39 
ldns_º_li°
 *
√w_nss_a
;

40 
ldns_º_li°
 *
√w_nss_ØØ
;

41 
ldns_º_li°
 *
√w_nss
;

42 
ldns_º_li°
 *
ns_addr
;

43 
ldns_º_li°
 *
ns_addr2
;

44 
uöt16_t
 
lo›_cou¡
;

45 
ldns_rdf
 *
p›
;

46 
ldns_°©us
 
°©us
;

47 
size_t
 
i
;

49 
size_t
 
nss_i
;

50 
ldns_º_li°
 *
™swî_li°
 = 
NULL
;

51 
ldns_º_li°
 *
auth‹ôy_li°
 = 
NULL
;

53 
size_t
 
œ°_«me£rvî_cou¡
;

54 
ldns_rdf
 **
œ°_«me£rvîs
;

56 
lo›_cou¡
 = 0;

57 
√w_nss_a
 = 
NULL
;

58 
√w_nss_ØØ
 = 
NULL
;

59 
√w_nss
 = 
NULL
;

60 
ns_addr
 = 
NULL
;

61 
ns_addr2
 = 
NULL
;

62 
p
 = 
	`ldns_pkt_√w
();

63 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

65 i‡(!
p
 || !
ªs
) {

66 
	`Ârötf
(
°dîr
, "Memoryállocation failed");

67  
NULL
;

70 i‡(
vîbosôy
 >= 2) {

71 
	`¥ötf
("Finding dnskey data for zone: ");

72 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

73 
	`¥ötf
("\n\n");

78 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
,

79 
	`ldns_ªsﬁvî_ù6
(
loˇl_ªs
));

80 
	`ldns_ªsﬁvî_£t_p‹t
(
ªs
,

81 
	`ldns_ªsﬁvî_p‹t
(
loˇl_ªs
));

82 
	`ldns_ªsﬁvî_£t_debug
(
ªs
,

83 
	`ldns_ªsﬁvî_debug
(
loˇl_ªs
));

84 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
,

85 
	`ldns_ªsﬁvî_dns£c
(
loˇl_ªs
));

86 
	`ldns_ªsﬁvî_£t_Áû
(
ªs
,

87 
	`ldns_ªsﬁvî_Áû
(
loˇl_ªs
));

88 
	`ldns_ªsﬁvî_£t_u£vc
(
ªs
,

89 
	`ldns_ªsﬁvî_u£vc
(
loˇl_ªs
));

90 
	`ldns_ªsﬁvî_£t_øndom
(
ªs
,

91 
	`ldns_ªsﬁvî_øndom
(
loˇl_ªs
));

92 
	`ldns_ªsﬁvî_£t_ªcursive
(
ªs
, 
Ál£
);

95 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
dns_roŸ
);

96 i‡(
°©us
 !
LDNS_STATUS_OK
) {

97 
	`Ârötf
(
°dîr
, "Eº‹ sëtögÑoŸÇame£rvî†öÑesﬁvî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

98  
NULL
;

101 
	`ldns_pkt_‰ì
(
p
);

102 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

103 i‡(
°©us
 !
LDNS_STATUS_OK
) {

104 
	`Ârötf
(
°dîr
, "Eº‹ quîyögÑoŸ sîvîs: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

105  
NULL
;

108 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë!
LDNS_RCODE_NOERROR
) {

109 
	`¥ötf
("Error inÖacket:\n");

110 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

111  
NULL
;

114 i‡(
vîbosôy
 >= 4) {

115 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

116 
	`¥ötf
("\n\n");

120 
	`ldns_ªsﬁvî_£t_u£vc
(
ªs
, 
åue
);

122 
°©us
 =
LDNS_STATUS_OK
 &&

123 
	`ldns_pkt_ª∂y_ty≥
(
p
Ë=
LDNS_PACKET_REFERRAL
) {

125 i‡(
vîbosôy
 >= 3) {

126 
	`¥ötf
("This isá delegation!\n\n");

128 i‡(
addªss_Ámûy
 == 0 ||áddress_family == 1) {

129 
√w_nss_a
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

130 
LDNS_RR_TYPE_A
, 
LDNS_SECTION_ADDITIONAL
);

132 
√w_nss_a
 = 
	`ldns_º_li°_√w
();

134 i‡(
addªss_Ámûy
 == 0 ||áddress_family == 2) {

135 
√w_nss_ØØ
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

136 
LDNS_RR_TYPE_AAAA
, 
LDNS_SECTION_ADDITIONAL
);

138 
√w_nss_ØØ
 = 
	`ldns_º_li°_√w
();

140 
√w_nss
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

141 
LDNS_RR_TYPE_NS
, 
LDNS_SECTION_AUTHORITY
);

144 (
p›
 = 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
))Ë{ 
	`ldns_rdf_dìp_‰ì
(pop); }

148 i‡(!
√w_nss_ØØ
 && !
√w_nss_a
) {

153 i‡(
vîbosôy
 >= 3) {

154 
	`¥ötf
("DidÇot getáddressÑecord forÇameserver, doing separate query.\n");

156 
ns_addr
 = 
	`ldns_º_li°_√w
();

157 
i
 = 0; (
size_t
Ëò< 
	`ldns_º_li°_º_cou¡
(
√w_nss
); i++) {

159 
p›
 = 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
√w_nss
, 
i
), 0);

160 i‡(!
p›
) {

165 
ns_addr2
 = 
	`ldns_gë_º_li°_addr_by_«me
(
loˇl_ªs
, 
p›
, 
c
, 0);

166 i‡(!
	`ldns_º_li°_ˇt
(
ns_addr
, 
ns_addr2
)) {

167 
	`Ârötf
(
°dîr
, "InternalÉrroráddingÇameserveráddress.\n");

168 
	`exô
(
EXIT_FAILURE
);

170 
	`ldns_º_li°_‰ì
(
ns_addr2
);

173 i‡(
ns_addr
) {

174 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ªs
, 
ns_addr
) !=

175 
LDNS_STATUS_OK
) {

176 
	`Ârötf
(
°dîr
, "ErroráddingÇewÇameservers");

177 
	`ldns_pkt_‰ì
(
p
);

178  
NULL
;

180 
	`ldns_º_li°_dìp_‰ì
(
ns_addr
);

182 
	`ldns_º_li°_¥öt
(
°dout
, 
ns_addr
);

183 
	`Ârötf
(
°dîr
, "CouldÇot findÅheÇameserver ipáddr;ábort");

184 
	`ldns_pkt_‰ì
(
p
);

185  
NULL
;

196 
	`ldns_º_li°_dìp_‰ì
(
™swî_li°
);

197 
	`ldns_º_li°_dìp_‰ì
(
auth‹ôy_li°
);

198 
™swî_li°
 = 
NULL
;

199 
auth‹ôy_li°
 = 
NULL
;

200 
nss_i
 = 0;Çss_ò< 
	`ldns_º_li°_º_cou¡
(
√w_nss_ØØ
);Çss_i++) {

201 (
p›
 = 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
))Ë{ 
	`ldns_rdf_dìp_‰ì
(pop); }

203 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî
(
ªs
, 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
√w_nss_ØØ
, 
nss_i
), 0));

204 i‡(
°©us
 !
LDNS_STATUS_OK
) {

205 
	`Ârötf
(
°dîr
, "Eº‹áddögÇame£rvîÅÿªsﬁvî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

208 i‡(
vîbosôy
 >= 1) {

209 
	`Ârötf
(
°dout
, "QueryingÇameserver: ");

210 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
√w_nss_ØØ
, 
nss_i
)));

211 
	`Ârötf
(
°dout
, " (");

212 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
√w_nss_ØØ
, 
nss_i
), 0));

213 
	`Ârötf
(
°dout
, ")\n");

215 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî
(
ªs
, 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
√w_nss_ØØ
, 
nss_i
), 0));

216 i‡(
°©us
 !
LDNS_STATUS_OK
) {

217 
	`Ârötf
(
°dîr
, "Eº‹áddögÇame£rvîÅÿªsﬁvî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

220 
	`ldns_pkt_‰ì
(
p
);

221 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

222 i‡(
°©us
 =
LDNS_STATUS_OK
 && 
p
) {

223 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë!
LDNS_RCODE_NOERROR
) {

224 
	`¥ötf
("Error inÖacket:\n");

225 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

226  
NULL
;

229 i‡(
vîbosôy
 >= 4) {

230 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

231 
	`¥ötf
("\n\n");

234 i‡(
™swî_li°
) {

235 i‡(
vîbosôy
 >= 2) {

236 
	`¥ötf
("ComparingánswerÜist ofánswerÅoÖrevious\n\n");

238 
	`ldns_º_li°_s‹t
(
	`ldns_pkt_™swî
(
p
));

239 
	`ldns_º_li°_s‹t
(
™swî_li°
);

240 i‡(
	`ldns_º_li°_com∑ª
(
™swî_li°
, 
	`ldns_pkt_™swî
(
p
)) != 0) {

241 
	`Ârötf
(
°dîr
, "ERROR: differentánsweránswer fromÇameserver\n");

242 
	`Ârötf
(
°dîr
, "\nI had (fromÖrevious servers):\n");

243 
	`ldns_º_li°_¥öt
(
°dîr
, 
™swî_li°
);

244 
	`Ârötf
(
°dîr
, "\nIÑeceived (fromÇameserverát ");

245 
	`ldns_rdf_¥öt
(
°dîr
, 
	`ldns_ªsﬁvî_«me£rvîs
(
ªs
)[0]);

246 
	`Ârötf
(
°dîr
, "):\n");

247 
	`ldns_º_li°_¥öt
(
°dîr
, 
	`ldns_pkt_™swî
(
p
));

248 
	`exô
(
EXIT_FAILURE
);

251 
™swî_li°
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_™swî
(
p
));

252 
	`ldns_º_li°_s‹t
(
™swî_li°
);

253 i‡(
vîbosôy
 >= 2) {

254 
	`¥ötf
("FirstánswerÜist forÅhis set,ÇothingÅo compare with\n\n");

257 i‡(
auth‹ôy_li°
) {

258 i‡(
vîbosôy
 >= 2) {

259 
	`¥ötf
("ComparingáuthorityÜist ofánswerÅoÖrevious\n\n");

261 
	`ldns_º_li°_s‹t
(
	`ldns_pkt_auth‹ôy
(
p
));

262 
	`ldns_º_li°_s‹t
(
auth‹ôy_li°
);

263 i‡(
	`ldns_º_li°_com∑ª
(
auth‹ôy_li°
, 
	`ldns_pkt_auth‹ôy
(
p
)) != 0) {

264 
	`Ârötf
(
°dîr
, "ERROR: differentáuthorityánswer fromÇameserver\n");

265 
	`Ârötf
(
°dîr
, "\nI had (fromÖrevious servers):\n");

266 
	`ldns_º_li°_¥öt
(
°dîr
, 
auth‹ôy_li°
);

267 
	`Ârötf
(
°dîr
, "\nIÑeceived (fromÇameserverát ");

268 
	`ldns_rdf_¥öt
(
°dîr
, 
	`ldns_ªsﬁvî_«me£rvîs
(
ªs
)[0]);

269 
	`Ârötf
(
°dîr
, "):\n");

270 
	`ldns_º_li°_¥öt
(
°dîr
, 
	`ldns_pkt_auth‹ôy
(
p
));

271 
	`exô
(
EXIT_FAILURE
);

274 
auth‹ôy_li°
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_auth‹ôy
(
p
));

275 
	`ldns_º_li°_s‹t
(
auth‹ôy_li°
);

276 i‡(
vîbosôy
 >= 2) {

277 
	`¥ötf
("FirstáuthorityÜist forÅhis set,ÇothingÅo compare with\n\n");

279 i‡(
vîbosôy
 >= 3) {

280 
	`¥ötf
("NS RRset:\n");

281 
	`ldns_º_li°_¥öt
(
°dout
, 
auth‹ôy_li°
);

282 
	`¥ötf
("\n");

288 
	`ldns_º_li°_dìp_‰ì
(
™swî_li°
);

289 
	`ldns_º_li°_dìp_‰ì
(
auth‹ôy_li°
);

290 
™swî_li°
 = 
NULL
;

291 
auth‹ôy_li°
 = 
NULL
;

292 
nss_i
 = 0;Çss_ò< 
	`ldns_º_li°_º_cou¡
(
√w_nss_a
);Çss_i++) {

294 (
p›
 = 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
))Ë{
	`ldns_rdf_dìp_‰ì
(pop); }

296 i‡(
vîbosôy
 >= 1) {

297 
	`Ârötf
(
°dout
, "QueryingÇameserver: ");

298 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
√w_nss_a
, 
nss_i
)));

299 
	`Ârötf
(
°dout
, " (");

300 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
√w_nss_a
, 
nss_i
), 0));

301 
	`Ârötf
(
°dout
, ")\n");

303 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî
(
ªs
, 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
√w_nss_a
, 
nss_i
), 0));

304 i‡(
°©us
 !
LDNS_STATUS_OK
) {

305 
	`Ârötf
(
°dîr
, "Eº‹áddögÇame£rvîÅÿªsﬁvî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

308 
	`ldns_pkt_‰ì
(
p
);

309 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

311 i‡(
°©us
 =
LDNS_STATUS_OK
) {

312 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë!
LDNS_RCODE_NOERROR
) {

313 
	`¥ötf
("Error inÖacket:\n");

314 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

315  
NULL
;

318 i‡(
vîbosôy
 >= 4) {

319 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

320 
	`¥ötf
("\n\n");

323 i‡(
™swî_li°
) {

324 i‡(
vîbosôy
 >= 2) {

325 
	`¥ötf
("ComparingánswerÜist ofánswerÅoÖrevious\n\n");

327 
	`ldns_º_li°_s‹t
(
	`ldns_pkt_™swî
(
p
));

328 
	`ldns_º_li°_s‹t
(
™swî_li°
);

329 i‡(
	`ldns_º_li°_com∑ª
(
™swî_li°
, 
	`ldns_pkt_™swî
(
p
)) != 0) {

330 
	`Ârötf
(
°dîr
, "ERROR: differentánsweránswer fromÇameserver\n");

331 
	`Ârötf
(
°dîr
, "\nI had (fromÖrevious servers):\n");

332 
	`ldns_º_li°_¥öt
(
°dîr
, 
™swî_li°
);

333 
	`Ârötf
(
°dîr
, "\nIÑeceived (fromÇameserverát ");

334 
	`ldns_rdf_¥öt
(
°dîr
, 
	`ldns_ªsﬁvî_«me£rvîs
(
ªs
)[0]);

335 
	`Ârötf
(
°dîr
, "):\n");

336 
	`ldns_º_li°_¥öt
(
°dîr
, 
	`ldns_pkt_™swî
(
p
));

337 
	`exô
(
EXIT_FAILURE
);

340 i‡(
vîbosôy
 >= 2) {

341 
	`¥ötf
("FirstánswerÜist forÅhis set,ÇothingÅo compare with\n\n");

343 
™swî_li°
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_™swî
(
p
));

344 
	`ldns_º_li°_s‹t
(
™swî_li°
);

346 i‡(
auth‹ôy_li°
) {

347 i‡(
vîbosôy
 >= 2) {

348 
	`¥ötf
("ComparingáuthorityÜist ofánswerÅoÖrevious\n\n");

350 
	`ldns_º_li°_s‹t
(
	`ldns_pkt_auth‹ôy
(
p
));

351 
	`ldns_º_li°_s‹t
(
auth‹ôy_li°
);

352 i‡(
	`ldns_º_li°_com∑ª
(
auth‹ôy_li°
, 
	`ldns_pkt_auth‹ôy
(
p
)) != 0) {

353 
	`Ârötf
(
°dîr
, "ERROR: differentáuthorityánswer fromÇameserver\n");

354 
	`Ârötf
(
°dîr
, "\nI had (fromÖrevious servers):\n");

355 
	`ldns_º_li°_¥öt
(
°dîr
, 
auth‹ôy_li°
);

356 
	`Ârötf
(
°dîr
, "\nIÑeceived (fromÇameserverát ");

357 
	`ldns_rdf_¥öt
(
°dîr
, 
	`ldns_ªsﬁvî_«me£rvîs
(
ªs
)[0]);

358 
	`Ârötf
(
°dîr
, "):\n");

359 
	`ldns_º_li°_¥öt
(
°dîr
, 
	`ldns_pkt_auth‹ôy
(
p
));

360 
	`exô
(
EXIT_FAILURE
);

363 i‡(
vîbosôy
 >= 2) {

364 
	`¥ötf
("FirstáuthorityÜist forÅhis set,ÇothingÅo compare with\n\n");

366 
auth‹ôy_li°
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_auth‹ôy
(
p
));

367 
	`ldns_º_li°_s‹t
(
auth‹ôy_li°
);

368 i‡(
vîbosôy
 >= 3) {

369 
	`¥ötf
("NS RRset:\n");

370 
	`ldns_º_li°_¥öt
(
°dout
, 
auth‹ôy_li°
);

371 
	`¥ötf
("\n");

376 
	`ldns_º_li°_dìp_‰ì
(
auth‹ôy_li°
);

377 
auth‹ôy_li°
 = 
NULL
;

379 i‡(
lo›_cou¡
++ > 20) {

381 
	`Ârötf
(
°dîr
, "LooksÜike weáreÜooping");

382 
	`ldns_pkt_‰ì
(
p
);

383  
NULL
;

386 
	`ldns_pkt_‰ì
(
p
);

388 i‡(
vîbosôy
 >= 3) {

389 
	`Ârötf
(
°dout
, "ThisÜevel ok. ContinuingÅoÇext.\n\n");

392 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

394 i‡(
°©us
 !
LDNS_STATUS_OK
) {

395 
	`Ârötf
(
°dîr
, "Eº‹ quîyögÑoŸ sîvîs: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

396  
NULL
;

399 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë!
LDNS_RCODE_NOERROR
) {

400 
	`¥ötf
("Error inÖacket:\n");

401 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

402  
NULL
;

405 i‡(
vîbosôy
 >= 4) {

406 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

407 
	`¥ötf
("\n\n");

411 
	`ldns_º_li°_dìp_‰ì
(
√w_nss_ØØ
);

412 
	`ldns_º_li°_dìp_‰ì
(
√w_nss_a
);

413 
	`ldns_º_li°_dìp_‰ì
(
√w_nss
);

414 
√w_nss_ØØ
 = 
NULL
;

415 
√w_nss_a
 = 
NULL
;

416 
ns_addr
 = 
NULL
;

419 
	`ldns_º_li°_dìp_‰ì
(
™swî_li°
);

420 
™swî_li°
 = 
NULL
;

422 
œ°_«me£rvî_cou¡
 = 0;

423 
œ°_«me£rvîs
 = 
	`LDNS_XMALLOC
(
ldns_rdf
 *, 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
ªs
));

425 
p›
 = 
NULL
;

426 (
p›
 = 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
))) {

427 
œ°_«me£rvîs
[
œ°_«me£rvî_cou¡
] = 
p›
;

428 
œ°_«me£rvî_cou¡
++;

431 
nss_i
 = 0;Çss_ò< 
œ°_«me£rvî_cou¡
;Çss_i++) {

433 (
p›
 = 
	`ldns_ªsﬁvî_p›_«me£rvî
(
ªs
))Ë{ 
	`ldns_rdf_dìp_‰ì
(pop); }

435 i‡(
vîbosôy
 >= 1) {

436 
	`¥ötf
("QueryingÇameserver: ");

437 
	`ldns_rdf_¥öt
(
°dout
, 
œ°_«me£rvîs
[
nss_i
]);

438 
	`¥ötf
("\n");

440 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî
(
ªs
, 
œ°_«me£rvîs
[
nss_i
]);

441 i‡(
°©us
 !
LDNS_STATUS_OK
) {

442 
	`Ârötf
(
°dîr
, "Eº‹áddögÇame£rvîÅÿªsﬁvî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

445 
	`ldns_pkt_‰ì
(
p
);

446 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(&
p
, 
ªs
, 
«me
, 
t
, 
c
, 0);

448 i‡(!
p
) {

449 
	`Ârötf
(
°dîr
, "noÖacketÑeceived\n");

450  
NULL
;

453 i‡(
°©us
 =
LDNS_STATUS_RES_NO_NS
) {

454 
	`Ârötf
(
°dîr
, "Error:Çameserverát ");

455 
	`ldns_rdf_¥öt
(
°dîr
, 
œ°_«me£rvîs
[
nss_i
]);

456 
	`Ârötf
(
°dîr
, "ÇotÑesponding. UnableÅo check RRset here,áborting.\n");

457  
NULL
;

460 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë!
LDNS_RCODE_NOERROR
) {

461 
	`¥ötf
("Error inÖacket:\n");

462 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

463  
NULL
;

466 i‡(
™swî_li°
) {

467 i‡(
vîbosôy
 >= 2) {

468 
	`¥ötf
("1ComparingánswerÑrÜist ofánswerÅoÖrevious\n");

470 
	`ldns_º_li°_s‹t
(
	`ldns_pkt_™swî
(
p
));

471 
	`ldns_º_li°_s‹t
(
™swî_li°
);

472 i‡(
	`ldns_º_li°_com∑ª
(
™swî_li°
, 
	`ldns_pkt_™swî
(
p
)) != 0) {

473 
	`¥ötf
("ERROR: differentánswer section inÑesponse fromÇameserver\n");

474 
	`Ârötf
(
°dîr
, "\nI had:\n");

475 
	`ldns_º_li°_¥öt
(
°dîr
, 
™swî_li°
);

476 
	`Ârötf
(
°dîr
, "\nIÑeceived (fromÇameserverát ");

477 
	`ldns_rdf_¥öt
(
°dîr
, 
	`ldns_ªsﬁvî_«me£rvîs
(
ªs
)[0]);

478 
	`Ârötf
(
°dîr
, "):\n");

479 
	`ldns_º_li°_¥öt
(
°dîr
, 
	`ldns_pkt_™swî
(
p
));

480 
	`exô
(
EXIT_FAILURE
);

483 i‡(
vîbosôy
 >= 2) {

484 
	`¥ötf
("FirstánswerÑrÜist forÅhis set,ÇothingÅo compare with\n");

486 
™swî_li°
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_™swî
(
p
));

487 i‡(
vîbosôy
 >= 3) {

488 
	`¥ötf
("DNSKEY RRset:\n");

489 
	`ldns_º_li°_¥öt
(
°dout
, 
™swî_li°
);

495 
nss_i
 = 0;Çss_ò< 
œ°_«me£rvî_cou¡
;Çss_i++) {

496 
	`ldns_rdf_dìp_‰ì
(
œ°_«me£rvîs
[
nss_i
]);

498 
	`LDNS_FREE
(
œ°_«me£rvîs
);

499 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

500 
	`ldns_pkt_‰ì
(
p
);

501  
™swî_li°
;

502 
	}
}

510 
ldns_º_li°
 *

511 
	$ªad_roŸ_höts
(c⁄° *
fûíame
)

513 
FILE
 *
Â
 = 
NULL
;

514 
löe_ƒ
 = 0;

515 
ldns_z⁄e
 *
z
;

516 
ldns_°©us
 
°©us
;

517 
ldns_º_li°
 *
addªs£s
 = 
NULL
;

518 
ldns_º
 *
º
;

519 
size_t
 
i
;

521 
Â
 = 
	`f›í
(
fûíame
, "r");

522 i‡(!
Â
) {

523 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %†f‹Ñódög: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

524  
NULL
;

527 
°©us
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z
, 
Â
, 
NULL
, 0, 0, &
löe_ƒ
);

528 
	`f˛o£
(
Â
);

529 i‡(
°©us
 !
LDNS_STATUS_OK
) {

530 
	`Ârötf
(
°dîr
, "Eº‹ÑódögÑoŸ höt†fûe: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

531  
NULL
;

533 
addªs£s
 = 
	`ldns_º_li°_√w
();

534 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z
)); i++) {

535 
º
 = 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z
), 
i
);

536 i‡((
addªss_Ámûy
 == 0 ||áddress_family == 1) &&

537 
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_A
 ) {

538 
	`ldns_º_li°_push_º
(
addªs£s
, 
	`ldns_º_˛⁄e
(
º
));

540 i‡((
addªss_Ámûy
 == 0 ||áddress_family == 2) &&

541 
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_AAAA
) {

542 
	`ldns_º_li°_push_º
(
addªs£s
, 
	`ldns_º_˛⁄e
(
º
));

545 
	`ldns_z⁄e_dìp_‰ì
(
z
);

546  
addªs£s
;

548 
	}
}

552 
	$maö
(
¨gc
, *
¨gv
[])

554 
ldns_ªsﬁvî
 *
ªs
;

555 
ldns_rdf
 *
ns
;

556 
ldns_rdf
 *
domaö
;

557 
ldns_º_li°
 *
l
 = 
NULL
;

559 
ldns_º_li°
 *
dns_roŸ
 = 
NULL
;

560 c⁄° *
roŸ_fûe
 = "/etc/named.root";

562 
ldns_°©us
 
°©us
;

564 
i
;

566 *
domaö_°r
;

567 *
ouçutfûe_°r
;

568 
ldns_buf„r
 *
ouçutfûe_buf„r
;

569 
FILE
 *
ouçutfûe
;

570 
ldns_º
 *
k
;

572 
boﬁ
 
ö£cuª
 = 
Ál£
;

573 
ldns_pkt
 *
pkt
;

575 
domaö
 = 
NULL
;

576 
ªs
 = 
NULL
;

578 i‡(
¨gc
 < 2) {

579 
	`ußge
(
°dout
, 
¨gv
[0]);

580 
	`exô
(
EXIT_FAILURE
);

582 
i
 = 1; i < 
¨gc
; i++) {

583 i‡(
	`°∫cmp
("-4", 
¨gv
[
i
], 3) == 0) {

584 i‡(
addªss_Ámûy
 != 0) {

585 
	`Ârötf
(
°dîr
, "Options -4ánd -6 cannot be specifiedátÅhe sameÅime\n");

586 
	`exô
(
EXIT_FAILURE
);

588 
addªss_Ámûy
 = 1;

589 } i‡(
	`°∫cmp
("-6", 
¨gv
[
i
], 3) == 0) {

590 i‡(
addªss_Ámûy
 != 0) {

591 
	`Ârötf
(
°dîr
, "Options -4ánd -6 cannot be specifiedátÅhe sameÅime\n");

592 
	`exô
(
EXIT_FAILURE
);

594 
addªss_Ámûy
 = 2;

595 } i‡(
	`°∫cmp
("-h", 
¨gv
[
i
], 3) == 0) {

596 
	`ußge
(
°dout
, 
¨gv
[0]);

597 
	`exô
(
EXIT_SUCCESS
);

598 } i‡(
	`°∫cmp
("-i", 
¨gv
[
i
], 2) == 0) {

599 
ö£cuª
 = 
åue
;

600 } i‡(
	`°∫cmp
("-r", 
¨gv
[
i
], 2) == 0) {

601 i‡(
	`°æí
(
¨gv
[
i
]) > 2) {

602 
roŸ_fûe
 = 
¨gv
[
i
]+2;

603 } i‡(
i
+1 >
¨gc
) {

604 
	`ußge
(
°dout
, 
¨gv
[0]);

605 
	`exô
(
EXIT_FAILURE
);

607 
roŸ_fûe
 = 
¨gv
[
i
+1];

608 
i
++;

610 } i‡(
	`°∫cmp
("-s", 
¨gv
[
i
], 3) == 0) {

611 
°‹e_ö_fûe
 = 
åue
;

612 } i‡(
	`°∫cmp
("-v", 
¨gv
[
i
], 2) == 0) {

613 i‡(
	`°æí
(
¨gv
[
i
]) > 2) {

614 
vîbosôy
 = 
	`©oi
(
¨gv
[
i
]+2);

615 } i‡(
i
+1 > 
¨gc
) {

616 
	`ußge
(
°dout
, 
¨gv
[0]);

617 
	`exô
(
EXIT_FAILURE
);

619 
vîbosôy
 = 
	`©oi
(
¨gv
[
i
+1]);

620 
i
++;

624 i‡(
domaö
) {

625 
	`Ârötf
(
°dout
, "You can only specify one domainátáÅime\n");

626 
	`exô
(
EXIT_FAILURE
);

629 
domaö
 = 
	`ldns_d«me_√w_‰m_°r
(
¨gv
[
i
]);

633 i‡(!
domaö
) {

634 
	`ußge
(
°dout
, 
¨gv
[0]);

635 
	`exô
(
EXIT_FAILURE
);

639 
dns_roŸ
 = 
	`ªad_roŸ_höts
(
roŸ_fûe
);

640 i‡(!
dns_roŸ
) {

641 
	`Ârötf
(
°dîr
, "cannotÑeadÅheÑoot hints file\n");

642 
	`exô
(
EXIT_FAILURE
);

646 
°©us
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
ªs
, 
NULL
);

648 i‡(
°©us
 !
LDNS_STATUS_OK
) {

649 
	`Ârötf
(
°dîr
, "Warning: UnableÅo create stubÑesolver from /etc/resolv.conf:\n");

650 
	`Ârötf
(
°dîr
, "%s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

651 
	`Ârötf
(
°dîr
, "defaultingÅoÇameserverát 127.0.0.1 for separateÇameserverÇameÜookups\n");

653 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

654 i‡(
ªs
) {

655 
ns
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_A
,

657 i‡(
ns
) {

658 
°©us
 = 
	`ldns_ªsﬁvî_push_«me£rvî
(

659 
ªs
, 
ns
);

660 i‡(
°©us
 =
LDNS_STATUS_OK
) {

663 
	`ldns_rdf_dìp_‰ì
(
ns
);

665 
	`ldns_ªsﬁvî_‰ì
(
ªs
);

667 
	`Ârötf
(
°dîr
, "UnableÅo create stubÑesolver: %s\n",

668 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

669 
	`exô
(
EXIT_FAILURE
);

671 } 
Ál£
);

672 
	`ldns_rdf_dìp_‰ì
(
ns
);

675 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
, 
addªss_Ámûy
);

677 i‡(
ö£cuª
) {

678 
pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
domaö
, 
LDNS_RR_TYPE_DNSKEY
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

679 i‡(
pkt
) {

680 
l
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
, 
LDNS_RR_TYPE_DNSKEY
, 
LDNS_SECTION_ANY_NOQUESTION
);

683 
l
 = 
	`ªåõve_dnskeys
(
ªs
, 
domaö
, 
LDNS_RR_TYPE_DNSKEY
, 
LDNS_RR_CLASS_IN
, 
dns_roŸ
);

687 i‡(
vîbosôy
 > 0) {

688 
	`Ârötf
(
°dout
, "; ---------------------------\n");

689 
	`Ârötf
(
°dout
, "; GotÅhe following keys:\n");

691 i‡(
l
) {

692 i‡(
°‹e_ö_fûe
) {

696 
i
 = 0; (
size_t
Ëò< 
	`ldns_º_li°_º_cou¡
(
l
); i++) {

697 
k
 = 
	`ldns_º_li°_º
(
l
, (
size_t
Ë
i
);

699 
ouçutfûe_buf„r
 = 
	`ldns_buf„r_√w
(300);

700 
domaö_°r
 = 
	`ldns_rdf2°r
(
	`ldns_º_ow√r
(
k
));

701 
	`ldns_buf„r_¥ötf
(
ouçutfûe_buf„r
, "K%s+%03u+%05u.key", 
domaö_°r
, 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
k
, 2)),

702 (Ë
	`ldns_ˇlc_keyèg
(
k
));

703 
ouçutfûe_°r
 = 
	`ldns_buf„r_exp‹t
(
ouçutfûe_buf„r
);

705 i‡(
vîbosôy
 >= 1) {

706 
	`Ârötf
(
°dout
, "Wrôög keyÅÿfûê%s\n", 
ouçutfûe_°r
);

709 
ouçutfûe
 = 
	`f›í
(
ouçutfûe_°r
, "w");

710 i‡(!
ouçutfûe
) {

711 
	`Ârötf
(
°dîr
, "Eº‹ wrôög keyÅÿfûê%s: %s\n", 
ouçutfûe_°r
, 
	`°ªº‹
(
î∫o
));

713 
	`ldns_º_¥öt
(
ouçutfûe
, 
k
);

714 
	`f˛o£
(
ouçutfûe
);

717 
	`LDNS_FREE
(
domaö_°r
);

718 
	`LDNS_FREE
(
ouçutfûe_°r
);

719 
	`LDNS_FREE
(
ouçutfûe_buf„r
);

722 
	`ldns_º_li°_¥öt
(
°dout
, 
l
);

725 
	`Ârötf
(
°dîr
, "noánswerÖacketÑeceived, stubÑesolver config:\n");

726 
	`ldns_ªsﬁvî_¥öt
(
°dîr
, 
ªs
);

728 
	`¥ötf
("\n");

730 
	`ldns_rdf_dìp_‰ì
(
domaö
);

731 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

732 
	`ldns_º_li°_dìp_‰ì
(
l
);

733 
	`ldns_º_li°_dìp_‰ì
(
dns_roŸ
);

734  
EXIT_SUCCESS
;

735 
	}
}

	@examples/ldns-keygen.c

9 
	~"c⁄fig.h
"

11 
	~<ldns/ldns.h
>

13 
	~<î∫o.h
>

15 #ifde‡
HAVE_SSL


17 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

18 
	`Ârötf
(
Â
, "%s -a <algorithm> [-b bits] [-r /dev/random] [-v] domain\n",

19 
¥og
);

20 
	`Ârötf
(
Â
, " generateáÇew keyÖair for domain\n");

21 
	`Ârötf
(
Â
, " -a <alg>\tuseÅhe specifiedálgorithm (-aÜistÅo");

22 
	`Ârötf
(
Â
, " showáÜist)\n");

23 
	`Ârötf
(
Â
, " -k\t\tsetÅhe flagsÅo 257; key signing key\n");

24 
	`Ârötf
(
Â
, " -b <bits>\tspecifyÅhe keylength\n");

25 
	`Ârötf
(
Â
, " -r <random>\tspecifyáÑandom device (defaultsÅo /dev/random)\n");

26 
	`Ârötf
(
Â
, "\t\tto seedÅheÑandom generator with\n");

27 
	`Ârötf
(
Â
, " -v\t\tshowÅhe versionándÉxit\n");

28 
	`Ârötf
(
Â
, " The following files will be created:\n");

29 
	`Ârötf
(
Â
, " K<name>+<alg>+<id>.key\tPublic key in RR format\n");

30 
	`Ârötf
(
Â
, " K<name>+<alg>+<id>.private\tPrivate key in key format\n");

31 
	`Ârötf
(
Â
, " K<name>+<alg>+<id>.ds\tDS in RR format (only for DNSSEC keys)\n");

32 
	`Ârötf
(
Â
, " The baseÇame (K<name>+<alg>+<id> will beÖrintedÅo stdout\n");

33 
	}
}

36 
	$show_Æg‹ôhms
(
FILE
 *
out
)

38 
ldns_lookup_èbÀ
 *
…
 = 
ldns_signög_Æg‹ôhms
;

39 
	`Ârötf
(
out
, "Possibleálgorithms:\n");

41 
…
->
«me
) {

42 
	`Ârötf
(
out
, "%s\n", 
…
->
«me
);

43 
…
++;

45 
	}
}

48 
	$maö
(
¨gc
, *
¨gv
[])

50 
c
;

51 *
¥og
;

54 
uöt16_t
 
def_bôs
 = 1024;

55 
uöt16_t
 
bôs
 = 
def_bôs
;

56 
boﬁ
 
ksk
;

58 
FILE
 *
fûe
;

59 
FILE
 *
øndom
;

60 *
fûíame
;

61 *
ow√r
;

63 
ldns_signög_Æg‹ôhm
 
Æg‹ôhm
;

64 
ldns_rdf
 *
domaö
;

65 
ldns_º
 *
pubkey
;

66 
ldns_key
 *
key
;

67 
ldns_º
 *
ds
;

69 
¥og
 = 
	`°rdup
(
¨gv
[0]);

70 
Æg‹ôhm
 = 0;

71 
øndom
 = 
NULL
;

72 
ksk
 = 
Ál£
;

74 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "a:kb:r:v")) != -1) {

75 
c
) {

77 i‡(
Æg‹ôhm
 != 0) {

78 
	`Ârötf
(
°dîr
, "The -aárgument can only be used once\n");

79 
	`exô
(1);

81 i‡(
	`°∫cmp
(
›èrg
, "list", 5) == 0) {

82 
	`show_Æg‹ôhms
(
°dout
);

83 
	`exô
(
EXIT_SUCCESS
);

85 
Æg‹ôhm
 = 
	`ldns_gë_signög_Æg‹ôhm_by_«me
(
›èrg
);

86 i‡(
Æg‹ôhm
 == 0) {

87 
	`Ârötf
(
°dîr
, "Alg‹ôhm %†nŸ found\n", 
›èrg
);

88 
	`show_Æg‹ôhms
(
°dîr
);

89 
	`exô
(
EXIT_FAILURE
);

93 
bôs
 = (
uöt16_t
Ë
	`©oi
(
›èrg
);

94 i‡(
bôs
 == 0) {

95 
	`Ârötf
(
°dîr
, "%s: %†%d", 
¥og
, "C™ÇŸÖ¨£Åhê-bárgumít, sëtög iàtÿthêdeÁu…\n", (Ë
def_bôs
);

96 
bôs
 = 
def_bôs
;

100 
ksk
 = 
åue
;

103 
øndom
 = 
	`f›í
(
›èrg
, "r");

104 i‡(!
øndom
) {

105 
	`Ârötf
(
°dîr
, "C™nŸ o≥¿øndom fûê%s: %s\n", 
›èrg
, 
	`°ªº‹
(
î∫o
));

106 
	`exô
(
EXIT_FAILURE
);

110 
	`¥ötf
("DNSSEC key gíî©‹ vîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

111 
	`exô
(
EXIT_SUCCESS
);

114 
	`ußge
(
°dîr
, 
¥og
);

115 
	`exô
(
EXIT_FAILURE
);

118 
¨gc
 -
›töd
;

119 
¨gv
 +
›töd
;

121 i‡(
Æg‹ôhm
 == 0) {

122 
	`¥ötf
("Please useÅhe -aárgumentÅoÖrovideánálgorithm\n");

123 
	`exô
(1);

126 i‡(
¨gc
 != 1) {

127 
	`ußge
(
°dîr
, 
¥og
);

128 
	`exô
(
EXIT_FAILURE
);

130 
	`‰ì
(
¥og
);

133 
Æg‹ôhm
) {

134 
LDNS_SIGN_RSAMD5
:

135 
LDNS_SIGN_RSASHA1
:

136 i‡(
bôs
 < 512 || bits > 4096) {

137 
	`Ârötf
(
°dîr
, "For RSA,Åhe key size must be between ");

138 
	`Ârötf
(
°dîr
, " 512ánd 4096 bytes. Aborting.\n");

139 
	`exô
(1);

142 
LDNS_SIGN_DSA
:

143 i‡(
bôs
 < 512 || bits > 4096) {

144 
	`Ârötf
(
°dîr
, "For DSA,Åhe key size must be between ");

145 
	`Ârötf
(
°dîr
, " 512ánd 1024 bytes. Aborting.\n");

146 
	`exô
(1);

149 #ifde‡
USE_GOST


150 
LDNS_SIGN_ECC_GOST
:

151 if(!
	`ldns_key_EVP_lﬂd_go°_id
()) {

152 
	`Ârötf
(
°dîr
, "error:Üibcrypto doesÇotÖrovide GOST\n");

153 
	`exô
(
EXIT_FAILURE
);

157 #ifde‡
USE_ECDSA


158 
LDNS_SIGN_ECDSAP256SHA256
:

159 
LDNS_SIGN_ECDSAP384SHA384
:

161 
LDNS_SIGN_HMACMD5
:

162 
LDNS_SIGN_HMACSHA1
:

163 
LDNS_SIGN_HMACSHA256
:

168 i‡(!
øndom
) {

169 
øndom
 = 
	`f›í
("/dev/random", "r");

170 i‡(!
øndom
) {

171 
	`Ârötf
(
°dîr
, "C™nŸ o≥¿øndom fûê%s: %s\n", 
›èrg
, 
	`°ªº‹
(
î∫o
));

172 
	`exô
(
EXIT_FAILURE
);

176 ()
	`ldns_öô_øndom
(
øndom
, (Ë
bôs
/8);

177 
	`f˛o£
(
øndom
);

180 
domaö
 = 
	`ldns_d«me_√w_‰m_°r
(
¨gv
[0]);

183 
key
 = 
	`ldns_key_√w_‰m_Æg‹ôhm
(
Æg‹ôhm
, 
bôs
);

186 
	`ldns_key_£t_pubkey_ow√r
(
key
, 
domaö
);

189 i‡(
ksk
) {

190 
	`ldns_key_£t_Êags
(
key
, 
	`ldns_key_Êags
(key) + 1);

194 
pubkey
 = 
	`ldns_key2º
(
key
);

195 i‡(!
pubkey
) {

196 
	`Ârötf
(
°dîr
, "CouldÇotÉxtractÅheÖublic key fromÅhe key structure...");

197 
	`ldns_key_dìp_‰ì
(
key
);

198 
	`exô
(
EXIT_FAILURE
);

200 
ow√r
 = 
	`ldns_rdf2°r
(
	`ldns_º_ow√r
(
pubkey
));

203 
	`ldns_key_£t_keyèg
(
key
, 
	`ldns_ˇlc_keyèg
(
pubkey
));

206 
Æg‹ôhm
) {

207 #ifde‡
USE_ECDSA


208 
LDNS_SIGN_ECDSAP384SHA384
:

209 
ds
 = 
	`ldns_key_º2ds
(
pubkey
, 
LDNS_SHA384
);

211 
LDNS_SIGN_ECDSAP256SHA256
:

213 
LDNS_SIGN_RSASHA256
:

214 
LDNS_SIGN_RSASHA512
:

215 
ds
 = 
	`ldns_key_º2ds
(
pubkey
, 
LDNS_SHA256
);

217 
LDNS_SIGN_ECC_GOST
:

218 #ifde‡
USE_GOST


219 
ds
 = 
	`ldns_key_º2ds
(
pubkey
, 
LDNS_HASH_GOST
);

221 
ds
 = 
	`ldns_key_º2ds
(
pubkey
, 
LDNS_SHA256
);

225 
ds
 = 
	`ldns_key_º2ds
(
pubkey
, 
LDNS_SHA1
);

230 
fûíame
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
ow√r
) + 17);

231 
	`¢¥ötf
(
fûíame
, 
	`°æí
(
ow√r
Ë+ 16, "K%s+%03u+%05u.key", ow√r, 
Æg‹ôhm
, (Ë
	`ldns_key_keyèg
(
key
));

232 
fûe
 = 
	`f›í
(
fûíame
, "w");

233 i‡(!
fûe
) {

234 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

235 
	`ldns_key_dìp_‰ì
(
key
);

236 
	`‰ì
(
ow√r
);

237 
	`ldns_º_‰ì
(
pubkey
);

238 
	`ldns_º_‰ì
(
ds
);

239 
	`LDNS_FREE
(
fûíame
);

240 
	`exô
(
EXIT_FAILURE
);

243 
	`ldns_º_£t_que°i⁄
(
pubkey
, 
åue
);

244 
	`ldns_º_¥öt
(
fûe
, 
pubkey
);

245 
	`ldns_º_£t_que°i⁄
(
pubkey
, 
Ál£
);

246 
	`f˛o£
(
fûe
);

247 
	`LDNS_FREE
(
fûíame
);

251 
fûíame
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
ow√r
) + 21);

252 
	`¢¥ötf
(
fûíame
, 
	`°æí
(
ow√r
Ë+ 20, "K%s+%03u+%05u.¥iv©e", ow√r, 
Æg‹ôhm
, (Ë
	`ldns_key_keyèg
(
key
));

253 
fûe
 = 
	`f›í
(
fûíame
, "w");

254 i‡(!
fûe
) {

255 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

256 
	`ldns_key_dìp_‰ì
(
key
);

257 
	`‰ì
(
ow√r
);

258 
	`ldns_º_‰ì
(
pubkey
);

259 
	`ldns_º_‰ì
(
ds
);

260 
	`LDNS_FREE
(
fûíame
);

261 
	`exô
(
EXIT_FAILURE
);

263 
	`ldns_key_¥öt
(
fûe
, 
key
);

264 
	`f˛o£
(
fûe
);

265 
	`LDNS_FREE
(
fûíame
);

269 i‡(
Æg‹ôhm
 !
LDNS_SIGN_HMACMD5
 &&

270 
Æg‹ôhm
 !
LDNS_SIGN_HMACSHA1
 &&

271 
Æg‹ôhm
 !
LDNS_SIGN_HMACSHA256
) {

272 
fûíame
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
ow√r
) + 16);

273 
	`¢¥ötf
(
fûíame
, 
	`°æí
(
ow√r
Ë+ 15, "K%s+%03u+%05u.ds", ow√r, 
Æg‹ôhm
, (Ë
	`ldns_key_keyèg
(
key
));

274 
fûe
 = 
	`f›í
(
fûíame
, "w");

275 i‡(!
fûe
) {

276 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

277 
	`ldns_key_dìp_‰ì
(
key
);

278 
	`‰ì
(
ow√r
);

279 
	`ldns_º_‰ì
(
pubkey
);

280 
	`ldns_º_‰ì
(
ds
);

281 
	`LDNS_FREE
(
fûíame
);

282 
	`exô
(
EXIT_FAILURE
);

285 
	`ldns_º_£t_que°i⁄
(
ds
, 
åue
);

286 
	`ldns_º_¥öt
(
fûe
, 
ds
);

287 
	`ldns_º_£t_que°i⁄
(
ds
, 
Ál£
);

288 
	`f˛o£
(
fûe
);

289 
	`LDNS_FREE
(
fûíame
);

293 
	`Ârötf
(
°dout
, "K%s+%03u+%05u\n", 
ow√r
, 
Æg‹ôhm
, (Ë
	`ldns_key_keyèg
(
key
));

294 
	`ldns_key_dìp_‰ì
(
key
);

295 
	`‰ì
(
ow√r
);

296 
	`ldns_º_‰ì
(
pubkey
);

297 
	`ldns_º_‰ì
(
ds
);

298 
	`exô
(
EXIT_SUCCESS
);

299 
	}
}

302 
	$maö
(
¨gc
, **
¨gv
)

304 
	`Ârötf
(
°dîr
, "ldns-keygenÇeeds OpenSSL support, which hasÇot been compiled in\n");

306 
	}
}

	@examples/ldns-mx.c

8 
	~"c⁄fig.h
"

10 
	~<ldns/ldns.h
>

13 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

14 
	`Ârötf
(
Â
, "%†domaö\n", 
¥og
);

15 
	`Ârötf
(
Â
, "Örint outÅhe mx for domain\n");

17 
	}
}

20 
	$maö
(
¨gc
, *
¨gv
[])

22 
ldns_ªsﬁvî
 *
ªs
;

23 
ldns_rdf
 *
domaö
;

24 
ldns_pkt
 *
p
;

25 
ldns_º_li°
 *
mx
;

26 
ldns_°©us
 
s
;

28 
p
 = 
NULL
;

29 
mx
 = 
NULL
;

30 
domaö
 = 
NULL
;

31 
ªs
 = 
NULL
;

33 i‡(
¨gc
 != 2) {

34 
	`ußge
(
°dout
, 
¨gv
[0]);

35 
	`exô
(
EXIT_FAILURE
);

38 
domaö
 = 
	`ldns_d«me_√w_‰m_°r
(
¨gv
[1]);

39 i‡(!
domaö
) {

40 
	`ußge
(
°dout
, 
¨gv
[0]);

41 
	`exô
(
EXIT_FAILURE
);

46 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
ªs
, 
NULL
);

48 i‡(
s
 !
LDNS_STATUS_OK
) {

49 
	`exô
(
EXIT_FAILURE
);

55 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
,

56 
domaö
,

57 
LDNS_RR_TYPE_MX
,

58 
LDNS_RR_CLASS_IN
,

59 
LDNS_RD
);

61 
	`ldns_rdf_dìp_‰ì
(
domaö
);

63 i‡(!
p
) {

64 
	`exô
(
EXIT_FAILURE
);

69 
mx
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
,

70 
LDNS_RR_TYPE_MX
,

71 
LDNS_SECTION_ANSWER
);

72 i‡(!
mx
) {

73 
	`Ârötf
(
°dîr
,

75 
¨gv
[1],árgv[1]);

76 
	`ldns_pkt_‰ì
(
p
);

77 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

78 
	`exô
(
EXIT_FAILURE
);

80 
	`ldns_º_li°_s‹t
(
mx
);

81 
	`ldns_º_li°_¥öt
(
°dout
, 
mx
);

82 
	`ldns_º_li°_dìp_‰ì
(
mx
);

85 
	`ldns_pkt_‰ì
(
p
);

86 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

88 
	}
}

	@examples/ldns-notify.c

11 
	~"c⁄fig.h
"

14 
	~<ldns/ldns.h
>

16 #ifde‡
HAVE_NETDB_H


17 
	~<√tdb.h
>

19 
	~<î∫o.h
>

21 
	gvîbo£
 = 1;

22 
	gmax_num_ªåy
 = 15;

25 
	$ußge
()

27 
	`Ârötf
(
°dîr
, "usage:Üdns-notify [other options] -z zone <servers>\n");

28 
	`Ârötf
(
°dîr
, "LdnsÇotify utility\n\n");

29 
	`Ârötf
(
°dîr
, " Supported options:\n");

30 
	`Ârötf
(
°dîr
, "\t-z zone\t\tThe zone\n");

31 
	`Ârötf
(
°dîr
, "\t-s version\tSOA versionÇumberÅo include\n");

32 
	`Ârötf
(
°dîr
, "\t-y key:data\tTSIG signÅhe query\n");

33 
	`Ârötf
(
°dîr
, "\t-pÖort\t\tportÅo useÅo sendÅo\n");

34 
	`Ârötf
(
°dîr
, "\t-v\t\tPrint version information\n");

35 
	`Ârötf
(
°dîr
, "\t-d\t\tPrint verbose debug information\n");

36 
	`Ârötf
(
°dîr
, "\t-rÇum\t\tmaxÇumber ofÑetries (%d)\n",

37 
max_num_ªåy
);

38 
	`Ârötf
(
°dîr
, "\t-h\t\tPrintÅhis help information\n\n");

39 
	`Ârötf
(
°dîr
, "Report bugsÅo <ldns-team@nlnetlabs.nl>\n");

40 
	`exô
(1);

41 
	}
}

44 
	$vîsi⁄
()

46 
	`Ârötf
(
°dîr
, "%†vîsi⁄ %s\n", 
PACKAGE_NAME
, 
PACKAGE_VERSION
);

47 
	`Ârötf
(
°dîr
, "Written by NLnet Labs.\n\n");

48 
	`Ârötf
(
°dîr
,

52 
	`exô
(0);

53 
	}
}

56 
	$nŸify_ho°
(
s
, 
addröfo
* 
ªs
, 
uöt8_t
* 
wúe
, 
size_t
 
wúesize
,

57 c⁄° * 
addr°r
)

59 
timeout_ªåy
 = 5;

60 
num_ªåy
 = 
max_num_ªåy
;

61 #i‚de‡
S_SPLINT_S


62 
fd_£t
 
rfds
;

64 
timevÆ
 
tv
;

65 
ªtvÆ
 = 0;

66 
ssize_t
 
ª˚ived
 = 0;

67 
gŸ_ack
 = 0;

68 
sockÀn_t
 
addæí
 = 0;

69 
uöt8_t
 
ª∂ybuf
[2048];

70 
ldns_°©us
 
°©us
;

71 
ldns_pkt
* 
pkt
 = 
NULL
;

73 !
gŸ_ack
) {

75 if(
	`£ndto
(
s
, (*)
wúe
, 
wúesize
, 0,

76 
ªs
->
ai_addr
,Ñes->
ai_addæí
) == -1) {

77 
	`¥ötf
("warning: sendÅo %s failed: %s\n",

78 
addr°r
, 
	`°ªº‹
(
î∫o
));

79 #i‚de‡
USE_WINSOCK


80 
	`˛o£
(
s
);

82 
	`˛o£sockë
(
s
);

88 #i‚de‡
S_SPLINT_S


89 
	`FD_ZERO
(&
rfds
);

90 
	`FD_SET
(
s
, &
rfds
);

91 
tv
.
tv_£c
 = 
timeout_ªåy
;

93 
tv
.
tv_u£c
 = 0;

94 
ªtvÆ
 = 
	`£À˘
(
s
 + 1, &
rfds
, 
NULL
, NULL, &
tv
);

95 i‡(
ªtvÆ
 == -1) {

96 
	`¥ötf
("error waiting forÑeply from %s: %s\n",

97 
addr°r
, 
	`°ªº‹
(
î∫o
));

98 #i‚de‡
USE_WINSOCK


99 
	`˛o£
(
s
);

101 
	`˛o£sockë
(
s
);

105 if(
ªtvÆ
 == 0) {

106 
num_ªåy
--;

107 if(
num_ªåy
 == 0) {

108 
	`¥ötf
("error: failedÅo sendÇotifyÅo %s.\n",

109 
addr°r
);

110 
	`exô
(1);

112 
	`¥ötf
("timeout (%d s)Éxpired,ÑetryÇotifyÅo %s.\n",

113 
timeout_ªåy
, 
addr°r
);

115 i‡(
ªtvÆ
 == 1) {

116 
gŸ_ack
 = 1;

121 
addæí
 = 
ªs
->
ai_addæí
;

122 
ª˚ived
 = 
	`ªcv‰om
(
s
, (*)
ª∂ybuf
, (replybuf), 0,

123 
ªs
->
ai_addr
, &
addæí
);

124 
ªs
->
ai_addæí
 = 
addæí
;

126 #i‚de‡
USE_WINSOCK


127 
	`˛o£
(
s
);

129 
	`˛o£sockë
(
s
);

131 i‡(
ª˚ived
 == -1) {

132 
	`¥ötf
("ªcv %†Áûed: %s\n", 
addr°r
, 
	`°ªº‹
(
î∫o
));

137 
°©us
 = 
	`ldns_wúe2pkt
(&
pkt
, 
ª∂ybuf
, (
size_t
)
ª˚ived
);

138 if(
°©us
 !
LDNS_STATUS_OK
) {

139 
ssize_t
 
i
;

140 
	`¥ötf
("CouldÇotÖarseÑeplyÖacket: %s\n",

141 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

142 i‡(
vîbo£
 > 1) {

143 
	`¥ötf
("hexdump ofÑeply: ");

144 
i
=0; i<
ª˚ived
; i++)

145 
	`¥ötf
("%02x", ()
ª∂ybuf
[
i
]);

146 
	`¥ötf
("\n");

148 
	`exô
(1);

151 if(
vîbo£
) {

152 
ssize_t
 
i
;

153 
	`¥ötf
("#Ñïly from %s:\n", 
addr°r
);

154 
	`ldns_pkt_¥öt
(
°dout
, 
pkt
);

155 i‡(
vîbo£
 > 1) {

156 
	`¥ötf
("hexdump ofÑeply: ");

157 
i
=0; i<
ª˚ived
; i++)

158 
	`¥ötf
("%02x", ()
ª∂ybuf
[
i
]);

159 
	`¥ötf
("\n");

162 
	`ldns_pkt_‰ì
(
pkt
);

163 
	}
}

166 
	$maö
(
¨gc
, **
¨gv
)

168 
c
;

169 
i
;

172 
ldns_pkt
 *
nŸify
;

173 
ldns_º
 *
que°i⁄
;

174 
ldns_ªsﬁvî
 *
ªs
;

175 
ldns_rdf
 *
ldns_z⁄e_«me
 = 
NULL
;

176 
ldns_°©us
 
°©us
;

177 c⁄° *
z⁄e_«me
 = 
NULL
;

178 
ö˛ude_sﬂ
 = 0;

179 
uöt32_t
 
sﬂ_vîsi⁄
 = 0;

180 
ldns_tsig_¸edítüls
 
tsig_¸ed
 = {0,0,0};

181 
do_hexdump
 = 1;

182 
uöt8_t
 *
wúe
 = 
NULL
;

183 
size_t
 
wúesize
 = 0;

184 c⁄° *
p‹t
 = "53";

186 
	`§™dom
(
	`time
(
NULL
Ë^ 
	`gëpid
());

188 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "vhdp:r:s:y:z:")) != -1) {

189 
c
) {

191 
vîbo£
++;

194 
p‹t
 = 
›èrg
;

197 
max_num_ªåy
 = 
	`©oi
(
›èrg
);

200 
ö˛ude_sﬂ
 = 1;

201 
sﬂ_vîsi⁄
 = (
uöt32_t
)
	`©oi
(
›èrg
);

204 
tsig_¸ed
.
Æg‹ôhm
 = (*)"hmac-md5.sig-alg.reg.int.";

205 
tsig_¸ed
.
key«me
 = 
›èrg
;

206 
tsig_¸ed
.
keyd©a
 = 
	`°rchr
(
›èrg
, ':');

207 i‡(
tsig_¸ed
.
keyd©a
 =
NULL
) {

208 
	`¥ötf
("TSIGárgument isÇot in form "

209 "key:d©a: %s\n", 
›èrg
);

210 
	`exô
(1);

212 *
tsig_¸ed
.
keyd©a
 = '\0';

213 
tsig_¸ed
.
keyd©a
++;

214 
	`¥ötf
("Sig¿wôh %†: %s\n", 
tsig_¸ed
.
key«me
,

215 
tsig_¸ed
.
keyd©a
);

218 
z⁄e_«me
 = 
›èrg
;

219 
ldns_z⁄e_«me
 = 
	`ldns_d«me_√w_‰m_°r
(
z⁄e_«me
);

220 if(!
ldns_z⁄e_«me
) {

221 
	`¥ötf
("cannotÖarse zoneÇame: %s\n",

222 
z⁄e_«me
);

223 
	`exô
(1);

227 
	`vîsi⁄
();

231 
	`ußge
();

234 
¨gc
 -
›töd
;

235 
¨gv
 +
›töd
;

237 i‡(
¨gc
 =0 || 
z⁄e_«me
 =
NULL
) {

238 
	`ußge
();

241 
nŸify
 = 
	`ldns_pkt_√w
();

242 
que°i⁄
 = 
	`ldns_º_√w
();

243 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

245 i‡(!
nŸify
 || !
que°i⁄
 || !
ªs
) {

247 
	`¥ötf
("error: cannot createÜdnsÅypes\n");

248 
	`exô
(1);

252 
	`ldns_º_£t_˛ass
(
que°i⁄
, 
LDNS_RR_CLASS_IN
);

253 
	`ldns_º_£t_ow√r
(
que°i⁄
, 
ldns_z⁄e_«me
);

254 
	`ldns_º_£t_ty≥
(
que°i⁄
, 
LDNS_RR_TYPE_SOA
);

255 
	`ldns_pkt_£t_›code
(
nŸify
, 
LDNS_PACKET_NOTIFY
);

256 
	`ldns_pkt_push_º
(
nŸify
, 
LDNS_SECTION_QUESTION
, 
que°i⁄
);

257 
	`ldns_pkt_£t_Ø
(
nŸify
, 
åue
);

258 
	`ldns_pkt_£t_øndom_id
(
nŸify
);

259 if(
ö˛ude_sﬂ
) {

260 
buf
[10240];

261 
ldns_º
 *
sﬂ_º
=
NULL
;

262 
ldns_rdf
 *
¥ev
=
NULL
;

263 
	`¢¥ötf
(
buf
, (buf), "%s 3600 IN SOA . . %u 0 0 0 0",

264 
z⁄e_«me
, ()
sﬂ_vîsi⁄
);

266 
°©us
 = 
	`ldns_º_√w_‰m_°r
(&
sﬂ_º
, 
buf
, 3600, 
NULL
, &
¥ev
);

267 if(
°©us
 !
LDNS_STATUS_OK
) {

268 
	`¥ötf
("Errorádding SOA version: %s\n",

269 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

271 
	`ldns_pkt_push_º
(
nŸify
, 
LDNS_SECTION_ANSWER
, 
sﬂ_º
);

274 if(
tsig_¸ed
.
key«me
) {

275 #ifde‡
HAVE_SSL


276 
°©us
 = 
	`ldns_pkt_tsig_sign
(
nŸify
, 
tsig_¸ed
.
key«me
,

277 
tsig_¸ed
.
keyd©a
, 300,Åsig_¸ed.
Æg‹ôhm
,

278 
NULL
);

279 if(
°©us
 !
LDNS_STATUS_OK
) {

280 
	`¥ötf
("Error TSIG sign query: %s\n",

281 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

284 
	`Ârötf
(
°dîr
, "Warning: TSIGÇeeds OpenSSL support, which hasÇot been compiled in, TSIG skipped\n");

288 if(
vîbo£
) {

289 
	`¥ötf
("# SendingÖacket:\n");

290 
	`ldns_pkt_¥öt
(
°dout
, 
nŸify
);

294 
°©us
 = 
	`ldns_pkt2wúe
(&
wúe
, 
nŸify
, &
wúesize
);

295 if(
wúesize
 == 0) {

296 
	`¥ötf
("Error convertingÇotifyÖacketÅo hex.\n");

297 
	`exô
(1);

300 if(
do_hexdump
 && 
vîbo£
 > 1) {

301 
	`¥ötf
("Hexdump ofÇotifyÖacket:\n");

302 
i
=0; i<()
wúesize
; i++)

303 
	`¥ötf
("%02x", ()
wúe
[
i
]);

304 
	`¥ötf
("\n");

307 
i
=0; i<
¨gc
; i++)

309 
addröfo
 
höts
, *
ªs0
, *
ªs
;

310 
îr‹
;

311 
deÁu…_Ámûy
 = 
AF_INET
;

313 if(
vîbo£
)

314 
	`¥ötf
("# sídögÅÿ%s\n", 
¨gv
[
i
]);

315 
	`mem£t
(&
höts
, 0, (hints));

316 
höts
.
ai_Ámûy
 = 
deÁu…_Ámûy
;

317 
höts
.
ai_sockty≥
 = 
SOCK_DGRAM
;

318 
höts
.
ai_¥Ÿocﬁ
 = 
IPPROTO_UDP
;

319 
îr‹
 = 
	`gëaddröfo
(
¨gv
[
i
], 
p‹t
, &
höts
, &
ªs0
);

320 i‡(
îr‹
) {

321 
	`¥ötf
("skùpög badáddªss: %s: %s\n", 
¨gv
[
i
],

322 
	`gai_°ªº‹
(
îr‹
));

325 
ªs
 = 
ªs0
;Ñes;Ñe†ªs->
ai_√xt
) {

326 
s
 = 
	`sockë
(
ªs
->
ai_Ámûy
,Ñes->
ai_sockty≥
,

327 
ªs
->
ai_¥Ÿocﬁ
);

328 if(
s
 == -1)

331 
	`nŸify_ho°
(
s
, 
ªs
, 
wúe
, 
wúesize
, 
¨gv
[
i
]);

333 
	`‰ìaddröfo
(
ªs0
);

336 
	`ldns_pkt_‰ì
(
nŸify
);

337 
	`‰ì
(
wúe
);

339 
	}
}

	@examples/ldns-nsec3-hash.c

8 
	~"c⁄fig.h
"

9 
	~<°dlib.h
>

10 
	~<uni°d.h
>

12 
	~<î∫o.h
>

14 
	~<time.h
>

16 
	~<ldns/ldns.h
>

17 
	~<ldns/keys.h
>

19 #ifde‡
HAVE_SSL


20 
	~<›ís¶/c⁄f.h
>

21 
	~<›ís¶/ígöe.h
>

24 
	#MAX_FILENAME_LEN
 250

	)

25 
	gvîbosôy
 = 1;

28 
	$ußge
(
FILE
 *
Â
, c⁄° *
¥og
) {

29 
	`Ârötf
(
Â
, "%†[OPTIONS] <domaöÇame>\n", 
¥og
);

30 
	`Ârötf
(
Â
, "ÖrintsÅhe NSEC3 hash ofÅhe given domainÇame\n");

31 
	`Ârötf
(
Â
, "-a [algorithm] hashingálgorithm\n");

32 
	`Ârötf
(
Â
, "-t [number]Çumber of hash iterations\n");

33 
	`Ârötf
(
Â
, "-s [string] salt\n");

34 
	}
}

37 
	$maö
(
¨gc
, *
¨gv
[])

39 
ldns_rdf
 *
d«me
, *
hashed_d«me
;

40 
uöt8_t
 
n£c3_Æg‹ôhm
 = 1;

41 
size_t
 
n£c3_ôî©i⁄s_cmd
 = 1;

42 
uöt16_t
 
n£c3_ôî©i⁄s
 = 1;

43 
uöt8_t
 
n£c3_ß…_Àngth
 = 0;

44 
uöt8_t
 *
n£c3_ß…
 = 
NULL
;

46 *
¥og
 = 
	`°rdup
(
¨gv
[0]);

48 
c
;

49 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "a:s:t:")) != -1) {

50 
c
) {

52 
n£c3_Æg‹ôhm
 = (
uöt8_t
Ë
	`©oi
(
›èrg
);

55 i‡(
	`°æí
(
›èrg
) % 2 != 0) {

56 
	`Ârötf
(
°dîr
, "Salt value isÇot valid hex data,Çotá multiple of 2 characters\n");

57 
	`exô
(
EXIT_FAILURE
);

59 i‡(
	`°æí
(
›èrg
) > 512) {

60 
	`Ârötf
(
°dîr
, "SaltÅooÜong\n");

61 
	`exô
(
EXIT_FAILURE
);

63 
n£c3_ß…_Àngth
 = (
uöt8_t
Ë(
	`°æí
(
›èrg
) / 2);

64 
n£c3_ß…
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
n£c3_ß…_Àngth
);

65 
c
 = 0; c < (Ë
	`°æí
(
›èrg
); c += 2) {

66 i‡(
	`isxdigô
((Ë
›èrg
[
c
]) && isxdigit(() optarg[c+1])) {

67 
n£c3_ß…
[
c
/2] = (
uöt8_t
Ë
	`ldns_hexdigô_to_öt
(
›èrg
[c]) * 16 +

68 
	`ldns_hexdigô_to_öt
(
›èrg
[
c
+1]);

70 
	`Ârötf
(
°dîr
, "Salt value isÇot valid hex data.\n");

71 
	`exô
(
EXIT_FAILURE
);

77 
n£c3_ôî©i⁄s_cmd
 = (
size_t
Ë
	`©ﬁ
(
›èrg
);

78 i‡(
n£c3_ôî©i⁄s_cmd
 > 
LDNS_NSEC3_MAX_ITERATIONS
) {

79 
	`Ârötf
(
°dîr
, "Iãøti⁄†cou¡ c™ÇŸÉx˚ed %u, quôtög\n", 
LDNS_NSEC3_MAX_ITERATIONS
);

80 
	`exô
(
EXIT_FAILURE
);

82 
n£c3_ôî©i⁄s
 = (
uöt16_t
Ë
n£c3_ôî©i⁄s_cmd
;

85 
	`ußge
(
°dîr
, 
¥og
);

86 
	`exô
(
EXIT_SUCCESS
);

90 
¨gc
 -
›töd
;

91 
¨gv
 +
›töd
;

93 i‡(
¨gc
 < 1) {

94 
	`¥ötf
("Error:ÇotÉnoughárguments\n");

95 
	`ußge
(
°dout
, 
¥og
);

96 
	`exô
(
EXIT_FAILURE
);

98 
d«me
 = 
	`ldns_d«me_√w_‰m_°r
(
¨gv
[0]);

99 i‡(!
d«me
) {

100 
	`Ârötf
(
°dîr
,

102  
EXIT_FAILURE
;

104 
hashed_d«me
 = 
	`ldns_n£c3_hash_«me
(
d«me
,

105 
n£c3_Æg‹ôhm
,

106 
n£c3_ôî©i⁄s
,

107 
n£c3_ß…_Àngth
,

108 
n£c3_ß…
);

109 i‡(!
hashed_d«me
) {

110 
	`Ârötf
(
°dîr
,

112  
EXIT_FAILURE
;

114 
	`ldns_rdf_¥öt
(
°dout
, 
hashed_d«me
);

115 
	`¥ötf
("\n");

116 
	`ldns_rdf_dìp_‰ì
(
d«me
);

117 
	`ldns_rdf_dìp_‰ì
(
hashed_d«me
);

120 i‡(
n£c3_ß…
) {

121 
	`‰ì
(
n£c3_ß…
);

124 
	`‰ì
(
¥og
);

126  
EXIT_SUCCESS
;

127 
	}
}

	@examples/ldns-read-zone.c

9 
	~"c⁄fig.h
"

10 
	~<uni°d.h
>

11 
	~<°dlib.h
>

13 
	~<ldns/ldns.h
>

14 
	~<ldns/ho°2°r.h
>

16 
	~<î∫o.h
>

18 
	$¥öt_ußge
(c⁄° * 
¥og«me
)

20 
	`¥ötf
("Ußge: %†[OPTIONS] <z⁄efûe>\n", 
¥og«me
);

21 
	`¥ötf
("\tReadsÅhe zonefileándÖrints it.\n");

22 
	`¥ötf
("\tThe RR count ofÅhe zone isÖrintedÅo stderr.\n");

23 
	`¥ötf
("\t-b include Bubble BabbleÉncoding of DS's.\n");

24 
	`¥ötf
("\t-0 zeroizeÅimestampsánd signature in RRSIGÑecords.\n");

25 
	`¥ötf
("\t-c canonicalizeállÑrs inÅhe zone.\n");

26 
	`¥ötf
("\t-d only show DNSSEC data fromÅhe zone\n");

27 
	`¥ötf
("\t-h showÅhisÅext\n");

28 
	`¥ötf
("\t-n doÇotÖrintÅhe SOAÑecord\n");

29 
	`¥ötf
("\t-pÖrepend SOA serial with spaces so"

31 
	`¥ötf
("\t-s strip DNSSEC data fromÅhe zone\n");

32 
	`¥ötf
("\t-S [[+|-]<number> | YYYYMMDDxx | "

44 
	`¥ötf
("\t-u <rrÅype>\n");

45 
	`¥ötf
("\t\tMark <rrÅype> forÖrinting in unknownÅype format.\n");

46 
	`¥ötf
("\t\tThis option may be given multipleÅimes.\n");

47 
	`¥ötf
("\t\t-u isÇot meantÅo be usedÅogether with -U.\n");

48 
	`¥ötf
("\t-U <rrÅype>\n");

49 
	`¥ötf
("\t\tMark <rrÅype> forÇotÖrinting in unknownÅype format.\n");

50 
	`¥ötf
("\t\tThis option may be given multipleÅimes.\n");

51 
	`¥ötf
(

57 
	`¥ötf
("\t\t-U isÇot meantÅo be usedÅogether with -u.\n");

58 
	`¥ötf
("\t-v showsÅhe versionándÉxits\n");

59 
	`¥ötf
("\t-z sortÅhe zone (implies -c).\n");

60 
	`¥ötf
("\nifÇo file is given standard input isÑead\n");

61 
	`exô
(
EXIT_SUCCESS
);

62 
	}
}

65 
	$maö
(
¨gc
, **
¨gv
)

67 *
fûíame
;

68 
FILE
 *
Â
;

69 
ldns_z⁄e
 *
z
;

70 
löe_ƒ
 = 0;

71 
c
;

72 
boﬁ
 
ˇn⁄iˇlize
 = 
Ál£
;

73 
boﬁ
 
s‹t
 = 
Ál£
;

74 
boﬁ
 
°rù
 = 
Ál£
;

75 
boﬁ
 
⁄ly_dns£c
 = 
Ál£
;

76 
boﬁ
 
¥öt_sﬂ
 = 
åue
;

77 
ldns_°©us
 
s
;

78 
size_t
 
i
;

79 
ldns_º_li°
 *
°rù≥d_li°
;

80 
ldns_º
 *
cur_º
;

81 
ldns_º_ty≥
 
cur_º_ty≥
;

82 
ldns_ouçut_f‹m©_°‹age
 
fmt_°‹age
;

83 
ldns_ouçut_f‹m©
* 
fmt
 = 
	`ldns_ouçut_f‹m©_öô
(&
fmt_°‹age
);

85 
ldns_sﬂ_£rül_ö¸emít_func_t
 
sﬂ_£rül_ö¸emít_func
 = 
NULL
;

86 
sﬂ_£rül_ö¸emít_func_d©a
 = 0;

88 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "0bcdhnpsu:U:vzS:")) != -1) {

89 
c
) {

91 
fmt
->
Êags
 |=

92 –
LDNS_COMMENT_BUBBLEBABBLE
 |

93 
LDNS_COMMENT_FLAGS
 );

96 
fmt
->
Êags
 |
LDNS_FMT_ZEROIZE_RRSIGS
;

99 
ˇn⁄iˇlize
 = 
åue
;

102 
⁄ly_dns£c
 = 
åue
;

103 i‡(
°rù
) {

104 
	`Ârötf
(
°dîr
, "Warning: stripping both DNSSECándÇon-DNSSECÑecords. Output will be sparse.\n");

108 
	`¥öt_ußge
("ldns-read-zone");

111 
¥öt_sﬂ
 = 
Ál£
;

114 
fmt
->
Êags
 |
LDNS_FMT_PAD_SOA_SERIAL
;

117 
°rù
 = 
åue
;

118 i‡(
⁄ly_dns£c
) {

119 
	`Ârötf
(
°dîr
, "Warning: stripping both DNSSECándÇon-DNSSECÑecords. Output will be sparse.\n");

123 
s
 = 
	`ldns_ouçut_f‹m©_£t_ty≥
(
fmt
,

124 
	`ldns_gë_º_ty≥_by_«me
(
›èrg
));

125 i‡(
s
 !
LDNS_STATUS_OK
) {

126 
	`Ârötf
–
°dîr


130 , 
	`ldns_º_des¸ùt
(

131 
	`ldns_gë_º_ty≥_by_«me
(
›èrg
)

132 )->
_«me


133 , 
	`ldns_gë_îr‹°r_by_id
(
s
)

135 
	`exô
(
EXIT_FAILURE
);

139 
s
 = 
	`ldns_ouçut_f‹m©_˛ór_ty≥
(
fmt
,

140 
	`ldns_gë_º_ty≥_by_«me
(
›èrg
));

141 i‡(
s
 !
LDNS_STATUS_OK
) {

142 
	`Ârötf
–
°dîr


146 , 
	`ldns_º_des¸ùt
(

147 
	`ldns_gë_º_ty≥_by_«me
(
›èrg
)

148 )->
_«me


149 , 
	`ldns_gë_îr‹°r_by_id
(
s
)

151 
	`exô
(
EXIT_FAILURE
);

155 
	`¥ötf
("ªad z⁄êvîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

156 
	`exô
(
EXIT_SUCCESS
);

159 
ˇn⁄iˇlize
 = 
åue
;

160 
s‹t
 = 
åue
;

163 
°rù
 = 
åue
;

164 i‡(*
›èrg
 == '+' || *optarg == '-') {

165 
sﬂ_£rül_ö¸emít_func_d©a
 =

166 
	`©oi
(
›èrg
);

167 
sﬂ_£rül_ö¸emít_func
 =

168 
ldns_sﬂ_£rül_ö¸emít_by
;

169 } i‡(! 
	`°πok
(
›èrg
, "0123456789")) {

170 
sﬂ_£rül_ö¸emít_func_d©a
 =

171 
	`©oi
(
›èrg
);

172 
sﬂ_£rül_ö¸emít_func
 =

173 
ldns_sﬂ_£rül_idítôy
;

174 } i‡(!
	`°rˇ£cmp
(
›èrg
, "YYYYMMDDxx")){

175 
sﬂ_£rül_ö¸emít_func
 =

176 
ldns_sﬂ_£rül_d©ecou¡î
;

177 } i‡(!
	`°rˇ£cmp
(
›èrg
, "unixtime")){

178 
sﬂ_£rül_ö¸emít_func
 =

179 
ldns_sﬂ_£rül_unixtime
;

181 
	`Ârötf
(
°dîr
, "-SÉxpectsáÇumber "

186 
	`exô
(
EXIT_FAILURE
);

192 
¨gc
 -
›töd
;

193 
¨gv
 +
›töd
;

195 i‡(
¨gc
 == 0) {

196 
Â
 = 
°dö
;

198 
fûíame
 = 
¨gv
[0];

200 
Â
 = 
	`f›í
(
fûíame
, "r");

201 i‡(!
Â
) {

202 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

203 
	`exô
(
EXIT_FAILURE
);

207 
s
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z
, 
Â
, 
NULL
, 0, 
LDNS_RR_CLASS_IN
, &
löe_ƒ
);

209 
	`f˛o£
(
Â
);

210 i‡(
s
 !
LDNS_STATUS_OK
) {

211 
	`Ârötf
(
°dîr
, "%sát %d\n",

212 
	`ldns_gë_îr‹°r_by_id
(
s
),

213 
löe_ƒ
);

214 
	`exô
(
EXIT_FAILURE
);

218 i‡(
°rù
) {

219 
°rù≥d_li°
 = 
	`ldns_º_li°_√w
();

220 (
cur_º
 = 
	`ldns_º_li°_p›_º
(
	`ldns_z⁄e_ºs
(
z
)))) {

221 
cur_º_ty≥
 = 
	`ldns_º_gë_ty≥
(
cur_º
);

222 i‡(
cur_º_ty≥
 =
LDNS_RR_TYPE_RRSIG
 ||

223 
cur_º_ty≥
 =
LDNS_RR_TYPE_NSEC
 ||

224 
cur_º_ty≥
 =
LDNS_RR_TYPE_NSEC3
 ||

225 
cur_º_ty≥
 =
LDNS_RR_TYPE_NSEC3PARAM


227 
	`ldns_º_‰ì
(
cur_º
);

229 
	`ldns_º_li°_push_º
(
°rù≥d_li°
, 
cur_º
);

232 
	`ldns_º_li°_‰ì
(
	`ldns_z⁄e_ºs
(
z
));

233 
	`ldns_z⁄e_£t_ºs
(
z
, 
°rù≥d_li°
);

235 i‡(
⁄ly_dns£c
) {

236 
°rù≥d_li°
 = 
	`ldns_º_li°_√w
();

237 (
cur_º
 = 
	`ldns_º_li°_p›_º
(
	`ldns_z⁄e_ºs
(
z
)))) {

238 
cur_º_ty≥
 = 
	`ldns_º_gë_ty≥
(
cur_º
);

239 i‡(
cur_º_ty≥
 =
LDNS_RR_TYPE_RRSIG
 ||

240 
cur_º_ty≥
 =
LDNS_RR_TYPE_NSEC
 ||

241 
cur_º_ty≥
 =
LDNS_RR_TYPE_NSEC3
 ||

242 
cur_º_ty≥
 =
LDNS_RR_TYPE_NSEC3PARAM


244 
	`ldns_º_li°_push_º
(
°rù≥d_li°
, 
cur_º
);

246 
	`ldns_º_‰ì
(
cur_º
);

249 
	`ldns_º_li°_‰ì
(
	`ldns_z⁄e_ºs
(
z
));

250 
	`ldns_z⁄e_£t_ºs
(
z
, 
°rù≥d_li°
);

253 i‡(
ˇn⁄iˇlize
) {

254 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_z⁄e_sﬂ
(
z
));

255 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z
)); i++) {

256 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z
), 
i
));

259 i‡(
s‹t
) {

260 
	`ldns_z⁄e_s‹t
(
z
);

263 i‡(
¥öt_sﬂ
 && 
	`ldns_z⁄e_sﬂ
(
z
)) {

264 i‡(
sﬂ_£rül_ö¸emít_func
) {

265 
	`ldns_º_sﬂ_ö¸emít_func_öt
(

266 
	`ldns_z⁄e_sﬂ
(
z
)

267 , 
sﬂ_£rül_ö¸emít_func


268 , 
sﬂ_£rül_ö¸emít_func_d©a


271 
	`ldns_º_¥öt_fmt
(
°dout
, 
fmt
, 
	`ldns_z⁄e_sﬂ
(
z
));

273 
	`ldns_º_li°_¥öt_fmt
(
°dout
, 
fmt
, 
	`ldns_z⁄e_ºs
(
z
));

275 
	`ldns_z⁄e_dìp_‰ì
(
z
);

277 
	`exô
(
EXIT_SUCCESS
);

278 
	}
}

	@examples/ldns-resolver.c

9 
	~"c⁄fig.h
"

10 
	~"î∫o.h
"

12 
	~<ldns/ldns.h
>

15 
	$maö
(
¨gc
, **
¨gv
) {

17 
ldns_ªsﬁvî
 *
r
;

18 
löe
 = 1;

19 
FILE
 *
ønd
;

20 
ldns_°©us
 
s
;

22 i‡(
¨gc
 !2 || 
	`°∫cmp
(
¨gv
[1], "-h", 3) == 0) {

23 
	`¥ötf
("Usage:Üdns-resolver <file>\n");

24 
	`¥ötf
("TriesÅo createá stubÑesolver structure fromÅhe given file.\n");

25 
	`exô
(
EXIT_FAILURE
);

28 i‡(!(
ønd
 = 
	`f›í
(
¨gv
[1], "r"))) {

29 
	`¥ötf
("Eº‹ o≥nög %s: %s\n", 
¨gv
[1], 
	`°ªº‹
(
î∫o
));

30 
	`exô
(
EXIT_FAILURE
);

33 
	`¥ötf
("TryögÅÿªad from %s\n", 
¨gv
[1]);

34 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_Â_l
(&
r
, 
ønd
, &
löe
);

35 i‡(
s
 !
LDNS_STATUS_OK
) {

36 
	`¥ötf
("Faûed: %†©Üöê%d\n", 
	`ldns_gë_îr‹°r_by_id
(
s
), 
löe
);

37 
	`exô
(
EXIT_FAILURE
);

39 
	`¥ötf
("Succes\n");

40 
	`ldns_ªsﬁvî_¥öt
(
°dout
, 
r
);

41 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

44 
	`f˛o£
(
ønd
);

46  
EXIT_SUCCESS
;

47 
	}
}

	@examples/ldns-revoke.c

8 
	~"c⁄fig.h
"

10 
	~<ldns/ldns.h
>

11 #ifde‡
HAVE_SSL


12 
	~<›ís¶/s¶.h
>

15 
	~<î∫o.h
>

18 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

19 
	`Ârötf
(
Â
, "%†[-n] keyfûe\n", 
¥og
);

20 
	`Ârötf
(
Â
, " Revokesá key\n");

21 
	`Ârötf
(
Â
, "Options:\n");

22 
	`Ârötf
(
Â
, " -n: doÇot writeÅo file butÅo stdout\n");

23 
	}
}

26 
	$maö
(
¨gc
, *
¨gv
[])

28 
FILE
 *
keyÂ
;

29 *
key«me
;

30 
ldns_º
 *
k
;

31 
uöt16_t
 
Êags
;

32 *
¥ogøm
 = 
¨gv
[0];

33 
nofûe
 = 0;

34 
ldns_rdf
 *
‹igö
 = 
NULL
;

35 
ldns_°©us
 
ªsu…
;

37 
¨gv
++, 
¨gc
--;

38 
¨gc
 && 
¨gv
[0][0] == '-') {

39 i‡(
	`°rcmp
(
¨gv
[0], "-n") == 0) {

40 
nofûe
=1;

43 
	`ußge
(
°dîr
, 
¥ogøm
);

44 
	`exô
(
EXIT_FAILURE
);

46 
¨gv
++, 
¨gc
--;

49 i‡(
¨gc
 != 1) {

50 
	`ußge
(
°dîr
, 
¥ogøm
);

51 
	`exô
(
EXIT_FAILURE
);

53 
key«me
 = 
	`°rdup
(
¨gv
[0]);

55 
keyÂ
 = 
	`f›í
(
key«me
, "r");

56 i‡(!
keyÂ
) {

57 
	`Ârötf
(
°dîr
, "FaûedÅÿ›íÖubli¯key fûê%s: %s\n", 
key«me
,

58 
	`°ªº‹
(
î∫o
));

59 
	`exô
(
EXIT_FAILURE
);

62 
ªsu…
 = 
	`ldns_º_√w_‰m_Â
(&
k
, 
keyÂ
, 0, &
‹igö
, 
NULL
);

64 
ªsu…
 =
LDNS_STATUS_SYNTAX_ORIGIN
) {

65 
ªsu…
 = 
	`ldns_º_√w_‰m_Â
(&
k
, 
keyÂ
, 0, &
‹igö
, 
NULL
);

67 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

68 
	`Ârötf
(
°dîr
, "CouldÇŸÑódÖubli¯key from fûê%s: %s\n", 
key«me
, 
	`ldns_gë_îr‹°r_by_id
(
ªsu…
));

69 
	`exô
(
EXIT_FAILURE
);

71 
	`f˛o£
(
keyÂ
);

73 
Êags
 = 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
	`ldns_º_dnskey_Êags
(
k
)));

74 
Êags
 |
LDNS_KEY_REVOKE_KEY
;

76 i‡(!
	`ldns_º_dnskey_£t_Êags
(
k
,

77 
	`ldns_«tive2rdf_öt16
(
LDNS_RDF_TYPE_INT16
, 
Êags
)))

79 
	`Ârötf
(
°dîr
, "Revocation failed\n");

80 
	`exô
(
EXIT_FAILURE
);

85 i‡(
nofûe
)

86 
	`ldns_º_¥öt
(
°dout
,
k
);

88 
keyÂ
 = 
	`f›í
(
key«me
, "w");

89 i‡(!
keyÂ
) {

90 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
key«me
,

91 
	`°ªº‹
(
î∫o
));

92 
	`exô
(
EXIT_FAILURE
);

94 
	`ldns_º_¥öt
(
keyÂ
, 
k
);

95 
	`f˛o£
(
keyÂ
);

96 
	`Ârötf
(
°dout
, "DNSKEYÑevoked\n");

100 
	`‰ì
(
key«me
);

101 
	`ldns_º_‰ì
(
k
);

103 
	`exô
(
EXIT_SUCCESS
);

104 
	}
}

	@examples/ldns-rrsig.c

10 
	~"c⁄fig.h
"

12 
	~<ldns/ldns.h
>

15 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

16 
	`Ârötf
(
Â
, "%†domaö [ty≥]\n", 
¥og
);

17 
	`Ârötf
(
Â
, "Örint outÅhe inceptionándÉxpiration dates\n");

18 
	`Ârötf
(
Â
, " iná more humanÑeadable form\n");

19 
	`Ârötf
(
Â
, " <type>\tquery for RRSIG(<type>), defaultsÅo SOA\n");

21 
	}
}

24 
	$maö
(
¨gc
, *
¨gv
[])

26 
ldns_ªsﬁvî
 *
ªs
;

27 
ldns_ªsﬁvî
 *
loˇÃes
;

28 
ldns_rdf
 *
domaö
;

29 
ldns_pkt
 *
p
;

30 
ldns_º_li°
 *
ºsig
;

31 
ldns_º_li°
 *
ºsig_ty≥
;

32 
ldns_º_li°
 *
ns
;

33 
ldns_º_li°
 *
ns_ù
;

34 
uöt8_t
 
i
, 
j
;

35 
ldns_º_ty≥
 
t
;

36 c⁄° * 
ty≥_«me
;

37 
tm
 
ö˚p
, 
expú
;

38 
ö˚p_buf
[26];

39 
expú_buf
[26];

40 
ldns_°©us
 
s
;

41 
time_t
 
now
 = 
	`time
(
NULL
);

43 
p
 = 
NULL
;

44 
ºsig
 = 
NULL
;

45 
ºsig_ty≥
 = 
NULL
;

46 
domaö
 = 
NULL
;

50 i‡(
¨gc
 < 2) {

51 
	`ußge
(
°dout
, 
¨gv
[0]);

52 
	`exô
(
EXIT_FAILURE
);

55 
domaö
 = 
	`ldns_d«me_√w_‰m_°r
(
¨gv
[1]);

56 i‡(!
domaö
) {

57 
	`ußge
(
°dout
, 
¨gv
[0]);

58 
	`exô
(
EXIT_FAILURE
);

62 i‡(
¨gc
 == 3) {

64 
ty≥_«me
 = 
	`°rdup
(
¨gv
[2]);

65 
t
 = 
	`ldns_rdf2º_ty≥
(

66 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_TYPE
, 
ty≥_«me
));

67 i‡(
t
 == 0) {

68 
	`Ârötf
(
°dîr
, " *** %†i†nŸá vÆid RRÅy≥\n", 
ty≥_«me
);

69 
	`exô
(
EXIT_FAILURE
);

72 
t
 = 
LDNS_RR_TYPE_SOA
;

73 
ty≥_«me
 = "SOA";

77 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
loˇÃes
, 
NULL
);

78 i‡(
s
 !
LDNS_STATUS_OK
) {

79 
	`exô
(
EXIT_FAILURE
);

83 
p
 = 
	`ldns_ªsﬁvî_quîy
(
loˇÃes
, 
domaö
, 
LDNS_RR_TYPE_NS
,

84 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

85 i‡(!
p
) {

86 
	`Ârötf
(
°dîr
," *** CouldÇŸ födányÇame£rvî f‹ %s", 
¨gv
[1]);

87 
	`ldns_ªsﬁvî_dìp_‰ì
(
loˇÃes
);

88 
	`exô
(
EXIT_FAILURE
);

90 
ns
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_NS
, 
LDNS_SECTION_ANSWER
);

92 i‡(!
ns
) {

93 
	`Ârötf
(
°dîr
," *** CouldÇŸ födányÇame£rvî f‹ %s", 
¨gv
[1]);

94 
	`ldns_pkt_‰ì
(
p
);

95 
	`ldns_ªsﬁvî_dìp_‰ì
(
loˇÃes
);

96 
	`exô
(
EXIT_FAILURE
);

101 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

102 i‡(!
ªs
) {

103 
	`ldns_pkt_‰ì
(
p
);

104 
	`ldns_ªsﬁvî_dìp_‰ì
(
loˇÃes
);

105 
	`ldns_º_li°_dìp_‰ì
(
ns
);

106 
	`exô
(
EXIT_FAILURE
);

108 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ns
); i++) {

109 
ns_ù
 = 
	`ldns_gë_º_li°_addr_by_«me
(
loˇÃes
,

110 
	`ldns_º_ns_nsd«me
(
	`ldns_º_li°_º
(
ns
, 
i
)),

111 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

113 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
ns_ù
); j++) {

114 i‡(
	`ldns_ªsﬁvî_push_«me£rvî
(
ªs
,

115 
	`ldns_º_a_addªss
(
	`ldns_º_li°_º
(
ns_ù
, 
j
))Ë!
LDNS_STATUS_OK
) {

116 
	`¥ötf
("ErroráddingÇameserverÅoÑesolver\n");

117 
	`ldns_pkt_‰ì
(
p
);

118 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

119 
	`ldns_ªsﬁvî_dìp_‰ì
(
loˇÃes
);

120 
	`ldns_º_li°_dìp_‰ì
(
ns
);

121 
	`exô
(
EXIT_FAILURE
);

124 
	`ldns_º_li°_dìp_‰ì
(
ns_ù
);

129 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
, 
åue
);

131 
	`ldns_ªsﬁvî_£t_dns£c_cd
(
ªs
, 
åue
);

136 
	`ldns_pkt_‰ì
(
p
);

137 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
domaö
, 
LDNS_RR_TYPE_RRSIG
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

139 
	`ldns_rdf_dìp_‰ì
(
domaö
);

141 i‡(!
p
) {

142 
	`ldns_ªsﬁvî_dìp_‰ì
(
loˇÃes
);

143 
	`ldns_º_li°_dìp_‰ì
(
ns
);

144 
	`exô
(
EXIT_FAILURE
);

149 
ºsig
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_RRSIG
, 
LDNS_SECTION_ANSWER
);

150 i‡(!
ºsig
) {

151 
	`Ârötf
(
°dîr
,

153 
¨gv
[1],árgv[1]);

154 
	`ldns_pkt_‰ì
(
p
);

155 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

156 
	`ldns_º_li°_dìp_‰ì
(
ns
);

157 
	`exô
(
EXIT_FAILURE
);

159 
ºsig_ty≥
 = 
	`ldns_º_li°_√w
();

161 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºsig
); i++) {

162 i‡(
	`ldns_rdf2º_ty≥
(

163 
	`ldns_º_ºsig_ty≥covîed
(

164 
	`ldns_º_li°_º
(
ºsig
, 
i
))Ë=
t
) {

165 
	`ldns_º_li°_push_º
(
ºsig_ty≥
,

166 
	`ldns_º_li°_º
(
ºsig
, 
i
));

169 i‡(
	`ldns_º_li°_º_cou¡
(
ºsig_ty≥
) == 0) {

170 
	`Ârötf
(
°dîr
, " *** No RRSIG(%s)Åype found\n",

171 
ty≥_«me
);

172 
	`ldns_ªsﬁvî_dìp_‰ì
(
loˇÃes
);

173 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

174 
	`ldns_pkt_‰ì
(
p
);

175 
	`ldns_º_li°_dìp_‰ì
(
ns
);

176 
	`ldns_º_li°_‰ì
(
ºsig
);

177 
	`ldns_º_li°_dìp_‰ì
(
ºsig_ty≥
);

178 
	`exô
(
EXIT_FAILURE
);

181 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºsig_ty≥
); i++) {

182 
	`mem£t
(&
ö˚p
, 0, (incep));

183 i‡(
	`ldns_£rül_¨ôhmôics_gmtime_r
(

184 
	`ldns_rdf2«tive_time_t
(

185 
	`ldns_º_ºsig_ö˚±i⁄
(

186 
	`ldns_º_li°_º
(
ºsig_ty≥
, 
i
))),

187 
now
, &
ö˚p


189 && 
	`as˘ime_r
(&
ö˚p
, 
ö˚p_buf
)) {

190 
ö˚p_buf
[24] = '\0';

192 
ö˚p_buf
[0] = '\0';

194 
	`mem£t
(&
expú
, 0, (expir));

195 i‡(
	`ldns_£rül_¨ôhmôics_gmtime_r
(

196 
	`ldns_rdf2«tive_time_t
(

197 
	`ldns_º_ºsig_expú©i⁄
(

198 
	`ldns_º_li°_º
(
ºsig_ty≥
, 
i
))),

199 
now
, &
expú


201 && 
	`as˘ime_r
(&
expú
, 
expú_buf
)) {

202 
expú_buf
[24] = '\0';

204 
expú_buf
[0] = '\0';

207 
	`Ârötf
(
°dout
, "%s RRSIG(%s): %s - %s\n",

208 
¨gv
[1], 
ty≥_«me
, 
ö˚p_buf
, 
expú_buf
);

210 
	`ldns_º_li°_‰ì
(
ºsig
);

211 
	`ldns_º_li°_dìp_‰ì
(
ºsig_ty≥
);

214 
	`ldns_pkt_‰ì
(
p
);

215 
	`ldns_ªsﬁvî_dìp_‰ì
(
loˇÃes
);

216 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

217 
	`ldns_º_li°_dìp_‰ì
(
ns
);

219 
	}
}

	@examples/ldns-signzone.c

8 
	~"c⁄fig.h
"

9 
	~<°dlib.h
>

10 
	~<uni°d.h
>

12 
	~<î∫o.h
>

14 
	~<time.h
>

16 
	~<ldns/ldns.h
>

17 
	~<ldns/keys.h
>

19 #ifde‡
HAVE_SSL


20 
	~<›ís¶/c⁄f.h
>

21 
	~<›ís¶/ígöe.h
>

24 
	#MAX_FILENAME_LEN
 250

	)

25 
	gvîbosôy
 = 1;

27 #ifde‡
HAVE_SSL


28 
	~<›ís¶/îr.h
>

31 
	$ußge
(
FILE
 *
Â
, c⁄° *
¥og
) {

32 
	`Ârötf
(
Â
, "%†[OPTIONS] z⁄efûêkey [key [key]]\n", 
¥og
);

33 
	`Ârötf
(
Â
, " signsÅhe zone withÅhe given key(s)\n");

34 
	`Ârötf
(
Â
, " -b\t\tuseÜayout in signed zoneándÖrint comments DNSSECÑecords\n");

35 
	`Ârötf
(
Â
, " -d\t\tused keysáreÇotáddedÅoÅhe zone\n");

36 
	`Ârötf
(
Â
, " -e <date>\texpiration date\n");

37 
	`Ârötf
(
Â
, " -f <file>\toutput zoneÅo file (default <name>.signed)\n");

38 
	`Ârötf
(
Â
, " -i <date>\tinception date\n");

39 
	`Ârötf
(
Â
, " -o <domain>\torigin forÅhe zone\n");

40 
	`Ârötf
(
Â
, " -v\t\tprint versionándÉxit\n");

41 
	`Ârötf
(
Â
, " -A\t\tsign DNSKEY witháll keys instead of minimal\n");

42 
	`Ârötf
(
Â
, " -E <name>\tuse <name>ásÅhe cryptoÉngine for signing\n");

43 
	`Ârötf
(
Â
, " \tThis can haveáÜot ofÉxtra options, seeÅhe manualÖage for more info\n");

44 
	`Ârötf
(
Â
, " -k <id>,<int>\tuse key id withálgorithm int fromÉngine\n");

45 
	`Ârötf
(
Â
, " -K <id>,<int>\tuse key id withálgorithm int fromÉngineás KSK\n");

46 
	`Ârötf
(
Â
, "\t\tifÇo key is given (butánÉxternal one is usedÅhroughÅheÉngine support, it might beÇecessaryÅoÖrovideÅheÑightálgorithmÇumber.\n");

47 
	`Ârötf
(
Â
, " -n\t\tuse NSEC3 instead of NSEC.\n");

48 
	`Ârötf
(
Â
, "\t\tIf you use NSEC3, you can specifyÅhe followingÉxtra options:\n");

49 
	`Ârötf
(
Â
, "\t\t-a [algorithm] hashingálgorithm\n");

50 
	`Ârötf
(
Â
, "\t\t-t [number]Çumber of hash iterations\n");

51 
	`Ârötf
(
Â
, "\t\t-s [string] salt\n");

52 
	`Ârötf
(
Â
, "\t\t-p setÅhe opt-out flag onállÇsec3Ñrs\n");

53 
	`Ârötf
(
Â
, "\n");

54 
	`Ârötf
(
Â
, " keys must be specified byÅheir baseÇame (usually K<name>+<alg>+<id>),\n");

55 
	`Ârötf
(
Â
, " i.e. WITHOUTÅhe .privateÉxtension.\n");

56 
	`Ârötf
(
Â
, " IfÅheÖublicÖart ofÅhe key isÇotÖresent inÅhe zone,Åhe DNSKEY RR\n");

57 
	`Ârötf
(
Â
, " will beÑead fromÅhe file called <baseÇame>.key. IfÅhat doesÇotÉxist,\n");

58 
	`Ârötf
(
Â
, "á default DNSKEY will be generated fromÅheÖrivate keyándáddedÅoÅhe zone.\n");

59 
	`Ârötf
(
Â
, " A date can beáÅimestamp (seconds sinceÅheÉpoch), or of\nÅhe form <YYYYMMdd[hhmmss]>\n");

60 
	}
}

62 
	$check_tm
(
tm
Åm)

64 i‡(
tm
.
tm_yór
 < 70) {

65 
	`Ârötf
(
°dîr
, "You cannot specify dates before 1970\n");

66 
	`exô
(
EXIT_FAILURE
);

68 i‡(
tm
.
tm_m⁄
 < 0 ||Åm.tm_mon > 11) {

69 
	`Ârötf
(
°dîr
, "The month must be inÅheÑange 1Åo 12\n");

70 
	`exô
(
EXIT_FAILURE
);

72 i‡(
tm
.
tm_mday
 < 1 ||Åm.tm_mday > 31) {

73 
	`Ârötf
(
°dîr
, "The day must be inÅheÑange 1Åo 31\n");

74 
	`exô
(
EXIT_FAILURE
);

77 i‡(
tm
.
tm_hour
 < 0 ||Åm.tm_hour > 23) {

78 
	`Ârötf
(
°dîr
, "The hour must be inÅheÑange 0-23\n");

79 
	`exô
(
EXIT_FAILURE
);

82 i‡(
tm
.
tm_mö
 < 0 ||Åm.tm_min > 59) {

83 
	`Ârötf
(
°dîr
, "The minute must be inÅheÑange 0-59\n");

84 
	`exô
(
EXIT_FAILURE
);

87 i‡(
tm
.
tm_£c
 < 0 ||Åm.tm_sec > 59) {

88 
	`Ârötf
(
°dîr
, "The second must be inÅheÑange 0-59\n");

89 
	`exô
(
EXIT_FAILURE
);

92 
	}
}

102 
	$equÆize_âls
(
ldns_º
 *
º1
,Üdns_º *
º2
, 
uöt32_t
 
deÁu…_âl
)

104 
uöt32_t
 
âl1
, 
âl2
;

106 
âl1
 = 
	`ldns_º_âl
(
º1
);

107 
âl2
 = 
	`ldns_º_âl
(
º2
);

109 i‡(
âl1
 !
âl2
) {

110 i‡(
âl1
 =
deÁu…_âl
) {

111 
	`ldns_º_£t_âl
(
º1
, 
âl2
);

112 } i‡(
âl2
 =
deÁu…_âl
) {

113 
	`ldns_º_£t_âl
(
º2
, 
âl1
);

115 
	`ldns_º_£t_âl
(
º2
, 
âl1
);

116 
	`Ârötf
(
°dîr
,

118 (Ë
âl2
, (Ë
âl1
);

121 
	}
}

124 
	$equÆize_âls_º_li°
(
ldns_º_li°
 *
º_li°
, 
ldns_º
 *
º
, 
uöt32_t
 
deÁu…_âl
)

126 
size_t
 
i
;

127 
ldns_º
 *
cur_º
;

129 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

130 
cur_º
 = 
	`ldns_º_li°_º
(
º_li°
, 
i
);

131 i‡(
	`ldns_º_com∑ª_no_rd©a
(
cur_º
, 
º
) == 0) {

132 
	`equÆize_âls
(
cur_º
, 
º
, 
deÁu…_âl
);

135 
	}
}

137 
ldns_º
 *

138 
	$föd_key_ö_z⁄e
(
ldns_º
 *
pubkey_gí
, 
ldns_z⁄e
 *
z⁄e
) {

139 
size_t
 
key_i
;

140 
ldns_º
 *
pubkey
;

142 
key_i
 = 0;

143 
key_i
 < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
z⁄e
));

144 
key_i
++) {

145 
pubkey
 = 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z⁄e
), 
key_i
);

146 i‡(
	`ldns_º_gë_ty≥
(
pubkey
Ë=
LDNS_RR_TYPE_DNSKEY
 &&

147 (
	`ldns_ˇlc_keyèg
(
pubkey
)

149 
	`ldns_ˇlc_keyèg
(
pubkey_gí
) ||

151 
	`ldns_ˇlc_keyèg
(
pubkey
)

153 
	`ldns_ˇlc_keyèg
(
pubkey_gí
) + 1)

155 i‡(
vîbosôy
 >= 2) {

156 
	`Ârötf
(
°dîr
, "Found it inÅhe zone!\n");

158  
pubkey
;

161  
NULL
;

162 
	}
}

164 
ldns_º
 *

165 
föd_key_ö_fûe
(c⁄° *
keyfûe_«me_ba£
, 
ldns_key
* 
ATTR_UNUSED
(
key
),

166 
uöt32_t
 
z⁄e_âl
)

168 *
	gkeyfûe_«me
;

169 
FILE
 *
	gkeyfûe
;

170 
	glöe_ƒ
;

171 
uöt32_t
 
	gdeÁu…_âl
 = 
z⁄e_âl
;

173 
ldns_º
 *
	gpubkey
 = 
NULL
;

174 
	gkeyfûe_«me
 = 
LDNS_XMALLOC
(,

175 
°æí
(
keyfûe_«me_ba£
) + 5);

176 
¢¥ötf
(
keyfûe_«me
,

177 
°æí
(
keyfûe_«me_ba£
) + 5,

179 
keyfûe_«me_ba£
);

180 i‡(
	gvîbosôy
 >= 2) {

181 
Ârötf
(
°dîr
, "TryögÅÿªad %s\n", 
keyfûe_«me
);

183 
	gkeyfûe
 = 
f›í
(
keyfûe_«me
, "r");

184 
	glöe_ƒ
 = 0;

185 i‡(
	gkeyfûe
) {

186 i‡(
ldns_º_√w_‰m_Â_l
(&
pubkey
,

187 
keyfûe
,

188 &
deÁu…_âl
,

189 
NULL
,

190 
NULL
,

191 &
löe_ƒ
) ==

192 
LDNS_STATUS_OK
) {

193 i‡(
vîbosôy
 >= 2) {

194 
¥ötf
("Key found i¿fûe: %s\n", 
keyfûe_«me
);

197 
f˛o£
(
keyfûe
);

199 
LDNS_FREE
(
keyfûe_«me
);

200  
	gpubkey
;

213 
	$föd_‹_¸óã_pubkey
(c⁄° *
keyfûe_«me_ba£
, 
ldns_key
 *
key
, 
ldns_z⁄e
 *
‹ig_z⁄e
, 
boﬁ
 
add_keys
, 
uöt32_t
 
deÁu…_âl
) {

214 
ldns_º
 *
pubkey_gí
, *
pubkey
;

215 
key_ö_z⁄e
;

217 i‡(
deÁu…_âl
 =
LDNS_DEFAULT_TTL
) {

218 
deÁu…_âl
 = 
	`ldns_º_âl
(
	`ldns_z⁄e_sﬂ
(
‹ig_z⁄e
));

221 i‡(!
	`ldns_key_pubkey_ow√r
(
key
)) {

222 
	`ldns_key_£t_pubkey_ow√r
(
key
, 
	`ldns_rdf_˛⁄e
(
	`ldns_º_ow√r
(
	`ldns_z⁄e_sﬂ
(
‹ig_z⁄e
))));

238 
pubkey_gí
 = 
	`ldns_key2º
(
key
);

239 
	`ldns_º_£t_âl
(
pubkey_gí
, 
deÁu…_âl
);

241 i‡(
vîbosôy
 >= 2) {

242 
	`Ârötf
(
°dîr
,

244 (Ë
	`ldns_ˇlc_keyèg
(
pubkey_gí
),

245 (Ë
	`ldns_ˇlc_keyèg
(
pubkey_gí
)+1

249 
pubkey
 = 
	`föd_key_ö_z⁄e
(
pubkey_gí
, 
‹ig_z⁄e
);

250 
key_ö_z⁄e
 = 1;

251 i‡(!
pubkey
) {

252 
key_ö_z⁄e
 = 0;

254 
pubkey
 = 
	`föd_key_ö_fûe
(
keyfûe_«me_ba£
, 
key
, 
deÁu…_âl
);

255 i‡(!
pubkey
 && !(
	`ldns_key_Êags
(
key
Ë& 
LDNS_KEY_SEP_KEY
)) {

257 
	`ldns_key_£t_keyèg
(
key
, 
	`ldns_key_keyèg
(key) + 1);

258 
pubkey
 = 
	`föd_key_ö_fûe
(
keyfûe_«me_ba£
, 
key
, 
deÁu…_âl
);

259 i‡(!
pubkey
) {

261 
	`ldns_key_£t_keyèg
(
key
, 
	`ldns_key_keyèg
(key) - 1);

264 if(
pubkey
 && 
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
’ubkey),Üdns_º_ow√r(
	`ldns_z⁄e_sﬂ
(
‹ig_z⁄e
))) != 0) {

265 
	`Ârötf
(
°dîr
, "Error %s.key has wrongÇame: %s\n",

266 
keyfûe_«me_ba£
, 
	`ldns_rdf2°r
(
	`ldns_º_ow√r
(
pubkey
)));

267 
	`exô
(
EXIT_FAILURE
);

271 i‡(!
pubkey
) {

274 
pubkey
 = 
pubkey_gí
;

275 i‡(
vîbosôy
 >= 2) {

276 
	`Ârötf
(
°dîr
, "Not in zone,Ço .key file, generating ZSK DNSKEY fromÖrivate key data\n");

279 
	`ldns_º_‰ì
(
pubkey_gí
);

281 
	`ldns_key_£t_Êags
(
key
, 
	`ldns_rdf2«tive_öt16
(
	`ldns_º_rdf
(
pubkey
, 0)));

282 
	`ldns_key_£t_keyèg
(
key
, 
	`ldns_ˇlc_keyèg
(
pubkey
));

284 i‡(
add_keys
 && !
key_ö_z⁄e
) {

285 
	`equÆize_âls_º_li°
(
	`ldns_z⁄e_ºs
(
‹ig_z⁄e
), 
pubkey
, 
deÁu…_âl
);

286 
	`ldns_z⁄e_push_º
(
‹ig_z⁄e
, 
pubkey
);

288 
	}
}

291 
	$°rù_dns£c_ªc‹ds
(
ldns_z⁄e
 *
z⁄e
)

293 
ldns_º_li°
 *
√w_li°
;

294 
ldns_º
 *
cur_º
;

296 
√w_li°
 = 
	`ldns_º_li°_√w
();

298 (
cur_º
 = 
	`ldns_º_li°_p›_º
(
	`ldns_z⁄e_ºs
(
z⁄e
)))) {

299 i‡(
	`ldns_º_gë_ty≥
(
cur_º
Ë=
LDNS_RR_TYPE_RRSIG
 ||

300 
	`ldns_º_gë_ty≥
(
cur_º
Ë=
LDNS_RR_TYPE_NSEC
 ||

301 
	`ldns_º_gë_ty≥
(
cur_º
Ë=
LDNS_RR_TYPE_NSEC3


304 
	`ldns_º_‰ì
(
cur_º
);

306 
	`ldns_º_li°_push_º
(
√w_li°
, 
cur_º
);

309 
	`ldns_º_li°_‰ì
(
	`ldns_z⁄e_ºs
(
z⁄e
));

310 
	`ldns_z⁄e_£t_ºs
(
z⁄e
, 
√w_li°
);

311 
	}
}

314 
	$maö
(
¨gc
, *
¨gv
[])

316 c⁄° *
z⁄efûe_«me
;

317 
FILE
 *
z⁄efûe
 = 
NULL
;

318 
löe_ƒ
 = 0;

319 
c
;

320 
¨gi
;

321 
ENGINE
 *
ígöe
 = 
NULL
;

323 
ldns_z⁄e
 *
‹ig_z⁄e
;

324 
ldns_º_li°
 *
‹ig_ºs
 = 
NULL
;

325 
ldns_º
 *
‹ig_sﬂ
 = 
NULL
;

326 
ldns_dns£c_z⁄e
 *
sig√d_z⁄e
;

328 *
keyfûe_«me_ba£
;

329 *
keyfûe_«me
 = 
NULL
;

330 
FILE
 *
keyfûe
 = 
NULL
;

331 
ldns_key
 *
key
 = 
NULL
;

332 
ldns_key_li°
 *
keys
;

333 
ldns_°©us
 
s
;

334 
size_t
 
i
;

335 
ldns_º_li°
 *
added_ºs
;

337 *
ouçutfûe_«me
 = 
NULL
;

338 
FILE
 *
ouçutfûe
;

341 *
íg_key_l
;

342 
size_t
 
íg_key_id_Àn
;

343 *
íg_key_id
;

344 
íg_key_Ægo
;

346 
boﬁ
 
u£_n£c3
 = 
Ál£
;

347 
signÊags
 = 0;

350 
boﬁ
 
add_keys
 = 
åue
;

351 
uöt8_t
 
n£c3_Æg‹ôhm
 = 1;

352 
uöt8_t
 
n£c3_Êags
 = 0;

353 
size_t
 
n£c3_ôî©i⁄s_cmd
 = 1;

354 
uöt16_t
 
n£c3_ôî©i⁄s
 = 1;

355 
uöt8_t
 
n£c3_ß…_Àngth
 = 0;

356 
uöt8_t
 *
n£c3_ß…
 = 
NULL
;

361 
tm
Åm;

362 
uöt32_t
 
ö˚±i⁄
;

363 
uöt32_t
 
expú©i⁄
;

364 
ldns_rdf
 *
‹igö
 = 
NULL
;

365 
uöt32_t
 
âl
 = 
LDNS_DEFAULT_TTL
;

366 
ldns_º_˛ass
 
˛ass
 = 
LDNS_RR_CLASS_IN
;

368 *
¥og
 = 
	`°rdup
(
¨gv
[0]);

369 
ldns_°©us
 
ªsu…
;

371 
ldns_ouçut_f‹m©_°‹age
 
fmt_°
;

372 
ldns_ouçut_f‹m©
* 
fmt
 = 
	`ldns_ouçut_f‹m©_öô
(&
fmt_°
);

374 
ö˚±i⁄
 = 0;

375 
expú©i⁄
 = 0;

377 
keys
 = 
	`ldns_key_li°_√w
();

379 
	`OPENSSL_c⁄fig
(
NULL
);

381 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "a:bde:f:i:k:no:ps:t:vAE:K:")) != -1) {

382 
c
) {

384 
n£c3_Æg‹ôhm
 = (
uöt8_t
Ë
	`©oi
(
›èrg
);

385 i‡(
n£c3_Æg‹ôhm
 != 1) {

386 
	`Ârötf
(
°dîr
, "Bad NSEC3álgorithm, only RSASHA1állowed\n");

387 
	`exô
(
EXIT_FAILURE
);

391 
	`ldns_ouçut_f‹m©_£t
(
fmt
, 
LDNS_COMMENT_FLAGS


392 | 
LDNS_COMMENT_LAYOUT


393 | 
LDNS_COMMENT_NSEC3_CHAIN


394 | 
LDNS_COMMENT_BUBBLEBABBLE
);

397 
add_keys
 = 
Ál£
;

404 
	`mem£t
(&
tm
, 0, (tm));

406 i‡(
	`°æí
(
›èrg
) == 8 &&

407 
	`ssˇnf
(
›èrg
, "%4d%2d%2d", &
tm
.
tm_yór
, &tm.
tm_m⁄
, &tm.
tm_mday
)

409 
tm
.
tm_yór
 -= 1900;

410 
tm
.
tm_m⁄
--;

411 
	`check_tm
(
tm
);

412 
expú©i⁄
 =

413 (
uöt32_t
Ë
	`ldns_mktime_‰om_utc
(&
tm
);

414 } i‡(
	`°æí
(
›èrg
) == 14 &&

415 
	`ssˇnf
(
›èrg
, "%4d%2d%2d%2d%2d%2d", &
tm
.
tm_yór
, &tm.
tm_m⁄
, &tm.
tm_mday
, &tm.
tm_hour
, &tm.
tm_mö
, &tm.
tm_£c
)

417 
tm
.
tm_yór
 -= 1900;

418 
tm
.
tm_m⁄
--;

419 
	`check_tm
(
tm
);

420 
expú©i⁄
 =

421 (
uöt32_t
Ë
	`ldns_mktime_‰om_utc
(&
tm
);

423 
expú©i⁄
 = (
uöt32_t
Ë
	`©ﬁ
(
›èrg
);

427 
ouçutfûe_«me
 = 
	`LDNS_XMALLOC
(, 
MAX_FILENAME_LEN
);

428 
	`°∫˝y
(
ouçutfûe_«me
, 
›èrg
, 
MAX_FILENAME_LEN
);

431 
	`mem£t
(&
tm
, 0, (tm));

433 i‡(
	`°æí
(
›èrg
) == 8 &&

434 
	`ssˇnf
(
›èrg
, "%4d%2d%2d", &
tm
.
tm_yór
, &tm.
tm_m⁄
, &tm.
tm_mday
)

436 
tm
.
tm_yór
 -= 1900;

437 
tm
.
tm_m⁄
--;

438 
	`check_tm
(
tm
);

439 
ö˚±i⁄
 =

440 (
uöt32_t
Ë
	`ldns_mktime_‰om_utc
(&
tm
);

441 } i‡(
	`°æí
(
›èrg
) == 14 &&

442 
	`ssˇnf
(
›èrg
, "%4d%2d%2d%2d%2d%2d", &
tm
.
tm_yór
, &tm.
tm_m⁄
, &tm.
tm_mday
, &tm.
tm_hour
, &tm.
tm_mö
, &tm.
tm_£c
)

444 
tm
.
tm_yór
 -= 1900;

445 
tm
.
tm_m⁄
--;

446 
	`check_tm
(
tm
);

447 
ö˚±i⁄
 =

448 (
uöt32_t
Ë
	`ldns_mktime_‰om_utc
(&
tm
);

450 
ö˚±i⁄
 = (
uöt32_t
Ë
	`©ﬁ
(
›èrg
);

454 
u£_n£c3
 = 
åue
;

457 i‡(
	`ldns_°r2rdf_d«me
(&
‹igö
, 
›èrg
Ë!
LDNS_STATUS_OK
) {

458 
	`Ârötf
(
°dîr
, "Bad origin,Çotá correct domainÇame\n");

459 
	`ußge
(
°dîr
, 
¥og
);

460 
	`exô
(
EXIT_FAILURE
);

464 
n£c3_Êags
 =Ç£c3_Êag†| 
LDNS_NSEC3_VARS_OPTOUT_MASK
;

467 
	`¥ötf
("z⁄êsig√∏vîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

468 
	`exô
(
EXIT_SUCCESS
);

471 
signÊags
 |
LDNS_SIGN_DNSKEY_WITH_ZSK
;

474 
	`ENGINE_lﬂd_buûtö_ígöes
();

475 
	`ENGINE_lﬂd_dy«mic
();

476 
	`ENGINE_lﬂd_¸y±odev
();

477 
ígöe
 = 
	`ENGINE_by_id
(
›èrg
);

478 i‡(!
ígöe
) {

479 
	`¥ötf
("NÿsuchÉngöe: %s\n", 
›èrg
);

480 
ígöe
 = 
	`ENGINE_gë_fú°
();

481 
	`¥ötf
("AvailableÉngines:\n");

482 
ígöe
) {

483 
	`¥ötf
("%s\n", 
	`ENGINE_gë_id
(
ígöe
));

484 
ígöe
 = 
	`ENGINE_gë_√xt
(engine);

486 
	`exô
(
EXIT_FAILURE
);

488 i‡(!
	`ENGINE_öô
(
ígöe
)) {

489 
	`¥ötf
("TheÉngine couldn't initialize\n");

490 
	`exô
(
EXIT_FAILURE
);

492 
	`ENGINE_£t_deÁu…_RSA
(
ígöe
);

493 
	`ENGINE_£t_deÁu…_DSA
(
ígöe
);

494 
	`ENGINE_£t_deÁu…
(
ígöe
, 0);

498 
íg_key_l
 = 
	`°rchr
(
›èrg
, ',');

499 i‡(
íg_key_l
 && 
	`°æí
(eng_key_l) > 1) {

500 i‡(
íg_key_l
 > 
›èrg
) {

501 
íg_key_id_Àn
 = (
size_t
Ë(
íg_key_l
 - 
›èrg
);

502 
íg_key_id
 = 
	`mÆloc
(
íg_key_id_Àn
 + 1);

503 
	`mem˝y
(
íg_key_id
, 
›èrg
, 
íg_key_id_Àn
);

504 
íg_key_id
[
íg_key_id_Àn
] = '\0';

507 
íg_key_id
 = 
NULL
;

510 
íg_key_Ægo
 = 
	`©oi
(
íg_key_l
 + 1);

512 
	`¥ötf
("Engöêkey id: %s,álgÿ%d\n", 
íg_key_id
, 
íg_key_Ægo
);

514 
s
 = 
	`ldns_key_√w_‰m_ígöe
(&
key
, 
ígöe
, 
íg_key_id
, 
íg_key_Ægo
);

515 i‡(
s
 =
LDNS_STATUS_OK
) {

517 
	`ldns_key_Æg‹ôhm
(
key
)) {

518 
LDNS_SIGN_RSAMD5
:

519 
LDNS_SIGN_RSASHA1
:

520 
LDNS_SIGN_RSASHA1_NSEC3
:

521 
LDNS_SIGN_RSASHA256
:

522 
LDNS_SIGN_RSASHA512
:

523 
LDNS_SIGN_DSA
:

524 
LDNS_SIGN_DSA_NSEC3
:

525 
LDNS_SIGN_ECC_GOST
:

526 #ifde‡
USE_ECDSA


527 
LDNS_SIGN_ECDSAP256SHA256
:

528 
LDNS_SIGN_ECDSAP384SHA384
:

530 
	`ldns_key_li°_push_key
(
keys
, 
key
);

535 
	`Ârötf
(
°dîr
, "W¨nög, keyÇŸ suôabÀ f‹ signög, ign‹ög key wôhálg‹ôhm %u\n", 
	`ldns_key_Æg‹ôhm
(
key
));

538 i‡(
expú©i⁄
 != 0) {

539 
	`ldns_key_£t_expú©i⁄
(
key
,

540 
expú©i⁄
);

542 i‡(
ö˚±i⁄
 != 0) {

543 
	`ldns_key_£t_ö˚±i⁄
(
key
,

544 
ö˚±i⁄
);

547 
	`¥ötf
("Eº‹Ñódög key '%s' fromÉngöe: %s\n", 
íg_key_id
, 
	`ldns_gë_îr‹°r_by_id
(
s
));

548 #ifde‡
HAVE_SSL


549 i‡(
	`ERR_≥ek_îr‹
()) {

550 
	`ERR_lﬂd_¸y±o_°rögs
();

551 
	`ERR_¥öt_îr‹s_Â
(
°dîr
);

552 
	`ERR_‰ì_°rögs
();

555 
	`exô
(
EXIT_FAILURE
);

558 i‡(
íg_key_id
) {

559 
	`‰ì
(
íg_key_id
);

562 
	`¥ötf
("Error: badÉngine key specification (should be: -k <id>,<algorithm>)).\n");

563 
	`exô
(
EXIT_FAILURE
);

567 
	`¥ötf
("Not implemented yet\n");

568 
	`exô
(
EXIT_FAILURE
);

571 i‡(
	`°æí
(
›èrg
) % 2 != 0) {

572 
	`Ârötf
(
°dîr
, "Salt value isÇot valid hex data,Çotá multiple of 2 characters\n");

573 
	`exô
(
EXIT_FAILURE
);

575 
n£c3_ß…_Àngth
 = (
uöt8_t
Ë
	`°æí
(
›èrg
) / 2;

576 
n£c3_ß…
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
n£c3_ß…_Àngth
);

577 
c
 = 0; c < (Ë
	`°æí
(
›èrg
); c += 2) {

578 i‡(
	`isxdigô
((Ë
›èrg
[
c
]) && isxdigit(() optarg[c+1])) {

579 
n£c3_ß…
[
c
/2] = (
uöt8_t
Ë
	`ldns_hexdigô_to_öt
(
›èrg
[c]) * 16 +

580 
	`ldns_hexdigô_to_öt
(
›èrg
[
c
+1]);

582 
	`Ârötf
(
°dîr
, "Salt value isÇot valid hex data.\n");

583 
	`exô
(
EXIT_FAILURE
);

589 
n£c3_ôî©i⁄s_cmd
 = (
size_t
Ë
	`©ﬁ
(
›èrg
);

590 i‡(
n£c3_ôî©i⁄s_cmd
 > 
LDNS_NSEC3_MAX_ITERATIONS
) {

591 
	`Ârötf
(
°dîr
, "Iãøti⁄†cou¡ c™ÇŸÉx˚ed %u, quôtög\n", 
LDNS_NSEC3_MAX_ITERATIONS
);

592 
	`exô
(
EXIT_FAILURE
);

594 
n£c3_ôî©i⁄s
 = (
uöt16_t
Ë
n£c3_ôî©i⁄s_cmd
;

597 
	`ußge
(
°dîr
, 
¥og
);

598 
	`exô
(
EXIT_SUCCESS
);

602 
¨gc
 -
›töd
;

603 
¨gv
 +
›töd
;

605 i‡(
¨gc
 < 1) {

606 
	`¥ötf
("Error:ÇotÉnoughárguments\n");

607 
	`ußge
(
°dout
, 
¥og
);

608 
	`exô
(
EXIT_FAILURE
);

610 
z⁄efûe_«me
 = 
¨gv
[0];

615 i‡(
	`°∫cmp
(
z⁄efûe_«me
, "-", 2) == 0) {

616 
s
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
‹ig_z⁄e
,

617 
°dö
,

618 
‹igö
,

619 
âl
,

620 
˛ass
,

621 &
löe_ƒ
);

622 i‡(
s
 !
LDNS_STATUS_OK
) {

623 
	`Ârötf
(
°dîr
, "ZoneÇotÑead,Érror: %sát stdinÜine %d\n",

624 
	`ldns_gë_îr‹°r_by_id
(
s
),

625 
löe_ƒ
);

626 
	`exô
(
EXIT_FAILURE
);

628 
‹ig_sﬂ
 = 
	`ldns_z⁄e_sﬂ
(
‹ig_z⁄e
);

629 i‡(!
‹ig_sﬂ
) {

630 
	`Ârötf
(
°dîr
,

632 
	`exô
(
EXIT_FAILURE
);

634 
‹ig_ºs
 = 
	`ldns_z⁄e_ºs
(
‹ig_z⁄e
);

635 i‡(!
‹ig_ºs
) {

636 
	`Ârötf
(
°dîr
,

638 
	`exô
(
EXIT_FAILURE
);

642 
z⁄efûe
 = 
	`f›í
(
z⁄efûe_«me
, "r");

644 i‡(!
z⁄efûe
) {

645 
	`Ârötf
(
°dîr
,

647 
z⁄efûe_«me
,

648 
	`°ªº‹
(
î∫o
));

649 
	`exô
(
EXIT_FAILURE
);

651 
s
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
‹ig_z⁄e
,

652 
z⁄efûe
,

653 
‹igö
,

654 
âl
,

655 
˛ass
,

656 &
löe_ƒ
);

657 i‡(
s
 !
LDNS_STATUS_OK
) {

658 
	`Ârötf
(
°dîr
, "ZoneÇotÑead,Érror: %sát %sÜine %d\n",

659 
	`ldns_gë_îr‹°r_by_id
(
s
),

660 
z⁄efûe_«me
, 
löe_ƒ
);

661 
	`exô
(
EXIT_FAILURE
);

663 
‹ig_sﬂ
 = 
	`ldns_z⁄e_sﬂ
(
‹ig_z⁄e
);

664 i‡(!
‹ig_sﬂ
) {

665 
	`Ârötf
(
°dîr
,

667 
	`exô
(
EXIT_FAILURE
);

669 
‹ig_ºs
 = 
	`ldns_z⁄e_ºs
(
‹ig_z⁄e
);

670 i‡(!
‹ig_ºs
) {

671 
	`Ârötf
(
°dîr
,

673 
	`exô
(
EXIT_FAILURE
);

676 
	`f˛o£
(
z⁄efûe
);

681 
¨gi
 = 1;

682 
¨gi
 < 
¨gc
) {

683 
keyfûe_«me_ba£
 = 
¨gv
[
¨gi
];

684 
keyfûe_«me
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
keyfûe_«me_ba£
) + 9);

685 
	`¢¥ötf
(
keyfûe_«me
,

686 
	`°æí
(
keyfûe_«me_ba£
) + 9,

688 
keyfûe_«me_ba£
);

689 
keyfûe
 = 
	`f›í
(
keyfûe_«me
, "r");

690 
löe_ƒ
 = 0;

691 i‡(!
keyfûe
) {

692 
	`Ârötf
(
°dîr
,

694 
keyfûe_«me
,

695 
	`°ªº‹
(
î∫o
));

697 
s
 = 
	`ldns_key_√w_‰m_Â_l
(&
key
, 
keyfûe
, &
löe_ƒ
);

698 
	`f˛o£
(
keyfûe
);

699 i‡(
s
 =
LDNS_STATUS_OK
) {

703 i‡(
expú©i⁄
 != 0) {

704 
	`ldns_key_£t_expú©i⁄
(
key
, 
expú©i⁄
);

706 i‡(
ö˚±i⁄
 != 0) {

707 
	`ldns_key_£t_ö˚±i⁄
(
key
, 
ö˚±i⁄
);

710 
	`LDNS_FREE
(
keyfûe_«me
);

712 
	`ldns_key_li°_push_key
(
keys
, 
key
);

714 
	`Ârötf
(
°dîr
, "Eº‹Ñódög key from %†©Üöê%d: %s\n", 
¨gv
[
¨gi
], 
löe_ƒ
, 
	`ldns_gë_îr‹°r_by_id
(
s
));

718 i‡(
key
) {

719 
	`föd_‹_¸óã_pubkey
(
keyfûe_«me_ba£
, 
key
,

720 
‹ig_z⁄e
, 
add_keys
, 
âl
);

722 
¨gi
++;

725 i‡(
	`ldns_key_li°_key_cou¡
(
keys
) < 1) {

726 
	`Ârötf
(
°dîr
, "Error:Ço keysÅo sign with. Aborting.\n\n");

727 
	`ußge
(
°dîr
, 
¥og
);

728 
	`exô
(
EXIT_FAILURE
);

731 
sig√d_z⁄e
 = 
	`ldns_dns£c_z⁄e_√w
();

732 i‡(
	`ldns_dns£c_z⁄e_add_º
(
sig√d_z⁄e
, 
	`ldns_z⁄e_sﬂ
(
‹ig_z⁄e
)) !=

733 
LDNS_STATUS_OK
) {

734 
	`Ârötf
(
°dîr
,

738 
i
 = 0;

739 
i
 < 
	`ldns_º_li°_º_cou¡
(
	`ldns_z⁄e_ºs
(
‹ig_z⁄e
));

740 
i
++) {

741 i‡(
	`ldns_dns£c_z⁄e_add_º
(
sig√d_z⁄e
,

742 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
‹ig_z⁄e
),

743 
i
)) !=

744 
LDNS_STATUS_OK
) {

745 
	`Ârötf
(
°dîr
,

747 
	`Ârötf
(
°dîr
, ", skippingÑecord:\n");

748 
	`ldns_º_¥öt
(
°dîr
,

749 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
‹ig_z⁄e
), 
i
));

754 
added_ºs
 = 
	`ldns_º_li°_√w
();

756 i‡(
u£_n£c3
) {

757 
ªsu…
 = 
	`ldns_dns£c_z⁄e_sign_n£c3_Êg_mkm≠
(
sig√d_z⁄e
,

758 
added_ºs
,

759 
keys
,

760 
ldns_dns£c_deÁu…_ª∂a˚_sig«tuªs
,

761 
NULL
,

762 
n£c3_Æg‹ôhm
,

763 
n£c3_Êags
,

764 
n£c3_ôî©i⁄s
,

765 
n£c3_ß…_Àngth
,

766 
n£c3_ß…
,

767 
signÊags
,

768 &
fmt_°
.
hashm≠
);

770 
ªsu…
 = 
	`ldns_dns£c_z⁄e_sign_Êg
(
sig√d_z⁄e
,

771 
added_ºs
,

772 
keys
,

773 
ldns_dns£c_deÁu…_ª∂a˚_sig«tuªs
,

774 
NULL
,

775 
signÊags
);

777 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

778 
	`Ârötf
(
°dîr
, "Error signing zone: %s\n",

779 
	`ldns_gë_îr‹°r_by_id
(
ªsu…
));

782 i‡(!
ouçutfûe_«me
) {

783 
ouçutfûe_«me
 = 
	`LDNS_XMALLOC
(, 
MAX_FILENAME_LEN
);

784 
	`¢¥ötf
(
ouçutfûe_«me
, 
MAX_FILENAME_LEN
, "%s.sig√d", 
z⁄efûe_«me
);

787 i‡(
sig√d_z⁄e
) {

788 i‡(
	`°∫cmp
(
ouçutfûe_«me
, "-", 2) == 0) {

789 
	`ldns_dns£c_z⁄e_¥öt
(
°dout
, 
sig√d_z⁄e
);

791 
ouçutfûe
 = 
	`f›í
(
ouçutfûe_«me
, "w");

792 i‡(!
ouçutfûe
) {

793 
	`Ârötf
(
°dîr
, "UnableÅo open %s for writing: %s\n",

794 
ouçutfûe_«me
, 
	`°ªº‹
(
î∫o
));

796 
	`ldns_dns£c_z⁄e_¥öt_fmt
(

797 
ouçutfûe
, 
fmt
, 
sig√d_z⁄e
);

798 
	`f˛o£
(
ouçutfûe
);

802 
	`Ârötf
(
°dîr
, "Error signing zone.\n");

804 #ifde‡
HAVE_SSL


805 i‡(
	`ERR_≥ek_îr‹
()) {

806 
	`ERR_lﬂd_¸y±o_°rögs
();

807 
	`ERR_¥öt_îr‹s_Â
(
°dîr
);

808 
	`ERR_‰ì_°rögs
();

811 
	`exô
(
EXIT_FAILURE
);

814 
	`ldns_key_li°_‰ì
(
keys
);

820 
	`ldns_dns£c_z⁄e_‰ì
(
sig√d_z⁄e
);

821 
	`ldns_z⁄e_dìp_‰ì
(
‹ig_z⁄e
);

822 
	`ldns_º_li°_dìp_‰ì
(
added_ºs
);

824 
	`LDNS_FREE
(
ouçutfûe_«me
);

826 
	`CRYPTO_˛ónup_Æl_ex_d©a
();

828 
	`‰ì
(
¥og
);

829 
	`exô
(
EXIT_SUCCESS
);

830 
	}
}

833 
	$maö
(
¨gc
, **
¨gv
)

835 
	`Ârötf
(
°dîr
, "ldns-signzoneÇeeds OpenSSL support, which hasÇot been compiled in\n");

837 
	}
}

	@examples/ldns-test-edns.c

11 
	~"c⁄fig.h
"

12 
	~"î∫o.h
"

13 
	~<ldns/ldns.h
>

16 
	gvîb
 = 1;

18 
sockaddr_ö6
* 
	$ˇ°_sockaddr_°‹age2sockaddr_ö6
(

19 
sockaddr_°‹age
* 
s
)

21  (
sockaddr_ö6
*)
s
;

22 
	}
}

24 
sockaddr_ö
* 
	$ˇ°_sockaddr_°‹age2sockaddr_ö
(

25 
sockaddr_°‹age
* 
s
)

27  (
sockaddr_ö
*)
s
;

28 
	}
}

32 
	$c⁄vît_addr
(* 
°r
, 
p
, 
sockaddr_°‹age
* 
addr
, 
sockÀn_t
* 
Àn
)

34 #ifde‡
AF_INET6


35 if(
	`°rchr
(
°r
, ':')) {

36 *
Àn
 = (
sockÀn_t
)(
sockaddr_ö6
);

37 
	`ˇ°_sockaddr_°‹age2sockaddr_ö6
(
addr
)->
sö6_Ámûy
 =

38 
AF_INET6
;

39 
	`ˇ°_sockaddr_°‹age2sockaddr_ö6
(
addr
)->
sö6_p‹t
 =

40 
	`ht⁄s
((
uöt16_t
)
p
);

41 if(
	`öë_±⁄
(
AF_INET6
, 
°r
,

42 &((
sockaddr_ö6
*)
addr
)->
sö6_addr
) == 1)

46 *
Àn
 = (
sockÀn_t
)(
sockaddr_ö
);

47 #i‚de‡
S_SPLINT_S


48 
	`ˇ°_sockaddr_°‹age2sockaddr_ö
(
addr
)->
sö_Ámûy
 =

49 
AF_INET
;

51 
	`ˇ°_sockaddr_°‹age2sockaddr_ö
(
addr
)->
sö_p‹t
 =

52 
	`ht⁄s
((
uöt16_t
)
p
);

53 if(
	`öë_±⁄
(
AF_INET
, 
°r
,

54 &((
sockaddr_ö
*)
addr
)->
sö_addr
) == 1)

56 #ifde‡
AF_INET6


59 if(
vîb
Ë
	`¥ötf
("îr‹: c™nŸÖ¨£ IPáddªs†%s\n", 
°r
);

61 
	}
}

64 
ldns_buf„r
*

65 
	$make_quîy
(c⁄° * 
nm
, 
ç
)

68 
ldns_buf„r
* 
b
 = 
	`ldns_buf„r_√w
(512);

69 
ldns_pkt
* 
p
;

70 
ldns_°©us
 
s
;

71 if(!
b
) {

72 if(
vîb
Ë
	`¥ötf
("error: out of memory\n");

73  
NULL
;

76 
s
 = 
	`ldns_pkt_quîy_√w_‰m_°r
(&
p
, 
nm
, 
ç
, 
LDNS_RR_CLASS_IN
,

77 (
uöt16_t
)(
LDNS_RD
|
LDNS_CD
));

78 if(
s
 !
LDNS_STATUS_OK
) {

79 if(
vîb
Ë
	`¥ötf
("îr‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
s
));

80 
	`ldns_buf„r_‰ì
(
b
);

81  
NULL
;

83 if(!
p
) {

84 if(
vîb
Ë
	`¥ötf
("error: out of memory\n");

85 
	`ldns_buf„r_‰ì
(
b
);

86  
NULL
;

89 
	`ldns_pkt_£t_edns_do
(
p
, 1);

90 
	`ldns_pkt_£t_edns_udp_size
(
p
, 4096);

91 
	`ldns_pkt_£t_id
(
p
, 
	`ldns_gë_øndom
());

92 if–(
s
=
	`ldns_pkt2buf„r_wúe
(
b
, 
p
)Ë!
LDNS_STATUS_OK
) {

93 if(
vîb
Ë
	`¥ötf
("îr‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
s
));

94 
	`ldns_pkt_‰ì
(
p
);

95 
	`ldns_buf„r_‰ì
(
b
);

96  
NULL
;

98 
	`ldns_pkt_‰ì
(
p
);

100  
b
;

101 
	}
}

105 
	$gë_∑ckë
(
sockaddr_°‹age
* 
addr
, 
sockÀn_t
 
Àn
, c⁄° * 
nm
,

106 
ç
, 
uöt8_t
 **
wúe
, 
size_t
* 
wÀn
)

108 
timevÆ
 
t
;

109 
ldns_buf„r
* 
qbö
;

110 
ldns_°©us
 
s
;

111 
åõs
 = 0;

113 
	`mem£t
(&
t
, 0, (t));

114 
t
.
tv_u£c
 = 100 * 1000;

116 
qbö
 = 
	`make_quîy
(
nm
, 
ç
);

117 if(!
qbö
)

119 
åõs
 < 4) {

120 
åõs
 ++;

121 
s
 = 
	`ldns_udp_£nd
(
wúe
, 
qbö
, 
addr
, 
Àn
, 
t
, 
wÀn
);

122 if(
s
 !
LDNS_STATUS_NETWORK_ERR
) {

125 
t
.
tv_u£c
 *= 2;

126 if(
t
.
tv_u£c
 > 1000*1000) {

127 
t
.
tv_u£c
 -= 1000*1000;

128 
t
.
tv_£c
 += 1;

131 
	`ldns_buf„r_‰ì
(
qbö
);

132 if(
åõs
 == 4) {

133 if(
vîb
Ë
	`¥ötf
("timeout\n");

136 if(
s
 !
LDNS_STATUS_OK
) {

137 if(
vîb
Ë
	`¥ötf
("îr‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
s
));

141 
	}
}

145 
	$check_ty≥_ö_™swî
(
ldns_pkt
* 
p
, 
t
)

147 
ldns_º_li°
 *
l
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
t
, 
LDNS_SECTION_ANSWER
);

148 if(!
l
) {

149 * 
s
 = 
	`ldns_º_ty≥2°r
(
t
);

150 if(
vîb
Ë
	`¥ötf
("nÿDNSSEC %s\n", 
s
?s:"(out of memory)");

151 
	`LDNS_FREE
(
s
);

154 
	`ldns_º_li°_dìp_‰ì
(
l
);

156 
	}
}

160 
	$check_∑ckë
(
uöt8_t
* 
wúe
, 
size_t
 
Àn
, 
ç
)

162 
ldns_pkt
 *
p
 = 
NULL
;

163 
ldns_°©us
 
s
;

164 if–(
s
=
	`ldns_wúe2pkt
(&
p
, 
wúe
, 
Àn
)Ë!
LDNS_STATUS_OK
) {

165 if(
vîb
Ë
	`¥ötf
("îr‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
s
));

166 
Áûed
;

168 if(!
p
) {

169 if(
vîb
Ë
	`¥ötf
("error: out of memory\n");

170 
Áûed
;

174 if(
	`ldns_pkt_gë_rcode
(
p
Ë!
LDNS_RCODE_NOERROR
) {

175 * 
r
 = 
	`ldns_pkt_rcode2°r
(
	`ldns_pkt_gë_rcode
(
p
));

176 if(
vîb
Ë
	`¥ötf
("nÿ™swî, %s\n", 
r
?r:"(out of memory)");

177 
	`LDNS_FREE
(
r
);

178 
Áûed
;

185 if(
	`LDNS_ARCOUNT
(
wúe
) == 0 ||

186 
	`ldns_pkt_¨cou¡
(
p
Ë=
	`LDNS_ARCOUNT
(
wúe
)) {

187 if(
vîb
Ë
	`¥ötf
("no EDNS\n");

188 
Áûed
;

192 if(!
	`check_ty≥_ö_™swî
(
p
, 
ç
) ||

193 !
	`check_ty≥_ö_™swî
(
p
, 
LDNS_RR_TYPE_RRSIG
)) {

194 
Áûed
;

197 
	`LDNS_FREE
(
wúe
);

198 
	`ldns_pkt_‰ì
(
p
);

200 
Áûed
:

201 
	`LDNS_FREE
(
wúe
);

202 
	`ldns_pkt_‰ì
(
p
);

204 
	}
}

208 
	$check_edns_ù
(* 
ù
, 
p‹t
, 
öfo
)

210 
sockaddr_°‹age
 
addr
;

211 
sockÀn_t
 
Àn
 = 0;

212 
uöt8_t
* 
wúe
;

213 
size_t
 
wÀn
;

214 
	`mem£t
(&
addr
, 0, (addr));

215 if(
vîb
Ë
	`¥ötf
("%†", 
ù
);

216 if(!
	`c⁄vît_addr
(
ù
, 
p‹t
, &
addr
, &
Àn
))

219 if(!
	`gë_∑ckë
(&
addr
, 
Àn
, ".", 
LDNS_RR_TYPE_DNSKEY
, &
wúe
, &
wÀn
))

221 if(!
	`check_∑ckë
(
wúe
, 
wÀn
, 
LDNS_RR_TYPE_DNSKEY
))

224 if(!
	`gë_∑ckë
(&
addr
, 
Àn
, "£.", 
LDNS_RR_TYPE_DS
, &
wúe
, &
wÀn
))

226 if(!
	`check_∑ckë
(
wúe
, 
wÀn
, 
LDNS_RR_TYPE_DS
))

228 if(
vîb
Ë
	`¥ötf
("OK\n");

229 if(
öfo
Ë
	`¥ötf
(" %s", 
ù
);

231 
	}
}

234 
	$maö
(
¨gc
, **
¨gv
)

236 
i
, 
r
=0, 
öfo
=0, 
ok
=0;

237 #ifde‡
USE_WINSOCK


238 
WSADATA
 
wß_d©a
;

239 if(
	`WSASèπup
(
	`MAKEWORD
(2,2), &
wß_d©a
) != 0) {

240 
	`¥ötf
("WSASèπu∞Áûed\n"); 
	`exô
(1);

243 i‡(
¨gc
 < 2 || 
	`°∫cmp
(
¨gv
[1], "-h", 3) == 0) {

244 
	`¥ötf
("Usage:Üdns-test-edns [-i] {ipáddress}\n");

245 
	`¥ötf
("Tests ifÅhe DNS cacheát IPáddress supports EDNS.\n");

246 
	`¥ötf
("if it works,Örint IPáddress OK.\n");

247 
	`¥ötf
("-i:Örint IPsÅhatáre OK orÖrint 'off'.\n");

248 
	`¥ötf
("exit value,Üast IP is 0:OK, 1:fail, 2:netÉrror.\n");

249 
	`exô
(1);

251 if(
	`°rcmp
(
¨gv
[1], "-i") == 0) {

252 
öfo
 = 1;

253 
vîb
 = 0;

256 
i
=1+
öfo
; i<
¨gc
; i++) {

257 
r
 = 
	`check_edns_ù
(
¨gv
[
i
], 
LDNS_PORT
, 
öfo
);

258 if(
r
 == 0)

259 
ok
++;

261 if(
öfo
 && !
ok
)

262 
	`¥ötf
("off\n");

263  
r
;

264 
	}
}

	@examples/ldns-testns.c

120 
	gsockaddr_°‹age
;

121 
	~"c⁄fig.h
"

122 
	~<ldns/ldns.h
>

123 
	~"ldns-ã°pkts.h
"

125 #ifde‡
HAVE_SYS_SOCKET_H


126 
	~<sys/sockë.h
>

128 #ifde‡
HAVE_TIME_H


129 
	~<time.h
>

131 #ifde‡
HAVE_SYS_TIME_H


132 
	~<sys/time.h
>

134 #ifde‡
HAVE_SYS_SELECT_H


135 
	~<sys/£À˘.h
>

137 #ifde‡
HAVE_ARPA_INET_H


138 
	~<¨∑/öë.h
>

140 #ifde‡
HAVE_NETINET_IN_H


141 
	~<√töë/ö.h
>

143 #ifde‡
HAVE_NETINET_UDP_H


144 
	~<√töë/udp.h
>

146 #ifde‡
HAVE_NETINET_IGMP_H


147 
	~<√töë/igmp.h
>

149 
	~<î∫o.h
>

151 
	#INBUF_SIZE
 4096

	)

152 
	#DEFAULT_PORT
 53

	)

153 
	#CONN_BACKLOG
 5

	)

154 c⁄° * 
	g¥og_«me
 = "ldns-testns";

155 
FILE
* 
	glogfûe
 = 0;

156 
	gdo_vîbo£
 = 0;

158 
	$ußge
()

160 
	`¥ötf
("Ußge: %†[›ti⁄s] <d©afûe>\n", 
¥og_«me
);

161 
	`¥ötf
(" -rÜistens onÑandomÖort. PortÇumber isÖrinted.\n");

162 
	`¥ötf
(" -pÜi°í†⁄Åhê•ecifõdÖ‹t, deÁu… %d.\n", 
DEFAULT_PORT
);

163 
	`¥ötf
(" -f forks givenÇumberÉxtra instances, defaultÇone.\n");

164 
	`¥ötf
(" -v more verbose,Örints queries,ánswersánd matching.\n");

165 
	`¥ötf
(" -6Üisten on IP6ányáddress, instead of IP4ányáddress.\n");

166 
	`¥ötf
("TheÖrogramánswers queries with cannedÑeplies fromÅhe datafile.\n");

167 
	`exô
(
EXIT_FAILURE
);

168 
	}
}

170 
	$log_msg
(c⁄° * 
msg
, ...)

172 
va_li°
 
¨gs
;

173 
	`va_°¨t
(
¨gs
, 
msg
);

174 
	`vÂrötf
(
logfûe
, 
msg
, 
¨gs
);

175 
	`fÊush
(
logfûe
);

176 
	`va_íd
(
¨gs
);

177 
	}
}

179 
	$îr‹
(c⁄° * 
msg
, ...)

181 
va_li°
 
¨gs
;

182 
	`va_°¨t
(
¨gs
, 
msg
);

183 
	`Ârötf
(
logfûe
, "%†îr‹: ", 
¥og_«me
);

184 
	`vÂrötf
(
logfûe
, 
msg
, 
¨gs
);

185 
	`Ârötf
(
logfûe
, "\n");

186 
	`fÊush
(
logfûe
);

187 
	`va_íd
(
¨gs
);

188 
	`exô
(
EXIT_FAILURE
);

189 
	}
}

191 
vîbo£
(
ATTR_UNUSED
(
lvl
), c⁄° * 
msg
, ...)

193 
va_li°
 
	g¨gs
;

194 
va_°¨t
(
¨gs
, 
msg
);

195 if(
	gdo_vîbo£
)

196 
vÂrötf
(
logfûe
, 
msg
, 
¨gs
);

197 
fÊush
(
logfûe
);

198 
va_íd
(
¨gs
);

201 
	$böd_p‹t
(
sock
, 
p‹t
, 
Ám
)

203 
sockaddr_ö
 
addr
;

204 #i‡
	`deföed
(
AF_INET6
Ë&& deföed(
HAVE_GETADDRINFO
)

205 if(
Ám
 =
AF_INET6
) {

206 
sockaddr_ö6
 
addr6
;

207 
	`mem£t
(&
addr6
, 0, (addr6));

208 
addr6
.
sö6_Ámûy
 = 
AF_INET6
;

209 
addr6
.
sö6_p‹t
 = (
ö_p‹t_t
)
	`ht⁄s
((
uöt16_t
)
p‹t
);

210 #i‡
HAVE_DECL_IN6ADDR_ANY


211 
addr6
.
sö6_addr
 = 
ö6addr_™y
;

213 
	`mem£t
(&
addr6
.
sö6_addr
, 0, (addr6.sin6_addr));

215  
	`böd
(
sock
, (
sockaddr
 *)&
addr6
, (
sockÀn_t
) (addr6));

219 #i‚de‡
S_SPLINT_S


220 
addr
.
sö_Ámûy
 = 
AF_INET
;

222 
addr
.
sö_p‹t
 = (
ö_p‹t_t
)
	`ht⁄s
((
uöt16_t
)
p‹t
);

223 
addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

224  
	`böd
(
sock
, (
sockaddr
 *)&
addr
, (
sockÀn_t
) (addr));

225 
	}
}

227 
	sh™dÀ_udp_u£rd©a
 {

228 
	mudp_sock
;

229 
sockaddr_°‹age
 
	maddr_him
;

230 
sockÀn_t
 
	mhi¶í
;

233 
	$£nd_udp
(
uöt8_t
* 
buf
, 
size_t
 
Àn
, * 
d©a
)

235 
h™dÀ_udp_u£rd©a
 *
u£rd©a
 = (h™dÀ_udp_u£rd©a*)
d©a
;

237 
ssize_t
 
nb
;

238 
nb
 = 
	`£ndto
(
u£rd©a
->
udp_sock
, (*)
buf
, 
Àn
, 0,

239 (
sockaddr
*)&
u£rd©a
->
addr_him
, u£rd©a->
hi¶í
);

240 if(
nb
 == -1)

241 
	`log_msg
("£ndto(): %s\n", 
	`°ªº‹
(
î∫o
));

242 if((
size_t
)
nb
 !
Àn
)

243 
	`log_msg
("sendto(): only sent %d of %d octets.\n",

244 ()
nb
, ()
Àn
);

245 
	}
}

248 
	$h™dÀ_udp
(
udp_sock
, 
íåy
* 
íåõs
, *
cou¡
)

250 
ssize_t
 
nb
;

251 
uöt8_t
 
öbuf
[
INBUF_SIZE
];

252 
h™dÀ_udp_u£rd©a
 
u£rd©a
;

253 
u£rd©a
.
udp_sock
 = udp_sock;

255 
u£rd©a
.
hi¶í
 = (
sockÀn_t
)(u£rd©a.
addr_him
);

257 
nb
 = 
	`ªcv‰om
(
udp_sock
, (*)
öbuf
, 
INBUF_SIZE
, 0,

258 (
sockaddr
*)&
u£rd©a
.
addr_him
, &u£rd©a.
hi¶í
);

259 i‡(
nb
 < 1) {

260 #i‚de‡
USE_WINSOCK


261 
	`log_msg
("ªcv‰om(): %s\n", 
	`°ªº‹
(
î∫o
));

263 if(
	`WSAGëLa°Eº‹
(Ë!
WSAEINPROGRESS
 &&

264 
	`WSAGëLa°Eº‹
(Ë!
WSAECONNRESET
 &&

265 
	`WSAGëLa°Eº‹
()!
WSAEWOULDBLOCK
)

266 
	`log_msg
("ªcv‰om(): %d\n", 
	`WSAGëLa°Eº‹
());

270 
	`h™dÀ_quîy
(
öbuf
, 
nb
, 
íåõs
, 
cou¡
, 
å™•‹t_udp
, 
£nd_udp
,

271 &
u£rd©a
, 
do_vîbo£
?
logfûe
:0);

272 
	}
}

275 
	$ªad_n_byãs
(
sock
, 
uöt8_t
* 
buf
, 
size_t
 
sz
)

277 
size_t
 
cou¡
 = 0;

278 
cou¡
 < 
sz
) {

279 
ssize_t
 
nb
 = 
	`ªcv
(
sock
, (*)(
buf
+
cou¡
), 
sz
-count, 0);

280 if(
nb
 < 0) {

281 
	`log_msg
("ªcv(): %s\n", 
	`°ªº‹
(
î∫o
));

284 
cou¡
 +
nb
;

286 
	}
}

289 
	$wrôe_n_byãs
(
sock
, 
uöt8_t
* 
buf
, 
size_t
 
sz
)

291 
size_t
 
cou¡
 = 0;

292 
cou¡
 < 
sz
) {

293 
ssize_t
 
nb
 = 
	`£nd
(
sock
, (*)(
buf
+
cou¡
), 
sz
-count, 0);

294 if(
nb
 < 0) {

295 
	`log_msg
("£nd(): %s\n", 
	`°ªº‹
(
î∫o
));

298 
cou¡
 +
nb
;

300 
	}
}

302 
	sh™dÀ_t˝_u£rd©a
 {

303 
	ms
;

306 
	$£nd_t˝
(
uöt8_t
* 
buf
, 
size_t
 
Àn
, * 
d©a
)

308 
h™dÀ_t˝_u£rd©a
 *
u£rd©a
 = (h™dÀ_t˝_u£rd©a*)
d©a
;

309 
uöt16_t
 
t˝Àn
;

311 
t˝Àn
 = 
	`ht⁄s
(
Àn
);

312 
	`wrôe_n_byãs
(
u£rd©a
->
s
, (
uöt8_t
*)&
t˝Àn
, (tcplen));

313 
	`wrôe_n_byãs
(
u£rd©a
->
s
, 
buf
, 
Àn
);

314 
	}
}

317 
	$h™dÀ_t˝
(
t˝_sock
, 
íåy
* 
íåõs
, *
cou¡
)

319 
s
;

320 
sockaddr_°‹age
 
addr_him
;

321 
sockÀn_t
 
hi¶í
;

322 
uöt8_t
 
öbuf
[
INBUF_SIZE
];

323 
uöt16_t
 
t˝Àn
;

324 
h™dÀ_t˝_u£rd©a
 
u£rd©a
;

327 
hi¶í
 = (
sockÀn_t
)(
addr_him
);

328 if((
s
 = 
	`ac˚±
(
t˝_sock
, (
sockaddr
*)&
addr_him
, &
hi¶í
)) < 0) {

329 
	`log_msg
("ac˚±(): %s\n", 
	`°ªº‹
(
î∫o
));

332 
u£rd©a
.
s
 = s;

335 
	`ªad_n_byãs
(
s
, (
uöt8_t
*)&
t˝Àn
, (tcplen));

336 
t˝Àn
 = 
	`¡ohs
(tcplen);

337 if(
t˝Àn
 >
INBUF_SIZE
) {

338 
	`log_msg
("query %d bytesÅooÜarge, buffer %d bytes.\n",

339 
t˝Àn
, 
INBUF_SIZE
);

340 #i‚de‡
USE_WINSOCK


341 
	`˛o£
(
s
);

343 
	`˛o£sockë
(
s
);

347 
	`ªad_n_byãs
(
s
, 
öbuf
, 
t˝Àn
);

349 
	`h™dÀ_quîy
(
öbuf
, (
ssize_t
Ë
t˝Àn
, 
íåõs
, 
cou¡
, 
å™•‹t_t˝
,

350 
£nd_t˝
, &
u£rd©a
, 
do_vîbo£
?
logfûe
:0);

351 #i‚de‡
USE_WINSOCK


352 
	`˛o£
(
s
);

354 
	`˛o£sockë
(
s
);

357 
	}
}

360 
	gudp_sock
, 
	gt˝_sock
;

361 
íåy
* 
	gíåõs
;

368 
	$£rvi˚
()

370 
fd_£t
 
r£t
, 
w£t
, 
e£t
;

371 
cou¡
;

372 
maxfd
;

375 
cou¡
 = 0;

377 #i‚de‡
S_SPLINT_S


378 
	`FD_ZERO
(&
r£t
);

379 
	`FD_ZERO
(&
w£t
);

380 
	`FD_ZERO
(&
e£t
);

381 
	`FD_SET
(
udp_sock
, &
r£t
);

382 
	`FD_SET
(
t˝_sock
, &
r£t
);

384 
maxfd
 = 
udp_sock
;

385 if(
t˝_sock
 > 
maxfd
)

386 
maxfd
 = 
t˝_sock
;

387 if(
	`£À˘
(
maxfd
+1, &
r£t
, &
w£t
, &
e£t
, 
NULL
) < 0) {

388 
	`îr‹
("£À˘(): %s\n", 
	`°ªº‹
(
î∫o
));

390 if(
	`FD_ISSET
(
udp_sock
, &
r£t
)) {

391 
	`h™dÀ_udp
(
udp_sock
, 
íåõs
, &
cou¡
);

393 if(
	`FD_ISSET
(
t˝_sock
, &
r£t
)) {

394 
	`h™dÀ_t˝
(
t˝_sock
, 
íåõs
, &
cou¡
);

397 
	}
}

400 
	$f‹kô
(
numbî
)

402 
i
;

403 
i
=0; i<
numbî
; i++)

405 #i‚de‡
HAVE_FORK


406 #i‚de‡
USE_WINSOCK


407 
	`log_msg
("fork()Çotávailable.\n");

408 
	`exô
(1);

410 
DWORD
 
tid
;

411 
HANDLE
 
id
 = 
	`Cª©eThªad
(
NULL
, 0,

412 (
LPTHREAD_START_ROUTINE
)
£rvi˚
, 
NULL
,

413 0, &
tid
);

414 if(
id
 =
NULL
) {

415 
	`log_msg
("îr‹ Cª©eThªad: %d\n", 
	`GëLa°Eº‹
());

418 
	`log_msg
("thªad id: %d\n", ()
tid
);

421 
pid_t
 
pid
 = 
	`f‹k
();

422 if(
pid
 =(
pid_t
) -1) {

423 
	`log_msg
("îr‹ f‹kög: %s\n", 
	`°ªº‹
(
î∫o
));

426 if(
pid
 == 0)

428 
	`log_msg
("f‹kedÖid: %d\n", ()
pid
);

431 
	}
}

434 
	$maö
(
¨gc
, **
¨gv
)

437 
c
;

438 
p‹t
 = 
DEFAULT_PORT
;

439 c⁄° * 
d©afûe
;

440 
f‹knum
 = 0;

443 
Ám
 = 
AF_INET
;

444 
boﬁ
 
øndom_p‹t_suc˚ss
;

446 #ifde‡
USE_WINSOCK


447 
WSADATA
 
wß_d©a
;

451 
	`§™dom
(
	`time
(
NULL
Ë^ 
	`gëpid
());

452 
logfûe
 = 
°dout
;

453 
¥og_«me
 = 
¨gv
[0];

454 
	`log_msg
("%s: sèπ\n", 
¥og_«me
);

455 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "6f:p:rv")) != -1) {

456 
c
) {

458 #ifde‡
AF_INET6


459 
Ám
 = 
AF_INET6
;

461 
	`log_msg
("cannot -6:Ço IP6ávailable\n");

462 
	`exô
(1);

466 
p‹t
 = 0;

469 
f‹knum
 = 
	`©oi
(
›èrg
);

470 if(
f‹knum
 < 1)

471 
	`îr‹
("övÆid f‹knÿ%s, givênumbî", 
›èrg
);

474 
p‹t
 = 
	`©oi
(
›èrg
);

475 i‡(
p‹t
 < 1) {

476 
	`îr‹
("InvÆidÖ‹à%s, u£áÇumbî.", 
›èrg
);

480 
do_vîbo£
++;

483 
	`ußge
();

487 
¨gc
 -
›töd
;

488 
¨gv
 +
›töd
;

490 if(
¨gc
 == 0 ||árgc > 1)

491 
	`ußge
();

493 
d©afûe
 = 
¨gv
[0];

494 
	`log_msg
("Ródög d©afûê%s\n", 
d©afûe
);

495 
íåõs
 = 
	`ªad_d©afûe
(
d©afûe
, 0);

497 #ifde‡
USE_WINSOCK


498 if(
	`WSASèπup
(
	`MAKEWORD
(2,2), &
wß_d©a
) != 0)

499 
	`îr‹
("WSAStartup failed\n");

502 if((
udp_sock
 = 
	`sockë
(
Ám
, 
SOCK_DGRAM
, 0)) < 0) {

503 
	`îr‹
("ud∞sockë(): %s\n", 
	`°ªº‹
(
î∫o
));

505 if((
t˝_sock
 = 
	`sockë
(
Ám
, 
SOCK_STREAM
, 0)) < 0) {

506 
	`îr‹
("t˝ sockë(): %s\n", 
	`°ªº‹
(
î∫o
));

508 
c
 = 1;

509 if(
	`£tsock›t
(
t˝_sock
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (*)&
c
, (
sockÀn_t
) ()) < 0) {

510 
	`îr‹
("£tsock›t(SO_REUSEADDR): %s\n", 
	`°ªº‹
(
î∫o
));

514 i‡(
p‹t
 > 0) {

515 i‡(
	`böd_p‹t
(
udp_sock
, 
p‹t
, 
Ám
)) {

516 
	`îr‹
("ˇ¬Ÿ böd(): %s\n", 
	`°ªº‹
(
î∫o
));

518 i‡(
	`böd_p‹t
(
t˝_sock
, 
p‹t
, 
Ám
)) {

519 
	`îr‹
("ˇ¬Ÿ böd(): %s\n", 
	`°ªº‹
(
î∫o
));

521 i‡(
	`li°í
(
t˝_sock
, 
CONN_BACKLOG
) < 0) {

522 
	`îr‹
("li°í(): %s\n", 
	`°ªº‹
(
î∫o
));

525 
øndom_p‹t_suc˚ss
 = 
Ál£
;

526 !
øndom_p‹t_suc˚ss
) {

527 
p‹t
 = (
	`øndom
() % 64510) + 1025;

528 
	`log_msg
("åyögÅÿbödÅÿp‹à%d\n", 
p‹t
);

529 
øndom_p‹t_suc˚ss
 = 
åue
;

530 i‡(
	`böd_p‹t
(
udp_sock
, 
p‹t
, 
Ám
)) {

531 #ifde‡
EADDRINUSE


532 i‡(
î∫o
 !
EADDRINUSE
) {

533 #ñi‡
	`deföed
(
USE_WINSOCK
)

534 i‡(
	`WSAGëLa°Eº‹
(Ë!
WSAEADDRINUSE
) {

538 
	`≥º‹
("bind()");

541 
øndom_p‹t_suc˚ss
 = 
Ál£
;

544 i‡(
øndom_p‹t_suc˚ss
) {

545 i‡(
	`böd_p‹t
(
t˝_sock
, 
p‹t
, 
Ám
)) {

546 #ifde‡
EADDRINUSE


547 i‡(
î∫o
 !
EADDRINUSE
) {

548 #ñi‡
	`deföed
(
USE_WINSOCK
)

549 i‡(
	`WSAGëLa°Eº‹
()!=
WSAEADDRINUSE
){

553 
	`≥º‹
("bind()");

556 
øndom_p‹t_suc˚ss
 = 
Ál£
;

560 i‡(
øndom_p‹t_suc˚ss
) {

561 i‡(
	`li°í
(
t˝_sock
, 
CONN_BACKLOG
) < 0) {

562 
	`îr‹
("li°í(): %s\n", 
	`°ªº‹
(
î∫o
));

568 
	`log_msg
("Li°íög o¿p‹à%d\n", 
p‹t
);

571 if(
f‹knum
 > 0)

572 
	`f‹kô
(
f‹knum
);

574 
	`£rvi˚
();

577 
	}
}

	@examples/ldns-testpkts.c

23 
	~"c⁄fig.h
"

24 
	gsockaddr_°‹age
;

25 
	~<ldns/ldns.h
>

26 
	~<î∫o.h
>

27 
	~"ldns-ã°pkts.h
"

30 
	#MAX_LINE
 10240

	)

32 c⁄° * 
	g¥og_«me
 = "ldns-testpkts";

34 #i‚de‡
UTIL_LOG_H


36 
	evîbosôy_vÆue
 { 
	mNO_VERBOSE
=0 };

39 
	$vîbo£
(
vîbosôy_vÆue
 
lvl
, c⁄° * 
msg
, ...Ë
	`ATTR_FORMAT
(
¥ötf
, 2, 3);

42 
	$îr‹
(c⁄° * 
msg
, ...)

44 
va_li°
 
¨gs
;

45 
	`va_°¨t
(
¨gs
, 
msg
);

46 
	`Ârötf
(
°dîr
, "%†îr‹: ", 
¥og_«me
);

47 
	`vÂrötf
(
°dîr
, 
msg
, 
¨gs
);

48 
	`Ârötf
(
°dîr
, "\n");

49 
	`fÊush
(
°dîr
);

50 
	`va_íd
(
¨gs
);

51 
	`exô
(
EXIT_FAILURE
);

52 
	}
}

55 
boﬁ
 
	$i£ndlöe
(
c
)

57 if(
c
 == ';' || c == '#'

58 || 
c
 == '\n' || c == 0)

59  
åue
;

60  
Ál£
;

61 
	}
}

68 
boﬁ
 
	$°r_keyw‹d
(** 
°r
, c⁄° * 
keyw‹d
)

70 
size_t
 
Àn
 = 
	`°æí
(
keyw‹d
);

71 
	`as£π
(
°r
 && 
keyw‹d
);

72 if(
	`°∫cmp
(*
°r
, 
keyw‹d
, 
Àn
) != 0)

73  
Ál£
;

74 *
°r
 +
Àn
;

75 
	`is•a˚
(()**
°r
))

76 (*
°r
)++;

77  
åue
;

78 
	}
}

81 
ª∂y_∑ckë
*

82 
	$íåy_add_ª∂y
(
íåy
*Éntry)

84 
ª∂y_∑ckë
* 
pkt
 = (ª∂y_∑ckë*)
	`mÆloc
(

85 (
ª∂y_∑ckë
));

86 
ª∂y_∑ckë
 ** 
p
 = &
íåy
->
ª∂y_li°
;

87 
pkt
->
√xt
 = 
NULL
;

88 
pkt
->
∑ckë_¶ìp
 = 0;

89 
pkt
->
ª∂y
 = 
	`ldns_pkt_√w
();

90 
pkt
->
ª∂y_‰om_hex
 = 
NULL
;

92 *
p
)

93 
p
 = &((*p)->
√xt
);

94 *
p
 = 
pkt
;

95  
pkt
;

96 
	}
}

99 
	$m©chlöe
(* 
löe
, 
íåy
* 
e
)

101 * 
∑r£
 = 
löe
;

102 *
∑r£
) {

103 if(
	`i£ndlöe
(*
∑r£
))

105 if(
	`°r_keyw‹d
(&
∑r£
, "opcode")) {

106 
e
->
m©ch_›code
 = 
åue
;

107 } if(
	`°r_keyw‹d
(&
∑r£
, "qtype")) {

108 
e
->
m©ch_qty≥
 = 
åue
;

109 } if(
	`°r_keyw‹d
(&
∑r£
, "qname")) {

110 
e
->
m©ch_q«me
 = 
åue
;

111 } if(
	`°r_keyw‹d
(&
∑r£
, "subdomain")) {

112 
e
->
m©ch_subdomaö
 = 
åue
;

113 } if(
	`°r_keyw‹d
(&
∑r£
, "all")) {

114 
e
->
m©ch_Æl
 = 
åue
;

115 } if(
	`°r_keyw‹d
(&
∑r£
, "ttl")) {

116 
e
->
m©ch_âl
 = 
åue
;

117 } if(
	`°r_keyw‹d
(&
∑r£
, "DO")) {

118 
e
->
m©ch_do
 = 
åue
;

119 } if(
	`°r_keyw‹d
(&
∑r£
, "noedns")) {

120 
e
->
m©ch_n€dns
 = 
åue
;

121 } if(
	`°r_keyw‹d
(&
∑r£
, "ednsdata")) {

122 
e
->
m©ch_ednsd©a_øw
 = 
åue
;

123 } if(
	`°r_keyw‹d
(&
∑r£
, "UDP")) {

124 
e
->
m©ch_å™•‹t
 = 
å™•‹t_udp
;

125 } if(
	`°r_keyw‹d
(&
∑r£
, "TCP")) {

126 
e
->
m©ch_å™•‹t
 = 
å™•‹t_t˝
;

127 } if(
	`°r_keyw‹d
(&
∑r£
, "serial")) {

128 
e
->
m©ch_£rül
 = 
åue
;

129 if(*
∑r£
 != '=' && *parse != ':')

130 
	`îr‹
("ex≥˘ed = o∏: i¿MATCH: %s", 
löe
);

131 
∑r£
++;

132 
e
->
ix‰_sﬂ_£rül
 = (
uöt32_t
)
	`°πﬁ
(
∑r£
, (**)&parse, 10);

133 
	`is•a˚
(()*
∑r£
))

134 
∑r£
++;

136 
	`îr‹
("couldÇŸÖ¨£ MATCH: '%s'", 
∑r£
);

139 
	}
}

142 
	$ª∂ylöe
(* 
löe
, 
ldns_pkt
 *
ª∂y
)

144 * 
∑r£
 = 
löe
;

145 *
∑r£
) {

146 if(
	`i£ndlöe
(*
∑r£
))

149 if(
	`°r_keyw‹d
(&
∑r£
, "QUERY")) {

150 
	`ldns_pkt_£t_›code
(
ª∂y
, 
LDNS_PACKET_QUERY
);

151 } if(
	`°r_keyw‹d
(&
∑r£
, "IQUERY")) {

152 
	`ldns_pkt_£t_›code
(
ª∂y
, 
LDNS_PACKET_IQUERY
);

153 } if(
	`°r_keyw‹d
(&
∑r£
, "STATUS")) {

154 
	`ldns_pkt_£t_›code
(
ª∂y
, 
LDNS_PACKET_STATUS
);

155 } if(
	`°r_keyw‹d
(&
∑r£
, "NOTIFY")) {

156 
	`ldns_pkt_£t_›code
(
ª∂y
, 
LDNS_PACKET_NOTIFY
);

157 } if(
	`°r_keyw‹d
(&
∑r£
, "UPDATE")) {

158 
	`ldns_pkt_£t_›code
(
ª∂y
, 
LDNS_PACKET_UPDATE
);

160 } if(
	`°r_keyw‹d
(&
∑r£
, "NOERROR")) {

161 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_NOERROR
);

162 } if(
	`°r_keyw‹d
(&
∑r£
, "FORMERR")) {

163 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_FORMERR
);

164 } if(
	`°r_keyw‹d
(&
∑r£
, "SERVFAIL")) {

165 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_SERVFAIL
);

166 } if(
	`°r_keyw‹d
(&
∑r£
, "NXDOMAIN")) {

167 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_NXDOMAIN
);

168 } if(
	`°r_keyw‹d
(&
∑r£
, "NOTIMPL")) {

169 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_NOTIMPL
);

170 } if(
	`°r_keyw‹d
(&
∑r£
, "REFUSED")) {

171 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_REFUSED
);

172 } if(
	`°r_keyw‹d
(&
∑r£
, "YXDOMAIN")) {

173 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_YXDOMAIN
);

174 } if(
	`°r_keyw‹d
(&
∑r£
, "YXRRSET")) {

175 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_YXRRSET
);

176 } if(
	`°r_keyw‹d
(&
∑r£
, "NXRRSET")) {

177 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_NXRRSET
);

178 } if(
	`°r_keyw‹d
(&
∑r£
, "NOTAUTH")) {

179 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_NOTAUTH
);

180 } if(
	`°r_keyw‹d
(&
∑r£
, "NOTZONE")) {

181 
	`ldns_pkt_£t_rcode
(
ª∂y
, 
LDNS_RCODE_NOTZONE
);

183 } if(
	`°r_keyw‹d
(&
∑r£
, "QR")) {

184 
	`ldns_pkt_£t_qr
(
ª∂y
, 
åue
);

185 } if(
	`°r_keyw‹d
(&
∑r£
, "AA")) {

186 
	`ldns_pkt_£t_Ø
(
ª∂y
, 
åue
);

187 } if(
	`°r_keyw‹d
(&
∑r£
, "TC")) {

188 
	`ldns_pkt_£t_tc
(
ª∂y
, 
åue
);

189 } if(
	`°r_keyw‹d
(&
∑r£
, "RD")) {

190 
	`ldns_pkt_£t_rd
(
ª∂y
, 
åue
);

191 } if(
	`°r_keyw‹d
(&
∑r£
, "CD")) {

192 
	`ldns_pkt_£t_cd
(
ª∂y
, 
åue
);

193 } if(
	`°r_keyw‹d
(&
∑r£
, "RA")) {

194 
	`ldns_pkt_£t_ø
(
ª∂y
, 
åue
);

195 } if(
	`°r_keyw‹d
(&
∑r£
, "AD")) {

196 
	`ldns_pkt_£t_ad
(
ª∂y
, 
åue
);

197 } if(
	`°r_keyw‹d
(&
∑r£
, "DO")) {

198 
	`ldns_pkt_£t_edns_udp_size
(
ª∂y
, 4096);

199 
	`ldns_pkt_£t_edns_do
(
ª∂y
, 
åue
);

201 
	`îr‹
("couldÇŸÖ¨£ REPLY: '%s'", 
∑r£
);

204 
	}
}

207 
	$adju°löe
(* 
löe
, 
íåy
* 
e
,

208 
ª∂y_∑ckë
* 
pkt
)

210 * 
∑r£
 = 
löe
;

211 *
∑r£
) {

212 if(
	`i£ndlöe
(*
∑r£
))

214 if(
	`°r_keyw‹d
(&
∑r£
, "copy_id")) {

215 
e
->
c›y_id
 = 
åue
;

216 } if(
	`°r_keyw‹d
(&
∑r£
, "copy_query")) {

217 
e
->
c›y_quîy
 = 
åue
;

218 } if(
	`°r_keyw‹d
(&
∑r£
, "sleep=")) {

219 
e
->
¶ì±ime
 = (Ë
	`°πﬁ
(
∑r£
, (**)&parse, 10);

220 
	`is•a˚
(()*
∑r£
))

221 
∑r£
++;

222 } if(
	`°r_keyw‹d
(&
∑r£
, "packet_sleep=")) {

223 
pkt
->
∑ckë_¶ìp
 = (Ë
	`°πﬁ
(
∑r£
, (**)&parse, 10);

224 
	`is•a˚
(()*
∑r£
))

225 
∑r£
++;

227 
	`îr‹
("couldÇŸÖ¨£ ADJUST: '%s'", 
∑r£
);

230 
	}
}

233 
íåy
* 
	$√w_íåy
()

235 
íåy
* 
e
 = 
	`LDNS_MALLOC
(entry);

236 
	`mem£t
(
e
, 0, (*e));

237 
e
->
m©ch_›code
 = 
Ál£
;

238 
e
->
m©ch_qty≥
 = 
Ál£
;

239 
e
->
m©ch_q«me
 = 
Ál£
;

240 
e
->
m©ch_subdomaö
 = 
Ál£
;

241 
e
->
m©ch_Æl
 = 
Ál£
;

242 
e
->
m©ch_âl
 = 
Ál£
;

243 
e
->
m©ch_do
 = 
Ál£
;

244 
e
->
m©ch_n€dns
 = 
Ál£
;

245 
e
->
m©ch_£rül
 = 
Ál£
;

246 
e
->
ix‰_sﬂ_£rül
 = 0;

247 
e
->
m©ch_å™•‹t
 = 
å™•‹t_™y
;

248 
e
->
ª∂y_li°
 = 
NULL
;

249 
e
->
c›y_id
 = 
Ál£
;

250 
e
->
c›y_quîy
 = 
Ál£
;

251 
e
->
¶ì±ime
 = 0;

252 
e
->
√xt
 = 
NULL
;

253  
e
;

254 
	}
}

265 
size_t


266 
	$hex°r2bö
(*
hex°r
, 
Àn
, 
uöt8_t
 *
buf
, 
size_t
 
off£t
, size_à
buf_Àn
)

268 
c
;

269 
i
;

270 
uöt8_t
 
öt8
 = 0;

271 
£c
 = 0;

272 
size_t
 
buÂos
 = 0;

274 i‡(
Àn
 % 2 != 0) {

278 
i
=0; i<
Àn
; i++) {

279 
c
 = 
hex°r
[
i
];

282 i‡(
c
 != ' ') {

283 i‡(
c
 >= '0' && c <= '9') {

284 
öt8
 +
c
 & 0x0f;

285 } i‡(
c
 >= 'a' && c <= 'z') {

286 
öt8
 +(
c
 & 0x0f) + 9;

287 } i‡(
c
 >= 'A' && c <= 'Z') {

288 
öt8
 +(
c
 & 0x0f) + 9;

293 i‡(
£c
 == 0) {

294 
öt8
 = int8 << 4;

295 
£c
 = 1;

297 i‡(
buÂos
 + 
off£t
 + 1 <
buf_Àn
) {

298 
buf
[
buÂos
+
off£t
] = 
öt8
;

299 
öt8
 = 0;

300 
£c
 = 0;

301 
buÂos
++;

303 
	`Ârötf
(
°dîr
, "BufferÅoo small in hexstr2bin");

308  
buÂos
;

309 
	}
}

312 
ldns_buf„r
 *

313 
	$d©a_buf„r2wúe
(
ldns_buf„r
 *
d©a_buf„r
)

315 
ldns_buf„r
 *
wúe_buf„r
 = 
NULL
;

316 
c
;

323 
size_t
 
d©a_buf_pos
 = 0;

324 
°©e
 = 0;

325 
uöt8_t
 *
hexbuf
;

326 
hexbuÂos
 = 0;

327 
size_t
 
wúñí
;

328 
uöt8_t
 *
d©a_wúe
 = (uöt8_à*Ë
	`ldns_buf„r_begö
(
d©a_buf„r
);

329 
uöt8_t
 *
wúe
 = 
	`LDNS_XMALLOC
(uöt8_t, 
LDNS_MAX_PACKETLEN
);

331 
hexbuf
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_MAX_PACKETLEN
);

332 
d©a_buf_pos
 = 0; d©a_buf_po†< 
	`ldns_buf„r_posôi⁄
(
d©a_buf„r
); data_buf_pos++) {

333 
c
 = (Ë
d©a_wúe
[
d©a_buf_pos
];

335 i‡(
°©e
 < 2 && !
	`ißscii
(
c
)) {

337 
°©e
 = 2;

339 
°©e
) {

341 i‡–(
c
 >= '0' && c <= '9') ||

342 (
c
 >= 'a' && c <= 'f') ||

343 (
c
 >= 'A' && c <= 'F') )

345 i‡(
hexbuÂos
 >
LDNS_MAX_PACKETLEN
) {

346 
	`îr‹
("buffer overflow");

347 
	`LDNS_FREE
(
hexbuf
);

351 
hexbuf
[
hexbuÂos
] = (
uöt8_t
Ë
c
;

352 
hexbuÂos
++;

353 } i‡(
c
 == ';') {

354 
°©e
 = 1;

355 } i‡(
c
 == ' ' || c == '\t' || c == '\n') {

360 i‡(
c
 ='\n' || c =
EOF
) {

361 
°©e
 = 0;

365 i‡(
hexbuÂos
 >
LDNS_MAX_PACKETLEN
) {

366 
	`îr‹
("buffer overflow");

367 
	`LDNS_FREE
(
hexbuf
);

370 
hexbuf
[
hexbuÂos
] = (
uöt8_t
Ë
c
;

371 
hexbuÂos
++;

376 i‡(
hexbuÂos
 >
LDNS_MAX_PACKETLEN
) {

381 i‡(
hexbuÂos
 % 2 != 0) {

382 i‡(
hexbuÂos
 >
LDNS_MAX_PACKETLEN
) {

383 
	`îr‹
("buffer overflow");

384 
	`LDNS_FREE
(
hexbuf
);

387 
hexbuf
[
hexbuÂos
] = (
uöt8_t
) '0';

388 
hexbuÂos
++;

391 i‡(
°©e
 < 2) {

392 
wúñí
 = 
	`hex°r2bö
((*Ë
hexbuf
, 
hexbuÂos
, 
wúe
, 0, 
LDNS_MAX_PACKETLEN
);

393 
wúe_buf„r
 = 
	`ldns_buf„r_√w
(
wúñí
);

394 
	`ldns_buf„r_√w_‰m_d©a
(
wúe_buf„r
, 
wúe
, 
wúñí
);

396 
	`îr‹
("Incomplete hex data,Çotát byte boundary\n");

398 
	`LDNS_FREE
(
wúe
);

399 
	`LDNS_FREE
(
hexbuf
);

400  
wúe_buf„r
;

401 
	}
}

405 
	$gë_‹igö
(c⁄° * 
«me
, 
löío
, 
ldns_rdf
** 
‹igö
, * 
∑r£
)

408 * 
íd
;

409 
°‹e
;

410 
ldns_°©us
 
°©us
;

412 
	`ldns_rdf_‰ì
(*
‹igö
);

413 *
‹igö
 = 
NULL
;

415 
íd
=
∑r£
;

416 !
	`is•a˚
(()*
íd
Ë&& !
	`i£ndlöe
(*end))

417 
íd
++;

418 
°‹e
 = *
íd
;

419 *
íd
 = 0;

420 
	`vîbo£
(3, "∑rsög '%s'\n", 
∑r£
);

421 
°©us
 = 
	`ldns_°r2rdf_d«me
(
‹igö
, 
∑r£
);

422 *
íd
 = 
°‹e
;

423 i‡(
°©us
 !
LDNS_STATUS_OK
)

424 
	`îr‹
("%†löê%d:\n\t%s: %s", 
«me
, 
löío
,

425 
	`ldns_gë_îr‹°r_by_id
(
°©us
), 
∑r£
);

426 
	}
}

429 
íåy
*

430 
	$ªad_íåy
(
FILE
* 
ö
, c⁄° * 
«me
, *
löío
, 
uöt32_t
* 
deÁu…_âl
,

431 
ldns_rdf
** 
‹igö
,Üdns_rdf** 
¥ev_º
, 
skù_whôe•a˚
)

433 
íåy
* 
cuºít
 = 
NULL
;

434 
löe
[
MAX_LINE
];

435 * 
∑r£
;

436 
ldns_pkt_£˘i⁄
 
add_£˘i⁄
 = 
LDNS_SECTION_QUESTION
;

437 
ª∂y_∑ckë
 *
cur_ª∂y
 = 
NULL
;

438 
boﬁ
 
ªadög_hex
 = 
Ál£
;

439 
boﬁ
 
ªadög_hex_ednsd©a
 = 
Ál£
;

440 
ldns_buf„r
* 
hex_d©a_buf„r
 = 
NULL
;

441 
ldns_buf„r
* 
hex_ednsd©a_buf„r
 = 
NULL
;

443 
	`fgës
(
löe
, ()÷öe), 
ö
Ë!
NULL
) {

444 
löe
[
MAX_LINE
-1] = 0;

445 
∑r£
 = 
löe
;

446 (*
löío
) ++;

448 
	`is•a˚
(()*
∑r£
))

449 
∑r£
++;

451 if(
	`i£ndlöe
(*
∑r£
))

453 if(
	`°r_keyw‹d
(&
∑r£
, "ENTRY_BEGIN")) {

454 if(
cuºít
) {

455 
	`îr‹
("%sÜine %d:ÖreviousÉntry doesÇot ENTRY_END",

456 
«me
, *
löío
);

458 
cuºít
 = 
	`√w_íåy
();

459 
cuºít
->
löío
 = *lineno;

460 
cur_ª∂y
 = 
	`íåy_add_ª∂y
(
cuºít
);

462 } if(
	`°r_keyw‹d
(&
∑r£
, "$ORIGIN")) {

463 
	`gë_‹igö
(
«me
, *
löío
, 
‹igö
, 
∑r£
);

465 } if(
	`°r_keyw‹d
(&
∑r£
, "$TTL")) {

466 *
deÁu…_âl
 = (
uöt32_t
)
	`©oi
(
∑r£
);

471 if(!
cuºít
) {

472 
	`îr‹
("%sÜine %d:Éxpected ENTRY_BEGIN but got %s",

473 
«me
, *
löío
, 
löe
);

475 if(
	`°r_keyw‹d
(&
∑r£
, "MATCH")) {

476 
	`m©chlöe
(
∑r£
, 
cuºít
);

477 } if(
	`°r_keyw‹d
(&
∑r£
, "REPLY")) {

478 
	`ª∂ylöe
(
∑r£
, 
cur_ª∂y
->
ª∂y
);

479 } if(
	`°r_keyw‹d
(&
∑r£
, "ADJUST")) {

480 
	`adju°löe
(
∑r£
, 
cuºít
, 
cur_ª∂y
);

481 } if(
	`°r_keyw‹d
(&
∑r£
, "EXTRA_PACKET")) {

482 
cur_ª∂y
 = 
	`íåy_add_ª∂y
(
cuºít
);

483 } if(
	`°r_keyw‹d
(&
∑r£
, "SECTION")) {

484 if(
	`°r_keyw‹d
(&
∑r£
, "QUESTION"))

485 
add_£˘i⁄
 = 
LDNS_SECTION_QUESTION
;

486 if(
	`°r_keyw‹d
(&
∑r£
, "ANSWER"))

487 
add_£˘i⁄
 = 
LDNS_SECTION_ANSWER
;

488 if(
	`°r_keyw‹d
(&
∑r£
, "AUTHORITY"))

489 
add_£˘i⁄
 = 
LDNS_SECTION_AUTHORITY
;

490 if(
	`°r_keyw‹d
(&
∑r£
, "ADDITIONAL"))

491 
add_£˘i⁄
 = 
LDNS_SECTION_ADDITIONAL
;

492 
	`îr‹
("%†löê%d: bad se˘i⁄ %s", 
«me
, *
löío
, 
∑r£
);

493 } if(
	`°r_keyw‹d
(&
∑r£
, "HEX_ANSWER_BEGIN")) {

494 
hex_d©a_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

495 
ªadög_hex
 = 
åue
;

496 } if(
	`°r_keyw‹d
(&
∑r£
, "HEX_ANSWER_END")) {

497 i‡(!
ªadög_hex
) {

498 
	`îr‹
("%†löê%d: HEX_ANSWER_ENDÑód buànÿHEX_ANSWER_BEGIN keyw‹d sìn", 
«me
, *
löío
);

500 
ªadög_hex
 = 
Ál£
;

501 
cur_ª∂y
->
ª∂y_‰om_hex
 = 
	`d©a_buf„r2wúe
(
hex_d©a_buf„r
);

502 
	`ldns_buf„r_‰ì
(
hex_d©a_buf„r
);

503 
hex_d©a_buf„r
 = 
NULL
;

504 } if(
ªadög_hex
) {

505 
	`ldns_buf„r_¥ötf
(
hex_d©a_buf„r
, 
löe
);

506 } if(
	`°r_keyw‹d
(&
∑r£
, "HEX_EDNSDATA_BEGIN")) {

507 
hex_ednsd©a_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

508 
ªadög_hex_ednsd©a
 = 
åue
;

509 } if(
	`°r_keyw‹d
(&
∑r£
, "HEX_EDNSDATA_END")) {

510 i‡(!
ªadög_hex_ednsd©a
) {

511 
	`îr‹
("%sÜine %d: HEX_EDNSDATA_ENDÑead butÇo"

512 "HEX_EDNSDATA_BEGIN keyw‹d sìn", 
«me
, *
löío
);

514 
ªadög_hex_ednsd©a
 = 
Ál£
;

515 
cur_ª∂y
->
øw_ednsd©a
 = 
	`d©a_buf„r2wúe
(
hex_ednsd©a_buf„r
);

516 
	`ldns_buf„r_‰ì
(
hex_ednsd©a_buf„r
);

517 
hex_ednsd©a_buf„r
 = 
NULL
;

518 } if(
ªadög_hex_ednsd©a
) {

519 
	`ldns_buf„r_¥ötf
(
hex_ednsd©a_buf„r
, 
löe
);

520 } if(
	`°r_keyw‹d
(&
∑r£
, "ENTRY_END")) {

521 i‡(
hex_d©a_buf„r
)

522 
	`ldns_buf„r_‰ì
(
hex_d©a_buf„r
);

523  
cuºít
;

526 
ldns_º
* 
n
 = 
NULL
;

527 
ldns_°©us
 
°©us
;

528 * 
º°r
 = 
löe
;

529 i‡(
skù_whôe•a˚
)

530 
º°r
 = 
∑r£
;

531 if(
add_£˘i⁄
 =
LDNS_SECTION_QUESTION
)

532 
°©us
 = 
	`ldns_º_√w_que°i⁄_‰m_°r
(

533 &
n
, 
º°r
, *
‹igö
, 
¥ev_º
);

534 
°©us
 = 
	`ldns_º_√w_‰m_°r
(&
n
, 
º°r
,

535 *
deÁu…_âl
, *
‹igö
, 
¥ev_º
);

536 if(
°©us
 !
LDNS_STATUS_OK
)

537 
	`îr‹
("%†löê%d:\n\t%s: %s", 
«me
, *
löío
,

538 
	`ldns_gë_îr‹°r_by_id
(
°©us
), 
º°r
);

539 
	`ldns_pkt_push_º
(
cur_ª∂y
->
ª∂y
, 
add_£˘i⁄
, 
n
);

543 i‡(
ªadög_hex
) {

544 
	`îr‹
("%s: End of fileÑeached while stillÑeading hex, "

545 "missög HEX_ANSWER_END\n", 
«me
);

547 if(
cuºít
) {

548 
	`îr‹
("%s: End of fileÑeached whileÑeadingÉntry. "

549 "missög ENTRY_END\n", 
«me
);

552 
	}
}

555 
íåy
*

556 
	$ªad_d©afûe
(c⁄° * 
«me
, 
skù_whôe•a˚
)

558 
íåy
* 
li°
 = 
NULL
;

559 
íåy
* 
œ°
 = 
NULL
;

560 
íåy
* 
cuºít
 = 
NULL
;

561 
FILE
 *
ö
;

562 
löío
 = 0;

563 
uöt32_t
 
deÁu…_âl
 = 0;

564 
ldns_rdf
* 
‹igö
 = 
NULL
;

565 
ldns_rdf
* 
¥ev_º
 = 
NULL
;

566 
íåy_num
 = 0;

568 if((
ö
=
	`f›í
(
«me
, "r")Ë=
NULL
) {

569 
	`îr‹
("couldÇŸ o≥¿fûê%s: %s", 
«me
, 
	`°ªº‹
(
î∫o
));

572 (
cuºít
 = 
	`ªad_íåy
(
ö
, 
«me
, &
löío
, &
deÁu…_âl
,

573 &
‹igö
, &
¥ev_º
, 
skù_whôe•a˚
)))

575 if(
œ°
)

576 
œ°
->
√xt
 = 
cuºít
;

577 
li°
 = 
cuºít
;

578 
œ°
 = 
cuºít
;

579 
íåy_num
 ++;

581 
	`vîbo£
(1, "%s: Ród %dÉ¡rõs\n", 
¥og_«me
, 
íåy_num
);

583 
	`f˛o£
(
ö
);

584 
	`ldns_rdf_dìp_‰ì
(
‹igö
);

585 
	`ldns_rdf_dìp_‰ì
(
¥ev_º
);

586  
li°
;

587 
	}
}

590 
ldns_º_ty≥
 
	$gë_qty≥
(
ldns_pkt
* 
p
)

592 if(!
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
p
), 0))

594  
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
p
), 0));

595 
	}
}

598 
ldns_rdf
* 
	$gë_ow√r
(
ldns_pkt
* 
p
)

600 if(!
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
p
), 0))

601  
NULL
;

602  
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
p
), 0));

603 
	}
}

606 
uöt32_t
 
	$gë_£rül
(
ldns_pkt
* 
p
)

608 
ldns_º
 *
º
 = 
	`ldns_º_li°_º
(
	`ldns_pkt_auth‹ôy
(
p
), 0);

609 
ldns_rdf
 *
rdf
;

610 
uöt32_t
 
vÆ
;

611 if(!
º
)  0;

612 
rdf
 = 
	`ldns_º_rdf
(
º
, 2);

613 if(!
rdf
)  0;

614 
vÆ
 = 
	`ldns_rdf2«tive_öt32
(
rdf
);

615 
	`vîbo£
(3, "found sîü»%u i¿msg. ", ()
vÆ
);

616  
vÆ
;

617 
	}
}

621 
	$m©ch_li°
(
ldns_º_li°
* 
q
,Üdns_º_li° *
p
, 
boﬁ
 
mâl
)

623 
size_t
 
i
;

624 if(
	`ldns_º_li°_º_cou¡
(
q
Ë!ldns_º_li°_º_cou¡(
p
))

626 
i
=0; i<
	`ldns_º_li°_º_cou¡
(
q
); i++)

628 if(
	`ldns_º_com∑ª
(
	`ldns_º_li°_º
(
q
, 
i
),

629 
	`ldns_º_li°_º
(
p
, 
i
)) != 0) {

630 
	`vîbo£
(3, "º %d dif„ª¡", ()
i
);

633 if(
mâl
 && 
	`ldns_º_âl
(
	`ldns_º_li°_º
(
q
, 
i
)) !=

634 
	`ldns_º_âl
(
	`ldns_º_li°_º
(
p
, 
i
))) {

635 
	`vîbo£
(3, "º %dÅé dif„ª¡", ()
i
);

640 
	}
}

644 
	$cmp_boﬁ
(
x
, 
y
)

646 if(!
x
 && !
y
)  0;

647 if(
x
 && 
y
)  0;

648 if(!
x
)  -1;

650 
	}
}

654 
	$m©ch_Æl
(
ldns_pkt
* 
q
,Üdns_pkt* 
p
, 
boﬁ
 
mâl
)

656 if(
	`ldns_pkt_gë_›code
(
q
Ë!ldns_pkt_gë_›code(
p
))

657 { 
	`vîbo£
(3, "allmatch: opcode different");  0;}

658 if(
	`ldns_pkt_gë_rcode
(
q
Ë!ldns_pkt_gë_rcode(
p
))

659 { 
	`vîbo£
(3, "allmatch:Ñcode different");  0;}

660 if(
	`ldns_pkt_id
(
q
Ë!ldns_pkt_id(
p
))

661 { 
	`vîbo£
(3, "allmatch: id different");  0;}

662 if(
	`cmp_boﬁ
(
	`ldns_pkt_qr
(
q
),Üdns_pkt_qr(
p
)) != 0)

663 { 
	`vîbo£
(3, "allmatch: qr different");  0;}

664 if(
	`cmp_boﬁ
(
	`ldns_pkt_Ø
(
q
),Üdns_pkt_Ø(
p
)) != 0)

665 { 
	`vîbo£
(3, "allmatch:áa different");  0;}

666 if(
	`cmp_boﬁ
(
	`ldns_pkt_tc
(
q
),Üdns_pkt_tc(
p
)) != 0)

667 { 
	`vîbo£
(3, "allmatch:Åc different");  0;}

668 if(
	`cmp_boﬁ
(
	`ldns_pkt_rd
(
q
),Üdns_pkt_rd(
p
)) != 0)

669 { 
	`vîbo£
(3, "allmatch:Ñd different");  0;}

670 if(
	`cmp_boﬁ
(
	`ldns_pkt_cd
(
q
),Üdns_pkt_cd(
p
)) != 0)

671 { 
	`vîbo£
(3, "allmatch: cd different");  0;}

672 if(
	`cmp_boﬁ
(
	`ldns_pkt_ø
(
q
),Üdns_pkt_ø(
p
)) != 0)

673 { 
	`vîbo£
(3, "allmatch:Ña different");  0;}

674 if(
	`cmp_boﬁ
(
	`ldns_pkt_ad
(
q
),Üdns_pkt_ad(
p
)) != 0)

675 { 
	`vîbo£
(3, "allmatch:ád different");  0;}

676 if(
	`ldns_pkt_qdcou¡
(
q
Ë!ldns_pkt_qdcou¡(
p
))

677 { 
	`vîbo£
(3, "allmatch: qdcount different");  0;}

678 if(
	`ldns_pkt_™cou¡
(
q
Ë!ldns_pkt_™cou¡(
p
))

679 { 
	`vîbo£
(3, "allmatch:áncount different");  0;}

680 if(
	`ldns_pkt_nscou¡
(
q
Ë!ldns_pkt_nscou¡(
p
))

681 { 
	`vîbo£
(3, "allmatch:Çscount different");  0;}

682 if(
	`ldns_pkt_¨cou¡
(
q
Ë!ldns_pkt_¨cou¡(
p
))

683 { 
	`vîbo£
(3, "allmatch:árcount different");  0;}

684 if(!
	`m©ch_li°
(
	`ldns_pkt_que°i⁄
(
q
),Üdns_pkt_que°i⁄(
p
), 0))

685 { 
	`vîbo£
(3, "allmatch: qd section different");  0;}

686 if(!
	`m©ch_li°
(
	`ldns_pkt_™swî
(
q
),Üdns_pkt_™swî(
p
), 
mâl
))

687 { 
	`vîbo£
(3, "allmatch:án section different");  0;}

688 if(!
	`m©ch_li°
(
	`ldns_pkt_auth‹ôy
(
q
),Üdns_pkt_auth‹ôy(
p
), 
mâl
))

689 { 
	`vîbo£
(3, "allmatch:ár section different");  0;}

690 if(!
	`m©ch_li°
(
	`ldns_pkt_addôi⁄Æ
(
q
),Üdns_pkt_addôi⁄Æ(
p
), 
mâl
))

691 { 
	`vîbo£
(3, "allmatch:Çs section different");  0;}

693 
	}
}

697 
	$vîbo£_hex
(
lvl
, 
uöt8_t
 *
d©a
, 
size_t
 
d©Æí
, c⁄° *
hódî
)

699 
	`vîbo£
(
lvl
, "%s", 
hódî
);

700 
d©Æí
-- > 0) {

701 
	`vîbo£
(
lvl
, " %02x", ()*
d©a
++);

703 
	`vîbo£
(
lvl
, "\n");

704 
	}
}

708 
	$m©ch_ednsd©a
(
ldns_pkt
* 
q
, 
ª∂y_∑ckë
* 
p
)

710 
size_t
 
qdÀn
, 
pdÀn
;

711 
uöt8_t
 *
qd
, *
pd
;

712 if(!
	`ldns_pkt_edns
(
q
Ë|| !
	`ldns_pkt_edns_d©a
(q)) {

713 
	`vîbo£
(3, "No EDNS data\n");

716 
qdÀn
 = 
	`ldns_rdf_size
(
	`ldns_pkt_edns_d©a
(
q
));

717 
pdÀn
 = 
	`ldns_buf„r_limô
(
p
->
øw_ednsd©a
);

718 
qd
 = 
	`ldns_rdf_d©a
(
	`ldns_pkt_edns_d©a
(
q
));

719 
pd
 = 
	`ldns_buf„r_begö
(
p
->
øw_ednsd©a
);

720 if–
qdÀn
 =
pdÀn
 && 0 =
	`memcmp
(
qd
, 
pd
, qdlen) )  1;

721 
	`vîbo£
(3, "EDNS data doesÇot match.\n");

722 
	`vîbo£_hex
(3, 
qd
, 
qdÀn
, "q:");

723 
	`vîbo£_hex
(3, 
pd
, 
pdÀn
, "p:");

725 
	}
}

728 
íåy
*

729 
	$föd_m©ch
(
íåy
* 
íåõs
, 
ldns_pkt
* 
quîy_pkt
,

730 
å™•‹t_ty≥
 
å™•‹t
)

732 
íåy
* 
p
 = 
íåõs
;

733 
ldns_pkt
* 
ª∂y
 = 
NULL
;

734 
p
=
íåõs
;Ö;Öı->
√xt
) {

735 
	`vîbo£
(3, "comparepkt: ");

736 
ª∂y
 = 
p
->
ª∂y_li°
->reply;

737 if(
p
->
m©ch_›code
 && 
	`ldns_pkt_gë_›code
(
quîy_pkt
) !=

738 
	`ldns_pkt_gë_›code
(
ª∂y
)) {

739 
	`vîbo£
(3, "bad opcode\n");

742 if(
p
->
m©ch_qty≥
 && 
	`gë_qty≥
(
quîy_pkt
Ë!gë_qty≥(
ª∂y
)) {

743 
	`vîbo£
(3, "bad qtype\n");

746 if(
p
->
m©ch_q«me
) {

747 if(!
	`gë_ow√r
(
quîy_pkt
Ë|| !gë_ow√r(
ª∂y
) ||

748 
	`ldns_d«me_com∑ª
(

749 
	`gë_ow√r
(
quîy_pkt
), gë_ow√r(
ª∂y
)) != 0) {

750 
	`vîbo£
(3, "bad qname\n");

754 if(
p
->
m©ch_subdomaö
) {

755 if(!
	`gë_ow√r
(
quîy_pkt
Ë|| !gë_ow√r(
ª∂y
) ||

756 (
	`ldns_d«me_com∑ª
(
	`gë_ow√r
(
quîy_pkt
),

757 
	`gë_ow√r
(
ª∂y
)) != 0 &&

758 !
	`ldns_d«me_is_subdomaö
(

759 
	`gë_ow√r
(
quîy_pkt
), gë_ow√r(
ª∂y
))))

761 
	`vîbo£
(3, "bad subdomain\n");

765 if(
p
->
m©ch_£rül
 && 
	`gë_£rül
(
quîy_pkt
Ë!p->
ix‰_sﬂ_£rül
) {

766 
	`vîbo£
(3, "bad serial\n");

769 if(
p
->
m©ch_do
 && !
	`ldns_pkt_edns_do
(
quîy_pkt
)) {

770 
	`vîbo£
(3, "no DO bit set\n");

773 if(
p
->
m©ch_n€dns
 && 
	`ldns_pkt_edns
(
quîy_pkt
)) {

774 
	`vîbo£
(3, "bad; EDNS OPTÖresent\n");

777 if(
p
->
m©ch_ednsd©a_øw
 &&

778 !
	`m©ch_ednsd©a
(
quîy_pkt
, 
p
->
ª∂y_li°
)) {

779 
	`vîbo£
(3, "bad EDNS data match.\n");

782 if(
p
->
m©ch_å™•‹t
 !
å™•‹t_™y
 &&Ö->m©ch_å™•‹à!
å™•‹t
) {

783 
	`vîbo£
(3, "badÅransport\n");

786 if(
p
->
m©ch_Æl
 && !
	`m©ch_Æl
(
quîy_pkt
, 
ª∂y
,Ö->
m©ch_âl
)) {

787 
	`vîbo£
(3, "badállmatch\n");

790 
	`vîbo£
(3, "match!\n");

791  
p
;

793  
NULL
;

794 
	}
}

797 
	$adju°_∑ckë
(
íåy
* 
m©ch
, 
ldns_pkt
* 
™swî_pkt
,Üdns_pkt* 
quîy_pkt
)

800 if(
m©ch
->
c›y_id
)

801 
	`ldns_pkt_£t_id
(
™swî_pkt
, 
	`ldns_pkt_id
(
quîy_pkt
));

802 if(
m©ch
->
c›y_quîy
) {

803 
ldns_º_li°
* 
li°
 = 
	`ldns_pkt_gë_£˘i⁄_˛⁄e
(
quîy_pkt
,

804 
LDNS_SECTION_QUESTION
);

805 
	`ldns_º_li°_dìp_‰ì
(
	`ldns_pkt_que°i⁄
(
™swî_pkt
));

806 
	`ldns_pkt_£t_que°i⁄
(
™swî_pkt
, 
li°
);

808 if(
m©ch
->
¶ì±ime
 > 0) {

809 
	`vîbo£
(3, "¶ìpög f‹ %d sec⁄ds\n", 
m©ch
->
¶ì±ime
);

810 #ifde‡
HAVE_SLEEP


811 
	`¶ìp
(
m©ch
->
¶ì±ime
);

813 
	`SÀï
(
m©ch
->
¶ì±ime
 * 1000);

816 
	}
}

823 
h™dÀ_quîy
(
uöt8_t
* 
öbuf
, 
ssize_t
 
öÀn
, 
íåy
* 
íåõs
, * 
cou¡
,

824 
å™•‹t_ty≥
 
å™•‹t
, (*
£ndfunc
)(
uöt8_t
*, 
size_t
, *),

825 * 
u£rd©a
, 
FILE
* 
vîbo£_out
)

827 
ldns_°©us
 
°©us
;

828 
ldns_pkt
 *
quîy_pkt
 = 
NULL
;

829 
ldns_pkt
 *
™swî_pkt
 = 
NULL
;

830 
ª∂y_∑ckë
 *
p
;

831 
ldns_º
 *
quîy_º
 = 
NULL
;

832 
uöt8_t
 *
outbuf
 = 
NULL
;

833 
size_t
 
™swî_size
 = 0;

834 
íåy
*É¡ry = 
NULL
;

835 
ldns_rdf
 *
°›_comm™d
 = 
	`ldns_d«me_√w_‰m_°r
("server.stop.");

837 
°©us
 = 
	`ldns_wúe2pkt
(&
quîy_pkt
, 
öbuf
, (
size_t
)
öÀn
);

838 i‡(
°©us
 !
LDNS_STATUS_OK
) {

839 
	`vîbo£
(1, "GŸ badÖackë: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

840 
	`ldns_rdf_‰ì
(
°›_comm™d
);

844 
quîy_º
 = 
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
quîy_pkt
), 0);

845 
	`vîbo£
(1, "quîy %d: id %d: %†%d byãs: ", ++(*
cou¡
), ()
	`ldns_pkt_id
(
quîy_pkt
),

846 (
å™•‹t
==
å™•‹t_t˝
)?"TCP":"UDP", ()
öÀn
);

847 if(
vîbo£_out
Ë
	`ldns_º_¥öt
(vîbo£_out, 
quîy_º
);

848 if(
vîbo£_out
Ë
	`ldns_pkt_¥öt
(vîbo£_out, 
quîy_pkt
);

850 i‡(
	`ldns_º_gë_ty≥
(
quîy_º
Ë=
LDNS_RR_TYPE_TXT
 &&

851 
	`ldns_º_gë_˛ass
(
quîy_º
Ë=
LDNS_RR_CLASS_CH
 &&

852 
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
quîy_º
), 
°›_comm™d
) == 0) {

853 
	`exô
(0);

857 
íåy
 = 
	`föd_m©ch
(
íåõs
, 
quîy_pkt
, 
å™•‹t
);

858 if(!
íåy
 || !íåy->
ª∂y_li°
) {

859 
	`vîbo£
(1, "noánswerÖacket forÅhis query,ÇoÑeply.\n");

860 
	`ldns_pkt_‰ì
(
quîy_pkt
);

861 
	`ldns_rdf_‰ì
(
°›_comm™d
);

864 
p
 = 
íåy
->
ª∂y_li°
;Ö;Ö =Ö->
√xt
)

866 
	`vîbo£
(3, "AnswerÖkt:\n");

867 i‡(
p
->
ª∂y_‰om_hex
) {

871 
°©us
 = 
	`ldns_buf„r2pkt_wúe
(&
™swî_pkt
, 
p
->
ª∂y_‰om_hex
);

872 i‡(
°©us
 =
LDNS_STATUS_OK
) {

873 
	`adju°_∑ckë
(
íåy
, 
™swî_pkt
, 
quîy_pkt
);

874 if(
vîbo£_out
Ë
	`ldns_pkt_¥öt
(vîbo£_out, 
™swî_pkt
);

875 
°©us
 = 
	`ldns_pkt2wúe
(&
outbuf
, 
™swî_pkt
, &
™swî_size
);

876 
	`vîbo£
(2, "AnswîÖackë size: %u byãs.\n", ()
™swî_size
);

877 i‡(
°©us
 !
LDNS_STATUS_OK
) {

878 
	`vîbo£
(1, "Eº‹ cª©ögánswî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

879 
	`ldns_pkt_‰ì
(
quîy_pkt
);

880 
	`ldns_rdf_‰ì
(
°›_comm™d
);

883 
	`ldns_pkt_‰ì
(
™swî_pkt
);

884 
™swî_pkt
 = 
NULL
;

886 
	`vîbo£
(3, "CouldÇŸÖ¨£ hex d©®(%s), sídög hex d©®dúe˘ly.\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

888 
™swî_size
 = 
	`ldns_buf„r_ˇ∑côy
(
p
->
ª∂y_‰om_hex
);

889 
outbuf
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
™swî_size
);

890 
	`mem˝y
(
outbuf
, 
	`ldns_buf„r_begö
(
p
->
ª∂y_‰om_hex
), 
™swî_size
);

891 if(
íåy
->
c›y_id
) {

892 
	`ldns_wrôe_uöt16
(
outbuf
,

893 
	`ldns_pkt_id
(
quîy_pkt
));

897 
™swî_pkt
 = 
	`ldns_pkt_˛⁄e
(
p
->
ª∂y
);

898 
	`adju°_∑ckë
(
íåy
, 
™swî_pkt
, 
quîy_pkt
);

899 if(
vîbo£_out
Ë
	`ldns_pkt_¥öt
(vîbo£_out, 
™swî_pkt
);

900 
°©us
 = 
	`ldns_pkt2wúe
(&
outbuf
, 
™swî_pkt
, &
™swî_size
);

901 
	`vîbo£
(1, "AnswîÖackë size: %u byãs.\n", ()
™swî_size
);

902 i‡(
°©us
 !
LDNS_STATUS_OK
) {

903 
	`vîbo£
(1, "Eº‹ cª©ögánswî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

904 
	`ldns_pkt_‰ì
(
quîy_pkt
);

905 
	`ldns_rdf_‰ì
(
°›_comm™d
);

908 
	`ldns_pkt_‰ì
(
™swî_pkt
);

909 
™swî_pkt
 = 
NULL
;

911 if(
p
->
∑ckë_¶ìp
) {

912 
	`vîbo£
(3, "sleeping forÇextÖacket %d secs\n",

913 
p
->
∑ckë_¶ìp
);

914 #ifde‡
HAVE_SLEEP


915 
	`¶ìp
(
p
->
∑ckë_¶ìp
);

917 
	`SÀï
(
p
->
∑ckë_¶ìp
 * 1000);

919 
	`vîbo£
(3, "wakeup forÇextÖacket "

920 "(¶ïà%d secs)\n", 
p
->
∑ckë_¶ìp
);

922 
	`£ndfunc
(
outbuf
, 
™swî_size
, 
u£rd©a
);

923 
	`LDNS_FREE
(
outbuf
);

924 
outbuf
 = 
NULL
;

925 
™swî_size
 = 0;

927 
	`ldns_pkt_‰ì
(
quîy_pkt
);

928 
	`ldns_rdf_‰ì
(
°›_comm™d
);

929 
	}
}

932 
	$dñëe_ª∂yli°
(
ª∂y_∑ckë
* 
ª∂i°
)

934 
ª∂y_∑ckë
 *
p
=
ª∂i°
, *
≈
;

935 
p
) {

936 
≈
 = 
p
->
√xt
;

937 
	`ldns_pkt_‰ì
(
p
->
ª∂y
);

938 
	`ldns_buf„r_‰ì
(
p
->
ª∂y_‰om_hex
);

939 
	`‰ì
(
p
);

940 
p
=
≈
;

942 
	}
}

944 
	$dñëe_íåy
(
íåy
* 
li°
)

946 
íåy
 *
p
=
li°
, *
≈
;

947 
p
) {

948 
≈
 = 
p
->
√xt
;

949 
	`dñëe_ª∂yli°
(
p
->
ª∂y_li°
);

950 
	`‰ì
(
p
);

951 
p
 = 
≈
;

953 
	}
}

	@examples/ldns-testpkts.h

10 #i‚de‡
LDNS_TESTPKTS_H


11 
	#LDNS_TESTPKTS_H


	)

140 
	~<ldns/ldns.h
>

143 
	eå™•‹t_ty≥
 {
	må™•‹t_™y
 = 0, 
	må™•‹t_udp
, 
	må™•‹t_t˝
 };

146 
	sª∂y_∑ckë
 {

148 
ª∂y_∑ckë
* 
	m√xt
;

150 
ldns_pkt
* 
	mª∂y
;

152 
ldns_buf„r
* 
	møw_ednsd©a
;

154 
ldns_buf„r
* 
	mª∂y_‰om_hex
;

156 
	m∑ckë_¶ìp
;

161 
	síåy
 {

165 
boﬁ
 
	mm©ch_›code
;

167 
boﬁ
 
	mm©ch_qty≥
;

169 
boﬁ
 
	mm©ch_q«me
;

171 
boﬁ
 
	mm©ch_subdomaö
;

173 
boﬁ
 
	mm©ch_£rül
;

175 
boﬁ
 
	mm©ch_Æl
;

177 
boﬁ
 
	mm©ch_âl
;

179 
boﬁ
 
	mm©ch_do
;

181 
boﬁ
 
	mm©ch_n€dns
;

183 
boﬁ
 
	mm©ch_ednsd©a_øw
;

185 
uöt32_t
 
	mix‰_sﬂ_£rül
;

187 
å™•‹t_ty≥
 
	mm©ch_å™•‹t
;

190 
ª∂y_∑ckë
 *
	mª∂y_li°
;

194 
boﬁ
 
	mc›y_id
;

196 
boﬁ
 
	mc›y_quîy
;

198 
	m¶ì±ime
;

201 
	mlöío
;

204 
íåy
* 
	m√xt
;

213 
íåy
* 
ªad_d©afûe
(c⁄° * 
«me
, 
skù_whôe•a˚
);

218 
dñëe_íåy
(
íåy
* 
li°
);

235 
íåy
* 
ªad_íåy
(
FILE
* 
ö
, c⁄° * 
«me
, *
löío
,

236 
uöt32_t
* 
deÁu…_âl
, 
ldns_rdf
** 
‹igö
,Üdns_rdf** 
¥ev_º
,

237 
skù_whôe•a˚
);

242 
íåy
* 
föd_m©ch
(íåy* 
íåõs
, 
ldns_pkt
* 
quîy_pkt
,

243 
å™•‹t_ty≥
 
å™•‹t
);

248 
adju°_∑ckë
(
íåy
* 
m©ch
, 
ldns_pkt
* 
™swî_pkt
,

249 
ldns_pkt
* 
quîy_pkt
);

264 
h™dÀ_quîy
(
uöt8_t
* 
öbuf
, 
ssize_t
 
öÀn
, 
íåy
* 
íåõs
,

265 * 
cou¡
, 
å™•‹t_ty≥
 
å™•‹t
,

266 (*
£ndfunc
)(
uöt8_t
*, 
size_t
, *), * 
u£rd©a
,

267 
FILE
* 
vîbo£_out
);

	@examples/ldns-update.c

9 
	~"c⁄fig.h
"

11 
	~<°rögs.h
>

12 
	~<ldns/ldns.h
>

15 
ldns_ªsﬁvî
 *

16 
	$ldns_upd©e_ªsﬁvî_√w
(c⁄° *
fqdn
, c⁄° *
z⁄e
,

17 
ldns_º_˛ass
 
˛ass
, 
uöt16_t
 
p‹t
, 
ldns_tsig_¸edítüls
 *
tsig_¸ed
, 
ldns_rdf
 **
z⁄e_rdf
)

19 
ldns_ªsﬁvî
 *
r1
, *
r2
;

20 
ldns_pkt
 *
quîy
 = 
NULL
, *
ª•
 = NULL;

21 
ldns_º_li°
 *
n¶i°
, *
ùli°
;

22 
ldns_rdf
 *
sﬂ_z⁄e
, *
sﬂ_m«me
 = 
NULL
, *
ns_«me
;

23 
size_t
 
i
;

24 
ldns_°©us
 
s
;

26 i‡(
˛ass
 == 0) {

27 
˛ass
 = 
LDNS_RR_CLASS_IN
;

30 i‡(
p‹t
 == 0) {

31 
p‹t
 = 
LDNS_PORT
;

35 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
r1
, 
NULL
);

36 i‡(
s
 !
LDNS_STATUS_OK
) {

37  
NULL
;

40 
r2
 = 
	`ldns_ªsﬁvî_√w
();

41 i‡(!
r2
) {

42 
bad
;

44 
	`ldns_ªsﬁvî_£t_p‹t
(
r2
, 
p‹t
);

47 i‡(
tsig_¸ed
) {

48 
	`ldns_ªsﬁvî_£t_tsig_Æg‹ôhm
(
r2
, 
	`ldns_tsig_Æg‹ôhm
(
tsig_¸ed
));

49 
	`ldns_ªsﬁvî_£t_tsig_key«me
(
r2
, 
	`ldns_tsig_key«me
(
tsig_¸ed
));

50 
	`ldns_ªsﬁvî_£t_tsig_keyd©a
(
r2
, 
	`ldns_tsig_keyd©a
(
tsig_¸ed
));

56 i‡(
z⁄e
) {

57 
sﬂ_z⁄e
 = 
	`ldns_d«me_√w_‰m_°r
(
z⁄e
);

58 i‡(
	`ldns_upd©e_sﬂ_m«me
(
sﬂ_z⁄e
, 
r1
, 
˛ass
, &
sﬂ_m«me
)

59 !
LDNS_STATUS_OK
) {

60 
bad
;

63 i‡(
	`ldns_upd©e_sﬂ_z⁄e_m«me
(
fqdn
, 
r1
, 
˛ass
, &
sﬂ_z⁄e
,

64 &
sﬂ_m«me
Ë!
LDNS_STATUS_OK
) {

65 
bad
;

70 *
z⁄e_rdf
 = 
	`ldns_rdf_˛⁄e
(
sﬂ_z⁄e
);

73 
quîy
 = 
	`ldns_pkt_quîy_√w
(
sﬂ_z⁄e
, 
LDNS_RR_TYPE_NS
, 
˛ass
, 
LDNS_RD
);

74 i‡(!
quîy
) {

75 
bad
;

77 
sﬂ_z⁄e
 = 
NULL
;

79 
	`ldns_pkt_£t_øndom_id
(
quîy
);

81 i‡(
	`ldns_ªsﬁvî_£nd_pkt
(&
ª•
, 
r1
, 
quîy
Ë!
LDNS_STATUS_OK
) {

82 
	`d¥ötf
("%s", "NS query failed!\n");

83 
bad
;

85 
	`ldns_pkt_‰ì
(
quîy
);

86 i‡(!
ª•
) {

87 
bad
;

90 
n¶i°
 = 
	`ldns_pkt_™swî
(
ª•
);

91 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
n¶i°
); i++) {

92 
ns_«me
 = 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
n¶i°
, 
i
), 0);

93 i‡(!
ns_«me
)

95 i‡(
	`ldns_rdf_com∑ª
(
sﬂ_m«me
, 
ns_«me
) == 0) {

97 
ùli°
 = 
	`ldns_gë_º_li°_addr_by_«me
(
r1
, 
ns_«me
, 
˛ass
, 0);

98 (Ë
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
r2
, 
ùli°
);

99 
	`ldns_º_li°_dìp_‰ì
(
ùli°
);

105 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
n¶i°
); i++) {

106 
ns_«me
 = 
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
n¶i°
, 
i
), 0);

107 i‡(!
ns_«me
)

109 i‡(
	`ldns_rdf_com∑ª
(
sﬂ_m«me
, 
ns_«me
) != 0) {

111 
ùli°
 = 
	`ldns_gë_º_li°_addr_by_«me
(
r1
, 
ns_«me
, 
˛ass
, 0);

112 (Ë
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(
r2
, 
ùli°
);

113 
	`ldns_º_li°_dìp_‰ì
(
ùli°
);

117 
	`ldns_ªsﬁvî_£t_øndom
(
r2
, 
Ál£
);

118 
	`ldns_pkt_‰ì
(
ª•
);

119 
	`ldns_ªsﬁvî_dìp_‰ì
(
r1
);

120 i‡(
sﬂ_m«me
)

121 
	`ldns_rdf_dìp_‰ì
(
sﬂ_m«me
);

122  
r2
;

124 
bad
:

125 i‡(
r1
)

126 
	`ldns_ªsﬁvî_dìp_‰ì
(
r1
);

127 i‡(
r2
)

128 
	`ldns_ªsﬁvî_dìp_‰ì
(
r2
);

129 i‡(
quîy
)

130 
	`ldns_pkt_‰ì
(
quîy
);

131 i‡(
ª•
)

132 
	`ldns_pkt_‰ì
(
ª•
);

133 i‡(
sﬂ_m«me
)

134 
	`ldns_rdf_dìp_‰ì
(
sﬂ_m«me
);

135  
NULL
;

136 
	}
}

139 
ldns_°©us


140 
	$ldns_upd©e_£nd_sim∂e_addr
(c⁄° *
fqdn
, c⁄° *
z⁄e
,

141 c⁄° *
ùaddr
, 
uöt16_t
 
p
, 
uöt32_t
 
âl
, 
ldns_tsig_¸edítüls
 *
tsig_¸ed
)

143 
ldns_ªsﬁvî
 *
ªs
;

144 
ldns_pkt
 *
u_pkt
 = 
NULL
, *
r_pkt
;

145 
ldns_º_li°
 *
up_ºli°
;

146 
ldns_º
 *
up_º
;

147 
ldns_rdf
 *
z⁄e_rdf
 = 
NULL
;

148 *
º°r
;

149 
uöt32_t
 
º°æí
, 
°©us
 = 
LDNS_STATUS_OK
;

151 i‡(!
fqdn
 || 
	`°æí
(fqdn) == 0)

152  
LDNS_STATUS_ERR
;

155 
ªs
 = 
	`ldns_upd©e_ªsﬁvî_√w
(
fqdn
, 
z⁄e
, 0, 
p
, 
tsig_¸ed
, &
z⁄e_rdf
);

156 i‡(!
ªs
 || !
z⁄e_rdf
) {

157 
˛ónup
;

161 
up_ºli°
 = 
	`ldns_º_li°_√w
();

162 i‡(!
up_ºli°
) {

163 
˛ónup
;

166 i‡(
ùaddr
) {

168 
º°æí
 = 
	`°æí
(
fqdn
Ë+  (" IN AAAA "Ë+ såÀn(
ùaddr
) + 1;

169 
º°r
 = (*)
	`mÆloc
(
º°æí
);

170 i‡(!
º°r
) {

171 
	`ldns_º_li°_dìp_‰ì
(
up_ºli°
);

172 
˛ónup
;

174 
	`¢¥ötf
(
º°r
, 
º°æí
, "%†IN %†%s", 
fqdn
,

175 
	`°rchr
(
ùaddr
, ':') ? "AAAA" : "A", ipaddr);

177 i‡(
	`ldns_º_√w_‰m_°r
(&
up_º
, 
º°r
, 
âl
, 
NULL
, NULL) !=

178 
LDNS_STATUS_OK
) {

179 
	`ldns_º_li°_dìp_‰ì
(
up_ºli°
);

180 
	`‰ì
(
º°r
);

181 
˛ónup
;

183 
	`‰ì
(
º°r
);

184 
	`ldns_º_li°_push_º
(
up_ºli°
, 
up_º
);

187 
up_º
 = 
	`ldns_º_√w
();

188 
	`ldns_º_£t_ow√r
(
up_º
, 
	`ldns_d«me_√w_‰m_°r
(
fqdn
));

189 
	`ldns_º_£t_âl
(
up_º
, 0);

190 
	`ldns_º_£t_˛ass
(
up_º
, 
LDNS_RR_CLASS_ANY
);

192 
	`ldns_º_£t_ty≥
(
up_º
, 
LDNS_RR_TYPE_A
);

193 
	`ldns_º_li°_push_º
(
up_ºli°
, 
	`ldns_º_˛⁄e
(
up_º
));

195 
	`ldns_º_£t_ty≥
(
up_º
, 
LDNS_RR_TYPE_AAAA
);

196 
	`ldns_º_li°_push_º
(
up_ºli°
, 
up_º
);

200 
u_pkt
 = 
	`ldns_upd©e_pkt_√w
(
z⁄e_rdf
, 
LDNS_RR_CLASS_IN
, 
NULL
, 
up_ºli°
, NULL);

201 
z⁄e_rdf
 = 
NULL
;

202 i‡(!
u_pkt
) {

203 
	`ldns_º_li°_dìp_‰ì
(
up_ºli°
);

204 
˛ónup
;

206 
	`ldns_pkt_£t_øndom_id
(
u_pkt
);

209 i‡(
tsig_¸ed
)

210 i‡(
	`ldns_upd©e_pkt_tsig_add
(
u_pkt
, 
ªs
Ë!
LDNS_STATUS_OK
) {

211 
˛ónup
;

214 i‡(
	`ldns_ªsﬁvî_£nd_pkt
(&
r_pkt
, 
ªs
, 
u_pkt
Ë!
LDNS_STATUS_OK
) {

215 
˛ónup
;

217 
	`ldns_pkt_‰ì
(
u_pkt
);

218 i‡(!
r_pkt
) {

219 
˛ónup
;

221 i‡(
	`ldns_pkt_gë_rcode
(
r_pkt
Ë!
LDNS_RCODE_NOERROR
) {

222 
ldns_lookup_èbÀ
 *
t
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
,

223 ()
	`ldns_pkt_gë_rcode
(
r_pkt
));

224 i‡(
t
) {

225 
	`d¥ötf
(";; UPDATEÑe•⁄£ wa†%s\n", 
t
->
«me
);

227 
	`d¥ötf
(";; UPDATEÑe•⁄£ wa†(%d)\n", 
	`ldns_pkt_gë_rcode
(
r_pkt
));

229 
°©us
 = 
LDNS_STATUS_ERR
;

231 
	`ldns_pkt_‰ì
(
r_pkt
);

232 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

233  
°©us
;

235 
˛ónup
:

236 i‡(
ªs
)

237 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

238 i‡(
u_pkt
)

239 
	`ldns_pkt_‰ì
(
u_pkt
);

240 i‡(
z⁄e_rdf
)

241 
	`ldns_rdf_dìp_‰ì
(
z⁄e_rdf
);

242  
LDNS_STATUS_ERR
;

243 
	}
}

247 
	$ußge
(
FILE
 *
Â
, *
¥og
)

249 
	`Ârötf
(
Â
, "%†domaö [z⁄e] i∞tsig_«mêtsig_ÆgÅsig_hmac\n", 
¥og
);

250 
	`Ârötf
(
Â
, " sendá dynamic updateÖacketÅo <ip>\n\n");

251 
	`Ârötf
(
Â
, " Use 'none' instead of ipÅoÑemoveányÖreviousáddress\n");

252 
	`Ârötf
(
Â
, " If 'zone' isÇot specified,ÅryÅo figure it out fromÅhe zone's SOA\n");

253 
	`Ârötf
(
Â
, " Exam∂e: %†my.exam∂e.‹g 1.2.3.4\n", 
¥og
);

254 
	}
}

258 
	$maö
(
¨gc
, **
¨gv
)

260 *
fqdn
, *
ùaddr
, *
z⁄e
, *
¥og
;

261 
ldns_°©us
 
ªt
;

262 
ldns_tsig_¸edítüls
 
tsig_¸
, *
tsig_¸ed
;

263 
c
 = 2;

264 
uöt32_t
 
de·é
 = 300;

265 
uöt32_t
 
p‹t
 = 5353;

267 
¥og
 = 
	`°rdup
(
¨gv
[0]);

269 
¨gc
) {

276 
	`ußge
(
°dîr
, 
¥og
);

277 
	`exô
(
EXIT_FAILURE
);

280 
fqdn
 = 
¨gv
[1];

281 
c
 = 2;

282 i‡(
¨gc
 == 4 ||árgc == 7) {

283 
z⁄e
 = 
¨gv
[
c
++];

285 
z⁄e
 = 
NULL
;

288 i‡(
	`°rcmp
(
¨gv
[
c
], "none") == 0) {

289 
ùaddr
 = 
NULL
;

291 
ùaddr
 = 
¨gv
[
c
];

293 
c
++;

294 i‡(
¨gc
 == 6 ||árgc == 7) {

295 
tsig_¸
.
key«me
 = 
¨gv
[
c
++];

296 i‡(
	`°∫ˇ£cmp
(
¨gv
[
c
], "hmac-sha1", 9) == 0) {

297 
tsig_¸
.
Æg‹ôhm
 = (*)"hmac-sha1.";

298 } i‡(
	`°∫ˇ£cmp
(
¨gv
[
c
], "hmac-md5", 8) == 0) {

299 
tsig_¸
.
Æg‹ôhm
 = (*)"hmac-md5.sig-alg.reg.int.";

301 
	`Ârötf
(
°dîr
, "Unknownálgorithm,Åry \"hmac-md5\" "

303 
	`exô
(
EXIT_FAILURE
);

305 
tsig_¸
.
keyd©a
 = 
¨gv
[++
c
];

306 
tsig_¸ed
 = &
tsig_¸
;

308 
tsig_¸ed
 = 
NULL
;

311 
	`¥ötf
(";;Årying UPDATE with FQDN \"%s\"ánd IP \"%s\"\n",

312 
fqdn
, 
ùaddr
 ? ipaddr : "<none>");

313 i‡(
¨gc
 == 6 ||árgc == 7) {

314 
	`¥ötf
(";;Åsig: \"%s\" \"%s\" \"%s\"\n", 
tsig_¸
.
key«me
,

315 
tsig_¸
.
Æg‹ôhm
,Åsig_¸.
keyd©a
);

318 
ªt
 = 
	`ldns_upd©e_£nd_sim∂e_addr
(
fqdn
, 
z⁄e
, 
ùaddr
, 
p‹t
, 
de·é
, 
tsig_¸ed
);

319 
	`exô
(
ªt
);

320 
	}
}

	@examples/ldns-verify-zone.c

11 
	~"c⁄fig.h
"

12 
	~<uni°d.h
>

13 
	~<°dlib.h
>

14 
	~<sys/time.h
>

16 
	~<ldns/ldns.h
>

18 
	~<î∫o.h
>

20 #ifde‡
HAVE_SSL


21 
	~<›ís¶/îr.h
>

23 
	gvîbosôy
 = 3;

24 
time_t
 
	gcheck_time
 = 0;

25 
öt32_t
 
	gö˚±i⁄_off£t
 = 0;

26 
öt32_t
 
	gexpú©i⁄_off£t
 = 0;

27 
boﬁ
 
	gdo_sigcha£
 = 
Ál£
;

28 
boﬁ
 
	gno_nom©ch_msg
 = 
Ál£
;

30 
FILE
* 
	gmyout
;

31 
FILE
* 
	gmyîr
;

34 
	$upd©e_îr‹
(
ldns_°©us
* 
ªsu…
,Üdns_°©u†
°©us
)

36 i‡(
°©us
 !
LDNS_STATUS_OK
) {

37 i‡(*
ªsu…
 =
LDNS_STATUS_OK
 || *ªsu… =
LDNS_STATUS_ERR
 ||

38 –*
ªsu…
 =
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY


39 && 
°©us
 !
LDNS_STATUS_ERR


41 *
ªsu…
 = 
°©us
;

44 
	}
}

47 
	$¥öt_ty≥
(
FILE
* 
°ªam
, 
ldns_º_ty≥
 
ty≥
)

49 c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
 = 
	`ldns_º_des¸ùt
(
ty≥
);

51 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

52 
	`Ârötf
(
°ªam
, "%s", 
des¸ùt‹
->
_«me
);

54 
	`Ârötf
(
°ªam
, "TYPE%u", 
ty≥
);

56 
	}
}

58 
ldns_°©us


59 
	$ªad_key_fûe
(c⁄° *
fûíame
, 
ldns_º_li°
 *
keys
)

61 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_ERR
;

62 
ldns_º
 *
º
;

63 
FILE
 *
Â
;

64 
uöt32_t
 
my_âl
 = 0;

65 
ldns_rdf
 *
my_‹igö
 = 
NULL
;

66 
ldns_rdf
 *
my_¥ev
 = 
NULL
;

67 
löe_ƒ
;

69 i‡(!(
Â
 = 
	`f›í
(
fûíame
, "r"))) {

70  
LDNS_STATUS_FILE_ERR
;

72 !
	`„of
(
Â
)) {

73 
°©us
 = 
	`ldns_º_√w_‰m_Â_l
(&
º
, 
Â
, &
my_âl
, &
my_‹igö
,

74 &
my_¥ev
, &
löe_ƒ
);

76 i‡(
°©us
 =
LDNS_STATUS_OK
) {

78 i‡–
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_DS


79 || 
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_DNSKEY
)

81 
	`ldns_º_li°_push_º
(
keys
, 
º
);

83 } i‡–
°©us
 =
LDNS_STATUS_SYNTAX_EMPTY


84 || 
°©us
 =
LDNS_STATUS_SYNTAX_TTL


85 || 
°©us
 =
LDNS_STATUS_SYNTAX_ORIGIN


86 || 
°©us
 =
LDNS_STATUS_SYNTAX_INCLUDE
)

88 
°©us
 = 
LDNS_STATUS_OK
;

92 
	`f˛o£
(
Â
);

93  
°©us
;

94 
	}
}

99 
	$¥öt_º_îr‹
(
FILE
* 
°ªam
, 
ldns_º
* 
º
, c⁄° * 
msg
)

101 i‡(
vîbosôy
 > 0) {

102 
	`Ârötf
(
°ªam
, "Eº‹: %†f‹ ", 
msg
);

103 
	`ldns_rdf_¥öt
(
°ªam
, 
	`ldns_º_ow√r
(
º
));

104 
	`Ârötf
(
°ªam
, "\t");

105 
	`¥öt_ty≥
(
°ªam
, 
	`ldns_º_gë_ty≥
(
º
));

106 
	`Ârötf
(
°ªam
, "\n");

108 
	}
}

111 
	$¥öt_º_°©us_îr‹
(
FILE
* 
°ªam
, 
ldns_º
* 
º
, 
ldns_°©us
 
°©us
)

113 i‡(
°©us
 !
LDNS_STATUS_OK
) {

114 
	`¥öt_º_îr‹
(
°ªam
, 
º
, 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

115 i‡(
vîbosôy
 > 0 && 
°©us
 =
LDNS_STATUS_SSL_ERR
) {

116 
	`ERR_lﬂd_¸y±o_°rögs
();

117 
	`ERR_¥öt_îr‹s_Â
(
°ªam
);

120 
	}
}

123 
	$¥öt_ºs_°©us_îr‹
(
FILE
* 
°ªam
, 
ldns_º_li°
* 
ºs
, 
ldns_°©us
 
°©us
,

124 
ldns_dns£c_ºs
* 
cur_sig
)

126 i‡(
°©us
 !
LDNS_STATUS_OK
) {

127 i‡(
	`ldns_º_li°_º_cou¡
(
ºs
) > 0) {

128 
	`¥öt_º_°©us_îr‹
(
°ªam
, 
	`ldns_º_li°_º
(
ºs
, 0),

129 
°©us
);

130 } i‡(
vîbosôy
 > 0) {

131 
	`Ârötf
(
°ªam
, "Error: %s for <unknown>\n",

132 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

134 i‡(
vîbosôy
 >= 4) {

135 
	`Ârötf
(
°ªam
, "RRSet:\n");

136 
	`ldns_º_li°_¥öt
(
°ªam
, 
ºs
);

137 
	`Ârötf
(
°ªam
, "Signature:\n");

138 
	`ldns_º_¥öt
(
°ªam
, 
cur_sig
->
º
);

139 
	`Ârötf
(
°ªam
, "\n");

142 
	}
}

144 
ldns_°©us


145 
ºsig_check_time_m¨gös
(
ldns_º
* 
ºsig


149 ,
time_t
 
check_time
, 
öt32_t
 
ö˚±i⁄_off£t
, i¡32_à
expú©i⁄_off£t


153 
öt32_t
 
	gö˚±i⁄
, 
	gexpú©i⁄
;

155 
	gö˚±i⁄
 = 
ldns_rdf2«tive_öt32
(
ldns_º_ºsig_ö˚±i⁄
 (
ºsig
));

156 
	gexpú©i⁄
 = 
ldns_rdf2«tive_öt32
(
ldns_º_ºsig_expú©i⁄
(
ºsig
));

158 i‡(((
	göt32_t
Ë(
	gcheck_time
 - 
	gö˚±i⁄_off£t
)Ë- 
	gö˚±i⁄
 < 0) {

159  
	gLDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED_WITHIN_MARGIN
;

161 i‡(
	gexpú©i⁄
 - ((
	göt32_t
Ë(
	gcheck_time
 + 
	gexpú©i⁄_off£t
)) < 0) {

162  
	gLDNS_STATUS_CRYPTO_SIG_EXPIRED_WITHIN_MARGIN
;

164  
	gLDNS_STATUS_OK
;

167 
ldns_°©us


168 
	$vîify_ºs
(
ldns_º_li°
* 
º£t_ºs
, 
ldns_dns£c_ºs
* 
cur_sig
,

169 
ldns_º_li°
* 
keys
)

171 
ldns_º_li°
* 
good_keys
;

172 
ldns_°©us
 
°©us
, 
ªsu…
 = 
LDNS_STATUS_OK
;

174 
cur_sig
) {

175 
good_keys
 = 
	`ldns_º_li°_√w
();

176 
°©us
 = 
	`ldns_vîify_ºsig_keyli°_time
(
º£t_ºs
, 
cur_sig
->
º
,

177 
keys
, 
check_time
, 
good_keys
);

178 
°©us
 = status ? status

179 : 
	`ºsig_check_time_m¨gös
(
cur_sig
->
º
);

180 i‡(
°©us
 !
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
 ||

181 !
no_nom©ch_msg
) {

183 
	`¥öt_ºs_°©us_îr‹
(
myîr
, 
º£t_ºs
, 
°©us
,

184 
cur_sig
);

186 
	`upd©e_îr‹
(&
ªsu…
, 
°©us
);

187 
	`ldns_º_li°_‰ì
(
good_keys
);

188 
cur_sig
 = cur_sig->
√xt
;

190  
ªsu…
;

191 
	}
}

193 
ldns_°©us


194 
	$vîify_dns£c_º£t
(
ldns_rdf
 *
z⁄e_«me
,Üdns_rd‡*
«me
,

195 
ldns_dns£c_º£ts
 *
º£t
, 
ldns_º_li°
 *
keys
)

197 
ldns_º_li°
 *
º£t_ºs
;

198 
ldns_dns£c_ºs
 *
cur_º
, *
cur_sig
;

199 
ldns_°©us
 
°©us
;

201 i‡(!
º£t
->
ºs
Ë 
LDNS_STATUS_OK
;

203 
º£t_ºs
 = 
	`ldns_º_li°_√w
();

204 
cur_º
 = 
º£t
->
ºs
;

205 
cur_º
 && cur_º->
º
) {

206 
	`ldns_º_li°_push_º
(
º£t_ºs
, 
cur_º
->
º
);

207 
cur_º
 = cur_º->
√xt
;

209 
cur_sig
 = 
º£t
->
sig«tuªs
;

210 i‡(
cur_sig
) {

211 
°©us
 = 
	`vîify_ºs
(
º£t_ºs
, 
cur_sig
, 
keys
);

214 i‡(
º£t
->
ty≥
 !
LDNS_RR_TYPE_NS
 ||

215 
	`ldns_d«me_com∑ª
(
«me
, 
z⁄e_«me
) == 0) {

217 
	`¥öt_º_îr‹
(
myîr
, 
º£t
->
ºs
->
º
, "no signatures");

218 
°©us
 = 
LDNS_STATUS_CRYPTO_NO_RRSIG
;

220 
°©us
 = 
LDNS_STATUS_OK
;

222 
	`ldns_º_li°_‰ì
(
º£t_ºs
);

224  
°©us
;

225 
	}
}

227 
ldns_°©us


228 
	$vîify_sögÀ_º
(
ldns_º
 *
º
, 
ldns_dns£c_ºs
 *
sig«tuª_ºs
,

229 
ldns_º_li°
 *
keys
)

231 
ldns_º_li°
 *
º£t_ºs
;

232 
ldns_°©us
 
°©us
;

234 
º£t_ºs
 = 
	`ldns_º_li°_√w
();

235 
	`ldns_º_li°_push_º
(
º£t_ºs
, 
º
);

237 
°©us
 = 
	`vîify_ºs
(
º£t_ºs
, 
sig«tuª_ºs
, 
keys
);

239 
	`ldns_º_li°_‰ì
(
º£t_ºs
);

241  
°©us
;

242 
	}
}

244 
ldns_°©us


245 
	$vîify_√xt_hashed_«me
(
ldns_dns£c_z⁄e
* 
z⁄e
, 
ldns_dns£c_«me
 *
«me
)

247 
ldns_rbnode_t
 *
√xt_node
;

248 
ldns_dns£c_«me
 *
√xt_«me
;

249 
cmp
;

250 *
√xt_ow√r_°r
;

251 
ldns_rdf
 *
√xt_ow√r_d«me
;

253 
	`as£π
(
«me
->
hashed_«me
 !
NULL
);

255 
√xt_node
 = 
	`ldns_rbåì_£¨ch
(
z⁄e
->
hashed_«mes
, 
«me
->
hashed_«me
);

256 
	`as£π
(
√xt_node
 !
NULL
);

258 
√xt_node
 = 
	`ldns_rbåì_√xt
(next_node);

259 i‡(
√xt_node
 =
LDNS_RBTREE_NULL
) {

260 
√xt_node
 = 
	`ldns_rbåì_fú°
(
z⁄e
->
hashed_«mes
);

262 
√xt_«me
 = (
ldns_dns£c_«me
 *Ë
√xt_node
->
d©a
;

263 } ! 
√xt_«me
->
n£c
);

265 
√xt_ow√r_°r
 = 
	`ldns_rdf2°r
(
	`ldns_n£c3_√xt_ow√r
(
«me
->
n£c
));

266 
√xt_ow√r_d«me
 = 
	`ldns_d«me_√w_‰m_°r
(
√xt_ow√r_°r
);

267 
cmp
 = 
	`ldns_d«me_com∑ª
(
√xt_ow√r_d«me
, 
√xt_«me
->
hashed_«me
);

268 
	`ldns_rdf_dìp_‰ì
(
√xt_ow√r_d«me
);

269 
	`LDNS_FREE
(
√xt_ow√r_°r
);

270 i‡(
cmp
 != 0) {

271 i‡(
vîbosôy
 > 0) {

272 
	`Ârötf
(
myîr
, "Error: The NSEC3Ñecord for ");

273 
	`ldns_rdf_¥öt
(
°dout
, 
«me
->name);

274 
	`Ârötf
(
myîr
, "ÖointsÅoÅhe wrongÇext hashed owner"

276 
	`ldns_rdf_¥öt
(
myîr
, 
√xt_«me
->
«me
);

277 
	`Ârötf
(
myîr
, ", whose hashedÇame is ");

278 
	`ldns_rdf_¥öt
(
myîr
, 
√xt_«me
->
hashed_«me
);

279 
	`Ârötf
(
myîr
, "\n");

281  
LDNS_STATUS_ERR
;

283  
LDNS_STATUS_OK
;

285 
	}
}

287 
boﬁ
 
	$z⁄e_is_n£c3_›tout
(
ldns_dns£c_z⁄e
* 
z⁄e
)

289 
ªmembî
 = -1;

291 i‡(
ªmembî
 == -1) {

292 
ªmembî
 = 
	`ldns_dns£c_z⁄e_is_n£c3_›tout
(
z⁄e
) ? 1 : 0;

294  
ªmembî
 == 1;

295 
	}
}

297 
ldns_°©us


298 
	$vîify_n£c
(
ldns_dns£c_z⁄e
* 
z⁄e
, 
ldns_rbnode_t
 *
cur_node
,

299 
ldns_º_li°
 *
keys
)

301 
ldns_rbnode_t
 *
√xt_node
;

302 
ldns_dns£c_«me
 *
«me
, *
√xt_«me
;

303 
ldns_°©us
 
°©us
, 
ªsu…
;

304 
ªsu…
 = 
LDNS_STATUS_OK
;

306 
«me
 = (
ldns_dns£c_«me
 *Ë
cur_node
->
d©a
;

307 i‡(
«me
->
n£c
) {

308 i‡(
«me
->
n£c_sig«tuªs
) {

309 
°©us
 = 
	`vîify_sögÀ_º
(
«me
->
n£c
,

310 
«me
->
n£c_sig«tuªs
, 
keys
);

312 
	`upd©e_îr‹
(&
ªsu…
, 
°©us
);

314 i‡(
vîbosôy
 > 0) {

315 
	`Ârötf
(
myîr
,

317 
	`ldns_rdf_¥öt
(
myîr
, 
«me
->name);

318 
	`Ârötf
(
myîr
, " hasÇo signatures\n");

320 
	`upd©e_îr‹
(&
ªsu…
, 
LDNS_STATUS_ERR
);

323 
	`ldns_º_gë_ty≥
(
«me
->
n£c
)) {

324 
LDNS_RR_TYPE_NSEC
:

326 
√xt_node
 = 
	`ldns_rbåì_√xt
(
cur_node
);

327 i‡(
√xt_node
 =
LDNS_RBTREE_NULL
) {

328 
√xt_node
 = 
	`ldns_rbåì_fú°
(

329 
z⁄e
->
«mes
);

331 
√xt_node
 = 
	`ldns_dns£c_«me_node_√xt_n⁄glue
(

332 
√xt_node
);

333 i‡(!
√xt_node
) {

334 
√xt_node
 =

335 
	`ldns_dns£c_«me_node_√xt_n⁄glue
(

336 
	`ldns_rbåì_fú°
(
z⁄e
->
«mes
));

338 
√xt_«me
 = (
ldns_dns£c_«me
*)
√xt_node
->
d©a
;

339 i‡(
	`ldns_d«me_com∑ª
(
√xt_«me
->
«me
,

340 
	`ldns_º_rdf
(
«me
->
n£c
,

342 i‡(
vîbosôy
 > 0) {

343 
	`Ârötf
(
myîr
, "Error:Åhe "

345 
	`ldns_rdf_¥öt
(
myîr
,

346 
«me
->name);

347 
	`Ârötf
(
myîr
, "ÖointsÅo "

351 i‡(
vîbosôy
 >= 4) {

352 
	`Ârötf
(
myîr
, "\t: ");

353 
	`ldns_rdf_¥öt
(
myîr
,

354 
	`ldns_º_rdf
(

355 
«me
->
n£c
,

357 
	`Ârötf
(
myîr
, " i.s.o. ");

358 
	`ldns_rdf_¥öt
(
myîr
,

359 
√xt_«me
->
«me
);

360 
	`Ârötf
(
myîr
, ".\n");

362 
	`upd©e_îr‹
(&
ªsu…
,

363 
LDNS_STATUS_ERR
);

366 
LDNS_RR_TYPE_NSEC3
:

372 
°©us
 = 
	`vîify_√xt_hashed_«me
(
z⁄e
, 
«me
);

373 
	`upd©e_îr‹
(&
ªsu…
, 
°©us
);

379 i‡(
	`z⁄e_is_n£c3_›tout
(
z⁄e
) &&

380 (
	`ldns_dns£c_«me_is_glue
(
«me
) ||

381 –
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(
«me
->
º£ts
,

382 
LDNS_RR_TYPE_NS
)

383 && !
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(
«me
->
º£ts
,

384 
LDNS_RR_TYPE_DS
)))) {

389 i‡(
vîbosôy
 > 0) {

390 
	`Ârötf
(
myîr
,

392 
	`ldns_rdf_¥öt
(
myîr
, 
«me
->name);

393 
	`Ârötf
(
myîr
, "\n");

395 
	`upd©e_îr‹
(&
ªsu…
, 
LDNS_STATUS_ERR
);

398  
ªsu…
;

399 
	}
}

401 
ldns_°©us


402 
	$vîify_dns£c_«me
(
ldns_rdf
 *
z⁄e_«me
, 
ldns_dns£c_z⁄e
* 
z⁄e
,

403 
ldns_rbnode_t
 *
cur_node
, 
ldns_º_li°
 *
keys
)

405 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

406 
ldns_°©us
 
°©us
;

407 
ldns_dns£c_º£ts
 *
cur_º£t
;

408 
ldns_dns£c_«me
 *
«me
;

409 
⁄_dñeg©i⁄_poöt
;

412 
«me
 = (
ldns_dns£c_«me
 *Ë
cur_node
->
d©a
;

413 i‡(
vîbosôy
 >= 5) {

414 
	`Ârötf
(
myout
, "Checking: ");

415 
	`ldns_rdf_¥öt
(
myout
, 
«me
->name);

416 
	`Ârötf
(
myout
, "\n");

419 i‡(
	`ldns_dns£c_«me_is_glue
(
«me
)) {

421 
cur_º£t
 = 
«me
->
º£ts
;

422 
cur_º£t
) {

423 i‡(
cur_º£t
->
sig«tuªs
) {

424 i‡(
vîbosôy
 > 0) {

425 
	`Ârötf
(
myîr
, "Error: ");

426 
	`ldns_rdf_¥öt
(
myîr
, 
«me
->name);

427 
	`Ârötf
(
myîr
, "\t");

428 
	`¥öt_ty≥
(
myîr
, 
cur_º£t
->
ty≥
);

429 
	`Ârötf
(
myîr
, " has signature(s),"

432 
ªsu…
 = 
LDNS_STATUS_ERR
;

434 
cur_º£t
 = cur_º£t->
√xt
;

436 i‡(
«me
->
n£c
) {

437 i‡(
vîbosôy
 > 0) {

438 
	`Ârötf
(
myîr
, "Error: ");

439 
	`ldns_rdf_¥öt
(
myîr
, 
«me
->name);

440 
	`Ârötf
(
myîr
, " hasán NSEC(3),"

443 
ªsu…
 = 
LDNS_STATUS_ERR
;

448 
⁄_dñeg©i⁄_poöt
 =

449 
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(
«me
->
º£ts
,

450 
LDNS_RR_TYPE_NS
)

451 && !
	`ldns_dns£c_º£ts_c⁄èös_ty≥
(
«me
->
º£ts
,

452 
LDNS_RR_TYPE_SOA
);

453 
cur_º£t
 = 
«me
->
º£ts
;

454 
cur_º£t
) {

459 i‡((
⁄_dñeg©i⁄_poöt
 &&

460 (
cur_º£t
->
ty≥
 =
LDNS_RR_TYPE_NS
 ||

461 
cur_º£t
->
ty≥
 =
LDNS_RR_TYPE_DS
)) ||

462 (!
⁄_dñeg©i⁄_poöt
 &&

463 
cur_º£t
->
ty≥
 !
LDNS_RR_TYPE_RRSIG
 &&

464 
cur_º£t
->
ty≥
 !
LDNS_RR_TYPE_NSEC
)) {

466 
°©us
 = 
	`vîify_dns£c_º£t
(
z⁄e_«me
,

467 
«me
->«me, 
cur_º£t
, 
keys
);

468 
	`upd©e_îr‹
(&
ªsu…
, 
°©us
);

470 
cur_º£t
 = cur_º£t->
√xt
;

472 
°©us
 = 
	`vîify_n£c
(
z⁄e
, 
cur_node
, 
keys
);

473 
	`upd©e_îr‹
(&
ªsu…
, 
°©us
);

475  
ªsu…
;

476 
	}
}

479 
	$add_keys_wôh_m©chög_ds
(
ldns_dns£c_º£ts
* 
‰om_keys
, 
ldns_º_li°
 *
dss
,

480 
ldns_º_li°
 *
to_keys
)

482 
size_t
 
i
;

483 
ldns_º
* 
ds_º
;

484 
ldns_dns£c_ºs
 *
cur_key
;

486 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
dss
); i++) {

488 i‡(
	`ldns_º_gë_ty≥
(
ds_º
 = 
	`ldns_º_li°_º
(
dss
, 
i
))

489 =
LDNS_RR_TYPE_DS
) {

491 
cur_key
 = 
‰om_keys
->
ºs
; cur_key;

492 
cur_key
 = cur_key->
√xt
 ) {

494 i‡(
	`ldns_º_com∑ª_ds
(
cur_key
->
º
, 
ds_º
)) {

495 
	`ldns_º_li°_push_º
(
to_keys
,

496 
cur_key
->
º
);

502 
	}
}

504 
ldns_°©us


505 
	$sigcha£
(
ldns_ªsﬁvî
* 
ªs
, 
ldns_rdf
 *
z⁄e_«me
, 
ldns_dns£c_º£ts
 *
z⁄ekeys
,

506 
ldns_º_li°
 *
keys
)

508 
ldns_dns£c_ºs
* 
cur_key
;

509 
ldns_°©us
 
°©us
;

510 
boﬁ
 
‰ì_ªsﬁvî
 = 
Ál£
;

511 
ldns_rdf
* 
∑ª¡_«me
;

512 
ldns_º_li°
* 
∑ª¡_keys
;

513 
ldns_º_li°
* 
ds_keys
;

515 
	`add_keys_wôh_m©chög_ds
(
z⁄ekeys
, 
keys
, keys);

522 
no_nom©ch_msg
 = 
do_sigcha£
;

523 
°©us
 = 
	`vîify_dns£c_º£t
(
z⁄e_«me
, z⁄e_«me, 
z⁄ekeys
, 
keys
);

524 
no_nom©ch_msg
 = 
Ál£
;

528 i‡(
do_sigcha£
 &&

529 
°©us
 =
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
 &&

530 
	`ldns_d«me_œbñ_cou¡
(
z⁄e_«me
) > 0 ) {

532 i‡(!
ªs
) {

533 i‡((
°©us
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
ªs
, 
NULL
))){

534 
	`ldns_ªsﬁvî_‰ì
(
ªs
);

535 i‡(
vîbosôy
 > 0) {

536 
	`Ârötf
(
myîr
,

539 
	`ldns_gë_îr‹°r_by_id
(
°©us
)

542  
°©us
;

544 
‰ì_ªsﬁvî
 = 
åue
;

545 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
,1);

546 
	`ldns_ªsﬁvî_£t_dns£c_cd
(
ªs
, 1);

548 i‡((
∑ª¡_«me
 = 
	`ldns_d«me_À·_ch›
(
z⁄e_«me
))) {

552 
∑ª¡_keys
 = 
	`ldns_„tch_vÆid_domaö_keys
(
ªs
,

553 
∑ª¡_«me
, 
keys
, &
°©us
);

554 
	`ldns_rdf_dìp_‰ì
(
∑ª¡_«me
);

559 
ds_keys
 = 
	`ldns_vÆid©e_domaö_ds
(
ªs
, 
z⁄e_«me
,

560 
∑ª¡_keys
);

561 
	`ldns_º_li°_‰ì
(
∑ª¡_keys
);

566 
	`add_keys_wôh_m©chög_ds
(
z⁄ekeys
, 
ds_keys
, 
keys
);

567 
	`ldns_º_li°_‰ì
(
ds_keys
);

572 
°©us
 = 
	`vîify_dns£c_º£t
(
z⁄e_«me
, zone_name,

573 
z⁄ekeys
, 
keys
);

575 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

577 i‡(
‰ì_ªsﬁvî
) {

578 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

585 i‡(
°©us
 =
LDNS_STATUS_OK
)

586 
cur_key
 = 
z⁄ekeys
->
ºs
; cur_key; cur_key = cur_key->
√xt
)

587 
	`ldns_º_li°_push_º
(
keys
, 
cur_key
->
º
);

588  
°©us
;

589 
	}
}

591 
ldns_°©us


592 
	$vîify_dns£c_z⁄e
(
ldns_dns£c_z⁄e
 *
dns£c_z⁄e
, 
ldns_rdf
 *
z⁄e_«me
,

593 
ldns_º_li°
 *
keys
, 
boﬁ
 
≠ex⁄ly
, 
≥r˚¡age
)

595 
ldns_rbnode_t
 *
cur_node
;

596 
ldns_dns£c_º£ts
 *
cur_key_º£t
;

597 
ldns_dns£c_ºs
 *
cur_key
;

598 
ldns_°©us
 
°©us
;

599 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_OK
;

601 
cur_key_º£t
 = 
	`ldns_dns£c_z⁄e_föd_º£t
(
dns£c_z⁄e
, 
z⁄e_«me
,

602 
LDNS_RR_TYPE_DNSKEY
);

603 i‡(!
cur_key_º£t
 || !cur_key_º£t->
ºs
) {

604 i‡(
vîbosôy
 > 0) {

605 
	`Ârötf
(
myîr
,

608 
ªsu…
 = 
LDNS_STATUS_ERR
;

611 i‡(
	`ldns_º_li°_º_cou¡
(
keys
) > 0) {

612 i‡((
ªsu…
 = 
	`sigcha£
(
NULL
, 
z⁄e_«me
, 
cur_key_º£t
,

613 
keys
)))

614 
îr‹
;

616 
cur_key
 = 
cur_key_º£t
->
ºs
; cur_key;

617 
cur_key
 = cur_key->
√xt
)

618 
	`ldns_º_li°_push_º
(
keys
, 
cur_key
->
º
);

620 
cur_node
 = 
	`ldns_rbåì_fú°
(
dns£c_z⁄e
->
«mes
);

621 i‡(
cur_node
 =
LDNS_RBTREE_NULL
) {

622 i‡(
vîbosôy
 > 0) {

623 
	`Ârötf
(
myîr
, "Error: Empty zone?\n");

625 
ªsu…
 = 
LDNS_STATUS_ERR
;

627 i‡(
≠ex⁄ly
) {

632 
	`as£π
–
cur_node
->
d©a
 =
dns£c_z⁄e
->
sﬂ
 );

638 
≥r˚¡age
 = 100;

640 
cur_node
 !
LDNS_RBTREE_NULL
) {

642 i‡(
≥r˚¡age
 == 100

643 || ((
	`øndom
(Ë% 100Ë>100 - 
≥r˚¡age
)) {

644 
°©us
 = 
	`vîify_dns£c_«me
(
z⁄e_«me
,

645 
dns£c_z⁄e
, 
cur_node
, 
keys
);

646 
	`upd©e_îr‹
(&
ªsu…
, 
°©us
);

647 i‡(
≠ex⁄ly
)

650 
cur_node
 = 
	`ldns_rbåì_√xt
(cur_node);

653 
îr‹
:

654 
	`ldns_º_li°_‰ì
(
keys
);

655  
ªsu…
;

656 
	}
}

659 
	$maö
(
¨gc
, **
¨gv
)

661 *
fûíame
;

662 
FILE
 *
Â
;

663 
löe_ƒ
 = 0;

664 
c
;

665 
ldns_°©us
 
s
;

666 
ldns_dns£c_z⁄e
 *
dns£c_z⁄e
 = 
NULL
;

667 
ldns_°©us
 
ªsu…
 = 
LDNS_STATUS_ERR
;

668 
boﬁ
 
≠ex⁄ly
 = 
Ál£
;

669 
≥r˚¡age
 = 100;

670 
tm
Åm;

671 
ldns_duøti⁄_ty≥
 *
duøti⁄
;

672 
ldns_º_li°
 *
keys
 = 
	`ldns_º_li°_√w
();

673 
size_t
 
nkeys
 = 0;

675 
check_time
 = 
	`ldns_time
(
NULL
);

676 
myout
 = 
°dout
;

677 
myîr
 = 
°dîr
;

679 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "ae:hi:k:vV:p:St:")) != -1) {

680 
c
) {

682 
≠ex⁄ly
 = 
åue
;

685 
	`¥ötf
("Ußge: %†[OPTIONS] <z⁄efûe>\n", 
¨gv
[0]);

686 
	`¥ötf
("\tReadsÅhe zonefileánd checks for DNSSEC "

688 
	`¥ötf
("\nIt checks whether NSEC(3)sáreÖresent, "

690 
	`¥ötf
("Itálso checksÅhe NSEC(3) chain, but it "

692 
	`¥ötf
("\nOPTIONS:\n");

693 
	`¥ötf
("\t-h\t\tshowÅhisÅext\n");

694 
	`¥ötf
("\t-a\t\tapex only, "

696 
	`¥ötf
("\t-e <period>\tsignatures mayÇotÉxpire "

699 
	`¥ötf
("\t-i <period>\tsignatures must have been "

703 
	`¥ötf
("\t-k <file>\tspecifyá fileÅhat containsá "

706 "\t\t\tDeÁu… i†%s", 
LDNS_TRUST_ANCHOR_FILE
);

707 
	`¥ötf
("\t-p [0-100]\tonly checksÅhisÖercentage of "

709 
	`¥ötf
("\t-S\t\tchase signature(s)Åoá known key. "

712 
	`¥ötf
("\t-t YYYYMMDDhhmmss | [+|-]offset\n\t\t\t"

719 
	`¥ötf
("\t-v\t\tshowsÅhe versionándÉxits\n");

720 
	`¥ötf
("\t-V [0-5]\tset verbosityÜevel (default 3)\n"

722 
	`¥ötf
("\n<period>sáre given "

725 
	`¥ötf
("\nifÇo file is given "

727 
	`exô
(
EXIT_SUCCESS
);

731 
duøti⁄
 = 
	`ldns_duøti⁄_¸óã_‰om_°rög
(
›èrg
);

732 i‡(!
duøti⁄
) {

733 i‡(
vîbosôy
 > 0) {

734 
	`Ârötf
(
myîr
,

740 
	`exô
(
EXIT_FAILURE
);

742 i‡(
c
 == 'e')

743 
expú©i⁄_off£t
 =

744 
	`ldns_duøti⁄2time
(
duøti⁄
);

746 
ö˚±i⁄_off£t
 =

747 
	`ldns_duøti⁄2time
(
duøti⁄
);

750 
s
 = 
	`ªad_key_fûe
(
›èrg
, 
keys
);

751 i‡(
s
 =
LDNS_STATUS_FILE_ERR
) {

752 i‡(
vîbosôy
 > 0) {

753 
	`Ârötf
(
myîr
,

755 
›èrg
, 
	`°ªº‹
(
î∫o
));

758 i‡(
s
 !
LDNS_STATUS_OK
) {

759 i‡(
vîbosôy
 > 0) {

760 
	`Ârötf
(
myîr
,

762 "%s: %s\n",
›èrg
,

763 
	`ldns_gë_îr‹°r_by_id
(
s
));

765 
	`exô
(
EXIT_FAILURE
);

767 i‡(
	`ldns_º_li°_º_cou¡
(
keys
Ë=
nkeys
) {

768 i‡(
vîbosôy
 > 0) {

769 
	`Ârötf
(
myîr
,

771 
›èrg
);

773 
	`exô
(
EXIT_FAILURE
);

775 
nkeys
 = 
	`ldns_º_li°_º_cou¡
(
keys
);

778 
≥r˚¡age
 = 
	`©oi
(
›èrg
);

779 i‡(
≥r˚¡age
 < 0 ||Öercentage > 100) {

780 i‡(
vîbosôy
 > 0) {

781 
	`Ârötf
(
myîr
,

785 
	`exô
(
EXIT_FAILURE
);

787 
	`§™dom
(
	`time
(
NULL
Ë^ 
	`gëpid
());

790 
do_sigcha£
 = 
åue
;

794 i‡(
	`°æí
(
›èrg
) == 14 &&

795 
	`ssˇnf
(
›èrg
, "%4d%2d%2d%2d%2d%2d",

796 &
tm
.
tm_yór
, &tm.
tm_m⁄
,

797 &
tm
.
tm_mday
, &tm.
tm_hour
,

798 &
tm
.
tm_mö
 , &tm.
tm_£c
 ) == 6) {

800 
tm
.
tm_yór
 -= 1900;

801 
tm
.
tm_m⁄
--;

802 
check_time
 = 
	`ldns_mktime_‰om_utc
(&
tm
);

805 
check_time
 +
	`©oi
(
›èrg
);

809 
	`¥ötf
("verify-zone version %s (ldns version %s)\n",

810 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

811 
	`exô
(
EXIT_SUCCESS
);

814 
vîbosôy
 = 
	`©oi
(
›èrg
);

818 i‡(
do_sigcha£
 && 
nkeys
 == 0) {

819 (Ë
	`ªad_key_fûe
(
LDNS_TRUST_ANCHOR_FILE
, 
keys
);

820 
nkeys
 = 
	`ldns_º_li°_º_cou¡
(
keys
);

822 i‡(
nkeys
 == 0) {

823 i‡(
vîbosôy
 > 0) {

824 
	`Ârötf
(
myîr
, "UnableÅo chase "

827 
	`exô
(
EXIT_FAILURE
);

831 
¨gc
 -
›töd
;

832 
¨gv
 +
›töd
;

834 i‡(
¨gc
 == 0) {

835 
Â
 = 
°dö
;

837 
fûíame
 = 
¨gv
[0];

839 
Â
 = 
	`f›í
(
fûíame
, "r");

840 i‡(!
Â
) {

841 i‡(
vîbosôy
 > 0) {

842 
	`Ârötf
(
myîr
, "UnableÅo open %s: %s\n",

843 
fûíame
, 
	`°ªº‹
(
î∫o
));

845 
	`exô
(
EXIT_FAILURE
);

849 
s
 = 
	`ldns_dns£c_z⁄e_√w_‰m_Â_l
(&
dns£c_z⁄e
, 
Â
, 
NULL
, 0,

850 
LDNS_RR_CLASS_IN
, &
löe_ƒ
);

851 i‡(
s
 =
LDNS_STATUS_OK
) {

852 i‡(!
dns£c_z⁄e
->
sﬂ
) {

853 i‡(
vîbosôy
 > 0) {

854 
	`Ârötf
(
myîr
,

857 
	`exô
(
EXIT_FAILURE
);

860 
ªsu…
 = 
	`ldns_dns£c_z⁄e_m¨k_glue
(
dns£c_z⁄e
);

861 i‡(
ªsu…
 !
LDNS_STATUS_OK
) {

862 i‡(
vîbosôy
 > 0) {

863 
	`Ârötf
(
myîr
,

868 i‡(
vîbosôy
 >= 5) {

869 
	`ldns_dns£c_z⁄e_¥öt
(
myout
, 
dns£c_z⁄e
);

872 
ªsu…
 = 
	`vîify_dns£c_z⁄e
(
dns£c_z⁄e
,

873 
dns£c_z⁄e
->
sﬂ
->
«me
, 
keys
, 
≠ex⁄ly
,

874 
≥r˚¡age
);

876 i‡(
ªsu…
 =
LDNS_STATUS_OK
) {

877 i‡(
vîbosôy
 >= 3) {

878 
	`Ârötf
(
myout
,

882 i‡(
vîbosôy
 > 0) {

883 
	`Ârötf
(
myîr
,

888 
	`ldns_dns£c_z⁄e_dìp_‰ì
(
dns£c_z⁄e
);

890 i‡(
vîbosôy
 > 0) {

891 
	`Ârötf
(
myîr
, "%sát %d\n",

892 
	`ldns_gë_îr‹°r_by_id
(
s
), 
löe_ƒ
);

894 
	`exô
(
EXIT_FAILURE
);

896 
	`f˛o£
(
Â
);

898 
	`exô
(
ªsu…
);

899 
	}
}

904 
	$maö
(
¨gc
, **
¨gv
)

906 
	`Ârötf
(
°dîr
, "ldns-verify-zoneÇeeds OpenSSL support, "

909 
	}
}

	@examples/ldns-version.c

8 
	~"c⁄fig.h
"

9 
	~<ldns/ldns.h
>

12 
	$maö
()

14 
	`¥ötf
("%s\n", 
	`ldns_vîsi⁄
());

16 
	}
}

	@examples/ldns-walk.c

9 
	~"c⁄fig.h
"

11 
	~<ldns/ldns.h
>

13 
	gvîbosôy
 = 0;

16 
	$ußge
(
FILE
 *
Â
, *
¥og
) {

17 
	`Ârötf
(
Â
, "%†[›ti⁄s] domaö\n", 
¥og
);

18 
	`Ârötf
(
Â
, "Örint outÅhe ownerÇames for domainándÅheÑecordÅypes forÅhoseÇames\n");

19 
	`Ârötf
(
Â
, "OPTIONS:\n");

20 
	`Ârötf
(
Â
, "-4\t\tonly use IPv4\n");

21 
	`Ârötf
(
Â
, "-6\t\tonly use IPv6\n");

22 
	`Ârötf
(
Â
, "-f\t\tfull; getállÑrsets instead of onlyáÜist ofÇamesándÅypes\n");

23 
	`Ârötf
(
Â
, "-s <name>\t\tStart fromÅhisÇame\n");

24 
	`Ârötf
(
Â
, "-v <verbosity>\t\tVerbosityÜevel [1-5]\n");

25 
	`Ârötf
(
Â
, "-version\tShow versionándÉxit\n");

26 
	`Ârötf
(
Â
, "@<nameserver>\t\tUseÅhisÇameserver\n");

28 
	}
}

30 
ldns_rdf
 *

31 
	$¸óã_d«me_∂us_1
(
ldns_rdf
 *
d«me
)

33 
uöt8_t
 *
wúe
;

34 
ldns_rdf
 *
√wd«me
;

35 
uöt8_t
 
œbñÀn
;

36 
size_t
 
pos
;

37 
ldns_°©us
 
°©us
;

38 
size_t
 
i
;

40 
	`ldns_d«me2ˇn⁄iˇl
(
d«me
);

41 
œbñÀn
 = 
	`ldns_rdf_d©a
(
d«me
)[0];

42 i‡(
vîbosôy
 >= 3) {

43 
	`¥ötf
("Create +e for ");

44 
	`ldns_rdf_¥öt
(
°dout
, 
d«me
);

45 
	`¥ötf
("\n");

47 i‡(
œbñÀn
 < 63) {

48 
wúe
 = 
	`mÆloc
(
	`ldns_rdf_size
(
d«me
) + 1);

49 i‡(!
wúe
) {

50 
	`Ârötf
(
°dîr
, "MallocÉrror: out of memory?\n");

51 
	`exô
(127);

53 
wúe
[0] = 
œbñÀn
 + 1;

54 
	`mem˝y
(&
wúe
[1], 
	`ldns_rdf_d©a
(
d«me
Ë+ 1, 
œbñÀn
);

55 
	`mem˝y
(&
wúe
[
œbñÀn
+1], 
	`ldns_rdf_d©a
(
d«me
Ë+ÜabñÀn, 
	`ldns_rdf_size
(dname) -Üabellen);

56 
wúe
[
œbñÀn
+1] = (
uöt8_t
) '\000';

57 
pos
 = 0;

58 
°©us
 = 
	`ldns_wúe2d«me
(&
√wd«me
, 
wúe
, 
	`ldns_rdf_size
(
d«me
Ë+ 1, &
pos
);

59 
	`‰ì
(
wúe
);

61 
wúe
 = 
	`mÆloc
(
	`ldns_rdf_size
(
d«me
));

62 i‡(!
wúe
) {

63 
	`Ârötf
(
°dîr
, "MallocÉrror: out of memory?\n");

64 
	`exô
(127);

66 
wúe
[0] = 
œbñÀn
;

67 
	`mem˝y
(&
wúe
[1], 
	`ldns_rdf_d©a
(
d«me
Ë+ 1, 
œbñÀn
);

68 
	`mem˝y
(&
wúe
[
œbñÀn
], 
	`ldns_rdf_d©a
(
d«me
Ë+ÜabñÀn, 
	`ldns_rdf_size
(dname) -Üabellen);

69 
i
 = 
œbñÀn
;

70 
wúe
[
i
] == 255) {

71 i‡(
i
 == 0) {

72 
	`¥ötf
("Error, don't know howÅoádd 1ÅoáÜabel with maximumÜengthándáll values on 255\n");

73 
	`exô
(9);

75 
i
--;

78 
wúe
[
i
] = wire[i] + 1;

79 
pos
 = 0;

80 
°©us
 = 
	`ldns_wúe2d«me
(&
√wd«me
, 
wúe
, 
	`ldns_rdf_size
(
d«me
Ë+ 1, &
pos
);

81 
	`‰ì
(
wúe
);

83 i‡(
vîbosôy
 >= 3) {

84 
	`¥ötf
("result: ");

85 
	`ldns_rdf_¥öt
(
°dout
, 
√wd«me
);

86 
	`¥ötf
("\n");

89 i‡(
°©us
 !
LDNS_STATUS_OK
) {

90 
	`¥ötf
("Eº‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

91 
	`exô
(10);

94  
√wd«me
;

95 
	}
}

97 
ldns_rdf
 *

98 
	$¸óã_∂us_1_d«me
(
ldns_rdf
 *
d«me
)

100 
ldns_rdf
 *
œbñ
;

101 
ldns_°©us
 
°©us
;

103 i‡(
vîbosôy
 >= 3) {

104 
	`¥ötf
("CreatingÇ+e for: ");

105 
	`ldns_rdf_¥öt
(
°dout
, 
d«me
);

106 
	`¥ötf
("\n");

109 
	`ldns_d«me2ˇn⁄iˇl
(
d«me
);

110 
°©us
 = 
	`ldns_°r2rdf_d«me
(&
œbñ
, "\\000");

111 i‡(
°©us
 !
LDNS_STATUS_OK
) {

112 
	`¥ötf
("îr‹ cª©ög \\000 d«me: %s\n\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

113 
	`exô
(2);

115 
°©us
 = 
	`ldns_d«me_ˇt
(
œbñ
, 
d«me
);

116 i‡(
°©us
 !
LDNS_STATUS_OK
) {

117 
	`¥ötf
("îr‹ c©tög \\000 d«me: %s\n\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

118 
	`exô
(3);

120  
œbñ
;

121 
	}
}

123 
ldns_°©us


124 
	$quîy_ty≥_bôm≠s
(
ldns_ªsﬁvî
 *
ªs
,

125 
uöt16_t
 
ªs_Êags
,

126 c⁄° 
ldns_rdf
 *
«me
,

127 c⁄° 
ldns_rdf
 *
rdf
)

132 
uöt8_t
 
wödow_block_ƒ
;

133 
uöt8_t
 
bôm≠_Àngth
;

134 
uöt16_t
 
ty≥
;

135 
uöt16_t
 
pos
 = 0;

136 
uöt16_t
 
bô_pos
;

137 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

139 
ldns_pkt
 *
™swî_pkt
;

140 *
îr°r
;

142 i‡(
vîbosôy
 >= 3) {

143 
	`¥ötf
("Getting Resource Records covered by NSECát ");

144 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

145 
	`¥ötf
("\n");

148 
pos
 < 
	`ldns_rdf_size
(
rdf
)) {

149 
wödow_block_ƒ
 = 
d©a
[
pos
];

150 
bôm≠_Àngth
 = 
d©a
[
pos
 + 1];

151 
pos
 += 2;

153 
bô_pos
 = 0; bô_po†< (
bôm≠_Àngth
) * 8; bit_pos++) {

154 i‡(
	`ldns_gë_bô
(&
d©a
[
pos
], 
bô_pos
)) {

155 
ty≥
 = 256 * (
uöt16_t
Ë
wödow_block_ƒ
 + 
bô_pos
;

157 i‡(
ty≥
 !
LDNS_RR_TYPE_NSEC
 &&

158 
ty≥
 !
LDNS_RR_TYPE_RRSIG
) {

159 i‡(
vîbosôy
 >= 3) {

160 
	`¥ötf
("querying for:\n");

161 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

162 
	`¥ötf
("Åy≥ %u\n", (Ë
ty≥
);

164 
™swî_pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
«me
, 
ty≥
,

165 
LDNS_RR_CLASS_IN
,

166 
ªs_Êags
);

167 i‡(
™swî_pkt
) {

168 i‡(
vîbosôy
 >= 5) {

169 
	`ldns_pkt_¥öt
(
°dout
, 
™swî_pkt
);

179 
	`ldns_º_li°_¥öt
(
°dout
,

180 
	`ldns_pkt_™swî
(
™swî_pkt
));

181 
	`ldns_pkt_‰ì
(
™swî_pkt
);

183 
	`¥ötf
("QueryÉrror, bailing out\n");

184 
	`¥ötf
("Failedát ");

185 
	`ldns_rdf_¥öt
(
°dout
, 
«me
);

186 
îr°r
 = 
	`ldns_º_ty≥2°r
(
ty≥
);

187 
	`¥ötf
(" %s\n", 
îr°r
);

188 
	`‰ì
(
îr°r
);

189 
	`exô
(1);

195 
pos
 +(
uöt16_t
Ë
bôm≠_Àngth
;

198  
LDNS_STATUS_OK
;

199 
	}
}

203 
	$maö
(
¨gc
, *
¨gv
[])

205 
ldns_°©us
 
°©us
;

207 
ldns_ªsﬁvî
 *
ªs
;

208 
ldns_rdf
 *
domaö
 = 
NULL
;

209 
ldns_pkt
 *
p
;

210 
ldns_º
 *
sﬂ
;

211 
ldns_º_li°
 *
ºli°
;

212 
ldns_º_li°
 *
ºli°2
;

213 
ldns_º_li°
 *
n£c_sigs
 = 
NULL
;

214 
ldns_rdf
 *
sﬂ_p1
;

215 
ldns_rdf
 *
√xt_d«me
;

216 
ldns_rdf
 *
œ°_d«me
;

217 
ldns_rdf
 *
œ°_d«me_p
;

218 
ldns_rdf
 *
°¨çoöt
 = 
NULL
;

219 
ldns_º
 *
n£c_º
 = 
NULL
;

220 c⁄° * 
¨g_domaö
 = 
NULL
;

221 
fuŒ
 = 0;

223 *
£rv
 = 
NULL
;

224 
ldns_rdf
 *
£rv_rdf
;

225 
ldns_ªsﬁvî
 *
cmdlöe_ªs
;

226 
ldns_º_li°
 *
cmdlöe_º_li°
;

227 
ldns_rdf
 *
cmdlöe_d«me
;

229 
uöt8_t
 
Ám
 = 
LDNS_RESOLV_INETANY
;

230 
ªsu…
 = 0;

231 
i
;

232 *
¨g_íd_±r
 = 
NULL
;

233 
size_t
 
j
;

235 
p
 = 
NULL
;

236 
ºli°
 = 
NULL
;

237 
ºli°2
 = 
NULL
;

238 
sﬂ
 = 
NULL
;

239 
domaö
 = 
NULL
;

241 i‡(
¨gc
 < 2) {

242 
	`ußge
(
°dout
, 
¨gv
[0]);

243 
	`exô
(
EXIT_FAILURE
);

245 
i
 = 1; i < 
¨gc
; i++) {

246 i‡(
	`°∫cmp
(
¨gv
[
i
], "-4", 3) == 0) {

247 i‡(
Ám
 !
LDNS_RESOLV_INETANY
) {

248 
	`Ârötf
(
°dîr
, "You can only specify one of -4 or -6\n");

249 
	`exô
(1);

251 
Ám
 = 
LDNS_RESOLV_INET
;

252 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-6", 3) == 0) {

253 i‡(
Ám
 !
LDNS_RESOLV_INETANY
) {

254 
	`Ârötf
(
°dîr
, "You can only specify one of -4 or -6\n");

255 
	`exô
(1);

257 
Ám
 = 
LDNS_RESOLV_INET6
;

258 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-f", 3) == 0) {

259 
fuŒ
 = 
åue
;

260 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-s", 3) == 0) {

261 i‡(
i
 + 1 < 
¨gc
) {

262 i‡(!
	`ldns_°r2rdf_d«me
(&
°¨çoöt
, 
¨gv
[
i
 + 1]Ë=
LDNS_STATUS_OK
) {

263 
	`¥ötf
("Bad sèπÖoöà«me: %s\n", 
¨gv
[
i
 + 1]);

264 
	`exô
(1);

267 
	`¥ötf
("Missingárgument for -s\n");

268 
	`exô
(1);

270 
i
++;

271 } i‡(
	`°∫cmp
(
¨gv
[
i
], "-v", 3) == 0) {

272 i‡(
i
 + 1 < 
¨gc
) {

273 
vîbosôy
 = 
	`°πﬁ
(
¨gv
[
i
+1], &
¨g_íd_±r
, 10);

274 i‡(*
¨g_íd_±r
 != '\0') {

275 
	`¥ötf
("Badárgumíàf‹ -v: %s\n", 
¨gv
[
i
+1]);

276 
	`exô
(1);

279 
	`¥ötf
("Missingárgument for -v\n");

280 
	`exô
(1);

282 
i
++;

283 } i‡(
	`°rcmp
("-vîsi⁄", 
¨gv
[
i
]) == 0) {

284 
	`¥ötf
("dn†z⁄êwÆkî, vîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

285 
exô
;

287 i‡(
¨gv
[
i
][0] == '@') {

288 i‡(
	`°æí
(
¨gv
[
i
]) == 1) {

289 i‡(
i
 + 1 < 
¨gc
) {

290 
£rv
 = 
¨gv
[
i
 + 1];

291 
i
++;

293 
	`¥ötf
("Missingárgument for -s\n");

294 
	`exô
(1);

297 
£rv
 = 
¨gv
[
i
] + 1;

300 i‡(
i
 < 
¨gc
) {

301 i‡(!
domaö
) {

303 
¨g_domaö
 = 
¨gv
[
i
];

304 
domaö
 = 
	`ldns_d«me_√w_‰m_°r
(
¨g_domaö
);

305 i‡(!
domaö
) {

306 
	`ußge
(
°dout
, 
¨gv
[0]);

307 
	`exô
(1);

310 
	`¥ötf
("One domainátáÅimeÖlease\n");

311 
	`exô
(1);

314 
	`¥ötf
("No domain givenÅo walk\n");

315 
	`exô
(1);

321 i‡(!
domaö
) {

322 
	`¥ötf
("Missingárgument\n");

323 
	`exô
(1);

328 if(!
£rv
) {

329 i‡(
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
ªs
, 
NULL
Ë!
LDNS_STATUS_OK
) {

330 
	`Ârötf
(
°dîr
, "%s", "CouldÇot createÑesolver obj");

331 
ªsu…
 = 
EXIT_FAILURE
;

332 
exô
;

335 
ªs
 = 
	`ldns_ªsﬁvî_√w
();

336 i‡(!
ªs
 || 
	`°æí
(
£rv
) <= 0) {

337 
ªsu…
 = 
EXIT_FAILURE
;

338 
exô
;

341 
£rv_rdf
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_A
, 
£rv
);

342 i‡(!
£rv_rdf
) {

344 
£rv_rdf
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_AAAA
, 
£rv
);

346 i‡(!
£rv_rdf
) {

348 
°©us
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
cmdlöe_ªs
, 
NULL
);

350 i‡(
°©us
 !
LDNS_STATUS_OK
) {

351 
	`Ârötf
(
°dîr
, "%s", "@server ip couldÇot be converted");

352 
ªsu…
 = 
EXIT_FAILURE
;

353 
exô
;

356 
cmdlöe_d«me
 = 
	`ldns_d«me_√w_‰m_°r
(
£rv
);

357 
cmdlöe_º_li°
 = 
	`ldns_gë_º_li°_addr_by_«me
(

358 
cmdlöe_ªs
,

359 
cmdlöe_d«me
,

360 
LDNS_RR_CLASS_IN
,

362 
	`ldns_rdf_dìp_‰ì
(
cmdlöe_d«me
);

363 
	`ldns_ªsﬁvî_dìp_‰ì
(
cmdlöe_ªs
);

364 i‡(!
cmdlöe_º_li°
) {

365 
	`Ârötf
(
°dîr
, "%†%s", "couldÇŸ födányáddªs†f‹Åhê«me: ", 
£rv
);

366 
ªsu…
 = 
EXIT_FAILURE
;

367 
exô
;

369 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º_li°
(

370 
ªs
,

371 
cmdlöe_º_li°


372 Ë!
LDNS_STATUS_OK
) {

373 
	`Ârötf
(
°dîr
, "%s", "pushingÇameserver");

374 
ªsu…
 = 
EXIT_FAILURE
;

375 
	`ldns_º_li°_dìp_‰ì
(
cmdlöe_º_li°
);

376 
exô
;

378 
	`ldns_º_li°_dìp_‰ì
(
cmdlöe_º_li°
);

381 i‡(
	`ldns_ªsﬁvî_push_«me£rvî
(
ªs
, 
£rv_rdf
Ë!
LDNS_STATUS_OK
) {

382 
	`Ârötf
(
°dîr
, "%s", "pushingÇameserver");

383 
ªsu…
 = 
EXIT_FAILURE
;

384 
exô
;

386 
	`ldns_rdf_dìp_‰ì
(
£rv_rdf
);

392 
	`ldns_ªsﬁvî_£t_dns£c
(
ªs
, 
åue
);

393 
	`ldns_ªsﬁvî_£t_dns£c_cd
(
ªs
, 
åue
);

394 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
, 
Ám
);

396 i‡(!
ªs
) {

397 
	`exô
(2);

403 i‡(
vîbosôy
 >= 3) {

404 
	`¥ötf
("\nQuerying for: ");

405 
	`ldns_rdf_¥öt
(
°dout
, 
domaö
);

406 
	`¥ötf
("\n");

408 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
domaö
, 
LDNS_RR_TYPE_SOA
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

409 
sﬂ
 = 
NULL
;

410 i‡(
vîbosôy
 >= 5) {

411 i‡(
p
) {

412 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

414 
	`Ârötf
(
°dout
, "No Packet Received fromÜdns_resolver_query()\n");

418 i‡(!
p
) {

419 
	`exô
(3);

424 
ºli°
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_SOA
, 
LDNS_SECTION_ANSWER
);

425 i‡(!
ºli°
 || 
	`ldns_º_li°_º_cou¡
(rrlist) != 1) {

426 i‡(
ºli°
) {

427 
	`¥ötf
(" *** > 1 SOA: %u\n", (Ë
	`ldns_º_li°_º_cou¡
(
ºli°
));

429 
	`¥ötf
(" *** NoÑrlist...\b");

432 
	`Ârötf
(
°dîr
,

434 
¨g_domaö
);

435 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

436 
	`ldns_pkt_‰ì
(
p
);

437 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

438 
	`exô
(4);

440 
sﬂ
 = 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
ºli°
, 0));

441 
	`ldns_º_li°_dìp_‰ì
(
ºli°
);

442 
ºli°
 = 
NULL
;

444 
ºli°
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_RRSIG
, 
LDNS_SECTION_ANSWER
);

445 i‡(!
ºli°
) {

446 
	`¥ötf
("No DNSSEC dataÑeceived;ÉitherÅhe zone isÇot secured or you should query it directly (with @nameserver)\n");

447 
	`ldns_pkt_‰ì
(
p
);

448 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

449 
	`exô
(5);

451 
	`ldns_º_li°_dìp_‰ì
(
ºli°
);

456 
°©us
 = 
	`ldns_°r2rdf_d«me
(&
sﬂ_p1
, "\\000");

457 i‡(
°©us
 !
LDNS_STATUS_OK
) {

458 
	`¥ötf
("îr‹: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

460 i‡(!
sﬂ
) {

461 
	`¥ötf
("Error getting SOA\n");

462 
	`exô
(1);

465 i‡(
°¨çoöt
) {

466 
œ°_d«me
 = 
°¨çoöt
;

467 
œ°_d«me_p
 = 
	`¸óã_d«me_∂us_1
(
œ°_d«me
);

469 
œ°_d«me
 = 
	`ldns_rdf_˛⁄e
(
domaö
);

470 i‡(
	`ldns_d«me_ˇt
(
sﬂ_p1
, 
œ°_d«me
Ë!
LDNS_STATUS_OK
) {

471 
	`¥ötf
("Error concatenating dnames\n");

472 
	`exô
(
EXIT_FAILURE
);

474 
œ°_d«me_p
 = 
	`ldns_rdf_˛⁄e
(
sﬂ_p1
);

477 i‡(!
fuŒ
) {

478 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_ow√r
(
sﬂ
));

479 
	`¥ötf
("\t");

482 
√xt_d«me
 = 
NULL
;

483 !
√xt_d«me
 || 
	`ldns_rdf_com∑ª
“ext_d«me, 
domaö
) != 0) {

484 i‡(
p
) {

485 
	`ldns_pkt_‰ì
(
p
);

486 
p
 = 
NULL
;

488 i‡(
vîbosôy
 >= 4) {

489 
	`¥ötf
("Querying for: ");

490 
	`ldns_rdf_¥öt
(
°dout
, 
œ°_d«me_p
);

491 
	`¥ötf
("\n");

493 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
œ°_d«me_p
, 
LDNS_RR_TYPE_DS
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

494 i‡(
vîbosôy
 >= 5) {

495 i‡(
p
) {

496 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

498 
	`Ârötf
(
°dout
, "No Packet Received fromÜdns_resolver_query()\n");

502 i‡(
√xt_d«me
) {

503 
	`ldns_rdf_dìp_‰ì
(
√xt_d«me
);

504 
	`ldns_º_‰ì
(
n£c_º
);

505 
√xt_d«me
 = 
NULL
;

506 
n£c_º
 = 
NULL
;

509 i‡(!
p
) {

510 
	`Ârötf
(
°dîr
, "ErrorÅryingÅoÑesolve: ");

511 
	`ldns_rdf_¥öt
(
°dîr
, 
œ°_d«me_p
);

512 
	`Ârötf
(
°dîr
, "\n");

513 !
p
) {

514 i‡(
vîbosôy
 >= 3) {

515 
	`¥ötf
("Querying for: ");

516 
	`ldns_rdf_¥öt
(
°dout
, 
œ°_d«me_p
);

517 
	`¥ötf
("\n");

519 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
œ°_d«me_p
, 
LDNS_RR_TYPE_DS
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

521 
j
 = 0; j < 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
ªs
); j++) {

522 i‡(
	`ldns_ªsﬁvî_«me£rvî_πt
(
ªs
, 
j
) != 0) {

523 
	`ldns_ªsﬁvî_£t_«me£rvî_πt
(
ªs
, 
j
, 
LDNS_RESOLV_RTT_MIN
);

526 i‡(
vîbosôy
 >= 5) {

527 i‡(
p
) {

528 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

530 
	`Ârötf
(
°dout
, "No Packet Received fromÜdns_resolver_query()\n");

540 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë=
LDNS_RCODE_SERVFAIL
) {

541 
	`ldns_pkt_‰ì
(
p
);

542 
p
 = 
NULL
;

543 i‡(
vîbosôy
 >= 3) {

544 
	`¥ötf
("Querying for: ");

545 
	`ldns_rdf_¥öt
(
°dout
, 
œ°_d«me
);

546 
	`¥ötf
("\n");

548 
p
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
œ°_d«me
, 
LDNS_RR_TYPE_DS
, 
LDNS_RR_CLASS_IN
, 
LDNS_RD
);

549 i‡(
vîbosôy
 >= 5) {

550 i‡(
p
) {

551 
	`ldns_pkt_¥öt
(
°dout
, 
p
);

553 
	`Ârötf
(
°dout
, "No Packet Received fromÜdns_resolver_query()\n");

557 i‡(!
p
) {

558 
	`exô
(51);

560 
ºli°
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_NSEC
, 
LDNS_SECTION_AUTHORITY
);

561 
ºli°2
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_NSEC
, 
LDNS_SECTION_ANSWER
);

563 
ºli°
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_NSEC
, 
LDNS_SECTION_AUTHORITY
);

564 
ºli°2
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_NSEC
, 
LDNS_SECTION_ANSWER
);

566 i‡(
ºli°
 && 
ºli°2
) {

567 
	`ldns_º_li°_ˇt
(
ºli°
, 
ºli°2
);

568 } i‡(
ºli°2
) {

569 
ºli°
 = 
ºli°2
;

572 i‡(!
ºli°
 || 
	`ldns_º_li°_º_cou¡
(rrlist) < 1) {

573 i‡(!
ºli°
) {

574 
	`fÊush
(
°dout
);

575 
	`Ârötf
(
°dîr
, "Zone doesÇot seemÅo be DNSSEC secured,"

577 
	`fÊush
(
°dîr
);

578 
exô
;

582 
√xt_d«me
 = 
NULL
;

583 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
ºli°
); j++) {

584 i‡(
	`ldns_n£c_covîs_«me
(
	`ldns_º_li°_º
(
ºli°
, 
j
), 
œ°_d«me_p
)) {

585 i‡(
vîbosôy
 >= 3) {

586 
	`¥ötf
("The domainÇame: ");

587 
	`ldns_rdf_¥öt
(
°dout
, 
œ°_d«me_p
);

588 
	`¥ötf
("\nis covered by NSEC: ");

589 
	`ldns_º_¥öt
(
°dout
, 
	`ldns_º_li°_º
(
ºli°
, 
j
));

591 
√xt_d«me
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_rdf
(
	`ldns_º_li°_º
(
ºli°
, 
j
), 0));

592 
n£c_º
 = 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
ºli°
, 
j
));

593 
n£c_sigs
 = 
	`ldns_dns£c_pkt_gë_ºsigs_f‹_«me_™d_ty≥
(
p
, 
	`ldns_º_ow√r
(
n£c_º
), 
LDNS_RR_TYPE_NSEC
);

595 i‡(
vîbosôy
 >= 4) {

596 
	`¥ötf
("\n");

597 
	`ldns_rdf_¥öt
(
°dout
, 
œ°_d«me_p
);

598 
	`¥ötf
("\nNOT covered by NSEC: ");

599 
	`ldns_º_¥öt
(
°dout
, 
	`ldns_º_li°_º
(
ºli°
, 
j
));

600 
	`¥ötf
("\n");

604 i‡(!
√xt_d«me
) {

605 
	`¥ötf
("ErrorÇoÇsec for ");

606 
	`ldns_rdf_¥öt
(
°dout
, 
œ°_d«me
);

607 
	`¥ötf
("\n");

608 
	`exô
(1);

610 
	`ldns_º_li°_dìp_‰ì
(
ºli°
);

612 i‡(!
√xt_d«me
) {

616 i‡(
œ°_d«me_p
) {

617 
	`ldns_rdf_dìp_‰ì
(
œ°_d«me_p
);

619 
œ°_d«me_p
 = 
	`¸óã_∂us_1_d«me
(
œ°_d«me
);

621 i‡(
œ°_d«me
) {

622 i‡(
	`ldns_rdf_com∑ª
(
œ°_d«me
, 
√xt_d«me
) == 0) {

623 
	`¥ötf
("\n\nNext dname isÅhe sameás current,Åhis wouldÜoop forever. This isáÖroblemÅhat usually occurs when walkingÅhroughá caching forwarder. Try usingÅheáuthoritativeÇameserverÅo walk (with @nameserver).\n");

624 
	`exô
(2);

626 
	`ldns_rdf_dìp_‰ì
(
œ°_d«me
);

628 
œ°_d«me
 = 
	`ldns_rdf_˛⁄e
(
√xt_d«me
);

629 i‡(
œ°_d«me_p
) {

630 
	`ldns_rdf_dìp_‰ì
(
œ°_d«me_p
);

632 
œ°_d«me_p
 = 
	`¸óã_d«me_∂us_1
(
œ°_d«me
);

633 i‡(!
fuŒ
) {

634 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_ow√r
(
n£c_º
));

635 
	`¥ötf
(" ");

636 
	`ldns_rdf_¥öt
(
°dout
, 
	`ldns_º_rdf
(
n£c_º
, 1));

637 
	`¥ötf
("\n");

642 
°©us
 = 
	`quîy_ty≥_bôm≠s
(
ªs
, 
LDNS_RD
, 
	`ldns_º_ow√r
(
n£c_º
),

643 
	`ldns_º_rdf
(
n£c_º
, 1));

645 
	`ldns_º_¥öt
(
°dout
, 
n£c_º
);

646 i‡(
n£c_sigs
) {

647 
	`ldns_º_li°_¥öt
(
°dout
, 
n£c_sigs
);

648 
	`ldns_º_li°_‰ì
(
n£c_sigs
);

649 
n£c_sigs
 = 
NULL
;

656 
	`ldns_rdf_dìp_‰ì
(
domaö
);

657 
	`ldns_rdf_dìp_‰ì
(
sﬂ_p1
);

658 
	`ldns_rdf_dìp_‰ì
(
œ°_d«me_p
);

659 
	`ldns_rdf_dìp_‰ì
(
œ°_d«me
);

660 
	`ldns_rdf_dìp_‰ì
(
√xt_d«me
);

661 
	`ldns_º_‰ì
(
n£c_º
);

662 
	`ldns_pkt_‰ì
(
p
);

664 
	`ldns_º_‰ì
(
sﬂ
);

666 
	`¥ötf
("\n\n");

667 
	`ldns_ªsﬁvî_dìp_‰ì
(
ªs
);

669 
exô
:

670  
ªsu…
;

671 
	}
}

	@examples/ldns-zcat.c

17 
	~"c⁄fig.h
"

18 
	~<î∫o.h
>

19 
	~<ldns/ldns.h
>

21 
	#FIRST_ZONE
 0

	)

22 
	#MIDDLE_ZONE
 1

	)

23 
	#LAST_ZONE
 2

	)

26 
	$ußge
(
FILE
 *
f
, *
¥og«me
)

28 
	`Ârötf
(
f
, "Ußge: %†[OPTIONS] <z⁄efûes>\n", 
¥og«me
);

29 
	`Ârötf
(
f
, " Concatenate signed zone snippets created withÜdns-zsplit\n");

30 
	`Ârötf
(
f
, " backÅogether. The generate zone file isÖrintedÅo stdout\n");

31 
	`Ârötf
(
f
, " TheÇew zone should beÉqualÅoÅhe original zone (before splitting)\n");

32 
	`Ârötf
(
f
, "OPTIONS:\n");

33 
	`Ârötf
(
f
, "-o ORIGIN\tUseÅhisás initial origin, for zones starting with @\n");

34 
	`Ârötf
(
f
, "-v\t\tShowÅhe versionÇumberándÉxit\n");

35 
	}
}

38 
	$maö
(
¨gc
, **
¨gv
)

40 *
¥og«me
;

41 
FILE
 *
Â
;

42 
c
;

43 
ldns_rdf
 *
‹igö
;

44 
size_t
 
i
, 
j
;

45 
whîe
;

46 
ldns_z⁄e
 *
z
;

47 
ldns_º_li°
 *
zº
;

48 
ldns_º
 *
cuºít_º
;

49 
ldns_º
 *
sﬂ
;

50 
ldns_rdf
 *
œ°_ow√r
;

51 
ldns_º
 *
œ°_º
;

52 
ldns_º
 *
p›_º
;

54 
¥og«me
 = 
	`°rdup
(
¨gv
[0]);

55 
‹igö
 = 
NULL
;

57 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "o:v")) != -1) {

58 
c
) {

60 
‹igö
 = 
	`ldns_d«me_√w_‰m_°r
(
	`°rdup
(
›èrg
));

61 i‡(!
‹igö
) {

62 
	`Ârötf
(
°dîr
, "C™nŸ c⁄vîàthê‹igö %†tÿ®domaö«me\n", 
›èrg
);

63 
	`exô
(
EXIT_FAILURE
);

67 
	`¥ötf
("z⁄êfûêc⁄ˇã«t‹ vîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

68 
	`exô
(
EXIT_SUCCESS
);

71 
	`Ârötf
(
°dîr
, "Unrecognized option\n");

72 
	`ußge
(
°dout
, 
¥og«me
);

73 
	`exô
(
EXIT_FAILURE
);

77 
¨gc
 -
›töd
;

78 
¨gv
 +
›töd
;

80 i‡(
¨gc
 < 1) {

81 
	`ußge
(
°dout
, 
¥og«me
);

82 
	`exô
(
EXIT_FAILURE
);

85 
i
 = 0; i < (
size_t
)
¨gc
; i++) {

87 i‡(!(
Â
 = 
	`f›í
(
¨gv
[
i
], "r"))) {

88 
	`Ârötf
(
°dîr
, "Eº‹ o≥nög key fûê%s: %s\n", 
¨gv
[
i
], 
	`°ªº‹
(
î∫o
));

89 
	`exô
(
EXIT_FAILURE
);

92 i‡(
	`ldns_z⁄e_√w_‰m_Â
(&
z
, 
Â
, 
‹igö
, 0, 0Ë!
LDNS_STATUS_OK
) {

93 
	`Ârötf
(
°dîr
, "Z⁄êfûê%†couldÇŸ bê∑r£d c‹ª˘ly\n", 
¨gv
[
i
]);

94 
	`exô
(
EXIT_FAILURE
);

97 
zº
 = 
	`ldns_z⁄e_ºs
(
z
);

98 
sﬂ
 = 
	`ldns_z⁄e_sﬂ
(
z
);

100 
	`Ârötf
(
°dîr
, "%s\n", 
¨gv
[
i
]);

102 i‡(0 =
i
) {

103 
whîe
 = 
FIRST_ZONE
;

106 
œ°_º
 = 
	`ldns_º_li°_p›_º
(
zº
);

107 
œ°_ow√r
 = 
	`ldns_º_ow√r
(
œ°_º
);

110 
p›_º
 = 
	`ldns_º_li°_p›_º
(
zº
);

111 } 
	`ldns_rdf_com∑ª
(
œ°_ow√r
, 
	`ldns_º_ow√r
(
p›_º
)) == 0) ;

113 
	`ldns_º_li°_push_º
(
zº
, 
p›_º
);

114 } i‡((
size_t
)(
¨gc
 - 1Ë=
i
) {

115 
whîe
 = 
LAST_ZONE
;

117 
whîe
 = 
MIDDLE_ZONE
;

120 
œ°_º
 = 
	`ldns_º_li°_p›_º
(
zº
);

121 
œ°_ow√r
 = 
	`ldns_º_ow√r
(
œ°_º
);

124 
p›_º
 = 
	`ldns_º_li°_p›_º
(
zº
);

125 } 
	`ldns_rdf_com∑ª
(
œ°_ow√r
, 
	`ldns_º_ow√r
(
p›_º
)) == 0) ;

127 
	`ldns_º_li°_push_º
(
zº
, 
p›_º
);

131 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
zº
); j++) {

133 
cuºít_º
 = 
	`ldns_º_li°_º
(
zº
, 
j
);

135 
whîe
) {

136 
FIRST_ZONE
:

137 i‡(
sﬂ
) {

138 
	`ldns_º_¥öt
(
°dout
, 
sﬂ
);

139 
sﬂ
 = 
NULL
;

142 
MIDDLE_ZONE
:

149 i‡(
	`ldns_rdf_com∑ª
(
	`ldns_º_ow√r
(
cuºít_º
),

150 
	`ldns_º_ow√r
(
sﬂ
)) == 0) {

154 
LAST_ZONE
:

161 i‡(
	`ldns_rdf_com∑ª
(
	`ldns_º_ow√r
(
cuºít_º
),

162 
	`ldns_º_ow√r
(
sﬂ
)) == 0) {

167 
	`ldns_º_¥öt
(
°dout
, 
cuºít_º
);

170 
	`exô
(
EXIT_SUCCESS
);

171 
	}
}

	@examples/ldns-zsplit.c

17 
	~"c⁄fig.h
"

18 
	~<î∫o.h
>

19 
	~<ldns/ldns.h
>

21 
	#DEFAULT_SPLIT
 1000

	)

22 
	#FILE_SIZE
 255

	)

23 
	#SPLIT_MAX
 999

	)

24 
	#NO_SPLIT
 0

	)

25 
	#INTENT_TO_SPLIT
 1

	)

26 
	#SPLIT_NOW
 2

	)

29 
	$ußge
(
FILE
 *
f
, *
¥og«me
)

31 
	`Ârötf
(
f
, "Ußge: %†[OPTIONS] <z⁄efûe> [keys]\n", 
¥og«me
);

32 
	`Ârötf
(
f
, " Cutá zone file intoÖieces,ÉachÖart isÖut iná file\n");

33 
	`Ârötf
(
f
, "Çamed: '<zonefile>.NNN'. Where NNN isá integerÑanging 000Åo 999.\n");

34 
	`Ârötf
(
f
, " If key filesáre givenÅheyáre inserted inÉachÖart.\n");

35 
	`Ârötf
(
f
, " The original SOA isálso included inÉachÖart, makingÅhem correct DNS\n");

36 
	`Ârötf
(
f
, " (mini) zones.\n");

37 
	`Ârötf
(
f
, " This utility can be usedÅoÖarallel signáÜarge zone.\n");

38 
	`Ârötf
(
f
, " To make it workÅhe original zoneÇeedsÅo be canonical ordered.\n");

39 
	`Ârötf
(
f
, "\nOPTIONS:\n");

40 
	`Ârötf
(
f
, " -n NUMBER\tsplitáfterÅhis many RRs\n");

41 
	`Ârötf
(
f
, " -o ORIGIN\tuseÅhisás initial origin, for zones starting with @\n");

42 
	`Ârötf
(
f
, " -z\t\tsortÅhe zoneÖriorÅo splitting. The currentÜdns zone\n");

43 
	`Ârötf
(
f
, " \t\timplementation makesÅhis unuseable forÜarge zones.\n");

44 
	`Ârötf
(
f
, " -v\t\tshow versionÇumberándÉxit\n");

45 
	}
}

49 
ldns_º_li°
 *

50 
	$›í_keyfûes
(**
fûes
, 
uöt16_t
 
fûec
)

52 
uöt16_t
 
i
;

53 
ldns_º_li°
 *
pubkeys
;

54 
ldns_º
 *
k
;

55 
FILE
 *
kÂ
;

57 
pubkeys
 = 
	`ldns_º_li°_√w
();

59 
i
 = 0; i < 
fûec
; i++) {

60 i‡(!(
kÂ
 = 
	`f›í
(
fûes
[
i
], "r"))) {

61 
	`Ârötf
(
°dîr
, "Eº‹ o≥nög key fûê%s: %s\n", 
fûes
[
i
], 
	`°ªº‹
(
î∫o
));

62  
NULL
;

64 i‡(
	`ldns_º_√w_‰m_Â
(&
k
, 
kÂ
, 
NULL
, NULL, NULLË!
LDNS_STATUS_OK
) {

65 
	`Ârötf
(
°dîr
, "Eº‹Ö¨sögÅhêkey fûê%s: %s\n", 
fûes
[
i
], 
	`°ªº‹
(
î∫o
));

66 
	`ldns_º_li°_dìp_‰ì
(
pubkeys
);

67  
NULL
;

69 
	`f˛o£
(
kÂ
);

70 
	`ldns_º_li°_push_º
(
pubkeys
, 
k
);

72  
pubkeys
;

73 
	}
}

76 
FILE
 *

77 
	$›í_√wfûe
(*
ba£«me
, 
ldns_z⁄e
 *
z
, 
size_t
 
cou¡î
, 
ldns_º_li°
 *
keys
)

79 
fûíame
[
FILE_SIZE
];

80 
FILE
 *
Â
;

82 i‡(
cou¡î
 > 
SPLIT_MAX
) {

83 
	`Ârötf
(
°dîr
, "Maximum s∂ô cou¡Ñóched %u\n", (Ë
cou¡î
);

84  
NULL
;

87 
	`¢¥ötf
(
fûíame
, 
FILE_SIZE
, "%s.%03u", 
ba£«me
, (Ë
cou¡î
);

89 i‡(!(
Â
 = 
	`f›í
(
fûíame
, "w"))) {

90 
	`Ârötf
(
°dîr
, "C™nŸ o≥¿z⁄ê%s: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

91  
NULL
;

93 
	`Ârötf
(
°dîr
, "%s\n", 
fûíame
);

95 
	`ldns_º_¥öt
(
Â
, 
	`ldns_z⁄e_sﬂ
(
z
));

96 i‡(
keys
) {

97 
	`ldns_º_li°_¥öt
(
Â
, 
keys
);

100  
Â
;

101 
	}
}

104 
	$maö
(
¨gc
, **
¨gv
)

106 *
¥og«me
;

107 
FILE
 *
Â
;

108 
ldns_z⁄e
 *
z
;

109 
ldns_º_li°
 *
zºs
;

110 
ldns_rdf
 *
œ°«me
;

111 
c
;

112 
löe_ƒ
;

113 
size_t
 
•lô
;

114 
size_t
 
i
;

115 
•lôtög
;

116 
com∑ª
;

117 
size_t
 
fûe_cou¡î
;

118 
ldns_rdf
 *
‹igö
;

119 
ldns_rdf
 *
cuºít_rdf
;

120 
ldns_º
 *
cuºít_º
;

121 
ldns_º_li°
 *
œ°_º£t
;

122 
ldns_º_li°
 *
pubkeys
;

123 
boﬁ
 
s‹t
;

124 
ldns_°©us
 
s
;

126 
¥og«me
 = 
	`°rdup
(
¨gv
[0]);

127 
•lô
 = 0;

128 
•lôtög
 = 
NO_SPLIT
;

129 
fûe_cou¡î
 = 0;

130 
œ°«me
 = 
NULL
;

131 
‹igö
 = 
NULL
;

132 
œ°_º£t
 = 
	`ldns_º_li°_√w
();

133 
s‹t
 = 
Ál£
;

135 (
c
 = 
	`gë›t
(
¨gc
, 
¨gv
, "n:o:zv")) != -1) {

136 
c
) {

138 
•lô
 = (
size_t
)
	`©oi
(
›èrg
);

139 i‡(
•lô
 == 0) {

140 
	`Ârötf
(
°dîr
, "-n wantá integer\n");

141 
	`exô
(
EXIT_FAILURE
);

145 
‹igö
 = 
	`ldns_d«me_√w_‰m_°r
(
	`°rdup
(
›èrg
));

146 i‡(!
‹igö
) {

147 
	`Ârötf
(
°dîr
, "C™nŸ c⁄vîàthê‹igö %†tÿ®domaö«me\n", 
›èrg
);

148 
	`exô
(
EXIT_FAILURE
);

152 
	`¥ötf
("z⁄êfûê•lôã∏vîsi⁄ %†÷dn†vîsi⁄ %s)\n", 
LDNS_VERSION
, 
	`ldns_vîsi⁄
());

153 
	`exô
(
EXIT_SUCCESS
);

156 
s‹t
 = 
åue
;

159 
	`Ârötf
(
°dîr
, "Unrecognized option\n");

160 
	`ußge
(
°dout
, 
¥og«me
);

161 
	`exô
(
EXIT_FAILURE
);

164 i‡(
•lô
 == 0) {

165 
•lô
 = 
DEFAULT_SPLIT
;

168 
¨gc
 -
›töd
;

169 
¨gv
 +
›töd
;

171 i‡(
¨gc
 < 1) {

172 
	`ußge
(
°dout
, 
¥og«me
);

173 
	`exô
(
EXIT_FAILURE
);

176 i‡(!(
Â
 = 
	`f›í
(
¨gv
[0], "r"))) {

177 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
¨gv
[0], 
	`°ªº‹
(
î∫o
));

178 
	`exô
(
EXIT_FAILURE
);

182 
pubkeys
 = 
	`›í_keyfûes
(
¨gv
 + 1, (
uöt16_t
Ë
¨gc
 - 1);

185 i‡(!
‹igö
) {

186 
‹igö
 = 
	`ldns_d«me_√w_‰m_°r
(".");

189 
s
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z
, 
Â
, 
‹igö
, 0, 
LDNS_RR_CLASS_IN
, &
löe_ƒ
);

190 
	`f˛o£
(
Â
);

192 i‡(
s
 !
LDNS_STATUS_OK
) {

193 
	`Ârötf
(
°dîr
, "Zone file %s couldÇot beÖarsed correctly: %sátÜine %d\n",

194 
¨gv
[0],

195 
	`ldns_gë_îr‹°r_by_id
(
s
),

196 
löe_ƒ
);

197 
	`exô
(
EXIT_FAILURE
);

200 i‡(
s‹t
) {

201 
	`ldns_z⁄e_s‹t
(
z
);

204 
zºs
 = 
	`ldns_z⁄e_ºs
(
z
);

205 i‡(
	`ldns_º_li°_º_cou¡
(
zºs
Ë/ 
•lô
 > 
SPLIT_MAX
) {

206 
	`Ârötf
(
°dîr
, "Thêz⁄êi†toÿœrgêf‹Åhêu£d -¿vÆue: %u\n", (Ë
•lô
);

207 
	`exô
(
EXIT_FAILURE
);

212 i‡(!(
Â
 = 
	`›í_√wfûe
(
¨gv
[0], 
z
, 
fûe_cou¡î
, 
pubkeys
))) {

213 
	`exô
(
EXIT_FAILURE
);

216 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
zºs
); i++) {

218 
cuºít_º
 = 
	`ldns_º_li°_º
(
zºs
, 
i
);

219 
cuºít_rdf
 = 
	`ldns_º_ow√r
(
cuºít_º
);

221 
com∑ª
 = 
	`ldns_d«me_com∑ª
(
cuºít_rdf
, 
œ°«me
);

223 i‡(
com∑ª
 == 0) {

224 
	`ldns_º_li°_push_º
(
œ°_º£t
, 
cuºít_º
);

227 i‡(
i
 > 0 && (ò% 
•lô
) == 0) {

228 
•lôtög
 = 
INTENT_TO_SPLIT
;

231 i‡(
•lôtög
 =
INTENT_TO_SPLIT
) {

232 i‡(
com∑ª
 != 0) {

233 
•lôtög
 = 
SPLIT_NOW
;

237 i‡(
•lôtög
 =
SPLIT_NOW
) {

238 
	`f˛o£
(
Â
);

240 
œ°«me
 = 
NULL
;

241 
•lôtög
 = 
NO_SPLIT
;

242 
fûe_cou¡î
++;

243 i‡(!(
Â
 = 
	`›í_√wfûe
(
¨gv
[0], 
z
, 
fûe_cou¡î
, 
pubkeys
))) {

244 
	`exô
(
EXIT_FAILURE
);

248 
	`ldns_º_li°_¥öt
(
Â
, 
œ°_º£t
);

251 
	`ldns_º_¥öt
(
Â
, 
cuºít_º
);

254 
	`ldns_º_li°_‰ì
(
œ°_º£t
);

255 
œ°_º£t
 = 
	`ldns_º_li°_√w
();

257 
	`ldns_º_li°_push_º
(
œ°_º£t
, 
cuºít_º
);

260 i‡(
•lôtög
 =
NO_SPLIT
 || s∂ôtög =
INTENT_TO_SPLIT
) {

261 
	`ldns_º_¥öt
(
Â
, 
cuºít_º
);

263 i‡(
com∑ª
 != 0) {

265 
	`ldns_º_li°_‰ì
(
œ°_º£t
);

266 
œ°_º£t
 = 
	`ldns_º_li°_√w
();

267 
	`ldns_º_li°_push_º
(
œ°_º£t
, 
cuºít_º
);

269 
œ°«me
 = 
cuºít_rdf
;

271 
	`f˛o£
(
Â
);

272 
	`exô
(
EXIT_SUCCESS
);

273 
	}
}

	@examples/ldnsd.c

10 
	~"c⁄fig.h
"

11 
	~<ldns/ldns.h
>

13 #ifde‡
HAVE_SYS_SOCKET_H


14 
	~<sys/sockë.h
>

16 #ifde‡
HAVE_ARPA_INET_H


17 
	~<¨∑/öë.h
>

19 #ifde‡
HAVE_NETINET_IN_H


20 
	~<√töë/ö.h
>

22 #ifde‡
HAVE_NETINET_UDP_H


23 
	~<√töë/udp.h
>

25 #ifde‡
HAVE_NETINET_IGMP_H


26 
	~<√töë/igmp.h
>

29 
	~<î∫o.h
>

31 
	#INBUF_SIZE
 4096

	)

33 
	$ußge
(
FILE
 *
ouçut
)

35 
	`Ârötf
(
ouçut
, "Usage:Üdnsd <address> <port> <zone> <zonefile>\n");

36 
	`Ârötf
(
ouçut
, "Listens onÅhe specifiedÖortándánswers queries forÅhe given zone\n");

37 
	`Ârötf
(
ouçut
, "This is NOTá full-fledgedáuthoritativeÇameserver!\n");

38 
	}
}

40 
	$udp_böd
(
sock
, 
p‹t
, c⁄° *
my_addªss
)

42 
sockaddr_ö
 
addr
;

43 
ö_addr_t
 
maddr
 = 
INADDR_ANY
;

45 i‡(
my_addªss
) {

46 #ifde‡
AF_INET6


47 i‡(
	`öë_±⁄
(
AF_INET6
, 
my_addªss
, &
maddr
) < 1) {

51 i‡(
	`öë_±⁄
(
AF_INET
, 
my_addªss
, &
maddr
) < 1) {

57 #i‚de‡
S_SPLINT_S


58 
addr
.
sö_Ámûy
 = 
AF_INET
;

60 
addr
.
sö_p‹t
 = (
ö_p‹t_t
Ë
	`ht⁄s
((
uöt16_t
)
p‹t
);

61 
addr
.
sö_addr
.
s_addr
 = 
maddr
;

62  
	`böd
(
sock
, (
sockaddr
 *)&
addr
, (
sockÀn_t
) (addr));

63 
	}
}

66 
ldns_º_li°
 *

67 
	$gë_º£t
(c⁄° 
ldns_z⁄e
 *
z⁄e
, c⁄° 
ldns_rdf
 *
ow√r_«me
, c⁄° 
ldns_º_ty≥
 
qty≥
, c⁄° 
ldns_º_˛ass
 
q˛ass
)

69 
uöt16_t
 
i
;

70 
ldns_º_li°
 *
ºli°
 = 
	`ldns_º_li°_√w
();

71 
ldns_º
 *
cur_º
;

72 i‡(!
z⁄e
 || !
ow√r_«me
) {

73 
	`Ârötf
(
°dîr
, "Warning: get_rrset called with NULL zone or ownerÇame\n");

74  
ºli°
;

77 
i
 = 0; i < 
	`ldns_z⁄e_º_cou¡
(
z⁄e
); i++) {

78 
cur_º
 = 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z⁄e
), 
i
);

79 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
cur_º
), 
ow√r_«me
) == 0 &&

80 
	`ldns_º_gë_˛ass
(
cur_º
Ë=
q˛ass
 &&

81 
	`ldns_º_gë_ty≥
(
cur_º
Ë=
qty≥


83 
	`ldns_º_li°_push_º
(
ºli°
, 
	`ldns_º_˛⁄e
(
cur_º
));

87 
	`¥ötf
("FoundÑr£ào‡%uÑrs\n", (Ë
	`ldns_º_li°_º_cou¡
(
ºli°
));

89  
ºli°
;

90 
	}
}

93 
	$maö
(
¨gc
, **
¨gv
)

96 
p‹t
;

97 c⁄° *
z⁄e_fûe
;

100 
sock
;

101 
ssize_t
 
nb
;

102 
sockaddr
 
addr_me
;

103 
sockaddr
 
addr_him
;

104 
sockÀn_t
 
hi¶í
 = (sockÀn_tË(
addr_him
);

105 
uöt8_t
 
öbuf
[
INBUF_SIZE
];

106 
uöt8_t
 *
outbuf
;

109 
ldns_°©us
 
°©us
;

110 
ldns_pkt
 *
quîy_pkt
;

111 
ldns_pkt
 *
™swî_pkt
;

112 
size_t
 
™swî_size
;

113 
ldns_º
 *
quîy_º
;

114 
ldns_º_li°
 *
™swî_qr
;

115 
ldns_º_li°
 *
™swî_™
;

116 
ldns_º_li°
 *
™swî_ns
;

117 
ldns_º_li°
 *
™swî_ad
;

118 
ldns_rdf
 *
‹igö
 = 
NULL
;

121 
ldns_z⁄e
 *
z⁄e
;

122 
löe_ƒ
;

123 
FILE
 *
z⁄e_Â
;

126 *
my_addªss
 = 
NULL
;

128 i‡(
¨gc
 < 5) {

129 
	`ußge
(
°dîr
);

130 
	`exô
(
EXIT_FAILURE
);

132 
my_addªss
 = 
¨gv
[1];

133 
p‹t
 = 
	`©oi
(
¨gv
[2]);

134 i‡(
p‹t
 < 1) {

135 
	`ußge
(
°dîr
);

136 
	`exô
(
EXIT_FAILURE
);

138 i‡(
	`ldns_°r2rdf_d«me
(&
‹igö
, 
¨gv
[3]Ë!
LDNS_STATUS_OK
) {

139 
	`Ârötf
(
°dîr
, "Bad origin,Çotá correct domainÇame\n");

140 
	`ußge
(
°dîr
);

141 
	`exô
(
EXIT_FAILURE
);

143 
z⁄e_fûe
 = 
¨gv
[4];

146 
	`¥ötf
("Ródög z⁄êfûê%s\n", 
z⁄e_fûe
);

147 
z⁄e_Â
 = 
	`f›í
(
z⁄e_fûe
, "r");

148 i‡(!
z⁄e_Â
) {

149 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
z⁄e_fûe
, 
	`°ªº‹
(
î∫o
));

150 
	`exô
(
EXIT_FAILURE
);

153 
löe_ƒ
 = 0;

154 
°©us
 = 
	`ldns_z⁄e_√w_‰m_Â_l
(&
z⁄e
, 
z⁄e_Â
, 
‹igö
, 0, 
LDNS_RR_CLASS_IN
, &
löe_ƒ
);

156 i‡(
°©us
 !
LDNS_STATUS_OK
) {

157 
	`¥ötf
("ZoneÑeader failed,áborting\n");

158 
	`exô
(
EXIT_FAILURE
);

160 
	`¥ötf
("Ród %uÑesour˚Ñec‹d†ö z⁄êfûe\n", (Ë
	`ldns_z⁄e_º_cou¡
(
z⁄e
));

162 
	`f˛o£
(
z⁄e_Â
);

164 
	`¥ötf
("Li°íög o¿p‹à%d\n", 
p‹t
);

165 
sock
 = 
	`sockë
(
AF_INET
, 
SOCK_DGRAM
, 0);

166 i‡(
sock
 < 0) {

167 
	`Ârötf
(
°dîr
, "%s: sockë(): %s\n", 
¨gv
[0], 
	`°ªº‹
(
î∫o
));

168 
	`exô
(1);

170 
	`mem£t
(&
addr_me
, 0, (addr_me));

173 i‡(
	`udp_böd
(
sock
, 
p‹t
, 
my_addªss
)) {

174 
	`Ârötf
(
°dîr
, "%s: c™nŸ böd(): %s\n", 
¨gv
[0], 
	`°ªº‹
(
î∫o
));

175 
	`exô
(
î∫o
);

180 
nb
 = 
	`ªcv‰om
(
sock
, (*)
öbuf
, 
INBUF_SIZE
, 0,

181 &
addr_him
, &
hi¶í
);

182 i‡(
nb
 < 1) {

183 
	`Ârötf
(
°dîr
, "%s:Ñecvfrom(): %s\n",

184 
¨gv
[0], 
	`°ªº‹
(
î∫o
));

185 
	`exô
(1);

191 
	`¥ötf
("GŸ quîy o‡%u byãs\n", (Ë
nb
);

192 
°©us
 = 
	`ldns_wúe2pkt
(&
quîy_pkt
, 
öbuf
, (
size_t
Ë
nb
);

193 i‡(
°©us
 !
LDNS_STATUS_OK
) {

194 
	`¥ötf
("GŸ badÖackë: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

196 
	`ldns_pkt_¥öt
(
°dout
, 
quîy_pkt
);

199 
quîy_º
 = 
	`ldns_º_li°_º
(
	`ldns_pkt_que°i⁄
(
quîy_pkt
), 0);

200 
	`¥ötf
("QUERY RR: \n");

201 
	`ldns_º_¥öt
(
°dout
, 
quîy_º
);

203 
™swî_qr
 = 
	`ldns_º_li°_√w
();

204 
	`ldns_º_li°_push_º
(
™swî_qr
, 
	`ldns_º_˛⁄e
(
quîy_º
));

206 
™swî_™
 = 
	`gë_º£t
(
z⁄e
, 
	`ldns_º_ow√r
(
quîy_º
), 
	`ldns_º_gë_ty≥
(quîy_º), 
	`ldns_º_gë_˛ass
(query_rr));

207 
™swî_pkt
 = 
	`ldns_pkt_√w
();

208 
™swî_ns
 = 
	`ldns_º_li°_√w
();

209 
™swî_ad
 = 
	`ldns_º_li°_√w
();

211 
	`ldns_pkt_£t_qr
(
™swî_pkt
, 1);

212 
	`ldns_pkt_£t_Ø
(
™swî_pkt
, 1);

213 
	`ldns_pkt_£t_id
(
™swî_pkt
, 
	`ldns_pkt_id
(
quîy_pkt
));

215 
	`ldns_pkt_push_º_li°
(
™swî_pkt
, 
LDNS_SECTION_QUESTION
, 
™swî_qr
);

216 
	`ldns_pkt_push_º_li°
(
™swî_pkt
, 
LDNS_SECTION_ANSWER
, 
™swî_™
);

217 
	`ldns_pkt_push_º_li°
(
™swî_pkt
, 
LDNS_SECTION_AUTHORITY
, 
™swî_ns
);

218 
	`ldns_pkt_push_º_li°
(
™swî_pkt
, 
LDNS_SECTION_ADDITIONAL
, 
™swî_ad
);

220 
°©us
 = 
	`ldns_pkt2wúe
(&
outbuf
, 
™swî_pkt
, &
™swî_size
);

222 
	`¥ötf
("AnswîÖackë size: %u byãs.\n", (Ë
™swî_size
);

223 i‡(
°©us
 !
LDNS_STATUS_OK
) {

224 
	`¥ötf
("Eº‹ cª©ögánswî: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

226 
nb
 = 
	`£ndto
(
sock
, (*)
outbuf
, 
™swî_size
, 0,

227 &
addr_him
, 
hi¶í
);

230 
	`ldns_pkt_‰ì
(
quîy_pkt
);

231 
	`ldns_pkt_‰ì
(
™swî_pkt
);

232 
	`LDNS_FREE
(
outbuf
);

233 
	`ldns_º_li°_‰ì
(
™swî_qr
);

234 
	`ldns_º_li°_‰ì
(
™swî_™
);

235 
	`ldns_º_li°_‰ì
(
™swî_ns
);

236 
	`ldns_º_li°_‰ì
(
™swî_ad
);

245 
	}
}

	@higher.c

14 
	~<ldns/c⁄fig.h
>

16 
	~<ldns/ldns.h
>

18 #ifde‡
HAVE_SSL


19 
	~<›ís¶/s¶.h
>

20 
	~<›ís¶/sha.h
>

23 
ldns_º_li°
 *

24 
	$ldns_gë_º_li°_addr_by_«me
(
ldns_ªsﬁvî
 *
ªs
, 
ldns_rdf
 *
«me
, 
ldns_º_˛ass
 
c
,

25 
uöt16_t
 
Êags
)

27 
ldns_pkt
 *
pkt
;

28 
ldns_º_li°
 *
ØØ
;

29 
ldns_º_li°
 *
a
;

30 
ldns_º_li°
 *
ªsu…
 = 
NULL
;

31 
ldns_º_li°
 *
ho°sfûíames
;

32 
size_t
 
i
;

33 
uöt8_t
 
ù6
;

35 
a
 = 
NULL
;

36 
ØØ
 = 
NULL
;

37 
ªsu…
 = 
NULL
;

39 i‡(!
ªs
) {

40  
NULL
;

42 i‡(
	`ldns_rdf_gë_ty≥
(
«me
Ë!
LDNS_RDF_TYPE_DNAME
) {

43  
NULL
;

46 
ù6
 = 
	`ldns_ªsﬁvî_ù6
(
ªs
);

49 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
, 
LDNS_RESOLV_INETANY
);

51 
ho°sfûíames
 = 
	`ldns_gë_º_li°_ho°s_‰m_fûe
(
NULL
);

52 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ho°sfûíames
); i++) {

53 i‡(
	`ldns_rdf_com∑ª
(
«me
,

54 
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
ho°sfûíames
,

55 
i
))) == 0) {

56 i‡(!
ªsu…
) {

57 
ªsu…
 = 
	`ldns_º_li°_√w
();

59 
	`ldns_º_li°_push_º
(
ªsu…
,

60 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
ho°sfûíames
, 
i
)));

63 
	`ldns_º_li°_dìp_‰ì
(
ho°sfûíames
);

65 i‡(
ªsu…
) {

66  
ªsu…
;

70 
pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
«me
, 
LDNS_RR_TYPE_AAAA
, 
c
, 
Êags
 | 
LDNS_RD
);

71 i‡(
pkt
) {

73 
ØØ
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
, 
LDNS_RR_TYPE_AAAA
,

74 
LDNS_SECTION_ANSWER
);

75 
	`ldns_pkt_‰ì
(
pkt
);

78 
pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
«me
, 
LDNS_RR_TYPE_A
, 
c
, 
Êags
 | 
LDNS_RD
);

79 i‡(
pkt
) {

81 
a
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
, 
LDNS_RR_TYPE_A
, 
LDNS_SECTION_ANSWER
);

82 
	`ldns_pkt_‰ì
(
pkt
);

84 
	`ldns_ªsﬁvî_£t_ù6
(
ªs
, 
ù6
);

86 i‡(
ØØ
 && 
a
) {

87 
ªsu…
 = 
	`ldns_º_li°_ˇt_˛⁄e
(
ØØ
, 
a
);

88 
	`ldns_º_li°_dìp_‰ì
(
ØØ
);

89 
	`ldns_º_li°_dìp_‰ì
(
a
);

90  
ªsu…
;

93 i‡(
ØØ
) {

94 
ªsu…
 = 
	`ldns_º_li°_˛⁄e
(
ØØ
);

97 i‡(
a
) {

98 
ªsu…
 = 
	`ldns_º_li°_˛⁄e
(
a
);

101 
	`ldns_º_li°_dìp_‰ì
(
ØØ
);

102 
	`ldns_º_li°_dìp_‰ì
(
a
);

103  
ªsu…
;

104 
	}
}

106 
ldns_º_li°
 *

107 
	$ldns_gë_º_li°_«me_by_addr
(
ldns_ªsﬁvî
 *
ªs
, 
ldns_rdf
 *
addr
, 
ldns_º_˛ass
 
c
,

108 
uöt16_t
 
Êags
)

110 
ldns_pkt
 *
pkt
;

111 
ldns_º_li°
 *
«mes
;

112 
ldns_rdf
 *
«me
;

114 
«mes
 = 
NULL
;

116 i‡(!
ªs
 || !
addr
) {

117  
NULL
;

120 i‡(
	`ldns_rdf_gë_ty≥
(
addr
Ë!
LDNS_RDF_TYPE_A
 &&

121 
	`ldns_rdf_gë_ty≥
(
addr
Ë!
LDNS_RDF_TYPE_AAAA
) {

122  
NULL
;

125 
«me
 = 
	`ldns_rdf_addªss_ªvî£
(
addr
);

128 
pkt
 = 
	`ldns_ªsﬁvî_quîy
(
ªs
, 
«me
, 
LDNS_RR_TYPE_PTR
, 
c
, 
Êags
 | 
LDNS_RD
);

129 
	`ldns_rdf_dìp_‰ì
(
«me
);

130 i‡(
pkt
) {

132 
«mes
 = 
	`ldns_pkt_º_li°_by_ty≥
(
pkt
,

133 
LDNS_RR_TYPE_PTR
, 
LDNS_SECTION_ANSWER
);

134 
	`ldns_pkt_‰ì
(
pkt
);

136  
«mes
;

137 
	}
}

140 
ldns_º_li°
 *

141 
	$ldns_gë_º_li°_ho°s_‰m_Â
(
FILE
 *
Â
)

143  
	`ldns_gë_º_li°_ho°s_‰m_Â_l
(
Â
, 
NULL
);

144 
	}
}

146 
ldns_º_li°
 *

147 
	$ldns_gë_º_li°_ho°s_‰m_Â_l
(
FILE
 *
Â
, *
löe_ƒ
)

149 
ssize_t
 
i
, 
j
;

150 
size_t
 
˙t
;

151 *
löe
;

152 *
w‹d
;

153 *
addr
;

154 *
º_°r
;

155 
ldns_buf„r
 *
löebuf
;

156 
ldns_º
 *
º
;

157 
ldns_º_li°
 *
li°
;

158 
ldns_rdf
 *
tmp
;

159 
boﬁ
 
ù6
;

160 
ldns_°©us
 
∑r£_ªsu…
;

162 
löe
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
 + 1);

163 
w‹d
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
 + 1);

164 
addr
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
 + 1);

165 
º_°r
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
 + 1);

166 
ù6
 = 
Ál£
;

167 
li°
 = 
	`ldns_º_li°_√w
();

168 
º
 = 
NULL
;

169 if(!
löe
 || !
w‹d
 || !
addr
 || !
º_°r
 || !
li°
) {

170 
	`LDNS_FREE
(
löe
);

171 
	`LDNS_FREE
(
w‹d
);

172 
	`LDNS_FREE
(
addr
);

173 
	`LDNS_FREE
(
º_°r
);

174 
	`ldns_º_li°_‰ì
(
li°
);

175  
NULL
;

178 
i
 = 
	`ldns_fgë_tokí_l
(
Â
, 
löe
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
);

179 
i
 > 0; i = 
	`ldns_fgë_tokí_l
(
Â
, 
löe
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
)) {

181 i‡(
löe
[0] == '#') {

185 
löebuf
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

186 if(!
löebuf
) {

187 
	`LDNS_FREE
(
löe
);

188 
	`LDNS_FREE
(
w‹d
);

189 
	`LDNS_FREE
(
addr
);

190 
	`LDNS_FREE
(
º_°r
);

191 
	`ldns_º_li°_dìp_‰ì
(
li°
);

192  
NULL
;

195 
	`ldns_buf„r_√w_‰m_d©a
(
löebuf
, 
löe
, (
size_t
Ë
i
);

196 
˙t
 = 0, 
j
 = 
	`ldns_bgë_tokí
(
löebuf
, 
w‹d
, 
LDNS_PARSE_NO_NL
, 
LDNS_MAX_LINELEN
);

197 
j
 > 0;

198 
j
 = 
	`ldns_bgë_tokí
(
löebuf
, 
w‹d
, 
LDNS_PARSE_NO_NL
, 
LDNS_MAX_LINELEN
), 
˙t
++) {

199 i‡(
˙t
 == 0) {

201 i‡((
tmp
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_AAAA
,

202 
w‹d
))) {

204 
	`ldns_rdf_dìp_‰ì
(
tmp
);

205 
ù6
 = 
åue
;

207 i‡((
tmp
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_A
,

208 
w‹d
))) {

210 
	`ldns_rdf_dìp_‰ì
(
tmp
);

211 
ù6
 = 
Ál£
;

217 ()
	`°æ˝y
(
addr
, 
w‹d
, 
LDNS_MAX_LINELEN
+1);

220 i‡(
ù6
) {

221 
	`¢¥ötf
(
º_°r
, 
LDNS_MAX_LINELEN
,

222 "%†IN AAAA %s", 
w‹d
, 
addr
);

224 
	`¢¥ötf
(
º_°r
, 
LDNS_MAX_LINELEN
,

225 "%†IN A %s", 
w‹d
, 
addr
);

227 
∑r£_ªsu…
 = 
	`ldns_º_√w_‰m_°r
(&
º
, 
º_°r
, 0, 
NULL
, NULL);

228 i‡(
∑r£_ªsu…
 =
LDNS_STATUS_OK
 && 
	`ldns_º_ow√r
(
º
Ë&& 
	`ldns_º_rd_cou¡
(rr) > 0) {

229 
	`ldns_º_li°_push_º
(
li°
, 
	`ldns_º_˛⁄e
(
º
));

231 
	`ldns_º_‰ì
(
º
);

234 
	`ldns_buf„r_‰ì
(
löebuf
);

236 
	`LDNS_FREE
(
löe
);

237 
	`LDNS_FREE
(
w‹d
);

238 
	`LDNS_FREE
(
addr
);

239 
	`LDNS_FREE
(
º_°r
);

240  
li°
;

241 
	}
}

243 
ldns_º_li°
 *

244 
	$ldns_gë_º_li°_ho°s_‰m_fûe
(*
fûíame
)

246 
ldns_º_li°
 *
«mes
;

247 
FILE
 *
Â
;

249 i‡(!
fûíame
) {

250 
Â
 = 
	`f›í
(
LDNS_RESOLV_HOSTS
, "r");

253 
Â
 = 
	`f›í
(
fûíame
, "r");

255 i‡(!
Â
) {

256  
NULL
;

259 
«mes
 = 
	`ldns_gë_º_li°_ho°s_‰m_Â
(
Â
);

260 
	`f˛o£
(
Â
);

261  
«mes
;

262 
	}
}

264 
uöt16_t


265 
	$ldns_gëaddröfo
(
ldns_ªsﬁvî
 *
ªs
, 
ldns_rdf
 *
node
, 
ldns_º_˛ass
 
c
,

266 
ldns_º_li°
 **
ªt
)

268 
ldns_rdf_ty≥
 
t
;

269 
uöt16_t
 
«mes_found
;

270 
ldns_ªsﬁvî
 *
r
;

271 
ldns_°©us
 
s
;

273 
t
 = 
	`ldns_rdf_gë_ty≥
(
node
);

274 
«mes_found
 = 0;

275 
r
 = 
ªs
;

277 i‡(
ªs
 =
NULL
) {

279 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_fûe
(&
r
, 
NULL
);

280 i‡(
s
 !
LDNS_STATUS_OK
) {

285 i‡(
t
 =
LDNS_RDF_TYPE_DNAME
) {

287 *
ªt
 = 
	`ldns_gë_º_li°_addr_by_«me
(
r
, 
node
, 
c
, 0);

288 
«mes_found
 = 
	`ldns_º_li°_º_cou¡
(*
ªt
);

291 i‡(
t
 =
LDNS_RDF_TYPE_A
 ||Å =
LDNS_RDF_TYPE_AAAA
) {

293 *
ªt
 = 
	`ldns_gë_º_li°_«me_by_addr
(
r
, 
node
, 
c
, 0);

294 
«mes_found
 = 
	`ldns_º_li°_º_cou¡
(*
ªt
);

297 i‡(
ªs
 =
NULL
) {

298 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

301  
«mes_found
;

302 
	}
}

304 
boﬁ


305 
	$ldns_n£c_ty≥_check
(
ldns_º
 *
n£c
, 
ldns_º_ty≥
 
t
)

307 
	`ldns_º_gë_ty≥
(
n£c
)) {

308 
LDNS_RR_TYPE_NSEC
 : i‡(
	`ldns_º_rd_cou¡
(
n£c
) < 2) {

309  
Ál£
;

311  
	`ldns_n£c_bôm≠_covîs_ty≥
(

312 
	`ldns_º_rdf
(
n£c
, 1), 
t
);

314 
LDNS_RR_TYPE_NSEC3
 : i‡(
	`ldns_º_rd_cou¡
(
n£c
) < 6) {

315  
Ál£
;

317  
	`ldns_n£c_bôm≠_covîs_ty≥
(

318 
	`ldns_º_rdf
(
n£c
, 5), 
t
);

320  :  
Ál£
;

322 
	}
}

325 
	$ldns_¥öt_º_rdf
(
FILE
 *
Â
, 
ldns_º
 *
r
, 
rd‚um
, ...)

327 
öt16_t
 
rdf
;

328 
ldns_rdf
 *
rd
;

329 
va_li°
 
va_rdf
;

330 
	`va_°¨t
(
va_rdf
, 
rd‚um
);

332 
rdf
 = (
öt16_t
)
rd‚um
;Ñd‡!-1;Ñd‡(öt16_t)
	`va_¨g
(
va_rdf
, ))

334 
rd
 = 
	`ldns_º_rdf
(
r
, 
rdf
);

335 i‡(!
rd
) {

338 
	`ldns_rdf_¥öt
(
Â
, 
rd
);

339 
	`Ârötf
(
Â
, " ");

342 
	`va_íd
(
va_rdf
);

343 
	}
}

	@host2str.c

13 
	~<ldns/c⁄fig.h
>

15 
	~<ldns/ldns.h
>

17 
	~<limôs.h
>

19 #ifde‡
HAVE_SYS_SOCKET_H


20 
	~<sys/sockë.h
>

22 #ifde‡
HAVE_ARPA_INET_H


23 
	~<¨∑/öë.h
>

25 #ifde‡
HAVE_NETDB_H


26 
	~<√tdb.h
>

28 
	~<time.h
>

29 
	~<sys/time.h
>

31 #i‚de‡
INET_ADDRSTRLEN


32 
	#INET_ADDRSTRLEN
 16

	)

34 #i‚de‡
INET6_ADDRSTRLEN


35 
	#INET6_ADDRSTRLEN
 46

	)

41 
ldns_lookup_èbÀ
 
	gldns_Æg‹ôhms
[] = {

42 { 
LDNS_RSAMD5
, "RSAMD5" },

43 { 
LDNS_DH
, "DH" },

44 { 
LDNS_DSA
, "DSA" },

45 { 
LDNS_ECC
, "ECC" },

46 { 
LDNS_RSASHA1
, "RSASHA1" },

47 { 
LDNS_DSA_NSEC3
, "DSA-NSEC3-SHA1" },

48 { 
LDNS_RSASHA1_NSEC3
, "RSASHA1-NSEC3-SHA1" },

49 #ifde‡
USE_SHA2


50 { 
LDNS_RSASHA256
, "RSASHA256"},

51 { 
LDNS_RSASHA512
, "RSASHA512"},

53 #ifde‡
USE_GOST


54 { 
LDNS_ECC_GOST
, "ECC-GOST"},

56 #ifde‡
USE_ECDSA


57 { 
LDNS_ECDSAP256SHA256
, "ECDSAP256SHA256"},

58 { 
LDNS_ECDSAP384SHA384
, "ECDSAP384SHA384"},

60 { 
LDNS_INDIRECT
, "INDIRECT" },

61 { 
LDNS_PRIVATEDNS
, "PRIVATEDNS" },

62 { 
LDNS_PRIVATEOID
, "PRIVATEOID" },

63 { 0, 
NULL
 }

67 
ldns_lookup_èbÀ
 
	gldns_˚π_Æg‹ôhms
[] = {

68 { 
LDNS_CERT_PKIX
, "PKIX" },

69 { 
LDNS_CERT_SPKI
, "SPKI" },

70 { 
LDNS_CERT_PGP
, "PGP" },

71 { 
LDNS_CERT_IPKIX
, "IPKIX" },

72 { 
LDNS_CERT_ISPKI
, "ISPKI" },

73 { 
LDNS_CERT_IPGP
, "IPGP" },

74 { 
LDNS_CERT_ACPKIX
, "ACPKIX" },

75 { 
LDNS_CERT_IACPKIX
, "IACPKIX" },

76 { 
LDNS_CERT_URI
, "URI" },

77 { 
LDNS_CERT_OID
, "OID" },

78 { 0, 
NULL
 }

82 
ldns_lookup_èbÀ
 
	gldns_º_˛as£s
[] = {

83 { 
LDNS_RR_CLASS_IN
, "IN" },

84 { 
LDNS_RR_CLASS_CH
, "CH" },

85 { 
LDNS_RR_CLASS_HS
, "HS" },

86 { 
LDNS_RR_CLASS_NONE
, "NONE" },

87 { 
LDNS_RR_CLASS_ANY
, "ANY" },

88 { 0, 
NULL
 }

92 
ldns_lookup_èbÀ
 
	gldns_rcodes
[] = {

93 { 
LDNS_RCODE_NOERROR
, "NOERROR" },

94 { 
LDNS_RCODE_FORMERR
, "FORMERR" },

95 { 
LDNS_RCODE_SERVFAIL
, "SERVFAIL" },

96 { 
LDNS_RCODE_NXDOMAIN
, "NXDOMAIN" },

97 { 
LDNS_RCODE_NOTIMPL
, "NOTIMPL" },

98 { 
LDNS_RCODE_REFUSED
, "REFUSED" },

99 { 
LDNS_RCODE_YXDOMAIN
, "YXDOMAIN" },

100 { 
LDNS_RCODE_YXRRSET
, "YXRRSET" },

101 { 
LDNS_RCODE_NXRRSET
, "NXRRSET" },

102 { 
LDNS_RCODE_NOTAUTH
, "NOTAUTH" },

103 { 
LDNS_RCODE_NOTZONE
, "NOTZONE" },

104 { 0, 
NULL
 }

107 
ldns_lookup_èbÀ
 
	gldns_›codes
[] = {

108 { 
LDNS_PACKET_QUERY
, "QUERY" },

109 { 
LDNS_PACKET_IQUERY
, "IQUERY" },

110 { 
LDNS_PACKET_STATUS
, "STATUS" },

111 { 
LDNS_PACKET_NOTIFY
, "NOTIFY" },

112 { 
LDNS_PACKET_UPDATE
, "UPDATE" },

113 { 0, 
NULL
 }

116 c⁄° 
ldns_ouçut_f‹m©
 
	gldns_ouçut_f‹m©_nocommíts_ªc‹d
 = { 0, 
NULL
 };

117 c⁄° 
ldns_ouçut_f‹m©
 *
	gldns_ouçut_f‹m©_nocommíts


118 &
ldns_ouçut_f‹m©_nocommíts_ªc‹d
;

119 c⁄° 
ldns_ouçut_f‹m©
 
	gldns_ouçut_f‹m©_⁄lykeyids_ªc‹d
 = {

120 
LDNS_COMMENT_KEY
, 
NULL


122 c⁄° 
ldns_ouçut_f‹m©
 *
	gldns_ouçut_f‹m©_⁄lykeyids


123 &
ldns_ouçut_f‹m©_⁄lykeyids_ªc‹d
;

124 c⁄° 
ldns_ouçut_f‹m©
 *
	gldns_ouçut_f‹m©_deÁu…


125 &
ldns_ouçut_f‹m©_⁄lykeyids_ªc‹d
;

127 c⁄° 
ldns_ouçut_f‹m©
 
	gldns_ouçut_f‹m©_bubbÀbabbÀ_ªc‹d
 = {

128 
LDNS_COMMENT_KEY
 | 
LDNS_COMMENT_BUBBLEBABBLE
 | 
LDNS_COMMENT_FLAGS
, 
NULL


130 c⁄° 
ldns_ouçut_f‹m©
 *
	gldns_ouçut_f‹m©_bubbÀbabbÀ


131 &
ldns_ouçut_f‹m©_bubbÀbabbÀ_ªc‹d
;

133 
boﬁ


134 
	$ldns_ouçut_f‹m©_covîs_ty≥
(c⁄° 
ldns_ouçut_f‹m©
* 
fmt
, 
ldns_º_ty≥
 
t
)

136  
fmt
 && (fmt->
Êags
 & 
LDNS_FMT_RFC3597
) &&

137 ((
ldns_ouçut_f‹m©_°‹age
*)
fmt
)->
bôm≠
 &&

138 
	`ldns_n£c_bôm≠_covîs_ty≥
(

139 ((
ldns_ouçut_f‹m©_°‹age
*)
fmt
)->
bôm≠
, 
t
);

140 
	}
}

142 
ldns_°©us


143 
	$ldns_ouçut_f‹m©_£t_ty≥
(
ldns_ouçut_f‹m©
* 
fmt
, 
ldns_º_ty≥
 
t
)

145 
ldns_ouçut_f‹m©_°‹age
* 
fmt_°
 = (ldns_ouçut_f‹m©_°‹age*)
fmt
;

146 
ldns_°©us
 
s
;

148 
	`as£π
(
fmt
 !
NULL
);

150 i‡(!(
fmt_°
->
Êags
 & 
LDNS_FMT_RFC3597
)) {

151 
	`ldns_ouçut_f‹m©_£t
(
fmt
, 
LDNS_FMT_RFC3597
);

153 i‡(! 
fmt_°
->
bôm≠
) {

154 
s
 = 
	`ldns_rdf_bôm≠_known_º_ty≥s_•a˚
(&
fmt_°
->
bôm≠
);

155 i‡(
s
 !
LDNS_STATUS_OK
) {

156  
s
;

159  
	`ldns_n£c_bôm≠_£t_ty≥
(
fmt_°
->
bôm≠
, 
t
);

160 
	}
}

162 
ldns_°©us


163 
	$ldns_ouçut_f‹m©_˛ór_ty≥
(
ldns_ouçut_f‹m©
* 
fmt
, 
ldns_º_ty≥
 
t
)

165 
ldns_ouçut_f‹m©_°‹age
* 
fmt_°
 = (ldns_ouçut_f‹m©_°‹age*)
fmt
;

166 
ldns_°©us
 
s
;

168 
	`as£π
(
fmt
 !
NULL
);

170 i‡(!(
fmt_°
->
Êags
 & 
LDNS_FMT_RFC3597
)) {

171 
	`ldns_ouçut_f‹m©_£t
(
fmt
, 
LDNS_FMT_RFC3597
);

173 i‡(! 
fmt_°
->
bôm≠
) {

174 
s
 = 
	`ldns_rdf_bôm≠_known_º_ty≥s
(&
fmt_°
->
bôm≠
);

175 i‡(
s
 !
LDNS_STATUS_OK
) {

176  
s
;

179  
	`ldns_n£c_bôm≠_˛ór_ty≥
(
fmt_°
->
bôm≠
, 
t
);

180 
	}
}

182 
ldns_°©us


183 
	$ldns_pkt_›code2buf„r_°r
(
ldns_buf„r
 *
ouçut
, 
ldns_pkt_›code
 
›code
)

185 
ldns_lookup_èbÀ
 *
…
 = 
	`ldns_lookup_by_id
(
ldns_›codes
, 
›code
);

186 i‡(
…
 &&Üt->
«me
) {

187 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
…
->
«me
);

189 
	`ldns_buf„r_¥ötf
(
ouçut
, "OPCODE%u", 
›code
);

191  
	`ldns_buf„r_°©us
(
ouçut
);

192 
	}
}

194 
ldns_°©us


195 
	$ldns_pkt_rcode2buf„r_°r
(
ldns_buf„r
 *
ouçut
, 
ldns_pkt_rcode
 
rcode
)

197 
ldns_lookup_èbÀ
 *
…
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
, 
rcode
);

198 i‡(
…
 &&Üt->
«me
) {

199 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
…
->
«me
);

201 
	`ldns_buf„r_¥ötf
(
ouçut
, "RCODE%u", 
rcode
);

203  
	`ldns_buf„r_°©us
(
ouçut
);

204 
	}
}

206 
ldns_°©us


207 
	$ldns_Æg‹ôhm2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

208 
ldns_Æg‹ôhm
 
Æg‹ôhm
)

210 
ldns_lookup_èbÀ
 *
…
 = 
	`ldns_lookup_by_id
(
ldns_Æg‹ôhms
,

211 
Æg‹ôhm
);

212 i‡(
…
 &&Üt->
«me
) {

213 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
…
->
«me
);

215 
	`ldns_buf„r_¥ötf
(
ouçut
, "ALG%u", 
Æg‹ôhm
);

217  
	`ldns_buf„r_°©us
(
ouçut
);

218 
	}
}

220 
ldns_°©us


221 
	$ldns_˚π_Æg‹ôhm2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

222 
ldns_˚π_Æg‹ôhm
 
˚π_Æg‹ôhm
)

224 
ldns_lookup_èbÀ
 *
…
 = 
	`ldns_lookup_by_id
(
ldns_˚π_Æg‹ôhms
,

225 
˚π_Æg‹ôhm
);

226 i‡(
…
 &&Üt->
«me
) {

227 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
…
->
«me
);

229 
	`ldns_buf„r_¥ötf
(
ouçut
, "CERT_ALG%u",

230 
˚π_Æg‹ôhm
);

232  
	`ldns_buf„r_°©us
(
ouçut
);

233 
	}
}

236 
	$ldns_pkt_›code2°r
(
ldns_pkt_›code
 
›code
)

238 *
°r
;

239 
ldns_buf„r
 *
buf
;

241 
buf
 = 
	`ldns_buf„r_√w
(12);

242 i‡(!
buf
) {

243  
NULL
;

246 
°r
 = 
NULL
;

247 i‡(
	`ldns_pkt_›code2buf„r_°r
(
buf
, 
›code
Ë=
LDNS_STATUS_OK
) {

248 
°r
 = 
	`ldns_buf„r_exp‹t2°r
(
buf
);

251 
	`ldns_buf„r_‰ì
(
buf
);

252  
°r
;

253 
	}
}

256 
	$ldns_pkt_rcode2°r
(
ldns_pkt_rcode
 
rcode
)

258 *
°r
;

259 
ldns_buf„r
 *
buf
;

261 
buf
 = 
	`ldns_buf„r_√w
(10);

262 i‡(!
buf
) {

263  
NULL
;

266 
°r
 = 
NULL
;

267 i‡(
	`ldns_pkt_rcode2buf„r_°r
(
buf
, 
rcode
Ë=
LDNS_STATUS_OK
) {

268 
°r
 = 
	`ldns_buf„r_exp‹t2°r
(
buf
);

271 
	`ldns_buf„r_‰ì
(
buf
);

272  
°r
;

273 
	}
}

276 
	$ldns_pkt_Æg‹ôhm2°r
(
ldns_Æg‹ôhm
 
Æg‹ôhm
)

278 *
°r
;

279 
ldns_buf„r
 *
buf
;

281 
buf
 = 
	`ldns_buf„r_√w
(10);

282 i‡(!
buf
) {

283  
NULL
;

286 
°r
 = 
NULL
;

287 i‡(
	`ldns_Æg‹ôhm2buf„r_°r
(
buf
, 
Æg‹ôhm
)

288 =
LDNS_STATUS_OK
) {

289 
°r
 = 
	`ldns_buf„r_exp‹t2°r
(
buf
);

292 
	`ldns_buf„r_‰ì
(
buf
);

293  
°r
;

294 
	}
}

297 
	$ldns_pkt_˚π_Æg‹ôhm2°r
(
ldns_˚π_Æg‹ôhm
 
˚π_Æg‹ôhm
)

299 *
°r
;

300 
ldns_buf„r
 *
buf
;

302 
buf
 = 
	`ldns_buf„r_√w
(10);

303 i‡(!
buf
) {

304  
NULL
;

307 
°r
 = 
NULL
;

308 i‡(
	`ldns_˚π_Æg‹ôhm2buf„r_°r
(
buf
, 
˚π_Æg‹ôhm
)

309 =
LDNS_STATUS_OK
) {

310 
°r
 = 
	`ldns_buf„r_exp‹t2°r
(
buf
);

313 
	`ldns_buf„r_‰ì
(
buf
);

314  
°r
;

315 
	}
}

319 
ldns_°©us


320 
	$ldns_rdf2buf„r_°r_d«me
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
d«me
)

323 
uöt8_t
 
§c_pos
 = 0;

324 
uöt8_t
 
Àn
;

325 
uöt8_t
 *
d©a
;

326 
uöt8_t
 
i
;

327 
c
;

329 
d©a
 = (
uöt8_t
*)
	`ldns_rdf_d©a
(
d«me
);

330 
Àn
 = 
d©a
[
§c_pos
];

332 i‡(
	`ldns_rdf_size
(
d«me
Ë> 
LDNS_MAX_DOMAINLEN
) {

334  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

338 i‡(1 =
	`ldns_rdf_size
(
d«me
)) {

339 
	`ldns_buf„r_¥ötf
(
ouçut
, ".");

341 (
Àn
 > 0Ë&& 
§c_pos
 < 
	`ldns_rdf_size
(
d«me
)) {

342 
§c_pos
++;

343 
i
 = 0; i < 
Àn
; i++) {

347 
c
 = (Ë
d©a
[
§c_pos
];

348 if(
c
 == '.' || c == ';' ||

349 
c
 == '(' || c == ')' ||

350 
c
 == '\\') {

351 
	`ldns_buf„r_¥ötf
(
ouçut
, "\\%c",

352 
d©a
[
§c_pos
]);

353 } i‡(!(
	`ißscii
(
c
Ë&& 
	`isgøph
(c))) {

354 
	`ldns_buf„r_¥ötf
(
ouçut
, "\\%03u",

355 
d©a
[
§c_pos
]);

357 
	`ldns_buf„r_¥ötf
(
ouçut
, "%c", 
d©a
[
§c_pos
]);

359 
§c_pos
++;

362 i‡(
§c_pos
 < 
	`ldns_rdf_size
(
d«me
)) {

363 
	`ldns_buf„r_¥ötf
(
ouçut
, ".");

365 
Àn
 = 
d©a
[
§c_pos
];

368  
	`ldns_buf„r_°©us
(
ouçut
);

369 
	}
}

371 
ldns_°©us


372 
	$ldns_rdf2buf„r_°r_öt8
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

374 
uöt8_t
 
d©a
 = 
	`ldns_rdf_d©a
(
rdf
)[0];

375 
	`ldns_buf„r_¥ötf
(
ouçut
, "%lu", (Ë
d©a
);

376  
	`ldns_buf„r_°©us
(
ouçut
);

377 
	}
}

379 
ldns_°©us


380 
	$ldns_rdf2buf„r_°r_öt16
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

382 
uöt16_t
 
d©a
 = 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
));

383 
	`ldns_buf„r_¥ötf
(
ouçut
, "%lu", (Ë
d©a
);

384  
	`ldns_buf„r_°©us
(
ouçut
);

385 
	}
}

387 
ldns_°©us


388 
	$ldns_rdf2buf„r_°r_öt32
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

390 
uöt32_t
 
d©a
 = 
	`ldns_ªad_uöt32
(
	`ldns_rdf_d©a
(
rdf
));

391 
	`ldns_buf„r_¥ötf
(
ouçut
, "%lu", (Ë
d©a
);

392  
	`ldns_buf„r_°©us
(
ouçut
);

393 
	}
}

395 
ldns_°©us


396 
	$ldns_rdf2buf„r_°r_time
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

399 
tm
Åm;

400 
d©e_buf
[16];

402 
	`mem£t
(&
tm
, 0, (tm));

403 i‡(
	`ldns_£rül_¨ôhmôics_gmtime_r
(
	`ldns_rdf2«tive_öt32
(
rdf
), 
	`time
(
NULL
), &
tm
)

404 && 
	`°r·ime
(
d©e_buf
, 15, "%Y%m%d%H%M%S", &
tm
)) {

405 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
d©e_buf
);

407  
	`ldns_buf„r_°©us
(
ouçut
);

408 
	}
}

410 
ldns_°©us


411 
	$ldns_rdf2buf„r_°r_a
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

413 
°r
[
INET_ADDRSTRLEN
];

415 i‡(
	`öë_¡›
(
AF_INET
, 
	`ldns_rdf_d©a
(
rdf
), 
°r
, 
INET_ADDRSTRLEN
)) {

416 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
°r
);

418  
	`ldns_buf„r_°©us
(
ouçut
);

419 
	}
}

421 
ldns_°©us


422 
	$ldns_rdf2buf„r_°r_ØØ
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

424 
°r
[
INET6_ADDRSTRLEN
];

426 i‡(
	`öë_¡›
(
AF_INET6
, 
	`ldns_rdf_d©a
(
rdf
), 
°r
, 
INET6_ADDRSTRLEN
)) {

427 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
°r
);

430  
	`ldns_buf„r_°©us
(
ouçut
);

431 
	}
}

434 
	$ldns_ch¨a˘îs2buf„r_°r
(
ldns_buf„r
* 
ouçut
,

435 
size_t
 
amou¡
, c⁄° 
uöt8_t
* 
ch¨a˘îs
)

437 
uöt8_t
 
ch
;

438 
amou¡
 > 0) {

439 
ch
 = *
ch¨a˘îs
++;

440 i‡(
	`i•röt
(()
ch
) || ch == '\t') {

441 i‡(
ch
 == '\"' || ch == '\\')

442 
	`ldns_buf„r_¥ötf
(
ouçut
, "\\%c", 
ch
);

444 
	`ldns_buf„r_¥ötf
(
ouçut
, "%c", 
ch
);

446 
	`ldns_buf„r_¥ötf
(
ouçut
, "\\%03u",

447 ()(
uöt8_t
Ë
ch
);

449 
amou¡
--;

451 
	}
}

453 
ldns_°©us


454 
	$ldns_rdf2buf„r_°r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

456 if(
	`ldns_rdf_size
(
rdf
) < 1) {

457  
LDNS_STATUS_WIRE_RDATA_ERR
;

459 if(()
	`ldns_rdf_size
(
rdf
Ë< ()
	`ldns_rdf_d©a
(rdf)[0] + 1) {

460  
LDNS_STATUS_WIRE_RDATA_ERR
;

462 
	`ldns_buf„r_¥ötf
(
ouçut
, "\"");

463 
	`ldns_ch¨a˘îs2buf„r_°r
(
ouçut
,

464 
	`ldns_rdf_d©a
(
rdf
)[0],Üdns_rdf_data(rdf) + 1);

465 
	`ldns_buf„r_¥ötf
(
ouçut
, "\"");

466  
	`ldns_buf„r_°©us
(
ouçut
);

467 
	}
}

469 
ldns_°©us


470 
	$ldns_rdf2buf„r_°r_b64
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

472 
size_t
 
size
 = 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`ldns_rdf_size
(
rdf
));

473 *
b64
 = 
	`LDNS_XMALLOC
(, 
size
);

474 if(!
b64
Ë 
LDNS_STATUS_MEM_ERR
;

475 i‡(
	`ldns_b64_¡›
(
	`ldns_rdf_d©a
(
rdf
), 
	`ldns_rdf_size
‘df), 
b64
, 
size
)) {

476 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
b64
);

478 
	`LDNS_FREE
(
b64
);

479  
	`ldns_buf„r_°©us
(
ouçut
);

480 
	}
}

482 
ldns_°©us


483 
	$ldns_rdf2buf„r_°r_b32_ext
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

485 
size_t
 
size
;

486 *
b32
;

487 if(
	`ldns_rdf_size
(
rdf
) == 0)

488  
LDNS_STATUS_OK
;

490 
size
 = 
	`ldns_b32_¡›_ˇlcuœã_size
(
	`ldns_rdf_size
(
rdf
) - 1);

492 
b32
 = 
	`LDNS_XMALLOC
(, 
size
 + 1);

493 if(!
b32
Ë 
LDNS_STATUS_MEM_ERR
;

494 
size
 = (
size_t
Ë
	`ldns_b32_¡›_exãnded_hex
(
	`ldns_rdf_d©a
(
rdf
) + 1,

495 
	`ldns_rdf_size
(
rdf
Ë- 1, 
b32
, 
size
+1);

496 i‡(
size
 > 0) {

497 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
b32
);

499 
	`LDNS_FREE
(
b32
);

500  
	`ldns_buf„r_°©us
(
ouçut
);

501 
	}
}

503 
ldns_°©us


504 
	$ldns_rdf2buf„r_°r_hex
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

506 
size_t
 
i
;

507 
i
 = 0; i < 
	`ldns_rdf_size
(
rdf
); i++) {

508 
	`ldns_buf„r_¥ötf
(
ouçut
, "%02x", 
	`ldns_rdf_d©a
(
rdf
)[
i
]);

511  
	`ldns_buf„r_°©us
(
ouçut
);

512 
	}
}

514 
ldns_°©us


515 
	$ldns_rdf2buf„r_°r_ty≥_fmt
(
ldns_buf„r
 *
ouçut
,

516 c⁄° 
ldns_ouçut_f‹m©
* 
fmt
, c⁄° 
ldns_rdf
 *
rdf
)

518 
uöt16_t
 
d©a
 = 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
));

520 i‡(! 
	`ldns_ouçut_f‹m©_covîs_ty≥
(
fmt
, 
d©a
) &&

521 
	`ldns_º_des¸ùt
(
d©a
) &&

522 
	`ldns_º_des¸ùt
(
d©a
)->
_«me
) {

524 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s",
	`ldns_º_des¸ùt
(
d©a
)->
_«me
);

526 
	`ldns_buf„r_¥ötf
(
ouçut
, "TYPE%u", 
d©a
);

528  
	`ldns_buf„r_°©us
(
ouçut
);

529 
	}
}

531 
ldns_°©us


532 
	$ldns_rdf2buf„r_°r_ty≥
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

534  
	`ldns_rdf2buf„r_°r_ty≥_fmt
(
ouçut
,

535 
ldns_ouçut_f‹m©_deÁu…
, 
rdf
);

536 
	}
}

538 
ldns_°©us


539 
	$ldns_rdf2buf„r_°r_˛ass
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

541 
uöt16_t
 
d©a
 = 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
));

542 
ldns_lookup_èbÀ
 *
…
;

544 
…
 = 
	`ldns_lookup_by_id
(
ldns_º_˛as£s
, (Ë
d©a
);

545 i‡(
…
) {

546 
	`ldns_buf„r_¥ötf
(
ouçut
, "\t%s", 
…
->
«me
);

548 
	`ldns_buf„r_¥ötf
(
ouçut
, "\tCLASS%d", 
d©a
);

550  
	`ldns_buf„r_°©us
(
ouçut
);

551 
	}
}

553 
ldns_°©us


554 
	$ldns_rdf2buf„r_°r_˚π_Æg
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

556 
uöt16_t
 
d©a
 = 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
));

557 
ldns_lookup_èbÀ
 *
…
;

558 
…
 = 
	`ldns_lookup_by_id
(
ldns_˚π_Æg‹ôhms
, (Ë
d©a
);

559 i‡(
…
) {

560 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
…
->
«me
);

562 
	`ldns_buf„r_¥ötf
(
ouçut
, "%d", 
d©a
);

564  
	`ldns_buf„r_°©us
(
ouçut
);

565 
	}
}

567 
ldns_°©us


568 
	$ldns_rdf2buf„r_°r_Æg
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

572 
uöt8_t
 
d©a
 = 
	`ldns_rdf_d©a
(
rdf
)[0];

573 
	`ldns_buf„r_¥ötf
(
ouçut
, "%d", 
d©a
);

574  
	`ldns_buf„r_°©us
(
ouçut
);

575 
	}
}

578 
	$loc_cm_¥öt
(
ldns_buf„r
 *
ouçut
, 
uöt8_t
 
m™tisß
, uöt8_à
exp⁄ít
)

580 
uöt8_t
 
i
;

582 if(
exp⁄ít
 < 2) {

583 if(
exp⁄ít
 == 1)

584 
m™tisß
 *= 10;

585 
	`ldns_buf„r_¥ötf
(
ouçut
, "0.%02ld", ()
m™tisß
);

589 
	`ldns_buf„r_¥ötf
(
ouçut
, "%d", ()
m™tisß
);

590 
i
=0; i<
exp⁄ít
-2; i++)

591 
	`ldns_buf„r_¥ötf
(
ouçut
, "0");

592 
	}
}

594 
ldns_°©us


595 
	$ldns_º_ty≥2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º_ty≥
 
ty≥
)

597 c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
;

599 
des¸ùt‹
 = 
	`ldns_º_des¸ùt
(
ty≥
);

601 i‡(
des¸ùt‹
 && des¸ùt‹->
_«me
) {

602 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
des¸ùt‹
->
_«me
);

605 
ty≥
) {

606 
LDNS_RR_TYPE_IXFR
:

607 
	`ldns_buf„r_¥ötf
(
ouçut
, "IXFR");

609 
LDNS_RR_TYPE_AXFR
:

610 
	`ldns_buf„r_¥ötf
(
ouçut
, "AXFR");

612 
LDNS_RR_TYPE_MAILA
:

613 
	`ldns_buf„r_¥ötf
(
ouçut
, "MAILA");

615 
LDNS_RR_TYPE_MAILB
:

616 
	`ldns_buf„r_¥ötf
(
ouçut
, "MAILB");

618 
LDNS_RR_TYPE_ANY
:

619 
	`ldns_buf„r_¥ötf
(
ouçut
, "ANY");

622 
	`ldns_buf„r_¥ötf
(
ouçut
, "TYPE%u", 
ty≥
);

625  
	`ldns_buf„r_°©us
(
ouçut
);

626 
	}
}

629 
	$ldns_º_ty≥2°r
(c⁄° 
ldns_º_ty≥
 
ty≥
)

631 *
°r
;

632 
ldns_buf„r
 *
buf
;

634 
buf
 = 
	`ldns_buf„r_√w
(10);

635 i‡(!
buf
) {

636  
NULL
;

639 
°r
 = 
NULL
;

640 i‡(
	`ldns_º_ty≥2buf„r_°r
(
buf
, 
ty≥
Ë=
LDNS_STATUS_OK
) {

641 
°r
 = 
	`ldns_buf„r_exp‹t2°r
(
buf
);

644 
	`ldns_buf„r_‰ì
(
buf
);

645  
°r
;

646 
	}
}

649 
ldns_°©us


650 
	$ldns_º_˛ass2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

651 c⁄° 
ldns_º_˛ass
 
kœss
)

653 
ldns_lookup_èbÀ
 *
…
;

655 
…
 = 
	`ldns_lookup_by_id
(
ldns_º_˛as£s
, 
kœss
);

656 i‡(
…
) {

657 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
…
->
«me
);

659 
	`ldns_buf„r_¥ötf
(
ouçut
, "CLASS%d", 
kœss
);

661  
	`ldns_buf„r_°©us
(
ouçut
);

662 
	}
}

665 
	$ldns_º_˛ass2°r
(c⁄° 
ldns_º_˛ass
 
kœss
)

667 
ldns_buf„r
 *
buf
;

668 *
°r
;

670 
buf
 = 
	`ldns_buf„r_√w
(10);

671 i‡(!
buf
) {

672  
NULL
;

675 
°r
 = 
NULL
;

676 i‡(
	`ldns_º_˛ass2buf„r_°r
(
buf
, 
kœss
Ë=
LDNS_STATUS_OK
) {

677 
°r
 = 
	`ldns_buf„r_exp‹t2°r
(
buf
);

679 
	`ldns_buf„r_‰ì
(
buf
);

680  
°r
;

681 
	}
}

683 
ldns_°©us


684 
	$ldns_rdf2buf„r_°r_loc
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

687 
uöt8_t
 
vîsi⁄
;

688 
uöt8_t
 
size
;

689 
uöt8_t
 
h‹iz⁄èl_¥ecisi⁄
;

690 
uöt8_t
 
vîtiˇl_¥ecisi⁄
;

691 
uöt32_t
 
l⁄gôude
;

692 
uöt32_t
 
œtôude
;

693 
uöt32_t
 
Ætôude
;

694 
n‹thî√ss
;

695 
ó°î√ss
;

696 
uöt32_t
 
h
;

697 
uöt32_t
 
m
;

698 
s
;

700 
uöt32_t
 
equ©‹
 = (uöt32_tË
	`ldns_powî
(2, 31);

702 if(
	`ldns_rdf_size
(
rdf
) < 1) {

703  
LDNS_STATUS_WIRE_RDATA_ERR
;

705 
vîsi⁄
 = 
	`ldns_rdf_d©a
(
rdf
)[0];

706 i‡(
vîsi⁄
 == 0) {

707 if(
	`ldns_rdf_size
(
rdf
) < 16) {

708  
LDNS_STATUS_WIRE_RDATA_ERR
;

710 
size
 = 
	`ldns_rdf_d©a
(
rdf
)[1];

711 
h‹iz⁄èl_¥ecisi⁄
 = 
	`ldns_rdf_d©a
(
rdf
)[2];

712 
vîtiˇl_¥ecisi⁄
 = 
	`ldns_rdf_d©a
(
rdf
)[3];

714 
œtôude
 = 
	`ldns_ªad_uöt32
(&
	`ldns_rdf_d©a
(
rdf
)[4]);

715 
l⁄gôude
 = 
	`ldns_ªad_uöt32
(&
	`ldns_rdf_d©a
(
rdf
)[8]);

716 
Ætôude
 = 
	`ldns_ªad_uöt32
(&
	`ldns_rdf_d©a
(
rdf
)[12]);

718 i‡(
œtôude
 > 
equ©‹
) {

719 
n‹thî√ss
 = 'N';

720 
œtôude
 =Ü©ôudê- 
equ©‹
;

722 
n‹thî√ss
 = 'S';

723 
œtôude
 = 
equ©‹
 -Üatitude;

725 
h
 = 
œtôude
 / (1000 * 60 * 60);

726 
œtôude
 =Üatitude % (1000 * 60 * 60);

727 
m
 = 
œtôude
 / (1000 * 60);

728 
œtôude
 =Üatitude % (1000 * 60);

729 
s
 = (Ë
œtôude
 / 1000.0;

730 
	`ldns_buf„r_¥ötf
(
ouçut
, "%02u %02u %0.3f %c ",

731 
h
, 
m
, 
s
, 
n‹thî√ss
);

733 i‡(
l⁄gôude
 > 
equ©‹
) {

734 
ó°î√ss
 = 'E';

735 
l⁄gôude
 =Ü⁄gôudê- 
equ©‹
;

737 
ó°î√ss
 = 'W';

738 
l⁄gôude
 = 
equ©‹
 -Üongitude;

740 
h
 = 
l⁄gôude
 / (1000 * 60 * 60);

741 
l⁄gôude
 =Üongitude % (1000 * 60 * 60);

742 
m
 = 
l⁄gôude
 / (1000 * 60);

743 
l⁄gôude
 =Üongitude % (1000 * 60);

744 
s
 = (Ë
l⁄gôude
 / (1000.0);

745 
	`ldns_buf„r_¥ötf
(
ouçut
, "%02u %02u %0.3f %c ",

746 
h
, 
m
, 
s
, 
ó°î√ss
);

749 
s
 = ((Ë
Ætôude
) / 100;

750 
s
 -= 100000;

752 if(
Ætôude
%100 != 0)

753 
	`ldns_buf„r_¥ötf
(
ouçut
, "%.2f", 
s
);

755 
	`ldns_buf„r_¥ötf
(
ouçut
, "%.0f", 
s
);

757 
	`ldns_buf„r_¥ötf
(
ouçut
, "m ");

759 
	`loc_cm_¥öt
(
ouçut
, (
size
 & 0xf0) >> 4, size & 0x0f);

760 
	`ldns_buf„r_¥ötf
(
ouçut
, "m ");

762 
	`loc_cm_¥öt
(
ouçut
, (
h‹iz⁄èl_¥ecisi⁄
 & 0xf0) >> 4,

763 
h‹iz⁄èl_¥ecisi⁄
 & 0x0f);

764 
	`ldns_buf„r_¥ötf
(
ouçut
, "m ");

766 
	`loc_cm_¥öt
(
ouçut
, (
vîtiˇl_¥ecisi⁄
 & 0xf0) >> 4,

767 
vîtiˇl_¥ecisi⁄
 & 0x0f);

768 
	`ldns_buf„r_¥ötf
(
ouçut
, "m");

770  
	`ldns_buf„r_°©us
(
ouçut
);

772  
	`ldns_rdf2buf„r_°r_hex
(
ouçut
, 
rdf
);

774 
	}
}

776 
ldns_°©us


777 
	$ldns_rdf2buf„r_°r_unknown
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

779 
	`ldns_buf„r_¥ötf
(
ouçut
, "\\# %u ", 
	`ldns_rdf_size
(
rdf
));

780  
	`ldns_rdf2buf„r_°r_hex
(
ouçut
, 
rdf
);

781 
	}
}

783 
ldns_°©us


784 
	$ldns_rdf2buf„r_°r_nßp
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

786 
	`ldns_buf„r_¥ötf
(
ouçut
, "0x");

787  
	`ldns_rdf2buf„r_°r_hex
(
ouçut
, 
rdf
);

788 
	}
}

790 
ldns_°©us


791 
	$ldns_rdf2buf„r_°r_©ma
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

793  
	`ldns_rdf2buf„r_°r_hex
(
ouçut
, 
rdf
);

794 
	}
}

796 
ldns_°©us


797 
	$ldns_rdf2buf„r_°r_wks
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

800 
¥Ÿ€¡
 *
¥Ÿocﬁ
;

801 *
¥Ÿo_«me
 = 
NULL
;

802 
uöt8_t
 
¥Ÿocﬁ_ƒ
;

803 
£rvít
 *
£rvi˚
;

804 
uöt16_t
 
cuºít_£rvi˚
;

806 if(
	`ldns_rdf_size
(
rdf
) < 1) {

807  
LDNS_STATUS_WIRE_RDATA_ERR
;

809 
¥Ÿocﬁ_ƒ
 = 
	`ldns_rdf_d©a
(
rdf
)[0];

810 
¥Ÿocﬁ
 = 
	`gë¥Ÿobynumbî
((Ë
¥Ÿocﬁ_ƒ
);

811 i‡(
¥Ÿocﬁ
 && (¥Ÿocﬁ->
p_«me
 !
NULL
)) {

812 
¥Ÿo_«me
 = 
¥Ÿocﬁ
->
p_«me
;

813 
	`ldns_buf„r_¥ötf
(
ouçut
, "%†", 
¥Ÿocﬁ
->
p_«me
);

815 
	`ldns_buf„r_¥ötf
(
ouçut
, "%u ", 
¥Ÿocﬁ_ƒ
);

818 #ifde‡
HAVE_ENDPROTOENT


819 
	`íd¥Ÿ€¡
();

822 
cuºít_£rvi˚
 = 0;

823 
cuºít_£rvi˚
 < 
	`ldns_rdf_size
(
rdf
) * 7; current_service++) {

824 i‡(
	`ldns_gë_bô
(&(
	`ldns_rdf_d©a
(
rdf
)[1]), 
cuºít_£rvi˚
)) {

825 
£rvi˚
 = 
	`gë£rvbyp‹t
((Ë
	`ht⁄s
(
cuºít_£rvi˚
),

826 
¥Ÿo_«me
);

827 i‡(
£rvi˚
 && sîvi˚->
s_«me
) {

828 
	`ldns_buf„r_¥ötf
(
ouçut
, "%†", 
£rvi˚
->
s_«me
);

830 
	`ldns_buf„r_¥ötf
(
ouçut
, "%u ", 
cuºít_£rvi˚
);

832 #ifde‡
HAVE_ENDSERVENT


833 
	`íd£rvít
();

837  
	`ldns_buf„r_°©us
(
ouçut
);

838 
	}
}

840 
ldns_°©us


841 
	$ldns_rdf2buf„r_°r_n£c_fmt
(
ldns_buf„r
 *
ouçut
,

842 c⁄° 
ldns_ouçut_f‹m©
* 
fmt
, c⁄° 
ldns_rdf
 *
rdf
)

847 
uöt8_t
 
wödow_block_ƒ
;

848 
uöt8_t
 
bôm≠_Àngth
;

849 
uöt16_t
 
ty≥
;

850 
uöt16_t
 
pos
 = 0;

851 
uöt16_t
 
bô_pos
;

852 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

854 (
size_t
)(
pos
 + 2Ë< 
	`ldns_rdf_size
(
rdf
)) {

855 
wödow_block_ƒ
 = 
d©a
[
pos
];

856 
bôm≠_Àngth
 = 
d©a
[
pos
 + 1];

857 
pos
 += 2;

858 i‡(
	`ldns_rdf_size
(
rdf
Ë< 
pos
 + 
bôm≠_Àngth
) {

859  
LDNS_STATUS_WIRE_RDATA_ERR
;

861 
bô_pos
 = 0; bô_po†< (
bôm≠_Àngth
) * 8; bit_pos++) {

862 i‡(! 
	`ldns_gë_bô
(&
d©a
[
pos
], 
bô_pos
)) {

865 
ty≥
 = 256 * (
uöt16_t
Ë
wödow_block_ƒ
 + 
bô_pos
;

867 i‡(! 
	`ldns_ouçut_f‹m©_covîs_ty≥
(
fmt
, 
ty≥
) &&

868 
	`ldns_º_des¸ùt
(
ty≥
) &&

869 
	`ldns_º_des¸ùt
(
ty≥
)->
_«me
){

871 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s ",

872 
	`ldns_º_des¸ùt
(
ty≥
)->
_«me
);

874 
	`ldns_buf„r_¥ötf
(
ouçut
, "TYPE%u ", 
ty≥
);

877 
pos
 +(
uöt16_t
Ë
bôm≠_Àngth
;

879  
	`ldns_buf„r_°©us
(
ouçut
);

880 
	}
}

882 
ldns_°©us


883 
	$ldns_rdf2buf„r_°r_n£c
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

885  
	`ldns_rdf2buf„r_°r_n£c_fmt
(
ouçut
,

886 
ldns_ouçut_f‹m©_deÁu…
, 
rdf
);

887 
	}
}

889 
ldns_°©us


890 
	$ldns_rdf2buf„r_°r_n£c3_ß…
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

892 
uöt8_t
 
ß…_Àngth
;

893 
uöt8_t
 
ß…_pos
;

895 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

897 if(
	`ldns_rdf_size
(
rdf
) < 1) {

898  
LDNS_STATUS_WIRE_RDATA_ERR
;

900 
ß…_Àngth
 = 
d©a
[0];

902 i‡(
ß…_Àngth
 =0 || ((
size_t
)ß…_Àngth)+1 > 
	`ldns_rdf_size
(
rdf
)) {

903 
	`ldns_buf„r_¥ötf
(
ouçut
, "- ");

905 
ß…_pos
 = 0; sÆt_po†< 
ß…_Àngth
; salt_pos++) {

906 
	`ldns_buf„r_¥ötf
(
ouçut
, "%02x", 
d©a
[1 + 
ß…_pos
]);

908 
	`ldns_buf„r_¥ötf
(
ouçut
, " ");

911  
	`ldns_buf„r_°©us
(
ouçut
);

912 
	}
}

914 
ldns_°©us


915 
	$ldns_rdf2buf„r_°r_≥riod
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

918 i‡(
	`ldns_rdf_size
(
rdf
) != 4) {

919  
LDNS_STATUS_WIRE_RDATA_ERR
;

921 
	`ldns_buf„r_¥ötf
(
ouçut
, "%u", 
	`ldns_ªad_uöt32
(
	`ldns_rdf_d©a
(
rdf
)));

922  
	`ldns_buf„r_°©us
(
ouçut
);

923 
	}
}

925 
ldns_°©us


926 
	$ldns_rdf2buf„r_°r_tsigtime
(
ldns_buf„r
 *
ouçut
,c⁄° 
ldns_rdf
 *
rdf
)

929 
uöt64_t
 
tsigtime
 = 0;

930 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

931 
uöt64_t
 
d0
, 
d1
, 
d2
, 
d3
, 
d4
, 
d5
;

933 i‡(
	`ldns_rdf_size
(
rdf
) < 6) {

934  
LDNS_STATUS_WIRE_RDATA_ERR
;

936 
d0
 = 
d©a
[0];

937 
d1
 = 
d©a
[1];

938 
d2
 = 
d©a
[2];

939 
d3
 = 
d©a
[3];

940 
d4
 = 
d©a
[4];

941 
d5
 = 
d©a
[5];

942 
tsigtime
 = (
d0
<<40Ë| (
d1
<<32Ë| (
d2
<<24Ë| (
d3
<<16Ë| (
d4
<<8Ë| 
d5
;

944 
	`ldns_buf„r_¥ötf
(
ouçut
, "%Œu ", ()
tsigtime
);

946  
	`ldns_buf„r_°©us
(
ouçut
);

947 
	}
}

949 
ldns_°©us


950 
	$ldns_rdf2buf„r_°r_≠l
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

952 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

953 
uöt16_t
 
addªss_Ámûy
;

954 
uöt8_t
 
¥efix
;

955 
boﬁ
 
√g©i⁄
;

956 
uöt8_t
 
adf_Àngth
;

957 
size_t
 
i
;

958 
size_t
 
pos
 = 0;

960 
pos
 < (Ë
	`ldns_rdf_size
(
rdf
)) {

961 if(
pos
 + 3 >()
	`ldns_rdf_size
(
rdf
))

962  
LDNS_STATUS_WIRE_RDATA_ERR
;

963 
addªss_Ámûy
 = 
	`ldns_ªad_uöt16
(&
d©a
[
pos
]);

964 
¥efix
 = 
d©a
[
pos
 + 2];

965 
√g©i⁄
 = 
d©a
[
pos
 + 3] & 
LDNS_APL_NEGATION
;

966 
adf_Àngth
 = 
d©a
[
pos
 + 3] & 
LDNS_APL_MASK
;

967 i‡(
addªss_Ámûy
 =
LDNS_APL_IP4
) {

969 i‡(
√g©i⁄
) {

970 
	`ldns_buf„r_¥ötf
(
ouçut
, "!");

972 
	`ldns_buf„r_¥ötf
(
ouçut
, "%u:", 
addªss_Ámûy
);

974 
i
 = 0; i < 4; i++) {

975 i‡(
i
 > 0) {

976 
	`ldns_buf„r_¥ötf
(
ouçut
, ".");

978 i‡(
i
 < (Ë
adf_Àngth
) {

979 if(
pos
+
i
+4 >
	`ldns_rdf_size
(
rdf
))

980  
LDNS_STATUS_WIRE_RDATA_ERR
;

981 
	`ldns_buf„r_¥ötf
(
ouçut
, "%d",

982 
d©a
[
pos
 + 
i
 + 4]);

984 
	`ldns_buf„r_¥ötf
(
ouçut
, "0");

987 
	`ldns_buf„r_¥ötf
(
ouçut
, "/%u ", 
¥efix
);

988 } i‡(
addªss_Ámûy
 =
LDNS_APL_IP6
) {

990 i‡(
√g©i⁄
) {

991 
	`ldns_buf„r_¥ötf
(
ouçut
, "!");

993 
	`ldns_buf„r_¥ötf
(
ouçut
, "%u:", 
addªss_Ámûy
);

995 
i
 = 0; i < 16; i++) {

996 i‡(
i
 % 2 == 0 && i > 0) {

997 
	`ldns_buf„r_¥ötf
(
ouçut
, ":");

999 i‡(
i
 < (Ë
adf_Àngth
) {

1000 if(
pos
+
i
+4 >
	`ldns_rdf_size
(
rdf
))

1001  
LDNS_STATUS_WIRE_RDATA_ERR
;

1002 
	`ldns_buf„r_¥ötf
(
ouçut
, "%02x",

1003 
d©a
[
pos
 + 
i
 + 4]);

1005 
	`ldns_buf„r_¥ötf
(
ouçut
, "00");

1008 
	`ldns_buf„r_¥ötf
(
ouçut
, "/%u ", 
¥efix
);

1012 
	`ldns_buf„r_¥ötf
(
ouçut
,

1014 
addªss_Ámûy
);

1015 
i
 = 1; i < (Ë(4 + 
adf_Àngth
); i++) {

1016 if(
pos
+
i
 >
	`ldns_rdf_size
(
rdf
))

1017  
LDNS_STATUS_WIRE_RDATA_ERR
;

1018 
	`ldns_buf„r_¥ötf
(
ouçut
, "%02x", 
d©a
[
i
]);

1021 
pos
 +4 + 
adf_Àngth
;

1023  
	`ldns_buf„r_°©us
(
ouçut
);

1024 
	}
}

1026 
ldns_°©us


1027 
	$ldns_rdf2buf„r_°r_öt16_d©a
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1029 
size_t
 
size
;

1030 *
b64
;

1031 i‡(
	`ldns_rdf_size
(
rdf
) < 2) {

1032  
LDNS_STATUS_WIRE_RDATA_ERR
;

1035 
size
 = 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`ldns_rdf_size
(
rdf
) - 2);

1036 
	`ldns_buf„r_¥ötf
(
ouçut
, "%u ", 
	`ldns_rdf_size
(
rdf
) - 2);

1037 i‡(
	`ldns_rdf_size
(
rdf
) > 2) {

1038 
b64
 = 
	`LDNS_XMALLOC
(, 
size
);

1039 if(!
b64
)

1040  
LDNS_STATUS_MEM_ERR
;

1042 i‡(
	`ldns_rdf_size
(
rdf
) > 2 &&

1043 
	`ldns_b64_¡›
(
	`ldns_rdf_d©a
(
rdf
) + 2,

1044 
	`ldns_rdf_size
(
rdf
) - 2,

1045 
b64
, 
size
)) {

1046 
	`ldns_buf„r_¥ötf
(
ouçut
, "%s", 
b64
);

1048 
	`LDNS_FREE
(
b64
);

1050  
	`ldns_buf„r_°©us
(
ouçut
);

1051 
	}
}

1053 
ldns_°©us


1054 
	$ldns_rdf2buf„r_°r_ù£ckey
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1059 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

1060 
uöt8_t
 
¥e˚dí˚
;

1061 
uöt8_t
 
g©eway_ty≥
;

1062 
uöt8_t
 
Æg‹ôhm
;

1064 
ldns_rdf
 *
g©eway
 = 
NULL
;

1065 
uöt8_t
 *
g©eway_d©a
;

1067 
size_t
 
public_key_size
;

1068 
uöt8_t
 *
public_key_d©a
;

1069 
ldns_rdf
 *
public_key
;

1071 
size_t
 
off£t
 = 0;

1072 
ldns_°©us
 
°©us
;

1074 i‡(
	`ldns_rdf_size
(
rdf
) < 3) {

1075  
LDNS_STATUS_WIRE_RDATA_ERR
;

1077 
¥e˚dí˚
 = 
d©a
[0];

1078 
g©eway_ty≥
 = 
d©a
[1];

1079 
Æg‹ôhm
 = 
d©a
[2];

1080 
off£t
 = 3;

1082 
g©eway_ty≥
) {

1087 
g©eway_d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_IP4ADDRLEN
);

1088 if(!
g©eway_d©a
)

1089  
LDNS_STATUS_MEM_ERR
;

1090 i‡(
	`ldns_rdf_size
(
rdf
Ë< 
off£t
 + 
LDNS_IP4ADDRLEN
) {

1091  
LDNS_STATUS_ERR
;

1093 
	`mem˝y
(
g©eway_d©a
, &
d©a
[
off£t
], 
LDNS_IP4ADDRLEN
);

1094 
g©eway
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_A
,

1095 
LDNS_IP4ADDRLEN
 , 
g©eway_d©a
);

1096 
off£t
 +
LDNS_IP4ADDRLEN
;

1097 if(!
g©eway
) {

1098 
	`LDNS_FREE
(
g©eway_d©a
);

1099  
LDNS_STATUS_MEM_ERR
;

1103 
g©eway_d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_IP6ADDRLEN
);

1104 if(!
g©eway_d©a
)

1105  
LDNS_STATUS_MEM_ERR
;

1106 i‡(
	`ldns_rdf_size
(
rdf
Ë< 
off£t
 + 
LDNS_IP6ADDRLEN
) {

1107  
LDNS_STATUS_ERR
;

1109 
	`mem˝y
(
g©eway_d©a
, &
d©a
[
off£t
], 
LDNS_IP6ADDRLEN
);

1110 
off£t
 +
LDNS_IP6ADDRLEN
;

1111 
g©eway
 =

1112 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_AAAA
,

1113 
LDNS_IP6ADDRLEN
, 
g©eway_d©a
);

1114 if(!
g©eway
) {

1115 
	`LDNS_FREE
(
g©eway_d©a
);

1116  
LDNS_STATUS_MEM_ERR
;

1120 
°©us
 = 
	`ldns_wúe2d«me
(&
g©eway
, 
d©a
,

1121 
	`ldns_rdf_size
(
rdf
), &
off£t
);

1122 if(
°©us
 !
LDNS_STATUS_OK
)

1123  
°©us
;

1130 i‡(
	`ldns_rdf_size
(
rdf
Ë<
off£t
) {

1131  
LDNS_STATUS_ERR
;

1133 
public_key_size
 = 
	`ldns_rdf_size
(
rdf
Ë- 
off£t
;

1134 
public_key_d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
public_key_size
);

1135 if(!
public_key_d©a
) {

1136 
	`ldns_rdf_‰ì
(
g©eway
);

1137  
LDNS_STATUS_MEM_ERR
;

1139 
	`mem˝y
(
public_key_d©a
, &
d©a
[
off£t
], 
public_key_size
);

1140 
public_key
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_B64
,

1141 
public_key_size
, 
public_key_d©a
);

1142 if(!
public_key
) {

1143 
	`LDNS_FREE
(
public_key_d©a
);

1144 
	`ldns_rdf_‰ì
(
g©eway
);

1145  
LDNS_STATUS_MEM_ERR
;

1148 
	`ldns_buf„r_¥ötf
(
ouçut
, "%u %u %u ", 
¥e˚dí˚
, 
g©eway_ty≥
, 
Æg‹ôhm
);

1149 i‡(
g©eway
)

1150 (Ë
	`ldns_rdf2buf„r_°r
(
ouçut
, 
g©eway
);

1152 
	`ldns_buf„r_¥ötf
(
ouçut
, ".");

1153 
	`ldns_buf„r_¥ötf
(
ouçut
, " ");

1154 (Ë
	`ldns_rdf2buf„r_°r
(
ouçut
, 
public_key
);

1156 
	`ldns_rdf_‰ì
(
g©eway
);

1157 
	`ldns_rdf_‰ì
(
public_key
);

1159  
	`ldns_buf„r_°©us
(
ouçut
);

1160 
	}
}

1162 
ldns_°©us


1163 
	$ldns_rdf2buf„r_°r_û≈64
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1165 i‡(
	`ldns_rdf_size
(
rdf
) != 8) {

1166  
LDNS_STATUS_WIRE_RDATA_ERR
;

1168 
	`ldns_buf„r_¥ötf
(
ouçut
,"%.4x:%.4x:%.4x:%.4x",

1169 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
)),

1170 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
)+2),

1171 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
)+4),

1172 
	`ldns_ªad_uöt16
(
	`ldns_rdf_d©a
(
rdf
)+6));

1173  
	`ldns_buf„r_°©us
(
ouçut
);

1174 
	}
}

1176 
ldns_°©us


1177 
	$ldns_rdf2buf„r_°r_eui48
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1179 i‡(
	`ldns_rdf_size
(
rdf
) != 6) {

1180  
LDNS_STATUS_WIRE_RDATA_ERR
;

1182 
	`ldns_buf„r_¥ötf
(
ouçut
,"%.2x-%.2x-%.2x-%.2x-%.2x-%.2x",

1183 
	`ldns_rdf_d©a
(
rdf
)[0],Üdns_rdf_data(rdf)[1],

1184 
	`ldns_rdf_d©a
(
rdf
)[2],Üdns_rdf_data(rdf)[3],

1185 
	`ldns_rdf_d©a
(
rdf
)[4],Üdns_rdf_data(rdf)[5]);

1186  
	`ldns_buf„r_°©us
(
ouçut
);

1187 
	}
}

1189 
ldns_°©us


1190 
	$ldns_rdf2buf„r_°r_eui64
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1192 i‡(
	`ldns_rdf_size
(
rdf
) != 8) {

1193  
LDNS_STATUS_WIRE_RDATA_ERR
;

1195 
	`ldns_buf„r_¥ötf
(
ouçut
,"%.2x-%.2x-%.2x-%.2x-%.2x-%.2x-%.2x-%.2x",

1196 
	`ldns_rdf_d©a
(
rdf
)[0],Üdns_rdf_data(rdf)[1],

1197 
	`ldns_rdf_d©a
(
rdf
)[2],Üdns_rdf_data(rdf)[3],

1198 
	`ldns_rdf_d©a
(
rdf
)[4],Üdns_rdf_data(rdf)[5],

1199 
	`ldns_rdf_d©a
(
rdf
)[6],Üdns_rdf_data(rdf)[7]);

1200  
	`ldns_buf„r_°©us
(
ouçut
);

1201 
	}
}

1203 
ldns_°©us


1204 
	$ldns_rdf2buf„r_°r_èg
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1206 
size_t
 
nch¨s
;

1207 c⁄° 
uöt8_t
* 
ch¨s
;

1208 
ch
;

1209 i‡(
	`ldns_rdf_size
(
rdf
) < 2) {

1210  
LDNS_STATUS_WIRE_RDATA_ERR
;

1212 
nch¨s
 = 
	`ldns_rdf_d©a
(
rdf
)[0];

1213 i‡(
nch¨s
 >
	`ldns_rdf_size
(
rdf
) ||

1214 
nch¨s
 < 1) {

1215  
LDNS_STATUS_WIRE_RDATA_ERR
;

1217 
ch¨s
 = 
	`ldns_rdf_d©a
(
rdf
) + 1;

1218 
nch¨s
 > 0) {

1219 
ch
 = ()*
ch¨s
++;

1220 i‡(! 
	`iß um
(
ch
)) {

1221  
LDNS_STATUS_WIRE_RDATA_ERR
;

1223 
	`ldns_buf„r_¥ötf
(
ouçut
, "%c", 
ch
);

1224 
nch¨s
--;

1226  
	`ldns_buf„r_°©us
(
ouçut
);

1227 
	}
}

1229 
ldns_°©us


1230 
	$ldns_rdf2buf„r_°r_l⁄g_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1233 
	`ldns_buf„r_¥ötf
(
ouçut
, "\"");

1234 
	`ldns_ch¨a˘îs2buf„r_°r
(
ouçut
,

1235 
	`ldns_rdf_size
(
rdf
), 
	`ldns_rdf_d©a
(rdf));

1236 
	`ldns_buf„r_¥ötf
(
ouçut
, "\"");

1237  
	`ldns_buf„r_°©us
(
ouçut
);

1238 
	}
}

1240 
ldns_°©us


1241 
	$ldns_rdf2buf„r_°r_hù
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

1243 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

1244 
size_t
 
rdf_size
 = 
	`ldns_rdf_size
(
rdf
);

1245 
uöt8_t
 
hô_size
;

1246 
uöt16_t
 
pk_size
;

1247 
wrôãn
;

1249 i‡(
rdf_size
 < 6) {

1250  
LDNS_STATUS_WIRE_RDATA_ERR
;

1252 i‡((
hô_size
 = 
d©a
[0]) == 0 ||

1253 (
pk_size
 = 
	`ldns_ªad_uöt16
(
d©a
 + 2)) == 0 ||

1254 
rdf_size
 < (
size_t
Ë
hô_size
 + 
pk_size
 + 4) {

1256  
LDNS_STATUS_WIRE_RDATA_ERR
;

1259 
	`ldns_buf„r_¥ötf
(
ouçut
, "%d ", (Ë
d©a
[1]);

1261 
d©a
 +4; 
hô_size
 > 0; hit_size--, data++) {

1263 
	`ldns_buf„r_¥ötf
(
ouçut
, "%02x", (Ë*
d©a
);

1265 
	`ldns_buf„r_wrôe_u8
(
ouçut
, (
uöt8_t
) ' ');

1267 i‡(
	`ldns_buf„r_ª£rve
(
ouçut
,

1268 
	`ldns_b64_¡›_ˇlcuœã_size
(
pk_size
))) {

1270 
wrôãn
 = 
	`ldns_b64_¡›
(
d©a
, 
pk_size
,

1271 (*Ë
	`ldns_buf„r_cuºít
(
ouçut
),

1272 
	`ldns_buf„r_ªmaöög
(
ouçut
));

1274 i‡(
wrôãn
 > 0 &&

1275 
wrôãn
 < (Ë
	`ldns_buf„r_ªmaöög
(
ouçut
)) {

1277 
ouçut
->
_posôi⁄
 +
wrôãn
;

1280  
	`ldns_buf„r_°©us
(
ouçut
);

1281 
	}
}

1283 
ldns_°©us


1284 
	$ldns_rdf2buf„r_°r_fmt
(
ldns_buf„r
 *
buf„r
,

1285 c⁄° 
ldns_ouçut_f‹m©
* 
fmt
, c⁄° 
ldns_rdf
 *
rdf
)

1287 
ldns_°©us
 
ªs
 = 
LDNS_STATUS_OK
;

1290 i‡(
rdf
) {

1291 
	`ldns_rdf_gë_ty≥
(
rdf
)) {

1292 
LDNS_RDF_TYPE_NONE
:

1294 
LDNS_RDF_TYPE_DNAME
:

1295 
ªs
 = 
	`ldns_rdf2buf„r_°r_d«me
(
buf„r
, 
rdf
);

1297 
LDNS_RDF_TYPE_INT8
:

1298 
ªs
 = 
	`ldns_rdf2buf„r_°r_öt8
(
buf„r
, 
rdf
);

1300 
LDNS_RDF_TYPE_INT16
:

1301 
ªs
 = 
	`ldns_rdf2buf„r_°r_öt16
(
buf„r
, 
rdf
);

1303 
LDNS_RDF_TYPE_INT32
:

1304 
ªs
 = 
	`ldns_rdf2buf„r_°r_öt32
(
buf„r
, 
rdf
);

1306 
LDNS_RDF_TYPE_PERIOD
:

1307 
ªs
 = 
	`ldns_rdf2buf„r_°r_≥riod
(
buf„r
, 
rdf
);

1309 
LDNS_RDF_TYPE_TSIGTIME
:

1310 
ªs
 = 
	`ldns_rdf2buf„r_°r_tsigtime
(
buf„r
, 
rdf
);

1312 
LDNS_RDF_TYPE_A
:

1313 
ªs
 = 
	`ldns_rdf2buf„r_°r_a
(
buf„r
, 
rdf
);

1315 
LDNS_RDF_TYPE_AAAA
:

1316 
ªs
 = 
	`ldns_rdf2buf„r_°r_ØØ
(
buf„r
, 
rdf
);

1318 
LDNS_RDF_TYPE_STR
:

1319 
ªs
 = 
	`ldns_rdf2buf„r_°r_°r
(
buf„r
, 
rdf
);

1321 
LDNS_RDF_TYPE_APL
:

1322 
ªs
 = 
	`ldns_rdf2buf„r_°r_≠l
(
buf„r
, 
rdf
);

1324 
LDNS_RDF_TYPE_B32_EXT
:

1325 
ªs
 = 
	`ldns_rdf2buf„r_°r_b32_ext
(
buf„r
, 
rdf
);

1327 
LDNS_RDF_TYPE_B64
:

1328 
ªs
 = 
	`ldns_rdf2buf„r_°r_b64
(
buf„r
, 
rdf
);

1330 
LDNS_RDF_TYPE_HEX
:

1331 
ªs
 = 
	`ldns_rdf2buf„r_°r_hex
(
buf„r
, 
rdf
);

1333 
LDNS_RDF_TYPE_NSEC
:

1334 
ªs
 = 
	`ldns_rdf2buf„r_°r_n£c_fmt
(
buf„r
, 
fmt
, 
rdf
);

1336 
LDNS_RDF_TYPE_NSEC3_SALT
:

1337 
ªs
 = 
	`ldns_rdf2buf„r_°r_n£c3_ß…
(
buf„r
, 
rdf
);

1339 
LDNS_RDF_TYPE_TYPE
:

1340 
ªs
 = 
	`ldns_rdf2buf„r_°r_ty≥_fmt
(
buf„r
, 
fmt
, 
rdf
);

1342 
LDNS_RDF_TYPE_CLASS
:

1343 
ªs
 = 
	`ldns_rdf2buf„r_°r_˛ass
(
buf„r
, 
rdf
);

1345 
LDNS_RDF_TYPE_CERT_ALG
:

1346 
ªs
 = 
	`ldns_rdf2buf„r_°r_˚π_Æg
(
buf„r
, 
rdf
);

1348 
LDNS_RDF_TYPE_ALG
:

1349 
ªs
 = 
	`ldns_rdf2buf„r_°r_Æg
(
buf„r
, 
rdf
);

1351 
LDNS_RDF_TYPE_UNKNOWN
:

1352 
ªs
 = 
	`ldns_rdf2buf„r_°r_unknown
(
buf„r
, 
rdf
);

1354 
LDNS_RDF_TYPE_TIME
:

1355 
ªs
 = 
	`ldns_rdf2buf„r_°r_time
(
buf„r
, 
rdf
);

1357 
LDNS_RDF_TYPE_HIP
:

1358 
ªs
 = 
	`ldns_rdf2buf„r_°r_hù
(
buf„r
, 
rdf
);

1360 
LDNS_RDF_TYPE_LOC
:

1361 
ªs
 = 
	`ldns_rdf2buf„r_°r_loc
(
buf„r
, 
rdf
);

1363 
LDNS_RDF_TYPE_WKS
:

1364 
LDNS_RDF_TYPE_SERVICE
:

1365 
ªs
 = 
	`ldns_rdf2buf„r_°r_wks
(
buf„r
, 
rdf
);

1367 
LDNS_RDF_TYPE_NSAP
:

1368 
ªs
 = 
	`ldns_rdf2buf„r_°r_nßp
(
buf„r
, 
rdf
);

1370 
LDNS_RDF_TYPE_ATMA
:

1371 
ªs
 = 
	`ldns_rdf2buf„r_°r_©ma
(
buf„r
, 
rdf
);

1373 
LDNS_RDF_TYPE_IPSECKEY
:

1374 
ªs
 = 
	`ldns_rdf2buf„r_°r_ù£ckey
(
buf„r
, 
rdf
);

1376 
LDNS_RDF_TYPE_INT16_DATA
:

1377 
ªs
 = 
	`ldns_rdf2buf„r_°r_öt16_d©a
(
buf„r
, 
rdf
);

1379 
LDNS_RDF_TYPE_NSEC3_NEXT_OWNER
:

1380 
ªs
 = 
	`ldns_rdf2buf„r_°r_b32_ext
(
buf„r
, 
rdf
);

1382 
LDNS_RDF_TYPE_ILNP64
:

1383 
ªs
 = 
	`ldns_rdf2buf„r_°r_û≈64
(
buf„r
, 
rdf
);

1385 
LDNS_RDF_TYPE_EUI48
:

1386 
ªs
 = 
	`ldns_rdf2buf„r_°r_eui48
(
buf„r
, 
rdf
);

1388 
LDNS_RDF_TYPE_EUI64
:

1389 
ªs
 = 
	`ldns_rdf2buf„r_°r_eui64
(
buf„r
, 
rdf
);

1391 
LDNS_RDF_TYPE_TAG
:

1392 
ªs
 = 
	`ldns_rdf2buf„r_°r_èg
(
buf„r
, 
rdf
);

1394 
LDNS_RDF_TYPE_LONG_STR
:

1395 
ªs
 = 
	`ldns_rdf2buf„r_°r_l⁄g_°r
(
buf„r
, 
rdf
);

1400 
	`ldns_buf„r_¥ötf
(
buf„r
, "(null) ");

1401 
ªs
 = 
LDNS_STATUS_ERR
;

1403  
ªs
;

1404 
	}
}

1406 
ldns_°©us


1407 
	$ldns_rdf2buf„r_°r
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_rdf
 *
rdf
)

1409  
	`ldns_rdf2buf„r_°r_fmt
(
buf„r
,
ldns_ouçut_f‹m©_deÁu…
,
rdf
);

1410 
	}
}

1412 
ldns_rdf
 *

1413 
	$ldns_b32_ext2d«me
(c⁄° 
ldns_rdf
 *
rdf
)

1415 
size_t
 
size
;

1416 *
b32
;

1417 
ldns_rdf
 *
out
;

1418 if(
	`ldns_rdf_size
(
rdf
) == 0)

1419  
NULL
;

1421 
size
 = 
	`ldns_b32_¡›_ˇlcuœã_size
(
	`ldns_rdf_size
(
rdf
) - 1);

1423 
b32
 = 
	`LDNS_XMALLOC
(, 
size
 + 2);

1424 i‡(
b32
) {

1425 i‡(
	`ldns_b32_¡›_exãnded_hex
(
	`ldns_rdf_d©a
(
rdf
) + 1,

1426 
	`ldns_rdf_size
(
rdf
Ë- 1, 
b32
, 
size
+1) > 0) {

1427 
b32
[
size
] = '.';

1428 
b32
[
size
+1] = '\0';

1429 i‡(
	`ldns_°r2rdf_d«me
(&
out
, 
b32
Ë=
LDNS_STATUS_OK
) {

1430 
	`LDNS_FREE
(
b32
);

1431  
out
;

1434 
	`LDNS_FREE
(
b32
);

1436  
NULL
;

1437 
	}
}

1439 
ldns_°©us


1440 
	$ldns_º2buf„r_°r_rfc3597
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
º
)

1442 
size_t
 
tŸÆ_rdfsize
 = 0;

1443 
size_t
 
i
, 
j
;

1445 
	`ldns_buf„r_¥ötf
(
ouçut
, "TYPE%u\t", 
	`ldns_º_gë_ty≥
(
º
));

1446 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

1447 
tŸÆ_rdfsize
 +
	`ldns_rdf_size
(
	`ldns_º_rdf
(
º
, 
i
));

1449 i‡(
tŸÆ_rdfsize
 == 0) {

1450 
	`ldns_buf„r_¥ötf
(
ouçut
, "\\# 0\n");

1451  
	`ldns_buf„r_°©us
(
ouçut
);

1453 
	`ldns_buf„r_¥ötf
(
ouçut
, "\\# %d ", 
tŸÆ_rdfsize
);

1454 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

1455 
j
 = 0; j < 
	`ldns_rdf_size
(
	`ldns_º_rdf
(
º
, 
i
)); j++) {

1456 
	`ldns_buf„r_¥ötf
(
ouçut
, "%.2x",

1457 
	`ldns_rdf_d©a
(
	`ldns_º_rdf
(
º
, 
i
))[
j
]);

1460 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1461  
	`ldns_buf„r_°©us
(
ouçut
);

1462 
	}
}

1464 
ldns_°©us


1465 
	$ldns_º2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

1466 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
)

1468 
uöt16_t
 
i
, 
Êags
;

1469 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

1470 
ldns_ouçut_f‹m©_°‹age
* 
fmt_°
 = (ldns_ouçut_f‹m©_°‹age*)
fmt
;

1472 i‡(
fmt_°
 =
NULL
) {

1473 
fmt_°
 = (
ldns_ouçut_f‹m©_°‹age
*)

1474 
ldns_ouçut_f‹m©_deÁu…
;

1476 i‡(!
º
) {

1477 i‡(
LDNS_COMMENT_NULLS
 & 
fmt_°
->
Êags
) {

1478 
	`ldns_buf„r_¥ötf
(
ouçut
, "; (null)\n");

1480  
	`ldns_buf„r_°©us
(
ouçut
);

1482 i‡(
	`ldns_º_ow√r
(
º
)) {

1483 
°©us
 = 
	`ldns_rdf2buf„r_°r_d«me
(
ouçut
, 
	`ldns_º_ow√r
(
º
));

1485 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1486  
°©us
;

1490 i‡(!
	`ldns_º_is_que°i⁄
(
º
)) {

1491 
	`ldns_buf„r_¥ötf
(
ouçut
, "\t%d", 
	`ldns_º_âl
(
º
));

1494 
	`ldns_buf„r_¥ötf
(
ouçut
, "\t");

1495 
°©us
 = 
	`ldns_º_˛ass2buf„r_°r
(
ouçut
, 
	`ldns_º_gë_˛ass
(
º
));

1496 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1497  
°©us
;

1499 
	`ldns_buf„r_¥ötf
(
ouçut
, "\t");

1501 i‡(
	`ldns_ouçut_f‹m©_covîs_ty≥
(
fmt
, 
	`ldns_º_gë_ty≥
(
º
))) {

1502  
	`ldns_º2buf„r_°r_rfc3597
(
ouçut
, 
º
);

1504 
°©us
 = 
	`ldns_º_ty≥2buf„r_°r
(
ouçut
, 
	`ldns_º_gë_ty≥
(
º
));

1505 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1506  
°©us
;

1509 i‡(
	`ldns_º_rd_cou¡
(
º
) > 0) {

1510 
	`ldns_buf„r_¥ötf
(
ouçut
, "\t");

1511 } i‡(!
	`ldns_º_is_que°i⁄
(
º
)) {

1512 
	`ldns_buf„r_¥ötf
(
ouçut
, "\t\\# 0");

1515 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

1517 i‡((
fmt_°
->
Êags
 & 
LDNS_FMT_ZEROIZE_RRSIGS
) &&

1518 (
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_RRSIG
) &&

1519 (–
i
 == 4 &&

1520 
	`ldns_rdf_gë_ty≥
(
	`ldns_º_rdf
(
º
, 4)) ==

1521 
LDNS_RDF_TYPE_TIME
) ||

1522 –
i
 == 5 &&

1523 
	`ldns_rdf_gë_ty≥
(
	`ldns_º_rdf
(
º
, 5)) ==

1524 
LDNS_RDF_TYPE_TIME
) ||

1525 –
i
 == 8 &&

1526 
	`ldns_rdf_gë_ty≥
(
	`ldns_º_rdf
(
º
, 8)) ==

1527 
LDNS_RDF_TYPE_B64
))) {

1529 
	`ldns_buf„r_¥ötf
(
ouçut
, "(null)");

1530 
°©us
 = 
	`ldns_buf„r_°©us
(
ouçut
);

1531 } i‡((
fmt_°
->
Êags
 & 
LDNS_FMT_PAD_SOA_SERIAL
) &&

1532 (
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_SOA
) &&

1533  
i
 == 2 &&

1534 
	`ldns_rdf_gë_ty≥
(
	`ldns_º_rdf
(
º
, 2)) ==

1535 
LDNS_RDF_TYPE_INT32
) {

1536 
	`ldns_buf„r_¥ötf
(
ouçut
, "%10lu",

1537 (Ë
	`ldns_ªad_uöt32
(

1538 
	`ldns_rdf_d©a
(
	`ldns_º_rdf
(
º
, 2))));

1539 
°©us
 = 
	`ldns_buf„r_°©us
(
ouçut
);

1541 
°©us
 = 
	`ldns_rdf2buf„r_°r_fmt
(
ouçut
,

1542 
fmt
, 
	`ldns_º_rdf
(
º
, 
i
));

1544 if(
°©us
 !
LDNS_STATUS_OK
)

1545  
°©us
;

1546 i‡(
i
 < 
	`ldns_º_rd_cou¡
(
º
) - 1) {

1547 
	`ldns_buf„r_¥ötf
(
ouçut
, " ");

1553 i‡(
	`ldns_º_rd_cou¡
(
º
) > 0) {

1554 
	`ldns_º_gë_ty≥
(
º
)) {

1555 
LDNS_RR_TYPE_DNSKEY
:

1558 i‡(! (
fmt_°
->
Êags
 & 
LDNS_COMMENT_KEY
)) {

1561 
Êags
 = 
	`ldns_rdf2«tive_öt16
(
	`ldns_º_rdf
(
º
, 0));

1562 
	`ldns_buf„r_¥ötf
(
ouçut
, " ;{");

1563 i‡(
fmt_°
->
Êags
 & 
LDNS_COMMENT_KEY_ID
) {

1564 
	`ldns_buf„r_¥ötf
(
ouçut
, "id = %u",

1565 (Ë
	`ldns_ˇlc_keyèg
(
º
));

1567 i‡((
fmt_°
->
Êags
 & 
LDNS_COMMENT_KEY_TYPE
) &&

1568 (
Êags
 & 
LDNS_KEY_ZONE_KEY
)){

1570 i‡(
Êags
 & 
LDNS_KEY_SEP_KEY
) {

1571 
	`ldns_buf„r_¥ötf
(
ouçut
, " (ksk)");

1573 
	`ldns_buf„r_¥ötf
(
ouçut
, " (zsk)");

1575 i‡(
fmt_°
->
Êags
 & 
LDNS_COMMENT_KEY_SIZE
){

1576 
	`ldns_buf„r_¥ötf
(
ouçut
, ", ");

1578 } i‡(
fmt_°
->
Êags


1579 & (
LDNS_COMMENT_KEY_ID


1580 |
LDNS_COMMENT_KEY_SIZE
)) {

1581 
	`ldns_buf„r_¥ötf
–
ouçut
, ", ");

1583 i‡(
fmt_°
->
Êags
 & 
LDNS_COMMENT_KEY_SIZE
) {

1584 
	`ldns_buf„r_¥ötf
(
ouçut
, "size = %db",

1585 
	`ldns_º_dnskey_key_size
(
º
));

1587 
	`ldns_buf„r_¥ötf
(
ouçut
, "}");

1589 
LDNS_RR_TYPE_RRSIG
:

1590 i‡((
fmt_°
->
Êags
 & 
LDNS_COMMENT_KEY
)

1591 && (
fmt_°
->
Êags
& 
LDNS_COMMENT_RRSIGS
)

1592 && 
	`ldns_º_rdf
(
º
, 6Ë!
NULL
) {

1593 
	`ldns_buf„r_¥ötf
(
ouçut
, " ;{id = %d}",

1594 
	`ldns_rdf2«tive_öt16
(

1595 
	`ldns_º_rdf
(
º
, 6)));

1598 
LDNS_RR_TYPE_DS
:

1599 i‡((
fmt_°
->
Êags
 & 
LDNS_COMMENT_BUBBLEBABBLE
) &&

1600 
	`ldns_º_rdf
(
º
, 3Ë!
NULL
) {

1602 
uöt8_t
 *
d©a
 = 
	`ldns_rdf_d©a
(

1603 
	`ldns_º_rdf
(
º
, 3));

1604 
size_t
 
Àn
 = 
	`ldns_rdf_size
(
	`ldns_º_rdf
(
º
, 3));

1605 *
babbÀ
 = 
	`ldns_bubbÀbabbÀ
(
d©a
, 
Àn
);

1606 if(
babbÀ
) {

1607 
	`ldns_buf„r_¥ötf
(
ouçut
,

1608 " ;{%s}", 
babbÀ
);

1610 
	`LDNS_FREE
(
babbÀ
);

1613 
LDNS_RR_TYPE_NSEC3
:

1614 i‡(! (
fmt_°
->
Êags
 & 
LDNS_COMMENT_FLAGS
) &&

1615 ! (
fmt_°
->
Êags
 & 
LDNS_COMMENT_NSEC3_CHAIN
)) {

1618 
	`ldns_buf„r_¥ötf
(
ouçut
, " ;{");

1619 i‡((
fmt_°
->
Êags
 & 
LDNS_COMMENT_FLAGS
)) {

1620 i‡(
	`ldns_n£c3_›tout
(
º
)) {

1621 
	`ldns_buf„r_¥ötf
(
ouçut
,

1624 
	`ldns_buf„r_¥ötf
(
ouçut
," flags: -");

1626 i‡(
fmt_°
->
Êags
 & 
LDNS_COMMENT_NSEC3_CHAIN
 &&

1627 
fmt_°
->
hashm≠
 !
NULL
) {

1628 
	`ldns_buf„r_¥ötf
(
ouçut
, ", ");

1631 i‡(
fmt_°
->
Êags
 & 
LDNS_COMMENT_NSEC3_CHAIN
 &&

1632 
fmt_°
->
hashm≠
 !
NULL
) {

1633 
ldns_rbnode_t
 *
node
;

1634 
ldns_rdf
 *
key
 = 
	`ldns_d«me_œbñ
(

1635 
	`ldns_º_ow√r
(
º
), 0);

1636 i‡(
key
) {

1637 
node
 = 
	`ldns_rbåì_£¨ch
(

1638 
fmt_°
->
hashm≠
,

1639 (*Ë
key
);

1640 i‡(
node
->
d©a
) {

1641 
	`ldns_buf„r_¥ötf
(
ouçut
,

1643 (Ë
	`ldns_rdf2buf„r_°r
(

1644 
ouçut
,

1645 
	`ldns_dns£c_«me_«me
(

1646 (
ldns_dns£c_«me
*)

1647 
node
->
d©a


1650 
	`ldns_rdf_‰ì
(
key
);

1652 
key
 = 
	`ldns_b32_ext2d«me
(

1653 
	`ldns_n£c3_√xt_ow√r
(
º
));

1654 i‡(
key
) {

1655 
node
 = 
	`ldns_rbåì_£¨ch
(

1656 
fmt_°
->
hashm≠
,

1657 (*Ë
key
);

1658 i‡(
node
->
d©a
) {

1659 
	`ldns_buf„r_¥ötf
(
ouçut
,

1661 (Ë
	`ldns_rdf2buf„r_°r
(

1662 
ouçut
,

1663 
	`ldns_dns£c_«me_«me
(

1664 (
ldns_dns£c_«me
*)

1665 
node
->
d©a


1668 
	`ldns_rdf_‰ì
(
key
);

1671 
	`ldns_buf„r_¥ötf
(
ouçut
, "}");

1679 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1680  
	`ldns_buf„r_°©us
(
ouçut
);

1681 
	}
}

1683 
ldns_°©us


1684 
	$ldns_º2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
º
)

1686  
	`ldns_º2buf„r_°r_fmt
(
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
º
);

1687 
	}
}

1689 
ldns_°©us


1690 
	$ldns_º_li°2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

1691 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
li°
)

1693 
uöt16_t
 
i
;

1695 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
li°
); i++) {

1696 (Ë
	`ldns_º2buf„r_°r_fmt
(
ouçut
, 
fmt
,

1697 
	`ldns_º_li°_º
(
li°
, 
i
));

1699  
	`ldns_buf„r_°©us
(
ouçut
);

1700 
	}
}

1702 
ldns_°©us


1703 
	$ldns_º_li°2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º_li°
 *
li°
)

1705  
	`ldns_º_li°2buf„r_°r_fmt
(

1706 
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
li°
);

1707 
	}
}

1709 
ldns_°©us


1710 
	$ldns_pkthódî2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
)

1712 
ldns_lookup_èbÀ
 *
›code
 = 
	`ldns_lookup_by_id
(
ldns_›codes
,

1713 (Ë
	`ldns_pkt_gë_›code
(
pkt
));

1714 
ldns_lookup_èbÀ
 *
rcode
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
,

1715 (Ë
	`ldns_pkt_gë_rcode
(
pkt
));

1717 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; ->>HEADER<<- ");

1718 i‡(
›code
) {

1719 
	`ldns_buf„r_¥ötf
(
ouçut
, "›code: %s, ", 
›code
->
«me
);

1721 
	`ldns_buf„r_¥ötf
(
ouçut
, "opcode: ?? (%u), ",

1722 
	`ldns_pkt_gë_›code
(
pkt
));

1724 i‡(
rcode
) {

1725 
	`ldns_buf„r_¥ötf
(
ouçut
, "rcode: %s, ", 
rcode
->
«me
);

1727 
	`ldns_buf„r_¥ötf
(
ouçut
, "rcode: ?? (%u), ", 
	`ldns_pkt_gë_rcode
(
pkt
));

1729 
	`ldns_buf„r_¥ötf
(
ouçut
, "id: %d\n", 
	`ldns_pkt_id
(
pkt
));

1730 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; flags: ");

1732 i‡(
	`ldns_pkt_qr
(
pkt
)) {

1733 
	`ldns_buf„r_¥ötf
(
ouçut
, "qr ");

1735 i‡(
	`ldns_pkt_Ø
(
pkt
)) {

1736 
	`ldns_buf„r_¥ötf
(
ouçut
, "aa ");

1738 i‡(
	`ldns_pkt_tc
(
pkt
)) {

1739 
	`ldns_buf„r_¥ötf
(
ouçut
, "tc ");

1741 i‡(
	`ldns_pkt_rd
(
pkt
)) {

1742 
	`ldns_buf„r_¥ötf
(
ouçut
, "rd ");

1744 i‡(
	`ldns_pkt_cd
(
pkt
)) {

1745 
	`ldns_buf„r_¥ötf
(
ouçut
, "cd ");

1747 i‡(
	`ldns_pkt_ø
(
pkt
)) {

1748 
	`ldns_buf„r_¥ötf
(
ouçut
, "ra ");

1750 i‡(
	`ldns_pkt_ad
(
pkt
)) {

1751 
	`ldns_buf„r_¥ötf
(
ouçut
, "ad ");

1753 
	`ldns_buf„r_¥ötf
(
ouçut
, "; ");

1754 
	`ldns_buf„r_¥ötf
(
ouçut
, "QUERY: %u, ", 
	`ldns_pkt_qdcou¡
(
pkt
));

1755 
	`ldns_buf„r_¥ötf
(
ouçut
, "ANSWER: %u, ", 
	`ldns_pkt_™cou¡
(
pkt
));

1756 
	`ldns_buf„r_¥ötf
(
ouçut
, "AUTHORITY: %u, ", 
	`ldns_pkt_nscou¡
(
pkt
));

1757 
	`ldns_buf„r_¥ötf
(
ouçut
, "ADDITIONAL: %u ", 
	`ldns_pkt_¨cou¡
(
pkt
));

1758  
	`ldns_buf„r_°©us
(
ouçut
);

1759 
	}
}

1761 
ldns_°©us


1762 
	$ldns_pkt2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

1763 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
)

1765 
uöt16_t
 
i
;

1766 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

1767 *
tmp
;

1768 
timevÆ
 
time
;

1769 
time_t
 
time_â
;

1771 i‡(!
pkt
) {

1772 
	`ldns_buf„r_¥ötf
(
ouçut
, "null");

1773  
LDNS_STATUS_OK
;

1776 i‡(
	`ldns_buf„r_°©us_ok
(
ouçut
)) {

1777 
°©us
 = 
	`ldns_pkthódî2buf„r_°r
(
ouçut
, 
pkt
);

1778 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1779  
°©us
;

1782 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1784 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; QUESTION SECTION:\n;; ");

1787 
i
 = 0; i < 
	`ldns_pkt_qdcou¡
(
pkt
); i++) {

1788 
°©us
 = 
	`ldns_º2buf„r_°r_fmt
(
ouçut
, 
fmt
,

1789 
	`ldns_º_li°_º
(

1790 
	`ldns_pkt_que°i⁄
(
pkt
), 
i
));

1791 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1792  
°©us
;

1795 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1797 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; ANSWER SECTION:\n");

1798 
i
 = 0; i < 
	`ldns_pkt_™cou¡
(
pkt
); i++) {

1799 
°©us
 = 
	`ldns_º2buf„r_°r_fmt
(
ouçut
, 
fmt
,

1800 
	`ldns_º_li°_º
(

1801 
	`ldns_pkt_™swî
(
pkt
), 
i
));

1802 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1803  
°©us
;

1807 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1809 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; AUTHORITY SECTION:\n");

1811 
i
 = 0; i < 
	`ldns_pkt_nscou¡
(
pkt
); i++) {

1812 
°©us
 = 
	`ldns_º2buf„r_°r_fmt
(
ouçut
, 
fmt
,

1813 
	`ldns_º_li°_º
(

1814 
	`ldns_pkt_auth‹ôy
(
pkt
), 
i
));

1815 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1816  
°©us
;

1819 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1821 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; ADDITIONAL SECTION:\n");

1822 
i
 = 0; i < 
	`ldns_pkt_¨cou¡
(
pkt
); i++) {

1823 
°©us
 = 
	`ldns_º2buf„r_°r_fmt
(
ouçut
, 
fmt
,

1824 
	`ldns_º_li°_º
(

1825 
	`ldns_pkt_addôi⁄Æ
(
pkt
), 
i
));

1826 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1827  
°©us
;

1831 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1833 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; QueryÅime: %d msec\n",

1834 
	`ldns_pkt_quîytime
(
pkt
));

1835 i‡(
	`ldns_pkt_edns
(
pkt
)) {

1836 
	`ldns_buf„r_¥ötf
(
ouçut
,

1838 
	`ldns_pkt_edns_vîsi⁄
(
pkt
));

1839 i‡(
	`ldns_pkt_edns_do
(
pkt
)) {

1840 
	`ldns_buf„r_¥ötf
(
ouçut
, " do");

1844 i‡(
	`ldns_pkt_edns_exãnded_rcode
(
pkt
)) {

1845 
	`ldns_buf„r_¥ötf
(
ouçut
, " ;Éxt-rcode: %d",

1846 (
	`ldns_pkt_edns_exãnded_rcode
(
pkt
Ë<< 4 | 
	`ldns_pkt_gë_rcode
(pkt)));

1848 
	`ldns_buf„r_¥ötf
(
ouçut
, " ; udp: %u\n",

1849 
	`ldns_pkt_edns_udp_size
(
pkt
));

1851 i‡(
	`ldns_pkt_edns_d©a
(
pkt
)) {

1852 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; Data: ");

1853 ()
	`ldns_rdf2buf„r_°r
(
ouçut
,

1854 
	`ldns_pkt_edns_d©a
(
pkt
));

1855 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1858 i‡(
	`ldns_pkt_tsig
(
pkt
)) {

1859 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; TSIG:\n;; ");

1860 (Ë
	`ldns_º2buf„r_°r_fmt
(

1861 
ouçut
, 
fmt
, 
	`ldns_pkt_tsig
(
pkt
));

1862 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1864 i‡(
	`ldns_pkt_™swî‰om
(
pkt
)) {

1865 
tmp
 = 
	`ldns_rdf2°r
(
	`ldns_pkt_™swî‰om
(
pkt
));

1866 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; SERVER: %s\n", 
tmp
);

1867 
	`LDNS_FREE
(
tmp
);

1869 
time
 = 
	`ldns_pkt_time°amp
(
pkt
);

1870 
time_â
 = (
time_t
)
time
.
tv_£c
;

1871 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; WHEN: %s",

1872 (*)
	`˘ime
(&
time_â
));

1874 
	`ldns_buf„r_¥ötf
(
ouçut
, ";; MSG SIZEÑcvd: %d\n",

1875 ()
	`ldns_pkt_size
(
pkt
));

1877  
	`ldns_buf„r_°©us
(
ouçut
);

1879  
°©us
;

1880 
	}
}

1882 
ldns_°©us


1883 
	$ldns_pkt2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
)

1885  
	`ldns_pkt2buf„r_°r_fmt
(
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
pkt
);

1886 
	}
}

1889 #ifde‡
HAVE_SSL


1890 
ldns_°©us


1891 
	$ldns_hmac_key2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_key
 *
k
)

1893 
ldns_°©us
 
°©us
;

1894 
size_t
 
i
;

1895 
ldns_rdf
 *
b64_bignum
;

1897 
	`ldns_buf„r_¥ötf
(
ouçut
, "Key: ");

1899 
i
 = 
	`ldns_key_hmac_size
(
k
);

1900 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
	`ldns_key_hmac_key
(
k
));

1901 
°©us
 = 
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
);

1902 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

1903 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1904  
°©us
;

1905 
	}
}

1908 #i‡
deföed
(
HAVE_SSL
Ë&& deföed(
USE_GOST
)

1909 
ldns_°©us


1910 
	$ldns_go°_key2buf„r_°r
(
ldns_buf„r
 *
ouçut
, 
EVP_PKEY
 *
p
)

1912 * 
µ
 = 
NULL
;

1913 
ªt
;

1914 
ldns_rdf
 *
b64_bignum
;

1915 
ldns_°©us
 
°©us
;

1917 
	`ldns_buf„r_¥ötf
(
ouçut
, "GostAsn1: ");

1919 
ªt
 = 
	`i2d_Priv©eKey
(
p
, &
µ
);

1920 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, (
size_t
)
ªt
, 
µ
);

1921 
°©us
 = 
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
);

1923 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

1924 
	`OPENSSL_‰ì
(
µ
);

1925 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

1926  
°©us
;

1927 
	}
}

1930 
ldns_°©us


1931 
	$ldns_key2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_key
 *
k
)

1933 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

1934 *
bignum
;

1935 #ifde‡
HAVE_SSL


1936 #i‚de‡
S_SPLINT_S


1937 
uöt16_t
 
i
;

1941 
ldns_rdf
 *
b64_bignum
 = 
NULL
;

1943 
RSA
 *
rß
;

1944 
DSA
 *
dß
;

1947 i‡(!
k
) {

1948  
LDNS_STATUS_ERR
;

1951 
bignum
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_KEYLEN
);

1952 i‡(!
bignum
) {

1953  
LDNS_STATUS_ERR
;

1956 i‡(
	`ldns_buf„r_°©us_ok
(
ouçut
)) {

1957 #ifde‡
HAVE_SSL


1958 
	`ldns_key_Æg‹ôhm
(
k
)) {

1959 
LDNS_SIGN_RSASHA1
:

1960 
LDNS_SIGN_RSASHA1_NSEC3
:

1961 
LDNS_SIGN_RSASHA256
:

1962 
LDNS_SIGN_RSASHA512
:

1963 
LDNS_SIGN_RSAMD5
:

1966 
rß
 = 
	`ldns_key_rß_key
(
k
);

1968 
	`ldns_buf„r_¥ötf
(
ouçut
,"Private-key-format: v1.2\n");

1969 
	`ldns_key_Æg‹ôhm
(
k
)) {

1970 
LDNS_SIGN_RSAMD5
:

1971 
	`ldns_buf„r_¥ötf
(
ouçut
,

1973 
LDNS_RSAMD5
);

1975 
LDNS_SIGN_RSASHA1
:

1976 
	`ldns_buf„r_¥ötf
(
ouçut
,

1978 
LDNS_RSASHA1
);

1980 
LDNS_SIGN_RSASHA1_NSEC3
:

1981 
	`ldns_buf„r_¥ötf
(
ouçut
,

1983 
LDNS_RSASHA1_NSEC3
);

1985 #ifde‡
USE_SHA2


1986 
LDNS_SIGN_RSASHA256
:

1987 
	`ldns_buf„r_¥ötf
(
ouçut
,

1989 
LDNS_RSASHA256
);

1991 
LDNS_SIGN_RSASHA512
:

1992 
	`ldns_buf„r_¥ötf
(
ouçut
,

1994 
LDNS_RSASHA512
);

1998 #ifde‡
STDERR_MSGS


1999 
	`Ârötf
(
°dîr
, "Warning: unknown signature ");

2000 
	`Ârötf
(
°dîr
,

2002 
	`ldns_key_Æg‹ôhm
(
k
));

2004 
	`ldns_buf„r_¥ötf
(
ouçut
,

2006 
	`ldns_key_Æg‹ôhm
(
k
));

2012 
	`ldns_buf„r_¥ötf
(
ouçut
, "Modulus: ");

2013 #i‚de‡
S_SPLINT_S


2014 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
n
, 
bignum
);

2015 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2016 
îr‹
;

2018 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2019 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2020 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2021 
îr‹
;

2023 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2024 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2025 
	`ldns_buf„r_¥ötf
(
ouçut
, "PublicExponent: ");

2026 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
e
, 
bignum
);

2027 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2028 
îr‹
;

2030 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2031 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2032 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2033 
îr‹
;

2035 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2036 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2038 
	`ldns_buf„r_¥ötf
(
ouçut
, "PrivateExponent: ");

2039 i‡(
rß
->
d
) {

2040 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
d
, 
bignum
);

2041 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2042 
îr‹
;

2044 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2045 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2046 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2047 
îr‹
;

2049 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2050 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2052 
	`ldns_buf„r_¥ötf
(
ouçut
, "(Notávailable)\n");

2055 
	`ldns_buf„r_¥ötf
(
ouçut
, "Prime1: ");

2056 i‡(
rß
->
p
) {

2057 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
p
, 
bignum
);

2058 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2059 
îr‹
;

2061 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2062 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2063 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2064 
îr‹
;

2066 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2067 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2069 
	`ldns_buf„r_¥ötf
(
ouçut
, "(Notávailable)\n");

2072 
	`ldns_buf„r_¥ötf
(
ouçut
, "Prime2: ");

2073 i‡(
rß
->
q
) {

2074 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
q
, 
bignum
);

2075 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2076 
îr‹
;

2078 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2079 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2080 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2081 
îr‹
;

2083 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2084 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2086 
	`ldns_buf„r_¥ötf
(
ouçut
, "(Notávailable)\n");

2089 
	`ldns_buf„r_¥ötf
(
ouçut
, "Exponent1: ");

2090 i‡(
rß
->
dmp1
) {

2091 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
dmp1
, 
bignum
);

2092 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2093 
îr‹
;

2095 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2096 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2097 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2098 
îr‹
;

2100 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2101 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2103 
	`ldns_buf„r_¥ötf
(
ouçut
, "(Notávailable)\n");

2106 
	`ldns_buf„r_¥ötf
(
ouçut
, "Exponent2: ");

2107 i‡(
rß
->
dmq1
) {

2108 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
dmq1
, 
bignum
);

2109 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2110 
îr‹
;

2112 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2113 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2114 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2115 
îr‹
;

2117 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2118 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2120 
	`ldns_buf„r_¥ötf
(
ouçut
, "(Notávailable)\n");

2123 
	`ldns_buf„r_¥ötf
(
ouçut
, "Coefficient: ");

2124 i‡(
rß
->
iqmp
) {

2125 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
rß
->
iqmp
, 
bignum
);

2126 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2127 
îr‹
;

2129 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2130 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2131 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2132 
îr‹
;

2134 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2135 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2137 
	`ldns_buf„r_¥ötf
(
ouçut
, "(Notávailable)\n");

2141 
	`RSA_‰ì
(
rß
);

2143 
LDNS_SIGN_DSA
:

2144 
LDNS_SIGN_DSA_NSEC3
:

2145 
dß
 = 
	`ldns_key_dß_key
(
k
);

2147 
	`ldns_buf„r_¥ötf
(
ouçut
,"Private-key-format: v1.2\n");

2148 i‡(
	`ldns_key_Æg‹ôhm
(
k
Ë=
LDNS_SIGN_DSA
) {

2149 
	`ldns_buf„r_¥ötf
(
ouçut
,"Algorithm: 3 (DSA)\n");

2150 } i‡(
	`ldns_key_Æg‹ôhm
(
k
Ë=
LDNS_SIGN_DSA_NSEC3
) {

2151 
	`ldns_buf„r_¥ötf
(
ouçut
,"Algorithm: 6 (DSA_NSEC3)\n");

2156 
	`ldns_buf„r_¥ötf
(
ouçut
, "Prime(p): ");

2157 #i‚de‡
S_SPLINT_S


2158 i‡(
dß
->
p
) {

2159 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
dß
->
p
, 
bignum
);

2160 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2161 
îr‹
;

2163 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2164 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2165 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2166 
îr‹
;

2168 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2169 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2171 
	`¥ötf
("(Notávailable)\n");

2174 
	`ldns_buf„r_¥ötf
(
ouçut
, "Subprime(q): ");

2175 i‡(
dß
->
q
) {

2176 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
dß
->
q
, 
bignum
);

2177 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2178 
îr‹
;

2180 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2181 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2182 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2183 
îr‹
;

2185 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2186 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2188 
	`¥ötf
("(Notávailable)\n");

2191 
	`ldns_buf„r_¥ötf
(
ouçut
, "Base(g): ");

2192 i‡(
dß
->
g
) {

2193 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
dß
->
g
, 
bignum
);

2194 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2195 
îr‹
;

2197 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2198 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2199 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2200 
îr‹
;

2202 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2203 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2205 
	`¥ötf
("(Notávailable)\n");

2208 
	`ldns_buf„r_¥ötf
(
ouçut
, "Private_value(x): ");

2209 i‡(
dß
->
¥iv_key
) {

2210 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
dß
->
¥iv_key
, 
bignum
);

2211 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2212 
îr‹
;

2214 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2215 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2216 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2217 
îr‹
;

2219 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2220 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2222 
	`¥ötf
("(Notávailable)\n");

2225 
	`ldns_buf„r_¥ötf
(
ouçut
, "Public_value(y): ");

2226 i‡(
dß
->
pub_key
) {

2227 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
dß
->
pub_key
, 
bignum
);

2228 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2229 
îr‹
;

2231 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2232 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2233 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2234 
îr‹
;

2236 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2237 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2239 
	`¥ötf
("(Notávailable)\n");

2243 
LDNS_SIGN_ECC_GOST
:

2245 #i‡
	`deföed
(
HAVE_SSL
Ë&& deföed(
USE_GOST
)

2246 
	`ldns_buf„r_¥ötf
(
ouçut
, "Private-key-format: v1.2\n");

2247 
	`ldns_buf„r_¥ötf
(
ouçut
, "Alg‹ôhm: %d (ECC-GOST)\n", 
LDNS_SIGN_ECC_GOST
);

2248 
°©us
 = 
	`ldns_go°_key2buf„r_°r
(
ouçut
,

2249 #i‚de‡
S_SPLINT_S


2250 
k
->
_key
.
key


2252 
NULL


2256 
îr‹
;

2259 
LDNS_SIGN_ECDSAP256SHA256
:

2260 
LDNS_SIGN_ECDSAP384SHA384
:

2261 #ifde‡
USE_ECDSA


2262 
	`ldns_buf„r_¥ötf
(
ouçut
, "Private-key-format: v1.2\n");

2263 
	`ldns_buf„r_¥ötf
(
ouçut
, "Alg‹ôhm: %d (", 
	`ldns_key_Æg‹ôhm
(
k
));

2264 
°©us
=
	`ldns_Æg‹ôhm2buf„r_°r
(
ouçut
, (
ldns_Æg‹ôhm
)
	`ldns_key_Æg‹ôhm
(
k
));

2265 #i‚de‡
S_SPLINT_S


2266 
	`ldns_buf„r_¥ötf
(
ouçut
, ")\n");

2267 if(
k
->
_key
.
key
) {

2268 
EC_KEY
* 
ec
 = 
	`EVP_PKEY_gë1_EC_KEY
(
k
->
_key
.
key
);

2269 c⁄° 
BIGNUM
* 
b
 = 
	`EC_KEY_gë0_¥iv©e_key
(
ec
);

2270 
	`ldns_buf„r_¥ötf
(
ouçut
, "PrivateKey: ");

2271 
i
 = (
uöt16_t
)
	`BN_bn2bö
(
b
, 
bignum
);

2272 i‡(
i
 > 
LDNS_MAX_KEYLEN
) {

2273 
îr‹
;

2275 
b64_bignum
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
i
, 
bignum
);

2276 i‡(
	`ldns_rdf2buf„r_°r
(
ouçut
, 
b64_bignum
Ë!
LDNS_STATUS_OK
) {

2277 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2278 
îr‹
;

2280 
	`ldns_rdf_dìp_‰ì
(
b64_bignum
);

2281 
	`ldns_buf„r_¥ötf
(
ouçut
, "\n");

2284 
	`EC_KEY_‰ì
(
ec
);

2288 
îr‹
;

2291 
LDNS_SIGN_HMACMD5
:

2294 
	`ldns_buf„r_¥ötf
(
ouçut
, "Private-key-format: v1.2\n");

2295 
	`ldns_buf„r_¥ötf
(
ouçut
, "Algorithm: 157 (HMAC_MD5)\n");

2296 
°©us
 = 
	`ldns_hmac_key2buf„r_°r
(
ouçut
, 
k
);

2298 
LDNS_SIGN_HMACSHA1
:

2299 
	`ldns_buf„r_¥ötf
(
ouçut
, "Private-key-format: v1.2\n");

2300 
	`ldns_buf„r_¥ötf
(
ouçut
, "Algorithm: 158 (HMAC_SHA1)\n");

2301 
°©us
 = 
	`ldns_hmac_key2buf„r_°r
(
ouçut
, 
k
);

2303 
LDNS_SIGN_HMACSHA256
:

2304 
	`ldns_buf„r_¥ötf
(
ouçut
, "Private-key-format: v1.2\n");

2305 
	`ldns_buf„r_¥ötf
(
ouçut
, "Algorithm: 159 (HMAC_SHA256)\n");

2306 
°©us
 = 
	`ldns_hmac_key2buf„r_°r
(
ouçut
, 
k
);

2311 
	`LDNS_FREE
(
bignum
);

2312  
	`ldns_buf„r_°©us
(
ouçut
);

2314 
	`LDNS_FREE
(
bignum
);

2315  
°©us
;

2317 #ifde‡
HAVE_SSL


2319 
îr‹
:

2320 
	`LDNS_FREE
(
bignum
);

2321  
LDNS_STATUS_ERR
;

2324 
	}
}

2330 
	$ldns_buf„r2°r
(
ldns_buf„r
 *
buf„r
)

2332 *
°r
;

2336 i‡(*(
	`ldns_buf„r_©
(
buf„r
, 
	`ldns_buf„r_posôi⁄
(buffer))) != 0) {

2337 i‡(!
	`ldns_buf„r_ª£rve
(
buf„r
, 1)) {

2338  
NULL
;

2340 
	`ldns_buf„r_wrôe_u8
(
buf„r
, (
uöt8_t
) '\0');

2341 i‡(!
	`ldns_buf„r_£t_ˇ∑côy
(
buf„r
, 
	`ldns_buf„r_posôi⁄
(buffer))) {

2342  
NULL
;

2346 
°r
 = 
	`°rdup
((c⁄° *)
	`ldns_buf„r_begö
(
buf„r
));

2347 if(!
°r
) {

2348  
NULL
;

2350  
°r
;

2351 
	}
}

2357 
	$ldns_buf„r_exp‹t2°r
(
ldns_buf„r
 *
buf„r
)

2360 i‡(! 
	`ldns_buf„r_ª£rve
(
buf„r
, 1)) {

2361  
NULL
;

2363 
	`ldns_buf„r_wrôe_u8
(
buf„r
, 0);

2366 
	`ldns_buf„r_£t_ˇ∑côy
(
buf„r
, 
	`ldns_buf„r_posôi⁄
(buffer));

2367  
	`ldns_buf„r_exp‹t
(
buf„r
);

2368 
	}
}

2371 
	$ldns_rdf2°r
(c⁄° 
ldns_rdf
 *
rdf
)

2373 *
ªsu…
 = 
NULL
;

2374 
ldns_buf„r
 *
tmp_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2376 i‡(!
tmp_buf„r
) {

2377  
NULL
;

2379 i‡(
	`ldns_rdf2buf„r_°r
(
tmp_buf„r
, 
rdf
Ë=
LDNS_STATUS_OK
) {

2381 
ªsu…
 = 
	`ldns_buf„r_exp‹t2°r
(
tmp_buf„r
);

2383 
	`ldns_buf„r_‰ì
(
tmp_buf„r
);

2384  
ªsu…
;

2385 
	}
}

2388 
	$ldns_º2°r_fmt
(c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
)

2390 *
ªsu…
 = 
NULL
;

2391 
ldns_buf„r
 *
tmp_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2393 i‡(!
tmp_buf„r
) {

2394  
NULL
;

2396 i‡(
	`ldns_º2buf„r_°r_fmt
(
tmp_buf„r
, 
fmt
, 
º
)

2397 =
LDNS_STATUS_OK
) {

2399 
ªsu…
 = 
	`ldns_buf„r_exp‹t2°r
(
tmp_buf„r
);

2401 
	`ldns_buf„r_‰ì
(
tmp_buf„r
);

2402  
ªsu…
;

2403 
	}
}

2406 
	$ldns_º2°r
(c⁄° 
ldns_º
 *
º
)

2408  
	`ldns_º2°r_fmt
(
ldns_ouçut_f‹m©_deÁu…
, 
º
);

2409 
	}
}

2412 
	$ldns_pkt2°r_fmt
(c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
)

2414 *
ªsu…
 = 
NULL
;

2415 
ldns_buf„r
 *
tmp_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2417 i‡(!
tmp_buf„r
) {

2418  
NULL
;

2420 i‡(
	`ldns_pkt2buf„r_°r_fmt
(
tmp_buf„r
, 
fmt
, 
pkt
)

2421 =
LDNS_STATUS_OK
) {

2423 
ªsu…
 = 
	`ldns_buf„r_exp‹t2°r
(
tmp_buf„r
);

2426 
	`ldns_buf„r_‰ì
(
tmp_buf„r
);

2427  
ªsu…
;

2428 
	}
}

2431 
	$ldns_pkt2°r
(c⁄° 
ldns_pkt
 *
pkt
)

2433  
	`ldns_pkt2°r_fmt
(
ldns_ouçut_f‹m©_deÁu…
, 
pkt
);

2434 
	}
}

2437 
	$ldns_key2°r
(c⁄° 
ldns_key
 *
k
)

2439 *
ªsu…
 = 
NULL
;

2440 
ldns_buf„r
 *
tmp_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2442 i‡(!
tmp_buf„r
) {

2443  
NULL
;

2445 i‡(
	`ldns_key2buf„r_°r
(
tmp_buf„r
, 
k
Ë=
LDNS_STATUS_OK
) {

2447 
ªsu…
 = 
	`ldns_buf„r_exp‹t2°r
(
tmp_buf„r
);

2449 
	`ldns_buf„r_‰ì
(
tmp_buf„r
);

2450  
ªsu…
;

2451 
	}
}

2454 
	$ldns_º_li°2°r_fmt
(c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
li°
)

2456 *
ªsu…
 = 
NULL
;

2457 
ldns_buf„r
 *
tmp_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

2459 i‡(!
tmp_buf„r
) {

2460  
NULL
;

2462 i‡(
li°
) {

2463 i‡(
	`ldns_º_li°2buf„r_°r_fmt
(

2464 
tmp_buf„r
, 
fmt
, 
li°
)

2465 =
LDNS_STATUS_OK
) {

2468 i‡(
fmt
 =
NULL
) {

2469 
fmt
 = 
ldns_ouçut_f‹m©_deÁu…
;

2471 i‡(
fmt
->
Êags
 & 
LDNS_COMMENT_NULLS
) {

2472 
	`ldns_buf„r_¥ötf
(
tmp_buf„r
, "; (null)\n");

2477 
ªsu…
 = 
	`ldns_buf„r_exp‹t2°r
(
tmp_buf„r
);

2478 
	`ldns_buf„r_‰ì
(
tmp_buf„r
);

2479  
ªsu…
;

2480 
	}
}

2483 
	$ldns_º_li°2°r
(c⁄° 
ldns_º_li°
 *
li°
)

2485  
	`ldns_º_li°2°r_fmt
(
ldns_ouçut_f‹m©_deÁu…
, 
li°
);

2486 
	}
}

2489 
	$ldns_rdf_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
)

2491 *
°r
 = 
	`ldns_rdf2°r
(
rdf
);

2492 i‡(
°r
) {

2493 
	`Ârötf
(
ouçut
, "%s", 
°r
);

2495 
	`Ârötf
(
ouçut
, ";UnableÅo convertÑdfÅo string\n");

2497 
	`LDNS_FREE
(
°r
);

2498 
	}
}

2501 
	$ldns_º_¥öt_fmt
(
FILE
 *
ouçut
,

2502 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
)

2504 *
°r
 = 
	`ldns_º2°r_fmt
(
fmt
, 
º
);

2505 i‡(
°r
) {

2506 
	`Ârötf
(
ouçut
, "%s", 
°r
);

2508 
	`Ârötf
(
ouçut
, ";UnableÅo convertÑrÅo string\n");

2510 
	`LDNS_FREE
(
°r
);

2511 
	}
}

2514 
	$ldns_º_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_º
 *
º
)

2516 
	`ldns_º_¥öt_fmt
(
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
º
);

2517 
	}
}

2520 
	$ldns_pkt_¥öt_fmt
(
FILE
 *
ouçut
,

2521 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
)

2523 *
°r
 = 
	`ldns_pkt2°r_fmt
(
fmt
, 
pkt
);

2524 i‡(
°r
) {

2525 
	`Ârötf
(
ouçut
, "%s", 
°r
);

2527 
	`Ârötf
(
ouçut
, ";UnableÅo convertÖacketÅo string\n");

2529 
	`LDNS_FREE
(
°r
);

2530 
	}
}

2533 
	$ldns_pkt_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
)

2535 
	`ldns_pkt_¥öt_fmt
(
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
pkt
);

2536 
	}
}

2539 
	$ldns_º_li°_¥öt_fmt
(
FILE
 *
ouçut
,

2540 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
l°
)

2542 
size_t
 
i
;

2543 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
l°
); i++) {

2544 
	`ldns_º_¥öt_fmt
(
ouçut
, 
fmt
, 
	`ldns_º_li°_º
(
l°
, 
i
));

2546 
	}
}

2549 
	$ldns_º_li°_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_º_li°
 *
l°
)

2551 
	`ldns_º_li°_¥öt_fmt
(
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
l°
);

2552 
	}
}

2555 
	$ldns_ªsﬁvî_¥öt_fmt
(
FILE
 *
ouçut
,

2556 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_ªsﬁvî
 *
r
)

2558 
uöt16_t
 
i
;

2559 
ldns_rdf
 **
n
;

2560 
ldns_rdf
 **
s
;

2561 
size_t
 *
πt
;

2562 i‡(!
r
) {

2565 
n
 = 
	`ldns_ªsﬁvî_«me£rvîs
(
r
);

2566 
s
 = 
	`ldns_ªsﬁvî_£¨chli°
(
r
);

2567 
πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

2569 
	`Ârötf
(
ouçut
, "p‹t: %d\n", ()
	`ldns_ªsﬁvî_p‹t
(
r
));

2570 
	`Ârötf
(
ouçut
, "edns0 size: %d\n", ()
	`ldns_ªsﬁvî_edns_udp_size
(
r
));

2571 
	`Ârötf
(
ouçut
, "u£ ip6: %d\n", ()
	`ldns_ªsﬁvî_ù6
(
r
));

2573 
	`Ârötf
(
ouçut
, "ªcursive: %d\n", 
	`ldns_ªsﬁvî_ªcursive
(
r
));

2574 
	`Ârötf
(
ouçut
, "u£vc: %d\n", 
	`ldns_ªsﬁvî_u£vc
(
r
));

2575 
	`Ârötf
(
ouçut
, "ig¡c: %d\n", 
	`ldns_ªsﬁvî_ig¡c
(
r
));

2576 
	`Ârötf
(
ouçut
, "Áû: %d\n", 
	`ldns_ªsﬁvî_Áû
(
r
));

2577 
	`Ârötf
(
ouçut
, "ªåy: %d\n", ()
	`ldns_ªsﬁvî_ªåy
(
r
));

2578 
	`Ârötf
(
ouçut
, "ªå™s: %d\n", ()
	`ldns_ªsﬁvî_ªå™s
(
r
));

2579 
	`Ârötf
(
ouçut
, "ÁŒback: %d\n", 
	`ldns_ªsﬁvî_ÁŒback
(
r
));

2580 
	`Ârötf
(
ouçut
, "øndom: %d\n", 
	`ldns_ªsﬁvî_øndom
(
r
));

2581 
	`Ârötf
(
ouçut
, "timeout: %d\n", ()
	`ldns_ªsﬁvî_timeout
(
r
).
tv_£c
);

2582 
	`Ârötf
(
ouçut
, "dns£c: %d\n", 
	`ldns_ªsﬁvî_dns£c
(
r
));

2583 
	`Ârötf
(
ouçut
, "dns£¯cd: %d\n", 
	`ldns_ªsﬁvî_dns£c_cd
(
r
));

2584 
	`Ârötf
(
ouçut
, "trustánchors (%dÜisted):\n",

2585 ()
	`ldns_º_li°_º_cou¡
(
	`ldns_ªsﬁvî_dns£c_™ch‹s
(
r
)));

2586 
	`ldns_º_li°_¥öt_fmt
(
ouçut
, 
fmt
, 
	`ldns_ªsﬁvî_dns£c_™ch‹s
(
r
));

2587 
	`Ârötf
(
ouçut
, "tsig: %s %s\n",

2588 
	`ldns_ªsﬁvî_tsig_key«me
(
r
)?ldns_resolver_tsig_keyname(r):"-",

2589 
	`ldns_ªsﬁvî_tsig_Æg‹ôhm
(
r
)?ldns_resolver_tsig_algorithm(r):"-");

2590 
	`Ârötf
(
ouçut
, "debug: %d\n", 
	`ldns_ªsﬁvî_debug
(
r
));

2592 
	`Ârötf
(
ouçut
, "default domain: ");

2593 
	`ldns_rdf_¥öt
(
ouçut
, 
	`ldns_ªsﬁvî_domaö
(
r
));

2594 
	`Ârötf
(
ouçut
, "\n");

2595 
	`Ârötf
(
ouçut
, "≠∂y deÁu… domaö: %d\n", 
	`ldns_ªsﬁvî_de‚ames
(
r
));

2597 
	`Ârötf
(
ouçut
, "£¨chli° (%dÜi°ed):\n", ()
	`ldns_ªsﬁvî_£¨chli°_cou¡
(
r
));

2598 
i
 = 0; i < 
	`ldns_ªsﬁvî_£¨chli°_cou¡
(
r
); i++) {

2599 
	`Ârötf
(
ouçut
, "\t");

2600 
	`ldns_rdf_¥öt
(
ouçut
, 
s
[
i
]);

2601 
	`Ârötf
(
ouçut
, "\n");

2603 
	`Ârötf
(
ouçut
, "≠∂y sórchÜi°: %d\n", 
	`ldns_ªsﬁvî_dn§ch
(
r
));

2605 
	`Ârötf
(
ouçut
, "«me£rvî†(%dÜi°ed):\n", ()
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
));

2606 
i
 = 0; i < 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
); i++) {

2607 
	`Ârötf
(
ouçut
, "\t");

2608 
	`ldns_rdf_¥öt
(
ouçut
, 
n
[
i
]);

2610 ()
πt
[
i
]) {

2611 
LDNS_RESOLV_RTT_MIN
:

2612 
	`Ârötf
(
ouçut
, " -Ñeachable\n");

2614 
LDNS_RESOLV_RTT_INF
:

2615 
	`Ârötf
(
ouçut
, " - unreachable\n");

2619 
	}
}

2622 
	$ldns_ªsﬁvî_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_ªsﬁvî
 *
r
)

2624 
	`ldns_ªsﬁvî_¥öt_fmt
(
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
r
);

2625 
	}
}

2628 
	$ldns_z⁄e_¥öt_fmt
(
FILE
 *
ouçut
,

2629 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_z⁄e
 *
z
)

2631 if(
	`ldns_z⁄e_sﬂ
(
z
))

2632 
	`ldns_º_¥öt_fmt
(
ouçut
, 
fmt
, 
	`ldns_z⁄e_sﬂ
(
z
));

2633 
	`ldns_º_li°_¥öt_fmt
(
ouçut
, 
fmt
, 
	`ldns_z⁄e_ºs
(
z
));

2634 
	}
}

2636 
	$ldns_z⁄e_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_z⁄e
 *
z
)

2638 
	`ldns_z⁄e_¥öt_fmt
(
ouçut
, 
ldns_ouçut_f‹m©_deÁu…
, 
z
);

2639 
	}
}

	@host2wire.c

15 
	~<ldns/c⁄fig.h
>

17 
	~<ldns/ldns.h
>

26 
ldns_°©us


27 
	$ldns_d«me2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_rdf
 *
«me
)

29 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 
	`ldns_rdf_size
(
«me
))) {

30 
	`ldns_buf„r_wrôe
(
buf„r
, 
	`ldns_rdf_d©a
(
«me
), 
	`ldns_rdf_size
(name));

32  
	`ldns_buf„r_°©us
(
buf„r
);

33 
	}
}

35 
ldns_°©us


36 
	$ldns_rdf2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_rdf
 *
rdf
)

38 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 
	`ldns_rdf_size
(
rdf
))) {

39 
	`ldns_buf„r_wrôe
(
buf„r
, 
	`ldns_rdf_d©a
(
rdf
), 
	`ldns_rdf_size
(rdf));

41  
	`ldns_buf„r_°©us
(
buf„r
);

42 
	}
}

44 
ldns_°©us


45 
	$ldns_rdf2buf„r_wúe_ˇn⁄iˇl
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_rdf
 *
rdf
)

47 
size_t
 
i
;

48 
uöt8_t
 *
rdf_d©a
;

50 i‡(
	`ldns_rdf_gë_ty≥
(
rdf
Ë=
LDNS_RDF_TYPE_DNAME
) {

51 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 
	`ldns_rdf_size
(
rdf
))) {

52 
rdf_d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

53 
i
 = 0; i < 
	`ldns_rdf_size
(
rdf
); i++) {

54 
	`ldns_buf„r_wrôe_u8
(
buf„r
,

55 (
uöt8_t
Ë
	`LDNS_DNAME_NORMALIZE
(()
rdf_d©a
[
i
]));

60 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 
	`ldns_rdf_size
(
rdf
))) {

61 
	`ldns_buf„r_wrôe
(
buf„r
,

62 
	`ldns_rdf_d©a
(
rdf
),

63 
	`ldns_rdf_size
(
rdf
));

66  
	`ldns_buf„r_°©us
(
buf„r
);

67 
	}
}

70 
ldns_°©us


71 
	$ldns_º_li°2buf„r_wúe
(
ldns_buf„r
 *
buf„r
,c⁄° 
ldns_º_li°
 *
º_li°
)

73 
uöt16_t
 
º_cou¡
;

74 
uöt16_t
 
i
;

76 
º_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
º_li°
);

77 
i
 = 0; i < 
º_cou¡
; i++) {

78 ()
	`ldns_º2buf„r_wúe
(
buf„r
, 
	`ldns_º_li°_º
(
º_li°
, 
i
),

79 
LDNS_SECTION_ANY
);

81  
	`ldns_buf„r_°©us
(
buf„r
);

82 
	}
}

85 
ldns_°©us


86 
	$ldns_º2buf„r_wúe_ˇn⁄iˇl
(
ldns_buf„r
 *
buf„r
,

87 c⁄° 
ldns_º
 *
º
,

88 
£˘i⁄
)

90 
uöt16_t
 
i
;

91 
uöt16_t
 
rdl_pos
 = 0;

92 
boﬁ
 
¥e_rfc3597
 = 
Ál£
;

93 
	`ldns_º_gë_ty≥
(
º
)) {

94 
LDNS_RR_TYPE_NS
:

95 
LDNS_RR_TYPE_MD
:

96 
LDNS_RR_TYPE_MF
:

97 
LDNS_RR_TYPE_CNAME
:

98 
LDNS_RR_TYPE_SOA
:

99 
LDNS_RR_TYPE_MB
:

100 
LDNS_RR_TYPE_MG
:

101 
LDNS_RR_TYPE_MR
:

102 
LDNS_RR_TYPE_PTR
:

103 
LDNS_RR_TYPE_HINFO
:

104 
LDNS_RR_TYPE_MINFO
:

105 
LDNS_RR_TYPE_MX
:

106 
LDNS_RR_TYPE_RP
:

107 
LDNS_RR_TYPE_AFSDB
:

108 
LDNS_RR_TYPE_RT
:

109 
LDNS_RR_TYPE_SIG
:

110 
LDNS_RR_TYPE_PX
:

111 
LDNS_RR_TYPE_NXT
:

112 
LDNS_RR_TYPE_NAPTR
:

113 
LDNS_RR_TYPE_KX
:

114 
LDNS_RR_TYPE_SRV
:

115 
LDNS_RR_TYPE_DNAME
:

116 
LDNS_RR_TYPE_A6
:

117 
LDNS_RR_TYPE_RRSIG
:

118 
¥e_rfc3597
 = 
åue
;

124 i‡(
	`ldns_º_ow√r
(
º
)) {

125 (Ë
	`ldns_rdf2buf„r_wúe_ˇn⁄iˇl
(
buf„r
, 
	`ldns_º_ow√r
(
º
));

128 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 4)) {

129 (Ë
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_º_gë_ty≥
(
º
));

130 (Ë
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_º_gë_˛ass
(
º
));

133 i‡(
£˘i⁄
 !
LDNS_SECTION_QUESTION
) {

134 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 6)) {

135 
	`ldns_buf„r_wrôe_u32
(
buf„r
, 
	`ldns_º_âl
(
º
));

137 
rdl_pos
 = 
	`ldns_buf„r_posôi⁄
(
buf„r
);

138 
	`ldns_buf„r_wrôe_u16
(
buf„r
, 0);

140 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

141 i‡(
¥e_rfc3597
) {

142 (Ë
	`ldns_rdf2buf„r_wúe_ˇn⁄iˇl
(

143 
buf„r
, 
	`ldns_º_rdf
(
º
, 
i
));

145 (Ë
	`ldns_rdf2buf„r_wúe
(

146 
buf„r
, 
	`ldns_º_rdf
(
º
, 
i
));

149 i‡(
rdl_pos
 != 0) {

150 
	`ldns_buf„r_wrôe_u16_©
(
buf„r
, 
rdl_pos
,

151 
	`ldns_buf„r_posôi⁄
(
buf„r
)

152 - 
rdl_pos
 - 2);

155  
	`ldns_buf„r_°©us
(
buf„r
);

156 
	}
}

158 
ldns_°©us


159 
	$ldns_º2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_º
 *
º
, 
£˘i⁄
)

161 
uöt16_t
 
i
;

162 
uöt16_t
 
rdl_pos
 = 0;

164 i‡(
	`ldns_º_ow√r
(
º
)) {

165 (Ë
	`ldns_d«me2buf„r_wúe
(
buf„r
, 
	`ldns_º_ow√r
(
º
));

168 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 4)) {

169 (Ë
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_º_gë_ty≥
(
º
));

170 (Ë
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_º_gë_˛ass
(
º
));

173 i‡(
£˘i⁄
 !
LDNS_SECTION_QUESTION
) {

174 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 6)) {

175 
	`ldns_buf„r_wrôe_u32
(
buf„r
, 
	`ldns_º_âl
(
º
));

177 
rdl_pos
 = 
	`ldns_buf„r_posôi⁄
(
buf„r
);

178 
	`ldns_buf„r_wrôe_u16
(
buf„r
, 0);

180 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

181 (Ë
	`ldns_rdf2buf„r_wúe
(

182 
buf„r
, 
	`ldns_º_rdf
(
º
, 
i
));

184 i‡(
rdl_pos
 != 0) {

185 
	`ldns_buf„r_wrôe_u16_©
(
buf„r
, 
rdl_pos
,

186 
	`ldns_buf„r_posôi⁄
(
buf„r
)

187 - 
rdl_pos
 - 2);

190  
	`ldns_buf„r_°©us
(
buf„r
);

191 
	}
}

193 
ldns_°©us


194 
	$ldns_ºsig2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_º
 *
º
)

196 
uöt16_t
 
i
;

199 i‡(
	`ldns_º_gë_ty≥
(
º
Ë!
LDNS_RR_TYPE_RRSIG
) {

200  
LDNS_STATUS_ERR
;

205 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
) - 1; i++) {

206 (Ë
	`ldns_rdf2buf„r_wúe_ˇn⁄iˇl
(
buf„r
,

207 
	`ldns_º_rdf
(
º
, 
i
));

210  
	`ldns_buf„r_°©us
(
buf„r
);

211 
	}
}

213 
ldns_°©us


214 
	$ldns_º_rd©a2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_º
 *
º
)

216 
uöt16_t
 
i
;

218 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

219 (Ë
	`ldns_rdf2buf„r_wúe
(
buf„r
, 
	`ldns_º_rdf
(
º
,
i
));

221  
	`ldns_buf„r_°©us
(
buf„r
);

222 
	}
}

227 
ldns_°©us


228 
	$ldns_hdr2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_pkt
 *
∑ckë
)

230 
uöt8_t
 
Êags
;

231 
uöt16_t
 
¨cou¡
;

233 i‡(
	`ldns_buf„r_ª£rve
(
buf„r
, 12)) {

234 
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_pkt_id
(
∑ckë
));

236 
Êags
 = 
	`ldns_pkt_qr
(
∑ckë
) << 7

237 | 
	`ldns_pkt_gë_›code
(
∑ckë
) << 3

238 | 
	`ldns_pkt_Ø
(
∑ckë
) << 2

239 | 
	`ldns_pkt_tc
(
∑ckë
Ë<< 1 | 
	`ldns_pkt_rd
(packet);

240 
	`ldns_buf„r_wrôe_u8
(
buf„r
, 
Êags
);

242 
Êags
 = 
	`ldns_pkt_ø
(
∑ckë
) << 7

244 | 
	`ldns_pkt_ad
(
∑ckë
) << 5

245 | 
	`ldns_pkt_cd
(
∑ckë
) << 4

246 | 
	`ldns_pkt_gë_rcode
(
∑ckë
);

247 
	`ldns_buf„r_wrôe_u8
(
buf„r
, 
Êags
);

249 
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_pkt_qdcou¡
(
∑ckë
));

250 
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_pkt_™cou¡
(
∑ckë
));

251 
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
	`ldns_pkt_nscou¡
(
∑ckë
));

253 
¨cou¡
 = 
	`ldns_pkt_¨cou¡
(
∑ckë
);

254 i‡(
	`ldns_pkt_tsig
(
∑ckë
)) {

255 
¨cou¡
++;

257 i‡(
	`ldns_pkt_edns
(
∑ckë
)) {

258 
¨cou¡
++;

260 
	`ldns_buf„r_wrôe_u16
(
buf„r
, 
¨cou¡
);

263  
	`ldns_buf„r_°©us
(
buf„r
);

264 
	}
}

266 
ldns_°©us


267 
	$ldns_pkt2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_pkt
 *
∑ckë
)

269 
ldns_º_li°
 *
º_li°
;

270 
uöt16_t
 
i
;

273 
ldns_º
 *
edns_º
;

274 
uöt8_t
 
ed©a
[4];

276 (Ë
	`ldns_hdr2buf„r_wúe
(
buf„r
, 
∑ckë
);

278 
º_li°
 = 
	`ldns_pkt_que°i⁄
(
∑ckë
);

279 i‡(
º_li°
) {

280 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

281 (Ë
	`ldns_º2buf„r_wúe
(
buf„r
,

282 
	`ldns_º_li°_º
(
º_li°
, 
i
), 
LDNS_SECTION_QUESTION
);

285 
º_li°
 = 
	`ldns_pkt_™swî
(
∑ckë
);

286 i‡(
º_li°
) {

287 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

288 (Ë
	`ldns_º2buf„r_wúe
(
buf„r
,

289 
	`ldns_º_li°_º
(
º_li°
, 
i
), 
LDNS_SECTION_ANSWER
);

292 
º_li°
 = 
	`ldns_pkt_auth‹ôy
(
∑ckë
);

293 i‡(
º_li°
) {

294 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

295 (Ë
	`ldns_º2buf„r_wúe
(
buf„r
,

296 
	`ldns_º_li°_º
(
º_li°
, 
i
), 
LDNS_SECTION_AUTHORITY
);

299 
º_li°
 = 
	`ldns_pkt_addôi⁄Æ
(
∑ckë
);

300 i‡(
º_li°
) {

301 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

302 (Ë
	`ldns_º2buf„r_wúe
(
buf„r
,

303 
	`ldns_º_li°_º
(
º_li°
, 
i
), 
LDNS_SECTION_ADDITIONAL
);

308 i‡(
	`ldns_pkt_edns
(
∑ckë
)) {

309 
edns_º
 = 
	`ldns_º_√w
();

310 if(!
edns_º
Ë 
LDNS_STATUS_MEM_ERR
;

311 
	`ldns_º_£t_ow√r
(
edns_º
,

312 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, "."));

313 
	`ldns_º_£t_ty≥
(
edns_º
, 
LDNS_RR_TYPE_OPT
);

314 
	`ldns_º_£t_˛ass
(
edns_º
, 
	`ldns_pkt_edns_udp_size
(
∑ckë
));

315 
ed©a
[0] = 
	`ldns_pkt_edns_exãnded_rcode
(
∑ckë
);

316 
ed©a
[1] = 
	`ldns_pkt_edns_vîsi⁄
(
∑ckë
);

317 
	`ldns_wrôe_uöt16
(&
ed©a
[2], 
	`ldns_pkt_edns_z
(
∑ckë
));

318 
	`ldns_º_£t_âl
(
edns_º
, 
	`ldns_ªad_uöt32
(
ed©a
));

320 i‡(
∑ckë
->
_edns_d©a
)

321 
	`ldns_º_push_rdf
 (
edns_º
, 
∑ckë
->
_edns_d©a
);

322 ()
	`ldns_º2buf„r_wúe
(
buf„r
, 
edns_º
, 
LDNS_SECTION_ADDITIONAL
);

324 i‡(
∑ckë
->
_edns_d©a
)

325 ()
	`ldns_º_p›_rdf
 (
edns_º
);

326 
	`ldns_º_‰ì
(
edns_º
);

330 i‡(
	`ldns_pkt_tsig
(
∑ckë
)) {

331 (Ë
	`ldns_º2buf„r_wúe
(
buf„r
,

332 
	`ldns_pkt_tsig
(
∑ckë
), 
LDNS_SECTION_ADDITIONAL
);

335  
LDNS_STATUS_OK
;

336 
	}
}

338 
ldns_°©us


339 
	$ldns_rdf2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_rdf
 *
rdf
, 
size_t
 *
ªsu…_size
)

341 
ldns_buf„r
 *
buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

342 
ldns_°©us
 
°©us
;

343 *
ªsu…_size
 = 0;

344 *
de°
 = 
NULL
;

345 if(!
buf„r
Ë 
LDNS_STATUS_MEM_ERR
;

347 
°©us
 = 
	`ldns_rdf2buf„r_wúe
(
buf„r
, 
rdf
);

348 i‡(
°©us
 =
LDNS_STATUS_OK
) {

349 *
ªsu…_size
 = 
	`ldns_buf„r_posôi⁄
(
buf„r
);

350 *
de°
 = (
uöt8_t
 *Ë
	`ldns_buf„r_exp‹t
(
buf„r
);

352 
	`ldns_buf„r_‰ì
(
buf„r
);

353  
°©us
;

354 
	}
}

356 
ldns_°©us


357 
	$ldns_º2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_º
 *
º
, 
£˘i⁄
, 
size_t
 *
ªsu…_size
)

359 
ldns_buf„r
 *
buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

360 
ldns_°©us
 
°©us
;

361 *
ªsu…_size
 = 0;

362 *
de°
 = 
NULL
;

363 if(!
buf„r
Ë 
LDNS_STATUS_MEM_ERR
;

365 
°©us
 = 
	`ldns_º2buf„r_wúe
(
buf„r
, 
º
, 
£˘i⁄
);

366 i‡(
°©us
 =
LDNS_STATUS_OK
) {

367 *
ªsu…_size
 = 
	`ldns_buf„r_posôi⁄
(
buf„r
);

368 *
de°
 = (
uöt8_t
 *Ë
	`ldns_buf„r_exp‹t
(
buf„r
);

370 
	`ldns_buf„r_‰ì
(
buf„r
);

371  
°©us
;

372 
	}
}

374 
ldns_°©us


375 
	$ldns_pkt2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_pkt
 *
∑ckë
, 
size_t
 *
ªsu…_size
)

377 
ldns_buf„r
 *
buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

378 
ldns_°©us
 
°©us
;

379 *
ªsu…_size
 = 0;

380 *
de°
 = 
NULL
;

381 if(!
buf„r
Ë 
LDNS_STATUS_MEM_ERR
;

383 
°©us
 = 
	`ldns_pkt2buf„r_wúe
(
buf„r
, 
∑ckë
);

384 i‡(
°©us
 =
LDNS_STATUS_OK
) {

385 *
ªsu…_size
 = 
	`ldns_buf„r_posôi⁄
(
buf„r
);

386 *
de°
 = (
uöt8_t
 *Ë
	`ldns_buf„r_exp‹t
(
buf„r
);

388 
	`ldns_buf„r_‰ì
(
buf„r
);

389  
°©us
;

390 
	}
}

	@include/ldns/buffer.h

13 #i‚de‡
LDNS_BUFFER_H


14 
	#LDNS_BUFFER_H


	)

16 
	~<as£π.h
>

17 
	~<°d¨g.h
>

18 
	~<°rög.h
>

20 
	~<ldns/îr‹.h
>

21 
	~<ldns/comm⁄.h
>

23 
	~"ldns/utû.h
"

25 #ifde‡
__˝lu•lus


33 
	#LDNS_MIN_BUFLEN
 512

	)

50 
	sldns_°ru˘_buf„r


53 
size_t
 
_posôi⁄
;

56 
size_t
 
_limô
;

59 
size_t
 
_ˇ∑côy
;

62 
uöt8_t
 *
_d©a
;

65 
_fixed
 : 1;

70 
ldns_°©us
 
_°©us
;

72 
ldns_°ru˘_buf„r
 
	tldns_buf„r
;

75 #ifde‡
NDEBUG


76 
INLINE
 

77 
ldns_buf„r_öv¨ü¡
(
ldns_buf„r
 *
ATTR_UNUSED
(
buf„r
))

81 
INLINE
 

82 
ldns_buf„r_öv¨ü¡
(
ldns_buf„r
 *
buf„r
)

84 
as£π
(
buf„r
 !
NULL
);

85 
as£π
(
buf„r
->
_posôi⁄
 <buf„r->
_limô
);

86 
as£π
(
buf„r
->
_limô
 <buf„r->
_ˇ∑côy
);

87 
as£π
(
buf„r
->
_d©a
 !
NULL
);

97 
ldns_buf„r
 *
ldns_buf„r_√w
(
size_t
 
ˇ∑côy
);

108 
ldns_buf„r_√w_‰m_d©a
(
ldns_buf„r
 *
buf„r
, *
d©a
, 
size_t
 
size
);

115 
INLINE
 
ldns_buf„r_˛ór
(
ldns_buf„r
 *
buf„r
)

117 
ldns_buf„r_öv¨ü¡
(
buf„r
);

121 
buf„r
->
_posôi⁄
 = 0;

122 
buf„r
->
_limô
 = buf„r->
_ˇ∑côy
;

133 
INLINE
 
ldns_buf„r_Êù
(
ldns_buf„r
 *
buf„r
)

135 
ldns_buf„r_öv¨ü¡
(
buf„r
);

137 
buf„r
->
_limô
 = buf„r->
_posôi⁄
;

138 
buf„r
->
_posôi⁄
 = 0;

146 
INLINE
 
ldns_buf„r_ªwöd
(
ldns_buf„r
 *
buf„r
)

148 
ldns_buf„r_öv¨ü¡
(
buf„r
);

150 
buf„r
->
_posôi⁄
 = 0;

158 
INLINE
 
size_t


159 
ldns_buf„r_posôi⁄
(
ldns_buf„r
 *
buf„r
)

161  
buf„r
->
_posôi⁄
;

170 
INLINE
 

171 
ldns_buf„r_£t_posôi⁄
(
ldns_buf„r
 *
buf„r
, 
size_t
 
m¨k
)

173 
as£π
(
m¨k
 <
buf„r
->
_limô
);

174 
buf„r
->
_posôi⁄
 = 
m¨k
;

184 
INLINE
 

185 
ldns_buf„r_skù
(
ldns_buf„r
 *
buf„r
, 
ssize_t
 
cou¡
)

187 
as£π
(
buf„r
->
_posôi⁄
 + 
cou¡
 <buf„r->
_limô
);

188 
buf„r
->
_posôi⁄
 +
cou¡
;

196 
INLINE
 
size_t


197 
ldns_buf„r_limô
(
ldns_buf„r
 *
buf„r
)

199  
buf„r
->
_limô
;

208 
INLINE
 

209 
ldns_buf„r_£t_limô
(
ldns_buf„r
 *
buf„r
, 
size_t
 
limô
)

211 
as£π
(
limô
 <
buf„r
->
_ˇ∑côy
);

212 
buf„r
->
_limô
 = 
limô
;

213 i‡(
buf„r
->
_posôi⁄
 > buf„r->
_limô
)

214 
buf„r
->
_posôi⁄
 = buf„r->
_limô
;

222 
INLINE
 
size_t


223 
ldns_buf„r_ˇ∑côy
(
ldns_buf„r
 *
buf„r
)

225  
buf„r
->
_ˇ∑côy
;

236 
boﬁ
 
ldns_buf„r_£t_ˇ∑côy
(
ldns_buf„r
 *
buf„r
, 
size_t
 
ˇ∑côy
);

248 
boﬁ
 
ldns_buf„r_ª£rve
(
ldns_buf„r
 *
buf„r
, 
size_t
 
amou¡
);

256 
INLINE
 
uöt8_t
 *

257 
ldns_buf„r_©
(c⁄° 
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

259 
as£π
(
©
 <
buf„r
->
_limô
);

260  
buf„r
->
_d©a
 + 
©
;

269 
INLINE
 
uöt8_t
 *

270 
ldns_buf„r_begö
(c⁄° 
ldns_buf„r
 *
buf„r
)

272  
ldns_buf„r_©
(
buf„r
, 0);

281 
INLINE
 
uöt8_t
 *

282 
ldns_buf„r_íd
(
ldns_buf„r
 *
buf„r
)

284  
ldns_buf„r_©
(
buf„r
, buf„r->
_limô
);

292 
INLINE
 
uöt8_t
 *

293 
ldns_buf„r_cuºít
(
ldns_buf„r
 *
buf„r
)

295  
ldns_buf„r_©
(
buf„r
, buf„r->
_posôi⁄
);

305 
INLINE
 
size_t


306 
ldns_buf„r_ªmaöög_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

308 
ldns_buf„r_öv¨ü¡
(
buf„r
);

309 
as£π
(
©
 <
buf„r
->
_limô
);

310  
buf„r
->
_limô
 - 
©
;

319 
INLINE
 
size_t


320 
ldns_buf„r_ªmaöög
(
ldns_buf„r
 *
buf„r
)

322  
ldns_buf„r_ªmaöög_©
(
buf„r
, buf„r->
_posôi⁄
);

334 
INLINE
 

335 
ldns_buf„r_avaûabÀ_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, size_à
cou¡
)

337  
cou¡
 <
ldns_buf„r_ªmaöög_©
(
buf„r
, 
©
);

346 
INLINE
 

347 
ldns_buf„r_avaûabÀ
(
ldns_buf„r
 *
buf„r
, 
size_t
 
cou¡
)

349  
ldns_buf„r_avaûabÀ_©
(
buf„r
, buf„r->
_posôi⁄
, 
cou¡
);

359 
INLINE
 

360 
ldns_buf„r_wrôe_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, c⁄° *
d©a
, size_à
cou¡
)

362 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, 
cou¡
));

363 
mem˝y
(
buf„r
->
_d©a
 + 
©
, 
d©a
, 
cou¡
);

372 
INLINE
 

373 
ldns_buf„r_wrôe
(
ldns_buf„r
 *
buf„r
, c⁄° *
d©a
, 
size_t
 
cou¡
)

375 
ldns_buf„r_wrôe_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
, 
cou¡
);

376 
buf„r
->
_posôi⁄
 +
cou¡
;

385 
INLINE
 

386 
ldns_buf„r_wrôe_°rög_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, c⁄° *
°r
)

388 
ldns_buf„r_wrôe_©
(
buf„r
, 
©
, 
°r
, 
°æí
(str));

396 
INLINE
 

397 
ldns_buf„r_wrôe_°rög
(
ldns_buf„r
 *
buf„r
, c⁄° *
°r
)

399 
ldns_buf„r_wrôe
(
buf„r
, 
°r
, 
°æí
(str));

408 
INLINE
 

409 
ldns_buf„r_wrôe_u8_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, 
uöt8_t
 
d©a
)

411 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
d©a
)));

412 
buf„r
->
_d©a
[
©
] = 
d©a
;

420 
INLINE
 

421 
ldns_buf„r_wrôe_u8
(
ldns_buf„r
 *
buf„r
, 
uöt8_t
 
d©a
)

423 
ldns_buf„r_wrôe_u8_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
);

424 
buf„r
->
_posôi⁄
 +(
d©a
);

433 
INLINE
 

434 
ldns_buf„r_wrôe_u16_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, 
uöt16_t
 
d©a
)

436 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
d©a
)));

437 
ldns_wrôe_uöt16
(
buf„r
->
_d©a
 + 
©
, 
d©a
);

445 
INLINE
 

446 
ldns_buf„r_wrôe_u16
(
ldns_buf„r
 *
buf„r
, 
uöt16_t
 
d©a
)

448 
ldns_buf„r_wrôe_u16_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
);

449 
buf„r
->
_posôi⁄
 +(
d©a
);

458 
INLINE
 

459 
ldns_buf„r_wrôe_u32_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, 
uöt32_t
 
d©a
)

461 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
d©a
)));

462 
ldns_wrôe_uöt32
(
buf„r
->
_d©a
 + 
©
, 
d©a
);

470 
INLINE
 

471 
ldns_buf„r_wrôe_u32
(
ldns_buf„r
 *
buf„r
, 
uöt32_t
 
d©a
)

473 
ldns_buf„r_wrôe_u32_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
);

474 
buf„r
->
_posôi⁄
 +(
d©a
);

484 
INLINE
 

485 
ldns_buf„r_ªad_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, *
d©a
, size_à
cou¡
)

487 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, 
cou¡
));

488 
mem˝y
(
d©a
, 
buf„r
->
_d©a
 + 
©
, 
cou¡
);

497 
INLINE
 

498 
ldns_buf„r_ªad
(
ldns_buf„r
 *
buf„r
, *
d©a
, 
size_t
 
cou¡
)

500 
ldns_buf„r_ªad_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
, 
cou¡
);

501 
buf„r
->
_posôi⁄
 +
cou¡
;

510 
INLINE
 
uöt8_t


511 
ldns_buf„r_ªad_u8_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

513 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
uöt8_t
)));

514  
buf„r
->
_d©a
[
©
];

522 
INLINE
 
uöt8_t


523 
ldns_buf„r_ªad_u8
(
ldns_buf„r
 *
buf„r
)

525 
uöt8_t
 
ªsu…
 = 
ldns_buf„r_ªad_u8_©
(
buf„r
, buf„r->
_posôi⁄
);

526 
buf„r
->
_posôi⁄
 +(
uöt8_t
);

527  
ªsu…
;

536 
INLINE
 
uöt16_t


537 
ldns_buf„r_ªad_u16_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

539 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
uöt16_t
)));

540  
ldns_ªad_uöt16
(
buf„r
->
_d©a
 + 
©
);

548 
INLINE
 
uöt16_t


549 
ldns_buf„r_ªad_u16
(
ldns_buf„r
 *
buf„r
)

551 
uöt16_t
 
ªsu…
 = 
ldns_buf„r_ªad_u16_©
(
buf„r
, buf„r->
_posôi⁄
);

552 
buf„r
->
_posôi⁄
 +(
uöt16_t
);

553  
ªsu…
;

562 
INLINE
 
uöt32_t


563 
ldns_buf„r_ªad_u32_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

565 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
uöt32_t
)));

566  
ldns_ªad_uöt32
(
buf„r
->
_d©a
 + 
©
);

574 
INLINE
 
uöt32_t


575 
ldns_buf„r_ªad_u32
(
ldns_buf„r
 *
buf„r
)

577 
uöt32_t
 
ªsu…
 = 
ldns_buf„r_ªad_u32_©
(
buf„r
, buf„r->
_posôi⁄
);

578 
buf„r
->
_posôi⁄
 +(
uöt32_t
);

579  
ªsu…
;

587 
INLINE
 
ldns_°©us


588 
ldns_buf„r_°©us
(
ldns_buf„r
 *
buf„r
)

590  
buf„r
->
_°©us
;

598 
INLINE
 
boﬁ


599 
ldns_buf„r_°©us_ok
(
ldns_buf„r
 *
buf„r
)

601 i‡(
buf„r
) {

602  
ldns_buf„r_°©us
(
buf„r
Ë=
LDNS_STATUS_OK
;

604  
Ál£
;

614 
ldns_buf„r_¥ötf
(
ldns_buf„r
 *
buf„r
, c⁄° *
f‹m©
, ...);

622 
ldns_buf„r_‰ì
(
ldns_buf„r
 *
buf„r
);

630 *
ldns_buf„r_exp‹t
(
ldns_buf„r
 *
buf„r
);

639 
ldns_buf„r_c›y
(
ldns_buf„r
* 
ªsu…
,Üdns_buf„r* 
‰om
);

641 #ifde‡
__˝lu•lus


	@include/ldns/common.h

15 #i‚de‡
LDNS_COMMON_H


16 
	#LDNS_COMMON_H


	)

22 
	#LDNS_BUILD_CONFIG_HAVE_SSL
 1

	)

23 
	#LDNS_BUILD_CONFIG_HAVE_INTTYPES_H
 1

	)

24 
	#LDNS_BUILD_CONFIG_HAVE_ATTR_FORMAT
 1

	)

25 
	#LDNS_BUILD_CONFIG_HAVE_ATTR_UNUSED
 1

	)

26 
	#LDNS_BUILD_CONFIG_HAVE_SOCKLEN_T
 1

	)

27 
	#LDNS_BUILD_CONFIG_USE_DANE
 1

	)

28 
	#LDNS_BUILD_CONFIG_HAVE_B32_PTON
 0

	)

29 
	#LDNS_BUILD_CONFIG_HAVE_B32_NTOP
 0

	)

40 #ifde‡
HAVE_STDBOOL_H


41 
	~<°dboﬁ.h
>

43 #i‚de‡
HAVE__BOOL


44 #ifde‡
__˝lu•lus


45 
boﬁ
 
	t_Boﬁ
;

47 
	#_Boﬁ
 sig√d 

	)

50 
	#boﬁ
 
_Boﬁ


	)

51 
	#Ál£
 0

	)

52 
	#åue
 1

	)

53 
	#__boﬁ_åue_Ál£_¨e_deföed
 1

	)

57 #i‡
LDNS_BUILD_CONFIG_HAVE_ATTR_FORMAT


58 
	#ATTR_FORMAT
(
¨chëy≥
, 
°rög_ödex
, 
fú°_to_check
) \

59 
	`__©åibuã__
 ((
	`f‹m©
 (
¨chëy≥
, 
°rög_ödex
, 
fú°_to_check
)))

	)

61 
	#ATTR_FORMAT
(
¨chëy≥
, 
°rög_ödex
, 
fú°_to_check
Ë

	)

64 #i‡
deföed
(
__˝lu•lus
)

65 
	#ATTR_UNUSED
(
x
)

	)

66 #ñi‡
LDNS_BUILD_CONFIG_HAVE_ATTR_UNUSED


67 
	#ATTR_UNUSED
(
x
Ëx 
	`__©åibuã__
((
unu£d
))

	)

69 
	#ATTR_UNUSED
(
x
Ë
	)
x

72 #i‡!
LDNS_BUILD_CONFIG_HAVE_SOCKLEN_T


73 
	tsockÀn_t
;

	@include/ldns/config.h

8 
	#HAVE_ARPA_INET_H
 1

	)

11 
	#HAVE_ATTR_FORMAT
 1

	)

14 
	#HAVE_ATTR_UNUSED
 1

	)

29 
	#HAVE_BZERO
 1

	)

32 
	#HAVE_CALLOC
 1

	)

35 
	#HAVE_CTIME_R
 1

	)

38 
	#HAVE_DANE_CA_FILE
 0

	)

41 
	#HAVE_DANE_CA_PATH
 0

	)

45 
	#HAVE_DECL_NID_SECP384R1
 1

	)

49 
	#HAVE_DECL_NID_X9_62_PRIME256V1
 1

	)

52 
	#HAVE_DLFCN_H
 1

	)

55 
	#HAVE_ENDPROTOENT
 1

	)

58 
	#HAVE_ENDSERVENT
 1

	)

61 
	#HAVE_EVP_SHA256
 1

	)

64 
	#HAVE_FCNTL
 1

	)

67 
	#HAVE_FORK
 1

	)

70 
	#HAVE_GETADDRINFO
 1

	)

73 
	#HAVE_GETOPT_H
 1

	)

76 
	#HAVE_GMTIME_R
 1

	)

79 
	#HAVE_HMAC_CTX_INIT
 1

	)

82 
	#HAVE_INET_ATON
 1

	)

85 
	#HAVE_INET_NTOP
 1

	)

88 
	#HAVE_INET_PTON
 1

	)

91 
	#HAVE_INTTYPES_H
 1

	)

97 
	#HAVE_ISASCII
 1

	)

100 
	#HAVE_ISBLANK
 1

	)

103 
	#HAVE_LIBPCAP
 1

	)

106 
	#HAVE_LOCALTIME_R
 1

	)

110 
	#HAVE_MALLOC
 1

	)

113 
	#HAVE_MEMMOVE
 1

	)

116 
	#HAVE_MEMORY_H
 1

	)

119 
	#HAVE_MEMSET
 1

	)

122 
	#HAVE_NETDB_H
 1

	)

125 
	#HAVE_NETINET_IF_ETHER_H
 1

	)

128 
	#HAVE_NETINET_IGMP_H
 1

	)

131 
	#HAVE_NETINET_IN_H
 1

	)

134 
	#HAVE_NETINET_IN_SYSTM_H
 1

	)

137 
	#HAVE_NETINET_IP6_H
 1

	)

143 
	#HAVE_NETINET_IP_H
 1

	)

146 
	#HAVE_NETINET_UDP_H
 1

	)

149 
	#HAVE_NET_ETHERNET_H
 1

	)

152 
	#HAVE_NET_IF_H
 1

	)

155 
	#HAVE_OPENSSL_ERR_H
 1

	)

158 
	#HAVE_OPENSSL_RAND_H
 1

	)

161 
	#HAVE_OPENSSL_SSL_H
 1

	)

164 
	#HAVE_PCAP_H
 1

	)

170 
	#HAVE_RANDOM
 1

	)

174 
	#HAVE_REALLOC
 1

	)

177 
	#HAVE_SLEEP
 1

	)

180 
	#HAVE_SNPRINTF
 1

	)

183 
	#HAVE_SSL


	)

186 
	#HAVE_STDARG_H
 1

	)

189 
	#HAVE_STDBOOL_H
 1

	)

192 
	#HAVE_STDINT_H
 1

	)

195 
	#HAVE_STDLIB_H
 1

	)

198 
	#HAVE_STRINGS_H
 1

	)

201 
	#HAVE_STRING_H
 1

	)

204 
	#HAVE_STRLCPY
 1

	)

207 
	#HAVE_STRTOUL
 1

	)

213 
	#HAVE_SYS_MOUNT_H
 1

	)

216 
	#HAVE_SYS_PARAM_H
 1

	)

219 
	#HAVE_SYS_SOCKET_H
 1

	)

222 
	#HAVE_SYS_STAT_H
 1

	)

225 
	#HAVE_SYS_TYPES_H
 1

	)

228 
	#HAVE_TIMEGM
 1

	)

231 
	#HAVE_TIME_H
 1

	)

234 
	#HAVE_UNISTD_H
 1

	)

237 
	#HAVE_VFORK
 1

	)

246 
	#HAVE_WORKING_FORK
 1

	)

249 
	#HAVE_WORKING_VFORK
 1

	)

255 
	#HAVE__BOOL
 1

	)

264 
	#LDNS_TRUST_ANCHOR_FILE
 "/ëc/unbound/roŸ.key"

	)

268 
	#LT_OBJDIR
 ".libs/"

	)

271 
	#PACKAGE_BUGREPORT
 "libdns@∆√éabs.∆"

	)

274 
	#PACKAGE_NAME
 "ldns"

	)

277 
	#PACKAGE_STRING
 "ldn†1.6.17"

	)

280 
	#PACKAGE_TARNAME
 "libdns"

	)

283 
	#PACKAGE_URL
 ""

	)

286 
	#PACKAGE_VERSION
 "1.6.17"

	)

304 
	#SIZEOF_TIME_T
 8

	)

307 
	#STDC_HEADERS
 1

	)

313 
	#SYSCONFDIR
 
sysc⁄fdú


	)

316 
	#USE_DANE
 1

	)

319 
	#USE_ECDSA
 1

	)

322 
	#USE_GOST
 1

	)

325 
	#USE_SHA2
 1

	)

328 #i‚de‡
_ALL_SOURCE


329 
	#_ALL_SOURCE
 1

	)

332 #i‚de‡
_GNU_SOURCE


333 
	#_GNU_SOURCE
 1

	)

336 #i‚de‡
_POSIX_PTHREAD_SEMANTICS


337 
	#_POSIX_PTHREAD_SEMANTICS
 1

	)

340 #i‚de‡
_TANDEM_SOURCE


341 
	#_TANDEM_SOURCE
 1

	)

344 #i‚de‡
__EXTENSIONS__


345 
	#__EXTENSIONS__
 1

	)

353 
	#WINVER
 0x0502

	)

357 #i‡
deföed
 
AC_APPLE_UNIVERSAL_BUILD


358 #i‡
deföed
 
__BIG_ENDIAN__


359 
	#WORDS_BIGENDIAN
 1

	)

362 #i‚de‡
WORDS_BIGENDIAN


388 #i‚de‡
__˝lu•lus


444 
	~<°dio.h
>

445 
	~<°rög.h
>

446 
	~<uni°d.h
>

447 
	~<as£π.h
>

449 #i‚de‡
LITTLE_ENDIAN


450 
	#LITTLE_ENDIAN
 1234

	)

453 #i‚de‡
BIG_ENDIAN


454 
	#BIG_ENDIAN
 4321

	)

457 #i‚de‡
BYTE_ORDER


458 #ifde‡
WORDS_BIGENDIAN


459 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

461 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

465 #i‡
STDC_HEADERS


466 
	~<°dlib.h
>

467 
	~<°ddef.h
>

470 #ifde‡
HAVE_STDINT_H


471 
	~<°döt.h
>

474 #ifde‡
HAVE_SYS_SOCKET_H


475 
	~<sys/sockë.h
>

478 #ifde‡
HAVE_NETINET_IN_H


479 
	~<√töë/ö.h
>

482 #ifde‡
HAVE_ARPA_INET_H


483 
	~<¨∑/öë.h
>

486 #ifde‡
HAVE_WINSOCK2_H


487 
	~<wösock2.h
>

490 #ifde‡
HAVE_WS2TCPIP_H


491 
	~<ws2t˝ù.h
>

496 #ifde‡
HAVE_WINSOCK2_H


497 
	#FD_SET_T
 (
u_öt
)

	)

499 
	#FD_SET_T


	)

505 #ifde‡
__˝lu•lus


509 
ldns_b64_¡›
(
uöt8_t
 c⁄° *
§c
, 
size_t
 
§˛ígth
,

510 *
èrgë
, 
size_t
 
èrgsize
);

515 
ölöe
 
size_t
 
ldns_b64_¡›_ˇlcuœã_size
(size_à
§csize
)

517  ((((
§csize
 + 2) / 3) * 4) + 1);

519 
ldns_b64_±⁄
(c⁄° *
§c
, 
uöt8_t
 *
èrgë
, 
size_t
 
èrgsize
);

524 
ölöe
 
size_t
 
ldns_b64_±⁄_ˇlcuœã_size
(size_à
§csize
)

526  (((((
§csize
 + 3) / 4) * 3)) + 1);

533 
ldns_d«me_com∑ª_v
(c⁄° *
a
, c⁄° *
b
);

535 #i‚de‡
HAVE_SLEEP


537 
	#¶ìp
(
x
Ë
	`SÀï
((x)*1000)

	)

540 #i‚de‡
HAVE_RANDOM


541 
	#§™dom
(
x
Ë
	`§™d
(x)

	)

542 
	#øndom
(
x
Ë
	`ønd
(x)

	)

545 #i‚de‡
HAVE_TIMEGM


546 
	~<time.h
>

547 
time_t
 
timegm
 (
tm
 *tm);

549 #i‚de‡
HAVE_GMTIME_R


550 
tm
 *
gmtime_r
(c⁄° 
time_t
 *
timï
, tm *
ªsu…
);

552 #i‚de‡
HAVE_LOCALTIME_R


553 
tm
 *
loˇ…ime_r
(c⁄° 
time_t
 *
timï
, tm *
ªsu…
);

555 #i‚de‡
HAVE_ISBLANK


556 
isbœnk
(
c
);

558 #i‚de‡
HAVE_ISASCII


559 
ißscii
(
c
);

561 #i‚de‡
HAVE_SNPRINTF


562 
	~<°d¨g.h
>

563 
¢¥ötf
 (*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, ...);

564 
v¢¥ötf
 (*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, 
va_li°
 
¨g
);

566 #i‚de‡
HAVE_INET_PTON


567 
öë_±⁄
(
af
, c⁄° * 
§c
, * 
d°
);

569 #i‚de‡
HAVE_INET_NTOP


570 c⁄° *
öë_¡›
(
af
, c⁄° *
§c
, *
d°
, 
size_t
 
size
);

572 #i‚de‡
HAVE_INET_ATON


573 
öë_©⁄
(c⁄° *
˝
, 
ö_addr
 *
addr
);

575 #i‚de‡
HAVE_MEMMOVE


576 *
memmove
(*
de°
, c⁄° *
§c
, 
size_t
 
n
);

578 #i‚de‡
HAVE_STRLCPY


579 
size_t
 
°æ˝y
(*
d°
, c⁄° *
§c
, size_à
siz
);

581 #ifde‡
__˝lu•lus


584 #i‚de‡
HAVE_GETADDRINFO


585 
	~"com∑t/Áke-rfc2553.h
"

587 #i‚de‡
HAVE_STRTOUL


588 
	#°πoul
 ()
°πﬁ


	)

	@include/ldns/dane.h

23 #i‚de‡
LDNS_DANE_H


24 
	#LDNS_DANE_H


	)

25 #i‡
LDNS_BUILD_CONFIG_USE_DANE


27 
	~<ldns/comm⁄.h
>

28 
	~<ldns/rd©a.h
>

29 
	~<ldns/º.h
>

30 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


31 
	~<›ís¶/s¶.h
>

32 
	~<›ís¶/îr.h
>

35 #ifde‡
__˝lu•lus


42 
	eldns_íum_éß_˚πifiˇã_ußge


45 
LDNS_TLSA_USAGE_CA_CONSTRAINT
 = 0,

47 
LDNS_TLSA_USAGE_SERVICE_CERTIFICATE_CONSTRAINT
 = 1,

49 
LDNS_TLSA_USAGE_TRUST_ANCHOR_ASSERTION
 = 2,

51 
LDNS_TLSA_USAGE_DOMAIN_ISSUED_CERTIFICATE
 = 3

53 
ldns_íum_éß_˚πifiˇã_ußge
 
	tldns_éß_˚πifiˇã_ußge
;

58 
	eldns_íum_éß_£À˘‹


64 
LDNS_TLSA_SELECTOR_FULL_CERTIFICATE
 = 0,

70 
LDNS_TLSA_SELECTOR_SUBJECTPUBLICKEYINFO
 = 1

72 
ldns_íum_éß_£À˘‹
 
	tldns_éß_£À˘‹
;

77 
	eldns_íum_éß_m©chög_ty≥


80 
LDNS_TLSA_MATCHING_TYPE_NO_HASH_USED
 = 0,

82 
LDNS_TLSA_MATCHING_TYPE_SHA256
 = 1,

84 
LDNS_TLSA_MATCHING_TYPE_SHA512
 = 2

86 
ldns_íum_éß_m©chög_ty≥
 
	tldns_éß_m©chög_ty≥
;

91 
	eldns_íum_d™e_å™•‹t


94 
LDNS_DANE_TRANSPORT_TCP
 = 0,

96 
LDNS_DANE_TRANSPORT_UDP
 = 1,

98 
LDNS_DANE_TRANSPORT_SCTP
 = 2

100 
ldns_íum_d™e_å™•‹t
 
	tldns_d™e_å™•‹t
;

113 
ldns_°©us
 
ldns_d™e_¸óã_éß_ow√r
(
ldns_rdf
** 
éß_ow√r
,

114 c⁄° 
ldns_rdf
* 
«me
, 
uöt16_t
 
p‹t
,

115 
ldns_d™e_å™•‹t
 
å™•‹t
);

118 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


130 
ldns_°©us
 
ldns_d™e_˚π2rdf
(
ldns_rdf
** 
rdf
, 
X509
* 
˚π
,

131 
ldns_éß_£À˘‹
 
£À˘‹
,

132 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
);

163 
ldns_°©us
 
ldns_d™e_£À˘_˚πifiˇã
(
X509
** 
£À˘ed_˚π
,

164 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

165 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
,

166 
ldns_éß_˚πifiˇã_ußge
 
˚π_ußge
, 
ödex
);

181 
ldns_°©us
 
ldns_d™e_¸óã_éß_º
(
ldns_º
** 
éß
,

182 
ldns_éß_˚πifiˇã_ußge
 
˚πifiˇã_ußge
,

183 
ldns_éß_£À˘‹
 
£À˘‹
,

184 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
,

185 
X509
* 
˚π
);

210 
ldns_°©us
 
ldns_d™e_vîify_º
(c⁄° 
ldns_º
* 
éß_º
,

211 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

212 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
);

235 
ldns_°©us
 
ldns_d™e_vîify
(
ldns_º_li°
* 
éßs
,

236 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

237 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
);

240 #ifde‡
__˝lu•lus


	@include/ldns/dname.h

39 #i‚de‡
LDNS_DNAME_H


40 
	#LDNS_DNAME_H


	)

42 
	~<ldns/comm⁄.h
>

43 
	~<ldns/rd©a.h
>

45 #ifde‡
__˝lu•lus


49 
	#LDNS_DNAME_NORMALIZE
 
tﬁowî


	)

57 
ldns_rdf
 *
ldns_d«me_ˇt_˛⁄e
(c⁄°Üdns_rd‡*
rd1
, c⁄°Üdns_rd‡*
rd2
);

65 
ldns_°©us
 
ldns_d«me_ˇt
(
ldns_rdf
 *
rd1
,Üdns_rd‡*
rd2
);

73 
ldns_rdf
 *
ldns_d«me_ªvî£
(c⁄°Üdns_rd‡*
d
);

84 
ldns_rdf
 *

85 
ldns_d«me_˛⁄e_‰om
(c⁄° 
ldns_rdf
 *
d
, 
uöt16_t
 
n
);

94 
ldns_rdf
 *
ldns_d«me_À·_ch›
(c⁄°Üdns_rd‡*
d
);

101 
uöt8_t
 
ldns_d«me_œbñ_cou¡
(c⁄° 
ldns_rdf
 *
r
);

108 
ldns_rdf
 *
ldns_d«me_√w_‰m_°r
(c⁄° *
°r
);

117 
ldns_rdf
 *
ldns_d«me_√w
(
uöt16_t
 
s
, *
d©a
);

126 
ldns_rdf
 *
ldns_d«me_√w_‰m_d©a
(
uöt16_t
 
size
, c⁄° *
d©a
);

133 
ldns_d«me2ˇn⁄iˇl
(c⁄° 
ldns_rdf
 *
rdf
);

143 
boﬁ
 
ldns_d«me_is_subdomaö
(c⁄° 
ldns_rdf
 *
sub
, c⁄°Üdns_rd‡*
∑ª¡
);

152 
ldns_d«me_com∑ª
(c⁄° 
ldns_rdf
 *
d«me1
, c⁄°Üdns_rd‡*
d«me2
);

163 
ldns_d«me_m©ch_wûdˇrd
(c⁄° 
ldns_rdf
 *
d«me
, c⁄°Üdns_rd‡*
wûdˇrd
);

173 
ldns_d«me_öãrvÆ
(c⁄° 
ldns_rdf
 *
¥ev
, c⁄°Üdns_rd‡*
middÀ
, c⁄°Üdns_rd‡*
√xt
);

180 
boﬁ
 
ldns_d«me_°r_absﬁuã
(c⁄° *
d«me_°r
);

187 
boﬁ
 
ldns_d«me_absﬁuã
(c⁄° 
ldns_rdf
 *
d«me
);

197 
ldns_rdf
 * 
ldns_d«me_œbñ
(c⁄°Üdns_rd‡*
rdf
, 
uöt8_t
 
œbñpos
);

204 
ldns_d«me_is_wûdˇrd
(c⁄° 
ldns_rdf
* 
d«me
);

206 #ifde‡
__˝lu•lus


	@include/ldns/dnssec.h

23 #i‚de‡
LDNS_DNSSEC_H


24 
	#LDNS_DNSSEC_H


	)

26 
	~<ldns/comm⁄.h
>

27 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


28 
	~<›ís¶/s¶.h
>

29 
	~<›ís¶/evp.h
>

31 
	~<ldns/∑ckë.h
>

32 
	~<ldns/keys.h
>

33 
	~<ldns/z⁄e.h
>

34 
	~<ldns/ªsﬁvî.h
>

35 
	~<ldns/dns£c_z⁄e.h
>

37 #ifde‡
__˝lu•lus


41 
	#LDNS_MAX_KEYLEN
 2048

	)

42 
	#LDNS_DNSSEC_KEYPROTO
 3

	)

44 
	#LDNS_DEFAULT_EXP_TIME
 2419200

	)

47 
	#LDNS_SIGNATURE_LEAVE_ADD_NEW
 0

	)

48 
	#LDNS_SIGNATURE_LEAVE_NO_ADD
 1

	)

49 
	#LDNS_SIGNATURE_REMOVE_ADD_NEW
 2

	)

50 
	#LDNS_SIGNATURE_REMOVE_NO_ADD
 3

	)

62 
ldns_º
 *
ldns_dns£c_gë_ºsig_f‹_«me_™d_ty≥
(c⁄° 
ldns_rdf
 *
«me
,

63 c⁄° 
ldns_º_ty≥
 
ty≥
,

64 c⁄° 
ldns_º_li°
 *
ºs
);

75 
ldns_º
 *
ldns_dns£c_gë_dnskey_f‹_ºsig
(c⁄°Üdns_º *
ºsig
, c⁄° 
ldns_º_li°
 *
ºs
);

84 
ldns_rdf
 *
ldns_n£c_gë_bôm≠
(
ldns_º
 *
n£c
);

87 
	#LDNS_NSEC3_MAX_ITERATIONS
 65535

	)

92 
ldns_rdf
 *

93 
ldns_dns£c_n£c3_˛o£°_í˛o£r
(
ldns_rdf
 *
q«me
,

94 
ldns_º_ty≥
 
qty≥
,

95 
ldns_º_li°
 *
n£c3s
);

100 
boﬁ


101 
ldns_dns£c_pkt_has_ºsigs
(c⁄° 
ldns_pkt
 *
pkt
);

107 
ldns_º_li°
 *
ldns_dns£c_pkt_gë_ºsigs_f‹_«me_™d_ty≥
(c⁄° 
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
ty≥
);

112 
ldns_º_li°
 *
ldns_dns£c_pkt_gë_ºsigs_f‹_ty≥
(c⁄° 
ldns_pkt
 *
pkt
, 
ldns_º_ty≥
 
ty≥
);

120 
uöt16_t
 
ldns_ˇlc_keyèg
(c⁄° 
ldns_º
 *
key
);

128 
uöt16_t
 
ldns_ˇlc_keyèg_øw
(
uöt8_t
* 
key
, 
size_t
 
keysize
);

130 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


137 
DSA
 *
ldns_key_buf2dß
(
ldns_buf„r
 *
key
);

144 
DSA
 *
ldns_key_buf2dß_øw
(* 
key
, 
size_t
 
Àn
);

154 
ldns_dige°_evp
(* 
d©a
, 
Àn
,

155 * 
de°
, c⁄° 
EVP_MD
* 
md
);

164 
EVP_PKEY
* 
ldns_go°2pkey_øw
(* 
key
, 
size_t
 
keyÀn
);

174 
EVP_PKEY
* 
ldns_ecdß2pkey_øw
(* 
key
, 
size_t
 
keyÀn
, 
uöt8_t
 
Ægo
);

178 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


185 
RSA
 *
ldns_key_buf2rß
(
ldns_buf„r
 *
key
);

193 
RSA
 *
ldns_key_buf2rß_øw
(* 
key
, 
size_t
 
Àn
);

204 
ldns_º
 *
ldns_key_º2ds
(c⁄°Üdns_º *
key
, 
ldns_hash
 
h
);

209 
ldns_rdf
 *

210 
ldns_dns£c_¸óã_n£c_bôm≠
(
ldns_º_ty≥
 
º_ty≥_li°
[],

211 
size_t
 
size
,

212 
ldns_º_ty≥
 
n£c_ty≥
);

222 
ldns_dns£c_º£ts_c⁄èös_ty≥
 (
ldns_dns£c_º£ts
 *
º£ts
, 
ldns_º_ty≥
 
ty≥
);

227 
ldns_º
 *

228 
ldns_dns£c_¸óã_n£c
(
ldns_dns£c_«me
 *
‰om
,

229 
ldns_dns£c_«me
 *
to
,

230 
ldns_º_ty≥
 
n£c_ty≥
);

236 
ldns_º
 *

237 
ldns_dns£c_¸óã_n£c3
(
ldns_dns£c_«me
 *
‰om
,

238 
ldns_dns£c_«me
 *
to
,

239 
ldns_rdf
 *
z⁄e_«me
,

240 
uöt8_t
 
Æg‹ôhm
,

241 
uöt8_t
 
Êags
,

242 
uöt16_t
 
ôî©i⁄s
,

243 
uöt8_t
 
ß…_Àngth
,

244 
uöt8_t
 *
ß…
);

253 
ldns_º
 * 
ldns_¸óã_n£c
(
ldns_rdf
 *
cur_ow√r
,Üdns_rd‡*
√xt_ow√r
, 
ldns_º_li°
 *
ºs
);

264 
ldns_rdf
 *
ldns_n£c3_hash_«me
÷dns_rd‡*
«me
, 
uöt8_t
 
Æg‹ôhm
, 
uöt16_t
 
ôî©i⁄s
, uöt8_à
ß…_Àngth
, uöt8_à*
ß…
);

276 
ldns_n£c3_add_∑øm_rdfs
(
ldns_º
 *
º
,

277 
uöt8_t
 
Æg‹ôhm
,

278 
uöt8_t
 
Êags
,

279 
uöt16_t
 
ôî©i⁄s
,

280 
uöt8_t
 
ß…_Àngth
,

281 
uöt8_t
 *
ß…
);

285 
ldns_º
 *

286 
ldns_¸óã_n£c3
(
ldns_rdf
 *
cur_ow√r
,

287 
ldns_rdf
 *
cur_z⁄e
,

288 
ldns_º_li°
 *
ºs
,

289 
uöt8_t
 
Æg‹ôhm
,

290 
uöt8_t
 
Êags
,

291 
uöt16_t
 
ôî©i⁄s
,

292 
uöt8_t
 
ß…_Àngth
,

293 
uöt8_t
 *
ß…
,

294 
boﬁ
 
em±yn⁄ãrmöÆ
);

301 
uöt8_t
 
ldns_n£c3_Æg‹ôhm
(c⁄° 
ldns_º
 *
n£c3_º
);

306 
uöt8_t


307 
ldns_n£c3_Êags
(c⁄° 
ldns_º
 *
n£c3_º
);

314 
boﬁ
 
ldns_n£c3_›tout
(c⁄° 
ldns_º
 *
n£c3_º
);

321 
uöt16_t
 
ldns_n£c3_ôî©i⁄s
(c⁄° 
ldns_º
 *
n£c3_º
);

328 
ldns_rdf
 *
ldns_n£c3_ß…
(c⁄° 
ldns_º
 *
n£c3_º
);

335 
uöt8_t
 
ldns_n£c3_ß…_Àngth
(c⁄° 
ldns_º
 *
n£c3_º
);

342 
uöt8_t
 *
ldns_n£c3_ß…_d©a
(c⁄° 
ldns_º
 *
n£c3_º
);

349 
ldns_rdf
 *
ldns_n£c3_√xt_ow√r
(c⁄° 
ldns_º
 *
n£c3_º
);

356 
ldns_rdf
 *
ldns_n£c3_bôm≠
(c⁄° 
ldns_º
 *
n£c3_º
);

364 
ldns_rdf
 *
ldns_n£c3_hash_«me_‰m_n£c3
(c⁄° 
ldns_º
 *
n£c
,Üdns_rd‡*
«me
);

372 
boﬁ
 
ldns_n£c_bôm≠_covîs_ty≥
(c⁄° 
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
);

381 
ldns_°©us
 
ldns_n£c_bôm≠_£t_ty≥
(
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
);

390 
ldns_°©us
 
ldns_n£c_bôm≠_˛ór_ty≥
(
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
);

402 
boﬁ
 
ldns_n£c_covîs_«me
(c⁄° 
ldns_º
 *
n£c
, c⁄° 
ldns_rdf
 *
«me
);

404 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


416 
ldns_°©us
 
ldns_pkt_vîify
(
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_rdf
 *
o
, 
ldns_º_li°
 *
k
,Üdns_º_li° *
s
,Üdns_º_li° *
good_keys
);

430 
ldns_°©us
 
ldns_pkt_vîify_time
(
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_rdf
 *
o
, 
ldns_º_li°
 *
k
,Üdns_º_li° *
s
, 
time_t
 
check_time
,Üdns_º_li° *
good_keys
);

437 
ldns_°©us


438 
ldns_dns£c_chaö_n£c3_li°
(
ldns_º_li°
 *
n£c3_ºs
);

444 
qs‹t_º_com∑ª_n£c3
(c⁄° *
a
, c⁄° *
b
);

450 
ldns_º_li°_s‹t_n£c3
(
ldns_º_li°
 *
uns‹ãd
);

459 
ldns_dns£c_deÁu…_add_to_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

467 
ldns_dns£c_deÁu…_Àave_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

475 
ldns_dns£c_deÁu…_dñëe_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

483 
ldns_dns£c_deÁu…_ª∂a˚_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

485 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


494 
ldns_rdf
 *

495 
ldns_c⁄vît_dß_ºsig_a¢12rdf
(c⁄° 
ldns_buf„r
 *
sig
,

496 c⁄° 
sig_Àn
);

506 
ldns_°©us


507 
ldns_c⁄vît_dß_ºsig_rdf2a¢1
(
ldns_buf„r
 *
èrgë_buf„r
,

508 c⁄° 
ldns_rdf
 *
sig_rdf
);

519 
ldns_rdf
 *

520 
ldns_c⁄vît_ecdß_ºsig_a¢12rdf
(c⁄° 
ldns_buf„r
 *
sig
, c⁄° 
sig_Àn
);

531 
ldns_°©us


532 
ldns_c⁄vît_ecdß_ºsig_rdf2a¢1
(
ldns_buf„r
 *
èrgë_buf„r
,

533 c⁄° 
ldns_rdf
 *
sig_rdf
);

537 #ifde‡
__˝lu•lus


	@include/ldns/dnssec_sign.h

3 #i‚de‡
LDNS_DNSSEC_SIGN_H


4 
	#LDNS_DNSSEC_SIGN_H


	)

6 
	~<ldns/dns£c.h
>

8 #ifde‡
__˝lu•lus


15 
	#LDNS_SIGN_DNSKEY_WITH_ZSK
 1

	)

23 
ldns_º
 *

24 
ldns_¸óã_em±y_ºsig
(
ldns_º_li°
 *
º£t
,

25 
ldns_key
 *
key
);

34 
ldns_rdf
 *

35 
ldns_sign_public_buf„r
(
ldns_buf„r
 *
sign_buf
, 
ldns_key
 *
key
);

43 
ldns_º_li°
 *
ldns_sign_public
÷dns_º_li° *
º£t
, 
ldns_key_li°
 *
keys
);

45 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


52 
ldns_rdf
 *
ldns_sign_public_dß
(
ldns_buf„r
 *
to_sign
, 
DSA
 *
key
);

64 
ldns_rdf
 *
ldns_sign_public_evp
(
ldns_buf„r
 *
to_sign
,

65 
EVP_PKEY
 *
key
,

66 c⁄° 
EVP_MD
 *
dige°_ty≥
);

74 
ldns_rdf
 *
ldns_sign_public_rßsha1
(
ldns_buf„r
 *
to_sign
, 
RSA
 *
key
);

82 
ldns_rdf
 *
ldns_sign_public_rßmd5
(
ldns_buf„r
 *
to_sign
, 
RSA
 *
key
);

99 
ldns_°©us


100 
ldns_dns£c_z⁄e_m¨k_™d_gë_glue
(

101 
ldns_dns£c_z⁄e
 *
z⁄e
, 
ldns_º_li°
 *
glue_li°
);

113 
ldns_°©us


114 
ldns_dns£c_z⁄e_m¨k_glue
(
ldns_dns£c_z⁄e
 *
z⁄e
);

124 
ldns_rbnode_t
 *
ldns_dns£c_«me_node_√xt_n⁄glue
÷dns_rbnode_à*
node
);

134 
ldns_°©us
 
ldns_dns£c_z⁄e_¸óã_n£cs
(
ldns_dns£c_z⁄e
 *
z⁄e
,

135 
ldns_º_li°
 *
√w_ºs
);

140 
ldns_°©us


141 
ldns_dns£c_z⁄e_¸óã_n£c3s
(
ldns_dns£c_z⁄e
 *
z⁄e
,

142 
ldns_º_li°
 *
√w_ºs
,

143 
uöt8_t
 
Æg‹ôhm
,

144 
uöt8_t
 
Êags
,

145 
uöt16_t
 
ôî©i⁄s
,

146 
uöt8_t
 
ß…_Àngth
,

147 
uöt8_t
 *
ß…
);

163 
ldns_dns£c_ºs
 *
ldns_dns£c_ªmove_sig«tuªs
÷dns_dns£c_º†*
sig«tuªs
,

164 
ldns_key_li°
 *
key_li°
,

165 (*
func
)(
ldns_º
 *, *),

166 *
¨g
);

186 
ldns_°©us
 
ldns_dns£c_z⁄e_¸óã_ºsigs_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

187 
ldns_º_li°
 *
√w_ºs
,

188 
ldns_key_li°
 *
key_li°
,

189 (*
func
)(
ldns_º
 *, *),

190 *
¨g
,

191 
Êags
);

206 
ldns_°©us
 
ldns_dns£c_z⁄e_¸óã_ºsigs
(
ldns_dns£c_z⁄e
 *
z⁄e
,

207 
ldns_º_li°
 *
√w_ºs
,

208 
ldns_key_li°
 *
key_li°
,

209 (*
func
)(
ldns_º
 *, *),

210 *
¨g
);

237 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

238 
ldns_º_li°
 *
√w_ºs
,

239 
ldns_key_li°
 *
key_li°
,

240 (*
func
)(
ldns_º
 *, *),

241 *
¨g
,

242 
Êags
);

260 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_n£c3_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

261 
ldns_º_li°
 *
√w_ºs
,

262 
ldns_key_li°
 *
key_li°
,

263 (*
func
)(
ldns_º
 *, *),

264 *
¨g
,

265 
uöt8_t
 
Æg‹ôhm
,

266 
uöt8_t
 
Êags
,

267 
uöt16_t
 
ôî©i⁄s
,

268 
uöt8_t
 
ß…_Àngth
,

269 
uöt8_t
 *
ß…
,

270 
signÊags
);

291 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_n£c3_Êg_mkm≠
(
ldns_dns£c_z⁄e
 *
z⁄e
,

292 
ldns_º_li°
 *
√w_ºs
,

293 
ldns_key_li°
 *
key_li°
,

294 (*
func
)(
ldns_º
 *, *),

295 *
¨g
,

296 
uöt8_t
 
Æg‹ôhm
,

297 
uöt8_t
 
Êags
,

298 
uöt16_t
 
ôî©i⁄s
,

299 
uöt8_t
 
ß…_Àngth
,

300 
uöt8_t
 *
ß…
,

301 
signÊags
,

302 
ldns_rbåì_t
 **
m≠


326 
ldns_°©us
 
ldns_dns£c_z⁄e_sign
(
ldns_dns£c_z⁄e
 *
z⁄e
,

327 
ldns_º_li°
 *
√w_ºs
,

328 
ldns_key_li°
 *
key_li°
,

329 (*
func
)(
ldns_º
 *, *),

330 *
¨g
);

347 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_n£c3
(
ldns_dns£c_z⁄e
 *
z⁄e
,

348 
ldns_º_li°
 *
√w_ºs
,

349 
ldns_key_li°
 *
key_li°
,

350 (*
func
)(
ldns_º
 *, *),

351 *
¨g
,

352 
uöt8_t
 
Æg‹ôhm
,

353 
uöt8_t
 
Êags
,

354 
uöt16_t
 
ôî©i⁄s
,

355 
uöt8_t
 
ß…_Àngth
,

356 
uöt8_t
 *
ß…
);

364 
ldns_z⁄e
 *
ldns_z⁄e_sign
(c⁄°Üdns_z⁄ê*
z⁄e
, 
ldns_key_li°
 *
key_li°
);

377 
ldns_z⁄e
 *
ldns_z⁄e_sign_n£c3
÷dns_z⁄ê*
z⁄e
, 
ldns_key_li°
 *
key_li°
, 
uöt8_t
 
Æg‹ôhm
, uöt8_à
Êags
, 
uöt16_t
 
ôî©i⁄s
, uöt8_à
ß…_Àngth
, uöt8_à*
ß…
);

379 #ifde‡
__˝lu•lus


	@include/ldns/dnssec_verify.h

3 #i‚de‡
LDNS_DNSSEC_VERIFY_H


4 
	#LDNS_DNSSEC_VERIFY_H


	)

6 
	#LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
 10

	)

8 
	~<ldns/dns£c.h
>

9 
	~<ldns/ho°2°r.h
>

11 #ifde‡
__˝lu•lus


19 
ldns_dns£c_d©a_chaö_°ru˘
 
	tldns_dns£c_d©a_chaö
;

20 
	sldns_dns£c_d©a_chaö_°ru˘


22 
ldns_º_li°
 *
º£t
;

23 
ldns_º_li°
 *
sig«tuªs
;

24 
ldns_º_ty≥
 
∑ª¡_ty≥
;

25 
ldns_dns£c_d©a_chaö
 *
∑ª¡
;

26 
ldns_pkt_rcode
 
∑ckë_rcode
;

27 
ldns_º_ty≥
 
∑ckë_qty≥
;

28 
boﬁ
 
∑ckë_nod©a
;

35 
ldns_dns£c_d©a_chaö
 *
ldns_dns£c_d©a_chaö_√w
();

42 
ldns_dns£c_d©a_chaö_‰ì
(
ldns_dns£c_d©a_chaö
 *
chaö
);

50 
ldns_dns£c_d©a_chaö_dìp_‰ì
(
ldns_dns£c_d©a_chaö
 *
chaö
);

58 
ldns_dns£c_d©a_chaö_¥öt
(
FILE
 *
out
, c⁄° 
ldns_dns£c_d©a_chaö
 *
chaö
);

67 
ldns_dns£c_d©a_chaö_¥öt_fmt
(
FILE
 *
out
,

68 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

69 c⁄° 
ldns_dns£c_d©a_chaö
 *
chaö
);

86 
ldns_dns£c_d©a_chaö
 *
ldns_dns£c_buûd_d©a_chaö
(
ldns_ªsﬁvî
 *
ªs
,

87 c⁄° 
uöt16_t
 
qÊags
,

88 c⁄° 
ldns_º_li°
 *
d©a_£t
,

89 c⁄° 
ldns_pkt
 *
pkt
,

90 
ldns_º
 *
‹ig_º
);

121 
ldns_dns£c_åu°_åì_°ru˘
 
	tldns_dns£c_åu°_åì
;

122 
	sldns_dns£c_åu°_åì_°ru˘


124 
ldns_º
 *
º
;

126 
ldns_º_li°
 *
º£t
;

127 
ldns_dns£c_åu°_åì
 *
∑ª¡s
[
LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
];

128 
ldns_°©us
 
∑ª¡_°©us
[
LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
];

131 
ldns_º
 *
∑ª¡_sig«tuª
[
LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
];

132 
size_t
 
∑ª¡_cou¡
;

140 
ldns_dns£c_åu°_åì
 *
ldns_dns£c_åu°_åì_√w
();

150 
ldns_dns£c_åu°_åì_‰ì
(
ldns_dns£c_åu°_åì
 *
åì
);

158 
size_t
 
ldns_dns£c_åu°_åì_dïth
(
ldns_dns£c_åu°_åì
 *
åì
);

172 
ldns_dns£c_åu°_åì_¥öt
(
FILE
 *
out
,

173 
ldns_dns£c_åu°_åì
 *
åì
,

174 
size_t
 
èbs
,

175 
boﬁ
 
exãnded
);

190 
ldns_dns£c_åu°_åì_¥öt_fmt
(
FILE
 *
out
,

191 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

192 
ldns_dns£c_åu°_åì
 *
åì
,

193 
size_t
 
èbs
,

194 
boﬁ
 
exãnded
);

206 
ldns_°©us
 
ldns_dns£c_åu°_åì_add_∑ª¡
(
ldns_dns£c_åu°_åì
 *
åì
,

207 c⁄° 
ldns_dns£c_åu°_åì
 *
∑ª¡
,

208 c⁄° 
ldns_º
 *
∑ª¡_sig«tuª
,

209 c⁄° 
ldns_°©us
 
∑ª¡_°©us
);

222 
ldns_dns£c_åu°_åì
 *
ldns_dns£c_dîive_åu°_åì
(

223 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

224 
ldns_º
 *
º
);

238 
ldns_dns£c_åu°_åì
 *
ldns_dns£c_dîive_åu°_åì_time
(

239 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

240 
ldns_º
 *
º
, 
time_t
 
check_time
);

249 
ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t
(

250 
ldns_dns£c_åu°_åì
 *
√w_åì
,

251 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

252 
ldns_º
 *
cur_sig_º
);

262 
ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t_time
(

263 
ldns_dns£c_åu°_åì
 *
√w_åì
,

264 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

265 
ldns_º
 *
cur_sig_º
, 
time_t
 
check_time
);

276 
ldns_dns£c_dîive_åu°_åì_dnskey_º£t
(

277 
ldns_dns£c_åu°_åì
 *
√w_åì
,

278 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

279 
ldns_º
 *
cur_º
,

280 
ldns_º
 *
cur_sig_º
);

291 
ldns_dns£c_dîive_åu°_åì_dnskey_º£t_time
(

292 
ldns_dns£c_åu°_åì
 *
√w_åì
,

293 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

294 
ldns_º
 *
cur_º
,Üdns_º *
cur_sig_º
,

295 
time_t
 
check_time
);

307 
ldns_dns£c_dîive_åu°_åì_dnskey_º£t_time
(

308 
ldns_dns£c_åu°_åì
 *
√w_åì
,

309 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

310 
ldns_º
 *
cur_º
,Üdns_º *
cur_sig_º
,

311 
time_t
 
check_time
);

321 
ldns_dns£c_dîive_åu°_åì_ds_º£t
(

322 
ldns_dns£c_åu°_åì
 *
√w_åì
,

323 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

324 
ldns_º
 *
cur_º
);

334 
ldns_dns£c_dîive_åu°_åì_ds_º£t_time
(

335 
ldns_dns£c_åu°_åì
 *
√w_åì
,

336 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

337 
ldns_º
 *
cur_º
, 
time_t
 
check_time
);

346 
ldns_dns£c_dîive_åu°_åì_no_sig
(

347 
ldns_dns£c_åu°_åì
 *
√w_åì
,

348 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
);

358 
ldns_dns£c_dîive_åu°_åì_no_sig_time
(

359 
ldns_dns£c_åu°_åì
 *
√w_åì
,

360 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

361 
time_t
 
check_time
);

375 
ldns_°©us
 
ldns_dns£c_åu°_åì_c⁄èös_keys
(

376 
ldns_dns£c_åu°_åì
 *
åì
,

377 
ldns_º_li°
 *
keys
);

390 
ldns_°©us
 
ldns_vîify
(
ldns_º_li°
 *
º£t
,

391 
ldns_º_li°
 *
ºsig
,

392 c⁄° 
ldns_º_li°
 *
keys
,

393 
ldns_º_li°
 *
good_keys
);

407 
ldns_°©us
 
ldns_vîify_time
(
ldns_º_li°
 *
º£t
,

408 
ldns_º_li°
 *
ºsig
,

409 c⁄° 
ldns_º_li°
 *
keys
,

410 
time_t
 
check_time
,

411 
ldns_º_li°
 *
good_keys
);

426 
ldns_°©us
 
ldns_vîify_nŸime
(
ldns_º_li°
 *
º£t
,

427 
ldns_º_li°
 *
ºsig
,

428 c⁄° 
ldns_º_li°
 *
keys
,

429 
ldns_º_li°
 *
good_keys
);

445 
ldns_º_li°
 *
ldns_„tch_vÆid_domaö_keys
(c⁄° 
ldns_ªsﬁvî
 * 
ªs
,

446 c⁄° 
ldns_rdf
 * 
domaö
,

447 c⁄° 
ldns_º_li°
 * 
keys
,

448 
ldns_°©us
 *
°©us
);

465 
ldns_º_li°
 *
ldns_„tch_vÆid_domaö_keys_time
(c⁄° 
ldns_ªsﬁvî
 * 
ªs
,

466 c⁄° 
ldns_rdf
 * 
domaö
, c⁄° 
ldns_º_li°
 * 
keys
,

467 
time_t
 
check_time
, 
ldns_°©us
 *
°©us
);

480 
ldns_º_li°
 *
ldns_vÆid©e_domaö_dnskey
 (c⁄° 
ldns_ªsﬁvî
 *
ªs
,

481 c⁄° 
ldns_rdf
 *
domaö
,

482 c⁄° 
ldns_º_li°
 *
keys
);

495 
ldns_º_li°
 *
ldns_vÆid©e_domaö_dnskey_time
(

496 c⁄° 
ldns_ªsﬁvî
 *
ªs
, c⁄° 
ldns_rdf
 *
domaö
,

497 c⁄° 
ldns_º_li°
 *
keys
, 
time_t
 
check_time
);

508 
ldns_º_li°
 *
ldns_vÆid©e_domaö_ds
(c⁄° 
ldns_ªsﬁvî
 *
ªs
,

509 c⁄° 
ldns_rdf
 *

510 
domaö
,

511 c⁄° 
ldns_º_li°
 * 
keys
);

522 
ldns_º_li°
 *
ldns_vÆid©e_domaö_ds_time
(

523 c⁄° 
ldns_ªsﬁvî
 *
ªs
, c⁄° 
ldns_rdf
 *
domaö
,

524 c⁄° 
ldns_º_li°
 * 
keys
, 
time_t
 
check_time
);

538 
ldns_°©us
 
ldns_vîify_åu°ed
(
ldns_ªsﬁvî
 *
ªs
,

539 
ldns_º_li°
 *
º£t
,

540 
ldns_º_li°
 *
ºsigs
,

541 
ldns_º_li°
 *
vÆid©ög_keys
);

555 
ldns_°©us
 
ldns_vîify_åu°ed_time
(

556 
ldns_ªsﬁvî
 *
ªs
, 
ldns_º_li°
 *
º£t
,

557 
ldns_º_li°
 *
ºsigs
, 
time_t
 
check_time
,

558 
ldns_º_li°
 *
vÆid©ög_keys
);

571 
ldns_°©us
 
ldns_dns£c_vîify_díül
(
ldns_º
 *
º
,

572 
ldns_º_li°
 *
n£cs
,

573 
ldns_º_li°
 *
ºsigs
);

592 
ldns_°©us
 
ldns_dns£c_vîify_díül_n£c3
(
ldns_º
 *
º
,

593 
ldns_º_li°
 *
n£cs
,

594 
ldns_º_li°
 *
ºsigs
,

595 
ldns_pkt_rcode
 
∑ckë_rcode
,

596 
ldns_º_ty≥
 
∑ckë_qty≥
,

597 
boﬁ
 
∑ckë_nod©a
);

617 
ldns_°©us
 
ldns_dns£c_vîify_díül_n£c3_m©ch
(
ldns_º
 *
º
,

618 
ldns_º_li°
 *
n£cs
,

619 
ldns_º_li°
 *
ºsigs
,

620 
ldns_pkt_rcode
 
∑ckë_rcode
,

621 
ldns_º_ty≥
 
∑ckë_qty≥
,

622 
boﬁ
 
∑ckë_nod©a
,

623 
ldns_º
 **
m©ch
);

634 
ldns_°©us
 
ldns_vîify_ºsig_buf„rs
(
ldns_buf„r
 *
øwsig_buf
,

635 
ldns_buf„r
 *
vîify_buf
,

636 
ldns_buf„r
 *
key_buf
,

637 
uöt8_t
 
Ægo
);

650 
ldns_°©us
 
ldns_vîify_ºsig_buf„rs_øw
(* 
sig
,

651 
size_t
 
sigÀn
,

652 
ldns_buf„r
 *
vîify_buf
,

653 * 
key
,

654 
size_t
 
keyÀn
,

655 
uöt8_t
 
Ægo
);

668 
ldns_°©us
 
ldns_vîify_ºsig_keyli°
(
ldns_º_li°
 *
º£t
,

669 
ldns_º
 *
ºsig
,

670 c⁄° 
ldns_º_li°
 *
keys
,

671 
ldns_º_li°
 *
good_keys
);

685 
ldns_°©us
 
ldns_vîify_ºsig_keyli°_time
(

686 
ldns_º_li°
 *
º£t
, 
ldns_º
 *
ºsig
,

687 c⁄° 
ldns_º_li°
 *
keys
, 
time_t
 
check_time
,

688 
ldns_º_li°
 *
good_keys
);

702 
ldns_°©us
 
ldns_vîify_ºsig_keyli°_nŸime
(
ldns_º_li°
 *
º£t
,

703 
ldns_º
 *
ºsig
,

704 c⁄° 
ldns_º_li°
 *
keys
,

705 
ldns_º_li°
 *
good_keys
);

714 
ldns_°©us
 
ldns_vîify_ºsig
(
ldns_º_li°
 *
º£t
,

715 
ldns_º
 *
ºsig
,

716 
ldns_º
 *
key
);

727 
ldns_°©us
 
ldns_vîify_ºsig_time
(

728 
ldns_º_li°
 *
º£t
, 
ldns_º
 *
ºsig
,

729 
ldns_º
 *
key
, 
time_t
 
check_time
);

732 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


742 
ldns_°©us
 
ldns_vîify_ºsig_evp
(
ldns_buf„r
 *
sig
,

743 
ldns_buf„r
 *
º£t
,

744 
EVP_PKEY
 *
key
,

745 c⁄° 
EVP_MD
 *
dige°_ty≥
);

755 
ldns_°©us
 
ldns_vîify_ºsig_evp_øw
(*
sig
,

756 
size_t
 
sigÀn
,

757 
ldns_buf„r
 *
º£t
,

758 
EVP_PKEY
 *
key
,

759 c⁄° 
EVP_MD
 *
dige°_ty≥
);

770 
ldns_°©us
 
ldns_vîify_ºsig_dß
(
ldns_buf„r
 *
sig
,

771 
ldns_buf„r
 *
º£t
,

772 
ldns_buf„r
 *
key
);

782 
ldns_°©us
 
ldns_vîify_ºsig_rßsha1
(
ldns_buf„r
 *
sig
,

783 
ldns_buf„r
 *
º£t
,

784 
ldns_buf„r
 *
key
);

794 
ldns_°©us
 
ldns_vîify_ºsig_rßmd5
(
ldns_buf„r
 *
sig
,

795 
ldns_buf„r
 *
º£t
,

796 
ldns_buf„r
 *
key
);

806 
ldns_°©us
 
ldns_vîify_ºsig_dß_øw
(* 
sig
,

807 
size_t
 
sigÀn
,

808 
ldns_buf„r
* 
º£t
,

809 * 
key
,

810 
size_t
 
keyÀn
);

820 
ldns_°©us
 
ldns_vîify_ºsig_rßsha1_øw
(* 
sig
,

821 
size_t
 
sigÀn
,

822 
ldns_buf„r
* 
º£t
,

823 * 
key
,

824 
size_t
 
keyÀn
);

835 
ldns_°©us
 
ldns_vîify_ºsig_rßsha256_øw
(* 
sig
,

836 
size_t
 
sigÀn
,

837 
ldns_buf„r
* 
º£t
,

838 * 
key
,

839 
size_t
 
keyÀn
);

849 
ldns_°©us
 
ldns_vîify_ºsig_rßsha512_øw
(* 
sig
,

850 
size_t
 
sigÀn
,

851 
ldns_buf„r
* 
º£t
,

852 * 
key
,

853 
size_t
 
keyÀn
);

863 
ldns_°©us
 
ldns_vîify_ºsig_rßmd5_øw
(* 
sig
,

864 
size_t
 
sigÀn
,

865 
ldns_buf„r
* 
º£t
,

866 * 
key
,

867 
size_t
 
keyÀn
);

869 #ifde‡
__˝lu•lus


	@include/ldns/dnssec_zone.h

8 #i‚de‡
LDNS_DNSSEC_ZONE_H


9 
	#LDNS_DNSSEC_ZONE_H


	)

11 
	~<ldns/rbåì.h
>

12 
	~<ldns/ho°2°r.h
>

14 #ifde‡
__˝lu•lus


21 
ldns_°ru˘_dns£c_ºs
 
	tldns_dns£c_ºs
;

22 
	sldns_°ru˘_dns£c_ºs


24 
ldns_º
 *
º
;

25 
ldns_dns£c_ºs
 *
√xt
;

31 
ldns_°ru˘_dns£c_º£ts
 
	tldns_dns£c_º£ts
;

32 
	sldns_°ru˘_dns£c_º£ts


34 
ldns_dns£c_ºs
 *
ºs
;

35 
ldns_º_ty≥
 
ty≥
;

36 
ldns_dns£c_ºs
 *
sig«tuªs
;

37 
ldns_dns£c_º£ts
 *
√xt
;

44 
ldns_°ru˘_dns£c_«me
 
	tldns_dns£c_«me
;

45 
	sldns_°ru˘_dns£c_«me


51 
ldns_rdf
 *
«me
;

59 
boﬁ
 
«me_Ælo˚d
;

63 
ldns_dns£c_º£ts
 *
º£ts
;

67 
ldns_º
 *
n£c
;

71 
ldns_dns£c_ºs
 *
n£c_sig«tuªs
;

81 
boﬁ
 
is_glue
;

85 
ldns_rdf
 *
hashed_«me
;

91 
	sldns_°ru˘_dns£c_z⁄e
 {

93 
ldns_dns£c_«me
 *
sﬂ
;

95 
ldns_rbåì_t
 *
«mes
;

97 
ldns_rbåì_t
 *
hashed_«mes
;

102 
ldns_º
 *
_n£c3∑øms
;

104 
ldns_°ru˘_dns£c_z⁄e
 
	tldns_dns£c_z⁄e
;

110 
ldns_dns£c_ºs
 *
ldns_dns£c_ºs_√w
();

118 
ldns_dns£c_ºs_‰ì
(
ldns_dns£c_ºs
 *
ºs
);

126 
ldns_dns£c_ºs_dìp_‰ì
(
ldns_dns£c_ºs
 *
ºs
);

136 
ldns_°©us
 
ldns_dns£c_ºs_add_º
(
ldns_dns£c_ºs
 *
ºs
, 
ldns_º
 *
º
);

144 
ldns_dns£c_ºs_¥öt
(
FILE
 *
out
, 
ldns_dns£c_ºs
 *
ºs
);

153 
ldns_dns£c_ºs_¥öt_fmt
(
FILE
 *
out
,

154 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, 
ldns_dns£c_ºs
 *
ºs
);

160 
ldns_dns£c_º£ts
 *
ldns_dns£c_º£ts_√w
();

168 
ldns_dns£c_º£ts_‰ì
(
ldns_dns£c_º£ts
 *
º£ts
);

176 
ldns_dns£c_º£ts_dìp_‰ì
(
ldns_dns£c_º£ts
 *
º£ts
);

184 
ldns_º_ty≥
 
ldns_dns£c_º£ts_ty≥
(
ldns_dns£c_º£ts
 *
º£ts
);

193 
ldns_°©us
 
ldns_dns£c_º£ts_£t_ty≥
(
ldns_dns£c_º£ts
 *
º£ts
,

194 
ldns_º_ty≥
 
ty≥
);

204 
ldns_°©us
 
ldns_dns£c_º£ts_add_º
(
ldns_dns£c_º£ts
 *
º£ts
, 
ldns_º
 *
º
);

213 
ldns_dns£c_º£ts_¥öt
(
FILE
 *
out
,

214 
ldns_dns£c_º£ts
 *
º£ts
,

215 
boﬁ
 
fﬁlow
);

225 
ldns_dns£c_º£ts_¥öt_fmt
(
FILE
 *
out
,

226 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

227 
ldns_dns£c_º£ts
 *
º£ts
,

228 
boﬁ
 
fﬁlow
);

235 
ldns_dns£c_«me
 *
ldns_dns£c_«me_√w
();

242 
ldns_dns£c_«me
 *
ldns_dns£c_«me_√w_‰m_º
(
ldns_º
 *
º
);

250 
ldns_dns£c_«me_‰ì
(
ldns_dns£c_«me
 *
«me
);

258 
ldns_dns£c_«me_dìp_‰ì
(
ldns_dns£c_«me
 *
«me
);

266 
ldns_rdf
 *
ldns_dns£c_«me_«me
(
ldns_dns£c_«me
 *
«me
);

275 
ldns_dns£c_«me_£t_«me
(
ldns_dns£c_«me
 *
«me
,

276 
ldns_rdf
 *
d«me
);

288 
boﬁ
 
ldns_dns£c_«me_is_glue
(
ldns_dns£c_«me
 *
«me
);

296 
ldns_dns£c_«me_£t_n£c
(
ldns_dns£c_«me
 *
«me
, 
ldns_º
 *
n£c
);

308 
ldns_dns£c_«me_cmp
(c⁄° *
a
, c⁄° *
b
);

318 
ldns_°©us
 
ldns_dns£c_«me_add_º
(
ldns_dns£c_«me
 *
«me
,

319 
ldns_º
 *
º
);

328 
ldns_dns£c_º£ts
 *
ldns_dns£c_«me_föd_º£t
(
ldns_dns£c_«me
 *
«me
,

329 
ldns_º_ty≥
 
ty≥
);

339 
ldns_dns£c_º£ts
 *
ldns_dns£c_z⁄e_föd_º£t
(
ldns_dns£c_z⁄e
 *
z⁄e
,

340 
ldns_rdf
 *
d«me
,

341 
ldns_º_ty≥
 
ty≥
);

350 
ldns_dns£c_«me_¥öt
(
FILE
 *
out
, 
ldns_dns£c_«me
 *
«me
);

360 
ldns_dns£c_«me_¥öt_fmt
(
FILE
 *
out
,

361 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, 
ldns_dns£c_«me
 *
«me
);

367 
ldns_dns£c_z⁄e
 *
ldns_dns£c_z⁄e_√w
();

379 
ldns_°©us
 
ldns_dns£c_z⁄e_√w_‰m_Â
(
ldns_dns£c_z⁄e
** 
z
, 
FILE
* 
Â
,

380 
ldns_rdf
* 
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
);

393 
ldns_°©us
 
ldns_dns£c_z⁄e_√w_‰m_Â_l
(
ldns_dns£c_z⁄e
** 
z
, 
FILE
* 
Â
,

394 
ldns_rdf
* 
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
, * 
löe_ƒ
);

401 
ldns_dns£c_z⁄e_‰ì
(
ldns_dns£c_z⁄e
 *
z⁄e
);

408 
ldns_dns£c_z⁄e_dìp_‰ì
(
ldns_dns£c_z⁄e
 *
z⁄e
);

420 
ldns_°©us
 
ldns_dns£c_z⁄e_add_º
(
ldns_dns£c_z⁄e
 *
z⁄e
,

421 
ldns_º
 *
º
);

430 
ldns_dns£c_z⁄e_«mes_¥öt
(
FILE
 *
out
, 
ldns_rbåì_t
 *
åì
, 
boﬁ
 
¥öt_sﬂ
);

440 
ldns_dns£c_z⁄e_«mes_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

441 
ldns_rbåì_t
 *
åì
, 
boﬁ
 
¥öt_sﬂ
);

449 
ldns_dns£c_z⁄e_¥öt
(
FILE
 *
out
, 
ldns_dns£c_z⁄e
 *
z⁄e
);

458 
ldns_dns£c_z⁄e_¥öt_fmt
(
FILE
 *
out
,

459 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, 
ldns_dns£c_z⁄e
 *
z⁄e
);

468 
ldns_°©us
 
ldns_dns£c_z⁄e_add_em±y_n⁄ãrmöÆs
(
ldns_dns£c_z⁄e
 *
z⁄e
);

477 
boﬁ
 
ldns_dns£c_z⁄e_is_n£c3_›tout
(
ldns_dns£c_z⁄e
* 
z⁄e
);

479 #ifde‡
__˝lu•lus


	@include/ldns/duration.h

40 #i‚de‡
LDNS_DURATION_H


41 
	#LDNS_DURATION_H


	)

43 
	~<°döt.h
>

44 
	~<time.h
>

50 
ldns_duøti⁄_°ru˘
 
	tldns_duøti⁄_ty≥
;

51 
	sldns_duøti⁄_°ru˘


53 
time_t
 
	myórs
;

54 
time_t
 
	mm⁄ths
;

55 
time_t
 
	mwìks
;

56 
time_t
 
	mdays
;

57 
time_t
 
	mhours
;

58 
time_t
 
	mmöuãs
;

59 
time_t
 
	m£c⁄ds
;

67 
ldns_duøti⁄_ty≥
* 
ldns_duøti⁄_¸óã
();

76 
ldns_duøti⁄_com∑ª
(
ldns_duøti⁄_ty≥
* 
d1
,Üdns_duøti⁄_ty≥* 
d2
);

84 
ldns_duøti⁄_ty≥
* 
ldns_duøti⁄_¸óã_‰om_°rög
(c⁄° * 
°r
);

92 * 
ldns_duøti⁄2°rög
(
ldns_duøti⁄_ty≥
* 
duøti⁄
);

100 
time_t
 
ldns_duøti⁄2time
(
ldns_duøti⁄_ty≥
* 
duøti⁄
);

107 
ldns_duøti⁄_˛ónup
(
ldns_duøti⁄_ty≥
* 
duøti⁄
);

	@include/ldns/error.h

16 #i‚de‡
LDNS_ERROR_H


17 
	#LDNS_ERROR_H


	)

19 
	~<ldns/utû.h
>

21 #ifde‡
__˝lu•lus


25 
	eldns_íum_°©us
 {

26 
LDNS_STATUS_OK
,

27 
LDNS_STATUS_EMPTY_LABEL
,

28 
LDNS_STATUS_LABEL_OVERFLOW
,

29 
LDNS_STATUS_DOMAINNAME_OVERFLOW
,

30 
LDNS_STATUS_DOMAINNAME_UNDERFLOW
,

31 
LDNS_STATUS_DDD_OVERFLOW
,

32 
LDNS_STATUS_PACKET_OVERFLOW
,

33 
LDNS_STATUS_INVALID_POINTER
,

34 
LDNS_STATUS_MEM_ERR
,

35 
LDNS_STATUS_INTERNAL_ERR
,

36 
LDNS_STATUS_SSL_ERR
,

37 
LDNS_STATUS_ERR
,

38 
LDNS_STATUS_INVALID_INT
,

39 
LDNS_STATUS_INVALID_IP4
,

40 
LDNS_STATUS_INVALID_IP6
,

41 
LDNS_STATUS_INVALID_STR
,

42 
LDNS_STATUS_INVALID_B32_EXT
,

43 
LDNS_STATUS_INVALID_B64
,

44 
LDNS_STATUS_INVALID_HEX
,

45 
LDNS_STATUS_INVALID_TIME
,

46 
LDNS_STATUS_NETWORK_ERR
,

47 
LDNS_STATUS_ADDRESS_ERR
,

48 
LDNS_STATUS_FILE_ERR
,

49 
LDNS_STATUS_UNKNOWN_INET
,

50 
LDNS_STATUS_NOT_IMPL
,

51 
LDNS_STATUS_NULL
,

52 
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
,

53 
LDNS_STATUS_CRYPTO_ALGO_NOT_IMPL
,

54 
LDNS_STATUS_CRYPTO_NO_RRSIG
,

55 
LDNS_STATUS_CRYPTO_NO_DNSKEY
,

56 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DNSKEY
,

57 
LDNS_STATUS_CRYPTO_NO_DS
,

58 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DS
,

59 
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
,

60 
LDNS_STATUS_CRYPTO_VALIDATED
,

61 
LDNS_STATUS_CRYPTO_BOGUS
,

62 
LDNS_STATUS_CRYPTO_SIG_EXPIRED
,

63 
LDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED
,

64 
LDNS_STATUS_CRYPTO_TSIG_BOGUS
,

65 
LDNS_STATUS_CRYPTO_TSIG_ERR
,

66 
LDNS_STATUS_CRYPTO_EXPIRATION_BEFORE_INCEPTION
,

67 
LDNS_STATUS_CRYPTO_TYPE_COVERED_ERR
,

68 
LDNS_STATUS_ENGINE_KEY_NOT_LOADED
,

69 
LDNS_STATUS_NSEC3_ERR
,

70 
LDNS_STATUS_RES_NO_NS
,

71 
LDNS_STATUS_RES_QUERY
,

72 
LDNS_STATUS_WIRE_INCOMPLETE_HEADER
,

73 
LDNS_STATUS_WIRE_INCOMPLETE_QUESTION
,

74 
LDNS_STATUS_WIRE_INCOMPLETE_ANSWER
,

75 
LDNS_STATUS_WIRE_INCOMPLETE_AUTHORITY
,

76 
LDNS_STATUS_WIRE_INCOMPLETE_ADDITIONAL
,

77 
LDNS_STATUS_NO_DATA
,

78 
LDNS_STATUS_CERT_BAD_ALGORITHM
,

79 
LDNS_STATUS_SYNTAX_TYPE_ERR
,

80 
LDNS_STATUS_SYNTAX_CLASS_ERR
,

81 
LDNS_STATUS_SYNTAX_TTL_ERR
,

82 
LDNS_STATUS_SYNTAX_INCLUDE_ERR_NOTIMPL
,

83 
LDNS_STATUS_SYNTAX_RDATA_ERR
,

84 
LDNS_STATUS_SYNTAX_DNAME_ERR
,

85 
LDNS_STATUS_SYNTAX_VERSION_ERR
,

86 
LDNS_STATUS_SYNTAX_ALG_ERR
,

87 
LDNS_STATUS_SYNTAX_KEYWORD_ERR
,

88 
LDNS_STATUS_SYNTAX_TTL
,

89 
LDNS_STATUS_SYNTAX_ORIGIN
,

90 
LDNS_STATUS_SYNTAX_INCLUDE
,

91 
LDNS_STATUS_SYNTAX_EMPTY
,

92 
LDNS_STATUS_SYNTAX_ITERATIONS_OVERFLOW
,

93 
LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
,

94 
LDNS_STATUS_SYNTAX_INTEGER_OVERFLOW
,

95 
LDNS_STATUS_SYNTAX_BAD_ESCAPE
,

96 
LDNS_STATUS_SOCKET_ERROR
,

97 
LDNS_STATUS_SYNTAX_ERR
,

98 
LDNS_STATUS_DNSSEC_EXISTENCE_DENIED
,

99 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
,

100 
LDNS_STATUS_DNSSEC_NSEC_WILDCARD_NOT_COVERED
,

101 
LDNS_STATUS_DNSSEC_NSEC3_ORIGINAL_NOT_FOUND
,

102 
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
,

103 
LDNS_STATUS_MISSING_RDATA_FIELDS_KEY
,

104 
LDNS_STATUS_CRYPTO_SIG_EXPIRED_WITHIN_MARGIN
,

105 
LDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED_WITHIN_MARGIN
,

106 
LDNS_STATUS_DANE_STATUS_MESSAGES
,

107 
LDNS_STATUS_DANE_UNKNOWN_CERTIFICATE_USAGE
,

108 
LDNS_STATUS_DANE_UNKNOWN_SELECTOR
,

109 
LDNS_STATUS_DANE_UNKNOWN_MATCHING_TYPE
,

110 
LDNS_STATUS_DANE_UNKNOWN_PROTOCOL
,

111 
LDNS_STATUS_DANE_UNKNOWN_TRANSPORT
,

112 
LDNS_STATUS_DANE_MISSING_EXTRA_CERTS
,

113 
LDNS_STATUS_DANE_EXTRA_CERTS_NOT_USED
,

114 
LDNS_STATUS_DANE_OFFSET_OUT_OF_RANGE
,

115 
LDNS_STATUS_DANE_INSECURE
,

116 
LDNS_STATUS_DANE_BOGUS
,

117 
LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH
,

118 
LDNS_STATUS_DANE_NON_CA_CERTIFICATE
,

119 
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
,

120 
LDNS_STATUS_DANE_PKIX_NO_SELF_SIGNED_TRUST_ANCHOR
,

121 
LDNS_STATUS_EXISTS_ERR
,

122 
LDNS_STATUS_INVALID_ILNP64
,

123 
LDNS_STATUS_INVALID_EUI48
,

124 
LDNS_STATUS_INVALID_EUI64
,

125 
LDNS_STATUS_WIRE_RDATA_ERR
,

126 
LDNS_STATUS_INVALID_TAG
,

127 
LDNS_STATUS_TYPE_NOT_IN_BITMAP
,

128 
LDNS_STATUS_INVALID_RDF_TYPE
,

129 
LDNS_STATUS_RDATA_OVERFLOW
,

131 
ldns_íum_°©us
 
	tldns_°©us
;

133 
ldns_lookup_èbÀ
 
ldns_îr‹_°r
[];

141 c⁄° *
ldns_gë_îr‹°r_by_id
(
ldns_°©us
 
îr
);

143 #ifde‡
__˝lu•lus


	@include/ldns/higher.h

16 #i‚de‡
LDNS_HIGHER_H


17 
	#LDNS_HIGHER_H


	)

19 
	~<ldns/ªsﬁvî.h
>

20 
	~<ldns/rd©a.h
>

21 
	~<ldns/º.h
>

22 
	~<ldns/ho°2°r.h
>

23 
	~<ldns/tsig.h
>

25 #ifde‡
__˝lu•lus


37 
ldns_º_li°
 *
ldns_gë_º_li°_addr_by_«me
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
«me
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

47 
ldns_º_li°
 *
ldns_gë_º_li°_«me_by_addr
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
addr
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

56 
ldns_º_li°
 *
ldns_gë_º_li°_ho°s_‰m_Â
(
FILE
 *
Â
);

66 
ldns_º_li°
 *
ldns_gë_º_li°_ho°s_‰m_Â_l
(
FILE
 *
Â
, *
löe_ƒ
);

75 
ldns_º_li°
 *
ldns_gë_º_li°_ho°s_‰m_fûe
(*
fûíame
);

89 
uöt16_t
 
ldns_gëaddröfo
(
ldns_ªsﬁvî
 *
ªs
, 
ldns_rdf
 *
node
, 
ldns_º_˛ass
 
c
, 
ldns_º_li°
 **
li°
);

97 
boﬁ
 
ldns_n£c_ty≥_check
(
ldns_º
 *
n£c
, 
ldns_º_ty≥
 
t
);

107 
ldns_¥öt_º_rdf
(
FILE
 *
Â
, 
ldns_º
 *
r
, 
rd‚um
, ...);

109 #ifde‡
__˝lu•lus


	@include/ldns/host2str.h

18 #i‚de‡
LDNS_HOST2STR_H


19 
	#LDNS_HOST2STR_H


	)

21 
	~<ldns/comm⁄.h
>

22 
	~<ldns/îr‹.h
>

23 
	~<ldns/º.h
>

24 
	~<ldns/rd©a.h
>

25 
	~<ldns/∑ckë.h
>

26 
	~<ldns/buf„r.h
>

27 
	~<ldns/ªsﬁvî.h
>

28 
	~<ldns/z⁄e.h
>

29 
	~<˘y≥.h
>

31 
	~"ldns/utû.h
"

33 #ifde‡
__˝lu•lus


37 
	#LDNS_APL_IP4
 1

	)

38 
	#LDNS_APL_IP6
 2

	)

39 
	#LDNS_APL_MASK
 0x7f

	)

40 
	#LDNS_APL_NEGATION
 0x80

	)

48 
	#LDNS_COMMENT_NULLS
 (1 << 0)

	)

50 
	#LDNS_COMMENT_KEY_ID
 (1 << 1)

	)

52 
	#LDNS_COMMENT_KEY_TYPE
 (1 << 2)

	)

54 
	#LDNS_COMMENT_KEY_SIZE
 (1 << 3)

	)

56 
	#LDNS_COMMENT_BUBBLEBABBLE
 (1 << 4)

	)

58 
	#LDNS_COMMENT_FLAGS
 (1 << 5)

	)

60 
	#LDNS_COMMENT_NSEC3_CHAIN
 (1 << 6Ë

	)

62 
	#LDNS_COMMENT_LAYOUT
 (1 << 7)

	)

64 
	#LDNS_COMMENT_RRSIGS
 (1 << 8)

	)

65 
	#LDNS_FMT_ZEROIZE_RRSIGS
 (1 << 9)

	)

66 
	#LDNS_FMT_PAD_SOA_SERIAL
 (1 << 10)

	)

67 
	#LDNS_FMT_RFC3597
 (1 << 11Ë

	)

69 
	#LDNS_FMT_FLAGS_WITH_DATA
 2

	)

72 
	#LDNS_COMMENT_KEY
 (
LDNS_COMMENT_KEY_ID
 \

73 |
LDNS_COMMENT_KEY_TYPE
\

74 |
LDNS_COMMENT_KEY_SIZE
)

	)

86 
	sldns_°ru˘_ouçut_f‹m©


89 
Êags
;

91 *
d©a
;

93 
ldns_°ru˘_ouçut_f‹m©
 
	tldns_ouçut_f‹m©
;

100 
	sldns_°ru˘_ouçut_f‹m©_°‹age


101 { 
Êags
;

102 
ldns_rbåì_t
* 
hashm≠
;

103 
ldns_rdf
* 
bôm≠
;

105 
ldns_°ru˘_ouçut_f‹m©_°‹age
 
	tldns_ouçut_f‹m©_°‹age
;

111 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_nocommíts
;

116 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_⁄lykeyids
;

120 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_deÁu…
;

126 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_bubbÀbabbÀ
;

133 
INLINE


134 
ldns_ouçut_f‹m©
* 
ldns_ouçut_f‹m©_öô
(
ldns_ouçut_f‹m©_°‹age
* 
fmt
) {

135 
	gfmt
->
	gÊags
 = 
ldns_ouçut_f‹m©_deÁu…
->
Êags
;

136 
	gfmt
->
	ghashm≠
 = 
NULL
;

137 
	gfmt
->
	gbôm≠
 = 
NULL
;

138  (
	gldns_ouçut_f‹m©
*)
	gfmt
;

144 
INLINE
 
ldns_ouçut_f‹m©_£t
(
ldns_ouçut_f‹m©
* 
fmt
, 
Êag
) {

145 
	gfmt
->
	gÊags
 |
Êag
;

151 
INLINE
 
ldns_ouçut_f‹m©_˛ór
(
ldns_ouçut_f‹m©
* 
fmt
, 
Êag
) {

152 
	gfmt
->
	gÊags
 &!
Êag
;

162 
ldns_°©us


163 
ldns_ouçut_f‹m©_£t_ty≥
(
ldns_ouçut_f‹m©
* 
fmt
, 
ldns_º_ty≥
 
ty≥
);

174 
ldns_°©us


175 
ldns_ouçut_f‹m©_˛ór_ty≥
(
ldns_ouçut_f‹m©
* 
fmt
, 
ldns_º_ty≥
 
ty≥
);

184 
ldns_°©us


185 
ldns_pkt_›code2buf„r_°r
(
ldns_buf„r
 *
ouçut
, 
ldns_pkt_›code
 
›code
);

194 
ldns_°©us


195 
ldns_pkt_rcode2buf„r_°r
(
ldns_buf„r
 *
ouçut
, 
ldns_pkt_rcode
 
rcode
);

204 
ldns_°©us


205 
ldns_Æg‹ôhm2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

206 
ldns_Æg‹ôhm
 
Æg‹ôhm
);

215 
ldns_°©us


216 
ldns_˚π_Æg‹ôhm2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

217 
ldns_˚π_Æg‹ôhm
 
˚π_Æg‹ôhm
);

228 *
ldns_pkt_›code2°r
(
ldns_pkt_›code
 
›code
);

238 *
ldns_pkt_rcode2°r
(
ldns_pkt_rcode
 
rcode
);

248 *
ldns_pkt_Æg‹ôhm2°r
(
ldns_Æg‹ôhm
 
Æg‹ôhm
);

258 *
ldns_pkt_˚π_Æg‹ôhm2°r
(
ldns_˚π_Æg‹ôhm
 
˚π_Æg‹ôhm
);

266 
ldns_°©us
 
ldns_rdf2buf„r_°r_a
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

274 
ldns_°©us
 
ldns_rdf2buf„r_°r_ØØ
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

282 
ldns_°©us
 
ldns_rdf2buf„r_°r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

290 
ldns_°©us
 
ldns_rdf2buf„r_°r_b64
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

298 
ldns_°©us
 
ldns_rdf2buf„r_°r_b32_ext
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

306 
ldns_°©us
 
ldns_rdf2buf„r_°r_hex
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

314 
ldns_°©us
 
ldns_rdf2buf„r_°r_ty≥
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

322 
ldns_°©us
 
ldns_rdf2buf„r_°r_˛ass
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

330 
ldns_°©us
 
ldns_rdf2buf„r_°r_Æg
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

339 
ldns_°©us
 
ldns_º_ty≥2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

340 c⁄° 
ldns_º_ty≥
 
ty≥
);

350 *
ldns_º_ty≥2°r
(c⁄° 
ldns_º_ty≥
 
ty≥
);

359 
ldns_°©us
 
ldns_º_˛ass2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

360 c⁄° 
ldns_º_˛ass
 
kœss
);

370 *
ldns_º_˛ass2°r
(c⁄° 
ldns_º_˛ass
 
kœss
);

379 
ldns_°©us
 
ldns_rdf2buf„r_°r_˚π_Æg
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

387 
ldns_°©us
 
ldns_rdf2buf„r_°r_loc
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

395 
ldns_°©us
 
ldns_rdf2buf„r_°r_unknown
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

403 
ldns_°©us
 
ldns_rdf2buf„r_°r_nßp
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

411 
ldns_°©us
 
ldns_rdf2buf„r_°r_©ma
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

419 
ldns_°©us
 
ldns_rdf2buf„r_°r_wks
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

427 
ldns_°©us
 
ldns_rdf2buf„r_°r_n£c
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

435 
ldns_°©us
 
ldns_rdf2buf„r_°r_≥riod
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

443 
ldns_°©us
 
ldns_rdf2buf„r_°r_tsigtime
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

451 
ldns_°©us
 
ldns_rdf2buf„r_°r_≠l
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

459 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt16_d©a
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

467 
ldns_°©us
 
ldns_rdf2buf„r_°r_ù£ckey
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

477 
ldns_°©us
 
ldns_rdf2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

489 
ldns_°©us
 
ldns_º2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
º
);

503 
ldns_°©us
 
ldns_º2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

504 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
);

514 
ldns_°©us
 
ldns_pkt2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

525 
ldns_°©us
 
ldns_pkt2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

526 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
);

534 
ldns_°©us
 
ldns_rdf2buf„r_°r_n£c3_ß…
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

545 
ldns_°©us
 
ldns_key2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_key
 *
k
);

553 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt8
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

561 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt16
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

569 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt32
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

577 
ldns_°©us
 
ldns_rdf2buf„r_°r_time
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

586 
ldns_°©us
 
ldns_rdf2buf„r_°r_û≈64
(
ldns_buf„r
 *
ouçut
,

587 c⁄° 
ldns_rdf
 *
rdf
);

596 
ldns_°©us
 
ldns_rdf2buf„r_°r_eui48
(
ldns_buf„r
 *
ouçut
,

597 c⁄° 
ldns_rdf
 *
rdf
);

606 
ldns_°©us
 
ldns_rdf2buf„r_°r_eui64
(
ldns_buf„r
 *
ouçut
,

607 c⁄° 
ldns_rdf
 *
rdf
);

616 
ldns_°©us
 
ldns_rdf2buf„r_°r_èg
(
ldns_buf„r
 *
ouçut
,

617 c⁄° 
ldns_rdf
 *
rdf
);

626 
ldns_°©us
 
ldns_rdf2buf„r_°r_l⁄g_°r
(
ldns_buf„r
 *
ouçut
,

627 c⁄° 
ldns_rdf
 *
rdf
);

636 
ldns_°©us
 
ldns_rdf2buf„r_°r_hù
(
ldns_buf„r
 *
ouçut
,

637 c⁄° 
ldns_rdf
 *
rdf
);

647 *
ldns_rdf2°r
(c⁄° 
ldns_rdf
 *
rdf
);

657 *
ldns_º2°r
(c⁄° 
ldns_º
 *
º
);

668 *
ldns_º2°r_fmt
(c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
);

678 *
ldns_pkt2°r
(c⁄° 
ldns_pkt
 *
pkt
);

689 *
ldns_pkt2°r_fmt
(c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
);

699 *
ldns_key2°r
(c⁄° 
ldns_key
 *
k
);

709 *
ldns_º_li°2°r
(c⁄° 
ldns_º_li°
 *
º_li°
);

720 *
ldns_º_li°2°r_fmt
(

721 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
º_li°
);

731 *
ldns_buf„r2°r
(
ldns_buf„r
 *
buf„r
);

742 *
ldns_buf„r_exp‹t2°r
(
ldns_buf„r
 *
buf„r
);

752 
ldns_rdf_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

762 
ldns_º_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_º
 *
º
);

773 
ldns_º_¥öt_fmt
(
FILE
 *
ouçut
,

774 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
);

784 
ldns_pkt_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

795 
ldns_pkt_¥öt_fmt
(
FILE
 *
ouçut
,

796 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
);

805 
ldns_°©us
 
ldns_º_li°2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º_li°
 *
li°
);

815 
ldns_°©us
 
ldns_º_li°2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

816 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
li°
);

825 
ldns_°©us
 
ldns_pkthódî2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

832 
ldns_º_li°_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_º_li°
 *
li°
);

840 
ldns_º_li°_¥öt_fmt
(
FILE
 *
ouçut
,

841 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
li°
);

849 
ldns_ªsﬁvî_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_ªsﬁvî
 *
r
);

858 
ldns_ªsﬁvî_¥öt_fmt
(
FILE
 *
ouçut
,

859 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_ªsﬁvî
 *
r
);

867 
ldns_z⁄e_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_z⁄e
 *
z
);

876 
ldns_z⁄e_¥öt_fmt
(
FILE
 *
ouçut
,

877 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_z⁄e
 *
z
);

885 
ldns_°©us
 
ldns_rdf2buf„r_°r_d«me
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
d«me
);

887 #ifde‡
__˝lu•lus


	@include/ldns/host2wire.h

17 #i‚de‡
LDNS_HOST2WIRE_H


18 
	#LDNS_HOST2WIRE_H


	)

20 
	~<ldns/comm⁄.h
>

21 
	~<ldns/îr‹.h
>

22 
	~<ldns/º.h
>

23 
	~<ldns/rd©a.h
>

24 
	~<ldns/∑ckë.h
>

25 
	~<ldns/buf„r.h
>

26 
	~<˘y≥.h
>

28 
	~"ldns/utû.h
"

30 #ifde‡
__˝lu•lus


40 
ldns_°©us
 
ldns_d«me2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_rdf
 *
«me
);

48 
ldns_°©us
 
ldns_rdf2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

58 
ldns_°©us
 
ldns_rdf2buf„r_wúe_ˇn⁄iˇl
(
ldns_buf„r
 *
ouçut
,

59 c⁄° 
ldns_rdf
 *
rdf
);

69 
ldns_°©us
 
ldns_º2buf„r_wúe
(
ldns_buf„r
 *
ouçut
,

70 c⁄° 
ldns_º
 *
º
,

71 
£˘i⁄
);

83 
ldns_°©us
 
ldns_º2buf„r_wúe_ˇn⁄iˇl
(
ldns_buf„r
 *
ouçut
,

84 c⁄° 
ldns_º
 *
º
,

85 
£˘i⁄
);

95 
ldns_°©us
 
ldns_ºsig2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
sigº
);

107 
ldns_°©us
 
ldns_º_rd©a2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
º
);

115 
ldns_°©us
 
ldns_pkt2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

123 
ldns_°©us
 
ldns_º_li°2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º_li°
 *
ºli°
);

135 
ldns_°©us
 
ldns_rdf2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_rdf
 *
rdf
, 
size_t
 *
size
);

150 
ldns_°©us
 
ldns_º2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_º
 *
º
, , 
size_t
 *
size
);

158 
ldns_°©us
 
ldns_pkt2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_pkt
 *
p
, 
size_t
 *
size
);

160 #ifde‡
__˝lu•lus


	@include/ldns/keys.h

21 #i‚de‡
LDNS_KEYS_H


22 
	#LDNS_KEYS_H


	)

24 
	~<ldns/comm⁄.h
>

25 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


26 
	~<›ís¶/s¶.h
>

28 
	~<ldns/utû.h
>

29 
	~<î∫o.h
>

31 #ifde‡
__˝lu•lus


35 
ldns_lookup_èbÀ
 
ldns_signög_Æg‹ôhms
[];

37 
	#LDNS_KEY_ZONE_KEY
 0x0100

	)

38 
	#LDNS_KEY_SEP_KEY
 0x0001

	)

39 
	#LDNS_KEY_REVOKE_KEY
 0x0080

	)

44 
	eldns_íum_Æg‹ôhm


46 
	gLDNS_RSAMD5
 = 1,

47 
	gLDNS_DH
 = 2,

48 
	gLDNS_DSA
 = 3,

49 
	gLDNS_ECC
 = 4,

50 
	gLDNS_RSASHA1
 = 5,

51 
	gLDNS_DSA_NSEC3
 = 6,

52 
	gLDNS_RSASHA1_NSEC3
 = 7,

53 
	gLDNS_RSASHA256
 = 8,

54 
	gLDNS_RSASHA512
 = 10,

55 
	gLDNS_ECC_GOST
 = 12,

56 
	gLDNS_ECDSAP256SHA256
 = 13,

57 
	gLDNS_ECDSAP384SHA384
 = 14,

58 
	gLDNS_INDIRECT
 = 252,

59 
	gLDNS_PRIVATEDNS
 = 253,

60 
	gLDNS_PRIVATEOID
 = 254

62 
ldns_íum_Æg‹ôhm
 
	tldns_Æg‹ôhm
;

67 
	eldns_íum_hash


69 
	gLDNS_SHA1
 = 1,

70 
	gLDNS_SHA256
 = 2,

71 
	gLDNS_HASH_GOST
 = 3,

72 
	gLDNS_SHA384
 = 4

74 
ldns_íum_hash
 
	tldns_hash
;

79 
	eldns_íum_signög_Æg‹ôhm


81 
	gLDNS_SIGN_RSAMD5
 = 
LDNS_RSAMD5
,

82 
	gLDNS_SIGN_RSASHA1
 = 
LDNS_RSASHA1
,

83 
	gLDNS_SIGN_DSA
 = 
LDNS_DSA
,

84 
	gLDNS_SIGN_RSASHA1_NSEC3
 = 
LDNS_RSASHA1_NSEC3
,

85 
	gLDNS_SIGN_RSASHA256
 = 
LDNS_RSASHA256
,

86 
	gLDNS_SIGN_RSASHA512
 = 
LDNS_RSASHA512
,

87 
	gLDNS_SIGN_DSA_NSEC3
 = 
LDNS_DSA_NSEC3
,

88 
	gLDNS_SIGN_ECC_GOST
 = 
LDNS_ECC_GOST
,

89 
	gLDNS_SIGN_ECDSAP256SHA256
 = 
LDNS_ECDSAP256SHA256
,

90 
	gLDNS_SIGN_ECDSAP384SHA384
 = 
LDNS_ECDSAP384SHA384
,

91 
	gLDNS_SIGN_HMACMD5
 = 157,

92 
	gLDNS_SIGN_HMACSHA1
 = 158,

93 
	gLDNS_SIGN_HMACSHA256
 = 159

95 
ldns_íum_signög_Æg‹ôhm
 
	tldns_signög_Æg‹ôhm
;

107 
	sldns_°ru˘_key
 {

108 
ldns_signög_Æg‹ôhm
 
	g_Æg
;

110 
boﬁ
 
	g_u£
;

114 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


115 #i‚de‡
S_SPLINT_S


118 
EVP_PKEY
 *
	gkey
;

125 *
	gkey
;

126 
size_t
 
	gsize
;

127 } 
	ghmac
;

131 *
	gexã∫Æ_key
;

132 } 
	g_key
;

138 
uöt32_t
 
	g‹ig_âl
;

140 
uöt32_t
 
	gö˚±i⁄
;

142 
uöt32_t
 
	gexpú©i⁄
;

144 
uöt16_t
 
	gkeyèg
;

146 
uöt16_t
 
	gÊags
;

147 } 
	gdns£c
;

148 } 
	g_exåa
;

150 
ldns_rdf
 *
	g_pubkey_ow√r
;

152 
ldns_°ru˘_key
 
	tldns_key
;

157 
	sldns_°ru˘_key_li°


159 
size_t
 
	g_key_cou¡
;

160 
ldns_key
 **
	g_keys
;

162 
ldns_°ru˘_key_li°
 
	tldns_key_li°
;

169 
ldns_key_li°
 *
ldns_key_li°_√w
();

175 
ldns_key
 *
ldns_key_√w
();

184 
ldns_key
 *
ldns_key_√w_‰m_Æg‹ôhm
(
ldns_signög_Æg‹ôhm
 
a
, 
uöt16_t
 
size
);

196 
ldns_°©us
 
ldns_key_√w_‰m_Â
(
ldns_key
 **
k
, 
FILE
 *
Â
);

209 
ldns_°©us
 
ldns_key_√w_‰m_Â_l
(
ldns_key
 **
k
, 
FILE
 *
Â
, *
löe_ƒ
);

211 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


216 
ldns_°©us
 
ldns_key_√w_‰m_ígöe
(
ldns_key
 **
key
, 
ENGINE
 *
e
, *
key_id
, 
ldns_Æg‹ôhm
);

225 
RSA
 *
ldns_key_√w_‰m_Â_rß
(
FILE
 *
Â
);

228 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


236 
RSA
 *
ldns_key_√w_‰m_Â_rß_l
(
FILE
 *
Â
, *
löe_ƒ
);

239 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


246 
DSA
 *
ldns_key_√w_‰m_Â_dß
(
FILE
 *
Â
);

249 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


257 
DSA
 *
ldns_key_√w_‰m_Â_dß_l
(
FILE
 *
Â
, *
löe_ƒ
);

260 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


269 *
ldns_key_√w_‰m_Â_hmac
(
FILE
 *
Â
, 
size_t
 *
hmac_size
);

272 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


282 *
ldns_key_√w_‰m_Â_hmac_l
(
FILE
 *
Â
, *
löe_ƒ
, 
size_t
 *
hmac_size
);

291 
ldns_key_£t_Æg‹ôhm
(
ldns_key
 *
k
, 
ldns_signög_Æg‹ôhm
 
l
);

292 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


298 
ldns_key_£t_evp_key
(
ldns_key
 *
k
, 
EVP_PKEY
 *
e
);

306 
ldns_key_£t_rß_key
(
ldns_key
 *
k
, 
RSA
 *
r
);

314 
ldns_key_£t_dß_key
(
ldns_key
 *
k
, 
DSA
 *
d
);

322 
ldns_key_assign_rß_key
(
ldns_key
 *
k
, 
RSA
 *
r
);

330 
ldns_key_assign_dß_key
(
ldns_key
 *
k
, 
DSA
 *
d
);

337 
ldns_key_EVP_lﬂd_go°_id
();

340 
ldns_key_EVP_u∆ﬂd_go°
();

348 
ldns_key_£t_hmac_key
(
ldns_key
 *
k
, *
hmac
);

360 
ldns_key_£t_exã∫Æ_key
(
ldns_key
 *
key
, *
exã∫Æ_key
);

367 
ldns_key_£t_hmac_size
(
ldns_key
 *
k
, 
size_t
 
hmac_size
);

373 
ldns_key_£t_‹igâl
(
ldns_key
 *
k
, 
uöt32_t
 
t
);

379 
ldns_key_£t_ö˚±i⁄
(
ldns_key
 *
k
, 
uöt32_t
 
i
);

385 
ldns_key_£t_expú©i⁄
(
ldns_key
 *
k
, 
uöt32_t
 
e
);

391 
ldns_key_£t_pubkey_ow√r
(
ldns_key
 *
k
, 
ldns_rdf
 *
r
);

397 
ldns_key_£t_keyèg
(
ldns_key
 *
k
, 
uöt16_t
 
èg
);

403 
ldns_key_£t_Êags
(
ldns_key
 *
k
, 
uöt16_t
 
Êags
);

409 
ldns_key_li°_£t_key_cou¡
(
ldns_key_li°
 *
key
, 
size_t
 
cou¡
);

417 
boﬁ
 
ldns_key_li°_push_key
(
ldns_key_li°
 *
key_li°
, 
ldns_key
 *
key
);

424 
size_t
 
ldns_key_li°_key_cou¡
(c⁄° 
ldns_key_li°
 *
key_li°
);

432 
ldns_key
 *
ldns_key_li°_key
(c⁄° 
ldns_key_li°
 *
key
, 
size_t
 
ƒ
);

434 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


440 
RSA
 *
ldns_key_rß_key
(c⁄° 
ldns_key
 *
k
);

446 
EVP_PKEY
 *
ldns_key_evp_key
(c⁄° 
ldns_key
 *
k
);

452 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


453 
DSA
 *
ldns_key_dß_key
(c⁄° 
ldns_key
 *
k
);

461 
ldns_signög_Æg‹ôhm
 
ldns_key_Æg‹ôhm
(c⁄° 
ldns_key
 *
k
);

467 
ldns_key_£t_u£
(
ldns_key
 *
k
, 
boﬁ
 
v
);

473 
boﬁ
 
ldns_key_u£
(c⁄° 
ldns_key
 *
k
);

479 *
ldns_key_hmac_key
(c⁄° 
ldns_key
 *
k
);

485 *
ldns_key_exã∫Æ_key
(c⁄° 
ldns_key
 *
k
);

491 
size_t
 
ldns_key_hmac_size
(c⁄° 
ldns_key
 *
k
);

497 
uöt32_t
 
ldns_key_‹igâl
(c⁄° 
ldns_key
 *
k
);

503 
uöt32_t
 
ldns_key_ö˚±i⁄
(c⁄° 
ldns_key
 *
k
);

509 
uöt32_t
 
ldns_key_expú©i⁄
(c⁄° 
ldns_key
 *
k
);

515 
uöt16_t
 
ldns_key_keyèg
(c⁄° 
ldns_key
 *
k
);

521 
ldns_rdf
 *
ldns_key_pubkey_ow√r
(c⁄° 
ldns_key
 *
k
);

528 
ldns_key_li°_£t_u£
(
ldns_key_li°
 *
keys
, 
boﬁ
 
v
);

535 
uöt16_t
 
ldns_key_Êags
(c⁄° 
ldns_key
 *
k
);

542 
ldns_key
 *
ldns_key_li°_p›_key
(
ldns_key_li°
 *
key_li°
);

553 
ldns_º
 *
ldns_key2º
(c⁄° 
ldns_key
 *
k
);

561 
ldns_key_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_key
 *
k
);

568 
ldns_key_‰ì
(
ldns_key
 *
key
);

576 
ldns_key_dìp_‰ì
(
ldns_key
 *
key
);

582 
ldns_key_li°_‰ì
(
ldns_key_li°
 *
key_li°
);

589 
ldns_º
 * 
ldns_ªad_™ch‹_fûe
(c⁄° *
fûíame
);

601 *
ldns_key_gë_fûe_ba£_«me
(
ldns_key
 *
key
);

608 
ldns_key_Ægo_suµ‹ãd
(
Ægo
);

615 
ldns_signög_Æg‹ôhm
 
ldns_gë_signög_Æg‹ôhm_by_«me
(c⁄° * 
«me
);

617 #ifde‡
__˝lu•lus


	@include/ldns/ldns.h

89 #i‚de‡
LDNS_DNS_H


90 
	#LDNS_DNS_H


	)

92 
	~<°dio.h
>

93 
	~<°dlib.h
>

95 
	~<ldns/utû.h
>

96 
	~<ldns/buf„r.h
>

97 
	~<ldns/comm⁄.h
>

98 
	~<ldns/d™e.h
>

99 
	~<ldns/d«me.h
>

100 
	~<ldns/dns£c.h
>

101 
	~<ldns/dns£c_vîify.h
>

102 
	~<ldns/dns£c_sign.h
>

103 
	~<ldns/duøti⁄.h
>

104 
	~<ldns/îr‹.h
>

105 
	~<ldns/highî.h
>

106 
	~<ldns/ho°2°r.h
>

107 
	~<ldns/ho°2wúe.h
>

108 
	~<ldns/√t.h
>

109 
	~<ldns/∑ckë.h
>

110 
	~<ldns/rd©a.h
>

111 
	~<ldns/ªsﬁvî.h
>

112 
	~<ldns/º.h
>

113 
	~<ldns/°r2ho°.h
>

114 
	~<ldns/tsig.h
>

115 
	~<ldns/upd©e.h
>

116 
	~<ldns/wúe2ho°.h
>

117 
	~<ldns/º_fun˘i⁄s.h
>

118 
	~<ldns/keys.h
>

119 
	~<ldns/∑r£.h
>

120 
	~<ldns/z⁄e.h
>

121 
	~<ldns/dns£c_z⁄e.h
>

122 
	~<ldns/ødix.h
>

123 
	~<ldns/rbåì.h
>

124 
	~<ldns/sha1.h
>

125 
	~<ldns/sha2.h
>

127 #ifde‡
__˝lu•lus


131 
	#LDNS_IP4ADDRLEN
 (32/8)

	)

132 
	#LDNS_IP6ADDRLEN
 (128/8)

	)

133 
	#LDNS_PORT
 53

	)

134 
	#LDNS_ROOT_LABEL_STR
 "."

	)

135 
	#LDNS_DEFAULT_TTL
 3600

	)

140 
ldns_lookup_èbÀ
 
ldns_˚πifiˇã_ty≥s
[];

142 
ldns_lookup_èbÀ
 
ldns_Æg‹ôhms
[];

144 
ldns_lookup_èbÀ
 
ldns_˚π_Æg‹ôhms
[];

146 
ldns_lookup_èbÀ
 
ldns_º_˛as£s
[];

148 
ldns_lookup_èbÀ
 
ldns_rcodes
[];

150 
ldns_lookup_èbÀ
 
ldns_›codes
[];

152 
ldns_lookup_èbÀ
 
ldns_edns_Êags
[];

154 #ifde‡
__˝lu•lus


	@include/ldns/net.h

13 #i‚de‡
LDNS_NET_H


14 
	#LDNS_NET_H


	)

16 
	~<ldns/ldns.h
>

17 
	~<sys/sockë.h
>

19 #ifde‡
__˝lu•lus


23 
	#LDNS_DEFAULT_TIMEOUT_SEC
 5

	)

24 
	#LDNS_DEFAULT_TIMEOUT_USEC
 0

	)

42 
ldns_°©us
 
ldns_udp_£nd
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
, 
size_t
 *
™swîsize
);

53 
ldns_udp_bg£nd
(
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
);

64 
ldns_t˝_bg£nd
(
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
);

77 
ldns_°©us
 
ldns_t˝_£nd
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
, 
size_t
 *
™swîsize
);

88 
ldns_°©us
 
ldns_£nd
(
ldns_pkt
 **
pkt
, 
ldns_ªsﬁvî
 *
r
, c⁄°Üdns_pkà*
quîy_pkt
);

100 
ldns_°©us
 
ldns_£nd_buf„r
(
ldns_pkt
 **
pkt
, 
ldns_ªsﬁvî
 *
r
, 
ldns_buf„r
 *
qb
, 
ldns_rdf
 *
tsig_mac
);

109 
ldns_t˝_c⁄√˘
(c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
);

117 
ldns_udp_c⁄√˘
(c⁄° 
sockaddr_°‹age
 *
to
, 
timevÆ
 
timeout
);

128 
ssize_t
 
ldns_t˝_£nd_quîy
(
ldns_buf„r
 *
qbö
, 
sockfd
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
);

139 
ssize_t
 
ldns_udp_£nd_quîy
(
ldns_buf„r
 *
qbö
, 
sockfd
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
);

150 
uöt8_t
 *
ldns_t˝_ªad_wúe_timeout
(
sockfd
, 
size_t
 *
size
, 
timevÆ
 
timeout
);

161 
uöt8_t
 *
ldns_t˝_ªad_wúe
(
sockfd
, 
size_t
 *
size
);

173 
uöt8_t
 *
ldns_udp_ªad_wúe
(
sockfd
, 
size_t
 *
size
, 
sockaddr_°‹age
 *
‰
, 
sockÀn_t
 *
‰Àn
);

183 
sockaddr_°‹age
 * 
ldns_rdf2«tive_sockaddr_°‹age
(c⁄° 
ldns_rdf
 *
rd
, 
uöt16_t
 
p‹t
, 
size_t
 *
size
);

191 
ldns_rdf
 * 
ldns_sockaddr_°‹age2rdf
(
sockaddr_°‹age
 *
sock
, 
uöt16_t
 *
p‹t
);

201 
ldns_°©us
 
ldns_ax‰_°¨t
(
ldns_ªsﬁvî
 *
ªsﬁvî
, 
ldns_rdf
 *
domaö
, 
ldns_º_˛ass
 
c
);

203 #ifde‡
__˝lu•lus


	@include/ldns/packet.h

21 #i‚de‡
LDNS_PACKET_H


22 
	#LDNS_PACKET_H


	)

24 
	#LDNS_MAX_PACKETLEN
 65535

	)

27 
	#LDNS_QR
 1

	)

28 
	#LDNS_AA
 2

	)

29 
	#LDNS_TC
 4

	)

30 
	#LDNS_RD
 8

	)

31 
	#LDNS_CD
 16

	)

32 
	#LDNS_RA
 32

	)

33 
	#LDNS_AD
 64

	)

35 
	~<ldns/îr‹.h
>

36 
	~<ldns/comm⁄.h
>

37 
	~<ldns/º.h
>

38 
	~<sys/time.h
>

40 #ifde‡
__˝lu•lus


45 
	eldns_íum_pkt_›code
 {

46 
LDNS_PACKET_QUERY
 = 0,

47 
LDNS_PACKET_IQUERY
 = 1,

48 
LDNS_PACKET_STATUS
 = 2,

49 
LDNS_PACKET_NOTIFY
 = 4,

50 
LDNS_PACKET_UPDATE
 = 5

52 
ldns_íum_pkt_›code
 
	tldns_pkt_›code
;

55 
	eldns_íum_pkt_rcode
 {

56 
LDNS_RCODE_NOERROR
 = 0,

57 
LDNS_RCODE_FORMERR
 = 1,

58 
LDNS_RCODE_SERVFAIL
 = 2,

59 
LDNS_RCODE_NXDOMAIN
 = 3,

60 
LDNS_RCODE_NOTIMPL
 = 4,

61 
LDNS_RCODE_REFUSED
 = 5,

62 
LDNS_RCODE_YXDOMAIN
 = 6,

63 
LDNS_RCODE_YXRRSET
 = 7,

64 
LDNS_RCODE_NXRRSET
 = 8,

65 
LDNS_RCODE_NOTAUTH
 = 9,

66 
LDNS_RCODE_NOTZONE
 = 10

68 
ldns_íum_pkt_rcode
 
	tldns_pkt_rcode
;

192 
	sldns_°ru˘_hdr


195 
uöt16_t
 
_id
;

197 
boﬁ
 
_qr
;

199 
boﬁ
 
_Ø
;

201 
boﬁ
 
_tc
;

203 
boﬁ
 
_rd
;

205 
boﬁ
 
_cd
;

207 
boﬁ
 
_ø
;

209 
boﬁ
 
_ad
;

211 
ldns_pkt_›code
 
_›code
;

213 
uöt8_t
 
_rcode
;

215 
uöt16_t
 
_qdcou¡
;

217 
uöt16_t
 
_™cou¡
;

219 
uöt16_t
 
_nscou¡
;

221 
uöt16_t
 
_¨cou¡
;

223 
ldns_°ru˘_hdr
 
	tldns_hdr
;

233 
	sldns_°ru˘_pkt


236 
ldns_hdr
 *
_hódî
;

239 
ldns_rdf
 *
_™swî‰om
;

241 
timevÆ
 
time°amp
;

243 
uöt32_t
 
_quîytime
;

245 
size_t
 
_size
;

247 
ldns_º
 *
_tsig_º
;

249 
uöt16_t
 
_edns_udp_size
;

251 
uöt8_t
 
_edns_exãnded_rcode
;

253 
uöt8_t
 
_edns_vîsi⁄
;

255 
uöt16_t
 
_edns_z
;

257 
ldns_rdf
 *
_edns_d©a
;

259 
ldns_º_li°
 *
_que°i⁄
;

261 
ldns_º_li°
 *
_™swî
;

263 
ldns_º_li°
 *
_auth‹ôy
;

265 
ldns_º_li°
 *
_addôi⁄Æ
;

267 
ldns_°ru˘_pkt
 
	tldns_pkt
;

272 
	eldns_íum_pkt_£˘i⁄
 {

273 
LDNS_SECTION_QUESTION
 = 0,

274 
LDNS_SECTION_ANSWER
 = 1,

275 
LDNS_SECTION_AUTHORITY
 = 2,

276 
LDNS_SECTION_ADDITIONAL
 = 3,

278 
LDNS_SECTION_ANY
 = 4,

280 
LDNS_SECTION_ANY_NOQUESTION
 = 5

282 
ldns_íum_pkt_£˘i⁄
 
	tldns_pkt_£˘i⁄
;

287 
	eldns_íum_pkt_ty≥
 {

288 
LDNS_PACKET_QUESTION
,

289 
LDNS_PACKET_REFERRAL
,

290 
LDNS_PACKET_ANSWER
,

291 
LDNS_PACKET_NXDOMAIN
,

292 
LDNS_PACKET_NODATA
,

293 
LDNS_PACKET_UNKNOWN


295 
ldns_íum_pkt_ty≥
 
	tldns_pkt_ty≥
;

306 
uöt16_t
 
ldns_pkt_id
(c⁄° 
ldns_pkt
 *
p
);

312 
boﬁ
 
ldns_pkt_qr
(c⁄° 
ldns_pkt
 *
p
);

318 
boﬁ
 
ldns_pkt_Ø
(c⁄° 
ldns_pkt
 *
p
);

324 
boﬁ
 
ldns_pkt_tc
(c⁄° 
ldns_pkt
 *
p
);

330 
boﬁ
 
ldns_pkt_rd
(c⁄° 
ldns_pkt
 *
p
);

336 
boﬁ
 
ldns_pkt_cd
(c⁄° 
ldns_pkt
 *
p
);

342 
boﬁ
 
ldns_pkt_ø
(c⁄° 
ldns_pkt
 *
p
);

348 
boﬁ
 
ldns_pkt_ad
(c⁄° 
ldns_pkt
 *
p
);

354 
ldns_pkt_›code
 
ldns_pkt_gë_›code
(c⁄° 
ldns_pkt
 *
p
);

360 
ldns_pkt_rcode
 
ldns_pkt_gë_rcode
(c⁄° 
ldns_pkt
 *
p
);

366 
uöt16_t
 
ldns_pkt_qdcou¡
(c⁄° 
ldns_pkt
 *
p
);

372 
uöt16_t
 
ldns_pkt_™cou¡
(c⁄° 
ldns_pkt
 *
p
);

378 
uöt16_t
 
ldns_pkt_nscou¡
(c⁄° 
ldns_pkt
 *
p
);

384 
uöt16_t
 
ldns_pkt_¨cou¡
(c⁄° 
ldns_pkt
 *
p
);

391 
ldns_rdf
 *
ldns_pkt_™swî‰om
(c⁄° 
ldns_pkt
 *
p
);

398 
timevÆ
 
ldns_pkt_time°amp
(c⁄° 
ldns_pkt
 *
p
);

404 
uöt32_t
 
ldns_pkt_quîytime
(c⁄° 
ldns_pkt
 *
p
);

411 
size_t
 
ldns_pkt_size
(c⁄° 
ldns_pkt
 *
p
);

422 
uöt16_t
 
ldns_pkt_£˘i⁄_cou¡
(c⁄° 
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
);

429 
ldns_º
 *
ldns_pkt_tsig
(c⁄° 
ldns_pkt
 *
p
);

436 
ldns_º_li°
 *
ldns_pkt_que°i⁄
(c⁄° 
ldns_pkt
 *
p
);

442 
ldns_º_li°
 *
ldns_pkt_™swî
(c⁄° 
ldns_pkt
 *
p
);

448 
ldns_º_li°
 *
ldns_pkt_auth‹ôy
(c⁄° 
ldns_pkt
 *
p
);

454 
ldns_º_li°
 *
ldns_pkt_addôi⁄Æ
(c⁄° 
ldns_pkt
 *
p
);

461 
ldns_º_li°
 *
ldns_pkt_Æl
(c⁄° 
ldns_pkt
 *
p
);

468 
ldns_º_li°
 *
ldns_pkt_Æl_noque°i⁄
(c⁄° 
ldns_pkt
 *
p
);

477 
ldns_º_li°
 *
ldns_pkt_gë_£˘i⁄_˛⁄e
(c⁄° 
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
);

487 
ldns_º_li°
 *
ldns_pkt_º_li°_by_«me
(
ldns_pkt
 *
p
, 
ldns_rdf
 *
r
, 
ldns_pkt_£˘i⁄
 
s
);

496 
ldns_º_li°
 *
ldns_pkt_º_li°_by_ty≥
(c⁄° 
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_pkt_£˘i⁄
 
s
);

506 
ldns_º_li°
 *
ldns_pkt_º_li°_by_«me_™d_ty≥
(c⁄° 
ldns_pkt
 *
∑ckë
, c⁄° 
ldns_rdf
 *
ow√∫ame
, 
ldns_º_ty≥
 
ty≥
, 
ldns_pkt_£˘i⁄
 
£c
);

515 
boﬁ
 
ldns_pkt_º
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º
 *
º
);

524 
boﬁ
 
ldns_pkt_£t_Êags
(
ldns_pkt
 *
pkt
, 
uöt16_t
 
Êags
);

531 
ldns_pkt_£t_id
(
ldns_pkt
 *
p
, 
uöt16_t
 
id
);

536 
ldns_pkt_£t_øndom_id
(
ldns_pkt
 *
p
);

542 
ldns_pkt_£t_qr
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

548 
ldns_pkt_£t_Ø
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

554 
ldns_pkt_£t_tc
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

560 
ldns_pkt_£t_rd
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

566 
ldns_pkt_£t_cd
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

572 
ldns_pkt_£t_ø
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

578 
ldns_pkt_£t_ad
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

585 
ldns_pkt_£t_›code
(
ldns_pkt
 *
p
, 
ldns_pkt_›code
 
c
);

591 
ldns_pkt_£t_rcode
(
ldns_pkt
 *
p
, 
uöt8_t
 
c
);

597 
ldns_pkt_£t_qdcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

603 
ldns_pkt_£t_™cou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

609 
ldns_pkt_£t_nscou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

615 
ldns_pkt_£t_¨cou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

621 
ldns_pkt_£t_™swî‰om
(
ldns_pkt
 *
p
, 
ldns_rdf
 *
r
);

627 
ldns_pkt_£t_quîytime
(
ldns_pkt
 *
p
, 
uöt32_t
 
t
);

633 
ldns_pkt_£t_size
(
ldns_pkt
 *
p
, 
size_t
 
s
);

640 
ldns_pkt_£t_time°amp
(
ldns_pkt
 *
p
, 
timevÆ
Åimeval);

647 
ldns_pkt_£t_£˘i⁄_cou¡
(
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
, 
uöt16_t
 
x
);

653 
ldns_pkt_£t_tsig
(
ldns_pkt
 *
p
, 
ldns_º
 *
t
);

661 
ldns_pkt_ty≥
 
ldns_pkt_ª∂y_ty≥
(
ldns_pkt
 *
p
);

668 
uöt16_t
 
ldns_pkt_edns_udp_size
(c⁄° 
ldns_pkt
 *
∑ckë
);

674 
uöt8_t
 
ldns_pkt_edns_exãnded_rcode
(c⁄° 
ldns_pkt
 *
∑ckë
);

680 
uöt8_t
 
ldns_pkt_edns_vîsi⁄
(c⁄° 
ldns_pkt
 *
∑ckë
);

686 
uöt16_t
 
ldns_pkt_edns_z
(c⁄° 
ldns_pkt
 *
∑ckë
);

692 
ldns_rdf
 *
ldns_pkt_edns_d©a
(c⁄° 
ldns_pkt
 *
∑ckë
);

699 
boﬁ
 
ldns_pkt_edns_do
(c⁄° 
ldns_pkt
 *
∑ckë
);

705 
ldns_pkt_£t_edns_do
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
vÆue
);

716 
boﬁ
 
ldns_pkt_edns
(c⁄° 
ldns_pkt
 *
∑ckë
);

723 
ldns_pkt_£t_edns_udp_size
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
s
);

729 
ldns_pkt_£t_edns_exãnded_rcode
(
ldns_pkt
 *
∑ckë
, 
uöt8_t
 
c
);

735 
ldns_pkt_£t_edns_vîsi⁄
(
ldns_pkt
 *
∑ckë
, 
uöt8_t
 
v
);

741 
ldns_pkt_£t_edns_z
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
z
);

747 
ldns_pkt_£t_edns_d©a
(
ldns_pkt
 *
∑ckë
, 
ldns_rdf
 *
d©a
);

753 
ldns_pkt
 *
ldns_pkt_√w
();

760 
ldns_pkt_‰ì
(
ldns_pkt
 *
∑ckë
);

771 
ldns_°©us
 
ldns_pkt_quîy_√w_‰m_°r
(
ldns_pkt
 **
p
, c⁄° *
º_«me
, 
ldns_º_ty≥
 
º_ty≥
, 
ldns_º_˛ass
 
º_˛ass
 , 
uöt16_t
 
Êags
);

783 
ldns_°©us
 
ldns_pkt_ix‰_ªque°_√w_‰m_°r
(
ldns_pkt
 **
p
, c⁄° *
º_«me
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
, 
ldns_º
* 
sﬂ
);

793 
ldns_pkt
 *
ldns_pkt_quîy_√w
(
ldns_rdf
 *
º_«me
, 
ldns_º_ty≥
 
º_ty≥
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
);

804 
ldns_pkt
 *
ldns_pkt_ix‰_ªque°_√w
(
ldns_rdf
 *
º_«me
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
, 
ldns_º
* 
sﬂ
);

812 
ldns_pkt
 *
ldns_pkt_˛⁄e
÷dns_pkà*
pkt
);

819 
ldns_pkt_£t_addôi⁄Æ
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

826 
ldns_pkt_£t_™swî
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

833 
ldns_pkt_£t_que°i⁄
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

840 
ldns_pkt_£t_auth‹ôy
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

849 
boﬁ
 
ldns_pkt_push_º
(
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
, 
ldns_º
 *
º
);

858 
boﬁ
 
ldns_pkt_ß„_push_º
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º
 *
º
);

867 
boﬁ
 
ldns_pkt_push_º_li°
(
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
, 
ldns_º_li°
 *
li°
);

876 
boﬁ
 
ldns_pkt_ß„_push_º_li°
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º_li°
 *
li°
);

883 
boﬁ
 
ldns_pkt_em±y
(
ldns_pkt
 *
p
);

885 #ifde‡
__˝lu•lus


	@include/ldns/parse.h

10 #i‚de‡
LDNS_PARSE_H


11 
	#LDNS_PARSE_H


	)

13 
	~<ldns/comm⁄.h
>

14 
	~<ldns/buf„r.h
>

16 #ifde‡
__˝lu•lus


20 
	#LDNS_PARSE_SKIP_SPACE
 "\f\n\r\v"

	)

21 
	#LDNS_PARSE_NORMAL
 " \f\n\r\t\v"

	)

22 
	#LDNS_PARSE_NO_NL
 " \t"

	)

23 
	#LDNS_MAX_LINELEN
 10230

	)

24 
	#LDNS_MAX_KEYWORDLEN
 32

	)

39 
	eldns_íum_dúe˘ive


41 
LDNS_DIR_TTL
,

42 
LDNS_DIR_ORIGIN
,

43 
LDNS_DIR_INCLUDE


45 
ldns_íum_dúe˘ive
 
	tldns_dúe˘ive
;

57 
ssize_t
 
ldns_fgë_tokí
(
FILE
 *
f
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
);

70 
ssize_t
 
ldns_fgë_tokí_l
(
FILE
 *
f
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
, *
löe_ƒ
);

82 
ssize_t
 
ldns_bgë_tokí
(
ldns_buf„r
 *
b
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
);

95 
ssize_t
 
ldns_fgë_keyw‹d_d©a
(
FILE
 *
f
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
, c⁄° *
d_dñ
, 
size_t
 
d©a_limô
);

110 
ssize_t
 
ldns_fgë_keyw‹d_d©a_l
(
FILE
 *
f
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
, c⁄° *
d_dñ
, 
size_t
 
d©a_limô
, *
löe_ƒ
);

123 
ssize_t
 
ldns_bgë_keyw‹d_d©a
(
ldns_buf„r
 *
b
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
, c⁄° *
d_dñ
, 
size_t
 
d©a_limô
);

132 
ldns_bgëc
(
ldns_buf„r
 *
buf„r
);

141 
ldns_bskùcs
(
ldns_buf„r
 *
buf„r
, c⁄° *
s
);

150 
ldns_fskùcs
(
FILE
 *
Â
, c⁄° *
s
);

161 
ldns_fskùcs_l
(
FILE
 *
Â
, c⁄° *
s
, *
löe_ƒ
);

163 #ifde‡
__˝lu•lus


	@include/ldns/radix.h

43 #i‚de‡
LDNS_RADIX_H_


44 
	#LDNS_RADIX_H_


	)

46 
	~<ldns/îr‹.h
>

48 #ifde‡
__˝lu•lus


52 
uöt16_t
 
	tødix_°æí_t
;

53 
ldns_ødix_¨øy_t
 
	tldns_ødix_¨øy_t
;

54 
ldns_ødix_node_t
 
	tldns_ødix_node_t
;

55 
ldns_ødix_t
 
	tldns_ødix_t
;

58 
	sldns_ødix_¨øy_t
 {

60 
uöt8_t
* 
°r
;

62 
ødix_°æí_t
 
Àn
;

64 
ldns_ødix_node_t
* 
edge
;

68 
	sldns_ødix_node_t
 {

70 
uöt8_t
* 
key
;

72 
ødix_°æí_t
 
kÀn
;

74 * 
d©a
;

76 
ldns_ødix_node_t
* 
∑ª¡
;

78 
uöt8_t
 
∑ª¡_ödex
;

80 
uöt16_t
 
Àn
;

82 
uöt16_t
 
off£t
;

84 
uöt16_t
 
ˇ∑côy
;

86 
ldns_ødix_¨øy_t
* 
¨øy
;

90 
	sldns_ødix_t
 {

92 
ldns_ødix_node_t
* 
roŸ
;

94 
size_t
 
cou¡
;

102 
ldns_ødix_t
* 
ldns_ødix_¸óã
();

109 
ldns_ødix_öô
(
ldns_ødix_t
* 
åì
);

116 
ldns_ødix_‰ì
(
ldns_ødix_t
* 
åì
);

127 
ldns_°©us
 
ldns_ødix_ö£π
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

128 
ødix_°æí_t
 
Àn
, * 
d©a
);

138 * 
ldns_ødix_dñëe
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
, 
ødix_°æí_t
 
Àn
);

148 
ldns_ødix_node_t
* 
ldns_ødix_£¨ch
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

149 
ødix_°æí_t
 
Àn
);

162 
ldns_ødix_föd_Àss_equÆ
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

163 
ødix_°æí_t
 
Àn
, 
ldns_ødix_node_t
** 
ªsu…
);

171 
ldns_ødix_node_t
* 
ldns_ødix_fú°
(
ldns_ødix_t
* 
åì
);

179 
ldns_ødix_node_t
* 
ldns_ødix_œ°
(
ldns_ødix_t
* 
åì
);

187 
ldns_ødix_node_t
* 
ldns_ødix_√xt
÷dns_ødix_node_t* 
node
);

195 
ldns_ødix_node_t
* 
ldns_ødix_¥ev
÷dns_ødix_node_t* 
node
);

205 
ldns_°©us
 
ldns_ødix_•lô
(
ldns_ødix_t
* 
åì1
, 
size_t
 
num
,

206 
ldns_ødix_t
** 
åì2
);

215 
ldns_°©us
 
ldns_ødix_joö
(
ldns_ødix_t
* 
åì1
,Üdns_ødix_t* 
åì2
);

225 
ldns_ødix_åavî£_po°‹dî
(
ldns_ødix_node_t
* 
node
,

226 (*
func
)(
ldns_ødix_node_t
*, *), * 
¨g
);

234 
ldns_ødix_¥ötf
(
FILE
* 
fd
, 
ldns_ødix_t
* 
åì
);

236 #ifde‡
__˝lu•lus


	@include/ldns/rbtree.h

43 #i‚de‡
LDNS_RBTREE_H_


44 
	#LDNS_RBTREE_H_


	)

46 #ifde‡
__˝lu•lus


56 
ldns_rbnode_t
 
	tldns_rbnode_t
;

60 
	sldns_rbnode_t
 {

62 
ldns_rbnode_t
 *
∑ª¡
;

64 
ldns_rbnode_t
 *
À·
;

66 
ldns_rbnode_t
 *
right
;

68 c⁄° *
key
;

70 c⁄° *
d©a
;

72 
uöt8_t
 
cﬁ‹
;

76 
	#LDNS_RBTREE_NULL
 &
ldns_rbåì_nuŒ_node


	)

78 
ldns_rbnode_t
 
ldns_rbåì_nuŒ_node
;

81 
ldns_rbåì_t
 
	tldns_rbåì_t
;

83 
	sldns_rbåì_t
 {

85 
ldns_rbnode_t
 *
	groŸ
;

88 
size_t
 
	gcou¡
;

94 (*
	gcmp
) (const *, const *);

102 
ldns_rbåì_t
 *
ldns_rbåì_¸óã
((*
cmpf
)(const *, const *));

108 
ldns_rbåì_‰ì
(
ldns_rbåì_t
 *
rbåì
);

115 
ldns_rbåì_öô
(
ldns_rbåì_t
 *
rbåì
, (*
cmpf
)(const *, const *));

123 
ldns_rbnode_t
 *
ldns_rbåì_ö£π
(
ldns_rbåì_t
 *
rbåì
,Üdns_rbnode_à*
d©a
);

131 
ldns_rbåì_ö£π_vªf
(
ldns_rbnode_t
 *
d©a
, *
rbåì
);

140 
ldns_rbnode_t
 *
ldns_rbåì_dñëe
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
);

148 
ldns_rbnode_t
 *
ldns_rbåì_£¨ch
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
);

159 
ldns_rbåì_föd_Àss_equÆ
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
,

160 
ldns_rbnode_t
 **
ªsu…
);

167 
ldns_rbnode_t
 *
ldns_rbåì_fú°
(
ldns_rbåì_t
 *
rbåì
);

174 
ldns_rbnode_t
 *
ldns_rbåì_œ°
(
ldns_rbåì_t
 *
rbåì
);

181 
ldns_rbnode_t
 *
ldns_rbåì_√xt
÷dns_rbnode_à*
rbåì
);

188 
ldns_rbnode_t
 *
ldns_rbåì_¥evious
÷dns_rbnode_à*
rbåì
);

195 
ldns_rbåì_t
 *
ldns_rbåì_•lô
÷dns_rbåì_à*
åì
, 
size_t
 
ñemíts
);

201 
ldns_rbåì_joö
(
ldns_rbåì_t
 *
åì1
,Üdns_rbåì_à*
åì2
);

207 
	#LDNS_RBTREE_FOR
(
node
, 
ty≥
, 
rbåì
) \

208 
node
=(
ty≥
)
	`ldns_rbåì_fú°
(
rbåì
); \

209 (
ldns_rbnode_t
*)
node
 !
LDNS_RBTREE_NULL
; \

210 
node
 = (
ty≥
)
	`ldns_rbåì_√xt
((
ldns_rbnode_t
*Íode))

	)

223 
ldns_åavî£_po°‹dî
(
ldns_rbåì_t
* 
åì
,

224 (*
func
)(
ldns_rbnode_t
*, *), * 
¨g
);

226 #ifde‡
__˝lu•lus


	@include/ldns/rdata.h

21 #i‚de‡
LDNS_RDATA_H


22 
	#LDNS_RDATA_H


	)

24 
	~<ldns/comm⁄.h
>

25 
	~<ldns/îr‹.h
>

27 #ifde‡
__˝lu•lus


31 
	#LDNS_MAX_RDFLEN
 65535

	)

33 
	#LDNS_RDF_SIZE_BYTE
 1

	)

34 
	#LDNS_RDF_SIZE_WORD
 2

	)

35 
	#LDNS_RDF_SIZE_DOUBLEWORD
 4

	)

36 
	#LDNS_RDF_SIZE_6BYTES
 6

	)

37 
	#LDNS_RDF_SIZE_8BYTES
 8

	)

38 
	#LDNS_RDF_SIZE_16BYTES
 16

	)

40 
	#LDNS_NSEC3_VARS_OPTOUT_MASK
 0x01

	)

45 
	eldns_íum_rdf_ty≥


48 
LDNS_RDF_TYPE_NONE
,

50 
LDNS_RDF_TYPE_DNAME
,

52 
LDNS_RDF_TYPE_INT8
,

54 
LDNS_RDF_TYPE_INT16
,

56 
LDNS_RDF_TYPE_INT32
,

58 
LDNS_RDF_TYPE_A
,

60 
LDNS_RDF_TYPE_AAAA
,

62 
LDNS_RDF_TYPE_STR
,

64 
LDNS_RDF_TYPE_APL
,

66 
LDNS_RDF_TYPE_B32_EXT
,

68 
LDNS_RDF_TYPE_B64
,

70 
LDNS_RDF_TYPE_HEX
,

72 
LDNS_RDF_TYPE_NSEC
,

74 
LDNS_RDF_TYPE_TYPE
,

76 
LDNS_RDF_TYPE_CLASS
,

78 
LDNS_RDF_TYPE_CERT_ALG
,

80 
LDNS_RDF_TYPE_ALG
,

82 
LDNS_RDF_TYPE_UNKNOWN
,

84 
LDNS_RDF_TYPE_TIME
,

86 
LDNS_RDF_TYPE_PERIOD
,

88 
LDNS_RDF_TYPE_TSIGTIME
,

92 
LDNS_RDF_TYPE_HIP
,

95 
LDNS_RDF_TYPE_INT16_DATA
,

97 
LDNS_RDF_TYPE_SERVICE
,

99 
LDNS_RDF_TYPE_LOC
,

101 
LDNS_RDF_TYPE_WKS
,

103 
LDNS_RDF_TYPE_NSAP
,

105 
LDNS_RDF_TYPE_ATMA
,

107 
LDNS_RDF_TYPE_IPSECKEY
,

109 
LDNS_RDF_TYPE_NSEC3_SALT
,

111 
LDNS_RDF_TYPE_NSEC3_NEXT_OWNER
,

116 
LDNS_RDF_TYPE_ILNP64
,

119 
LDNS_RDF_TYPE_EUI48
,

121 
LDNS_RDF_TYPE_EUI64
,

126 
LDNS_RDF_TYPE_TAG
,

132 
LDNS_RDF_TYPE_LONG_STR
,

135 
LDNS_RDF_TYPE_BITMAP
 = 
LDNS_RDF_TYPE_NSEC


137 
ldns_íum_rdf_ty≥
 
	tldns_rdf_ty≥
;

142 
	eldns_íum_˚π_Æg‹ôhm


144 
LDNS_CERT_PKIX
 = 1,

145 
LDNS_CERT_SPKI
 = 2,

146 
LDNS_CERT_PGP
 = 3,

147 
LDNS_CERT_IPKIX
 = 4,

148 
LDNS_CERT_ISPKI
 = 5,

149 
LDNS_CERT_IPGP
 = 6,

150 
LDNS_CERT_ACPKIX
 = 7,

151 
LDNS_CERT_IACPKIX
 = 8,

152 
LDNS_CERT_URI
 = 253,

153 
LDNS_CERT_OID
 = 254

155 
ldns_íum_˚π_Æg‹ôhm
 
	tldns_˚π_Æg‹ôhm
;

166 
	sldns_°ru˘_rdf


169 
size_t
 
_size
;

171 
ldns_rdf_ty≥
 
_ty≥
;

173 *
_d©a
;

175 
ldns_°ru˘_rdf
 
	tldns_rdf
;

187 
ldns_rdf_£t_size
(
ldns_rdf
 *
rd
, 
size_t
 
size
);

195 
ldns_rdf_£t_ty≥
(
ldns_rdf
 *
rd
, 
ldns_rdf_ty≥
 
ty≥
);

203 
ldns_rdf_£t_d©a
(
ldns_rdf
 *
rd
, *
d©a
);

212 
size_t
 
ldns_rdf_size
(c⁄° 
ldns_rdf
 *
rd
);

220 
ldns_rdf_ty≥
 
ldns_rdf_gë_ty≥
(c⁄° 
ldns_rdf
 *
rd
);

228 
uöt8_t
 *
ldns_rdf_d©a
(c⁄° 
ldns_rdf
 *
rd
);

241 
ldns_rdf
 *
ldns_rdf_√w
(
ldns_rdf_ty≥
 
ty≥
, 
size_t
 
size
, *
d©a
);

252 
ldns_rdf
 *
ldns_rdf_√w_‰m_d©a
(
ldns_rdf_ty≥
 
ty≥
, 
size_t
 
size
, c⁄° *
d©a
);

260 
ldns_rdf
 *
ldns_rdf_√w_‰m_°r
(
ldns_rdf_ty≥
 
ty≥
, c⁄° *
°r
);

269 
ldns_°©us
 
ldns_rdf_√w_‰m_Â
(
ldns_rdf
 **
r
, 
ldns_rdf_ty≥
 
ty≥
, 
FILE
 *
Â
);

279 
ldns_°©us
 
ldns_rdf_√w_‰m_Â_l
(
ldns_rdf
 **
r
, 
ldns_rdf_ty≥
 
ty≥
, 
FILE
 *
Â
, *
löe_ƒ
);

289 
ldns_rdf_‰ì
(
ldns_rdf
 *
rd
);

297 
ldns_rdf_dìp_‰ì
(
ldns_rdf
 *
rd
);

307 
ldns_rdf
 *
ldns_«tive2rdf_öt8
(
ldns_rdf_ty≥
 
ty≥
, 
uöt8_t
 
vÆue
);

315 
ldns_rdf
 *
ldns_«tive2rdf_öt16
(
ldns_rdf_ty≥
 
ty≥
, 
uöt16_t
 
vÆue
);

326 
ldns_rdf
 *
ldns_«tive2rdf_öt32
(
ldns_rdf_ty≥
 
ty≥
, 
uöt32_t
 
vÆue
);

338 
ldns_rdf
 *
ldns_«tive2rdf_öt16_d©a
(
size_t
 
size
, 
uöt8_t
 *
d©a
);

346 
ldns_rdf
 *
ldns_rdf_addªss_ªvî£
÷dns_rd‡*
rd
);

353 
uöt8_t
 
ldns_rdf2«tive_öt8
(c⁄° 
ldns_rdf
 *
rd
);

360 
uöt16_t
 
ldns_rdf2«tive_öt16
(c⁄° 
ldns_rdf
 *
rd
);

367 
uöt32_t
 
ldns_rdf2«tive_öt32
(c⁄° 
ldns_rdf
 *
rd
);

374 
time_t
 
ldns_rdf2«tive_time_t
(c⁄° 
ldns_rdf
 *
rd
);

382 
uöt32_t
 
ldns_°r2≥riod
(c⁄° *
≈å
, c⁄° **
íd±r
);

391 
ldns_°©us
 
ldns_o˘ë
(*
w‹d
, 
size_t
 *
Àngth
);

398 
ldns_rdf
 *
ldns_rdf_˛⁄e
(c⁄°Üdns_rd‡*
rd
);

409 
ldns_rdf_com∑ª
(c⁄° 
ldns_rdf
 *
rd1
, c⁄°Üdns_rd‡*
rd2
);

422 
ldns_°©us
 
ldns_rdf_hù_gë_Æg_hô_pk
(
ldns_rdf
 *
rdf
, 
uöt8_t
* 
Æg
,

423 
uöt8_t
 *
hô_size
, uöt8_t** 
hô
,

424 
uöt16_t
 *
pk_size
, 
uöt8_t
** 
pk
);

436 
ldns_°©us
 
ldns_rdf_hù_√w_‰m_Æg_hô_pk
(
ldns_rdf
** 
rdf
, 
uöt8_t
 
Æg
,

437 
uöt8_t
 
hô_size
, uöt8_à*
hô
, 
uöt16_t
 
pk_size
, uöt8_à*
pk
);

439 #ifde‡
__˝lu•lus


	@include/ldns/resolver.h

20 #i‚de‡
LDNS_RESOLVER_H


21 
	#LDNS_RESOLVER_H


	)

23 
	~<ldns/îr‹.h
>

24 
	~<ldns/comm⁄.h
>

25 
	~<ldns/º.h
>

26 
	~<ldns/tsig.h
>

27 
	~<ldns/rd©a.h
>

28 
	~<ldns/∑ckë.h
>

29 
	~<sys/time.h
>

31 #ifde‡
__˝lu•lus


36 
	#LDNS_RESOLV_CONF
 "/ëc/ªsﬁv.c⁄f"

	)

38 
	#LDNS_RESOLV_HOSTS
 "/ëc/ho°s"

	)

40 
	#LDNS_RESOLV_KEYWORD
 -1

	)

41 
	#LDNS_RESOLV_DEFDOMAIN
 0

	)

42 
	#LDNS_RESOLV_NAMESERVER
 1

	)

43 
	#LDNS_RESOLV_SEARCH
 2

	)

44 
	#LDNS_RESOLV_SORTLIST
 3

	)

45 
	#LDNS_RESOLV_OPTIONS
 4

	)

46 
	#LDNS_RESOLV_ANCHOR
 5

	)

47 
	#LDNS_RESOLV_KEYWORDS
 6

	)

49 
	#LDNS_RESOLV_INETANY
 0

	)

50 
	#LDNS_RESOLV_INET
 1

	)

51 
	#LDNS_RESOLV_INET6
 2

	)

53 
	#LDNS_RESOLV_RTT_INF
 0

	)

54 
	#LDNS_RESOLV_RTT_MIN
 1

	)

59 
	sldns_°ru˘_ªsﬁvî


62 
uöt16_t
 
_p‹t
;

65 
ldns_rdf
 **
_«me£rvîs
;

67 
size_t
 
_«me£rvî_cou¡
;

70 
size_t
 *
_πt
;

73 
boﬁ
 
_ªcursive
;

76 
boﬁ
 
_debug
;

79 
ldns_rdf
 *
_domaö
;

82 
ldns_rdf
 **
_£¨chli°
;

85 
size_t
 
_£¨chli°_cou¡
;

88 
uöt8_t
 
_ªåy
;

90 
uöt8_t
 
_ªå™s
;

92 
boﬁ
 
_ÁŒback
;

95 
boﬁ
 
_dns£c
;

97 
boﬁ
 
_dns£c_cd
;

99 
ldns_º_li°
 * 
_dns£c_™ch‹s
;

101 
boﬁ
 
_u£vc
;

103 
boﬁ
 
_ig¡c
;

105 
uöt8_t
 
_ù6
;

107 
boﬁ
 
_de‚ames
;

109 
boﬁ
 
_dn§ch
;

111 
timevÆ
 
_timeout
;

113 
boﬁ
 
_Áû
;

115 
boﬁ
 
_øndom
;

117 
_sockë
;

121 
_ax‰_sﬂ_cou¡
;

126 
ldns_pkt
 *
_cur_ax‰_pkt
;

128 
uöt16_t
 
_ax‰_i
;

130 
uöt16_t
 
_edns_udp_size
;

136 *
_tsig_key«me
;

138 *
_tsig_keyd©a
;

140 *
_tsig_Æg‹ôhm
;

143 
ldns_rdf
 *
_sour˚
;

145 
ldns_°ru˘_ªsﬁvî
 
	tldns_ªsﬁvî
;

155 
uöt16_t
 
ldns_ªsﬁvî_p‹t
(c⁄° 
ldns_ªsﬁvî
 *
r
);

162 
ldns_rdf
 *
ldns_ªsﬁvî_sour˚
(c⁄° 
ldns_ªsﬁvî
 *
r
);

169 
boﬁ
 
ldns_ªsﬁvî_ªcursive
(c⁄° 
ldns_ªsﬁvî
 *
r
);

176 
boﬁ
 
ldns_ªsﬁvî_debug
(c⁄° 
ldns_ªsﬁvî
 *
r
);

183 
uöt8_t
 
ldns_ªsﬁvî_ªåy
(c⁄° 
ldns_ªsﬁvî
 *
r
);

190 
uöt8_t
 
ldns_ªsﬁvî_ªå™s
(c⁄° 
ldns_ªsﬁvî
 *
r
);

197 
boﬁ
 
ldns_ªsﬁvî_ÁŒback
(c⁄° 
ldns_ªsﬁvî
 *
r
);

204 
uöt8_t
 
ldns_ªsﬁvî_ù6
(c⁄° 
ldns_ªsﬁvî
 *
r
);

211 
uöt16_t
 
ldns_ªsﬁvî_edns_udp_size
(c⁄° 
ldns_ªsﬁvî
 *
r
);

217 
boﬁ
 
ldns_ªsﬁvî_u£vc
(c⁄° 
ldns_ªsﬁvî
 *
r
);

223 
boﬁ
 
ldns_ªsﬁvî_Áû
(c⁄° 
ldns_ªsﬁvî
 *
r
);

229 
boﬁ
 
ldns_ªsﬁvî_de‚ames
(c⁄° 
ldns_ªsﬁvî
 *
r
);

235 
boﬁ
 
ldns_ªsﬁvî_dn§ch
(c⁄° 
ldns_ªsﬁvî
 *
r
);

241 
boﬁ
 
ldns_ªsﬁvî_dns£c
(c⁄° 
ldns_ªsﬁvî
 *
r
);

247 
boﬁ
 
ldns_ªsﬁvî_dns£c_cd
(c⁄° 
ldns_ªsﬁvî
 *
r
);

253 
ldns_º_li°
 * 
ldns_ªsﬁvî_dns£c_™ch‹s
(c⁄° 
ldns_ªsﬁvî
 *
r
);

259 
boﬁ
 
ldns_ªsﬁvî_ig¡c
(c⁄° 
ldns_ªsﬁvî
 *
r
);

265 
boﬁ
 
ldns_ªsﬁvî_øndom
(c⁄° 
ldns_ªsﬁvî
 *
r
);

271 
size_t
 
ldns_ªsﬁvî_«me£rvî_cou¡
(c⁄° 
ldns_ªsﬁvî
 *
r
);

277 
ldns_rdf
 *
ldns_ªsﬁvî_domaö
(c⁄° 
ldns_ªsﬁvî
 *
r
);

283 
timevÆ
 
ldns_ªsﬁvî_timeout
(c⁄° 
ldns_ªsﬁvî
 *
r
);

289 
ldns_rdf
** 
ldns_ªsﬁvî_£¨chli°
(c⁄° 
ldns_ªsﬁvî
 *
r
);

295 
ldns_rdf
** 
ldns_ªsﬁvî_«me£rvîs
(c⁄° 
ldns_ªsﬁvî
 *
r
);

302 
size_t
 * 
ldns_ªsﬁvî_πt
(c⁄° 
ldns_ªsﬁvî
 *
r
);

309 
size_t
 
ldns_ªsﬁvî_«me£rvî_πt
(c⁄° 
ldns_ªsﬁvî
 *
r
, size_à
pos
);

315 *
ldns_ªsﬁvî_tsig_key«me
(c⁄° 
ldns_ªsﬁvî
 *
r
);

321 *
ldns_ªsﬁvî_tsig_Æg‹ôhm
(c⁄° 
ldns_ªsﬁvî
 *
r
);

327 *
ldns_ªsﬁvî_tsig_keyd©a
(c⁄° 
ldns_ªsﬁvî
 *
r
);

333 
ldns_rdf
* 
ldns_ªsﬁvî_p›_«me£rvî
(
ldns_ªsﬁvî
 *
r
);

340 
size_t
 
ldns_ªsﬁvî_£¨chli°_cou¡
(c⁄° 
ldns_ªsﬁvî
 *
r
);

348 
ldns_ªsﬁvî_£t_p‹t
(
ldns_ªsﬁvî
 *
r
, 
uöt16_t
 
p
);

355 
ldns_ªsﬁvî_£t_sour˚
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
s
);

362 
ldns_ªsﬁvî_£t_ªcursive
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

369 
ldns_ªsﬁvî_£t_debug
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

375 
ldns_ªsﬁvî_ö¸_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
);

381 
ldns_ªsﬁvî_dec_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
);

388 
ldns_ªsﬁvî_£t_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
, 
size_t
 
c
);

395 
ldns_ªsﬁvî_£t_«me£rvîs
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 **
rd
);

403 
ldns_ªsﬁvî_£t_domaö
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
rd
);

410 
ldns_ªsﬁvî_£t_timeout
(
ldns_ªsﬁvî
 *
r
, 
timevÆ
 
timeout
);

417 
ldns_ªsﬁvî_push_£¨chli°
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
rd
);

424 
ldns_ªsﬁvî_£t_de‚ames
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

431 
ldns_ªsﬁvî_£t_u£vc
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

438 
ldns_ªsﬁvî_£t_dn§ch
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

445 
ldns_ªsﬁvî_£t_dns£c
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

452 
ldns_ªsﬁvî_£t_dns£c_cd
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

458 
ldns_ªsﬁvî_£t_dns£c_™ch‹s
(
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 * 
l
);

466 
ldns_°©us
 
ldns_ªsﬁvî_push_dns£c_™ch‹
(
ldns_ªsﬁvî
 *
r
, 
ldns_º
 *
º
);

473 
ldns_ªsﬁvî_£t_ªå™s
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
ª
);

481 
ldns_ªsﬁvî_£t_ÁŒback
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
ÁŒback
);

489 
ldns_ªsﬁvî_£t_ªåy
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
ª
);

496 
ldns_ªsﬁvî_£t_ù6
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
i
);

503 
ldns_ªsﬁvî_£t_Áû
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

510 
ldns_ªsﬁvî_£t_ig¡c
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

517 
ldns_ªsﬁvî_£t_edns_udp_size
(
ldns_ªsﬁvî
 *
r
, 
uöt16_t
 
s
);

524 
ldns_ªsﬁvî_£t_tsig_key«me
(
ldns_ªsﬁvî
 *
r
, *
tsig_key«me
);

531 
ldns_ªsﬁvî_£t_tsig_Æg‹ôhm
(
ldns_ªsﬁvî
 *
r
, *
tsig_Æg‹ôhm
);

538 
ldns_ªsﬁvî_£t_tsig_keyd©a
(
ldns_ªsﬁvî
 *
r
, *
tsig_keyd©a
);

546 
ldns_ªsﬁvî_£t_πt
(
ldns_ªsﬁvî
 *
r
, 
size_t
 *
πt
);

555 
ldns_ªsﬁvî_£t_«me£rvî_πt
(
ldns_ªsﬁvî
 *
r
, 
size_t
 
pos
, size_à
vÆue
);

562 
ldns_ªsﬁvî_£t_øndom
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

571 
ldns_°©us
 
ldns_ªsﬁvî_push_«me£rvî
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
n
);

580 
ldns_°©us
 
ldns_ªsﬁvî_push_«me£rvî_º
(
ldns_ªsﬁvî
 *
r
, 
ldns_º
 *
º
);

588 
ldns_°©us
 
ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 *
ºli°
);

602 
ldns_pkt
* 
ldns_ªsﬁvî_£¨ch
(c⁄° 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
rdf
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

618 
ldns_°©us
 
ldns_ªsﬁvî_£¨ch_°©us
(
ldns_pkt
** 
pkt
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
rdf
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

631 
ldns_°©us
 
ldns_ªsﬁvî_¥ï¨e_quîy_pkt
(
ldns_pkt
 **
q
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
f
);

644 
ldns_°©us
 
ldns_ªsﬁvî_£nd
(
ldns_pkt
 **
™swî
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

652 
ldns_°©us
 
ldns_ªsﬁvî_£nd_pkt
(
ldns_pkt
 **
™swî
, 
ldns_ªsﬁvî
 *
r
,Üdns_pkà*
quîy_pkt
);

666 
ldns_°©us
 
ldns_ªsﬁvî_quîy_°©us
(
ldns_pkt
** 
pkt
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

682 
ldns_pkt
* 
ldns_ªsﬁvî_quîy
(c⁄° 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

689 
ldns_ªsﬁvî
* 
ldns_ªsﬁvî_√w
();

698 
ldns_°©us
 
ldns_ªsﬁvî_√w_‰m_Â
(
ldns_ªsﬁvî
 **
r
, 
FILE
 *
Â
);

708 
ldns_°©us
 
ldns_ªsﬁvî_√w_‰m_Â_l
(
ldns_ªsﬁvî
 **
r
, 
FILE
 *
Â
, *
löe_ƒ
);

718 
ldns_°©us
 
ldns_ªsﬁvî_√w_‰m_fûe
(
ldns_ªsﬁvî
 **
r
, c⁄° *
fûíame
);

724 
ldns_ªsﬁvî_‰ì
(
ldns_ªsﬁvî
 *
ªs
);

730 
ldns_ªsﬁvî_dìp_‰ì
(
ldns_ªsﬁvî
 *
ªs
);

740 
ldns_º
* 
ldns_ax‰_√xt
(
ldns_ªsﬁvî
 *
ªsﬁvî
);

747 
boﬁ
 
ldns_ax‰_com∂ëe
(c⁄° 
ldns_ªsﬁvî
 *
ªsﬁvî
);

755 
ldns_pkt
 *
ldns_ax‰_œ°_pkt
(c⁄° 
ldns_ªsﬁvî
 *
ªs
);

761 
ldns_ªsﬁvî_«me£rvîs_øndomize
(
ldns_ªsﬁvî
 *
r
);

770 
boﬁ
 
ldns_ªsﬁvî_åu°ed_key
(c⁄° 
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 * 
keys
,Üdns_º_li° * 
åu°ed_keys
);

772 #ifde‡
__˝lu•lus


	@include/ldns/rr.h

18 #i‚de‡
LDNS_RR_H


19 
	#LDNS_RR_H


	)

21 
	~<ldns/comm⁄.h
>

22 
	~<ldns/rd©a.h
>

23 
	~<ldns/buf„r.h
>

24 
	~<ldns/îr‹.h
>

26 #ifde‡
__˝lu•lus


31 
	#LDNS_MAX_LABELLEN
 63

	)

33 
	#LDNS_MAX_DOMAINLEN
 255

	)

35 
	#LDNS_MAX_POINTERS
 65535

	)

37 
	#LDNS_RR_OVERHEAD
 10

	)

40 
	#LDNS_RDATA_FIELD_DESCRIPTORS_COMMON
 258

	)

47 
	eldns_íum_º_˛ass


50 
LDNS_RR_CLASS_IN
 = 1,

52 
LDNS_RR_CLASS_CH
 = 3,

54 
LDNS_RR_CLASS_HS
 = 4,

56 
LDNS_RR_CLASS_NONE
 = 254,

58 
LDNS_RR_CLASS_ANY
 = 255,

60 
LDNS_RR_CLASS_FIRST
 = 0,

61 
LDNS_RR_CLASS_LAST
 = 65535,

62 
LDNS_RR_CLASS_COUNT
 = 
LDNS_RR_CLASS_LAST
 - 
LDNS_RR_CLASS_FIRST
 + 1

64 
ldns_íum_º_˛ass
 
	tldns_º_˛ass
;

69 
	eldns_íum_º_com¥ess


72 
LDNS_RR_COMPRESS
,

73 
LDNS_RR_NO_COMPRESS


75 
ldns_íum_º_com¥ess
 
	tldns_º_com¥ess
;

80 
	eldns_íum_º_ty≥


83 
LDNS_RR_TYPE_A
 = 1,

85 
LDNS_RR_TYPE_NS
 = 2,

87 
LDNS_RR_TYPE_MD
 = 3,

89 
LDNS_RR_TYPE_MF
 = 4,

91 
LDNS_RR_TYPE_CNAME
 = 5,

93 
LDNS_RR_TYPE_SOA
 = 6,

95 
LDNS_RR_TYPE_MB
 = 7,

97 
LDNS_RR_TYPE_MG
 = 8,

99 
LDNS_RR_TYPE_MR
 = 9,

101 
LDNS_RR_TYPE_NULL
 = 10,

103 
LDNS_RR_TYPE_WKS
 = 11,

105 
LDNS_RR_TYPE_PTR
 = 12,

107 
LDNS_RR_TYPE_HINFO
 = 13,

109 
LDNS_RR_TYPE_MINFO
 = 14,

111 
LDNS_RR_TYPE_MX
 = 15,

113 
LDNS_RR_TYPE_TXT
 = 16,

115 
LDNS_RR_TYPE_RP
 = 17,

117 
LDNS_RR_TYPE_AFSDB
 = 18,

119 
LDNS_RR_TYPE_X25
 = 19,

121 
LDNS_RR_TYPE_ISDN
 = 20,

123 
LDNS_RR_TYPE_RT
 = 21,

125 
LDNS_RR_TYPE_NSAP
 = 22,

127 
LDNS_RR_TYPE_NSAP_PTR
 = 23,

129 
LDNS_RR_TYPE_SIG
 = 24,

131 
LDNS_RR_TYPE_KEY
 = 25,

133 
LDNS_RR_TYPE_PX
 = 26,

135 
LDNS_RR_TYPE_GPOS
 = 27,

137 
LDNS_RR_TYPE_AAAA
 = 28,

139 
LDNS_RR_TYPE_LOC
 = 29,

141 
LDNS_RR_TYPE_NXT
 = 30,

143 
LDNS_RR_TYPE_EID
 = 31,

145 
LDNS_RR_TYPE_NIMLOC
 = 32,

147 
LDNS_RR_TYPE_SRV
 = 33,

149 
LDNS_RR_TYPE_ATMA
 = 34,

151 
LDNS_RR_TYPE_NAPTR
 = 35,

153 
LDNS_RR_TYPE_KX
 = 36,

155 
LDNS_RR_TYPE_CERT
 = 37,

157 
LDNS_RR_TYPE_A6
 = 38,

159 
LDNS_RR_TYPE_DNAME
 = 39,

161 
LDNS_RR_TYPE_SINK
 = 40,

163 
LDNS_RR_TYPE_OPT
 = 41,

165 
LDNS_RR_TYPE_APL
 = 42,

167 
LDNS_RR_TYPE_DS
 = 43,

169 
LDNS_RR_TYPE_SSHFP
 = 44,

171 
LDNS_RR_TYPE_IPSECKEY
 = 45,

173 
LDNS_RR_TYPE_RRSIG
 = 46,

174 
LDNS_RR_TYPE_NSEC
 = 47,

175 
LDNS_RR_TYPE_DNSKEY
 = 48,

177 
LDNS_RR_TYPE_DHCID
 = 49,

179 
LDNS_RR_TYPE_NSEC3
 = 50,

180 
LDNS_RR_TYPE_NSEC3PARAM
 = 51,

181 
LDNS_RR_TYPE_NSEC3PARAMS
 = 51,

182 
LDNS_RR_TYPE_TLSA
 = 52,

184 
LDNS_RR_TYPE_HIP
 = 55,

187 
LDNS_RR_TYPE_NINFO
 = 56,

189 
LDNS_RR_TYPE_RKEY
 = 57,

191 
LDNS_RR_TYPE_TALINK
 = 58,

193 
LDNS_RR_TYPE_CDS
 = 59,

195 
LDNS_RR_TYPE_SPF
 = 99,

197 
LDNS_RR_TYPE_UINFO
 = 100,

198 
LDNS_RR_TYPE_UID
 = 101,

199 
LDNS_RR_TYPE_GID
 = 102,

200 
LDNS_RR_TYPE_UNSPEC
 = 103,

202 
LDNS_RR_TYPE_NID
 = 104,

203 
LDNS_RR_TYPE_L32
 = 105,

204 
LDNS_RR_TYPE_L64
 = 106,

205 
LDNS_RR_TYPE_LP
 = 107,

207 
LDNS_RR_TYPE_EUI48
 = 108,

208 
LDNS_RR_TYPE_EUI64
 = 109,

210 
LDNS_RR_TYPE_TKEY
 = 249,

211 
LDNS_RR_TYPE_TSIG
 = 250,

212 
LDNS_RR_TYPE_IXFR
 = 251,

213 
LDNS_RR_TYPE_AXFR
 = 252,

215 
LDNS_RR_TYPE_MAILB
 = 253,

217 
LDNS_RR_TYPE_MAILA
 = 254,

219 
LDNS_RR_TYPE_ANY
 = 255,

221 
LDNS_RR_TYPE_URI
 = 256,

222 
LDNS_RR_TYPE_CAA
 = 257,

225 
LDNS_RR_TYPE_TA
 = 32768,

227 
LDNS_RR_TYPE_DLV
 = 32769,

232 
LDNS_RR_TYPE_FIRST
 = 0,

233 
LDNS_RR_TYPE_LAST
 = 65535,

234 
LDNS_RR_TYPE_COUNT
 = 
LDNS_RR_TYPE_LAST
 - 
LDNS_RR_TYPE_FIRST
 + 1

236 
ldns_íum_º_ty≥
 
	tldns_º_ty≥
;

299 
	sldns_°ru˘_º


302 
ldns_rdf
 *
_ow√r
;

304 
uöt32_t
 
_âl
;

306 
size_t
 
_rd_cou¡
;

308 
ldns_º_ty≥
 
_º_ty≥
;

310 
ldns_º_˛ass
 
_º_˛ass
;

313 
ldns_rdf
 **
_rd©a_fõlds
;

317 
boﬁ
 
_º_que°i⁄
;

319 
ldns_°ru˘_º
 
	tldns_º
;

327 
	sldns_°ru˘_º_li°


329 
size_t
 
_º_cou¡
;

330 
size_t
 
_º_ˇ∑côy
;

331 
ldns_º
 **
_ºs
;

333 
ldns_°ru˘_º_li°
 
	tldns_º_li°
;

340 
	sldns_°ru˘_º_des¸ùt‹


343 
ldns_º_ty≥
 
_ty≥
;

345 c⁄° *
_«me
;

347 
uöt8_t
 
_möimum
;

349 
uöt8_t
 
_maximum
;

351 c⁄° 
ldns_rdf_ty≥
 *
_wúef‹m©
;

353 
ldns_rdf_ty≥
 
_v¨übÀ
;

355 
ldns_º_com¥ess
 
_com¥ess
;

357 
uöt8_t
 
_d«me_cou¡
;

359 
ldns_°ru˘_º_des¸ùt‹
 
	tldns_º_des¸ùt‹
;

368 
ldns_°©us
 
ldns_rdf_bôm≠_known_º_ty≥s_•a˚
(
ldns_rdf
** 
rdf
);

375 
ldns_°©us
 
ldns_rdf_bôm≠_known_º_ty≥s
(
ldns_rdf
** 
rdf
);

382 
ldns_º
* 
ldns_º_√w
();

388 
ldns_º
* 
ldns_º_√w_‰m_ty≥
(
ldns_º_ty≥
 
t
);

395 
ldns_º_‰ì
(
ldns_º
 *
º
);

413 
ldns_°©us
 
ldns_º_√w_‰m_°r
(
ldns_º
 **
n
, c⁄° *
°r
,

414 
uöt32_t
 
deÁu…_âl
, 
ldns_rdf
 *
‹igö
,

415 
ldns_rdf
 **
¥ev
);

430 
ldns_°©us
 
ldns_º_√w_que°i⁄_‰m_°r
(
ldns_º
 **
n
, c⁄° *
°r
,

431 
ldns_rdf
 *
‹igö
,Üdns_rd‡**
¥ev
);

447 
ldns_°©us
 
ldns_º_√w_‰m_Â
(
ldns_º
 **
º
, 
FILE
 *
Â
, 
uöt32_t
 *
deÁu…_âl
, 
ldns_rdf
 **
‹igö
,Üdns_rd‡**
¥ev
);

464 
ldns_°©us
 
ldns_º_√w_‰m_Â_l
(
ldns_º
 **
º
, 
FILE
 *
Â
, 
uöt32_t
 *
deÁu…_âl
, 
ldns_rdf
 **
‹igö
,Üdns_rd‡**
¥ev
, *
löe_ƒ
);

472 
ldns_º_£t_ow√r
(
ldns_º
 *
º
, 
ldns_rdf
 *
ow√r
);

480 
ldns_º_£t_que°i⁄
(
ldns_º
 *
º
, 
boﬁ
 
que°i⁄
);

488 
ldns_º_£t_âl
(
ldns_º
 *
º
, 
uöt32_t
 
âl
);

496 
ldns_º_£t_rd_cou¡
(
ldns_º
 *
º
, 
size_t
 
cou¡
);

504 
ldns_º_£t_ty≥
(
ldns_º
 *
º
, 
ldns_º_ty≥
 
º_ty≥
);

512 
ldns_º_£t_˛ass
(
ldns_º
 *
º
, 
ldns_º_˛ass
 
º_˛ass
);

522 
ldns_rdf
* 
ldns_º_£t_rdf
(
ldns_º
 *
º
, c⁄°Üdns_rd‡*
f
, 
size_t
 
posôi⁄
);

531 
boﬁ
 
ldns_º_push_rdf
(
ldns_º
 *
º
, c⁄° 
ldns_rdf
 *
f
);

539 
ldns_rdf
* 
ldns_º_p›_rdf
(
ldns_º
 *
º
);

547 
ldns_rdf
* 
ldns_º_rdf
(c⁄° 
ldns_º
 *
º
, 
size_t
 
ƒ
);

554 
ldns_rdf
* 
ldns_º_ow√r
(c⁄° 
ldns_º
 *
º
);

561 
boﬁ
 
ldns_º_is_que°i⁄
(c⁄° 
ldns_º
 *
º
);

568 
uöt32_t
 
ldns_º_âl
(c⁄° 
ldns_º
 *
º
);

575 
size_t
 
ldns_º_rd_cou¡
(c⁄° 
ldns_º
 *
º
);

582 
ldns_º_ty≥
 
ldns_º_gë_ty≥
(c⁄° 
ldns_º
 *
º
);

589 
ldns_º_˛ass
 
ldns_º_gë_˛ass
(c⁄° 
ldns_º
 *
º
);

598 
size_t
 
ldns_º_li°_º_cou¡
(c⁄° 
ldns_º_li°
 *
º_li°
);

606 
ldns_º_li°_£t_º_cou¡
(
ldns_º_li°
 *
º_li°
, 
size_t
 
cou¡
);

616 
ldns_º
 * 
ldns_º_li°_£t_º
(
ldns_º_li°
 *
º_li°
, c⁄°Üdns_º *
r
, 
size_t
 
cou¡
);

624 
ldns_º
* 
ldns_º_li°_º
(c⁄° 
ldns_º_li°
 *
º_li°
, 
size_t
 
ƒ
);

630 
ldns_º_li°
* 
ldns_º_li°_√w
();

636 
ldns_º_li°_‰ì
(
ldns_º_li°
 *
º_li°
);

642 
ldns_º_li°_dìp_‰ì
(
ldns_º_li°
 *
º_li°
);

651 
boﬁ
 
ldns_º_li°_ˇt
(
ldns_º_li°
 *
À·
,Üdns_º_li° *
right
);

660 
ldns_º_li°
* 
ldns_º_li°_ˇt_˛⁄e
÷dns_º_li° *
À·
,Üdns_º_li° *
right
);

668 
boﬁ
 
ldns_º_li°_push_º
(
ldns_º_li°
 *
º_li°
, c⁄° 
ldns_º
 *
º
);

676 
boﬁ
 
ldns_º_li°_push_º_li°
(
ldns_º_li°
 *
º_li°
, c⁄°Üdns_º_li° *
push_li°
);

683 
ldns_º
* 
ldns_º_li°_p›_º
(
ldns_º_li°
 *
º_li°
);

691 
ldns_º_li°
* 
ldns_º_li°_p›_º_li°
÷dns_º_li° *
º_li°
, 
size_t
 
size
);

700 
boﬁ
 
ldns_º_li°_c⁄èös_º
(c⁄° 
ldns_º_li°
 *
º_li°
, 
ldns_º
 *
º
);

707 
boﬁ
 
ldns_is_º£t
(
ldns_º_li°
 *
º_li°
);

715 
boﬁ
 
ldns_º_£t_push_º
(
ldns_º_li°
 *
º_li°
, 
ldns_º
 *
º
);

724 
ldns_º
* 
ldns_º_£t_p›_º
(
ldns_º_li°
 *
º_li°
);

731 
ldns_º_li°
 *
ldns_º_li°_p›_º£t
÷dns_º_li° *
º_li°
);

739 
ldns_º_ty≥
 
ldns_gë_º_ty≥_by_«me
(c⁄° *
«me
);

746 
ldns_º_˛ass
 
ldns_gë_º_˛ass_by_«me
(c⁄° *
«me
);

753 
ldns_º
* 
ldns_º_˛⁄e
(c⁄°Üdns_º *
º
);

760 
ldns_º_li°
* 
ldns_º_li°_˛⁄e
(c⁄°Üdns_º_li° *
ºli°
);

767 
ldns_º_li°_s‹t
(
ldns_º_li°
 *
uns‹ãd
);

777 
ldns_º_com∑ª
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
);

787 
ldns_º_com∑ª_no_rd©a
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
);

797 
ldns_º_com∑ª_wúe
(
ldns_buf„r
 *
º1_buf
,Üdns_buf„∏*
º2_buf
);

807 
boﬁ
 
ldns_º_com∑ª_ds
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
);

817 
ldns_º_li°_com∑ª
(c⁄° 
ldns_º_li°
 *
ºl1
, c⁄°Üdns_º_li° *
ºl2
);

824 
size_t
 
ldns_º_uncom¥es£d_size
(c⁄° 
ldns_º
 *
r
);

831 
ldns_º2ˇn⁄iˇl
(
ldns_º
 *
º
);

838 
ldns_º_li°2ˇn⁄iˇl
(
ldns_º_li°
 *
º_li°
);

845 
uöt8_t
 
ldns_º_œbñ_cou¡
(
ldns_º
 *
º
);

853 c⁄° 
ldns_º_des¸ùt‹
 *
ldns_º_des¸ùt
(
uöt16_t
 
ty≥
);

861 
size_t
 
ldns_º_des¸ùt‹_möimum
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
);

869 
size_t
 
ldns_º_des¸ùt‹_maximum
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
);

878 
ldns_rdf_ty≥
 
ldns_º_des¸ùt‹_fõld_ty≥
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
, 
size_t
 
fõld
);

891 
ldns_º_li°
 *
ldns_º_li°_subty≥_by_rdf
÷dns_º_li° *
l
, 
ldns_rdf
 *
r
, 
size_t
 
pos
);

901 
ldns_º_ty≥
 
ldns_rdf2º_ty≥
(c⁄° 
ldns_rdf
 *
rd
);

910 
ldns_º_ty≥


911 
ldns_º_li°_ty≥
(c⁄° 
ldns_º_li°
 *
º_li°
);

920 
ldns_rdf
 *

921 
ldns_º_li°_ow√r
(c⁄° 
ldns_º_li°
 *
º_li°
);

923 #ifde‡
__˝lu•lus


	@include/ldns/rr_functions.h

13 #i‚de‡
LDNS_RR_FUNCTIONS_H


14 
	#LDNS_RR_FUNCTIONS_H


	)

16 #ifde‡
__˝lu•lus


32 
ldns_rdf
* 
ldns_º_a_addªss
(c⁄° 
ldns_º
 *
r
);

40 
boﬁ
 
ldns_º_a_£t_addªss
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

48 
ldns_rdf
* 
ldns_º_ns_nsd«me
(c⁄° 
ldns_º
 *
r
);

56 
ldns_rdf
* 
ldns_º_mx_¥e„ªn˚
(c⁄° 
ldns_º
 *
r
);

62 
ldns_rdf
* 
ldns_º_mx_exch™ge
(c⁄° 
ldns_º
 *
r
);

70 
ldns_rdf
* 
ldns_º_ºsig_ty≥covîed
(c⁄° 
ldns_º
 *
r
);

77 
boﬁ
 
ldns_º_ºsig_£t_ty≥covîed
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

83 
ldns_rdf
* 
ldns_º_ºsig_Æg‹ôhm
(c⁄° 
ldns_º
 *
r
);

90 
boﬁ
 
ldns_º_ºsig_£t_Æg‹ôhm
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

96 
ldns_rdf
 *
ldns_º_ºsig_œbñs
(c⁄° 
ldns_º
 *
r
);

103 
boﬁ
 
ldns_º_ºsig_£t_œbñs
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

109 
ldns_rdf
* 
ldns_º_ºsig_‹igâl
(c⁄° 
ldns_º
 *
r
);

116 
boﬁ
 
ldns_º_ºsig_£t_‹igâl
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

122 
ldns_rdf
* 
ldns_º_ºsig_expú©i⁄
(c⁄° 
ldns_º
 *
r
);

129 
boﬁ
 
ldns_º_ºsig_£t_expú©i⁄
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

135 
ldns_rdf
* 
ldns_º_ºsig_ö˚±i⁄
(c⁄° 
ldns_º
 *
r
);

142 
boﬁ
 
ldns_º_ºsig_£t_ö˚±i⁄
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

148 
ldns_rdf
* 
ldns_º_ºsig_keyèg
(c⁄° 
ldns_º
 *
r
);

155 
boﬁ
 
ldns_º_ºsig_£t_keyèg
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

161 
ldns_rdf
* 
ldns_º_ºsig_sig«me
(c⁄° 
ldns_º
 *
r
);

168 
boﬁ
 
ldns_º_ºsig_£t_sig«me
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

174 
ldns_rdf
* 
ldns_º_ºsig_sig
(c⁄° 
ldns_º
 *
r
);

181 
boﬁ
 
ldns_º_ºsig_£t_sig
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

189 
ldns_rdf
* 
ldns_º_dnskey_Êags
(c⁄° 
ldns_º
 *
r
);

196 
boﬁ
 
ldns_º_dnskey_£t_Êags
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

202 
ldns_rdf
* 
ldns_º_dnskey_¥Ÿocﬁ
(c⁄° 
ldns_º
 *
r
);

209 
boﬁ
 
ldns_º_dnskey_£t_¥Ÿocﬁ
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

215 
ldns_rdf
* 
ldns_º_dnskey_Æg‹ôhm
(c⁄° 
ldns_º
 *
r
);

222 
boﬁ
 
ldns_º_dnskey_£t_Æg‹ôhm
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

228 
ldns_rdf
* 
ldns_º_dnskey_key
(c⁄° 
ldns_º
 *
r
);

235 
boﬁ
 
ldns_º_dnskey_£t_key
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

244 
size_t
 
ldns_º_dnskey_key_size_øw
(c⁄° *
keyd©a
,

245 c⁄° 
size_t
 
Àn
,

246 c⁄° 
ldns_Æg‹ôhm
 
Æg
);

253 
size_t
 
ldns_º_dnskey_key_size
(c⁄° 
ldns_º
 *
key
);

266 
uöt32_t
 (*
	tldns_sﬂ_£rül_ö¸emít_func_t
)(
	tuöt32_t
, *);

274 
uöt32_t
 
ldns_sﬂ_£rül_idítôy
(uöt32_à
unu£d
, *
d©a
);

282 
uöt32_t
 
ldns_sﬂ_£rül_ö¸emít
(uöt32_à
s
, *
unu£d
);

290 
uöt32_t
 
ldns_sﬂ_£rül_ö¸emít_by
(uöt32_à
s
, *
d©a
);

303 
uöt32_t
 
ldns_sﬂ_£rül_unixtime
(uöt32_à
s
, *
d©a
);

316 
uöt32_t
 
ldns_sﬂ_£rül_d©ecou¡î
(uöt32_à
s
, *
d©a
);

322 
ldns_º_sﬂ_ö¸emít
(

323 
ldns_º
 *
sﬂ
);

332 
ldns_º_sﬂ_ö¸emít_func
(

333 
ldns_º
 *
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
);

342 
ldns_º_sﬂ_ö¸emít_func_d©a
(

343 
ldns_º
 *
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
, *
d©a
);

356 
ldns_º_sﬂ_ö¸emít_func_öt
(

357 
ldns_º
 *
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
, 
d©a
);

359 #ifde‡
__˝lu•lus


	@include/ldns/sha1.h

1 #i‚de‡
LDNS_SHA1_H


2 
	#LDNS_SHA1_H


	)

4 #ifde‡
__˝lu•lus


8 
	#LDNS_SHA1_BLOCK_LENGTH
 64

	)

9 
	#LDNS_SHA1_DIGEST_LENGTH
 20

	)

12 
uöt32_t
 
°©e
[5];

13 
uöt64_t
 
cou¡
;

14 
buf„r
[
LDNS_SHA1_BLOCK_LENGTH
];

15 } 
	tldns_sha1_˘x
;

17 
ldns_sha1_öô
(
ldns_sha1_˘x
 * 
c⁄ãxt
);

18 
ldns_sha1_å™sf‹m
(
uöt32_t
 
°©e
[5], c⁄° 
buf„r
[
LDNS_SHA1_BLOCK_LENGTH
]);

19 
ldns_sha1_upd©e
(
ldns_sha1_˘x
 *
c⁄ãxt
, c⁄° *
d©a
, 
Àn
);

20 
ldns_sha1_föÆ
(
dige°
[
LDNS_SHA1_DIGEST_LENGTH
], 
ldns_sha1_˘x
 *
c⁄ãxt
);

32 *
ldns_sha1
(*
d©a
, 
d©a_Àn
, *
dige°
);

34 #ifde‡
__˝lu•lus


	@include/ldns/sha2.h

46 #i‚de‡
__LDNS_SHA2_H__


47 
	#__LDNS_SHA2_H__


	)

49 #ifde‡
__˝lu•lus


59 
	~<sys/ty≥s.h
>

61 #i‡
LDNS_BUILD_CONFIG_HAVE_INTTYPES_H


63 
	~<öây≥s.h
>

69 
	#LDNS_SHA256_BLOCK_LENGTH
 64

	)

70 
	#LDNS_SHA256_DIGEST_LENGTH
 32

	)

71 
	#LDNS_SHA256_DIGEST_STRING_LENGTH
 (
LDNS_SHA256_DIGEST_LENGTH
 * 2 + 1)

	)

72 
	#LDNS_SHA384_BLOCK_LENGTH
 128

	)

73 
	#LDNS_SHA384_DIGEST_LENGTH
 48

	)

74 
	#LDNS_SHA384_DIGEST_STRING_LENGTH
 (
LDNS_SHA384_DIGEST_LENGTH
 * 2 + 1)

	)

75 
	#LDNS_SHA512_BLOCK_LENGTH
 128

	)

76 
	#LDNS_SHA512_DIGEST_LENGTH
 64

	)

77 
	#LDNS_SHA512_DIGEST_STRING_LENGTH
 (
LDNS_SHA512_DIGEST_LENGTH
 * 2 + 1)

	)

82 
	s_ldns_sha256_CTX
 {

83 
uöt32_t
 
°©e
[8];

84 
uöt64_t
 
bôcou¡
;

85 
uöt8_t
 
buf„r
[
LDNS_SHA256_BLOCK_LENGTH
];

86 } 
	tldns_sha256_CTX
;

87 
	s_ldns_sha512_CTX
 {

88 
uöt64_t
 
°©e
[8];

89 
uöt64_t
 
bôcou¡
[2];

90 
uöt8_t
 
buf„r
[
LDNS_SHA512_BLOCK_LENGTH
];

91 } 
	tldns_sha512_CTX
;

93 
ldns_sha512_CTX
 
	tldns_sha384_CTX
;

97 
ldns_sha256_öô
(
ldns_sha256_CTX
 *);

98 
ldns_sha256_upd©e
(
ldns_sha256_CTX
*, c⁄° 
uöt8_t
*, 
size_t
);

99 
ldns_sha256_föÆ
(
uöt8_t
[
LDNS_SHA256_DIGEST_LENGTH
], 
ldns_sha256_CTX
*);

101 
ldns_sha384_öô
(
ldns_sha384_CTX
*);

102 
ldns_sha384_upd©e
(
ldns_sha384_CTX
*, c⁄° 
uöt8_t
*, 
size_t
);

103 
ldns_sha384_föÆ
(
uöt8_t
[
LDNS_SHA384_DIGEST_LENGTH
], 
ldns_sha384_CTX
*);

105 
ldns_sha512_öô
(
ldns_sha512_CTX
*);

106 
ldns_sha512_upd©e
(
ldns_sha512_CTX
*, c⁄° 
uöt8_t
*, 
size_t
);

107 
ldns_sha512_föÆ
(
uöt8_t
[
LDNS_SHA512_DIGEST_LENGTH
], 
ldns_sha512_CTX
*);

119 *
ldns_sha256
(*
d©a
, 
d©a_Àn
, *
dige°
);

131 *
ldns_sha384
(*
d©a
, 
d©a_Àn
, *
dige°
);

143 *
ldns_sha512
(*
d©a
, 
d©a_Àn
, *
dige°
);

145 #ifdef 
__˝lu•lus


	@include/ldns/str2host.h

11 #i‚de‡
LDNS_2HOST_H


12 
	#LDNS_2HOST_H


	)

14 
	~<ldns/comm⁄.h
>

15 
	~<ldns/îr‹.h
>

16 
	~<ldns/º.h
>

17 
	~<ldns/rd©a.h
>

18 
	~<ldns/∑ckë.h
>

19 
	~<ldns/buf„r.h
>

20 
	~<˘y≥.h
>

22 #ifde‡
__˝lu•lus


39 
ldns_°©us
 
ldns_°r2rdf_öt8
(
ldns_rdf
 **
rd
, c⁄° *
byã°r
);

47 
ldns_°©us
 
ldns_°r2rdf_öt16
(
ldns_rdf
 **
rd
, c⁄° *
sh‹t°r
);

55 
ldns_°©us
 
ldns_°r2rdf_öt32
(
ldns_rdf
 **
rd
, c⁄° *
l⁄g°r
);

63 
ldns_°©us
 
ldns_°r2rdf_time
(
ldns_rdf
 **
rd
, c⁄° *
time
);

70 
ldns_°©us
 
ldns_°r2rdf_n£c3_ß…
(
ldns_rdf
 **
rd
, c⁄° *
n£c3_ß…
);

77 
ldns_°©us
 
ldns_°r2rdf_≥riod
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

85 
ldns_°©us
 
ldns_°r2rdf_a
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

93 
ldns_°©us
 
ldns_°r2rdf_ØØ
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

101 
ldns_°©us
 
ldns_°r2rdf_°r
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

109 
ldns_°©us
 
ldns_°r2rdf_≠l
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

117 
ldns_°©us
 
ldns_°r2rdf_b64
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

125 
ldns_°©us
 
ldns_°r2rdf_b32_ext
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

133 
ldns_°©us
 
ldns_°r2rdf_hex
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

141 
ldns_°©us
 
ldns_°r2rdf_n£c
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

149 
ldns_°©us
 
ldns_°r2rdf_ty≥
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

157 
ldns_°©us
 
ldns_°r2rdf_˛ass
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

165 
ldns_°©us
 
ldns_°r2rdf_˚π_Æg
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

173 
ldns_°©us
 
ldns_°r2rdf_Æg
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

181 
ldns_°©us
 
ldns_°r2rdf_unknown
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

189 
ldns_°©us
 
ldns_°r2rdf_£rvi˚
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

197 
ldns_°©us
 
ldns_°r2rdf_loc
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

205 
ldns_°©us
 
ldns_°r2rdf_wks
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

213 
ldns_°©us
 
ldns_°r2rdf_nßp
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

221 
ldns_°©us
 
ldns_°r2rdf_©ma
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

229 
ldns_°©us
 
ldns_°r2rdf_ù£ckey
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

237 
ldns_°©us
 
ldns_°r2rdf_d«me
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

245 
ldns_°©us
 
ldns_°r2rdf_û≈64
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

253 
ldns_°©us
 
ldns_°r2rdf_eui48
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

261 
ldns_°©us
 
ldns_°r2rdf_eui64
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

269 
ldns_°©us
 
ldns_°r2rdf_èg
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

278 
ldns_°©us
 
ldns_°r2rdf_l⁄g_°r
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

288 
ldns_°©us
 
ldns_°r2rdf_hù
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

291 #ifde‡
__˝lu•lus


	@include/ldns/tsig.h

9 #i‚de‡
LDNS_TSIG_H


10 
	#LDNS_TSIG_H


	)

12 #ifde‡
__˝lu•lus


26 
	sldns_tsig_¸edítüls_°ru˘


28 *
Æg‹ôhm
;

29 *
key«me
;

30 *
keyd©a
;

32 } 
	tldns_tsig_¸edítüls
;

34 *
ldns_tsig_Æg‹ôhm
(
ldns_tsig_¸edítüls
 *);

35 *
ldns_tsig_key«me
(
ldns_tsig_¸edítüls
 *);

36 *
ldns_tsig_keyd©a
(
ldns_tsig_¸edítüls
 *);

37 *
ldns_tsig_key«me_˛⁄e
(
ldns_tsig_¸edítüls
 *);

38 *
ldns_tsig_keyd©a_˛⁄e
(
ldns_tsig_¸edítüls
 *);

51 
boﬁ
 
ldns_pkt_tsig_vîify
(
ldns_pkt
 *
pkt
, 
uöt8_t
 *
wúe
, 
size_t
 
wúe_size
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
ldns_rdf
 *
mac
);

66 
boﬁ
 
ldns_pkt_tsig_vîify_√xt
(
ldns_pkt
 *
pkt
, 
uöt8_t
 *
wúe
, 
size_t
 
wúe_size
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
ldns_rdf
 *
mac
,

67 
tsig_timîs_⁄ly
);

79 
ldns_°©us
 
ldns_pkt_tsig_sign
(
ldns_pkt
 *
pkt
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
uöt16_t
 
fudge
,

80 c⁄° *
Æg‹ôhm_«me
, 
ldns_rdf
 *
quîy_mac
);

94 
ldns_°©us
 
ldns_pkt_tsig_sign_√xt
(
ldns_pkt
 *
pkt
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
uöt16_t
 
fudge
,

95 c⁄° *
Æg‹ôhm_«me
, 
ldns_rdf
 *
quîy_mac
, 
tsig_timîs_⁄ly
);

97 #ifde‡
__˝lu•lus


	@include/ldns/update.h

18 #i‚de‡
LDNS_UPDATE_H


19 
	#LDNS_UPDATE_H


	)

21 
	~<ldns/ªsﬁvî.h
>

23 #ifde‡
__˝lu•lus


36 
ldns_pkt
 *
ldns_upd©e_pkt_√w
(
ldns_rdf
 *
z⁄e_rdf
, 
ldns_º_˛ass
 
˛as
, 
ldns_º_li°
 *
¥_ºli°
,Üdns_º_li° *
up_ºli°
,Üdns_º_li° *
ad_ºli°
);

46 
ldns_°©us
 
ldns_upd©e_pkt_tsig_add
(
ldns_pkt
 *
p
, 
ldns_ªsﬁvî
 *
r
);

55 
uöt16_t
 
ldns_upd©e_zocou¡
(c⁄° 
ldns_pkt
 *
p
);

61 
uöt16_t
 
ldns_upd©e_¥cou¡
(c⁄° 
ldns_pkt
 *
p
);

67 
uöt16_t
 
ldns_upd©e_upcou¡
(c⁄° 
ldns_pkt
 *
p
);

73 
uöt16_t
 
ldns_upd©e_ad
(c⁄° 
ldns_pkt
 *
p
);

79 
ldns_upd©e_£t_zo
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

85 
ldns_upd©e_£t_¥cou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

91 
ldns_upd©e_£t_upcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

97 
ldns_upd©e_£t_adcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

104 
ldns_°©us
 
ldns_upd©e_sﬂ_m«me
(
ldns_rdf
 *
z⁄e
, 
ldns_ªsﬁvî
 *
r
, 
ldns_º_˛ass
 
c
,Üdns_rd‡**
m«me
);

109 
ldns_°©us
 
ldns_upd©e_sﬂ_z⁄e_m«me
(c⁄° *
fqdn
, 
ldns_ªsﬁvî
 *
r
, 
ldns_º_˛ass
 
c
, 
ldns_rdf
 **
z⁄e_rdf
,Üdns_rd‡**
m«me_rdf
);

111 #ifde‡
__˝lu•lus


	@include/ldns/util.h

13 #i‚de‡
_UTIL_H


14 
	#_UTIL_H


	)

16 
	~<öây≥s.h
>

17 
	~<sys/ty≥s.h
>

18 
	~<uni°d.h
>

19 
	~<ldns/comm⁄.h
>

20 
	~<time.h
>

21 
	~<°dio.h
>

23 #ifde‡
__˝lu•lus


27 
	#d¥ötf
(
X
,
Y
Ë
	`Ârötf
(
°dîr
, (X), (Y))

	)

30 
	#LDNS_VERSION
 "1.6.17"

	)

31 
	#LDNS_REVISION
 ((1<<16)|(6<<8)|(17))

	)

36 #ifde‡
S_SPLINT_S


37 
	#INLINE


	)

39 #ifde‡
SWIG


40 
	#INLINE
 

	)

42 
	#INLINE
 
ölöe


	)

49 
	#LDNS_MALLOC
(
ty≥
Ë
	`LDNS_XMALLOC
—y≥, 1)

	)

51 
	#LDNS_XMALLOC
(
ty≥
, 
cou¡
Ë(—y≥ *Ë
	`mÆloc
((cou¡Ë* —y≥)))

	)

53 
	#LDNS_CALLOC
(
ty≥
, 
cou¡
Ë(—y≥ *Ë
	`ˇŒoc
((cou¡), —y≥)))

	)

55 
	#LDNS_REALLOC
(
±r
, 
ty≥
Ë
	`LDNS_XREALLOC
(’å),Åy≥, 1)

	)

57 
	#LDNS_XREALLOC
(
±r
, 
ty≥
, 
cou¡
) \

58 ((
ty≥
 *Ë
	`ªÆloc
((
±r
), (
cou¡
Ë* —y≥)))

	)

60 
	#LDNS_FREE
(
±r
) \

61 dÿ{ 
	`‰ì
((
±r
)); (±rË
NULL
; } 0)

	)

63 
	#LDNS_DEP
 
	`¥ötf
("DEPRECATED FUNCTION!\n");

	)

69 
INLINE
 
uöt16_t


70 
ldns_ªad_uöt16
(c⁄° *
§c
)

72 #ifde‡
ALLOW_UNALIGNED_ACCESSES


73  
¡ohs
(*(
uöt16_t
 *Ë
§c
);

75 
uöt8_t
 *
p
 = (uöt8_à*Ë
§c
;

76  ((
uöt16_t
Ë
p
[0] << 8) | (uint16_t)Ö[1];

80 
INLINE
 
uöt32_t


81 
ldns_ªad_uöt32
(c⁄° *
§c
)

83 #ifde‡
ALLOW_UNALIGNED_ACCESSES


84  
¡ohl
(*(
uöt32_t
 *Ë
§c
);

86 
uöt8_t
 *
p
 = (uöt8_à*Ë
§c
;

87  ( ((
uöt32_t
Ë
p
[0] << 24)

88 | ((
uöt32_t
Ë
p
[1] << 16)

89 | ((
uöt32_t
Ë
p
[2] << 8)

90 | (
uöt32_t
Ë
p
[3]);

98 
INLINE
 

99 
ldns_wrôe_uöt16
(*
d°
, 
uöt16_t
 
d©a
)

101 #ifde‡
ALLOW_UNALIGNED_ACCESSES


102 * (
uöt16_t
 *Ë
d°
 = 
ht⁄s
(
d©a
);

104 
uöt8_t
 *
p
 = (uöt8_à*Ë
d°
;

105 
p
[0] = (
uöt8_t
Ë((
d©a
 >> 8) & 0xff);

106 
p
[1] = (
uöt8_t
Ë(
d©a
 & 0xff);

110 
INLINE
 

111 
ldns_wrôe_uöt32
(*
d°
, 
uöt32_t
 
d©a
)

113 #ifde‡
ALLOW_UNALIGNED_ACCESSES


114 * (
uöt32_t
 *Ë
d°
 = 
ht⁄l
(
d©a
);

116 
uöt8_t
 *
p
 = (uöt8_à*Ë
d°
;

117 
p
[0] = (
uöt8_t
Ë((
d©a
 >> 24) & 0xff);

118 
p
[1] = (
uöt8_t
Ë((
d©a
 >> 16) & 0xff);

119 
p
[2] = (
uöt8_t
Ë((
d©a
 >> 8) & 0xff);

120 
p
[3] = (
uöt8_t
Ë(
d©a
 & 0xff);

125 
INLINE
 

126 
ldns_wrôe_uöt64_as_uöt48
(*
d°
, 
uöt64_t
 
d©a
)

128 
uöt8_t
 *
p
 = (uöt8_à*Ë
d°
;

129 
p
[0] = (
uöt8_t
Ë((
d©a
 >> 40) & 0xff);

130 
p
[1] = (
uöt8_t
Ë((
d©a
 >> 32) & 0xff);

131 
p
[2] = (
uöt8_t
Ë((
d©a
 >> 24) & 0xff);

132 
p
[3] = (
uöt8_t
Ë((
d©a
 >> 16) & 0xff);

133 
p
[4] = (
uöt8_t
Ë((
d©a
 >> 8) & 0xff);

134 
p
[5] = (
uöt8_t
Ë(
d©a
 & 0xff);

144 
	sldns_schw¨tzün_com∑ª_°ru˘
 {

145 *
‹igöÆ_obje˘
;

146 *
å™sf‹med_obje˘
;

156 
	sldns_°ru˘_lookup_èbÀ
 {

157 
id
;

158 c⁄° *
«me
;

160 
ldns_°ru˘_lookup_èbÀ
 
	tldns_lookup_èbÀ
;

168 
ldns_lookup_èbÀ
 *
ldns_lookup_by_«me
÷dns_lookup_èbÀ 
èbÀ
[],

169 c⁄° *
«me
);

177 
ldns_lookup_èbÀ
 *
ldns_lookup_by_id
÷dns_lookup_èbÀ 
èbÀ
[], 
id
);

187 
ldns_gë_bô
(
uöt8_t
 
bôs
[], 
size_t
 
ödex
);

198 
ldns_gë_bô_r
(
uöt8_t
 
bôs
[], 
size_t
 
ödex
);

210 
ldns_£t_bô
(
uöt8_t
 *
byã
, 
bô_ƒ
, 
boﬁ
 
vÆue
);

217 
INLINE
 

218 
ldns_powî
(
a
, 
b
) {

219 
ªsu…
 = 1;

220 
b
 > 0) {

221 i‡(
b
 & 1) {

222 
ªsu…
 *
a
;

223 i‡(
b
 == 1) {

224  
ªsu…
;

227 
a
 *=á;

228 
b
 /= 2;

230  
ªsu…
;

238 
ldns_hexdigô_to_öt
(
ch
);

245 
ldns_öt_to_hexdigô
(
ch
);

257 
ldns_hex°rög_to_d©a
(
uöt8_t
 *
d©a
, c⁄° *
°r
);

263 c⁄° * 
ldns_vîsi⁄
();

271 
time_t
 
ldns_mktime_‰om_utc
(c⁄° 
tm
 *tm);

273 
time_t
 
mktime_‰om_utc
(c⁄° 
tm
 *tm);

289 
tm
 * 
ldns_£rül_¨ôhmôics_gmtime_r
(
öt32_t
 
time
, 
time_t
 
now
, tm *
ªsu…
);

310 
ldns_öô_øndom
(
FILE
 *
fd
, 
size
);

317 
uöt16_t
 
ldns_gë_øndom
();

326 *
ldns_bubbÀbabbÀ
(
uöt8_t
 *
d©a
, 
size_t
 
Àn
);

329 
INLINE
 
time_t
 
ldns_time
—ime_à*
t
Ë{  
time
(t); }

336 
INLINE
 
size_t
 
ldns_b32_¡›_ˇlcuœã_size
(size_à
§c_d©a_Àngth
)

338  
§c_d©a_Àngth
 == 0 ? 0 : ((src_data_length - 1) / 5 + 1) * 8;

341 
INLINE
 
size_t
 
ldns_b32_¡›_ˇlcuœã_size_no_∑ddög
(size_à
§c_d©a_Àngth
)

343  ((
§c_d©a_Àngth
 + 3) * 8 / 5) - 4;

346 
ldns_b32_¡›
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

347 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

349 
ldns_b32_¡›_exãnded_hex
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

350 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

352 #i‡! 
LDNS_BUILD_CONFIG_HAVE_B32_NTOP


354 
b32_¡›
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

355 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

357 
b32_¡›_exãnded_hex
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

358 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

367 
INLINE
 
size_t
 
ldns_b32_±⁄_ˇlcuœã_size
(size_à
§c_ãxt_Àngth
)

369  
§c_ãxt_Àngth
 * 5 / 8;

372 
ldns_b32_±⁄
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

373 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

375 
ldns_b32_±⁄_exãnded_hex
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

376 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

378 #i‡! 
LDNS_BUILD_CONFIG_HAVE_B32_PTON


380 
b32_±⁄
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

381 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

383 
b32_±⁄_exãnded_hex
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

384 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

389 #ifde‡
__˝lu•lus


	@include/ldns/wire2host.h

18 #i‚de‡
LDNS_WIRE2HOST_H


19 
	#LDNS_WIRE2HOST_H


	)

21 
	~<ldns/rd©a.h
>

22 
	~<ldns/comm⁄.h
>

23 
	~<ldns/îr‹.h
>

24 
	~<ldns/º.h
>

25 
	~<ldns/∑ckë.h
>

27 #ifde‡
__˝lu•lus


32 
	#LDNS_HEADER_SIZE
 12

	)

35 
	#LDNS_RD_MASK
 0x01U

	)

36 
	#LDNS_RD_SHIFT
 0

	)

37 
	#LDNS_RD_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_RD_MASK
)

	)

38 
	#LDNS_RD_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_RD_MASK
)

	)

39 
	#LDNS_RD_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_RD_MASK
)

	)

41 
	#LDNS_TC_MASK
 0x02U

	)

42 
	#LDNS_TC_SHIFT
 1

	)

43 
	#LDNS_TC_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_TC_MASK
)

	)

44 
	#LDNS_TC_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_TC_MASK
)

	)

45 
	#LDNS_TC_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_TC_MASK
)

	)

47 
	#LDNS_AA_MASK
 0x04U

	)

48 
	#LDNS_AA_SHIFT
 2

	)

49 
	#LDNS_AA_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_AA_MASK
)

	)

50 
	#LDNS_AA_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_AA_MASK
)

	)

51 
	#LDNS_AA_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_AA_MASK
)

	)

53 
	#LDNS_OPCODE_MASK
 0x78U

	)

54 
	#LDNS_OPCODE_SHIFT
 3

	)

55 
	#LDNS_OPCODE_WIRE
(
wúebuf
Ë((*(wúebuf+2Ë& 
LDNS_OPCODE_MASK
Ë>> 
LDNS_OPCODE_SHIFT
)

	)

56 
	#LDNS_OPCODE_SET
(
wúebuf
, 
›code
) \

57 (*(
wúebuf
+2Ë((*(wúebuf+2)Ë& ~
LDNS_OPCODE_MASK
Ë| ((
›code
Ë<< 
LDNS_OPCODE_SHIFT
))

	)

59 
	#LDNS_QR_MASK
 0x80U

	)

60 
	#LDNS_QR_SHIFT
 7

	)

61 
	#LDNS_QR_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_QR_MASK
)

	)

62 
	#LDNS_QR_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_QR_MASK
)

	)

63 
	#LDNS_QR_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_QR_MASK
)

	)

66 
	#LDNS_RCODE_MASK
 0x0fU

	)

67 
	#LDNS_RCODE_SHIFT
 0

	)

68 
	#LDNS_RCODE_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_RCODE_MASK
)

	)

69 
	#LDNS_RCODE_SET
(
wúebuf
, 
rcode
) \

70 (*(
wúebuf
+3Ë((*(wúebuf+3)Ë& ~
LDNS_RCODE_MASK
Ë| (
rcode
))

	)

72 
	#LDNS_CD_MASK
 0x10U

	)

73 
	#LDNS_CD_SHIFT
 4

	)

74 
	#LDNS_CD_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_CD_MASK
)

	)

75 
	#LDNS_CD_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_CD_MASK
)

	)

76 
	#LDNS_CD_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_CD_MASK
)

	)

78 
	#LDNS_AD_MASK
 0x20U

	)

79 
	#LDNS_AD_SHIFT
 5

	)

80 
	#LDNS_AD_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_AD_MASK
)

	)

81 
	#LDNS_AD_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_AD_MASK
)

	)

82 
	#LDNS_AD_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_AD_MASK
)

	)

84 
	#LDNS_Z_MASK
 0x40U

	)

85 
	#LDNS_Z_SHIFT
 6

	)

86 
	#LDNS_Z_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_Z_MASK
)

	)

87 
	#LDNS_Z_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_Z_MASK
)

	)

88 
	#LDNS_Z_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_Z_MASK
)

	)

90 
	#LDNS_RA_MASK
 0x80U

	)

91 
	#LDNS_RA_SHIFT
 7

	)

92 
	#LDNS_RA_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_RA_MASK
)

	)

93 
	#LDNS_RA_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_RA_MASK
)

	)

94 
	#LDNS_RA_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_RA_MASK
)

	)

97 
	#LDNS_ID_WIRE
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf))

	)

98 
	#LDNS_ID_SET
(
wúebuf
, 
id
Ë(
	`ldns_wrôe_uöt16
(wúebuf, id))

	)

101 
	#LDNS_QDCOUNT_OFF
 4

	)

105 
	#LDNS_QDCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_QDCOUNT_OFF
))

	)

108 
	#LDNS_ANCOUNT_OFF
 6

	)

109 
	#LDNS_ANCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_ANCOUNT_OFF
))

	)

112 
	#LDNS_NSCOUNT_OFF
 8

	)

113 
	#LDNS_NSCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_NSCOUNT_OFF
))

	)

116 
	#LDNS_ARCOUNT_OFF
 10

	)

117 
	#LDNS_ARCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_ARCOUNT_OFF
))

	)

129 
ldns_°©us
 
ldns_wúe2pkt
(
ldns_pkt
 **
∑ckë
, c⁄° 
uöt8_t
 *
d©a
, 
size_t
 
Àn
);

140 
ldns_°©us
 
ldns_buf„r2pkt_wúe
(
ldns_pkt
 **
∑ckë
, 
ldns_buf„r
 *
buf„r
);

155 
ldns_°©us
 
ldns_wúe2d«me
(
ldns_rdf
 **
d«me
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
);

174 
ldns_°©us
 
ldns_wúe2rdf
(
ldns_º
 *
º
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
);

191 
ldns_°©us
 
ldns_wúe2º
(
ldns_º
 **
º
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
);

193 #ifde‡
__˝lu•lus


	@include/ldns/zone.h

23 #i‚de‡
LDNS_ZONE_H


24 
	#LDNS_ZONE_H


	)

26 
	~<ldns/comm⁄.h
>

27 
	~<ldns/rd©a.h
>

28 
	~<ldns/º.h
>

29 
	~<ldns/îr‹.h
>

31 #ifde‡
__˝lu•lus


42 
	sldns_°ru˘_z⁄e


45 
ldns_º
 *
_sﬂ
;

47 
ldns_º_li°
 *
_ºs
;

50 
ldns_°ru˘_z⁄e
 
	tldns_z⁄e
;

56 
ldns_z⁄e
 * 
ldns_z⁄e_√w
();

63 
ldns_º
 * 
ldns_z⁄e_sﬂ
(c⁄° 
ldns_z⁄e
 *
z
);

70 
size_t
 
ldns_z⁄e_º_cou¡
(c⁄° 
ldns_z⁄e
 *
z
);

77 
ldns_z⁄e_£t_sﬂ
(
ldns_z⁄e
 *
z
, 
ldns_º
 *
sﬂ
);

86 
ldns_º_li°
 * 
ldns_z⁄e_ºs
(c⁄° 
ldns_z⁄e
 *
z
);

93 
ldns_z⁄e_£t_ºs
(
ldns_z⁄e
 *
z
, 
ldns_º_li°
 *
ºli°
);

102 
boﬁ
 
ldns_z⁄e_push_º_li°
(
ldns_z⁄e
 *
z
, 
ldns_º_li°
 *
li°
);

111 
boﬁ
 
ldns_z⁄e_push_º
(
ldns_z⁄e
 *
z
, 
ldns_º
 *
º
);

126 
ldns_º_li°
 *
ldns_z⁄e_glue_º_li°
(c⁄° 
ldns_z⁄e
 *
z
);

138 
ldns_°©us
 
ldns_z⁄e_√w_‰m_Â
(
ldns_z⁄e
 **
z
, 
FILE
 *
Â
, 
ldns_rdf
 *
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
);

151 
ldns_°©us
 
ldns_z⁄e_√w_‰m_Â_l
(
ldns_z⁄e
 **
z
, 
FILE
 *
Â
, 
ldns_rdf
 *
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
, *
löe_ƒ
);

157 
ldns_z⁄e_‰ì
(
ldns_z⁄e
 *
z⁄e
);

164 
ldns_z⁄e_dìp_‰ì
(
ldns_z⁄e
 *
z⁄e
);

170 
ldns_z⁄e_s‹t
(
ldns_z⁄e
 *
z⁄e
);

172 #ifde‡
__˝lu•lus


	@keys.c

13 
	~<ldns/c⁄fig.h
>

15 
	~<ldns/ldns.h
>

17 #ifde‡
HAVE_SSL


18 
	~<›ís¶/s¶.h
>

19 
	~<›ís¶/ígöe.h
>

20 
	~<›ís¶/ønd.h
>

23 
ldns_lookup_èbÀ
 
	gldns_signög_Æg‹ôhms
[] = {

24 { 
LDNS_SIGN_RSAMD5
, "RSAMD5" },

25 { 
LDNS_SIGN_RSASHA1
, "RSASHA1" },

26 { 
LDNS_SIGN_RSASHA1_NSEC3
, "RSASHA1-NSEC3-SHA1" },

27 #ifde‡
USE_SHA2


28 { 
LDNS_SIGN_RSASHA256
, "RSASHA256" },

29 { 
LDNS_SIGN_RSASHA512
, "RSASHA512" },

31 #ifde‡
USE_GOST


32 { 
LDNS_SIGN_ECC_GOST
, "ECC-GOST" },

34 #ifde‡
USE_ECDSA


35 { 
LDNS_SIGN_ECDSAP256SHA256
, "ECDSAP256SHA256" },

36 { 
LDNS_SIGN_ECDSAP384SHA384
, "ECDSAP384SHA384" },

38 { 
LDNS_SIGN_DSA
, "DSA" },

39 { 
LDNS_SIGN_DSA_NSEC3
, "DSA-NSEC3-SHA1" },

40 { 
LDNS_SIGN_HMACMD5
, "hmac-md5.sig-alg.reg.int" },

41 { 
LDNS_SIGN_HMACSHA1
, "hmac-sha1" },

42 { 
LDNS_SIGN_HMACSHA256
, "hmac-sha256" },

43 { 0, 
NULL
 }

46 
ldns_key_li°
 *

47 
	$ldns_key_li°_√w
()

49 
ldns_key_li°
 *
key_li°
 = 
	`LDNS_MALLOC
(ldns_key_list);

50 i‡(!
key_li°
) {

51  
NULL
;

53 
key_li°
->
_key_cou¡
 = 0;

54 
key_li°
->
_keys
 = 
NULL
;

55  
key_li°
;

57 
	}
}

59 
ldns_key
 *

60 
	$ldns_key_√w
()

62 
ldns_key
 *
√wkey
;

64 
√wkey
 = 
	`LDNS_MALLOC
(
ldns_key
);

65 i‡(!
√wkey
) {

66  
NULL
;

69 
	`ldns_key_£t_u£
(
√wkey
, 
åue
);

70 
	`ldns_key_£t_Êags
(
√wkey
, 
LDNS_KEY_ZONE_KEY
);

71 
	`ldns_key_£t_‹igâl
(
√wkey
, 0);

72 
	`ldns_key_£t_keyèg
(
√wkey
, 0);

73 
	`ldns_key_£t_ö˚±i⁄
(
√wkey
, 0);

74 
	`ldns_key_£t_expú©i⁄
(
√wkey
, 0);

75 
	`ldns_key_£t_pubkey_ow√r
(
√wkey
, 
NULL
);

76 #ifde‡
HAVE_SSL


77 
	`ldns_key_£t_evp_key
(
√wkey
, 
NULL
);

79 
	`ldns_key_£t_hmac_key
(
√wkey
, 
NULL
);

80 
	`ldns_key_£t_exã∫Æ_key
(
√wkey
, 
NULL
);

81  
√wkey
;

83 
	}
}

85 
ldns_°©us


86 
	$ldns_key_√w_‰m_Â
(
ldns_key
 **
k
, 
FILE
 *
Â
)

88  
	`ldns_key_√w_‰m_Â_l
(
k
, 
Â
, 
NULL
);

89 
	}
}

91 #ifde‡
HAVE_SSL


92 
ldns_°©us


93 
	$ldns_key_√w_‰m_ígöe
(
ldns_key
 **
key
, 
ENGINE
 *
e
, *
key_id
, 
ldns_Æg‹ôhm
 
Æg
)

95 
ldns_key
 *
k
;

97 
k
 = 
	`ldns_key_√w
();

98 if(!
k
Ë 
LDNS_STATUS_MEM_ERR
;

99 #i‚de‡
S_SPLINT_S


100 
k
->
_key
.
key
 = 
	`ENGINE_lﬂd_¥iv©e_key
(
e
, 
key_id
, 
	`UI_O≥nSSL
(), 
NULL
);

101 if(!
k
->
_key
.
key
) {

102 
	`ldns_key_‰ì
(
k
);

103  
LDNS_STATUS_ERR
;

105 
	`ldns_key_£t_Æg‹ôhm
(
k
, (
ldns_signög_Æg‹ôhm
Ë
Æg
);

106 i‡(!
k
->
_key
.
key
) {

107 
	`ldns_key_‰ì
(
k
);

108  
LDNS_STATUS_ENGINE_KEY_NOT_LOADED
;

111 *
key
 = 
k
;

112  
LDNS_STATUS_OK
;

113 
	}
}

116 #ifde‡
USE_GOST


118 
ENGINE
* 
	gldns_go°_ígöe
 = 
NULL
;

121 
	$ldns_key_EVP_lﬂd_go°_id
()

123 
go°_id
 = 0;

124 c⁄° 
EVP_PKEY_ASN1_METHOD
* 
mëh
;

125 
ENGINE
* 
e
;

127 if(
go°_id
)  gost_id;

130 
mëh
 = 
	`EVP_PKEY_a¢1_föd_°r
(
NULL
, "gost2001", -1);

131 if(
mëh
) {

132 
	`EVP_PKEY_a¢1_gë0_öfo
(&
go°_id
, 
NULL
, NULL, NULL, NULL, 
mëh
);

133  
go°_id
;

137 
e
 = 
	`ENGINE_by_id
("gost");

138 if(!
e
) {

140 
	`ENGINE_lﬂd_buûtö_ígöes
();

141 
	`ENGINE_lﬂd_dy«mic
();

142 
e
 = 
	`ENGINE_by_id
("gost");

144 if(!
e
) {

148 if(!
	`ENGINE_£t_deÁu…
(
e
, 
ENGINE_METHOD_ALL
)) {

149 
	`ENGINE_föish
(
e
);

150 
	`ENGINE_‰ì
(
e
);

154 
mëh
 = 
	`EVP_PKEY_a¢1_föd_°r
(&
e
, "gost2001", -1);

155 if(!
mëh
) {

157 
	`ENGINE_föish
(
e
);

158 
	`ENGINE_‰ì
(
e
);

163 
ldns_go°_ígöe
 = 
e
;

165 
	`EVP_PKEY_a¢1_gë0_öfo
(&
go°_id
, 
NULL
, NULL, NULL, NULL, 
mëh
);

166  
go°_id
;

167 
	}
}

169 
	$ldns_key_EVP_u∆ﬂd_go°
()

171 if(
ldns_go°_ígöe
) {

172 
	`ENGINE_föish
(
ldns_go°_ígöe
);

173 
	`ENGINE_‰ì
(
ldns_go°_ígöe
);

174 
ldns_go°_ígöe
 = 
NULL
;

176 
	}
}

179 
EVP_PKEY
*

180 
	$ldns_key_√w_‰m_Â_go°_l
(
FILE
* 
Â
, * 
löe_ƒ
)

182 
tokí
[16384];

183 c⁄° * 
µ
;

184 
go°_id
;

185 
EVP_PKEY
* 
pkey
;

186 
ldns_rdf
* 
b64rdf
 = 
NULL
;

188 
go°_id
 = 
	`ldns_key_EVP_lﬂd_go°_id
();

189 if(!
go°_id
)

190  
NULL
;

192 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
Â
, "Go°A¢1", ": ", 
tokí
, "\n",

193 (
tokí
), 
löe_ƒ
) == -1)

194  
NULL
;

195 
	`°æí
(
tokí
) < 96) {

197 if(
	`ldns_fgë_tokí_l
(
Â
, 
tokí
+
	`°æí
(token), "\n",

198 (
tokí
)-
	`°æí
—okí), 
löe_ƒ
) == -1)

199  
NULL
;

201 if(
	`ldns_°r2rdf_b64
(&
b64rdf
, 
tokí
Ë!
LDNS_STATUS_OK
)

202  
NULL
;

203 
µ
 = (*)
	`ldns_rdf_d©a
(
b64rdf
);

204 
pkey
 = 
	`d2i_Priv©eKey
(
go°_id
, 
NULL
, &
µ
, ()
	`ldns_rdf_size
(
b64rdf
));

205 
	`ldns_rdf_dìp_‰ì
(
b64rdf
);

206  
pkey
;

207 
	}
}

210 #ifde‡
USE_ECDSA


213 
	$ldns_EC_KEY_ˇlc_public
(
EC_KEY
* 
ec
)

215 
EC_POINT
* 
pub_key
;

216 c⁄° 
EC_GROUP
* 
group
;

217 
group
 = 
	`EC_KEY_gë0_group
(
ec
);

218 
pub_key
 = 
	`EC_POINT_√w
(
group
);

219 if(!
pub_key
)  0;

220 if(!
	`EC_POINT_c›y
(
pub_key
, 
	`EC_GROUP_gë0_gíî©‹
(
group
))) {

221 
	`EC_POINT_‰ì
(
pub_key
);

224 if(!
	`EC_POINT_mul
(
group
, 
pub_key
, 
	`EC_KEY_gë0_¥iv©e_key
(
ec
),

225 
NULL
, NULL, NULL)) {

226 
	`EC_POINT_‰ì
(
pub_key
);

229 if(
	`EC_KEY_£t_public_key
(
ec
, 
pub_key
) == 0) {

230 
	`EC_POINT_‰ì
(
pub_key
);

233 
	`EC_POINT_‰ì
(
pub_key
);

235 
	}
}

238 
EVP_PKEY
*

239 
	$ldns_key_√w_‰m_Â_ecdß_l
(
FILE
* 
Â
, 
ldns_Æg‹ôhm
 
Æg
, * 
löe_ƒ
)

241 
tokí
[16384];

242 
ldns_rdf
* 
b64rdf
 = 
NULL
;

243 * 
µ
;

244 
BIGNUM
* 
bn
;

245 
EVP_PKEY
* 
evp_key
;

246 
EC_KEY
* 
ec
;

247 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
Â
, "Priv©eKey", ": ", 
tokí
, "\n",

248 (
tokí
), 
löe_ƒ
) == -1)

249  
NULL
;

250 if(
	`ldns_°r2rdf_b64
(&
b64rdf
, 
tokí
Ë!
LDNS_STATUS_OK
)

251  
NULL
;

252 
µ
 = (*)
	`ldns_rdf_d©a
(
b64rdf
);

254 if(
Æg
 =
LDNS_ECDSAP256SHA256
)

255 
ec
 = 
	`EC_KEY_√w_by_curve_«me
(
NID_X9_62_¥ime256v1
);

256 if(
Æg
 =
LDNS_ECDSAP384SHA384
)

257 
ec
 = 
	`EC_KEY_√w_by_curve_«me
(
NID_£˝384r1
);

258 
ec
 = 
NULL
;

259 if(!
ec
) {

260 
	`ldns_rdf_dìp_‰ì
(
b64rdf
);

261  
NULL
;

263 
bn
 = 
	`BN_bö2bn
(
µ
, ()
	`ldns_rdf_size
(
b64rdf
), 
NULL
);

264 
	`ldns_rdf_dìp_‰ì
(
b64rdf
);

265 if(!
bn
) {

266 
	`EC_KEY_‰ì
(
ec
);

267  
NULL
;

269 
	`EC_KEY_£t_¥iv©e_key
(
ec
, 
bn
);

270 
	`BN_‰ì
(
bn
);

271 if(!
	`ldns_EC_KEY_ˇlc_public
(
ec
)) {

272 
	`EC_KEY_‰ì
(
ec
);

273  
NULL
;

276 
evp_key
 = 
	`EVP_PKEY_√w
();

277 if(!
evp_key
) {

278 
	`EC_KEY_‰ì
(
ec
);

279  
NULL
;

281 i‡(!
	`EVP_PKEY_assign_EC_KEY
(
evp_key
, 
ec
)) {

282 
	`EVP_PKEY_‰ì
(
evp_key
);

283 
	`EC_KEY_‰ì
(
ec
);

284  
NULL
;

286  
evp_key
;

287 
	}
}

290 
ldns_°©us


291 
	$ldns_key_√w_‰m_Â_l
(
ldns_key
 **
key
, 
FILE
 *
Â
, *
löe_ƒ
)

293 
ldns_key
 *
k
;

294 *
d
;

295 
ldns_signög_Æg‹ôhm
 
Æg
;

296 
ldns_º
 *
key_º
;

297 #ifde‡
HAVE_SSL


298 
RSA
 *
rß
;

299 
DSA
 *
dß
;

300 *
hmac
;

301 
size_t
 
hmac_size
;

304 
k
 = 
	`ldns_key_√w
();

306 
d
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
);

307 i‡(!
k
 || !
d
) {

308 
	`ldns_key_‰ì
(
k
);

309 
	`LDNS_FREE
(
d
);

310  
LDNS_STATUS_MEM_ERR
;

313 
Æg
 = 0;

322 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
Â
, "Priv©e-key-f‹m©", ": ", 
d
, "\n",

323 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

325 
	`ldns_key_‰ì
(
k
);

326 
	`LDNS_FREE
(
d
);

327  
LDNS_STATUS_SYNTAX_ERR
;

329 i‡(
	`°∫cmp
(
d
, "v1.", 3) != 0) {

330 
	`ldns_key_‰ì
(
k
);

331 
	`LDNS_FREE
(
d
);

332  
LDNS_STATUS_SYNTAX_VERSION_ERR
;

337 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
Â
, "Alg‹ôhm", ": ", 
d
, "\n",

338 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

340 
	`ldns_key_‰ì
(
k
);

341 
	`LDNS_FREE
(
d
);

342  
LDNS_STATUS_SYNTAX_ALG_ERR
;

345 i‡(
	`°∫cmp
(
d
, "1 RSA", 2) == 0) {

346 
Æg
 = 
LDNS_SIGN_RSAMD5
;

348 i‡(
	`°∫cmp
(
d
, "2 DH", 2) == 0) {

349 
Æg
 = (
ldns_signög_Æg‹ôhm
)
LDNS_DH
;

351 i‡(
	`°∫cmp
(
d
, "3 DSA", 2) == 0) {

352 
Æg
 = 
LDNS_SIGN_DSA
;

354 i‡(
	`°∫cmp
(
d
, "4 ECC", 2) == 0) {

355 
Æg
 = (
ldns_signög_Æg‹ôhm
)
LDNS_ECC
;

357 i‡(
	`°∫cmp
(
d
, "5 RSASHA1", 2) == 0) {

358 
Æg
 = 
LDNS_SIGN_RSASHA1
;

360 i‡(
	`°∫cmp
(
d
, "6 DSA", 2) == 0) {

361 
Æg
 = 
LDNS_SIGN_DSA_NSEC3
;

363 i‡(
	`°∫cmp
(
d
, "7 RSASHA1", 2) == 0) {

364 
Æg
 = 
LDNS_SIGN_RSASHA1_NSEC3
;

367 i‡(
	`°∫cmp
(
d
, "8 RSASHA256", 2) == 0) {

368 #ifde‡
USE_SHA2


369 
Æg
 = 
LDNS_SIGN_RSASHA256
;

371 #ifde‡
STDERR_MSGS


372 
	`Ârötf
(
°dîr
, "Warning: SHA256Çot compiled intoÅhis ");

373 
	`Ârötf
(
°dîr
, "version ofÜdns\n");

377 i‡(
	`°∫cmp
(
d
, "10 RSASHA512", 3) == 0) {

378 #ifde‡
USE_SHA2


379 
Æg
 = 
LDNS_SIGN_RSASHA512
;

381 #ifde‡
STDERR_MSGS


382 
	`Ârötf
(
°dîr
, "Warning: SHA512Çot compiled intoÅhis ");

383 
	`Ârötf
(
°dîr
, "version ofÜdns\n");

387 i‡(
	`°∫cmp
(
d
, "12 ECC-GOST", 3) == 0) {

388 #ifde‡
USE_GOST


389 
Æg
 = 
LDNS_SIGN_ECC_GOST
;

391 #ifde‡
STDERR_MSGS


392 
	`Ârötf
(
°dîr
, "Warning: ECC-GOSTÇot compiled intoÅhis ");

393 
	`Ârötf
(
°dîr
, "version ofÜdns, use --enable-gost\n");

397 i‡(
	`°∫cmp
(
d
, "13 ECDSAP256SHA256", 3) == 0) {

398 #ifde‡
USE_ECDSA


399 
Æg
 = 
LDNS_SIGN_ECDSAP256SHA256
;

401 #ifde‡
STDERR_MSGS


402 
	`Ârötf
(
°dîr
, "Warning: ECDSAÇot compiled intoÅhis ");

403 
	`Ârötf
(
°dîr
, "version ofÜdns, use --enable-ecdsa\n");

407 i‡(
	`°∫cmp
(
d
, "14 ECDSAP384SHA384", 3) == 0) {

408 #ifde‡
USE_ECDSA


409 
Æg
 = 
LDNS_SIGN_ECDSAP384SHA384
;

411 #ifde‡
STDERR_MSGS


412 
	`Ârötf
(
°dîr
, "Warning: ECDSAÇot compiled intoÅhis ");

413 
	`Ârötf
(
°dîr
, "version ofÜdns, use --enable-ecdsa\n");

417 i‡(
	`°∫cmp
(
d
, "157 HMAC-MD5", 4) == 0) {

418 
Æg
 = 
LDNS_SIGN_HMACMD5
;

420 i‡(
	`°∫cmp
(
d
, "158 HMAC-SHA1", 4) == 0) {

421 
Æg
 = 
LDNS_SIGN_HMACSHA1
;

423 i‡(
	`°∫cmp
(
d
, "159 HMAC-SHA256", 4) == 0) {

424 
Æg
 = 
LDNS_SIGN_HMACSHA256
;

427 
	`LDNS_FREE
(
d
);

429 
Æg
) {

430 
LDNS_SIGN_RSAMD5
:

431 
LDNS_SIGN_RSASHA1
:

432 
LDNS_SIGN_RSASHA1_NSEC3
:

433 #ifde‡
USE_SHA2


434 
LDNS_SIGN_RSASHA256
:

435 
LDNS_SIGN_RSASHA512
:

437 
	`ldns_key_£t_Æg‹ôhm
(
k
, 
Æg
);

438 #ifde‡
HAVE_SSL


439 
rß
 = 
	`ldns_key_√w_‰m_Â_rß_l
(
Â
, 
löe_ƒ
);

440 i‡(!
rß
) {

441 
	`ldns_key_‰ì
(
k
);

442  
LDNS_STATUS_ERR
;

444 
	`ldns_key_assign_rß_key
(
k
, 
rß
);

447 
LDNS_SIGN_DSA
:

448 
LDNS_SIGN_DSA_NSEC3
:

449 
	`ldns_key_£t_Æg‹ôhm
(
k
, 
Æg
);

450 #ifde‡
HAVE_SSL


451 
dß
 = 
	`ldns_key_√w_‰m_Â_dß_l
(
Â
, 
löe_ƒ
);

452 i‡(!
dß
) {

453 
	`ldns_key_‰ì
(
k
);

454  
LDNS_STATUS_ERR
;

456 
	`ldns_key_assign_dß_key
(
k
, 
dß
);

459 
LDNS_SIGN_HMACMD5
:

460 
LDNS_SIGN_HMACSHA1
:

461 
LDNS_SIGN_HMACSHA256
:

462 
	`ldns_key_£t_Æg‹ôhm
(
k
, 
Æg
);

463 #ifde‡
HAVE_SSL


464 
hmac
 = 
	`ldns_key_√w_‰m_Â_hmac_l
(
Â
, 
löe_ƒ
, &
hmac_size
);

465 i‡(!
hmac
) {

466 
	`ldns_key_‰ì
(
k
);

467  
LDNS_STATUS_ERR
;

469 
	`ldns_key_£t_hmac_size
(
k
, 
hmac_size
);

470 
	`ldns_key_£t_hmac_key
(
k
, 
hmac
);

473 
LDNS_SIGN_ECC_GOST
:

474 
	`ldns_key_£t_Æg‹ôhm
(
k
, 
Æg
);

475 #i‡
	`deföed
(
HAVE_SSL
Ë&& deföed(
USE_GOST
)

476 if(!
	`ldns_key_EVP_lﬂd_go°_id
()) {

477 
	`ldns_key_‰ì
(
k
);

478  
LDNS_STATUS_CRYPTO_ALGO_NOT_IMPL
;

480 
	`ldns_key_£t_evp_key
(
k
,

481 
	`ldns_key_√w_‰m_Â_go°_l
(
Â
, 
löe_ƒ
));

482 #i‚de‡
S_SPLINT_S


483 if(!
k
->
_key
.
key
) {

484 
	`ldns_key_‰ì
(
k
);

485  
LDNS_STATUS_ERR
;

490 #ifde‡
USE_ECDSA


491 
LDNS_SIGN_ECDSAP256SHA256
:

492 
LDNS_SIGN_ECDSAP384SHA384
:

493 
	`ldns_key_£t_Æg‹ôhm
(
k
, 
Æg
);

494 
	`ldns_key_£t_evp_key
(
k
,

495 
	`ldns_key_√w_‰m_Â_ecdß_l
(
Â
, (
ldns_Æg‹ôhm
)
Æg
, 
löe_ƒ
));

496 #i‚de‡
S_SPLINT_S


497 if(!
k
->
_key
.
key
) {

498 
	`ldns_key_‰ì
(
k
);

499  
LDNS_STATUS_ERR
;

505 
	`ldns_key_‰ì
(
k
);

506  
LDNS_STATUS_SYNTAX_ALG_ERR
;

508 
key_º
 = 
	`ldns_key2º
(
k
);

509 
	`ldns_key_£t_keyèg
(
k
, 
	`ldns_ˇlc_keyèg
(
key_º
));

510 
	`ldns_º_‰ì
(
key_º
);

512 i‡(
key
) {

513 *
key
 = 
k
;

514  
LDNS_STATUS_OK
;

516 
	`ldns_key_‰ì
(
k
);

517  
LDNS_STATUS_ERR
;

518 
	}
}

520 #ifde‡
HAVE_SSL


521 
RSA
 *

522 
	$ldns_key_√w_‰m_Â_rß
(
FILE
 *
f
)

524  
	`ldns_key_√w_‰m_Â_rß_l
(
f
, 
NULL
);

525 
	}
}

527 
RSA
 *

528 
	$ldns_key_√w_‰m_Â_rß_l
(
FILE
 *
f
, *
löe_ƒ
)

555 *
d
;

556 
RSA
 *
rß
;

557 
uöt8_t
 *
buf
;

558 
i
;

560 
d
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
);

561 
buf
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_MAX_LINELEN
);

562 
rß
 = 
	`RSA_√w
();

563 i‡(!
d
 || !
rß
 || !
buf
) {

564 
îr‹
;

572 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Modulus", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

573 
îr‹
;

575 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

576 #i‚de‡
S_SPLINT_S


577 
rß
->
n
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

578 i‡(!
rß
->
n
) {

579 
îr‹
;

583 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "PublicExp⁄ít", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

584 
îr‹
;

586 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

587 
rß
->
e
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

588 i‡(!
rß
->
e
) {

589 
îr‹
;

593 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Priv©eExp⁄ít", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

594 
îr‹
;

596 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

597 
rß
->
d
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

598 i‡(!
rß
->
d
) {

599 
îr‹
;

603 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Prime1", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

604 
îr‹
;

606 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

607 
rß
->
p
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

608 i‡(!
rß
->
p
) {

609 
îr‹
;

613 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Prime2", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

614 
îr‹
;

616 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

617 
rß
->
q
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

618 i‡(!
rß
->
q
) {

619 
îr‹
;

623 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Exp⁄ít1", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

624 
îr‹
;

626 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

627 
rß
->
dmp1
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

628 i‡(!
rß
->
dmp1
) {

629 
îr‹
;

633 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Exp⁄ít2", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

634 
îr‹
;

636 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

637 
rß
->
dmq1
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

638 i‡(!
rß
->
dmq1
) {

639 
îr‹
;

643 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "C€fficõ¡", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

644 
îr‹
;

646 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

647 
rß
->
iqmp
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

648 i‡(!
rß
->
iqmp
) {

649 
îr‹
;

653 
	`LDNS_FREE
(
buf
);

654 
	`LDNS_FREE
(
d
);

655  
rß
;

657 
îr‹
:

658 
	`RSA_‰ì
(
rß
);

659 
	`LDNS_FREE
(
d
);

660 
	`LDNS_FREE
(
buf
);

661  
NULL
;

662 
	}
}

664 
DSA
 *

665 
	$ldns_key_√w_‰m_Â_dß
(
FILE
 *
f
)

667  
	`ldns_key_√w_‰m_Â_dß_l
(
f
, 
NULL
);

668 
	}
}

670 
DSA
 *

671 
ldns_key_√w_‰m_Â_dß_l
(
FILE
 *
f
, 
	$ATTR_UNUSED
(*
löe_ƒ
))

673 
i
;

674 *
d
;

675 
DSA
 *
dß
;

676 
uöt8_t
 *
buf
;

678 
d
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
);

679 
buf
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_MAX_LINELEN
);

680 
dß
 = 
	`DSA_√w
();

681 i‡(!
d
 || !
dß
 || !
buf
) {

682 
îr‹
;

688 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Primï", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

689 
îr‹
;

691 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

692 #i‚de‡
S_SPLINT_S


693 
dß
->
p
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

694 i‡(!
dß
->
p
) {

695 
îr‹
;

699 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Sub¥imeq", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

700 
îr‹
;

702 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

703 
dß
->
q
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

704 i‡(!
dß
->
q
) {

705 
îr‹
;

709 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Ba£g", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

710 
îr‹
;

712 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

713 
dß
->
g
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

714 i‡(!
dß
->
g
) {

715 
îr‹
;

719 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Priv©e_vÆuex", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

720 
îr‹
;

722 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

723 
dß
->
¥iv_key
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

724 i‡(!
dß
->
¥iv_key
) {

725 
îr‹
;

729 i‡(
	`ldns_fgë_keyw‹d_d©a_l
(
f
, "Public_vÆuey", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

730 
îr‹
;

732 
i
 = 
	`ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(d)));

733 
dß
->
pub_key
 = 
	`BN_bö2bn
((c⁄° *)
buf
, 
i
, 
NULL
);

734 i‡(!
dß
->
pub_key
) {

735 
îr‹
;

739 
	`LDNS_FREE
(
buf
);

740 
	`LDNS_FREE
(
d
);

742  
dß
;

744 
îr‹
:

745 
	`LDNS_FREE
(
d
);

746 
	`LDNS_FREE
(
buf
);

747 
	`DSA_‰ì
(
dß
);

748  
NULL
;

749 
	}
}

752 
	$ldns_key_√w_‰m_Â_hmac
(
FILE
 *
f
, 
size_t
 *
hmac_size
)

754  
	`ldns_key_√w_‰m_Â_hmac_l
(
f
, 
NULL
, 
hmac_size
);

755 
	}
}

758 
ldns_key_√w_‰m_Â_hmac_l
–
FILE
 *
f


759 , 
ATTR_UNUSED
(*
löe_ƒ
)

760 , 
size_t
 *
hmac_size


763 
size_t
 
	gi
, 
	gbufsz
;

764 
	gd
[
LDNS_MAX_LINELEN
];

765 *
	gbuf
 = 
NULL
;

767 i‡(
ldns_fgë_keyw‹d_d©a_l
(
f
, "Key", ": ", 
d
, "\n", 
LDNS_MAX_LINELEN
, 
löe_ƒ
) == -1) {

768 
îr‹
;

770 
	gbufsz
 = 
ldns_b64_¡›_ˇlcuœã_size
(
°æí
(
d
));

771 
	gbuf
 = 
LDNS_XMALLOC
(, 
bufsz
);

772 
	gi
 = (
size_t
Ë
ldns_b64_±⁄
((c⁄° *)
d
, 
buf
, 
bufsz
);

774 *
	ghmac_size
 = 
i
;

775  
	gbuf
;

777 
	gîr‹
:

778 
LDNS_FREE
(
buf
);

779 *
	ghmac_size
 = 0;

780  
	gNULL
;

784 #ifde‡
USE_GOST


785 
EVP_PKEY
*

786 
	$ldns_gí_go°_key
()

788 
EVP_PKEY_CTX
* 
˘x
;

789 
EVP_PKEY
* 
p
 = 
NULL
;

790 
go°_id
 = 
	`ldns_key_EVP_lﬂd_go°_id
();

791 if(!
go°_id
)

792  
NULL
;

793 
˘x
 = 
	`EVP_PKEY_CTX_√w_id
(
go°_id
, 
NULL
);

794 if(!
˘x
) {

796  
NULL
;

798 if(
	`EVP_PKEY_CTX_˘æ_°r
(
˘x
, "paramset", "A") <= 0) {

800 
	`EVP_PKEY_CTX_‰ì
(
˘x
);

801  
NULL
;

804 if(
	`EVP_PKEY_keygí_öô
(
˘x
) <= 0) {

805 
	`EVP_PKEY_CTX_‰ì
(
˘x
);

806  
NULL
;

808 if(
	`EVP_PKEY_keygí
(
˘x
, &
p
) <= 0) {

809 
	`EVP_PKEY_‰ì
(
p
);

810 
	`EVP_PKEY_CTX_‰ì
(
˘x
);

811  
NULL
;

813 
	`EVP_PKEY_CTX_‰ì
(
˘x
);

814  
p
;

815 
	}
}

818 
ldns_key
 *

819 
	$ldns_key_√w_‰m_Æg‹ôhm
(
ldns_signög_Æg‹ôhm
 
Æg
, 
uöt16_t
 
size
)

821 
ldns_key
 *
k
;

822 #ifde‡
HAVE_SSL


823 
DSA
 *
d
;

824 
RSA
 *
r
;

825 #ifde‡
USE_ECDSA


826 
EC_KEY
 *
ec
 = 
NULL
;

829 
i
;

830 
uöt16_t
 
off£t
 = 0;

832 *
hmac
;

834 
k
 = 
	`ldns_key_√w
();

835 i‡(!
k
) {

836  
NULL
;

838 
Æg
) {

839 
LDNS_SIGN_RSAMD5
:

840 
LDNS_SIGN_RSASHA1
:

841 
LDNS_SIGN_RSASHA1_NSEC3
:

842 
LDNS_SIGN_RSASHA256
:

843 
LDNS_SIGN_RSASHA512
:

844 #ifde‡
HAVE_SSL


845 
r
 = 
	`RSA_gíî©e_key
(()
size
, 
RSA_F4
, 
NULL
, NULL);

846 if(!
r
) {

847 
	`ldns_key_‰ì
(
k
);

848  
NULL
;

850 i‡(
	`RSA_check_key
(
r
) != 1) {

851 
	`ldns_key_‰ì
(
k
);

852  
NULL
;

854 
	`ldns_key_£t_rß_key
(
k
, 
r
);

855 
	`RSA_‰ì
(
r
);

858 
LDNS_SIGN_DSA
:

859 
LDNS_SIGN_DSA_NSEC3
:

860 #ifde‡
HAVE_SSL


861 
d
 = 
	`DSA_gíî©e_∑ømëîs
(()
size
, 
NULL
, 0, NULL, NULL, NULL, NULL);

862 i‡(!
d
) {

863 
	`ldns_key_‰ì
(
k
);

864  
NULL
;

866 i‡(
	`DSA_gíî©e_key
(
d
) != 1) {

867 
	`ldns_key_‰ì
(
k
);

868  
NULL
;

870 
	`ldns_key_£t_dß_key
(
k
, 
d
);

871 
	`DSA_‰ì
(
d
);

874 
LDNS_SIGN_HMACMD5
:

875 
LDNS_SIGN_HMACSHA1
:

876 
LDNS_SIGN_HMACSHA256
:

877 #ifde‡
HAVE_SSL


878 #i‚de‡
S_SPLINT_S


879 
k
->
_key
.
key
 = 
NULL
;

882 
size
 = size / 8;

883 
	`ldns_key_£t_hmac_size
(
k
, 
size
);

885 
hmac
 = 
	`LDNS_XMALLOC
(, 
size
);

886 if(!
hmac
) {

887 
	`ldns_key_‰ì
(
k
);

888  
NULL
;

890 #ifde‡
HAVE_SSL


891 i‡(
	`RAND_byãs
(
hmac
, (Ë
size
) != 1) {

892 
	`LDNS_FREE
(
hmac
);

893 
	`ldns_key_‰ì
(
k
);

894  
NULL
;

897 
off£t
 + (
i
Ë< 
size
) {

898 
i
 = 
	`øndom
();

899 
	`mem˝y
(&
hmac
[
off£t
], &
i
, (i));

900 
off£t
 +(
i
);

902 i‡(
off£t
 < 
size
) {

903 
i
 = 
	`øndom
();

904 
	`mem˝y
(&
hmac
[
off£t
], &
i
, 
size
 - offset);

907 
	`ldns_key_£t_hmac_key
(
k
, 
hmac
);

909 
	`ldns_key_£t_Êags
(
k
, 0);

911 
LDNS_SIGN_ECC_GOST
:

912 #i‡
	`deföed
(
HAVE_SSL
Ë&& deföed(
USE_GOST
)

913 
	`ldns_key_£t_evp_key
(
k
, 
	`ldns_gí_go°_key
());

914 #i‚de‡
S_SPLINT_S


915 if(!
k
->
_key
.
key
) {

916 
	`ldns_key_‰ì
(
k
);

917  
NULL
;

921 
	`ldns_key_‰ì
(
k
);

922  
NULL
;

925 
LDNS_SIGN_ECDSAP256SHA256
:

926 
LDNS_SIGN_ECDSAP384SHA384
:

927 #ifde‡
USE_ECDSA


928 if(
Æg
 =
LDNS_SIGN_ECDSAP256SHA256
)

929 
ec
 = 
	`EC_KEY_√w_by_curve_«me
(
NID_X9_62_¥ime256v1
);

930 if(
Æg
 =
LDNS_SIGN_ECDSAP384SHA384
)

931 
ec
 = 
	`EC_KEY_√w_by_curve_«me
(
NID_£˝384r1
);

932 if(!
ec
) {

933 
	`ldns_key_‰ì
(
k
);

934  
NULL
;

936 if(!
	`EC_KEY_gíî©e_key
(
ec
)) {

937 
	`ldns_key_‰ì
(
k
);

938 
	`EC_KEY_‰ì
(
ec
);

939  
NULL
;

941 #i‚de‡
S_SPLINT_S


942 
k
->
_key
.
key
 = 
	`EVP_PKEY_√w
();

943 if(!
k
->
_key
.
key
) {

944 
	`ldns_key_‰ì
(
k
);

945 
	`EC_KEY_‰ì
(
ec
);

946  
NULL
;

948 i‡(!
	`EVP_PKEY_assign_EC_KEY
(
k
->
_key
.
key
, 
ec
)) {

949 
	`ldns_key_‰ì
(
k
);

950 
	`EC_KEY_‰ì
(
ec
);

951  
NULL
;

955 
	`ldns_key_‰ì
(
k
);

956  
NULL
;

960 
	`ldns_key_£t_Æg‹ôhm
(
k
, 
Æg
);

961  
k
;

962 
	}
}

965 
	$ldns_key_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_key
 *
k
)

967 *
°r
 = 
	`ldns_key2°r
(
k
);

968 i‡(
°r
) {

969 
	`Ârötf
(
ouçut
, "%s", 
°r
);

971 
	`Ârötf
(
ouçut
, "UnableÅo convertÖrivate keyÅo string\n");

973 
	`LDNS_FREE
(
°r
);

974 
	}
}

978 
	$ldns_key_£t_Æg‹ôhm
(
ldns_key
 *
k
, 
ldns_signög_Æg‹ôhm
 
l
)

980 
k
->
_Æg
 = 
l
;

981 
	}
}

984 
	$ldns_key_£t_Êags
(
ldns_key
 *
k
, 
uöt16_t
 
f
)

986 
k
->
_exåa
.
dns£c
.
Êags
 = 
f
;

987 
	}
}

989 #ifde‡
HAVE_SSL


990 #i‚de‡
S_SPLINT_S


992 
	$ldns_key_£t_evp_key
(
ldns_key
 *
k
, 
EVP_PKEY
 *
e
)

994 
k
->
_key
.
key
 = 
e
;

995 
	}
}

998 
	$ldns_key_£t_rß_key
(
ldns_key
 *
k
, 
RSA
 *
r
)

1000 
EVP_PKEY
 *
key
 = 
	`EVP_PKEY_√w
();

1001 
	`EVP_PKEY_£t1_RSA
(
key
, 
r
);

1002 
k
->
_key
.
key
 = key;

1003 
	}
}

1006 
	$ldns_key_£t_dß_key
(
ldns_key
 *
k
, 
DSA
 *
d
)

1008 
EVP_PKEY
 *
key
 = 
	`EVP_PKEY_√w
();

1009 
	`EVP_PKEY_£t1_DSA
(
key
, 
d
);

1010 
k
->
_key
.
key
 = key;

1011 
	}
}

1014 
	$ldns_key_assign_rß_key
(
ldns_key
 *
k
, 
RSA
 *
r
)

1016 
EVP_PKEY
 *
key
 = 
	`EVP_PKEY_√w
();

1017 
	`EVP_PKEY_assign_RSA
(
key
, 
r
);

1018 
k
->
_key
.
key
 = key;

1019 
	}
}

1022 
	$ldns_key_assign_dß_key
(
ldns_key
 *
k
, 
DSA
 *
d
)

1024 
EVP_PKEY
 *
key
 = 
	`EVP_PKEY_√w
();

1025 
	`EVP_PKEY_assign_DSA
(
key
, 
d
);

1026 
k
->
_key
.
key
 = key;

1027 
	}
}

1032 
	$ldns_key_£t_hmac_key
(
ldns_key
 *
k
, *
hmac
)

1034 
k
->
_key
.
hmac
.
key
 = hmac;

1035 
	}
}

1038 
	$ldns_key_£t_hmac_size
(
ldns_key
 *
k
, 
size_t
 
hmac_size
)

1040 
k
->
_key
.
hmac
.
size
 = 
hmac_size
;

1041 
	}
}

1044 
	$ldns_key_£t_exã∫Æ_key
(
ldns_key
 *
k
, *
exã∫Æ_key
)

1046 
k
->
_key
.
exã∫Æ_key
 =Éxternal_key;

1047 
	}
}

1050 
	$ldns_key_£t_‹igâl
(
ldns_key
 *
k
, 
uöt32_t
 
t
)

1052 
k
->
_exåa
.
dns£c
.
‹ig_âl
 = 
t
;

1053 
	}
}

1056 
	$ldns_key_£t_ö˚±i⁄
(
ldns_key
 *
k
, 
uöt32_t
 
i
)

1058 
k
->
_exåa
.
dns£c
.
ö˚±i⁄
 = 
i
;

1059 
	}
}

1062 
	$ldns_key_£t_expú©i⁄
(
ldns_key
 *
k
, 
uöt32_t
 
e
)

1064 
k
->
_exåa
.
dns£c
.
expú©i⁄
 = 
e
;

1065 
	}
}

1068 
	$ldns_key_£t_pubkey_ow√r
(
ldns_key
 *
k
, 
ldns_rdf
 *
r
)

1070 
k
->
_pubkey_ow√r
 = 
r
;

1071 
	}
}

1074 
	$ldns_key_£t_keyèg
(
ldns_key
 *
k
, 
uöt16_t
 
èg
)

1076 
k
->
_exåa
.
dns£c
.
keyèg
 = 
èg
;

1077 
	}
}

1080 
size_t


1081 
	$ldns_key_li°_key_cou¡
(c⁄° 
ldns_key_li°
 *
key_li°
)

1083  
key_li°
->
_key_cou¡
;

1084 
	}
}

1086 
ldns_key
 *

1087 
	$ldns_key_li°_key
(c⁄° 
ldns_key_li°
 *
key
, 
size_t
 
ƒ
)

1089 i‡(
ƒ
 < 
	`ldns_key_li°_key_cou¡
(
key
)) {

1090  
key
->
_keys
[
ƒ
];

1092  
NULL
;

1094 
	}
}

1096 
ldns_signög_Æg‹ôhm


1097 
	$ldns_key_Æg‹ôhm
(c⁄° 
ldns_key
 *
k
)

1099  
k
->
_Æg
;

1100 
	}
}

1103 
	$ldns_key_£t_u£
(
ldns_key
 *
k
, 
boﬁ
 
v
)

1105 i‡(
k
) {

1106 
k
->
_u£
 = 
v
;

1108 
	}
}

1110 
boﬁ


1111 
	$ldns_key_u£
(c⁄° 
ldns_key
 *
k
)

1113 i‡(
k
) {

1114  
k
->
_u£
;

1116  
Ál£
;

1117 
	}
}

1119 #ifde‡
HAVE_SSL


1120 #i‚de‡
S_SPLINT_S


1121 
EVP_PKEY
 *

1122 
	$ldns_key_evp_key
(c⁄° 
ldns_key
 *
k
)

1124  
k
->
_key
.
key
;

1125 
	}
}

1127 
RSA
 *

1128 
	$ldns_key_rß_key
(c⁄° 
ldns_key
 *
k
)

1130 i‡(
k
->
_key
.
key
) {

1131  
	`EVP_PKEY_gë1_RSA
(
k
->
_key
.
key
);

1133  
NULL
;

1135 
	}
}

1137 
DSA
 *

1138 
	$ldns_key_dß_key
(c⁄° 
ldns_key
 *
k
)

1140 i‡(
k
->
_key
.
key
) {

1141  
	`EVP_PKEY_gë1_DSA
(
k
->
_key
.
key
);

1143  
NULL
;

1145 
	}
}

1150 
	$ldns_key_hmac_key
(c⁄° 
ldns_key
 *
k
)

1152 i‡(
k
->
_key
.
hmac
.
key
) {

1153  
k
->
_key
.
hmac
.
key
;

1155  
NULL
;

1157 
	}
}

1159 
size_t


1160 
	$ldns_key_hmac_size
(c⁄° 
ldns_key
 *
k
)

1162 i‡(
k
->
_key
.
hmac
.
size
) {

1163  
k
->
_key
.
hmac
.
size
;

1167 
	}
}

1170 
	$ldns_key_exã∫Æ_key
(c⁄° 
ldns_key
 *
k
)

1172  
k
->
_key
.
exã∫Æ_key
;

1173 
	}
}

1175 
uöt32_t


1176 
	$ldns_key_‹igâl
(c⁄° 
ldns_key
 *
k
)

1178  
k
->
_exåa
.
dns£c
.
‹ig_âl
;

1179 
	}
}

1181 
uöt16_t


1182 
	$ldns_key_Êags
(c⁄° 
ldns_key
 *
k
)

1184  
k
->
_exåa
.
dns£c
.
Êags
;

1185 
	}
}

1187 
uöt32_t


1188 
	$ldns_key_ö˚±i⁄
(c⁄° 
ldns_key
 *
k
)

1190  
k
->
_exåa
.
dns£c
.
ö˚±i⁄
;

1191 
	}
}

1193 
uöt32_t


1194 
	$ldns_key_expú©i⁄
(c⁄° 
ldns_key
 *
k
)

1196  
k
->
_exåa
.
dns£c
.
expú©i⁄
;

1197 
	}
}

1199 
uöt16_t


1200 
	$ldns_key_keyèg
(c⁄° 
ldns_key
 *
k
)

1202  
k
->
_exåa
.
dns£c
.
keyèg
;

1203 
	}
}

1205 
ldns_rdf
 *

1206 
	$ldns_key_pubkey_ow√r
(c⁄° 
ldns_key
 *
k
)

1208  
k
->
_pubkey_ow√r
;

1209 
	}
}

1213 
	$ldns_key_li°_£t_u£
(
ldns_key_li°
 *
keys
, 
boﬁ
 
v
)

1215 
size_t
 
i
;

1217 
i
 = 0; i < 
	`ldns_key_li°_key_cou¡
(
keys
); i++) {

1218 
	`ldns_key_£t_u£
(
	`ldns_key_li°_key
(
keys
, 
i
), 
v
);

1220 
	}
}

1223 
	$ldns_key_li°_£t_key_cou¡
(
ldns_key_li°
 *
key
, 
size_t
 
cou¡
)

1225 
key
->
_key_cou¡
 = 
cou¡
;

1226 
	}
}

1228 
boﬁ


1229 
	$ldns_key_li°_push_key
(
ldns_key_li°
 *
key_li°
, 
ldns_key
 *
key
)

1231 
size_t
 
key_cou¡
;

1232 
ldns_key
 **
keys
;

1234 
key_cou¡
 = 
	`ldns_key_li°_key_cou¡
(
key_li°
);

1237 
keys
 = 
	`LDNS_XREALLOC
(

1238 
key_li°
->
_keys
, 
ldns_key
 *, 
key_cou¡
 + 1);

1239 i‡(!
keys
) {

1240  
Ál£
;

1244 
key_li°
->
_keys
 = 
keys
;

1245 
key_li°
->
_keys
[
key_cou¡
] = 
key
;

1247 
	`ldns_key_li°_£t_key_cou¡
(
key_li°
, 
key_cou¡
 + 1);

1248  
åue
;

1249 
	}
}

1251 
ldns_key
 *

1252 
	$ldns_key_li°_p›_key
(
ldns_key_li°
 *
key_li°
)

1254 
size_t
 
key_cou¡
;

1255 
ldns_key
** 
a
;

1256 
ldns_key
 *
p›
;

1258 i‡(!
key_li°
) {

1259  
NULL
;

1262 
key_cou¡
 = 
	`ldns_key_li°_key_cou¡
(
key_li°
);

1263 i‡(
key_cou¡
 == 0) {

1264  
NULL
;

1267 
p›
 = 
	`ldns_key_li°_key
(
key_li°
, 
key_cou¡
);

1270 
a
 = 
	`LDNS_XREALLOC
(
key_li°
->
_keys
, 
ldns_key
 *, 
key_cou¡
 - 1);

1271 if(
a
) {

1272 
key_li°
->
_keys
 = 
a
;

1275 
	`ldns_key_li°_£t_key_cou¡
(
key_li°
, 
key_cou¡
 - 1);

1277  
p›
;

1278 
	}
}

1280 #ifde‡
HAVE_SSL


1281 #i‚de‡
S_SPLINT_S


1283 
boﬁ


1284 
	$ldns_key_rß2bö
(*
d©a
, 
RSA
 *
k
, 
uöt16_t
 *
size
)

1286 
i
,
j
;

1288 i‡(!
k
) {

1289  
Ál£
;

1292 i‡(
	`BN_num_byãs
(
k
->
e
) <= 256) {

1296 
d©a
[0] = (Ë
	`BN_num_byãs
(
k
->
e
);

1297 
i
 = 
	`BN_bn2bö
(
k
->
e
, 
d©a
 + 1);

1298 
j
 = 
	`BN_bn2bö
(
k
->
n
, 
d©a
 + 
i
 + 1);

1299 *
size
 = (
uöt16_t
Ë
i
 + 
j
;

1300 } i‡(
	`BN_num_byãs
(
k
->
e
) <= 65536) {

1301 
d©a
[0] = 0;

1303 
	`ldns_wrôe_uöt16
(
d©a
 + 1, (
uöt16_t
Ë
	`BN_num_byãs
(
k
->
e
));

1305 
	`BN_bn2bö
(
k
->
e
, 
d©a
 + 3);

1306 
	`BN_bn2bö
(
k
->
n
, 
d©a
 + 4 + 
	`BN_num_byãs
(k->
e
));

1307 *
size
 = (
uöt16_t
Ë
	`BN_num_byãs
(
k
->
n
) + 6;

1309  
Ál£
;

1311  
åue
;

1312 
	}
}

1315 
boﬁ


1316 
	$ldns_key_dß2bö
(*
d©a
, 
DSA
 *
k
, 
uöt16_t
 *
size
)

1318 
uöt8_t
 
T
;

1320 i‡(!
k
) {

1321  
Ál£
;

1325 *
size
 = (
uöt16_t
)
	`BN_num_byãs
(
k
->
p
);

1326 
T
 = (*
size
 - 64) / 8;

1327 
	`mem˝y
(
d©a
, &
T
, 1);

1329 i‡(
T
 > 8) {

1330 #ifde‡
STDERR_MSGS


1331 
	`Ârötf
(
°dîr
, "DSA key with T > 8 (ie. > 1024 bits)");

1332 
	`Ârötf
(
°dîr
, "Çot implemented\n");

1334  
Ál£
;

1338 
d©a
[0] = ()
T
;

1339 
	`BN_bn2bö
(
k
->
q
, 
d©a
 + 1 );

1340 
	`BN_bn2bö
(
k
->
p
, 
d©a
 + 21 );

1341 
	`BN_bn2bö
(
k
->
g
, 
d©a
 + 21 + *
size
);

1342 
	`BN_bn2bö
(
k
->
pub_key
, 
d©a
 + 21 + *
size
 + *size);

1343 *
size
 = 21 + (*size * 3);

1344  
åue
;

1345 
	}
}

1347 #ifde‡
USE_GOST


1348 
boﬁ


1349 
	$ldns_key_go°2bö
(* 
d©a
, 
EVP_PKEY
* 
k
, 
uöt16_t
* 
size
)

1351 
i
;

1352 * 
µ
 = 
NULL
;

1353 if(
	`i2d_PUBKEY
(
k
, &
µ
) != 37 + 64) {

1355 
	`CRYPTO_‰ì
(
µ
);

1356  
Ál£
;

1359 
i
=0; i<64; i++)

1360 
d©a
[
i
] = 
µ
[i+37];

1361 
	`CRYPTO_‰ì
(
µ
);

1362 *
size
 = 64;

1363  
åue
;

1364 
	}
}

1369 
ldns_º
 *

1370 
	$ldns_key2º
(c⁄° 
ldns_key
 *
k
)

1377 
ldns_º
 *
pubkey
;

1378 
ldns_rdf
 *
keybö
;

1379 *
bö
 = 
NULL
;

1380 
uöt16_t
 
size
 = 0;

1381 #ifde‡
HAVE_SSL


1382 
RSA
 *
rß
 = 
NULL
;

1383 
DSA
 *
dß
 = 
NULL
;

1385 #ifde‡
USE_ECDSA


1386 
EC_KEY
* 
ec
;

1388 
öã∫Æ_d©a
 = 0;

1390 i‡(!
k
) {

1391  
NULL
;

1393 
pubkey
 = 
	`ldns_º_√w
();

1395 
	`ldns_key_Æg‹ôhm
(
k
)) {

1396 
LDNS_SIGN_HMACMD5
:

1397 
LDNS_SIGN_HMACSHA1
:

1398 
LDNS_SIGN_HMACSHA256
:

1399 
	`ldns_º_£t_ty≥
(
pubkey
, 
LDNS_RR_TYPE_KEY
);

1402 
	`ldns_º_£t_ty≥
(
pubkey
, 
LDNS_RR_TYPE_DNSKEY
);

1406 
	`ldns_º_push_rdf
(
pubkey
,

1407 
	`ldns_«tive2rdf_öt16
(
LDNS_RDF_TYPE_INT16
,

1408 
	`ldns_key_Êags
(
k
)));

1410 
	`ldns_º_push_rdf
(
pubkey
,

1411 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
, 
LDNS_DNSSEC_KEYPROTO
));

1413 i‡(
	`ldns_key_pubkey_ow√r
(
k
)) {

1414 
	`ldns_º_£t_ow√r
(
pubkey
, 
	`ldns_rdf_˛⁄e
(
	`ldns_key_pubkey_ow√r
(
k
)));

1418 
	`ldns_key_Æg‹ôhm
(
k
)) {

1419 
LDNS_SIGN_RSAMD5
:

1420 
LDNS_SIGN_RSASHA1
:

1421 
LDNS_SIGN_RSASHA1_NSEC3
:

1422 
LDNS_SIGN_RSASHA256
:

1423 
LDNS_SIGN_RSASHA512
:

1424 
	`ldns_º_push_rdf
(
pubkey
,

1425 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_ALG
, 
	`ldns_key_Æg‹ôhm
(
k
)));

1426 #ifde‡
HAVE_SSL


1427 
rß
 = 
	`ldns_key_rß_key
(
k
);

1428 i‡(
rß
) {

1429 
bö
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_KEYLEN
);

1430 i‡(!
bö
) {

1431 
	`ldns_º_‰ì
(
pubkey
);

1432  
NULL
;

1434 i‡(!
	`ldns_key_rß2bö
(
bö
, 
rß
, &
size
)) {

1435 
	`LDNS_FREE
(
bö
);

1436 
	`ldns_º_‰ì
(
pubkey
);

1437  
NULL
;

1439 
	`RSA_‰ì
(
rß
);

1440 
öã∫Æ_d©a
 = 1;

1443 
size
++;

1445 
LDNS_SIGN_DSA
:

1446 
	`ldns_º_push_rdf
(
pubkey
,

1447 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_ALG
, 
LDNS_DSA
));

1448 #ifde‡
HAVE_SSL


1449 
dß
 = 
	`ldns_key_dß_key
(
k
);

1450 i‡(
dß
) {

1451 
bö
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_KEYLEN
);

1452 i‡(!
bö
) {

1453 
	`ldns_º_‰ì
(
pubkey
);

1454  
NULL
;

1456 i‡(!
	`ldns_key_dß2bö
(
bö
, 
dß
, &
size
)) {

1457 
	`LDNS_FREE
(
bö
);

1458 
	`ldns_º_‰ì
(
pubkey
);

1459  
NULL
;

1461 
	`DSA_‰ì
(
dß
);

1462 
öã∫Æ_d©a
 = 1;

1466 
LDNS_SIGN_DSA_NSEC3
:

1467 
	`ldns_º_push_rdf
(
pubkey
,

1468 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_ALG
, 
LDNS_DSA_NSEC3
));

1469 #ifde‡
HAVE_SSL


1470 
dß
 = 
	`ldns_key_dß_key
(
k
);

1471 i‡(
dß
) {

1472 
bö
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_KEYLEN
);

1473 i‡(!
bö
) {

1474 
	`ldns_º_‰ì
(
pubkey
);

1475  
NULL
;

1477 i‡(!
	`ldns_key_dß2bö
(
bö
, 
dß
, &
size
)) {

1478 
	`LDNS_FREE
(
bö
);

1479 
	`ldns_º_‰ì
(
pubkey
);

1480  
NULL
;

1482 
	`DSA_‰ì
(
dß
);

1483 
öã∫Æ_d©a
 = 1;

1487 
LDNS_SIGN_ECC_GOST
:

1488 
	`ldns_º_push_rdf
(
pubkey
, 
	`ldns_«tive2rdf_öt8
(

1489 
LDNS_RDF_TYPE_ALG
, 
	`ldns_key_Æg‹ôhm
(
k
)));

1490 #i‡
	`deföed
(
HAVE_SSL
Ë&& deföed(
USE_GOST
)

1491 
bö
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_KEYLEN
);

1492 i‡(!
bö
) {

1493 
	`ldns_º_‰ì
(
pubkey
);

1494  
NULL
;

1496 #i‚de‡
S_SPLINT_S


1497 i‡(!
	`ldns_key_go°2bö
(
bö
, 
k
->
_key
.
key
, &
size
)) {

1498 
	`LDNS_FREE
(
bö
);

1499 
	`ldns_º_‰ì
(
pubkey
);

1500  
NULL
;

1503 
öã∫Æ_d©a
 = 1;

1505 
	`ldns_º_‰ì
(
pubkey
);

1506  
NULL
;

1509 
LDNS_SIGN_ECDSAP256SHA256
:

1510 
LDNS_SIGN_ECDSAP384SHA384
:

1511 #ifde‡
USE_ECDSA


1512 
	`ldns_º_push_rdf
(
pubkey
, 
	`ldns_«tive2rdf_öt8
(

1513 
LDNS_RDF_TYPE_ALG
, 
	`ldns_key_Æg‹ôhm
(
k
)));

1514 
bö
 = 
NULL
;

1515 #i‚de‡
S_SPLINT_S


1516 
ec
 = 
	`EVP_PKEY_gë1_EC_KEY
(
k
->
_key
.
key
);

1518 
	`EC_KEY_£t_c⁄v_f‹m
(
ec
, 
POINT_CONVERSION_UNCOMPRESSED
);

1519 
size
 = (
uöt16_t
)
	`i2o_ECPublicKey
(
ec
, 
NULL
);

1520 if(!
	`i2o_ECPublicKey
(
ec
, &
bö
)) {

1521 
	`EC_KEY_‰ì
(
ec
);

1522 
	`ldns_º_‰ì
(
pubkey
);

1523  
NULL
;

1525 if(
size
 > 1) {

1530 
	`as£π
(
bö
[0] =
POINT_CONVERSION_UNCOMPRESSED
);

1531 
size
 -= 1;

1532 
	`memmove
(
bö
, bö+1, 
size
);

1536 
	`EC_KEY_‰ì
(
ec
);

1537 
öã∫Æ_d©a
 = 1;

1539 
	`ldns_º_‰ì
(
pubkey
);

1540  
NULL
;

1543 
LDNS_SIGN_HMACMD5
:

1544 
LDNS_SIGN_HMACSHA1
:

1545 
LDNS_SIGN_HMACSHA256
:

1546 
bö
 = 
	`LDNS_XMALLOC
(, 
	`ldns_key_hmac_size
(
k
));

1547 i‡(!
bö
) {

1548 
	`ldns_º_‰ì
(
pubkey
);

1549  
NULL
;

1551 
	`ldns_º_push_rdf
(
pubkey
,

1552 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_ALG
,

1553 
	`ldns_key_Æg‹ôhm
(
k
)));

1554 
size
 = 
	`ldns_key_hmac_size
(
k
);

1555 
	`mem˝y
(
bö
, 
	`ldns_key_hmac_key
(
k
), 
size
);

1556 
öã∫Æ_d©a
 = 1;

1560 i‡(
öã∫Æ_d©a
) {

1561 
keybö
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_B64
, 
size
, 
bö
);

1562 
	`LDNS_FREE
(
bö
);

1563 
	`ldns_º_push_rdf
(
pubkey
, 
keybö
);

1565  
pubkey
;

1566 
	}
}

1569 
	$ldns_key_‰ì
(
ldns_key
 *
key
)

1571 
	`LDNS_FREE
(
key
);

1572 
	}
}

1575 
	$ldns_key_dìp_‰ì
(
ldns_key
 *
key
)

1577 * 
hmac
;

1578 i‡(
	`ldns_key_pubkey_ow√r
(
key
)) {

1579 
	`ldns_rdf_dìp_‰ì
(
	`ldns_key_pubkey_ow√r
(
key
));

1581 #ifde‡
HAVE_SSL


1582 i‡(
	`ldns_key_evp_key
(
key
)) {

1583 
	`EVP_PKEY_‰ì
(
	`ldns_key_evp_key
(
key
));

1586 i‡(
	`ldns_key_hmac_key
(
key
)) {

1587 
hmac
 = 
	`ldns_key_hmac_key
(
key
);

1588 
	`LDNS_FREE
(
hmac
);

1590 
	`LDNS_FREE
(
key
);

1591 
	}
}

1594 
	$ldns_key_li°_‰ì
(
ldns_key_li°
 *
key_li°
)

1596 
size_t
 
i
;

1597 
i
 = 0; i < 
	`ldns_key_li°_key_cou¡
(
key_li°
); i++) {

1598 
	`ldns_key_dìp_‰ì
(
	`ldns_key_li°_key
(
key_li°
, 
i
));

1600 
	`LDNS_FREE
(
key_li°
->
_keys
);

1601 
	`LDNS_FREE
(
key_li°
);

1602 
	}
}

1604 
ldns_º
 *

1605 
	$ldns_ªad_™ch‹_fûe
(c⁄° *
fûíame
)

1607 
FILE
 *
Â
;

1609 *
löe
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_PACKETLEN
);

1610 
c
;

1611 
size_t
 
i
 = 0;

1612 
ldns_º
 *
r
;

1613 
ldns_°©us
 
°©us
;

1614 if(!
löe
) {

1615  
NULL
;

1618 
Â
 = 
	`f›í
(
fûíame
, "r");

1619 i‡(!
Â
) {

1620 #ifde‡
STDERR_MSGS


1621 
	`Ârötf
(
°dîr
, "U«bÀÅÿ›í %s: %s\n", 
fûíame
, 
	`°ªº‹
(
î∫o
));

1623 
	`LDNS_FREE
(
löe
);

1624  
NULL
;

1627 (
c
 = 
	`fgëc
(
Â
)Ë&& 
i
+1 < 
LDNS_MAX_PACKETLEN
 && c !
EOF
) {

1628 
löe
[
i
] = 
c
;

1629 
i
++;

1631 
löe
[
i
] = '\0';

1633 
	`f˛o£
(
Â
);

1635 i‡(
i
 <= 0) {

1636 #ifde‡
STDERR_MSGS


1637 
	`Ârötf
(
°dîr
, "nŸhögÑód from %s", 
fûíame
);

1639 
	`LDNS_FREE
(
löe
);

1640  
NULL
;

1642 
°©us
 = 
	`ldns_º_√w_‰m_°r
(&
r
, 
löe
, 0, 
NULL
, NULL);

1643 i‡(
°©us
 =
LDNS_STATUS_OK
 && (
	`ldns_º_gë_ty≥
(
r
Ë=
LDNS_RR_TYPE_DNSKEY
 ||Üdns_º_gë_ty≥‘Ë=
LDNS_RR_TYPE_DS
)) {

1644 
	`LDNS_FREE
(
löe
);

1645  
r
;

1647 #ifde‡
STDERR_MSGS


1648 
	`Ârötf
(
°dîr
, "Eº‹ cª©ög DNSKEY o∏DSÑ∏‰om %s: %s\n", 
fûíame
, 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

1650 
	`LDNS_FREE
(
löe
);

1651  
NULL
;

1654 
	}
}

1657 
	$ldns_key_gë_fûe_ba£_«me
(
ldns_key
 *
key
)

1659 
ldns_buf„r
 *
buf„r
;

1660 *
fûe_ba£_«me
;

1662 
buf„r
 = 
	`ldns_buf„r_√w
(255);

1663 
	`ldns_buf„r_¥ötf
(
buf„r
, "K");

1664 ()
	`ldns_rdf2buf„r_°r_d«me
(
buf„r
, 
	`ldns_key_pubkey_ow√r
(
key
));

1665 
	`ldns_buf„r_¥ötf
(
buf„r
,

1667 
	`ldns_key_Æg‹ôhm
(
key
),

1668 
	`ldns_key_keyèg
(
key
));

1669 
fûe_ba£_«me
 = 
	`ldns_buf„r_exp‹t
(
buf„r
);

1670 
	`ldns_buf„r_‰ì
(
buf„r
);

1671  
fûe_ba£_«me
;

1672 
	}
}

1674 
	$ldns_key_Ægo_suµ‹ãd
(
Ægo
)

1676 
ldns_lookup_èbÀ
 *
…
 = 
ldns_signög_Æg‹ôhms
;

1677 
…
->
«me
) {

1678 if(
…
->
id
 =
Ægo
)

1680 
…
++;

1683 
	}
}

1685 
ldns_signög_Æg‹ôhm
 
	$ldns_gë_signög_Æg‹ôhm_by_«me
(c⁄° * 
«me
)

1688 
ldns_lookup_èbÀ
 
Æü£s
[] = {

1690 {
LDNS_SIGN_HMACMD5
, "HMAC-MD5"},

1691 {
LDNS_SIGN_DSA_NSEC3
, "NSEC3DSA"},

1692 {
LDNS_SIGN_RSASHA1_NSEC3
, "NSEC3RSASHA1"},

1694 {
LDNS_SIGN_DSA_NSEC3
, "DSA_NSEC3" },

1695 {
LDNS_SIGN_RSASHA1_NSEC3
, "RSASHA1_NSEC3" },

1696 #ifde‡
USE_GOST


1697 {
LDNS_SIGN_ECC_GOST
, "GOST"},

1700 {
LDNS_DH
, "DH"},

1701 {
LDNS_ECC
, "ECC"},

1702 {
LDNS_INDIRECT
, "INDIRECT"},

1703 {
LDNS_PRIVATEDNS
, "PRIVATEDNS"},

1704 {
LDNS_PRIVATEOID
, "PRIVATEOID"},

1705 {0, 
NULL
}};

1706 
ldns_lookup_èbÀ
* 
…
 = 
ldns_signög_Æg‹ôhms
;

1707 
…
->
«me
) {

1708 if(
	`°rˇ£cmp
(
…
->
«me
,Çame) == 0)

1709  
…
->
id
;

1710 
…
++;

1712 
…
 = 
Æü£s
;

1713 
…
->
«me
) {

1714 if(
	`°rˇ£cmp
(
…
->
«me
,Çame) == 0)

1715  
…
->
id
;

1716 
…
++;

1718 if(
	`©oi
(
«me
) != 0)

1719  
	`©oi
(
«me
);

1721 
	}
}

	@ldns/buffer.h

13 #i‚de‡
LDNS_BUFFER_H


14 
	#LDNS_BUFFER_H


	)

16 
	~<as£π.h
>

17 
	~<°d¨g.h
>

18 
	~<°rög.h
>

20 
	~<ldns/îr‹.h
>

21 
	~<ldns/comm⁄.h
>

23 
	~"ldns/utû.h
"

25 #ifde‡
__˝lu•lus


33 
	#LDNS_MIN_BUFLEN
 512

	)

50 
	sldns_°ru˘_buf„r


53 
size_t
 
_posôi⁄
;

56 
size_t
 
_limô
;

59 
size_t
 
_ˇ∑côy
;

62 
uöt8_t
 *
_d©a
;

65 
_fixed
 : 1;

70 
ldns_°©us
 
_°©us
;

72 
ldns_°ru˘_buf„r
 
	tldns_buf„r
;

75 #ifde‡
NDEBUG


76 
INLINE
 

77 
ldns_buf„r_öv¨ü¡
(
ldns_buf„r
 *
ATTR_UNUSED
(
buf„r
))

81 
INLINE
 

82 
ldns_buf„r_öv¨ü¡
(
ldns_buf„r
 *
buf„r
)

84 
as£π
(
buf„r
 !
NULL
);

85 
as£π
(
buf„r
->
_posôi⁄
 <buf„r->
_limô
);

86 
as£π
(
buf„r
->
_limô
 <buf„r->
_ˇ∑côy
);

87 
as£π
(
buf„r
->
_d©a
 !
NULL
);

97 
ldns_buf„r
 *
ldns_buf„r_√w
(
size_t
 
ˇ∑côy
);

108 
ldns_buf„r_√w_‰m_d©a
(
ldns_buf„r
 *
buf„r
, *
d©a
, 
size_t
 
size
);

115 
INLINE
 
ldns_buf„r_˛ór
(
ldns_buf„r
 *
buf„r
)

117 
ldns_buf„r_öv¨ü¡
(
buf„r
);

121 
buf„r
->
_posôi⁄
 = 0;

122 
buf„r
->
_limô
 = buf„r->
_ˇ∑côy
;

133 
INLINE
 
ldns_buf„r_Êù
(
ldns_buf„r
 *
buf„r
)

135 
ldns_buf„r_öv¨ü¡
(
buf„r
);

137 
buf„r
->
_limô
 = buf„r->
_posôi⁄
;

138 
buf„r
->
_posôi⁄
 = 0;

146 
INLINE
 
ldns_buf„r_ªwöd
(
ldns_buf„r
 *
buf„r
)

148 
ldns_buf„r_öv¨ü¡
(
buf„r
);

150 
buf„r
->
_posôi⁄
 = 0;

158 
INLINE
 
size_t


159 
ldns_buf„r_posôi⁄
(
ldns_buf„r
 *
buf„r
)

161  
buf„r
->
_posôi⁄
;

170 
INLINE
 

171 
ldns_buf„r_£t_posôi⁄
(
ldns_buf„r
 *
buf„r
, 
size_t
 
m¨k
)

173 
as£π
(
m¨k
 <
buf„r
->
_limô
);

174 
buf„r
->
_posôi⁄
 = 
m¨k
;

184 
INLINE
 

185 
ldns_buf„r_skù
(
ldns_buf„r
 *
buf„r
, 
ssize_t
 
cou¡
)

187 
as£π
(
buf„r
->
_posôi⁄
 + 
cou¡
 <buf„r->
_limô
);

188 
buf„r
->
_posôi⁄
 +
cou¡
;

196 
INLINE
 
size_t


197 
ldns_buf„r_limô
(
ldns_buf„r
 *
buf„r
)

199  
buf„r
->
_limô
;

208 
INLINE
 

209 
ldns_buf„r_£t_limô
(
ldns_buf„r
 *
buf„r
, 
size_t
 
limô
)

211 
as£π
(
limô
 <
buf„r
->
_ˇ∑côy
);

212 
buf„r
->
_limô
 = 
limô
;

213 i‡(
buf„r
->
_posôi⁄
 > buf„r->
_limô
)

214 
buf„r
->
_posôi⁄
 = buf„r->
_limô
;

222 
INLINE
 
size_t


223 
ldns_buf„r_ˇ∑côy
(
ldns_buf„r
 *
buf„r
)

225  
buf„r
->
_ˇ∑côy
;

236 
boﬁ
 
ldns_buf„r_£t_ˇ∑côy
(
ldns_buf„r
 *
buf„r
, 
size_t
 
ˇ∑côy
);

248 
boﬁ
 
ldns_buf„r_ª£rve
(
ldns_buf„r
 *
buf„r
, 
size_t
 
amou¡
);

256 
INLINE
 
uöt8_t
 *

257 
ldns_buf„r_©
(c⁄° 
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

259 
as£π
(
©
 <
buf„r
->
_limô
);

260  
buf„r
->
_d©a
 + 
©
;

269 
INLINE
 
uöt8_t
 *

270 
ldns_buf„r_begö
(c⁄° 
ldns_buf„r
 *
buf„r
)

272  
ldns_buf„r_©
(
buf„r
, 0);

281 
INLINE
 
uöt8_t
 *

282 
ldns_buf„r_íd
(
ldns_buf„r
 *
buf„r
)

284  
ldns_buf„r_©
(
buf„r
, buf„r->
_limô
);

292 
INLINE
 
uöt8_t
 *

293 
ldns_buf„r_cuºít
(
ldns_buf„r
 *
buf„r
)

295  
ldns_buf„r_©
(
buf„r
, buf„r->
_posôi⁄
);

305 
INLINE
 
size_t


306 
ldns_buf„r_ªmaöög_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

308 
ldns_buf„r_öv¨ü¡
(
buf„r
);

309 
as£π
(
©
 <
buf„r
->
_limô
);

310  
buf„r
->
_limô
 - 
©
;

319 
INLINE
 
size_t


320 
ldns_buf„r_ªmaöög
(
ldns_buf„r
 *
buf„r
)

322  
ldns_buf„r_ªmaöög_©
(
buf„r
, buf„r->
_posôi⁄
);

334 
INLINE
 

335 
ldns_buf„r_avaûabÀ_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, size_à
cou¡
)

337  
cou¡
 <
ldns_buf„r_ªmaöög_©
(
buf„r
, 
©
);

346 
INLINE
 

347 
ldns_buf„r_avaûabÀ
(
ldns_buf„r
 *
buf„r
, 
size_t
 
cou¡
)

349  
ldns_buf„r_avaûabÀ_©
(
buf„r
, buf„r->
_posôi⁄
, 
cou¡
);

359 
INLINE
 

360 
ldns_buf„r_wrôe_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, c⁄° *
d©a
, size_à
cou¡
)

362 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, 
cou¡
));

363 
mem˝y
(
buf„r
->
_d©a
 + 
©
, 
d©a
, 
cou¡
);

372 
INLINE
 

373 
ldns_buf„r_wrôe
(
ldns_buf„r
 *
buf„r
, c⁄° *
d©a
, 
size_t
 
cou¡
)

375 
ldns_buf„r_wrôe_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
, 
cou¡
);

376 
buf„r
->
_posôi⁄
 +
cou¡
;

385 
INLINE
 

386 
ldns_buf„r_wrôe_°rög_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, c⁄° *
°r
)

388 
ldns_buf„r_wrôe_©
(
buf„r
, 
©
, 
°r
, 
°æí
(str));

396 
INLINE
 

397 
ldns_buf„r_wrôe_°rög
(
ldns_buf„r
 *
buf„r
, c⁄° *
°r
)

399 
ldns_buf„r_wrôe
(
buf„r
, 
°r
, 
°æí
(str));

408 
INLINE
 

409 
ldns_buf„r_wrôe_u8_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, 
uöt8_t
 
d©a
)

411 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
d©a
)));

412 
buf„r
->
_d©a
[
©
] = 
d©a
;

420 
INLINE
 

421 
ldns_buf„r_wrôe_u8
(
ldns_buf„r
 *
buf„r
, 
uöt8_t
 
d©a
)

423 
ldns_buf„r_wrôe_u8_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
);

424 
buf„r
->
_posôi⁄
 +(
d©a
);

433 
INLINE
 

434 
ldns_buf„r_wrôe_u16_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, 
uöt16_t
 
d©a
)

436 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
d©a
)));

437 
ldns_wrôe_uöt16
(
buf„r
->
_d©a
 + 
©
, 
d©a
);

445 
INLINE
 

446 
ldns_buf„r_wrôe_u16
(
ldns_buf„r
 *
buf„r
, 
uöt16_t
 
d©a
)

448 
ldns_buf„r_wrôe_u16_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
);

449 
buf„r
->
_posôi⁄
 +(
d©a
);

458 
INLINE
 

459 
ldns_buf„r_wrôe_u32_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, 
uöt32_t
 
d©a
)

461 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
d©a
)));

462 
ldns_wrôe_uöt32
(
buf„r
->
_d©a
 + 
©
, 
d©a
);

470 
INLINE
 

471 
ldns_buf„r_wrôe_u32
(
ldns_buf„r
 *
buf„r
, 
uöt32_t
 
d©a
)

473 
ldns_buf„r_wrôe_u32_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
);

474 
buf„r
->
_posôi⁄
 +(
d©a
);

484 
INLINE
 

485 
ldns_buf„r_ªad_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
, *
d©a
, size_à
cou¡
)

487 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, 
cou¡
));

488 
mem˝y
(
d©a
, 
buf„r
->
_d©a
 + 
©
, 
cou¡
);

497 
INLINE
 

498 
ldns_buf„r_ªad
(
ldns_buf„r
 *
buf„r
, *
d©a
, 
size_t
 
cou¡
)

500 
ldns_buf„r_ªad_©
(
buf„r
, buf„r->
_posôi⁄
, 
d©a
, 
cou¡
);

501 
buf„r
->
_posôi⁄
 +
cou¡
;

510 
INLINE
 
uöt8_t


511 
ldns_buf„r_ªad_u8_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

513 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
uöt8_t
)));

514  
buf„r
->
_d©a
[
©
];

522 
INLINE
 
uöt8_t


523 
ldns_buf„r_ªad_u8
(
ldns_buf„r
 *
buf„r
)

525 
uöt8_t
 
ªsu…
 = 
ldns_buf„r_ªad_u8_©
(
buf„r
, buf„r->
_posôi⁄
);

526 
buf„r
->
_posôi⁄
 +(
uöt8_t
);

527  
ªsu…
;

536 
INLINE
 
uöt16_t


537 
ldns_buf„r_ªad_u16_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

539 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
uöt16_t
)));

540  
ldns_ªad_uöt16
(
buf„r
->
_d©a
 + 
©
);

548 
INLINE
 
uöt16_t


549 
ldns_buf„r_ªad_u16
(
ldns_buf„r
 *
buf„r
)

551 
uöt16_t
 
ªsu…
 = 
ldns_buf„r_ªad_u16_©
(
buf„r
, buf„r->
_posôi⁄
);

552 
buf„r
->
_posôi⁄
 +(
uöt16_t
);

553  
ªsu…
;

562 
INLINE
 
uöt32_t


563 
ldns_buf„r_ªad_u32_©
(
ldns_buf„r
 *
buf„r
, 
size_t
 
©
)

565 
as£π
(
ldns_buf„r_avaûabÀ_©
(
buf„r
, 
©
, (
uöt32_t
)));

566  
ldns_ªad_uöt32
(
buf„r
->
_d©a
 + 
©
);

574 
INLINE
 
uöt32_t


575 
ldns_buf„r_ªad_u32
(
ldns_buf„r
 *
buf„r
)

577 
uöt32_t
 
ªsu…
 = 
ldns_buf„r_ªad_u32_©
(
buf„r
, buf„r->
_posôi⁄
);

578 
buf„r
->
_posôi⁄
 +(
uöt32_t
);

579  
ªsu…
;

587 
INLINE
 
ldns_°©us


588 
ldns_buf„r_°©us
(
ldns_buf„r
 *
buf„r
)

590  
buf„r
->
_°©us
;

598 
INLINE
 
boﬁ


599 
ldns_buf„r_°©us_ok
(
ldns_buf„r
 *
buf„r
)

601 i‡(
buf„r
) {

602  
ldns_buf„r_°©us
(
buf„r
Ë=
LDNS_STATUS_OK
;

604  
Ál£
;

614 
ldns_buf„r_¥ötf
(
ldns_buf„r
 *
buf„r
, c⁄° *
f‹m©
, ...);

622 
ldns_buf„r_‰ì
(
ldns_buf„r
 *
buf„r
);

630 *
ldns_buf„r_exp‹t
(
ldns_buf„r
 *
buf„r
);

639 
ldns_buf„r_c›y
(
ldns_buf„r
* 
ªsu…
,Üdns_buf„r* 
‰om
);

641 #ifde‡
__˝lu•lus


	@ldns/common.h

15 #i‚de‡
LDNS_COMMON_H


16 
	#LDNS_COMMON_H


	)

22 
	#LDNS_BUILD_CONFIG_HAVE_SSL
 1

	)

23 
	#LDNS_BUILD_CONFIG_HAVE_INTTYPES_H
 1

	)

24 
	#LDNS_BUILD_CONFIG_HAVE_ATTR_FORMAT
 1

	)

25 
	#LDNS_BUILD_CONFIG_HAVE_ATTR_UNUSED
 1

	)

26 
	#LDNS_BUILD_CONFIG_HAVE_SOCKLEN_T
 1

	)

27 
	#LDNS_BUILD_CONFIG_USE_DANE
 1

	)

28 
	#LDNS_BUILD_CONFIG_HAVE_B32_PTON
 0

	)

29 
	#LDNS_BUILD_CONFIG_HAVE_B32_NTOP
 0

	)

40 #ifde‡
HAVE_STDBOOL_H


41 
	~<°dboﬁ.h
>

43 #i‚de‡
HAVE__BOOL


44 #ifde‡
__˝lu•lus


45 
boﬁ
 
	t_Boﬁ
;

47 
	#_Boﬁ
 sig√d 

	)

50 
	#boﬁ
 
_Boﬁ


	)

51 
	#Ál£
 0

	)

52 
	#åue
 1

	)

53 
	#__boﬁ_åue_Ál£_¨e_deföed
 1

	)

57 #i‡
LDNS_BUILD_CONFIG_HAVE_ATTR_FORMAT


58 
	#ATTR_FORMAT
(
¨chëy≥
, 
°rög_ödex
, 
fú°_to_check
) \

59 
	`__©åibuã__
 ((
	`f‹m©
 (
¨chëy≥
, 
°rög_ödex
, 
fú°_to_check
)))

	)

61 
	#ATTR_FORMAT
(
¨chëy≥
, 
°rög_ödex
, 
fú°_to_check
Ë

	)

64 #i‡
deföed
(
__˝lu•lus
)

65 
	#ATTR_UNUSED
(
x
)

	)

66 #ñi‡
LDNS_BUILD_CONFIG_HAVE_ATTR_UNUSED


67 
	#ATTR_UNUSED
(
x
Ëx 
	`__©åibuã__
((
unu£d
))

	)

69 
	#ATTR_UNUSED
(
x
Ë
	)
x

72 #i‡!
LDNS_BUILD_CONFIG_HAVE_SOCKLEN_T


73 
	tsockÀn_t
;

	@ldns/config.h

8 
	#HAVE_ARPA_INET_H
 1

	)

11 
	#HAVE_ATTR_FORMAT
 1

	)

14 
	#HAVE_ATTR_UNUSED
 1

	)

29 
	#HAVE_BZERO
 1

	)

32 
	#HAVE_CALLOC
 1

	)

35 
	#HAVE_CTIME_R
 1

	)

38 
	#HAVE_DANE_CA_FILE
 0

	)

41 
	#HAVE_DANE_CA_PATH
 0

	)

45 
	#HAVE_DECL_NID_SECP384R1
 1

	)

49 
	#HAVE_DECL_NID_X9_62_PRIME256V1
 1

	)

52 
	#HAVE_DLFCN_H
 1

	)

55 
	#HAVE_ENDPROTOENT
 1

	)

58 
	#HAVE_ENDSERVENT
 1

	)

61 
	#HAVE_EVP_SHA256
 1

	)

64 
	#HAVE_FCNTL
 1

	)

67 
	#HAVE_FORK
 1

	)

70 
	#HAVE_GETADDRINFO
 1

	)

73 
	#HAVE_GETOPT_H
 1

	)

76 
	#HAVE_GMTIME_R
 1

	)

79 
	#HAVE_HMAC_CTX_INIT
 1

	)

82 
	#HAVE_INET_ATON
 1

	)

85 
	#HAVE_INET_NTOP
 1

	)

88 
	#HAVE_INET_PTON
 1

	)

91 
	#HAVE_INTTYPES_H
 1

	)

97 
	#HAVE_ISASCII
 1

	)

100 
	#HAVE_ISBLANK
 1

	)

103 
	#HAVE_LIBPCAP
 1

	)

106 
	#HAVE_LOCALTIME_R
 1

	)

110 
	#HAVE_MALLOC
 1

	)

113 
	#HAVE_MEMMOVE
 1

	)

116 
	#HAVE_MEMORY_H
 1

	)

119 
	#HAVE_MEMSET
 1

	)

122 
	#HAVE_NETDB_H
 1

	)

125 
	#HAVE_NETINET_IF_ETHER_H
 1

	)

128 
	#HAVE_NETINET_IGMP_H
 1

	)

131 
	#HAVE_NETINET_IN_H
 1

	)

134 
	#HAVE_NETINET_IN_SYSTM_H
 1

	)

137 
	#HAVE_NETINET_IP6_H
 1

	)

143 
	#HAVE_NETINET_IP_H
 1

	)

146 
	#HAVE_NETINET_UDP_H
 1

	)

149 
	#HAVE_NET_ETHERNET_H
 1

	)

152 
	#HAVE_NET_IF_H
 1

	)

155 
	#HAVE_OPENSSL_ERR_H
 1

	)

158 
	#HAVE_OPENSSL_RAND_H
 1

	)

161 
	#HAVE_OPENSSL_SSL_H
 1

	)

164 
	#HAVE_PCAP_H
 1

	)

170 
	#HAVE_RANDOM
 1

	)

174 
	#HAVE_REALLOC
 1

	)

177 
	#HAVE_SLEEP
 1

	)

180 
	#HAVE_SNPRINTF
 1

	)

183 
	#HAVE_SSL


	)

186 
	#HAVE_STDARG_H
 1

	)

189 
	#HAVE_STDBOOL_H
 1

	)

192 
	#HAVE_STDINT_H
 1

	)

195 
	#HAVE_STDLIB_H
 1

	)

198 
	#HAVE_STRINGS_H
 1

	)

201 
	#HAVE_STRING_H
 1

	)

204 
	#HAVE_STRLCPY
 1

	)

207 
	#HAVE_STRTOUL
 1

	)

213 
	#HAVE_SYS_MOUNT_H
 1

	)

216 
	#HAVE_SYS_PARAM_H
 1

	)

219 
	#HAVE_SYS_SOCKET_H
 1

	)

222 
	#HAVE_SYS_STAT_H
 1

	)

225 
	#HAVE_SYS_TYPES_H
 1

	)

228 
	#HAVE_TIMEGM
 1

	)

231 
	#HAVE_TIME_H
 1

	)

234 
	#HAVE_UNISTD_H
 1

	)

237 
	#HAVE_VFORK
 1

	)

246 
	#HAVE_WORKING_FORK
 1

	)

249 
	#HAVE_WORKING_VFORK
 1

	)

255 
	#HAVE__BOOL
 1

	)

264 
	#LDNS_TRUST_ANCHOR_FILE
 "/ëc/unbound/roŸ.key"

	)

268 
	#LT_OBJDIR
 ".libs/"

	)

271 
	#PACKAGE_BUGREPORT
 "libdns@∆√éabs.∆"

	)

274 
	#PACKAGE_NAME
 "ldns"

	)

277 
	#PACKAGE_STRING
 "ldn†1.6.17"

	)

280 
	#PACKAGE_TARNAME
 "libdns"

	)

283 
	#PACKAGE_URL
 ""

	)

286 
	#PACKAGE_VERSION
 "1.6.17"

	)

304 
	#SIZEOF_TIME_T
 8

	)

307 
	#STDC_HEADERS
 1

	)

313 
	#SYSCONFDIR
 
sysc⁄fdú


	)

316 
	#USE_DANE
 1

	)

319 
	#USE_ECDSA
 1

	)

322 
	#USE_GOST
 1

	)

325 
	#USE_SHA2
 1

	)

328 #i‚de‡
_ALL_SOURCE


329 
	#_ALL_SOURCE
 1

	)

332 #i‚de‡
_GNU_SOURCE


333 
	#_GNU_SOURCE
 1

	)

336 #i‚de‡
_POSIX_PTHREAD_SEMANTICS


337 
	#_POSIX_PTHREAD_SEMANTICS
 1

	)

340 #i‚de‡
_TANDEM_SOURCE


341 
	#_TANDEM_SOURCE
 1

	)

344 #i‚de‡
__EXTENSIONS__


345 
	#__EXTENSIONS__
 1

	)

353 
	#WINVER
 0x0502

	)

357 #i‡
deföed
 
AC_APPLE_UNIVERSAL_BUILD


358 #i‡
deföed
 
__BIG_ENDIAN__


359 
	#WORDS_BIGENDIAN
 1

	)

362 #i‚de‡
WORDS_BIGENDIAN


388 #i‚de‡
__˝lu•lus


444 
	~<°dio.h
>

445 
	~<°rög.h
>

446 
	~<uni°d.h
>

447 
	~<as£π.h
>

449 #i‚de‡
LITTLE_ENDIAN


450 
	#LITTLE_ENDIAN
 1234

	)

453 #i‚de‡
BIG_ENDIAN


454 
	#BIG_ENDIAN
 4321

	)

457 #i‚de‡
BYTE_ORDER


458 #ifde‡
WORDS_BIGENDIAN


459 
	#BYTE_ORDER
 
BIG_ENDIAN


	)

461 
	#BYTE_ORDER
 
LITTLE_ENDIAN


	)

465 #i‡
STDC_HEADERS


466 
	~<°dlib.h
>

467 
	~<°ddef.h
>

470 #ifde‡
HAVE_STDINT_H


471 
	~<°döt.h
>

474 #ifde‡
HAVE_SYS_SOCKET_H


475 
	~<sys/sockë.h
>

478 #ifde‡
HAVE_NETINET_IN_H


479 
	~<√töë/ö.h
>

482 #ifde‡
HAVE_ARPA_INET_H


483 
	~<¨∑/öë.h
>

486 #ifde‡
HAVE_WINSOCK2_H


487 
	~<wösock2.h
>

490 #ifde‡
HAVE_WS2TCPIP_H


491 
	~<ws2t˝ù.h
>

496 #ifde‡
HAVE_WINSOCK2_H


497 
	#FD_SET_T
 (
u_öt
)

	)

499 
	#FD_SET_T


	)

505 #ifde‡
__˝lu•lus


509 
ldns_b64_¡›
(
uöt8_t
 c⁄° *
§c
, 
size_t
 
§˛ígth
,

510 *
èrgë
, 
size_t
 
èrgsize
);

515 
ölöe
 
size_t
 
ldns_b64_¡›_ˇlcuœã_size
(size_à
§csize
)

517  ((((
§csize
 + 2) / 3) * 4) + 1);

519 
ldns_b64_±⁄
(c⁄° *
§c
, 
uöt8_t
 *
èrgë
, 
size_t
 
èrgsize
);

524 
ölöe
 
size_t
 
ldns_b64_±⁄_ˇlcuœã_size
(size_à
§csize
)

526  (((((
§csize
 + 3) / 4) * 3)) + 1);

533 
ldns_d«me_com∑ª_v
(c⁄° *
a
, c⁄° *
b
);

535 #i‚de‡
HAVE_SLEEP


537 
	#¶ìp
(
x
Ë
	`SÀï
((x)*1000)

	)

540 #i‚de‡
HAVE_RANDOM


541 
	#§™dom
(
x
Ë
	`§™d
(x)

	)

542 
	#øndom
(
x
Ë
	`ønd
(x)

	)

545 #i‚de‡
HAVE_TIMEGM


546 
	~<time.h
>

547 
time_t
 
timegm
 (
tm
 *tm);

549 #i‚de‡
HAVE_GMTIME_R


550 
tm
 *
gmtime_r
(c⁄° 
time_t
 *
timï
, tm *
ªsu…
);

552 #i‚de‡
HAVE_LOCALTIME_R


553 
tm
 *
loˇ…ime_r
(c⁄° 
time_t
 *
timï
, tm *
ªsu…
);

555 #i‚de‡
HAVE_ISBLANK


556 
isbœnk
(
c
);

558 #i‚de‡
HAVE_ISASCII


559 
ißscii
(
c
);

561 #i‚de‡
HAVE_SNPRINTF


562 
	~<°d¨g.h
>

563 
¢¥ötf
 (*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, ...);

564 
v¢¥ötf
 (*
°r
, 
size_t
 
cou¡
, c⁄° *
fmt
, 
va_li°
 
¨g
);

566 #i‚de‡
HAVE_INET_PTON


567 
öë_±⁄
(
af
, c⁄° * 
§c
, * 
d°
);

569 #i‚de‡
HAVE_INET_NTOP


570 c⁄° *
öë_¡›
(
af
, c⁄° *
§c
, *
d°
, 
size_t
 
size
);

572 #i‚de‡
HAVE_INET_ATON


573 
öë_©⁄
(c⁄° *
˝
, 
ö_addr
 *
addr
);

575 #i‚de‡
HAVE_MEMMOVE


576 *
memmove
(*
de°
, c⁄° *
§c
, 
size_t
 
n
);

578 #i‚de‡
HAVE_STRLCPY


579 
size_t
 
°æ˝y
(*
d°
, c⁄° *
§c
, size_à
siz
);

581 #ifde‡
__˝lu•lus


584 #i‚de‡
HAVE_GETADDRINFO


585 
	~"com∑t/Áke-rfc2553.h
"

587 #i‚de‡
HAVE_STRTOUL


588 
	#°πoul
 ()
°πﬁ


	)

	@ldns/dane.h

23 #i‚de‡
LDNS_DANE_H


24 
	#LDNS_DANE_H


	)

25 #i‡
LDNS_BUILD_CONFIG_USE_DANE


27 
	~<ldns/comm⁄.h
>

28 
	~<ldns/rd©a.h
>

29 
	~<ldns/º.h
>

30 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


31 
	~<›ís¶/s¶.h
>

32 
	~<›ís¶/îr.h
>

35 #ifde‡
__˝lu•lus


42 
	eldns_íum_éß_˚πifiˇã_ußge


45 
LDNS_TLSA_USAGE_CA_CONSTRAINT
 = 0,

47 
LDNS_TLSA_USAGE_SERVICE_CERTIFICATE_CONSTRAINT
 = 1,

49 
LDNS_TLSA_USAGE_TRUST_ANCHOR_ASSERTION
 = 2,

51 
LDNS_TLSA_USAGE_DOMAIN_ISSUED_CERTIFICATE
 = 3

53 
ldns_íum_éß_˚πifiˇã_ußge
 
	tldns_éß_˚πifiˇã_ußge
;

58 
	eldns_íum_éß_£À˘‹


64 
LDNS_TLSA_SELECTOR_FULL_CERTIFICATE
 = 0,

70 
LDNS_TLSA_SELECTOR_SUBJECTPUBLICKEYINFO
 = 1

72 
ldns_íum_éß_£À˘‹
 
	tldns_éß_£À˘‹
;

77 
	eldns_íum_éß_m©chög_ty≥


80 
LDNS_TLSA_MATCHING_TYPE_NO_HASH_USED
 = 0,

82 
LDNS_TLSA_MATCHING_TYPE_SHA256
 = 1,

84 
LDNS_TLSA_MATCHING_TYPE_SHA512
 = 2

86 
ldns_íum_éß_m©chög_ty≥
 
	tldns_éß_m©chög_ty≥
;

91 
	eldns_íum_d™e_å™•‹t


94 
LDNS_DANE_TRANSPORT_TCP
 = 0,

96 
LDNS_DANE_TRANSPORT_UDP
 = 1,

98 
LDNS_DANE_TRANSPORT_SCTP
 = 2

100 
ldns_íum_d™e_å™•‹t
 
	tldns_d™e_å™•‹t
;

113 
ldns_°©us
 
ldns_d™e_¸óã_éß_ow√r
(
ldns_rdf
** 
éß_ow√r
,

114 c⁄° 
ldns_rdf
* 
«me
, 
uöt16_t
 
p‹t
,

115 
ldns_d™e_å™•‹t
 
å™•‹t
);

118 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


130 
ldns_°©us
 
ldns_d™e_˚π2rdf
(
ldns_rdf
** 
rdf
, 
X509
* 
˚π
,

131 
ldns_éß_£À˘‹
 
£À˘‹
,

132 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
);

163 
ldns_°©us
 
ldns_d™e_£À˘_˚πifiˇã
(
X509
** 
£À˘ed_˚π
,

164 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

165 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
,

166 
ldns_éß_˚πifiˇã_ußge
 
˚π_ußge
, 
ödex
);

181 
ldns_°©us
 
ldns_d™e_¸óã_éß_º
(
ldns_º
** 
éß
,

182 
ldns_éß_˚πifiˇã_ußge
 
˚πifiˇã_ußge
,

183 
ldns_éß_£À˘‹
 
£À˘‹
,

184 
ldns_éß_m©chög_ty≥
 
m©chög_ty≥
,

185 
X509
* 
˚π
);

210 
ldns_°©us
 
ldns_d™e_vîify_º
(c⁄° 
ldns_º
* 
éß_º
,

211 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

212 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
);

235 
ldns_°©us
 
ldns_d™e_vîify
(
ldns_º_li°
* 
éßs
,

236 
X509
* 
˚π
, 
STACK_OF
(X509)* 
exåa_˚πs
,

237 
X509_STORE
* 
pkix_vÆid©i⁄_°‹e
);

240 #ifde‡
__˝lu•lus


	@ldns/dname.h

39 #i‚de‡
LDNS_DNAME_H


40 
	#LDNS_DNAME_H


	)

42 
	~<ldns/comm⁄.h
>

43 
	~<ldns/rd©a.h
>

45 #ifde‡
__˝lu•lus


49 
	#LDNS_DNAME_NORMALIZE
 
tﬁowî


	)

57 
ldns_rdf
 *
ldns_d«me_ˇt_˛⁄e
(c⁄°Üdns_rd‡*
rd1
, c⁄°Üdns_rd‡*
rd2
);

65 
ldns_°©us
 
ldns_d«me_ˇt
(
ldns_rdf
 *
rd1
,Üdns_rd‡*
rd2
);

73 
ldns_rdf
 *
ldns_d«me_ªvî£
(c⁄°Üdns_rd‡*
d
);

84 
ldns_rdf
 *

85 
ldns_d«me_˛⁄e_‰om
(c⁄° 
ldns_rdf
 *
d
, 
uöt16_t
 
n
);

94 
ldns_rdf
 *
ldns_d«me_À·_ch›
(c⁄°Üdns_rd‡*
d
);

101 
uöt8_t
 
ldns_d«me_œbñ_cou¡
(c⁄° 
ldns_rdf
 *
r
);

108 
ldns_rdf
 *
ldns_d«me_√w_‰m_°r
(c⁄° *
°r
);

117 
ldns_rdf
 *
ldns_d«me_√w
(
uöt16_t
 
s
, *
d©a
);

126 
ldns_rdf
 *
ldns_d«me_√w_‰m_d©a
(
uöt16_t
 
size
, c⁄° *
d©a
);

133 
ldns_d«me2ˇn⁄iˇl
(c⁄° 
ldns_rdf
 *
rdf
);

143 
boﬁ
 
ldns_d«me_is_subdomaö
(c⁄° 
ldns_rdf
 *
sub
, c⁄°Üdns_rd‡*
∑ª¡
);

152 
ldns_d«me_com∑ª
(c⁄° 
ldns_rdf
 *
d«me1
, c⁄°Üdns_rd‡*
d«me2
);

163 
ldns_d«me_m©ch_wûdˇrd
(c⁄° 
ldns_rdf
 *
d«me
, c⁄°Üdns_rd‡*
wûdˇrd
);

173 
ldns_d«me_öãrvÆ
(c⁄° 
ldns_rdf
 *
¥ev
, c⁄°Üdns_rd‡*
middÀ
, c⁄°Üdns_rd‡*
√xt
);

180 
boﬁ
 
ldns_d«me_°r_absﬁuã
(c⁄° *
d«me_°r
);

187 
boﬁ
 
ldns_d«me_absﬁuã
(c⁄° 
ldns_rdf
 *
d«me
);

197 
ldns_rdf
 * 
ldns_d«me_œbñ
(c⁄°Üdns_rd‡*
rdf
, 
uöt8_t
 
œbñpos
);

204 
ldns_d«me_is_wûdˇrd
(c⁄° 
ldns_rdf
* 
d«me
);

206 #ifde‡
__˝lu•lus


	@ldns/dnssec.h

23 #i‚de‡
LDNS_DNSSEC_H


24 
	#LDNS_DNSSEC_H


	)

26 
	~<ldns/comm⁄.h
>

27 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


28 
	~<›ís¶/s¶.h
>

29 
	~<›ís¶/evp.h
>

31 
	~<ldns/∑ckë.h
>

32 
	~<ldns/keys.h
>

33 
	~<ldns/z⁄e.h
>

34 
	~<ldns/ªsﬁvî.h
>

35 
	~<ldns/dns£c_z⁄e.h
>

37 #ifde‡
__˝lu•lus


41 
	#LDNS_MAX_KEYLEN
 2048

	)

42 
	#LDNS_DNSSEC_KEYPROTO
 3

	)

44 
	#LDNS_DEFAULT_EXP_TIME
 2419200

	)

47 
	#LDNS_SIGNATURE_LEAVE_ADD_NEW
 0

	)

48 
	#LDNS_SIGNATURE_LEAVE_NO_ADD
 1

	)

49 
	#LDNS_SIGNATURE_REMOVE_ADD_NEW
 2

	)

50 
	#LDNS_SIGNATURE_REMOVE_NO_ADD
 3

	)

62 
ldns_º
 *
ldns_dns£c_gë_ºsig_f‹_«me_™d_ty≥
(c⁄° 
ldns_rdf
 *
«me
,

63 c⁄° 
ldns_º_ty≥
 
ty≥
,

64 c⁄° 
ldns_º_li°
 *
ºs
);

75 
ldns_º
 *
ldns_dns£c_gë_dnskey_f‹_ºsig
(c⁄°Üdns_º *
ºsig
, c⁄° 
ldns_º_li°
 *
ºs
);

84 
ldns_rdf
 *
ldns_n£c_gë_bôm≠
(
ldns_º
 *
n£c
);

87 
	#LDNS_NSEC3_MAX_ITERATIONS
 65535

	)

92 
ldns_rdf
 *

93 
ldns_dns£c_n£c3_˛o£°_í˛o£r
(
ldns_rdf
 *
q«me
,

94 
ldns_º_ty≥
 
qty≥
,

95 
ldns_º_li°
 *
n£c3s
);

100 
boﬁ


101 
ldns_dns£c_pkt_has_ºsigs
(c⁄° 
ldns_pkt
 *
pkt
);

107 
ldns_º_li°
 *
ldns_dns£c_pkt_gë_ºsigs_f‹_«me_™d_ty≥
(c⁄° 
ldns_pkt
 *
pkt
, 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
ty≥
);

112 
ldns_º_li°
 *
ldns_dns£c_pkt_gë_ºsigs_f‹_ty≥
(c⁄° 
ldns_pkt
 *
pkt
, 
ldns_º_ty≥
 
ty≥
);

120 
uöt16_t
 
ldns_ˇlc_keyèg
(c⁄° 
ldns_º
 *
key
);

128 
uöt16_t
 
ldns_ˇlc_keyèg_øw
(
uöt8_t
* 
key
, 
size_t
 
keysize
);

130 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


137 
DSA
 *
ldns_key_buf2dß
(
ldns_buf„r
 *
key
);

144 
DSA
 *
ldns_key_buf2dß_øw
(* 
key
, 
size_t
 
Àn
);

154 
ldns_dige°_evp
(* 
d©a
, 
Àn
,

155 * 
de°
, c⁄° 
EVP_MD
* 
md
);

164 
EVP_PKEY
* 
ldns_go°2pkey_øw
(* 
key
, 
size_t
 
keyÀn
);

174 
EVP_PKEY
* 
ldns_ecdß2pkey_øw
(* 
key
, 
size_t
 
keyÀn
, 
uöt8_t
 
Ægo
);

178 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


185 
RSA
 *
ldns_key_buf2rß
(
ldns_buf„r
 *
key
);

193 
RSA
 *
ldns_key_buf2rß_øw
(* 
key
, 
size_t
 
Àn
);

204 
ldns_º
 *
ldns_key_º2ds
(c⁄°Üdns_º *
key
, 
ldns_hash
 
h
);

209 
ldns_rdf
 *

210 
ldns_dns£c_¸óã_n£c_bôm≠
(
ldns_º_ty≥
 
º_ty≥_li°
[],

211 
size_t
 
size
,

212 
ldns_º_ty≥
 
n£c_ty≥
);

222 
ldns_dns£c_º£ts_c⁄èös_ty≥
 (
ldns_dns£c_º£ts
 *
º£ts
, 
ldns_º_ty≥
 
ty≥
);

227 
ldns_º
 *

228 
ldns_dns£c_¸óã_n£c
(
ldns_dns£c_«me
 *
‰om
,

229 
ldns_dns£c_«me
 *
to
,

230 
ldns_º_ty≥
 
n£c_ty≥
);

236 
ldns_º
 *

237 
ldns_dns£c_¸óã_n£c3
(
ldns_dns£c_«me
 *
‰om
,

238 
ldns_dns£c_«me
 *
to
,

239 
ldns_rdf
 *
z⁄e_«me
,

240 
uöt8_t
 
Æg‹ôhm
,

241 
uöt8_t
 
Êags
,

242 
uöt16_t
 
ôî©i⁄s
,

243 
uöt8_t
 
ß…_Àngth
,

244 
uöt8_t
 *
ß…
);

253 
ldns_º
 * 
ldns_¸óã_n£c
(
ldns_rdf
 *
cur_ow√r
,Üdns_rd‡*
√xt_ow√r
, 
ldns_º_li°
 *
ºs
);

264 
ldns_rdf
 *
ldns_n£c3_hash_«me
÷dns_rd‡*
«me
, 
uöt8_t
 
Æg‹ôhm
, 
uöt16_t
 
ôî©i⁄s
, uöt8_à
ß…_Àngth
, uöt8_à*
ß…
);

276 
ldns_n£c3_add_∑øm_rdfs
(
ldns_º
 *
º
,

277 
uöt8_t
 
Æg‹ôhm
,

278 
uöt8_t
 
Êags
,

279 
uöt16_t
 
ôî©i⁄s
,

280 
uöt8_t
 
ß…_Àngth
,

281 
uöt8_t
 *
ß…
);

285 
ldns_º
 *

286 
ldns_¸óã_n£c3
(
ldns_rdf
 *
cur_ow√r
,

287 
ldns_rdf
 *
cur_z⁄e
,

288 
ldns_º_li°
 *
ºs
,

289 
uöt8_t
 
Æg‹ôhm
,

290 
uöt8_t
 
Êags
,

291 
uöt16_t
 
ôî©i⁄s
,

292 
uöt8_t
 
ß…_Àngth
,

293 
uöt8_t
 *
ß…
,

294 
boﬁ
 
em±yn⁄ãrmöÆ
);

301 
uöt8_t
 
ldns_n£c3_Æg‹ôhm
(c⁄° 
ldns_º
 *
n£c3_º
);

306 
uöt8_t


307 
ldns_n£c3_Êags
(c⁄° 
ldns_º
 *
n£c3_º
);

314 
boﬁ
 
ldns_n£c3_›tout
(c⁄° 
ldns_º
 *
n£c3_º
);

321 
uöt16_t
 
ldns_n£c3_ôî©i⁄s
(c⁄° 
ldns_º
 *
n£c3_º
);

328 
ldns_rdf
 *
ldns_n£c3_ß…
(c⁄° 
ldns_º
 *
n£c3_º
);

335 
uöt8_t
 
ldns_n£c3_ß…_Àngth
(c⁄° 
ldns_º
 *
n£c3_º
);

342 
uöt8_t
 *
ldns_n£c3_ß…_d©a
(c⁄° 
ldns_º
 *
n£c3_º
);

349 
ldns_rdf
 *
ldns_n£c3_√xt_ow√r
(c⁄° 
ldns_º
 *
n£c3_º
);

356 
ldns_rdf
 *
ldns_n£c3_bôm≠
(c⁄° 
ldns_º
 *
n£c3_º
);

364 
ldns_rdf
 *
ldns_n£c3_hash_«me_‰m_n£c3
(c⁄° 
ldns_º
 *
n£c
,Üdns_rd‡*
«me
);

372 
boﬁ
 
ldns_n£c_bôm≠_covîs_ty≥
(c⁄° 
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
);

381 
ldns_°©us
 
ldns_n£c_bôm≠_£t_ty≥
(
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
);

390 
ldns_°©us
 
ldns_n£c_bôm≠_˛ór_ty≥
(
ldns_rdf
* 
bôm≠
, 
ldns_º_ty≥
 
ty≥
);

402 
boﬁ
 
ldns_n£c_covîs_«me
(c⁄° 
ldns_º
 *
n£c
, c⁄° 
ldns_rdf
 *
«me
);

404 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


416 
ldns_°©us
 
ldns_pkt_vîify
(
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_rdf
 *
o
, 
ldns_º_li°
 *
k
,Üdns_º_li° *
s
,Üdns_º_li° *
good_keys
);

430 
ldns_°©us
 
ldns_pkt_vîify_time
(
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_rdf
 *
o
, 
ldns_º_li°
 *
k
,Üdns_º_li° *
s
, 
time_t
 
check_time
,Üdns_º_li° *
good_keys
);

437 
ldns_°©us


438 
ldns_dns£c_chaö_n£c3_li°
(
ldns_º_li°
 *
n£c3_ºs
);

444 
qs‹t_º_com∑ª_n£c3
(c⁄° *
a
, c⁄° *
b
);

450 
ldns_º_li°_s‹t_n£c3
(
ldns_º_li°
 *
uns‹ãd
);

459 
ldns_dns£c_deÁu…_add_to_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

467 
ldns_dns£c_deÁu…_Àave_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

475 
ldns_dns£c_deÁu…_dñëe_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

483 
ldns_dns£c_deÁu…_ª∂a˚_sig«tuªs
(
ldns_º
 *
sig
, *
n
);

485 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


494 
ldns_rdf
 *

495 
ldns_c⁄vît_dß_ºsig_a¢12rdf
(c⁄° 
ldns_buf„r
 *
sig
,

496 c⁄° 
sig_Àn
);

506 
ldns_°©us


507 
ldns_c⁄vît_dß_ºsig_rdf2a¢1
(
ldns_buf„r
 *
èrgë_buf„r
,

508 c⁄° 
ldns_rdf
 *
sig_rdf
);

519 
ldns_rdf
 *

520 
ldns_c⁄vît_ecdß_ºsig_a¢12rdf
(c⁄° 
ldns_buf„r
 *
sig
, c⁄° 
sig_Àn
);

531 
ldns_°©us


532 
ldns_c⁄vît_ecdß_ºsig_rdf2a¢1
(
ldns_buf„r
 *
èrgë_buf„r
,

533 c⁄° 
ldns_rdf
 *
sig_rdf
);

537 #ifde‡
__˝lu•lus


	@ldns/dnssec_sign.h

3 #i‚de‡
LDNS_DNSSEC_SIGN_H


4 
	#LDNS_DNSSEC_SIGN_H


	)

6 
	~<ldns/dns£c.h
>

8 #ifde‡
__˝lu•lus


15 
	#LDNS_SIGN_DNSKEY_WITH_ZSK
 1

	)

23 
ldns_º
 *

24 
ldns_¸óã_em±y_ºsig
(
ldns_º_li°
 *
º£t
,

25 
ldns_key
 *
key
);

34 
ldns_rdf
 *

35 
ldns_sign_public_buf„r
(
ldns_buf„r
 *
sign_buf
, 
ldns_key
 *
key
);

43 
ldns_º_li°
 *
ldns_sign_public
÷dns_º_li° *
º£t
, 
ldns_key_li°
 *
keys
);

45 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


52 
ldns_rdf
 *
ldns_sign_public_dß
(
ldns_buf„r
 *
to_sign
, 
DSA
 *
key
);

64 
ldns_rdf
 *
ldns_sign_public_evp
(
ldns_buf„r
 *
to_sign
,

65 
EVP_PKEY
 *
key
,

66 c⁄° 
EVP_MD
 *
dige°_ty≥
);

74 
ldns_rdf
 *
ldns_sign_public_rßsha1
(
ldns_buf„r
 *
to_sign
, 
RSA
 *
key
);

82 
ldns_rdf
 *
ldns_sign_public_rßmd5
(
ldns_buf„r
 *
to_sign
, 
RSA
 *
key
);

99 
ldns_°©us


100 
ldns_dns£c_z⁄e_m¨k_™d_gë_glue
(

101 
ldns_dns£c_z⁄e
 *
z⁄e
, 
ldns_º_li°
 *
glue_li°
);

113 
ldns_°©us


114 
ldns_dns£c_z⁄e_m¨k_glue
(
ldns_dns£c_z⁄e
 *
z⁄e
);

124 
ldns_rbnode_t
 *
ldns_dns£c_«me_node_√xt_n⁄glue
÷dns_rbnode_à*
node
);

134 
ldns_°©us
 
ldns_dns£c_z⁄e_¸óã_n£cs
(
ldns_dns£c_z⁄e
 *
z⁄e
,

135 
ldns_º_li°
 *
√w_ºs
);

140 
ldns_°©us


141 
ldns_dns£c_z⁄e_¸óã_n£c3s
(
ldns_dns£c_z⁄e
 *
z⁄e
,

142 
ldns_º_li°
 *
√w_ºs
,

143 
uöt8_t
 
Æg‹ôhm
,

144 
uöt8_t
 
Êags
,

145 
uöt16_t
 
ôî©i⁄s
,

146 
uöt8_t
 
ß…_Àngth
,

147 
uöt8_t
 *
ß…
);

163 
ldns_dns£c_ºs
 *
ldns_dns£c_ªmove_sig«tuªs
÷dns_dns£c_º†*
sig«tuªs
,

164 
ldns_key_li°
 *
key_li°
,

165 (*
func
)(
ldns_º
 *, *),

166 *
¨g
);

186 
ldns_°©us
 
ldns_dns£c_z⁄e_¸óã_ºsigs_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

187 
ldns_º_li°
 *
√w_ºs
,

188 
ldns_key_li°
 *
key_li°
,

189 (*
func
)(
ldns_º
 *, *),

190 *
¨g
,

191 
Êags
);

206 
ldns_°©us
 
ldns_dns£c_z⁄e_¸óã_ºsigs
(
ldns_dns£c_z⁄e
 *
z⁄e
,

207 
ldns_º_li°
 *
√w_ºs
,

208 
ldns_key_li°
 *
key_li°
,

209 (*
func
)(
ldns_º
 *, *),

210 *
¨g
);

237 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

238 
ldns_º_li°
 *
√w_ºs
,

239 
ldns_key_li°
 *
key_li°
,

240 (*
func
)(
ldns_º
 *, *),

241 *
¨g
,

242 
Êags
);

260 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_n£c3_Êg
(
ldns_dns£c_z⁄e
 *
z⁄e
,

261 
ldns_º_li°
 *
√w_ºs
,

262 
ldns_key_li°
 *
key_li°
,

263 (*
func
)(
ldns_º
 *, *),

264 *
¨g
,

265 
uöt8_t
 
Æg‹ôhm
,

266 
uöt8_t
 
Êags
,

267 
uöt16_t
 
ôî©i⁄s
,

268 
uöt8_t
 
ß…_Àngth
,

269 
uöt8_t
 *
ß…
,

270 
signÊags
);

291 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_n£c3_Êg_mkm≠
(
ldns_dns£c_z⁄e
 *
z⁄e
,

292 
ldns_º_li°
 *
√w_ºs
,

293 
ldns_key_li°
 *
key_li°
,

294 (*
func
)(
ldns_º
 *, *),

295 *
¨g
,

296 
uöt8_t
 
Æg‹ôhm
,

297 
uöt8_t
 
Êags
,

298 
uöt16_t
 
ôî©i⁄s
,

299 
uöt8_t
 
ß…_Àngth
,

300 
uöt8_t
 *
ß…
,

301 
signÊags
,

302 
ldns_rbåì_t
 **
m≠


326 
ldns_°©us
 
ldns_dns£c_z⁄e_sign
(
ldns_dns£c_z⁄e
 *
z⁄e
,

327 
ldns_º_li°
 *
√w_ºs
,

328 
ldns_key_li°
 *
key_li°
,

329 (*
func
)(
ldns_º
 *, *),

330 *
¨g
);

347 
ldns_°©us
 
ldns_dns£c_z⁄e_sign_n£c3
(
ldns_dns£c_z⁄e
 *
z⁄e
,

348 
ldns_º_li°
 *
√w_ºs
,

349 
ldns_key_li°
 *
key_li°
,

350 (*
func
)(
ldns_º
 *, *),

351 *
¨g
,

352 
uöt8_t
 
Æg‹ôhm
,

353 
uöt8_t
 
Êags
,

354 
uöt16_t
 
ôî©i⁄s
,

355 
uöt8_t
 
ß…_Àngth
,

356 
uöt8_t
 *
ß…
);

364 
ldns_z⁄e
 *
ldns_z⁄e_sign
(c⁄°Üdns_z⁄ê*
z⁄e
, 
ldns_key_li°
 *
key_li°
);

377 
ldns_z⁄e
 *
ldns_z⁄e_sign_n£c3
÷dns_z⁄ê*
z⁄e
, 
ldns_key_li°
 *
key_li°
, 
uöt8_t
 
Æg‹ôhm
, uöt8_à
Êags
, 
uöt16_t
 
ôî©i⁄s
, uöt8_à
ß…_Àngth
, uöt8_à*
ß…
);

379 #ifde‡
__˝lu•lus


	@ldns/dnssec_verify.h

3 #i‚de‡
LDNS_DNSSEC_VERIFY_H


4 
	#LDNS_DNSSEC_VERIFY_H


	)

6 
	#LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
 10

	)

8 
	~<ldns/dns£c.h
>

9 
	~<ldns/ho°2°r.h
>

11 #ifde‡
__˝lu•lus


19 
ldns_dns£c_d©a_chaö_°ru˘
 
	tldns_dns£c_d©a_chaö
;

20 
	sldns_dns£c_d©a_chaö_°ru˘


22 
ldns_º_li°
 *
º£t
;

23 
ldns_º_li°
 *
sig«tuªs
;

24 
ldns_º_ty≥
 
∑ª¡_ty≥
;

25 
ldns_dns£c_d©a_chaö
 *
∑ª¡
;

26 
ldns_pkt_rcode
 
∑ckë_rcode
;

27 
ldns_º_ty≥
 
∑ckë_qty≥
;

28 
boﬁ
 
∑ckë_nod©a
;

35 
ldns_dns£c_d©a_chaö
 *
ldns_dns£c_d©a_chaö_√w
();

42 
ldns_dns£c_d©a_chaö_‰ì
(
ldns_dns£c_d©a_chaö
 *
chaö
);

50 
ldns_dns£c_d©a_chaö_dìp_‰ì
(
ldns_dns£c_d©a_chaö
 *
chaö
);

58 
ldns_dns£c_d©a_chaö_¥öt
(
FILE
 *
out
, c⁄° 
ldns_dns£c_d©a_chaö
 *
chaö
);

67 
ldns_dns£c_d©a_chaö_¥öt_fmt
(
FILE
 *
out
,

68 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

69 c⁄° 
ldns_dns£c_d©a_chaö
 *
chaö
);

86 
ldns_dns£c_d©a_chaö
 *
ldns_dns£c_buûd_d©a_chaö
(
ldns_ªsﬁvî
 *
ªs
,

87 c⁄° 
uöt16_t
 
qÊags
,

88 c⁄° 
ldns_º_li°
 *
d©a_£t
,

89 c⁄° 
ldns_pkt
 *
pkt
,

90 
ldns_º
 *
‹ig_º
);

121 
ldns_dns£c_åu°_åì_°ru˘
 
	tldns_dns£c_åu°_åì
;

122 
	sldns_dns£c_åu°_åì_°ru˘


124 
ldns_º
 *
º
;

126 
ldns_º_li°
 *
º£t
;

127 
ldns_dns£c_åu°_åì
 *
∑ª¡s
[
LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
];

128 
ldns_°©us
 
∑ª¡_°©us
[
LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
];

131 
ldns_º
 *
∑ª¡_sig«tuª
[
LDNS_DNSSEC_TRUST_TREE_MAX_PARENTS
];

132 
size_t
 
∑ª¡_cou¡
;

140 
ldns_dns£c_åu°_åì
 *
ldns_dns£c_åu°_åì_√w
();

150 
ldns_dns£c_åu°_åì_‰ì
(
ldns_dns£c_åu°_åì
 *
åì
);

158 
size_t
 
ldns_dns£c_åu°_åì_dïth
(
ldns_dns£c_åu°_åì
 *
åì
);

172 
ldns_dns£c_åu°_åì_¥öt
(
FILE
 *
out
,

173 
ldns_dns£c_åu°_åì
 *
åì
,

174 
size_t
 
èbs
,

175 
boﬁ
 
exãnded
);

190 
ldns_dns£c_åu°_åì_¥öt_fmt
(
FILE
 *
out
,

191 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

192 
ldns_dns£c_åu°_åì
 *
åì
,

193 
size_t
 
èbs
,

194 
boﬁ
 
exãnded
);

206 
ldns_°©us
 
ldns_dns£c_åu°_åì_add_∑ª¡
(
ldns_dns£c_åu°_åì
 *
åì
,

207 c⁄° 
ldns_dns£c_åu°_åì
 *
∑ª¡
,

208 c⁄° 
ldns_º
 *
∑ª¡_sig«tuª
,

209 c⁄° 
ldns_°©us
 
∑ª¡_°©us
);

222 
ldns_dns£c_åu°_åì
 *
ldns_dns£c_dîive_åu°_åì
(

223 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

224 
ldns_º
 *
º
);

238 
ldns_dns£c_åu°_åì
 *
ldns_dns£c_dîive_åu°_åì_time
(

239 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

240 
ldns_º
 *
º
, 
time_t
 
check_time
);

249 
ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t
(

250 
ldns_dns£c_åu°_åì
 *
√w_åì
,

251 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

252 
ldns_º
 *
cur_sig_º
);

262 
ldns_dns£c_dîive_åu°_åì_n‹mÆ_º£t_time
(

263 
ldns_dns£c_åu°_åì
 *
√w_åì
,

264 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

265 
ldns_º
 *
cur_sig_º
, 
time_t
 
check_time
);

276 
ldns_dns£c_dîive_åu°_åì_dnskey_º£t
(

277 
ldns_dns£c_åu°_åì
 *
√w_åì
,

278 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

279 
ldns_º
 *
cur_º
,

280 
ldns_º
 *
cur_sig_º
);

291 
ldns_dns£c_dîive_åu°_åì_dnskey_º£t_time
(

292 
ldns_dns£c_åu°_åì
 *
√w_åì
,

293 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

294 
ldns_º
 *
cur_º
,Üdns_º *
cur_sig_º
,

295 
time_t
 
check_time
);

307 
ldns_dns£c_dîive_åu°_åì_dnskey_º£t_time
(

308 
ldns_dns£c_åu°_åì
 *
√w_åì
,

309 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

310 
ldns_º
 *
cur_º
,Üdns_º *
cur_sig_º
,

311 
time_t
 
check_time
);

321 
ldns_dns£c_dîive_åu°_åì_ds_º£t
(

322 
ldns_dns£c_åu°_åì
 *
√w_åì
,

323 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

324 
ldns_º
 *
cur_º
);

334 
ldns_dns£c_dîive_åu°_åì_ds_º£t_time
(

335 
ldns_dns£c_åu°_åì
 *
√w_åì
,

336 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

337 
ldns_º
 *
cur_º
, 
time_t
 
check_time
);

346 
ldns_dns£c_dîive_åu°_åì_no_sig
(

347 
ldns_dns£c_åu°_åì
 *
√w_åì
,

348 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
);

358 
ldns_dns£c_dîive_åu°_åì_no_sig_time
(

359 
ldns_dns£c_åu°_åì
 *
√w_åì
,

360 
ldns_dns£c_d©a_chaö
 *
d©a_chaö
,

361 
time_t
 
check_time
);

375 
ldns_°©us
 
ldns_dns£c_åu°_åì_c⁄èös_keys
(

376 
ldns_dns£c_åu°_åì
 *
åì
,

377 
ldns_º_li°
 *
keys
);

390 
ldns_°©us
 
ldns_vîify
(
ldns_º_li°
 *
º£t
,

391 
ldns_º_li°
 *
ºsig
,

392 c⁄° 
ldns_º_li°
 *
keys
,

393 
ldns_º_li°
 *
good_keys
);

407 
ldns_°©us
 
ldns_vîify_time
(
ldns_º_li°
 *
º£t
,

408 
ldns_º_li°
 *
ºsig
,

409 c⁄° 
ldns_º_li°
 *
keys
,

410 
time_t
 
check_time
,

411 
ldns_º_li°
 *
good_keys
);

426 
ldns_°©us
 
ldns_vîify_nŸime
(
ldns_º_li°
 *
º£t
,

427 
ldns_º_li°
 *
ºsig
,

428 c⁄° 
ldns_º_li°
 *
keys
,

429 
ldns_º_li°
 *
good_keys
);

445 
ldns_º_li°
 *
ldns_„tch_vÆid_domaö_keys
(c⁄° 
ldns_ªsﬁvî
 * 
ªs
,

446 c⁄° 
ldns_rdf
 * 
domaö
,

447 c⁄° 
ldns_º_li°
 * 
keys
,

448 
ldns_°©us
 *
°©us
);

465 
ldns_º_li°
 *
ldns_„tch_vÆid_domaö_keys_time
(c⁄° 
ldns_ªsﬁvî
 * 
ªs
,

466 c⁄° 
ldns_rdf
 * 
domaö
, c⁄° 
ldns_º_li°
 * 
keys
,

467 
time_t
 
check_time
, 
ldns_°©us
 *
°©us
);

480 
ldns_º_li°
 *
ldns_vÆid©e_domaö_dnskey
 (c⁄° 
ldns_ªsﬁvî
 *
ªs
,

481 c⁄° 
ldns_rdf
 *
domaö
,

482 c⁄° 
ldns_º_li°
 *
keys
);

495 
ldns_º_li°
 *
ldns_vÆid©e_domaö_dnskey_time
(

496 c⁄° 
ldns_ªsﬁvî
 *
ªs
, c⁄° 
ldns_rdf
 *
domaö
,

497 c⁄° 
ldns_º_li°
 *
keys
, 
time_t
 
check_time
);

508 
ldns_º_li°
 *
ldns_vÆid©e_domaö_ds
(c⁄° 
ldns_ªsﬁvî
 *
ªs
,

509 c⁄° 
ldns_rdf
 *

510 
domaö
,

511 c⁄° 
ldns_º_li°
 * 
keys
);

522 
ldns_º_li°
 *
ldns_vÆid©e_domaö_ds_time
(

523 c⁄° 
ldns_ªsﬁvî
 *
ªs
, c⁄° 
ldns_rdf
 *
domaö
,

524 c⁄° 
ldns_º_li°
 * 
keys
, 
time_t
 
check_time
);

538 
ldns_°©us
 
ldns_vîify_åu°ed
(
ldns_ªsﬁvî
 *
ªs
,

539 
ldns_º_li°
 *
º£t
,

540 
ldns_º_li°
 *
ºsigs
,

541 
ldns_º_li°
 *
vÆid©ög_keys
);

555 
ldns_°©us
 
ldns_vîify_åu°ed_time
(

556 
ldns_ªsﬁvî
 *
ªs
, 
ldns_º_li°
 *
º£t
,

557 
ldns_º_li°
 *
ºsigs
, 
time_t
 
check_time
,

558 
ldns_º_li°
 *
vÆid©ög_keys
);

571 
ldns_°©us
 
ldns_dns£c_vîify_díül
(
ldns_º
 *
º
,

572 
ldns_º_li°
 *
n£cs
,

573 
ldns_º_li°
 *
ºsigs
);

592 
ldns_°©us
 
ldns_dns£c_vîify_díül_n£c3
(
ldns_º
 *
º
,

593 
ldns_º_li°
 *
n£cs
,

594 
ldns_º_li°
 *
ºsigs
,

595 
ldns_pkt_rcode
 
∑ckë_rcode
,

596 
ldns_º_ty≥
 
∑ckë_qty≥
,

597 
boﬁ
 
∑ckë_nod©a
);

617 
ldns_°©us
 
ldns_dns£c_vîify_díül_n£c3_m©ch
(
ldns_º
 *
º
,

618 
ldns_º_li°
 *
n£cs
,

619 
ldns_º_li°
 *
ºsigs
,

620 
ldns_pkt_rcode
 
∑ckë_rcode
,

621 
ldns_º_ty≥
 
∑ckë_qty≥
,

622 
boﬁ
 
∑ckë_nod©a
,

623 
ldns_º
 **
m©ch
);

634 
ldns_°©us
 
ldns_vîify_ºsig_buf„rs
(
ldns_buf„r
 *
øwsig_buf
,

635 
ldns_buf„r
 *
vîify_buf
,

636 
ldns_buf„r
 *
key_buf
,

637 
uöt8_t
 
Ægo
);

650 
ldns_°©us
 
ldns_vîify_ºsig_buf„rs_øw
(* 
sig
,

651 
size_t
 
sigÀn
,

652 
ldns_buf„r
 *
vîify_buf
,

653 * 
key
,

654 
size_t
 
keyÀn
,

655 
uöt8_t
 
Ægo
);

668 
ldns_°©us
 
ldns_vîify_ºsig_keyli°
(
ldns_º_li°
 *
º£t
,

669 
ldns_º
 *
ºsig
,

670 c⁄° 
ldns_º_li°
 *
keys
,

671 
ldns_º_li°
 *
good_keys
);

685 
ldns_°©us
 
ldns_vîify_ºsig_keyli°_time
(

686 
ldns_º_li°
 *
º£t
, 
ldns_º
 *
ºsig
,

687 c⁄° 
ldns_º_li°
 *
keys
, 
time_t
 
check_time
,

688 
ldns_º_li°
 *
good_keys
);

702 
ldns_°©us
 
ldns_vîify_ºsig_keyli°_nŸime
(
ldns_º_li°
 *
º£t
,

703 
ldns_º
 *
ºsig
,

704 c⁄° 
ldns_º_li°
 *
keys
,

705 
ldns_º_li°
 *
good_keys
);

714 
ldns_°©us
 
ldns_vîify_ºsig
(
ldns_º_li°
 *
º£t
,

715 
ldns_º
 *
ºsig
,

716 
ldns_º
 *
key
);

727 
ldns_°©us
 
ldns_vîify_ºsig_time
(

728 
ldns_º_li°
 *
º£t
, 
ldns_º
 *
ºsig
,

729 
ldns_º
 *
key
, 
time_t
 
check_time
);

732 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


742 
ldns_°©us
 
ldns_vîify_ºsig_evp
(
ldns_buf„r
 *
sig
,

743 
ldns_buf„r
 *
º£t
,

744 
EVP_PKEY
 *
key
,

745 c⁄° 
EVP_MD
 *
dige°_ty≥
);

755 
ldns_°©us
 
ldns_vîify_ºsig_evp_øw
(*
sig
,

756 
size_t
 
sigÀn
,

757 
ldns_buf„r
 *
º£t
,

758 
EVP_PKEY
 *
key
,

759 c⁄° 
EVP_MD
 *
dige°_ty≥
);

770 
ldns_°©us
 
ldns_vîify_ºsig_dß
(
ldns_buf„r
 *
sig
,

771 
ldns_buf„r
 *
º£t
,

772 
ldns_buf„r
 *
key
);

782 
ldns_°©us
 
ldns_vîify_ºsig_rßsha1
(
ldns_buf„r
 *
sig
,

783 
ldns_buf„r
 *
º£t
,

784 
ldns_buf„r
 *
key
);

794 
ldns_°©us
 
ldns_vîify_ºsig_rßmd5
(
ldns_buf„r
 *
sig
,

795 
ldns_buf„r
 *
º£t
,

796 
ldns_buf„r
 *
key
);

806 
ldns_°©us
 
ldns_vîify_ºsig_dß_øw
(* 
sig
,

807 
size_t
 
sigÀn
,

808 
ldns_buf„r
* 
º£t
,

809 * 
key
,

810 
size_t
 
keyÀn
);

820 
ldns_°©us
 
ldns_vîify_ºsig_rßsha1_øw
(* 
sig
,

821 
size_t
 
sigÀn
,

822 
ldns_buf„r
* 
º£t
,

823 * 
key
,

824 
size_t
 
keyÀn
);

835 
ldns_°©us
 
ldns_vîify_ºsig_rßsha256_øw
(* 
sig
,

836 
size_t
 
sigÀn
,

837 
ldns_buf„r
* 
º£t
,

838 * 
key
,

839 
size_t
 
keyÀn
);

849 
ldns_°©us
 
ldns_vîify_ºsig_rßsha512_øw
(* 
sig
,

850 
size_t
 
sigÀn
,

851 
ldns_buf„r
* 
º£t
,

852 * 
key
,

853 
size_t
 
keyÀn
);

863 
ldns_°©us
 
ldns_vîify_ºsig_rßmd5_øw
(* 
sig
,

864 
size_t
 
sigÀn
,

865 
ldns_buf„r
* 
º£t
,

866 * 
key
,

867 
size_t
 
keyÀn
);

869 #ifde‡
__˝lu•lus


	@ldns/dnssec_zone.h

8 #i‚de‡
LDNS_DNSSEC_ZONE_H


9 
	#LDNS_DNSSEC_ZONE_H


	)

11 
	~<ldns/rbåì.h
>

12 
	~<ldns/ho°2°r.h
>

14 #ifde‡
__˝lu•lus


21 
ldns_°ru˘_dns£c_ºs
 
	tldns_dns£c_ºs
;

22 
	sldns_°ru˘_dns£c_ºs


24 
ldns_º
 *
º
;

25 
ldns_dns£c_ºs
 *
√xt
;

31 
ldns_°ru˘_dns£c_º£ts
 
	tldns_dns£c_º£ts
;

32 
	sldns_°ru˘_dns£c_º£ts


34 
ldns_dns£c_ºs
 *
ºs
;

35 
ldns_º_ty≥
 
ty≥
;

36 
ldns_dns£c_ºs
 *
sig«tuªs
;

37 
ldns_dns£c_º£ts
 *
√xt
;

44 
ldns_°ru˘_dns£c_«me
 
	tldns_dns£c_«me
;

45 
	sldns_°ru˘_dns£c_«me


51 
ldns_rdf
 *
«me
;

59 
boﬁ
 
«me_Ælo˚d
;

63 
ldns_dns£c_º£ts
 *
º£ts
;

67 
ldns_º
 *
n£c
;

71 
ldns_dns£c_ºs
 *
n£c_sig«tuªs
;

81 
boﬁ
 
is_glue
;

85 
ldns_rdf
 *
hashed_«me
;

91 
	sldns_°ru˘_dns£c_z⁄e
 {

93 
ldns_dns£c_«me
 *
sﬂ
;

95 
ldns_rbåì_t
 *
«mes
;

97 
ldns_rbåì_t
 *
hashed_«mes
;

102 
ldns_º
 *
_n£c3∑øms
;

104 
ldns_°ru˘_dns£c_z⁄e
 
	tldns_dns£c_z⁄e
;

110 
ldns_dns£c_ºs
 *
ldns_dns£c_ºs_√w
();

118 
ldns_dns£c_ºs_‰ì
(
ldns_dns£c_ºs
 *
ºs
);

126 
ldns_dns£c_ºs_dìp_‰ì
(
ldns_dns£c_ºs
 *
ºs
);

136 
ldns_°©us
 
ldns_dns£c_ºs_add_º
(
ldns_dns£c_ºs
 *
ºs
, 
ldns_º
 *
º
);

144 
ldns_dns£c_ºs_¥öt
(
FILE
 *
out
, 
ldns_dns£c_ºs
 *
ºs
);

153 
ldns_dns£c_ºs_¥öt_fmt
(
FILE
 *
out
,

154 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, 
ldns_dns£c_ºs
 *
ºs
);

160 
ldns_dns£c_º£ts
 *
ldns_dns£c_º£ts_√w
();

168 
ldns_dns£c_º£ts_‰ì
(
ldns_dns£c_º£ts
 *
º£ts
);

176 
ldns_dns£c_º£ts_dìp_‰ì
(
ldns_dns£c_º£ts
 *
º£ts
);

184 
ldns_º_ty≥
 
ldns_dns£c_º£ts_ty≥
(
ldns_dns£c_º£ts
 *
º£ts
);

193 
ldns_°©us
 
ldns_dns£c_º£ts_£t_ty≥
(
ldns_dns£c_º£ts
 *
º£ts
,

194 
ldns_º_ty≥
 
ty≥
);

204 
ldns_°©us
 
ldns_dns£c_º£ts_add_º
(
ldns_dns£c_º£ts
 *
º£ts
, 
ldns_º
 *
º
);

213 
ldns_dns£c_º£ts_¥öt
(
FILE
 *
out
,

214 
ldns_dns£c_º£ts
 *
º£ts
,

215 
boﬁ
 
fﬁlow
);

225 
ldns_dns£c_º£ts_¥öt_fmt
(
FILE
 *
out
,

226 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

227 
ldns_dns£c_º£ts
 *
º£ts
,

228 
boﬁ
 
fﬁlow
);

235 
ldns_dns£c_«me
 *
ldns_dns£c_«me_√w
();

242 
ldns_dns£c_«me
 *
ldns_dns£c_«me_√w_‰m_º
(
ldns_º
 *
º
);

250 
ldns_dns£c_«me_‰ì
(
ldns_dns£c_«me
 *
«me
);

258 
ldns_dns£c_«me_dìp_‰ì
(
ldns_dns£c_«me
 *
«me
);

266 
ldns_rdf
 *
ldns_dns£c_«me_«me
(
ldns_dns£c_«me
 *
«me
);

275 
ldns_dns£c_«me_£t_«me
(
ldns_dns£c_«me
 *
«me
,

276 
ldns_rdf
 *
d«me
);

288 
boﬁ
 
ldns_dns£c_«me_is_glue
(
ldns_dns£c_«me
 *
«me
);

296 
ldns_dns£c_«me_£t_n£c
(
ldns_dns£c_«me
 *
«me
, 
ldns_º
 *
n£c
);

308 
ldns_dns£c_«me_cmp
(c⁄° *
a
, c⁄° *
b
);

318 
ldns_°©us
 
ldns_dns£c_«me_add_º
(
ldns_dns£c_«me
 *
«me
,

319 
ldns_º
 *
º
);

328 
ldns_dns£c_º£ts
 *
ldns_dns£c_«me_föd_º£t
(
ldns_dns£c_«me
 *
«me
,

329 
ldns_º_ty≥
 
ty≥
);

339 
ldns_dns£c_º£ts
 *
ldns_dns£c_z⁄e_föd_º£t
(
ldns_dns£c_z⁄e
 *
z⁄e
,

340 
ldns_rdf
 *
d«me
,

341 
ldns_º_ty≥
 
ty≥
);

350 
ldns_dns£c_«me_¥öt
(
FILE
 *
out
, 
ldns_dns£c_«me
 *
«me
);

360 
ldns_dns£c_«me_¥öt_fmt
(
FILE
 *
out
,

361 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, 
ldns_dns£c_«me
 *
«me
);

367 
ldns_dns£c_z⁄e
 *
ldns_dns£c_z⁄e_√w
();

379 
ldns_°©us
 
ldns_dns£c_z⁄e_√w_‰m_Â
(
ldns_dns£c_z⁄e
** 
z
, 
FILE
* 
Â
,

380 
ldns_rdf
* 
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
);

393 
ldns_°©us
 
ldns_dns£c_z⁄e_√w_‰m_Â_l
(
ldns_dns£c_z⁄e
** 
z
, 
FILE
* 
Â
,

394 
ldns_rdf
* 
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
, * 
löe_ƒ
);

401 
ldns_dns£c_z⁄e_‰ì
(
ldns_dns£c_z⁄e
 *
z⁄e
);

408 
ldns_dns£c_z⁄e_dìp_‰ì
(
ldns_dns£c_z⁄e
 *
z⁄e
);

420 
ldns_°©us
 
ldns_dns£c_z⁄e_add_º
(
ldns_dns£c_z⁄e
 *
z⁄e
,

421 
ldns_º
 *
º
);

430 
ldns_dns£c_z⁄e_«mes_¥öt
(
FILE
 *
out
, 
ldns_rbåì_t
 *
åì
, 
boﬁ
 
¥öt_sﬂ
);

440 
ldns_dns£c_z⁄e_«mes_¥öt_fmt
(
FILE
 *
out
, c⁄° 
ldns_ouçut_f‹m©
 *
fmt
,

441 
ldns_rbåì_t
 *
åì
, 
boﬁ
 
¥öt_sﬂ
);

449 
ldns_dns£c_z⁄e_¥öt
(
FILE
 *
out
, 
ldns_dns£c_z⁄e
 *
z⁄e
);

458 
ldns_dns£c_z⁄e_¥öt_fmt
(
FILE
 *
out
,

459 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, 
ldns_dns£c_z⁄e
 *
z⁄e
);

468 
ldns_°©us
 
ldns_dns£c_z⁄e_add_em±y_n⁄ãrmöÆs
(
ldns_dns£c_z⁄e
 *
z⁄e
);

477 
boﬁ
 
ldns_dns£c_z⁄e_is_n£c3_›tout
(
ldns_dns£c_z⁄e
* 
z⁄e
);

479 #ifde‡
__˝lu•lus


	@ldns/duration.h

40 #i‚de‡
LDNS_DURATION_H


41 
	#LDNS_DURATION_H


	)

43 
	~<°döt.h
>

44 
	~<time.h
>

50 
ldns_duøti⁄_°ru˘
 
	tldns_duøti⁄_ty≥
;

51 
	sldns_duøti⁄_°ru˘


53 
time_t
 
	myórs
;

54 
time_t
 
	mm⁄ths
;

55 
time_t
 
	mwìks
;

56 
time_t
 
	mdays
;

57 
time_t
 
	mhours
;

58 
time_t
 
	mmöuãs
;

59 
time_t
 
	m£c⁄ds
;

67 
ldns_duøti⁄_ty≥
* 
ldns_duøti⁄_¸óã
();

76 
ldns_duøti⁄_com∑ª
(
ldns_duøti⁄_ty≥
* 
d1
,Üdns_duøti⁄_ty≥* 
d2
);

84 
ldns_duøti⁄_ty≥
* 
ldns_duøti⁄_¸óã_‰om_°rög
(c⁄° * 
°r
);

92 * 
ldns_duøti⁄2°rög
(
ldns_duøti⁄_ty≥
* 
duøti⁄
);

100 
time_t
 
ldns_duøti⁄2time
(
ldns_duøti⁄_ty≥
* 
duøti⁄
);

107 
ldns_duøti⁄_˛ónup
(
ldns_duøti⁄_ty≥
* 
duøti⁄
);

	@ldns/error.h

16 #i‚de‡
LDNS_ERROR_H


17 
	#LDNS_ERROR_H


	)

19 
	~<ldns/utû.h
>

21 #ifde‡
__˝lu•lus


25 
	eldns_íum_°©us
 {

26 
LDNS_STATUS_OK
,

27 
LDNS_STATUS_EMPTY_LABEL
,

28 
LDNS_STATUS_LABEL_OVERFLOW
,

29 
LDNS_STATUS_DOMAINNAME_OVERFLOW
,

30 
LDNS_STATUS_DOMAINNAME_UNDERFLOW
,

31 
LDNS_STATUS_DDD_OVERFLOW
,

32 
LDNS_STATUS_PACKET_OVERFLOW
,

33 
LDNS_STATUS_INVALID_POINTER
,

34 
LDNS_STATUS_MEM_ERR
,

35 
LDNS_STATUS_INTERNAL_ERR
,

36 
LDNS_STATUS_SSL_ERR
,

37 
LDNS_STATUS_ERR
,

38 
LDNS_STATUS_INVALID_INT
,

39 
LDNS_STATUS_INVALID_IP4
,

40 
LDNS_STATUS_INVALID_IP6
,

41 
LDNS_STATUS_INVALID_STR
,

42 
LDNS_STATUS_INVALID_B32_EXT
,

43 
LDNS_STATUS_INVALID_B64
,

44 
LDNS_STATUS_INVALID_HEX
,

45 
LDNS_STATUS_INVALID_TIME
,

46 
LDNS_STATUS_NETWORK_ERR
,

47 
LDNS_STATUS_ADDRESS_ERR
,

48 
LDNS_STATUS_FILE_ERR
,

49 
LDNS_STATUS_UNKNOWN_INET
,

50 
LDNS_STATUS_NOT_IMPL
,

51 
LDNS_STATUS_NULL
,

52 
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
,

53 
LDNS_STATUS_CRYPTO_ALGO_NOT_IMPL
,

54 
LDNS_STATUS_CRYPTO_NO_RRSIG
,

55 
LDNS_STATUS_CRYPTO_NO_DNSKEY
,

56 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DNSKEY
,

57 
LDNS_STATUS_CRYPTO_NO_DS
,

58 
LDNS_STATUS_CRYPTO_NO_TRUSTED_DS
,

59 
LDNS_STATUS_CRYPTO_NO_MATCHING_KEYTAG_DNSKEY
,

60 
LDNS_STATUS_CRYPTO_VALIDATED
,

61 
LDNS_STATUS_CRYPTO_BOGUS
,

62 
LDNS_STATUS_CRYPTO_SIG_EXPIRED
,

63 
LDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED
,

64 
LDNS_STATUS_CRYPTO_TSIG_BOGUS
,

65 
LDNS_STATUS_CRYPTO_TSIG_ERR
,

66 
LDNS_STATUS_CRYPTO_EXPIRATION_BEFORE_INCEPTION
,

67 
LDNS_STATUS_CRYPTO_TYPE_COVERED_ERR
,

68 
LDNS_STATUS_ENGINE_KEY_NOT_LOADED
,

69 
LDNS_STATUS_NSEC3_ERR
,

70 
LDNS_STATUS_RES_NO_NS
,

71 
LDNS_STATUS_RES_QUERY
,

72 
LDNS_STATUS_WIRE_INCOMPLETE_HEADER
,

73 
LDNS_STATUS_WIRE_INCOMPLETE_QUESTION
,

74 
LDNS_STATUS_WIRE_INCOMPLETE_ANSWER
,

75 
LDNS_STATUS_WIRE_INCOMPLETE_AUTHORITY
,

76 
LDNS_STATUS_WIRE_INCOMPLETE_ADDITIONAL
,

77 
LDNS_STATUS_NO_DATA
,

78 
LDNS_STATUS_CERT_BAD_ALGORITHM
,

79 
LDNS_STATUS_SYNTAX_TYPE_ERR
,

80 
LDNS_STATUS_SYNTAX_CLASS_ERR
,

81 
LDNS_STATUS_SYNTAX_TTL_ERR
,

82 
LDNS_STATUS_SYNTAX_INCLUDE_ERR_NOTIMPL
,

83 
LDNS_STATUS_SYNTAX_RDATA_ERR
,

84 
LDNS_STATUS_SYNTAX_DNAME_ERR
,

85 
LDNS_STATUS_SYNTAX_VERSION_ERR
,

86 
LDNS_STATUS_SYNTAX_ALG_ERR
,

87 
LDNS_STATUS_SYNTAX_KEYWORD_ERR
,

88 
LDNS_STATUS_SYNTAX_TTL
,

89 
LDNS_STATUS_SYNTAX_ORIGIN
,

90 
LDNS_STATUS_SYNTAX_INCLUDE
,

91 
LDNS_STATUS_SYNTAX_EMPTY
,

92 
LDNS_STATUS_SYNTAX_ITERATIONS_OVERFLOW
,

93 
LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
,

94 
LDNS_STATUS_SYNTAX_INTEGER_OVERFLOW
,

95 
LDNS_STATUS_SYNTAX_BAD_ESCAPE
,

96 
LDNS_STATUS_SOCKET_ERROR
,

97 
LDNS_STATUS_SYNTAX_ERR
,

98 
LDNS_STATUS_DNSSEC_EXISTENCE_DENIED
,

99 
LDNS_STATUS_DNSSEC_NSEC_RR_NOT_COVERED
,

100 
LDNS_STATUS_DNSSEC_NSEC_WILDCARD_NOT_COVERED
,

101 
LDNS_STATUS_DNSSEC_NSEC3_ORIGINAL_NOT_FOUND
,

102 
LDNS_STATUS_MISSING_RDATA_FIELDS_RRSIG
,

103 
LDNS_STATUS_MISSING_RDATA_FIELDS_KEY
,

104 
LDNS_STATUS_CRYPTO_SIG_EXPIRED_WITHIN_MARGIN
,

105 
LDNS_STATUS_CRYPTO_SIG_NOT_INCEPTED_WITHIN_MARGIN
,

106 
LDNS_STATUS_DANE_STATUS_MESSAGES
,

107 
LDNS_STATUS_DANE_UNKNOWN_CERTIFICATE_USAGE
,

108 
LDNS_STATUS_DANE_UNKNOWN_SELECTOR
,

109 
LDNS_STATUS_DANE_UNKNOWN_MATCHING_TYPE
,

110 
LDNS_STATUS_DANE_UNKNOWN_PROTOCOL
,

111 
LDNS_STATUS_DANE_UNKNOWN_TRANSPORT
,

112 
LDNS_STATUS_DANE_MISSING_EXTRA_CERTS
,

113 
LDNS_STATUS_DANE_EXTRA_CERTS_NOT_USED
,

114 
LDNS_STATUS_DANE_OFFSET_OUT_OF_RANGE
,

115 
LDNS_STATUS_DANE_INSECURE
,

116 
LDNS_STATUS_DANE_BOGUS
,

117 
LDNS_STATUS_DANE_TLSA_DID_NOT_MATCH
,

118 
LDNS_STATUS_DANE_NON_CA_CERTIFICATE
,

119 
LDNS_STATUS_DANE_PKIX_DID_NOT_VALIDATE
,

120 
LDNS_STATUS_DANE_PKIX_NO_SELF_SIGNED_TRUST_ANCHOR
,

121 
LDNS_STATUS_EXISTS_ERR
,

122 
LDNS_STATUS_INVALID_ILNP64
,

123 
LDNS_STATUS_INVALID_EUI48
,

124 
LDNS_STATUS_INVALID_EUI64
,

125 
LDNS_STATUS_WIRE_RDATA_ERR
,

126 
LDNS_STATUS_INVALID_TAG
,

127 
LDNS_STATUS_TYPE_NOT_IN_BITMAP
,

128 
LDNS_STATUS_INVALID_RDF_TYPE
,

129 
LDNS_STATUS_RDATA_OVERFLOW
,

131 
ldns_íum_°©us
 
	tldns_°©us
;

133 
ldns_lookup_èbÀ
 
ldns_îr‹_°r
[];

141 c⁄° *
ldns_gë_îr‹°r_by_id
(
ldns_°©us
 
îr
);

143 #ifde‡
__˝lu•lus


	@ldns/higher.h

16 #i‚de‡
LDNS_HIGHER_H


17 
	#LDNS_HIGHER_H


	)

19 
	~<ldns/ªsﬁvî.h
>

20 
	~<ldns/rd©a.h
>

21 
	~<ldns/º.h
>

22 
	~<ldns/ho°2°r.h
>

23 
	~<ldns/tsig.h
>

25 #ifde‡
__˝lu•lus


37 
ldns_º_li°
 *
ldns_gë_º_li°_addr_by_«me
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
«me
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

47 
ldns_º_li°
 *
ldns_gë_º_li°_«me_by_addr
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
addr
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

56 
ldns_º_li°
 *
ldns_gë_º_li°_ho°s_‰m_Â
(
FILE
 *
Â
);

66 
ldns_º_li°
 *
ldns_gë_º_li°_ho°s_‰m_Â_l
(
FILE
 *
Â
, *
löe_ƒ
);

75 
ldns_º_li°
 *
ldns_gë_º_li°_ho°s_‰m_fûe
(*
fûíame
);

89 
uöt16_t
 
ldns_gëaddröfo
(
ldns_ªsﬁvî
 *
ªs
, 
ldns_rdf
 *
node
, 
ldns_º_˛ass
 
c
, 
ldns_º_li°
 **
li°
);

97 
boﬁ
 
ldns_n£c_ty≥_check
(
ldns_º
 *
n£c
, 
ldns_º_ty≥
 
t
);

107 
ldns_¥öt_º_rdf
(
FILE
 *
Â
, 
ldns_º
 *
r
, 
rd‚um
, ...);

109 #ifde‡
__˝lu•lus


	@ldns/host2str.h

18 #i‚de‡
LDNS_HOST2STR_H


19 
	#LDNS_HOST2STR_H


	)

21 
	~<ldns/comm⁄.h
>

22 
	~<ldns/îr‹.h
>

23 
	~<ldns/º.h
>

24 
	~<ldns/rd©a.h
>

25 
	~<ldns/∑ckë.h
>

26 
	~<ldns/buf„r.h
>

27 
	~<ldns/ªsﬁvî.h
>

28 
	~<ldns/z⁄e.h
>

29 
	~<˘y≥.h
>

31 
	~"ldns/utû.h
"

33 #ifde‡
__˝lu•lus


37 
	#LDNS_APL_IP4
 1

	)

38 
	#LDNS_APL_IP6
 2

	)

39 
	#LDNS_APL_MASK
 0x7f

	)

40 
	#LDNS_APL_NEGATION
 0x80

	)

48 
	#LDNS_COMMENT_NULLS
 (1 << 0)

	)

50 
	#LDNS_COMMENT_KEY_ID
 (1 << 1)

	)

52 
	#LDNS_COMMENT_KEY_TYPE
 (1 << 2)

	)

54 
	#LDNS_COMMENT_KEY_SIZE
 (1 << 3)

	)

56 
	#LDNS_COMMENT_BUBBLEBABBLE
 (1 << 4)

	)

58 
	#LDNS_COMMENT_FLAGS
 (1 << 5)

	)

60 
	#LDNS_COMMENT_NSEC3_CHAIN
 (1 << 6Ë

	)

62 
	#LDNS_COMMENT_LAYOUT
 (1 << 7)

	)

64 
	#LDNS_COMMENT_RRSIGS
 (1 << 8)

	)

65 
	#LDNS_FMT_ZEROIZE_RRSIGS
 (1 << 9)

	)

66 
	#LDNS_FMT_PAD_SOA_SERIAL
 (1 << 10)

	)

67 
	#LDNS_FMT_RFC3597
 (1 << 11Ë

	)

69 
	#LDNS_FMT_FLAGS_WITH_DATA
 2

	)

72 
	#LDNS_COMMENT_KEY
 (
LDNS_COMMENT_KEY_ID
 \

73 |
LDNS_COMMENT_KEY_TYPE
\

74 |
LDNS_COMMENT_KEY_SIZE
)

	)

86 
	sldns_°ru˘_ouçut_f‹m©


89 
Êags
;

91 *
d©a
;

93 
ldns_°ru˘_ouçut_f‹m©
 
	tldns_ouçut_f‹m©
;

100 
	sldns_°ru˘_ouçut_f‹m©_°‹age


101 { 
Êags
;

102 
ldns_rbåì_t
* 
hashm≠
;

103 
ldns_rdf
* 
bôm≠
;

105 
ldns_°ru˘_ouçut_f‹m©_°‹age
 
	tldns_ouçut_f‹m©_°‹age
;

111 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_nocommíts
;

116 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_⁄lykeyids
;

120 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_deÁu…
;

126 c⁄° 
ldns_ouçut_f‹m©
 *
ldns_ouçut_f‹m©_bubbÀbabbÀ
;

133 
INLINE


134 
ldns_ouçut_f‹m©
* 
ldns_ouçut_f‹m©_öô
(
ldns_ouçut_f‹m©_°‹age
* 
fmt
) {

135 
	gfmt
->
	gÊags
 = 
ldns_ouçut_f‹m©_deÁu…
->
Êags
;

136 
	gfmt
->
	ghashm≠
 = 
NULL
;

137 
	gfmt
->
	gbôm≠
 = 
NULL
;

138  (
	gldns_ouçut_f‹m©
*)
	gfmt
;

144 
INLINE
 
ldns_ouçut_f‹m©_£t
(
ldns_ouçut_f‹m©
* 
fmt
, 
Êag
) {

145 
	gfmt
->
	gÊags
 |
Êag
;

151 
INLINE
 
ldns_ouçut_f‹m©_˛ór
(
ldns_ouçut_f‹m©
* 
fmt
, 
Êag
) {

152 
	gfmt
->
	gÊags
 &!
Êag
;

162 
ldns_°©us


163 
ldns_ouçut_f‹m©_£t_ty≥
(
ldns_ouçut_f‹m©
* 
fmt
, 
ldns_º_ty≥
 
ty≥
);

174 
ldns_°©us


175 
ldns_ouçut_f‹m©_˛ór_ty≥
(
ldns_ouçut_f‹m©
* 
fmt
, 
ldns_º_ty≥
 
ty≥
);

184 
ldns_°©us


185 
ldns_pkt_›code2buf„r_°r
(
ldns_buf„r
 *
ouçut
, 
ldns_pkt_›code
 
›code
);

194 
ldns_°©us


195 
ldns_pkt_rcode2buf„r_°r
(
ldns_buf„r
 *
ouçut
, 
ldns_pkt_rcode
 
rcode
);

204 
ldns_°©us


205 
ldns_Æg‹ôhm2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

206 
ldns_Æg‹ôhm
 
Æg‹ôhm
);

215 
ldns_°©us


216 
ldns_˚π_Æg‹ôhm2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

217 
ldns_˚π_Æg‹ôhm
 
˚π_Æg‹ôhm
);

228 *
ldns_pkt_›code2°r
(
ldns_pkt_›code
 
›code
);

238 *
ldns_pkt_rcode2°r
(
ldns_pkt_rcode
 
rcode
);

248 *
ldns_pkt_Æg‹ôhm2°r
(
ldns_Æg‹ôhm
 
Æg‹ôhm
);

258 *
ldns_pkt_˚π_Æg‹ôhm2°r
(
ldns_˚π_Æg‹ôhm
 
˚π_Æg‹ôhm
);

266 
ldns_°©us
 
ldns_rdf2buf„r_°r_a
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

274 
ldns_°©us
 
ldns_rdf2buf„r_°r_ØØ
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

282 
ldns_°©us
 
ldns_rdf2buf„r_°r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

290 
ldns_°©us
 
ldns_rdf2buf„r_°r_b64
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

298 
ldns_°©us
 
ldns_rdf2buf„r_°r_b32_ext
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

306 
ldns_°©us
 
ldns_rdf2buf„r_°r_hex
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

314 
ldns_°©us
 
ldns_rdf2buf„r_°r_ty≥
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

322 
ldns_°©us
 
ldns_rdf2buf„r_°r_˛ass
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

330 
ldns_°©us
 
ldns_rdf2buf„r_°r_Æg
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

339 
ldns_°©us
 
ldns_º_ty≥2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

340 c⁄° 
ldns_º_ty≥
 
ty≥
);

350 *
ldns_º_ty≥2°r
(c⁄° 
ldns_º_ty≥
 
ty≥
);

359 
ldns_°©us
 
ldns_º_˛ass2buf„r_°r
(
ldns_buf„r
 *
ouçut
,

360 c⁄° 
ldns_º_˛ass
 
kœss
);

370 *
ldns_º_˛ass2°r
(c⁄° 
ldns_º_˛ass
 
kœss
);

379 
ldns_°©us
 
ldns_rdf2buf„r_°r_˚π_Æg
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

387 
ldns_°©us
 
ldns_rdf2buf„r_°r_loc
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

395 
ldns_°©us
 
ldns_rdf2buf„r_°r_unknown
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

403 
ldns_°©us
 
ldns_rdf2buf„r_°r_nßp
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

411 
ldns_°©us
 
ldns_rdf2buf„r_°r_©ma
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

419 
ldns_°©us
 
ldns_rdf2buf„r_°r_wks
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

427 
ldns_°©us
 
ldns_rdf2buf„r_°r_n£c
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

435 
ldns_°©us
 
ldns_rdf2buf„r_°r_≥riod
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

443 
ldns_°©us
 
ldns_rdf2buf„r_°r_tsigtime
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

451 
ldns_°©us
 
ldns_rdf2buf„r_°r_≠l
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

459 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt16_d©a
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

467 
ldns_°©us
 
ldns_rdf2buf„r_°r_ù£ckey
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

477 
ldns_°©us
 
ldns_rdf2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

489 
ldns_°©us
 
ldns_º2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
º
);

503 
ldns_°©us
 
ldns_º2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

504 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
);

514 
ldns_°©us
 
ldns_pkt2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

525 
ldns_°©us
 
ldns_pkt2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

526 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
);

534 
ldns_°©us
 
ldns_rdf2buf„r_°r_n£c3_ß…
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

545 
ldns_°©us
 
ldns_key2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_key
 *
k
);

553 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt8
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

561 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt16
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

569 
ldns_°©us
 
ldns_rdf2buf„r_°r_öt32
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

577 
ldns_°©us
 
ldns_rdf2buf„r_°r_time
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

586 
ldns_°©us
 
ldns_rdf2buf„r_°r_û≈64
(
ldns_buf„r
 *
ouçut
,

587 c⁄° 
ldns_rdf
 *
rdf
);

596 
ldns_°©us
 
ldns_rdf2buf„r_°r_eui48
(
ldns_buf„r
 *
ouçut
,

597 c⁄° 
ldns_rdf
 *
rdf
);

606 
ldns_°©us
 
ldns_rdf2buf„r_°r_eui64
(
ldns_buf„r
 *
ouçut
,

607 c⁄° 
ldns_rdf
 *
rdf
);

616 
ldns_°©us
 
ldns_rdf2buf„r_°r_èg
(
ldns_buf„r
 *
ouçut
,

617 c⁄° 
ldns_rdf
 *
rdf
);

626 
ldns_°©us
 
ldns_rdf2buf„r_°r_l⁄g_°r
(
ldns_buf„r
 *
ouçut
,

627 c⁄° 
ldns_rdf
 *
rdf
);

636 
ldns_°©us
 
ldns_rdf2buf„r_°r_hù
(
ldns_buf„r
 *
ouçut
,

637 c⁄° 
ldns_rdf
 *
rdf
);

647 *
ldns_rdf2°r
(c⁄° 
ldns_rdf
 *
rdf
);

657 *
ldns_º2°r
(c⁄° 
ldns_º
 *
º
);

668 *
ldns_º2°r_fmt
(c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
);

678 *
ldns_pkt2°r
(c⁄° 
ldns_pkt
 *
pkt
);

689 *
ldns_pkt2°r_fmt
(c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
);

699 *
ldns_key2°r
(c⁄° 
ldns_key
 *
k
);

709 *
ldns_º_li°2°r
(c⁄° 
ldns_º_li°
 *
º_li°
);

720 *
ldns_º_li°2°r_fmt
(

721 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
º_li°
);

731 *
ldns_buf„r2°r
(
ldns_buf„r
 *
buf„r
);

742 *
ldns_buf„r_exp‹t2°r
(
ldns_buf„r
 *
buf„r
);

752 
ldns_rdf_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

762 
ldns_º_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_º
 *
º
);

773 
ldns_º_¥öt_fmt
(
FILE
 *
ouçut
,

774 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º
 *
º
);

784 
ldns_pkt_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

795 
ldns_pkt_¥öt_fmt
(
FILE
 *
ouçut
,

796 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_pkt
 *
pkt
);

805 
ldns_°©us
 
ldns_º_li°2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º_li°
 *
li°
);

815 
ldns_°©us
 
ldns_º_li°2buf„r_°r_fmt
(
ldns_buf„r
 *
ouçut
,

816 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
li°
);

825 
ldns_°©us
 
ldns_pkthódî2buf„r_°r
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

832 
ldns_º_li°_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_º_li°
 *
li°
);

840 
ldns_º_li°_¥öt_fmt
(
FILE
 *
ouçut
,

841 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_º_li°
 *
li°
);

849 
ldns_ªsﬁvî_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_ªsﬁvî
 *
r
);

858 
ldns_ªsﬁvî_¥öt_fmt
(
FILE
 *
ouçut
,

859 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_ªsﬁvî
 *
r
);

867 
ldns_z⁄e_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_z⁄e
 *
z
);

876 
ldns_z⁄e_¥öt_fmt
(
FILE
 *
ouçut
,

877 c⁄° 
ldns_ouçut_f‹m©
 *
fmt
, c⁄° 
ldns_z⁄e
 *
z
);

885 
ldns_°©us
 
ldns_rdf2buf„r_°r_d«me
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
d«me
);

887 #ifde‡
__˝lu•lus


	@ldns/host2wire.h

17 #i‚de‡
LDNS_HOST2WIRE_H


18 
	#LDNS_HOST2WIRE_H


	)

20 
	~<ldns/comm⁄.h
>

21 
	~<ldns/îr‹.h
>

22 
	~<ldns/º.h
>

23 
	~<ldns/rd©a.h
>

24 
	~<ldns/∑ckë.h
>

25 
	~<ldns/buf„r.h
>

26 
	~<˘y≥.h
>

28 
	~"ldns/utû.h
"

30 #ifde‡
__˝lu•lus


40 
ldns_°©us
 
ldns_d«me2buf„r_wúe
(
ldns_buf„r
 *
buf„r
, c⁄° 
ldns_rdf
 *
«me
);

48 
ldns_°©us
 
ldns_rdf2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_rdf
 *
rdf
);

58 
ldns_°©us
 
ldns_rdf2buf„r_wúe_ˇn⁄iˇl
(
ldns_buf„r
 *
ouçut
,

59 c⁄° 
ldns_rdf
 *
rdf
);

69 
ldns_°©us
 
ldns_º2buf„r_wúe
(
ldns_buf„r
 *
ouçut
,

70 c⁄° 
ldns_º
 *
º
,

71 
£˘i⁄
);

83 
ldns_°©us
 
ldns_º2buf„r_wúe_ˇn⁄iˇl
(
ldns_buf„r
 *
ouçut
,

84 c⁄° 
ldns_º
 *
º
,

85 
£˘i⁄
);

95 
ldns_°©us
 
ldns_ºsig2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
sigº
);

107 
ldns_°©us
 
ldns_º_rd©a2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º
 *
º
);

115 
ldns_°©us
 
ldns_pkt2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_pkt
 *
pkt
);

123 
ldns_°©us
 
ldns_º_li°2buf„r_wúe
(
ldns_buf„r
 *
ouçut
, c⁄° 
ldns_º_li°
 *
ºli°
);

135 
ldns_°©us
 
ldns_rdf2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_rdf
 *
rdf
, 
size_t
 *
size
);

150 
ldns_°©us
 
ldns_º2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_º
 *
º
, , 
size_t
 *
size
);

158 
ldns_°©us
 
ldns_pkt2wúe
(
uöt8_t
 **
de°
, c⁄° 
ldns_pkt
 *
p
, 
size_t
 *
size
);

160 #ifde‡
__˝lu•lus


	@ldns/keys.h

21 #i‚de‡
LDNS_KEYS_H


22 
	#LDNS_KEYS_H


	)

24 
	~<ldns/comm⁄.h
>

25 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


26 
	~<›ís¶/s¶.h
>

28 
	~<ldns/utû.h
>

29 
	~<î∫o.h
>

31 #ifde‡
__˝lu•lus


35 
ldns_lookup_èbÀ
 
ldns_signög_Æg‹ôhms
[];

37 
	#LDNS_KEY_ZONE_KEY
 0x0100

	)

38 
	#LDNS_KEY_SEP_KEY
 0x0001

	)

39 
	#LDNS_KEY_REVOKE_KEY
 0x0080

	)

44 
	eldns_íum_Æg‹ôhm


46 
	gLDNS_RSAMD5
 = 1,

47 
	gLDNS_DH
 = 2,

48 
	gLDNS_DSA
 = 3,

49 
	gLDNS_ECC
 = 4,

50 
	gLDNS_RSASHA1
 = 5,

51 
	gLDNS_DSA_NSEC3
 = 6,

52 
	gLDNS_RSASHA1_NSEC3
 = 7,

53 
	gLDNS_RSASHA256
 = 8,

54 
	gLDNS_RSASHA512
 = 10,

55 
	gLDNS_ECC_GOST
 = 12,

56 
	gLDNS_ECDSAP256SHA256
 = 13,

57 
	gLDNS_ECDSAP384SHA384
 = 14,

58 
	gLDNS_INDIRECT
 = 252,

59 
	gLDNS_PRIVATEDNS
 = 253,

60 
	gLDNS_PRIVATEOID
 = 254

62 
ldns_íum_Æg‹ôhm
 
	tldns_Æg‹ôhm
;

67 
	eldns_íum_hash


69 
	gLDNS_SHA1
 = 1,

70 
	gLDNS_SHA256
 = 2,

71 
	gLDNS_HASH_GOST
 = 3,

72 
	gLDNS_SHA384
 = 4

74 
ldns_íum_hash
 
	tldns_hash
;

79 
	eldns_íum_signög_Æg‹ôhm


81 
	gLDNS_SIGN_RSAMD5
 = 
LDNS_RSAMD5
,

82 
	gLDNS_SIGN_RSASHA1
 = 
LDNS_RSASHA1
,

83 
	gLDNS_SIGN_DSA
 = 
LDNS_DSA
,

84 
	gLDNS_SIGN_RSASHA1_NSEC3
 = 
LDNS_RSASHA1_NSEC3
,

85 
	gLDNS_SIGN_RSASHA256
 = 
LDNS_RSASHA256
,

86 
	gLDNS_SIGN_RSASHA512
 = 
LDNS_RSASHA512
,

87 
	gLDNS_SIGN_DSA_NSEC3
 = 
LDNS_DSA_NSEC3
,

88 
	gLDNS_SIGN_ECC_GOST
 = 
LDNS_ECC_GOST
,

89 
	gLDNS_SIGN_ECDSAP256SHA256
 = 
LDNS_ECDSAP256SHA256
,

90 
	gLDNS_SIGN_ECDSAP384SHA384
 = 
LDNS_ECDSAP384SHA384
,

91 
	gLDNS_SIGN_HMACMD5
 = 157,

92 
	gLDNS_SIGN_HMACSHA1
 = 158,

93 
	gLDNS_SIGN_HMACSHA256
 = 159

95 
ldns_íum_signög_Æg‹ôhm
 
	tldns_signög_Æg‹ôhm
;

107 
	sldns_°ru˘_key
 {

108 
ldns_signög_Æg‹ôhm
 
	g_Æg
;

110 
boﬁ
 
	g_u£
;

114 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


115 #i‚de‡
S_SPLINT_S


118 
EVP_PKEY
 *
	gkey
;

125 *
	gkey
;

126 
size_t
 
	gsize
;

127 } 
	ghmac
;

131 *
	gexã∫Æ_key
;

132 } 
	g_key
;

138 
uöt32_t
 
	g‹ig_âl
;

140 
uöt32_t
 
	gö˚±i⁄
;

142 
uöt32_t
 
	gexpú©i⁄
;

144 
uöt16_t
 
	gkeyèg
;

146 
uöt16_t
 
	gÊags
;

147 } 
	gdns£c
;

148 } 
	g_exåa
;

150 
ldns_rdf
 *
	g_pubkey_ow√r
;

152 
ldns_°ru˘_key
 
	tldns_key
;

157 
	sldns_°ru˘_key_li°


159 
size_t
 
	g_key_cou¡
;

160 
ldns_key
 **
	g_keys
;

162 
ldns_°ru˘_key_li°
 
	tldns_key_li°
;

169 
ldns_key_li°
 *
ldns_key_li°_√w
();

175 
ldns_key
 *
ldns_key_√w
();

184 
ldns_key
 *
ldns_key_√w_‰m_Æg‹ôhm
(
ldns_signög_Æg‹ôhm
 
a
, 
uöt16_t
 
size
);

196 
ldns_°©us
 
ldns_key_√w_‰m_Â
(
ldns_key
 **
k
, 
FILE
 *
Â
);

209 
ldns_°©us
 
ldns_key_√w_‰m_Â_l
(
ldns_key
 **
k
, 
FILE
 *
Â
, *
löe_ƒ
);

211 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


216 
ldns_°©us
 
ldns_key_√w_‰m_ígöe
(
ldns_key
 **
key
, 
ENGINE
 *
e
, *
key_id
, 
ldns_Æg‹ôhm
);

225 
RSA
 *
ldns_key_√w_‰m_Â_rß
(
FILE
 *
Â
);

228 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


236 
RSA
 *
ldns_key_√w_‰m_Â_rß_l
(
FILE
 *
Â
, *
löe_ƒ
);

239 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


246 
DSA
 *
ldns_key_√w_‰m_Â_dß
(
FILE
 *
Â
);

249 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


257 
DSA
 *
ldns_key_√w_‰m_Â_dß_l
(
FILE
 *
Â
, *
löe_ƒ
);

260 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


269 *
ldns_key_√w_‰m_Â_hmac
(
FILE
 *
Â
, 
size_t
 *
hmac_size
);

272 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


282 *
ldns_key_√w_‰m_Â_hmac_l
(
FILE
 *
Â
, *
löe_ƒ
, 
size_t
 *
hmac_size
);

291 
ldns_key_£t_Æg‹ôhm
(
ldns_key
 *
k
, 
ldns_signög_Æg‹ôhm
 
l
);

292 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


298 
ldns_key_£t_evp_key
(
ldns_key
 *
k
, 
EVP_PKEY
 *
e
);

306 
ldns_key_£t_rß_key
(
ldns_key
 *
k
, 
RSA
 *
r
);

314 
ldns_key_£t_dß_key
(
ldns_key
 *
k
, 
DSA
 *
d
);

322 
ldns_key_assign_rß_key
(
ldns_key
 *
k
, 
RSA
 *
r
);

330 
ldns_key_assign_dß_key
(
ldns_key
 *
k
, 
DSA
 *
d
);

337 
ldns_key_EVP_lﬂd_go°_id
();

340 
ldns_key_EVP_u∆ﬂd_go°
();

348 
ldns_key_£t_hmac_key
(
ldns_key
 *
k
, *
hmac
);

360 
ldns_key_£t_exã∫Æ_key
(
ldns_key
 *
key
, *
exã∫Æ_key
);

367 
ldns_key_£t_hmac_size
(
ldns_key
 *
k
, 
size_t
 
hmac_size
);

373 
ldns_key_£t_‹igâl
(
ldns_key
 *
k
, 
uöt32_t
 
t
);

379 
ldns_key_£t_ö˚±i⁄
(
ldns_key
 *
k
, 
uöt32_t
 
i
);

385 
ldns_key_£t_expú©i⁄
(
ldns_key
 *
k
, 
uöt32_t
 
e
);

391 
ldns_key_£t_pubkey_ow√r
(
ldns_key
 *
k
, 
ldns_rdf
 *
r
);

397 
ldns_key_£t_keyèg
(
ldns_key
 *
k
, 
uöt16_t
 
èg
);

403 
ldns_key_£t_Êags
(
ldns_key
 *
k
, 
uöt16_t
 
Êags
);

409 
ldns_key_li°_£t_key_cou¡
(
ldns_key_li°
 *
key
, 
size_t
 
cou¡
);

417 
boﬁ
 
ldns_key_li°_push_key
(
ldns_key_li°
 *
key_li°
, 
ldns_key
 *
key
);

424 
size_t
 
ldns_key_li°_key_cou¡
(c⁄° 
ldns_key_li°
 *
key_li°
);

432 
ldns_key
 *
ldns_key_li°_key
(c⁄° 
ldns_key_li°
 *
key
, 
size_t
 
ƒ
);

434 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


440 
RSA
 *
ldns_key_rß_key
(c⁄° 
ldns_key
 *
k
);

446 
EVP_PKEY
 *
ldns_key_evp_key
(c⁄° 
ldns_key
 *
k
);

452 #i‡
LDNS_BUILD_CONFIG_HAVE_SSL


453 
DSA
 *
ldns_key_dß_key
(c⁄° 
ldns_key
 *
k
);

461 
ldns_signög_Æg‹ôhm
 
ldns_key_Æg‹ôhm
(c⁄° 
ldns_key
 *
k
);

467 
ldns_key_£t_u£
(
ldns_key
 *
k
, 
boﬁ
 
v
);

473 
boﬁ
 
ldns_key_u£
(c⁄° 
ldns_key
 *
k
);

479 *
ldns_key_hmac_key
(c⁄° 
ldns_key
 *
k
);

485 *
ldns_key_exã∫Æ_key
(c⁄° 
ldns_key
 *
k
);

491 
size_t
 
ldns_key_hmac_size
(c⁄° 
ldns_key
 *
k
);

497 
uöt32_t
 
ldns_key_‹igâl
(c⁄° 
ldns_key
 *
k
);

503 
uöt32_t
 
ldns_key_ö˚±i⁄
(c⁄° 
ldns_key
 *
k
);

509 
uöt32_t
 
ldns_key_expú©i⁄
(c⁄° 
ldns_key
 *
k
);

515 
uöt16_t
 
ldns_key_keyèg
(c⁄° 
ldns_key
 *
k
);

521 
ldns_rdf
 *
ldns_key_pubkey_ow√r
(c⁄° 
ldns_key
 *
k
);

528 
ldns_key_li°_£t_u£
(
ldns_key_li°
 *
keys
, 
boﬁ
 
v
);

535 
uöt16_t
 
ldns_key_Êags
(c⁄° 
ldns_key
 *
k
);

542 
ldns_key
 *
ldns_key_li°_p›_key
(
ldns_key_li°
 *
key_li°
);

553 
ldns_º
 *
ldns_key2º
(c⁄° 
ldns_key
 *
k
);

561 
ldns_key_¥öt
(
FILE
 *
ouçut
, c⁄° 
ldns_key
 *
k
);

568 
ldns_key_‰ì
(
ldns_key
 *
key
);

576 
ldns_key_dìp_‰ì
(
ldns_key
 *
key
);

582 
ldns_key_li°_‰ì
(
ldns_key_li°
 *
key_li°
);

589 
ldns_º
 * 
ldns_ªad_™ch‹_fûe
(c⁄° *
fûíame
);

601 *
ldns_key_gë_fûe_ba£_«me
(
ldns_key
 *
key
);

608 
ldns_key_Ægo_suµ‹ãd
(
Ægo
);

615 
ldns_signög_Æg‹ôhm
 
ldns_gë_signög_Æg‹ôhm_by_«me
(c⁄° * 
«me
);

617 #ifde‡
__˝lu•lus


	@ldns/ldns.h

89 #i‚de‡
LDNS_DNS_H


90 
	#LDNS_DNS_H


	)

92 
	~<°dio.h
>

93 
	~<°dlib.h
>

95 
	~<ldns/utû.h
>

96 
	~<ldns/buf„r.h
>

97 
	~<ldns/comm⁄.h
>

98 
	~<ldns/d™e.h
>

99 
	~<ldns/d«me.h
>

100 
	~<ldns/dns£c.h
>

101 
	~<ldns/dns£c_vîify.h
>

102 
	~<ldns/dns£c_sign.h
>

103 
	~<ldns/duøti⁄.h
>

104 
	~<ldns/îr‹.h
>

105 
	~<ldns/highî.h
>

106 
	~<ldns/ho°2°r.h
>

107 
	~<ldns/ho°2wúe.h
>

108 
	~<ldns/√t.h
>

109 
	~<ldns/∑ckë.h
>

110 
	~<ldns/rd©a.h
>

111 
	~<ldns/ªsﬁvî.h
>

112 
	~<ldns/º.h
>

113 
	~<ldns/°r2ho°.h
>

114 
	~<ldns/tsig.h
>

115 
	~<ldns/upd©e.h
>

116 
	~<ldns/wúe2ho°.h
>

117 
	~<ldns/º_fun˘i⁄s.h
>

118 
	~<ldns/keys.h
>

119 
	~<ldns/∑r£.h
>

120 
	~<ldns/z⁄e.h
>

121 
	~<ldns/dns£c_z⁄e.h
>

122 
	~<ldns/ødix.h
>

123 
	~<ldns/rbåì.h
>

124 
	~<ldns/sha1.h
>

125 
	~<ldns/sha2.h
>

127 #ifde‡
__˝lu•lus


131 
	#LDNS_IP4ADDRLEN
 (32/8)

	)

132 
	#LDNS_IP6ADDRLEN
 (128/8)

	)

133 
	#LDNS_PORT
 53

	)

134 
	#LDNS_ROOT_LABEL_STR
 "."

	)

135 
	#LDNS_DEFAULT_TTL
 3600

	)

140 
ldns_lookup_èbÀ
 
ldns_˚πifiˇã_ty≥s
[];

142 
ldns_lookup_èbÀ
 
ldns_Æg‹ôhms
[];

144 
ldns_lookup_èbÀ
 
ldns_˚π_Æg‹ôhms
[];

146 
ldns_lookup_èbÀ
 
ldns_º_˛as£s
[];

148 
ldns_lookup_èbÀ
 
ldns_rcodes
[];

150 
ldns_lookup_èbÀ
 
ldns_›codes
[];

152 
ldns_lookup_èbÀ
 
ldns_edns_Êags
[];

154 #ifde‡
__˝lu•lus


	@ldns/net.h

13 #i‚de‡
LDNS_NET_H


14 
	#LDNS_NET_H


	)

16 
	~<ldns/ldns.h
>

17 
	~<sys/sockë.h
>

19 #ifde‡
__˝lu•lus


23 
	#LDNS_DEFAULT_TIMEOUT_SEC
 5

	)

24 
	#LDNS_DEFAULT_TIMEOUT_USEC
 0

	)

42 
ldns_°©us
 
ldns_udp_£nd
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
, 
size_t
 *
™swîsize
);

53 
ldns_udp_bg£nd
(
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
);

64 
ldns_t˝_bg£nd
(
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
);

77 
ldns_°©us
 
ldns_t˝_£nd
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
, 
size_t
 *
™swîsize
);

88 
ldns_°©us
 
ldns_£nd
(
ldns_pkt
 **
pkt
, 
ldns_ªsﬁvî
 *
r
, c⁄°Üdns_pkà*
quîy_pkt
);

100 
ldns_°©us
 
ldns_£nd_buf„r
(
ldns_pkt
 **
pkt
, 
ldns_ªsﬁvî
 *
r
, 
ldns_buf„r
 *
qb
, 
ldns_rdf
 *
tsig_mac
);

109 
ldns_t˝_c⁄√˘
(c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
, 
timevÆ
 
timeout
);

117 
ldns_udp_c⁄√˘
(c⁄° 
sockaddr_°‹age
 *
to
, 
timevÆ
 
timeout
);

128 
ssize_t
 
ldns_t˝_£nd_quîy
(
ldns_buf„r
 *
qbö
, 
sockfd
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
);

139 
ssize_t
 
ldns_udp_£nd_quîy
(
ldns_buf„r
 *
qbö
, 
sockfd
, c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
);

150 
uöt8_t
 *
ldns_t˝_ªad_wúe_timeout
(
sockfd
, 
size_t
 *
size
, 
timevÆ
 
timeout
);

161 
uöt8_t
 *
ldns_t˝_ªad_wúe
(
sockfd
, 
size_t
 *
size
);

173 
uöt8_t
 *
ldns_udp_ªad_wúe
(
sockfd
, 
size_t
 *
size
, 
sockaddr_°‹age
 *
‰
, 
sockÀn_t
 *
‰Àn
);

183 
sockaddr_°‹age
 * 
ldns_rdf2«tive_sockaddr_°‹age
(c⁄° 
ldns_rdf
 *
rd
, 
uöt16_t
 
p‹t
, 
size_t
 *
size
);

191 
ldns_rdf
 * 
ldns_sockaddr_°‹age2rdf
(
sockaddr_°‹age
 *
sock
, 
uöt16_t
 *
p‹t
);

201 
ldns_°©us
 
ldns_ax‰_°¨t
(
ldns_ªsﬁvî
 *
ªsﬁvî
, 
ldns_rdf
 *
domaö
, 
ldns_º_˛ass
 
c
);

203 #ifde‡
__˝lu•lus


	@ldns/packet.h

21 #i‚de‡
LDNS_PACKET_H


22 
	#LDNS_PACKET_H


	)

24 
	#LDNS_MAX_PACKETLEN
 65535

	)

27 
	#LDNS_QR
 1

	)

28 
	#LDNS_AA
 2

	)

29 
	#LDNS_TC
 4

	)

30 
	#LDNS_RD
 8

	)

31 
	#LDNS_CD
 16

	)

32 
	#LDNS_RA
 32

	)

33 
	#LDNS_AD
 64

	)

35 
	~<ldns/îr‹.h
>

36 
	~<ldns/comm⁄.h
>

37 
	~<ldns/º.h
>

38 
	~<sys/time.h
>

40 #ifde‡
__˝lu•lus


45 
	eldns_íum_pkt_›code
 {

46 
LDNS_PACKET_QUERY
 = 0,

47 
LDNS_PACKET_IQUERY
 = 1,

48 
LDNS_PACKET_STATUS
 = 2,

49 
LDNS_PACKET_NOTIFY
 = 4,

50 
LDNS_PACKET_UPDATE
 = 5

52 
ldns_íum_pkt_›code
 
	tldns_pkt_›code
;

55 
	eldns_íum_pkt_rcode
 {

56 
LDNS_RCODE_NOERROR
 = 0,

57 
LDNS_RCODE_FORMERR
 = 1,

58 
LDNS_RCODE_SERVFAIL
 = 2,

59 
LDNS_RCODE_NXDOMAIN
 = 3,

60 
LDNS_RCODE_NOTIMPL
 = 4,

61 
LDNS_RCODE_REFUSED
 = 5,

62 
LDNS_RCODE_YXDOMAIN
 = 6,

63 
LDNS_RCODE_YXRRSET
 = 7,

64 
LDNS_RCODE_NXRRSET
 = 8,

65 
LDNS_RCODE_NOTAUTH
 = 9,

66 
LDNS_RCODE_NOTZONE
 = 10

68 
ldns_íum_pkt_rcode
 
	tldns_pkt_rcode
;

192 
	sldns_°ru˘_hdr


195 
uöt16_t
 
_id
;

197 
boﬁ
 
_qr
;

199 
boﬁ
 
_Ø
;

201 
boﬁ
 
_tc
;

203 
boﬁ
 
_rd
;

205 
boﬁ
 
_cd
;

207 
boﬁ
 
_ø
;

209 
boﬁ
 
_ad
;

211 
ldns_pkt_›code
 
_›code
;

213 
uöt8_t
 
_rcode
;

215 
uöt16_t
 
_qdcou¡
;

217 
uöt16_t
 
_™cou¡
;

219 
uöt16_t
 
_nscou¡
;

221 
uöt16_t
 
_¨cou¡
;

223 
ldns_°ru˘_hdr
 
	tldns_hdr
;

233 
	sldns_°ru˘_pkt


236 
ldns_hdr
 *
_hódî
;

239 
ldns_rdf
 *
_™swî‰om
;

241 
timevÆ
 
time°amp
;

243 
uöt32_t
 
_quîytime
;

245 
size_t
 
_size
;

247 
ldns_º
 *
_tsig_º
;

249 
uöt16_t
 
_edns_udp_size
;

251 
uöt8_t
 
_edns_exãnded_rcode
;

253 
uöt8_t
 
_edns_vîsi⁄
;

255 
uöt16_t
 
_edns_z
;

257 
ldns_rdf
 *
_edns_d©a
;

259 
ldns_º_li°
 *
_que°i⁄
;

261 
ldns_º_li°
 *
_™swî
;

263 
ldns_º_li°
 *
_auth‹ôy
;

265 
ldns_º_li°
 *
_addôi⁄Æ
;

267 
ldns_°ru˘_pkt
 
	tldns_pkt
;

272 
	eldns_íum_pkt_£˘i⁄
 {

273 
LDNS_SECTION_QUESTION
 = 0,

274 
LDNS_SECTION_ANSWER
 = 1,

275 
LDNS_SECTION_AUTHORITY
 = 2,

276 
LDNS_SECTION_ADDITIONAL
 = 3,

278 
LDNS_SECTION_ANY
 = 4,

280 
LDNS_SECTION_ANY_NOQUESTION
 = 5

282 
ldns_íum_pkt_£˘i⁄
 
	tldns_pkt_£˘i⁄
;

287 
	eldns_íum_pkt_ty≥
 {

288 
LDNS_PACKET_QUESTION
,

289 
LDNS_PACKET_REFERRAL
,

290 
LDNS_PACKET_ANSWER
,

291 
LDNS_PACKET_NXDOMAIN
,

292 
LDNS_PACKET_NODATA
,

293 
LDNS_PACKET_UNKNOWN


295 
ldns_íum_pkt_ty≥
 
	tldns_pkt_ty≥
;

306 
uöt16_t
 
ldns_pkt_id
(c⁄° 
ldns_pkt
 *
p
);

312 
boﬁ
 
ldns_pkt_qr
(c⁄° 
ldns_pkt
 *
p
);

318 
boﬁ
 
ldns_pkt_Ø
(c⁄° 
ldns_pkt
 *
p
);

324 
boﬁ
 
ldns_pkt_tc
(c⁄° 
ldns_pkt
 *
p
);

330 
boﬁ
 
ldns_pkt_rd
(c⁄° 
ldns_pkt
 *
p
);

336 
boﬁ
 
ldns_pkt_cd
(c⁄° 
ldns_pkt
 *
p
);

342 
boﬁ
 
ldns_pkt_ø
(c⁄° 
ldns_pkt
 *
p
);

348 
boﬁ
 
ldns_pkt_ad
(c⁄° 
ldns_pkt
 *
p
);

354 
ldns_pkt_›code
 
ldns_pkt_gë_›code
(c⁄° 
ldns_pkt
 *
p
);

360 
ldns_pkt_rcode
 
ldns_pkt_gë_rcode
(c⁄° 
ldns_pkt
 *
p
);

366 
uöt16_t
 
ldns_pkt_qdcou¡
(c⁄° 
ldns_pkt
 *
p
);

372 
uöt16_t
 
ldns_pkt_™cou¡
(c⁄° 
ldns_pkt
 *
p
);

378 
uöt16_t
 
ldns_pkt_nscou¡
(c⁄° 
ldns_pkt
 *
p
);

384 
uöt16_t
 
ldns_pkt_¨cou¡
(c⁄° 
ldns_pkt
 *
p
);

391 
ldns_rdf
 *
ldns_pkt_™swî‰om
(c⁄° 
ldns_pkt
 *
p
);

398 
timevÆ
 
ldns_pkt_time°amp
(c⁄° 
ldns_pkt
 *
p
);

404 
uöt32_t
 
ldns_pkt_quîytime
(c⁄° 
ldns_pkt
 *
p
);

411 
size_t
 
ldns_pkt_size
(c⁄° 
ldns_pkt
 *
p
);

422 
uöt16_t
 
ldns_pkt_£˘i⁄_cou¡
(c⁄° 
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
);

429 
ldns_º
 *
ldns_pkt_tsig
(c⁄° 
ldns_pkt
 *
p
);

436 
ldns_º_li°
 *
ldns_pkt_que°i⁄
(c⁄° 
ldns_pkt
 *
p
);

442 
ldns_º_li°
 *
ldns_pkt_™swî
(c⁄° 
ldns_pkt
 *
p
);

448 
ldns_º_li°
 *
ldns_pkt_auth‹ôy
(c⁄° 
ldns_pkt
 *
p
);

454 
ldns_º_li°
 *
ldns_pkt_addôi⁄Æ
(c⁄° 
ldns_pkt
 *
p
);

461 
ldns_º_li°
 *
ldns_pkt_Æl
(c⁄° 
ldns_pkt
 *
p
);

468 
ldns_º_li°
 *
ldns_pkt_Æl_noque°i⁄
(c⁄° 
ldns_pkt
 *
p
);

477 
ldns_º_li°
 *
ldns_pkt_gë_£˘i⁄_˛⁄e
(c⁄° 
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
);

487 
ldns_º_li°
 *
ldns_pkt_º_li°_by_«me
(
ldns_pkt
 *
p
, 
ldns_rdf
 *
r
, 
ldns_pkt_£˘i⁄
 
s
);

496 
ldns_º_li°
 *
ldns_pkt_º_li°_by_ty≥
(c⁄° 
ldns_pkt
 *
p
, 
ldns_º_ty≥
 
t
, 
ldns_pkt_£˘i⁄
 
s
);

506 
ldns_º_li°
 *
ldns_pkt_º_li°_by_«me_™d_ty≥
(c⁄° 
ldns_pkt
 *
∑ckë
, c⁄° 
ldns_rdf
 *
ow√∫ame
, 
ldns_º_ty≥
 
ty≥
, 
ldns_pkt_£˘i⁄
 
£c
);

515 
boﬁ
 
ldns_pkt_º
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º
 *
º
);

524 
boﬁ
 
ldns_pkt_£t_Êags
(
ldns_pkt
 *
pkt
, 
uöt16_t
 
Êags
);

531 
ldns_pkt_£t_id
(
ldns_pkt
 *
p
, 
uöt16_t
 
id
);

536 
ldns_pkt_£t_øndom_id
(
ldns_pkt
 *
p
);

542 
ldns_pkt_£t_qr
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

548 
ldns_pkt_£t_Ø
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

554 
ldns_pkt_£t_tc
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

560 
ldns_pkt_£t_rd
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

566 
ldns_pkt_£t_cd
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

572 
ldns_pkt_£t_ø
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

578 
ldns_pkt_£t_ad
(
ldns_pkt
 *
p
, 
boﬁ
 
b
);

585 
ldns_pkt_£t_›code
(
ldns_pkt
 *
p
, 
ldns_pkt_›code
 
c
);

591 
ldns_pkt_£t_rcode
(
ldns_pkt
 *
p
, 
uöt8_t
 
c
);

597 
ldns_pkt_£t_qdcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

603 
ldns_pkt_£t_™cou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

609 
ldns_pkt_£t_nscou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

615 
ldns_pkt_£t_¨cou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

621 
ldns_pkt_£t_™swî‰om
(
ldns_pkt
 *
p
, 
ldns_rdf
 *
r
);

627 
ldns_pkt_£t_quîytime
(
ldns_pkt
 *
p
, 
uöt32_t
 
t
);

633 
ldns_pkt_£t_size
(
ldns_pkt
 *
p
, 
size_t
 
s
);

640 
ldns_pkt_£t_time°amp
(
ldns_pkt
 *
p
, 
timevÆ
Åimeval);

647 
ldns_pkt_£t_£˘i⁄_cou¡
(
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
, 
uöt16_t
 
x
);

653 
ldns_pkt_£t_tsig
(
ldns_pkt
 *
p
, 
ldns_º
 *
t
);

661 
ldns_pkt_ty≥
 
ldns_pkt_ª∂y_ty≥
(
ldns_pkt
 *
p
);

668 
uöt16_t
 
ldns_pkt_edns_udp_size
(c⁄° 
ldns_pkt
 *
∑ckë
);

674 
uöt8_t
 
ldns_pkt_edns_exãnded_rcode
(c⁄° 
ldns_pkt
 *
∑ckë
);

680 
uöt8_t
 
ldns_pkt_edns_vîsi⁄
(c⁄° 
ldns_pkt
 *
∑ckë
);

686 
uöt16_t
 
ldns_pkt_edns_z
(c⁄° 
ldns_pkt
 *
∑ckë
);

692 
ldns_rdf
 *
ldns_pkt_edns_d©a
(c⁄° 
ldns_pkt
 *
∑ckë
);

699 
boﬁ
 
ldns_pkt_edns_do
(c⁄° 
ldns_pkt
 *
∑ckë
);

705 
ldns_pkt_£t_edns_do
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
vÆue
);

716 
boﬁ
 
ldns_pkt_edns
(c⁄° 
ldns_pkt
 *
∑ckë
);

723 
ldns_pkt_£t_edns_udp_size
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
s
);

729 
ldns_pkt_£t_edns_exãnded_rcode
(
ldns_pkt
 *
∑ckë
, 
uöt8_t
 
c
);

735 
ldns_pkt_£t_edns_vîsi⁄
(
ldns_pkt
 *
∑ckë
, 
uöt8_t
 
v
);

741 
ldns_pkt_£t_edns_z
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
z
);

747 
ldns_pkt_£t_edns_d©a
(
ldns_pkt
 *
∑ckë
, 
ldns_rdf
 *
d©a
);

753 
ldns_pkt
 *
ldns_pkt_√w
();

760 
ldns_pkt_‰ì
(
ldns_pkt
 *
∑ckë
);

771 
ldns_°©us
 
ldns_pkt_quîy_√w_‰m_°r
(
ldns_pkt
 **
p
, c⁄° *
º_«me
, 
ldns_º_ty≥
 
º_ty≥
, 
ldns_º_˛ass
 
º_˛ass
 , 
uöt16_t
 
Êags
);

783 
ldns_°©us
 
ldns_pkt_ix‰_ªque°_√w_‰m_°r
(
ldns_pkt
 **
p
, c⁄° *
º_«me
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
, 
ldns_º
* 
sﬂ
);

793 
ldns_pkt
 *
ldns_pkt_quîy_√w
(
ldns_rdf
 *
º_«me
, 
ldns_º_ty≥
 
º_ty≥
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
);

804 
ldns_pkt
 *
ldns_pkt_ix‰_ªque°_√w
(
ldns_rdf
 *
º_«me
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
, 
ldns_º
* 
sﬂ
);

812 
ldns_pkt
 *
ldns_pkt_˛⁄e
÷dns_pkà*
pkt
);

819 
ldns_pkt_£t_addôi⁄Æ
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

826 
ldns_pkt_£t_™swî
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

833 
ldns_pkt_£t_que°i⁄
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

840 
ldns_pkt_£t_auth‹ôy
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
);

849 
boﬁ
 
ldns_pkt_push_º
(
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
, 
ldns_º
 *
º
);

858 
boﬁ
 
ldns_pkt_ß„_push_º
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º
 *
º
);

867 
boﬁ
 
ldns_pkt_push_º_li°
(
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
, 
ldns_º_li°
 *
li°
);

876 
boﬁ
 
ldns_pkt_ß„_push_º_li°
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º_li°
 *
li°
);

883 
boﬁ
 
ldns_pkt_em±y
(
ldns_pkt
 *
p
);

885 #ifde‡
__˝lu•lus


	@ldns/parse.h

10 #i‚de‡
LDNS_PARSE_H


11 
	#LDNS_PARSE_H


	)

13 
	~<ldns/comm⁄.h
>

14 
	~<ldns/buf„r.h
>

16 #ifde‡
__˝lu•lus


20 
	#LDNS_PARSE_SKIP_SPACE
 "\f\n\r\v"

	)

21 
	#LDNS_PARSE_NORMAL
 " \f\n\r\t\v"

	)

22 
	#LDNS_PARSE_NO_NL
 " \t"

	)

23 
	#LDNS_MAX_LINELEN
 10230

	)

24 
	#LDNS_MAX_KEYWORDLEN
 32

	)

39 
	eldns_íum_dúe˘ive


41 
LDNS_DIR_TTL
,

42 
LDNS_DIR_ORIGIN
,

43 
LDNS_DIR_INCLUDE


45 
ldns_íum_dúe˘ive
 
	tldns_dúe˘ive
;

57 
ssize_t
 
ldns_fgë_tokí
(
FILE
 *
f
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
);

70 
ssize_t
 
ldns_fgë_tokí_l
(
FILE
 *
f
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
, *
löe_ƒ
);

82 
ssize_t
 
ldns_bgë_tokí
(
ldns_buf„r
 *
b
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
);

95 
ssize_t
 
ldns_fgë_keyw‹d_d©a
(
FILE
 *
f
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
, c⁄° *
d_dñ
, 
size_t
 
d©a_limô
);

110 
ssize_t
 
ldns_fgë_keyw‹d_d©a_l
(
FILE
 *
f
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
, c⁄° *
d_dñ
, 
size_t
 
d©a_limô
, *
löe_ƒ
);

123 
ssize_t
 
ldns_bgë_keyw‹d_d©a
(
ldns_buf„r
 *
b
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
, c⁄° *
d_dñ
, 
size_t
 
d©a_limô
);

132 
ldns_bgëc
(
ldns_buf„r
 *
buf„r
);

141 
ldns_bskùcs
(
ldns_buf„r
 *
buf„r
, c⁄° *
s
);

150 
ldns_fskùcs
(
FILE
 *
Â
, c⁄° *
s
);

161 
ldns_fskùcs_l
(
FILE
 *
Â
, c⁄° *
s
, *
löe_ƒ
);

163 #ifde‡
__˝lu•lus


	@ldns/radix.h

43 #i‚de‡
LDNS_RADIX_H_


44 
	#LDNS_RADIX_H_


	)

46 
	~<ldns/îr‹.h
>

48 #ifde‡
__˝lu•lus


52 
uöt16_t
 
	tødix_°æí_t
;

53 
ldns_ødix_¨øy_t
 
	tldns_ødix_¨øy_t
;

54 
ldns_ødix_node_t
 
	tldns_ødix_node_t
;

55 
ldns_ødix_t
 
	tldns_ødix_t
;

58 
	sldns_ødix_¨øy_t
 {

60 
uöt8_t
* 
°r
;

62 
ødix_°æí_t
 
Àn
;

64 
ldns_ødix_node_t
* 
edge
;

68 
	sldns_ødix_node_t
 {

70 
uöt8_t
* 
key
;

72 
ødix_°æí_t
 
kÀn
;

74 * 
d©a
;

76 
ldns_ødix_node_t
* 
∑ª¡
;

78 
uöt8_t
 
∑ª¡_ödex
;

80 
uöt16_t
 
Àn
;

82 
uöt16_t
 
off£t
;

84 
uöt16_t
 
ˇ∑côy
;

86 
ldns_ødix_¨øy_t
* 
¨øy
;

90 
	sldns_ødix_t
 {

92 
ldns_ødix_node_t
* 
roŸ
;

94 
size_t
 
cou¡
;

102 
ldns_ødix_t
* 
ldns_ødix_¸óã
();

109 
ldns_ødix_öô
(
ldns_ødix_t
* 
åì
);

116 
ldns_ødix_‰ì
(
ldns_ødix_t
* 
åì
);

127 
ldns_°©us
 
ldns_ødix_ö£π
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

128 
ødix_°æí_t
 
Àn
, * 
d©a
);

138 * 
ldns_ødix_dñëe
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
, 
ødix_°æí_t
 
Àn
);

148 
ldns_ødix_node_t
* 
ldns_ødix_£¨ch
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

149 
ødix_°æí_t
 
Àn
);

162 
ldns_ødix_föd_Àss_equÆ
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

163 
ødix_°æí_t
 
Àn
, 
ldns_ødix_node_t
** 
ªsu…
);

171 
ldns_ødix_node_t
* 
ldns_ødix_fú°
(
ldns_ødix_t
* 
åì
);

179 
ldns_ødix_node_t
* 
ldns_ødix_œ°
(
ldns_ødix_t
* 
åì
);

187 
ldns_ødix_node_t
* 
ldns_ødix_√xt
÷dns_ødix_node_t* 
node
);

195 
ldns_ødix_node_t
* 
ldns_ødix_¥ev
÷dns_ødix_node_t* 
node
);

205 
ldns_°©us
 
ldns_ødix_•lô
(
ldns_ødix_t
* 
åì1
, 
size_t
 
num
,

206 
ldns_ødix_t
** 
åì2
);

215 
ldns_°©us
 
ldns_ødix_joö
(
ldns_ødix_t
* 
åì1
,Üdns_ødix_t* 
åì2
);

225 
ldns_ødix_åavî£_po°‹dî
(
ldns_ødix_node_t
* 
node
,

226 (*
func
)(
ldns_ødix_node_t
*, *), * 
¨g
);

234 
ldns_ødix_¥ötf
(
FILE
* 
fd
, 
ldns_ødix_t
* 
åì
);

236 #ifde‡
__˝lu•lus


	@ldns/rbtree.h

43 #i‚de‡
LDNS_RBTREE_H_


44 
	#LDNS_RBTREE_H_


	)

46 #ifde‡
__˝lu•lus


56 
ldns_rbnode_t
 
	tldns_rbnode_t
;

60 
	sldns_rbnode_t
 {

62 
ldns_rbnode_t
 *
∑ª¡
;

64 
ldns_rbnode_t
 *
À·
;

66 
ldns_rbnode_t
 *
right
;

68 c⁄° *
key
;

70 c⁄° *
d©a
;

72 
uöt8_t
 
cﬁ‹
;

76 
	#LDNS_RBTREE_NULL
 &
ldns_rbåì_nuŒ_node


	)

78 
ldns_rbnode_t
 
ldns_rbåì_nuŒ_node
;

81 
ldns_rbåì_t
 
	tldns_rbåì_t
;

83 
	sldns_rbåì_t
 {

85 
ldns_rbnode_t
 *
	groŸ
;

88 
size_t
 
	gcou¡
;

94 (*
	gcmp
) (const *, const *);

102 
ldns_rbåì_t
 *
ldns_rbåì_¸óã
((*
cmpf
)(const *, const *));

108 
ldns_rbåì_‰ì
(
ldns_rbåì_t
 *
rbåì
);

115 
ldns_rbåì_öô
(
ldns_rbåì_t
 *
rbåì
, (*
cmpf
)(const *, const *));

123 
ldns_rbnode_t
 *
ldns_rbåì_ö£π
(
ldns_rbåì_t
 *
rbåì
,Üdns_rbnode_à*
d©a
);

131 
ldns_rbåì_ö£π_vªf
(
ldns_rbnode_t
 *
d©a
, *
rbåì
);

140 
ldns_rbnode_t
 *
ldns_rbåì_dñëe
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
);

148 
ldns_rbnode_t
 *
ldns_rbåì_£¨ch
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
);

159 
ldns_rbåì_föd_Àss_equÆ
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
,

160 
ldns_rbnode_t
 **
ªsu…
);

167 
ldns_rbnode_t
 *
ldns_rbåì_fú°
(
ldns_rbåì_t
 *
rbåì
);

174 
ldns_rbnode_t
 *
ldns_rbåì_œ°
(
ldns_rbåì_t
 *
rbåì
);

181 
ldns_rbnode_t
 *
ldns_rbåì_√xt
÷dns_rbnode_à*
rbåì
);

188 
ldns_rbnode_t
 *
ldns_rbåì_¥evious
÷dns_rbnode_à*
rbåì
);

195 
ldns_rbåì_t
 *
ldns_rbåì_•lô
÷dns_rbåì_à*
åì
, 
size_t
 
ñemíts
);

201 
ldns_rbåì_joö
(
ldns_rbåì_t
 *
åì1
,Üdns_rbåì_à*
åì2
);

207 
	#LDNS_RBTREE_FOR
(
node
, 
ty≥
, 
rbåì
) \

208 
node
=(
ty≥
)
	`ldns_rbåì_fú°
(
rbåì
); \

209 (
ldns_rbnode_t
*)
node
 !
LDNS_RBTREE_NULL
; \

210 
node
 = (
ty≥
)
	`ldns_rbåì_√xt
((
ldns_rbnode_t
*Íode))

	)

223 
ldns_åavî£_po°‹dî
(
ldns_rbåì_t
* 
åì
,

224 (*
func
)(
ldns_rbnode_t
*, *), * 
¨g
);

226 #ifde‡
__˝lu•lus


	@ldns/rdata.h

21 #i‚de‡
LDNS_RDATA_H


22 
	#LDNS_RDATA_H


	)

24 
	~<ldns/comm⁄.h
>

25 
	~<ldns/îr‹.h
>

27 #ifde‡
__˝lu•lus


31 
	#LDNS_MAX_RDFLEN
 65535

	)

33 
	#LDNS_RDF_SIZE_BYTE
 1

	)

34 
	#LDNS_RDF_SIZE_WORD
 2

	)

35 
	#LDNS_RDF_SIZE_DOUBLEWORD
 4

	)

36 
	#LDNS_RDF_SIZE_6BYTES
 6

	)

37 
	#LDNS_RDF_SIZE_8BYTES
 8

	)

38 
	#LDNS_RDF_SIZE_16BYTES
 16

	)

40 
	#LDNS_NSEC3_VARS_OPTOUT_MASK
 0x01

	)

45 
	eldns_íum_rdf_ty≥


48 
LDNS_RDF_TYPE_NONE
,

50 
LDNS_RDF_TYPE_DNAME
,

52 
LDNS_RDF_TYPE_INT8
,

54 
LDNS_RDF_TYPE_INT16
,

56 
LDNS_RDF_TYPE_INT32
,

58 
LDNS_RDF_TYPE_A
,

60 
LDNS_RDF_TYPE_AAAA
,

62 
LDNS_RDF_TYPE_STR
,

64 
LDNS_RDF_TYPE_APL
,

66 
LDNS_RDF_TYPE_B32_EXT
,

68 
LDNS_RDF_TYPE_B64
,

70 
LDNS_RDF_TYPE_HEX
,

72 
LDNS_RDF_TYPE_NSEC
,

74 
LDNS_RDF_TYPE_TYPE
,

76 
LDNS_RDF_TYPE_CLASS
,

78 
LDNS_RDF_TYPE_CERT_ALG
,

80 
LDNS_RDF_TYPE_ALG
,

82 
LDNS_RDF_TYPE_UNKNOWN
,

84 
LDNS_RDF_TYPE_TIME
,

86 
LDNS_RDF_TYPE_PERIOD
,

88 
LDNS_RDF_TYPE_TSIGTIME
,

92 
LDNS_RDF_TYPE_HIP
,

95 
LDNS_RDF_TYPE_INT16_DATA
,

97 
LDNS_RDF_TYPE_SERVICE
,

99 
LDNS_RDF_TYPE_LOC
,

101 
LDNS_RDF_TYPE_WKS
,

103 
LDNS_RDF_TYPE_NSAP
,

105 
LDNS_RDF_TYPE_ATMA
,

107 
LDNS_RDF_TYPE_IPSECKEY
,

109 
LDNS_RDF_TYPE_NSEC3_SALT
,

111 
LDNS_RDF_TYPE_NSEC3_NEXT_OWNER
,

116 
LDNS_RDF_TYPE_ILNP64
,

119 
LDNS_RDF_TYPE_EUI48
,

121 
LDNS_RDF_TYPE_EUI64
,

126 
LDNS_RDF_TYPE_TAG
,

132 
LDNS_RDF_TYPE_LONG_STR
,

135 
LDNS_RDF_TYPE_BITMAP
 = 
LDNS_RDF_TYPE_NSEC


137 
ldns_íum_rdf_ty≥
 
	tldns_rdf_ty≥
;

142 
	eldns_íum_˚π_Æg‹ôhm


144 
LDNS_CERT_PKIX
 = 1,

145 
LDNS_CERT_SPKI
 = 2,

146 
LDNS_CERT_PGP
 = 3,

147 
LDNS_CERT_IPKIX
 = 4,

148 
LDNS_CERT_ISPKI
 = 5,

149 
LDNS_CERT_IPGP
 = 6,

150 
LDNS_CERT_ACPKIX
 = 7,

151 
LDNS_CERT_IACPKIX
 = 8,

152 
LDNS_CERT_URI
 = 253,

153 
LDNS_CERT_OID
 = 254

155 
ldns_íum_˚π_Æg‹ôhm
 
	tldns_˚π_Æg‹ôhm
;

166 
	sldns_°ru˘_rdf


169 
size_t
 
_size
;

171 
ldns_rdf_ty≥
 
_ty≥
;

173 *
_d©a
;

175 
ldns_°ru˘_rdf
 
	tldns_rdf
;

187 
ldns_rdf_£t_size
(
ldns_rdf
 *
rd
, 
size_t
 
size
);

195 
ldns_rdf_£t_ty≥
(
ldns_rdf
 *
rd
, 
ldns_rdf_ty≥
 
ty≥
);

203 
ldns_rdf_£t_d©a
(
ldns_rdf
 *
rd
, *
d©a
);

212 
size_t
 
ldns_rdf_size
(c⁄° 
ldns_rdf
 *
rd
);

220 
ldns_rdf_ty≥
 
ldns_rdf_gë_ty≥
(c⁄° 
ldns_rdf
 *
rd
);

228 
uöt8_t
 *
ldns_rdf_d©a
(c⁄° 
ldns_rdf
 *
rd
);

241 
ldns_rdf
 *
ldns_rdf_√w
(
ldns_rdf_ty≥
 
ty≥
, 
size_t
 
size
, *
d©a
);

252 
ldns_rdf
 *
ldns_rdf_√w_‰m_d©a
(
ldns_rdf_ty≥
 
ty≥
, 
size_t
 
size
, c⁄° *
d©a
);

260 
ldns_rdf
 *
ldns_rdf_√w_‰m_°r
(
ldns_rdf_ty≥
 
ty≥
, c⁄° *
°r
);

269 
ldns_°©us
 
ldns_rdf_√w_‰m_Â
(
ldns_rdf
 **
r
, 
ldns_rdf_ty≥
 
ty≥
, 
FILE
 *
Â
);

279 
ldns_°©us
 
ldns_rdf_√w_‰m_Â_l
(
ldns_rdf
 **
r
, 
ldns_rdf_ty≥
 
ty≥
, 
FILE
 *
Â
, *
löe_ƒ
);

289 
ldns_rdf_‰ì
(
ldns_rdf
 *
rd
);

297 
ldns_rdf_dìp_‰ì
(
ldns_rdf
 *
rd
);

307 
ldns_rdf
 *
ldns_«tive2rdf_öt8
(
ldns_rdf_ty≥
 
ty≥
, 
uöt8_t
 
vÆue
);

315 
ldns_rdf
 *
ldns_«tive2rdf_öt16
(
ldns_rdf_ty≥
 
ty≥
, 
uöt16_t
 
vÆue
);

326 
ldns_rdf
 *
ldns_«tive2rdf_öt32
(
ldns_rdf_ty≥
 
ty≥
, 
uöt32_t
 
vÆue
);

338 
ldns_rdf
 *
ldns_«tive2rdf_öt16_d©a
(
size_t
 
size
, 
uöt8_t
 *
d©a
);

346 
ldns_rdf
 *
ldns_rdf_addªss_ªvî£
÷dns_rd‡*
rd
);

353 
uöt8_t
 
ldns_rdf2«tive_öt8
(c⁄° 
ldns_rdf
 *
rd
);

360 
uöt16_t
 
ldns_rdf2«tive_öt16
(c⁄° 
ldns_rdf
 *
rd
);

367 
uöt32_t
 
ldns_rdf2«tive_öt32
(c⁄° 
ldns_rdf
 *
rd
);

374 
time_t
 
ldns_rdf2«tive_time_t
(c⁄° 
ldns_rdf
 *
rd
);

382 
uöt32_t
 
ldns_°r2≥riod
(c⁄° *
≈å
, c⁄° **
íd±r
);

391 
ldns_°©us
 
ldns_o˘ë
(*
w‹d
, 
size_t
 *
Àngth
);

398 
ldns_rdf
 *
ldns_rdf_˛⁄e
(c⁄°Üdns_rd‡*
rd
);

409 
ldns_rdf_com∑ª
(c⁄° 
ldns_rdf
 *
rd1
, c⁄°Üdns_rd‡*
rd2
);

422 
ldns_°©us
 
ldns_rdf_hù_gë_Æg_hô_pk
(
ldns_rdf
 *
rdf
, 
uöt8_t
* 
Æg
,

423 
uöt8_t
 *
hô_size
, uöt8_t** 
hô
,

424 
uöt16_t
 *
pk_size
, 
uöt8_t
** 
pk
);

436 
ldns_°©us
 
ldns_rdf_hù_√w_‰m_Æg_hô_pk
(
ldns_rdf
** 
rdf
, 
uöt8_t
 
Æg
,

437 
uöt8_t
 
hô_size
, uöt8_à*
hô
, 
uöt16_t
 
pk_size
, uöt8_à*
pk
);

439 #ifde‡
__˝lu•lus


	@ldns/resolver.h

20 #i‚de‡
LDNS_RESOLVER_H


21 
	#LDNS_RESOLVER_H


	)

23 
	~<ldns/îr‹.h
>

24 
	~<ldns/comm⁄.h
>

25 
	~<ldns/º.h
>

26 
	~<ldns/tsig.h
>

27 
	~<ldns/rd©a.h
>

28 
	~<ldns/∑ckë.h
>

29 
	~<sys/time.h
>

31 #ifde‡
__˝lu•lus


36 
	#LDNS_RESOLV_CONF
 "/ëc/ªsﬁv.c⁄f"

	)

38 
	#LDNS_RESOLV_HOSTS
 "/ëc/ho°s"

	)

40 
	#LDNS_RESOLV_KEYWORD
 -1

	)

41 
	#LDNS_RESOLV_DEFDOMAIN
 0

	)

42 
	#LDNS_RESOLV_NAMESERVER
 1

	)

43 
	#LDNS_RESOLV_SEARCH
 2

	)

44 
	#LDNS_RESOLV_SORTLIST
 3

	)

45 
	#LDNS_RESOLV_OPTIONS
 4

	)

46 
	#LDNS_RESOLV_ANCHOR
 5

	)

47 
	#LDNS_RESOLV_KEYWORDS
 6

	)

49 
	#LDNS_RESOLV_INETANY
 0

	)

50 
	#LDNS_RESOLV_INET
 1

	)

51 
	#LDNS_RESOLV_INET6
 2

	)

53 
	#LDNS_RESOLV_RTT_INF
 0

	)

54 
	#LDNS_RESOLV_RTT_MIN
 1

	)

59 
	sldns_°ru˘_ªsﬁvî


62 
uöt16_t
 
_p‹t
;

65 
ldns_rdf
 **
_«me£rvîs
;

67 
size_t
 
_«me£rvî_cou¡
;

70 
size_t
 *
_πt
;

73 
boﬁ
 
_ªcursive
;

76 
boﬁ
 
_debug
;

79 
ldns_rdf
 *
_domaö
;

82 
ldns_rdf
 **
_£¨chli°
;

85 
size_t
 
_£¨chli°_cou¡
;

88 
uöt8_t
 
_ªåy
;

90 
uöt8_t
 
_ªå™s
;

92 
boﬁ
 
_ÁŒback
;

95 
boﬁ
 
_dns£c
;

97 
boﬁ
 
_dns£c_cd
;

99 
ldns_º_li°
 * 
_dns£c_™ch‹s
;

101 
boﬁ
 
_u£vc
;

103 
boﬁ
 
_ig¡c
;

105 
uöt8_t
 
_ù6
;

107 
boﬁ
 
_de‚ames
;

109 
boﬁ
 
_dn§ch
;

111 
timevÆ
 
_timeout
;

113 
boﬁ
 
_Áû
;

115 
boﬁ
 
_øndom
;

117 
_sockë
;

121 
_ax‰_sﬂ_cou¡
;

126 
ldns_pkt
 *
_cur_ax‰_pkt
;

128 
uöt16_t
 
_ax‰_i
;

130 
uöt16_t
 
_edns_udp_size
;

136 *
_tsig_key«me
;

138 *
_tsig_keyd©a
;

140 *
_tsig_Æg‹ôhm
;

143 
ldns_rdf
 *
_sour˚
;

145 
ldns_°ru˘_ªsﬁvî
 
	tldns_ªsﬁvî
;

155 
uöt16_t
 
ldns_ªsﬁvî_p‹t
(c⁄° 
ldns_ªsﬁvî
 *
r
);

162 
ldns_rdf
 *
ldns_ªsﬁvî_sour˚
(c⁄° 
ldns_ªsﬁvî
 *
r
);

169 
boﬁ
 
ldns_ªsﬁvî_ªcursive
(c⁄° 
ldns_ªsﬁvî
 *
r
);

176 
boﬁ
 
ldns_ªsﬁvî_debug
(c⁄° 
ldns_ªsﬁvî
 *
r
);

183 
uöt8_t
 
ldns_ªsﬁvî_ªåy
(c⁄° 
ldns_ªsﬁvî
 *
r
);

190 
uöt8_t
 
ldns_ªsﬁvî_ªå™s
(c⁄° 
ldns_ªsﬁvî
 *
r
);

197 
boﬁ
 
ldns_ªsﬁvî_ÁŒback
(c⁄° 
ldns_ªsﬁvî
 *
r
);

204 
uöt8_t
 
ldns_ªsﬁvî_ù6
(c⁄° 
ldns_ªsﬁvî
 *
r
);

211 
uöt16_t
 
ldns_ªsﬁvî_edns_udp_size
(c⁄° 
ldns_ªsﬁvî
 *
r
);

217 
boﬁ
 
ldns_ªsﬁvî_u£vc
(c⁄° 
ldns_ªsﬁvî
 *
r
);

223 
boﬁ
 
ldns_ªsﬁvî_Áû
(c⁄° 
ldns_ªsﬁvî
 *
r
);

229 
boﬁ
 
ldns_ªsﬁvî_de‚ames
(c⁄° 
ldns_ªsﬁvî
 *
r
);

235 
boﬁ
 
ldns_ªsﬁvî_dn§ch
(c⁄° 
ldns_ªsﬁvî
 *
r
);

241 
boﬁ
 
ldns_ªsﬁvî_dns£c
(c⁄° 
ldns_ªsﬁvî
 *
r
);

247 
boﬁ
 
ldns_ªsﬁvî_dns£c_cd
(c⁄° 
ldns_ªsﬁvî
 *
r
);

253 
ldns_º_li°
 * 
ldns_ªsﬁvî_dns£c_™ch‹s
(c⁄° 
ldns_ªsﬁvî
 *
r
);

259 
boﬁ
 
ldns_ªsﬁvî_ig¡c
(c⁄° 
ldns_ªsﬁvî
 *
r
);

265 
boﬁ
 
ldns_ªsﬁvî_øndom
(c⁄° 
ldns_ªsﬁvî
 *
r
);

271 
size_t
 
ldns_ªsﬁvî_«me£rvî_cou¡
(c⁄° 
ldns_ªsﬁvî
 *
r
);

277 
ldns_rdf
 *
ldns_ªsﬁvî_domaö
(c⁄° 
ldns_ªsﬁvî
 *
r
);

283 
timevÆ
 
ldns_ªsﬁvî_timeout
(c⁄° 
ldns_ªsﬁvî
 *
r
);

289 
ldns_rdf
** 
ldns_ªsﬁvî_£¨chli°
(c⁄° 
ldns_ªsﬁvî
 *
r
);

295 
ldns_rdf
** 
ldns_ªsﬁvî_«me£rvîs
(c⁄° 
ldns_ªsﬁvî
 *
r
);

302 
size_t
 * 
ldns_ªsﬁvî_πt
(c⁄° 
ldns_ªsﬁvî
 *
r
);

309 
size_t
 
ldns_ªsﬁvî_«me£rvî_πt
(c⁄° 
ldns_ªsﬁvî
 *
r
, size_à
pos
);

315 *
ldns_ªsﬁvî_tsig_key«me
(c⁄° 
ldns_ªsﬁvî
 *
r
);

321 *
ldns_ªsﬁvî_tsig_Æg‹ôhm
(c⁄° 
ldns_ªsﬁvî
 *
r
);

327 *
ldns_ªsﬁvî_tsig_keyd©a
(c⁄° 
ldns_ªsﬁvî
 *
r
);

333 
ldns_rdf
* 
ldns_ªsﬁvî_p›_«me£rvî
(
ldns_ªsﬁvî
 *
r
);

340 
size_t
 
ldns_ªsﬁvî_£¨chli°_cou¡
(c⁄° 
ldns_ªsﬁvî
 *
r
);

348 
ldns_ªsﬁvî_£t_p‹t
(
ldns_ªsﬁvî
 *
r
, 
uöt16_t
 
p
);

355 
ldns_ªsﬁvî_£t_sour˚
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
s
);

362 
ldns_ªsﬁvî_£t_ªcursive
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

369 
ldns_ªsﬁvî_£t_debug
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

375 
ldns_ªsﬁvî_ö¸_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
);

381 
ldns_ªsﬁvî_dec_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
);

388 
ldns_ªsﬁvî_£t_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
, 
size_t
 
c
);

395 
ldns_ªsﬁvî_£t_«me£rvîs
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 **
rd
);

403 
ldns_ªsﬁvî_£t_domaö
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
rd
);

410 
ldns_ªsﬁvî_£t_timeout
(
ldns_ªsﬁvî
 *
r
, 
timevÆ
 
timeout
);

417 
ldns_ªsﬁvî_push_£¨chli°
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
rd
);

424 
ldns_ªsﬁvî_£t_de‚ames
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

431 
ldns_ªsﬁvî_£t_u£vc
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

438 
ldns_ªsﬁvî_£t_dn§ch
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

445 
ldns_ªsﬁvî_£t_dns£c
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

452 
ldns_ªsﬁvî_£t_dns£c_cd
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

458 
ldns_ªsﬁvî_£t_dns£c_™ch‹s
(
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 * 
l
);

466 
ldns_°©us
 
ldns_ªsﬁvî_push_dns£c_™ch‹
(
ldns_ªsﬁvî
 *
r
, 
ldns_º
 *
º
);

473 
ldns_ªsﬁvî_£t_ªå™s
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
ª
);

481 
ldns_ªsﬁvî_£t_ÁŒback
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
ÁŒback
);

489 
ldns_ªsﬁvî_£t_ªåy
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
ª
);

496 
ldns_ªsﬁvî_£t_ù6
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
i
);

503 
ldns_ªsﬁvî_£t_Áû
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

510 
ldns_ªsﬁvî_£t_ig¡c
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

517 
ldns_ªsﬁvî_£t_edns_udp_size
(
ldns_ªsﬁvî
 *
r
, 
uöt16_t
 
s
);

524 
ldns_ªsﬁvî_£t_tsig_key«me
(
ldns_ªsﬁvî
 *
r
, *
tsig_key«me
);

531 
ldns_ªsﬁvî_£t_tsig_Æg‹ôhm
(
ldns_ªsﬁvî
 *
r
, *
tsig_Æg‹ôhm
);

538 
ldns_ªsﬁvî_£t_tsig_keyd©a
(
ldns_ªsﬁvî
 *
r
, *
tsig_keyd©a
);

546 
ldns_ªsﬁvî_£t_πt
(
ldns_ªsﬁvî
 *
r
, 
size_t
 *
πt
);

555 
ldns_ªsﬁvî_£t_«me£rvî_πt
(
ldns_ªsﬁvî
 *
r
, 
size_t
 
pos
, size_à
vÆue
);

562 
ldns_ªsﬁvî_£t_øndom
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
);

571 
ldns_°©us
 
ldns_ªsﬁvî_push_«me£rvî
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
n
);

580 
ldns_°©us
 
ldns_ªsﬁvî_push_«me£rvî_º
(
ldns_ªsﬁvî
 *
r
, 
ldns_º
 *
º
);

588 
ldns_°©us
 
ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 *
ºli°
);

602 
ldns_pkt
* 
ldns_ªsﬁvî_£¨ch
(c⁄° 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
rdf
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

618 
ldns_°©us
 
ldns_ªsﬁvî_£¨ch_°©us
(
ldns_pkt
** 
pkt
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
rdf
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

631 
ldns_°©us
 
ldns_ªsﬁvî_¥ï¨e_quîy_pkt
(
ldns_pkt
 **
q
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
f
);

644 
ldns_°©us
 
ldns_ªsﬁvî_£nd
(
ldns_pkt
 **
™swî
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

652 
ldns_°©us
 
ldns_ªsﬁvî_£nd_pkt
(
ldns_pkt
 **
™swî
, 
ldns_ªsﬁvî
 *
r
,Üdns_pkà*
quîy_pkt
);

666 
ldns_°©us
 
ldns_ªsﬁvî_quîy_°©us
(
ldns_pkt
** 
pkt
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

682 
ldns_pkt
* 
ldns_ªsﬁvî_quîy
(c⁄° 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
);

689 
ldns_ªsﬁvî
* 
ldns_ªsﬁvî_√w
();

698 
ldns_°©us
 
ldns_ªsﬁvî_√w_‰m_Â
(
ldns_ªsﬁvî
 **
r
, 
FILE
 *
Â
);

708 
ldns_°©us
 
ldns_ªsﬁvî_√w_‰m_Â_l
(
ldns_ªsﬁvî
 **
r
, 
FILE
 *
Â
, *
löe_ƒ
);

718 
ldns_°©us
 
ldns_ªsﬁvî_√w_‰m_fûe
(
ldns_ªsﬁvî
 **
r
, c⁄° *
fûíame
);

724 
ldns_ªsﬁvî_‰ì
(
ldns_ªsﬁvî
 *
ªs
);

730 
ldns_ªsﬁvî_dìp_‰ì
(
ldns_ªsﬁvî
 *
ªs
);

740 
ldns_º
* 
ldns_ax‰_√xt
(
ldns_ªsﬁvî
 *
ªsﬁvî
);

747 
boﬁ
 
ldns_ax‰_com∂ëe
(c⁄° 
ldns_ªsﬁvî
 *
ªsﬁvî
);

755 
ldns_pkt
 *
ldns_ax‰_œ°_pkt
(c⁄° 
ldns_ªsﬁvî
 *
ªs
);

761 
ldns_ªsﬁvî_«me£rvîs_øndomize
(
ldns_ªsﬁvî
 *
r
);

770 
boﬁ
 
ldns_ªsﬁvî_åu°ed_key
(c⁄° 
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 * 
keys
,Üdns_º_li° * 
åu°ed_keys
);

772 #ifde‡
__˝lu•lus


	@ldns/rr.h

18 #i‚de‡
LDNS_RR_H


19 
	#LDNS_RR_H


	)

21 
	~<ldns/comm⁄.h
>

22 
	~<ldns/rd©a.h
>

23 
	~<ldns/buf„r.h
>

24 
	~<ldns/îr‹.h
>

26 #ifde‡
__˝lu•lus


31 
	#LDNS_MAX_LABELLEN
 63

	)

33 
	#LDNS_MAX_DOMAINLEN
 255

	)

35 
	#LDNS_MAX_POINTERS
 65535

	)

37 
	#LDNS_RR_OVERHEAD
 10

	)

40 
	#LDNS_RDATA_FIELD_DESCRIPTORS_COMMON
 258

	)

47 
	eldns_íum_º_˛ass


50 
LDNS_RR_CLASS_IN
 = 1,

52 
LDNS_RR_CLASS_CH
 = 3,

54 
LDNS_RR_CLASS_HS
 = 4,

56 
LDNS_RR_CLASS_NONE
 = 254,

58 
LDNS_RR_CLASS_ANY
 = 255,

60 
LDNS_RR_CLASS_FIRST
 = 0,

61 
LDNS_RR_CLASS_LAST
 = 65535,

62 
LDNS_RR_CLASS_COUNT
 = 
LDNS_RR_CLASS_LAST
 - 
LDNS_RR_CLASS_FIRST
 + 1

64 
ldns_íum_º_˛ass
 
	tldns_º_˛ass
;

69 
	eldns_íum_º_com¥ess


72 
LDNS_RR_COMPRESS
,

73 
LDNS_RR_NO_COMPRESS


75 
ldns_íum_º_com¥ess
 
	tldns_º_com¥ess
;

80 
	eldns_íum_º_ty≥


83 
LDNS_RR_TYPE_A
 = 1,

85 
LDNS_RR_TYPE_NS
 = 2,

87 
LDNS_RR_TYPE_MD
 = 3,

89 
LDNS_RR_TYPE_MF
 = 4,

91 
LDNS_RR_TYPE_CNAME
 = 5,

93 
LDNS_RR_TYPE_SOA
 = 6,

95 
LDNS_RR_TYPE_MB
 = 7,

97 
LDNS_RR_TYPE_MG
 = 8,

99 
LDNS_RR_TYPE_MR
 = 9,

101 
LDNS_RR_TYPE_NULL
 = 10,

103 
LDNS_RR_TYPE_WKS
 = 11,

105 
LDNS_RR_TYPE_PTR
 = 12,

107 
LDNS_RR_TYPE_HINFO
 = 13,

109 
LDNS_RR_TYPE_MINFO
 = 14,

111 
LDNS_RR_TYPE_MX
 = 15,

113 
LDNS_RR_TYPE_TXT
 = 16,

115 
LDNS_RR_TYPE_RP
 = 17,

117 
LDNS_RR_TYPE_AFSDB
 = 18,

119 
LDNS_RR_TYPE_X25
 = 19,

121 
LDNS_RR_TYPE_ISDN
 = 20,

123 
LDNS_RR_TYPE_RT
 = 21,

125 
LDNS_RR_TYPE_NSAP
 = 22,

127 
LDNS_RR_TYPE_NSAP_PTR
 = 23,

129 
LDNS_RR_TYPE_SIG
 = 24,

131 
LDNS_RR_TYPE_KEY
 = 25,

133 
LDNS_RR_TYPE_PX
 = 26,

135 
LDNS_RR_TYPE_GPOS
 = 27,

137 
LDNS_RR_TYPE_AAAA
 = 28,

139 
LDNS_RR_TYPE_LOC
 = 29,

141 
LDNS_RR_TYPE_NXT
 = 30,

143 
LDNS_RR_TYPE_EID
 = 31,

145 
LDNS_RR_TYPE_NIMLOC
 = 32,

147 
LDNS_RR_TYPE_SRV
 = 33,

149 
LDNS_RR_TYPE_ATMA
 = 34,

151 
LDNS_RR_TYPE_NAPTR
 = 35,

153 
LDNS_RR_TYPE_KX
 = 36,

155 
LDNS_RR_TYPE_CERT
 = 37,

157 
LDNS_RR_TYPE_A6
 = 38,

159 
LDNS_RR_TYPE_DNAME
 = 39,

161 
LDNS_RR_TYPE_SINK
 = 40,

163 
LDNS_RR_TYPE_OPT
 = 41,

165 
LDNS_RR_TYPE_APL
 = 42,

167 
LDNS_RR_TYPE_DS
 = 43,

169 
LDNS_RR_TYPE_SSHFP
 = 44,

171 
LDNS_RR_TYPE_IPSECKEY
 = 45,

173 
LDNS_RR_TYPE_RRSIG
 = 46,

174 
LDNS_RR_TYPE_NSEC
 = 47,

175 
LDNS_RR_TYPE_DNSKEY
 = 48,

177 
LDNS_RR_TYPE_DHCID
 = 49,

179 
LDNS_RR_TYPE_NSEC3
 = 50,

180 
LDNS_RR_TYPE_NSEC3PARAM
 = 51,

181 
LDNS_RR_TYPE_NSEC3PARAMS
 = 51,

182 
LDNS_RR_TYPE_TLSA
 = 52,

184 
LDNS_RR_TYPE_HIP
 = 55,

187 
LDNS_RR_TYPE_NINFO
 = 56,

189 
LDNS_RR_TYPE_RKEY
 = 57,

191 
LDNS_RR_TYPE_TALINK
 = 58,

193 
LDNS_RR_TYPE_CDS
 = 59,

195 
LDNS_RR_TYPE_SPF
 = 99,

197 
LDNS_RR_TYPE_UINFO
 = 100,

198 
LDNS_RR_TYPE_UID
 = 101,

199 
LDNS_RR_TYPE_GID
 = 102,

200 
LDNS_RR_TYPE_UNSPEC
 = 103,

202 
LDNS_RR_TYPE_NID
 = 104,

203 
LDNS_RR_TYPE_L32
 = 105,

204 
LDNS_RR_TYPE_L64
 = 106,

205 
LDNS_RR_TYPE_LP
 = 107,

207 
LDNS_RR_TYPE_EUI48
 = 108,

208 
LDNS_RR_TYPE_EUI64
 = 109,

210 
LDNS_RR_TYPE_TKEY
 = 249,

211 
LDNS_RR_TYPE_TSIG
 = 250,

212 
LDNS_RR_TYPE_IXFR
 = 251,

213 
LDNS_RR_TYPE_AXFR
 = 252,

215 
LDNS_RR_TYPE_MAILB
 = 253,

217 
LDNS_RR_TYPE_MAILA
 = 254,

219 
LDNS_RR_TYPE_ANY
 = 255,

221 
LDNS_RR_TYPE_URI
 = 256,

222 
LDNS_RR_TYPE_CAA
 = 257,

225 
LDNS_RR_TYPE_TA
 = 32768,

227 
LDNS_RR_TYPE_DLV
 = 32769,

232 
LDNS_RR_TYPE_FIRST
 = 0,

233 
LDNS_RR_TYPE_LAST
 = 65535,

234 
LDNS_RR_TYPE_COUNT
 = 
LDNS_RR_TYPE_LAST
 - 
LDNS_RR_TYPE_FIRST
 + 1

236 
ldns_íum_º_ty≥
 
	tldns_º_ty≥
;

299 
	sldns_°ru˘_º


302 
ldns_rdf
 *
_ow√r
;

304 
uöt32_t
 
_âl
;

306 
size_t
 
_rd_cou¡
;

308 
ldns_º_ty≥
 
_º_ty≥
;

310 
ldns_º_˛ass
 
_º_˛ass
;

313 
ldns_rdf
 **
_rd©a_fõlds
;

317 
boﬁ
 
_º_que°i⁄
;

319 
ldns_°ru˘_º
 
	tldns_º
;

327 
	sldns_°ru˘_º_li°


329 
size_t
 
_º_cou¡
;

330 
size_t
 
_º_ˇ∑côy
;

331 
ldns_º
 **
_ºs
;

333 
ldns_°ru˘_º_li°
 
	tldns_º_li°
;

340 
	sldns_°ru˘_º_des¸ùt‹


343 
ldns_º_ty≥
 
_ty≥
;

345 c⁄° *
_«me
;

347 
uöt8_t
 
_möimum
;

349 
uöt8_t
 
_maximum
;

351 c⁄° 
ldns_rdf_ty≥
 *
_wúef‹m©
;

353 
ldns_rdf_ty≥
 
_v¨übÀ
;

355 
ldns_º_com¥ess
 
_com¥ess
;

357 
uöt8_t
 
_d«me_cou¡
;

359 
ldns_°ru˘_º_des¸ùt‹
 
	tldns_º_des¸ùt‹
;

368 
ldns_°©us
 
ldns_rdf_bôm≠_known_º_ty≥s_•a˚
(
ldns_rdf
** 
rdf
);

375 
ldns_°©us
 
ldns_rdf_bôm≠_known_º_ty≥s
(
ldns_rdf
** 
rdf
);

382 
ldns_º
* 
ldns_º_√w
();

388 
ldns_º
* 
ldns_º_√w_‰m_ty≥
(
ldns_º_ty≥
 
t
);

395 
ldns_º_‰ì
(
ldns_º
 *
º
);

413 
ldns_°©us
 
ldns_º_√w_‰m_°r
(
ldns_º
 **
n
, c⁄° *
°r
,

414 
uöt32_t
 
deÁu…_âl
, 
ldns_rdf
 *
‹igö
,

415 
ldns_rdf
 **
¥ev
);

430 
ldns_°©us
 
ldns_º_√w_que°i⁄_‰m_°r
(
ldns_º
 **
n
, c⁄° *
°r
,

431 
ldns_rdf
 *
‹igö
,Üdns_rd‡**
¥ev
);

447 
ldns_°©us
 
ldns_º_√w_‰m_Â
(
ldns_º
 **
º
, 
FILE
 *
Â
, 
uöt32_t
 *
deÁu…_âl
, 
ldns_rdf
 **
‹igö
,Üdns_rd‡**
¥ev
);

464 
ldns_°©us
 
ldns_º_√w_‰m_Â_l
(
ldns_º
 **
º
, 
FILE
 *
Â
, 
uöt32_t
 *
deÁu…_âl
, 
ldns_rdf
 **
‹igö
,Üdns_rd‡**
¥ev
, *
löe_ƒ
);

472 
ldns_º_£t_ow√r
(
ldns_º
 *
º
, 
ldns_rdf
 *
ow√r
);

480 
ldns_º_£t_que°i⁄
(
ldns_º
 *
º
, 
boﬁ
 
que°i⁄
);

488 
ldns_º_£t_âl
(
ldns_º
 *
º
, 
uöt32_t
 
âl
);

496 
ldns_º_£t_rd_cou¡
(
ldns_º
 *
º
, 
size_t
 
cou¡
);

504 
ldns_º_£t_ty≥
(
ldns_º
 *
º
, 
ldns_º_ty≥
 
º_ty≥
);

512 
ldns_º_£t_˛ass
(
ldns_º
 *
º
, 
ldns_º_˛ass
 
º_˛ass
);

522 
ldns_rdf
* 
ldns_º_£t_rdf
(
ldns_º
 *
º
, c⁄°Üdns_rd‡*
f
, 
size_t
 
posôi⁄
);

531 
boﬁ
 
ldns_º_push_rdf
(
ldns_º
 *
º
, c⁄° 
ldns_rdf
 *
f
);

539 
ldns_rdf
* 
ldns_º_p›_rdf
(
ldns_º
 *
º
);

547 
ldns_rdf
* 
ldns_º_rdf
(c⁄° 
ldns_º
 *
º
, 
size_t
 
ƒ
);

554 
ldns_rdf
* 
ldns_º_ow√r
(c⁄° 
ldns_º
 *
º
);

561 
boﬁ
 
ldns_º_is_que°i⁄
(c⁄° 
ldns_º
 *
º
);

568 
uöt32_t
 
ldns_º_âl
(c⁄° 
ldns_º
 *
º
);

575 
size_t
 
ldns_º_rd_cou¡
(c⁄° 
ldns_º
 *
º
);

582 
ldns_º_ty≥
 
ldns_º_gë_ty≥
(c⁄° 
ldns_º
 *
º
);

589 
ldns_º_˛ass
 
ldns_º_gë_˛ass
(c⁄° 
ldns_º
 *
º
);

598 
size_t
 
ldns_º_li°_º_cou¡
(c⁄° 
ldns_º_li°
 *
º_li°
);

606 
ldns_º_li°_£t_º_cou¡
(
ldns_º_li°
 *
º_li°
, 
size_t
 
cou¡
);

616 
ldns_º
 * 
ldns_º_li°_£t_º
(
ldns_º_li°
 *
º_li°
, c⁄°Üdns_º *
r
, 
size_t
 
cou¡
);

624 
ldns_º
* 
ldns_º_li°_º
(c⁄° 
ldns_º_li°
 *
º_li°
, 
size_t
 
ƒ
);

630 
ldns_º_li°
* 
ldns_º_li°_√w
();

636 
ldns_º_li°_‰ì
(
ldns_º_li°
 *
º_li°
);

642 
ldns_º_li°_dìp_‰ì
(
ldns_º_li°
 *
º_li°
);

651 
boﬁ
 
ldns_º_li°_ˇt
(
ldns_º_li°
 *
À·
,Üdns_º_li° *
right
);

660 
ldns_º_li°
* 
ldns_º_li°_ˇt_˛⁄e
÷dns_º_li° *
À·
,Üdns_º_li° *
right
);

668 
boﬁ
 
ldns_º_li°_push_º
(
ldns_º_li°
 *
º_li°
, c⁄° 
ldns_º
 *
º
);

676 
boﬁ
 
ldns_º_li°_push_º_li°
(
ldns_º_li°
 *
º_li°
, c⁄°Üdns_º_li° *
push_li°
);

683 
ldns_º
* 
ldns_º_li°_p›_º
(
ldns_º_li°
 *
º_li°
);

691 
ldns_º_li°
* 
ldns_º_li°_p›_º_li°
÷dns_º_li° *
º_li°
, 
size_t
 
size
);

700 
boﬁ
 
ldns_º_li°_c⁄èös_º
(c⁄° 
ldns_º_li°
 *
º_li°
, 
ldns_º
 *
º
);

707 
boﬁ
 
ldns_is_º£t
(
ldns_º_li°
 *
º_li°
);

715 
boﬁ
 
ldns_º_£t_push_º
(
ldns_º_li°
 *
º_li°
, 
ldns_º
 *
º
);

724 
ldns_º
* 
ldns_º_£t_p›_º
(
ldns_º_li°
 *
º_li°
);

731 
ldns_º_li°
 *
ldns_º_li°_p›_º£t
÷dns_º_li° *
º_li°
);

739 
ldns_º_ty≥
 
ldns_gë_º_ty≥_by_«me
(c⁄° *
«me
);

746 
ldns_º_˛ass
 
ldns_gë_º_˛ass_by_«me
(c⁄° *
«me
);

753 
ldns_º
* 
ldns_º_˛⁄e
(c⁄°Üdns_º *
º
);

760 
ldns_º_li°
* 
ldns_º_li°_˛⁄e
(c⁄°Üdns_º_li° *
ºli°
);

767 
ldns_º_li°_s‹t
(
ldns_º_li°
 *
uns‹ãd
);

777 
ldns_º_com∑ª
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
);

787 
ldns_º_com∑ª_no_rd©a
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
);

797 
ldns_º_com∑ª_wúe
(
ldns_buf„r
 *
º1_buf
,Üdns_buf„∏*
º2_buf
);

807 
boﬁ
 
ldns_º_com∑ª_ds
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
);

817 
ldns_º_li°_com∑ª
(c⁄° 
ldns_º_li°
 *
ºl1
, c⁄°Üdns_º_li° *
ºl2
);

824 
size_t
 
ldns_º_uncom¥es£d_size
(c⁄° 
ldns_º
 *
r
);

831 
ldns_º2ˇn⁄iˇl
(
ldns_º
 *
º
);

838 
ldns_º_li°2ˇn⁄iˇl
(
ldns_º_li°
 *
º_li°
);

845 
uöt8_t
 
ldns_º_œbñ_cou¡
(
ldns_º
 *
º
);

853 c⁄° 
ldns_º_des¸ùt‹
 *
ldns_º_des¸ùt
(
uöt16_t
 
ty≥
);

861 
size_t
 
ldns_º_des¸ùt‹_möimum
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
);

869 
size_t
 
ldns_º_des¸ùt‹_maximum
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
);

878 
ldns_rdf_ty≥
 
ldns_º_des¸ùt‹_fõld_ty≥
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
, 
size_t
 
fõld
);

891 
ldns_º_li°
 *
ldns_º_li°_subty≥_by_rdf
÷dns_º_li° *
l
, 
ldns_rdf
 *
r
, 
size_t
 
pos
);

901 
ldns_º_ty≥
 
ldns_rdf2º_ty≥
(c⁄° 
ldns_rdf
 *
rd
);

910 
ldns_º_ty≥


911 
ldns_º_li°_ty≥
(c⁄° 
ldns_º_li°
 *
º_li°
);

920 
ldns_rdf
 *

921 
ldns_º_li°_ow√r
(c⁄° 
ldns_º_li°
 *
º_li°
);

923 #ifde‡
__˝lu•lus


	@ldns/rr_functions.h

13 #i‚de‡
LDNS_RR_FUNCTIONS_H


14 
	#LDNS_RR_FUNCTIONS_H


	)

16 #ifde‡
__˝lu•lus


32 
ldns_rdf
* 
ldns_º_a_addªss
(c⁄° 
ldns_º
 *
r
);

40 
boﬁ
 
ldns_º_a_£t_addªss
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

48 
ldns_rdf
* 
ldns_º_ns_nsd«me
(c⁄° 
ldns_º
 *
r
);

56 
ldns_rdf
* 
ldns_º_mx_¥e„ªn˚
(c⁄° 
ldns_º
 *
r
);

62 
ldns_rdf
* 
ldns_º_mx_exch™ge
(c⁄° 
ldns_º
 *
r
);

70 
ldns_rdf
* 
ldns_º_ºsig_ty≥covîed
(c⁄° 
ldns_º
 *
r
);

77 
boﬁ
 
ldns_º_ºsig_£t_ty≥covîed
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

83 
ldns_rdf
* 
ldns_º_ºsig_Æg‹ôhm
(c⁄° 
ldns_º
 *
r
);

90 
boﬁ
 
ldns_º_ºsig_£t_Æg‹ôhm
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

96 
ldns_rdf
 *
ldns_º_ºsig_œbñs
(c⁄° 
ldns_º
 *
r
);

103 
boﬁ
 
ldns_º_ºsig_£t_œbñs
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

109 
ldns_rdf
* 
ldns_º_ºsig_‹igâl
(c⁄° 
ldns_º
 *
r
);

116 
boﬁ
 
ldns_º_ºsig_£t_‹igâl
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

122 
ldns_rdf
* 
ldns_º_ºsig_expú©i⁄
(c⁄° 
ldns_º
 *
r
);

129 
boﬁ
 
ldns_º_ºsig_£t_expú©i⁄
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

135 
ldns_rdf
* 
ldns_º_ºsig_ö˚±i⁄
(c⁄° 
ldns_º
 *
r
);

142 
boﬁ
 
ldns_º_ºsig_£t_ö˚±i⁄
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

148 
ldns_rdf
* 
ldns_º_ºsig_keyèg
(c⁄° 
ldns_º
 *
r
);

155 
boﬁ
 
ldns_º_ºsig_£t_keyèg
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

161 
ldns_rdf
* 
ldns_º_ºsig_sig«me
(c⁄° 
ldns_º
 *
r
);

168 
boﬁ
 
ldns_º_ºsig_£t_sig«me
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

174 
ldns_rdf
* 
ldns_º_ºsig_sig
(c⁄° 
ldns_º
 *
r
);

181 
boﬁ
 
ldns_º_ºsig_£t_sig
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

189 
ldns_rdf
* 
ldns_º_dnskey_Êags
(c⁄° 
ldns_º
 *
r
);

196 
boﬁ
 
ldns_º_dnskey_£t_Êags
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

202 
ldns_rdf
* 
ldns_º_dnskey_¥Ÿocﬁ
(c⁄° 
ldns_º
 *
r
);

209 
boﬁ
 
ldns_º_dnskey_£t_¥Ÿocﬁ
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

215 
ldns_rdf
* 
ldns_º_dnskey_Æg‹ôhm
(c⁄° 
ldns_º
 *
r
);

222 
boﬁ
 
ldns_º_dnskey_£t_Æg‹ôhm
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

228 
ldns_rdf
* 
ldns_º_dnskey_key
(c⁄° 
ldns_º
 *
r
);

235 
boﬁ
 
ldns_º_dnskey_£t_key
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
);

244 
size_t
 
ldns_º_dnskey_key_size_øw
(c⁄° *
keyd©a
,

245 c⁄° 
size_t
 
Àn
,

246 c⁄° 
ldns_Æg‹ôhm
 
Æg
);

253 
size_t
 
ldns_º_dnskey_key_size
(c⁄° 
ldns_º
 *
key
);

266 
uöt32_t
 (*
	tldns_sﬂ_£rül_ö¸emít_func_t
)(
	tuöt32_t
, *);

274 
uöt32_t
 
ldns_sﬂ_£rül_idítôy
(uöt32_à
unu£d
, *
d©a
);

282 
uöt32_t
 
ldns_sﬂ_£rül_ö¸emít
(uöt32_à
s
, *
unu£d
);

290 
uöt32_t
 
ldns_sﬂ_£rül_ö¸emít_by
(uöt32_à
s
, *
d©a
);

303 
uöt32_t
 
ldns_sﬂ_£rül_unixtime
(uöt32_à
s
, *
d©a
);

316 
uöt32_t
 
ldns_sﬂ_£rül_d©ecou¡î
(uöt32_à
s
, *
d©a
);

322 
ldns_º_sﬂ_ö¸emít
(

323 
ldns_º
 *
sﬂ
);

332 
ldns_º_sﬂ_ö¸emít_func
(

333 
ldns_º
 *
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
);

342 
ldns_º_sﬂ_ö¸emít_func_d©a
(

343 
ldns_º
 *
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
, *
d©a
);

356 
ldns_º_sﬂ_ö¸emít_func_öt
(

357 
ldns_º
 *
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
, 
d©a
);

359 #ifde‡
__˝lu•lus


	@ldns/sha1.h

1 #i‚de‡
LDNS_SHA1_H


2 
	#LDNS_SHA1_H


	)

4 #ifde‡
__˝lu•lus


8 
	#LDNS_SHA1_BLOCK_LENGTH
 64

	)

9 
	#LDNS_SHA1_DIGEST_LENGTH
 20

	)

12 
uöt32_t
 
°©e
[5];

13 
uöt64_t
 
cou¡
;

14 
buf„r
[
LDNS_SHA1_BLOCK_LENGTH
];

15 } 
	tldns_sha1_˘x
;

17 
ldns_sha1_öô
(
ldns_sha1_˘x
 * 
c⁄ãxt
);

18 
ldns_sha1_å™sf‹m
(
uöt32_t
 
°©e
[5], c⁄° 
buf„r
[
LDNS_SHA1_BLOCK_LENGTH
]);

19 
ldns_sha1_upd©e
(
ldns_sha1_˘x
 *
c⁄ãxt
, c⁄° *
d©a
, 
Àn
);

20 
ldns_sha1_föÆ
(
dige°
[
LDNS_SHA1_DIGEST_LENGTH
], 
ldns_sha1_˘x
 *
c⁄ãxt
);

32 *
ldns_sha1
(*
d©a
, 
d©a_Àn
, *
dige°
);

34 #ifde‡
__˝lu•lus


	@ldns/sha2.h

46 #i‚de‡
__LDNS_SHA2_H__


47 
	#__LDNS_SHA2_H__


	)

49 #ifde‡
__˝lu•lus


59 
	~<sys/ty≥s.h
>

61 #i‡
LDNS_BUILD_CONFIG_HAVE_INTTYPES_H


63 
	~<öây≥s.h
>

69 
	#LDNS_SHA256_BLOCK_LENGTH
 64

	)

70 
	#LDNS_SHA256_DIGEST_LENGTH
 32

	)

71 
	#LDNS_SHA256_DIGEST_STRING_LENGTH
 (
LDNS_SHA256_DIGEST_LENGTH
 * 2 + 1)

	)

72 
	#LDNS_SHA384_BLOCK_LENGTH
 128

	)

73 
	#LDNS_SHA384_DIGEST_LENGTH
 48

	)

74 
	#LDNS_SHA384_DIGEST_STRING_LENGTH
 (
LDNS_SHA384_DIGEST_LENGTH
 * 2 + 1)

	)

75 
	#LDNS_SHA512_BLOCK_LENGTH
 128

	)

76 
	#LDNS_SHA512_DIGEST_LENGTH
 64

	)

77 
	#LDNS_SHA512_DIGEST_STRING_LENGTH
 (
LDNS_SHA512_DIGEST_LENGTH
 * 2 + 1)

	)

82 
	s_ldns_sha256_CTX
 {

83 
uöt32_t
 
°©e
[8];

84 
uöt64_t
 
bôcou¡
;

85 
uöt8_t
 
buf„r
[
LDNS_SHA256_BLOCK_LENGTH
];

86 } 
	tldns_sha256_CTX
;

87 
	s_ldns_sha512_CTX
 {

88 
uöt64_t
 
°©e
[8];

89 
uöt64_t
 
bôcou¡
[2];

90 
uöt8_t
 
buf„r
[
LDNS_SHA512_BLOCK_LENGTH
];

91 } 
	tldns_sha512_CTX
;

93 
ldns_sha512_CTX
 
	tldns_sha384_CTX
;

97 
ldns_sha256_öô
(
ldns_sha256_CTX
 *);

98 
ldns_sha256_upd©e
(
ldns_sha256_CTX
*, c⁄° 
uöt8_t
*, 
size_t
);

99 
ldns_sha256_föÆ
(
uöt8_t
[
LDNS_SHA256_DIGEST_LENGTH
], 
ldns_sha256_CTX
*);

101 
ldns_sha384_öô
(
ldns_sha384_CTX
*);

102 
ldns_sha384_upd©e
(
ldns_sha384_CTX
*, c⁄° 
uöt8_t
*, 
size_t
);

103 
ldns_sha384_föÆ
(
uöt8_t
[
LDNS_SHA384_DIGEST_LENGTH
], 
ldns_sha384_CTX
*);

105 
ldns_sha512_öô
(
ldns_sha512_CTX
*);

106 
ldns_sha512_upd©e
(
ldns_sha512_CTX
*, c⁄° 
uöt8_t
*, 
size_t
);

107 
ldns_sha512_föÆ
(
uöt8_t
[
LDNS_SHA512_DIGEST_LENGTH
], 
ldns_sha512_CTX
*);

119 *
ldns_sha256
(*
d©a
, 
d©a_Àn
, *
dige°
);

131 *
ldns_sha384
(*
d©a
, 
d©a_Àn
, *
dige°
);

143 *
ldns_sha512
(*
d©a
, 
d©a_Àn
, *
dige°
);

145 #ifdef 
__˝lu•lus


	@ldns/str2host.h

11 #i‚de‡
LDNS_2HOST_H


12 
	#LDNS_2HOST_H


	)

14 
	~<ldns/comm⁄.h
>

15 
	~<ldns/îr‹.h
>

16 
	~<ldns/º.h
>

17 
	~<ldns/rd©a.h
>

18 
	~<ldns/∑ckë.h
>

19 
	~<ldns/buf„r.h
>

20 
	~<˘y≥.h
>

22 #ifde‡
__˝lu•lus


39 
ldns_°©us
 
ldns_°r2rdf_öt8
(
ldns_rdf
 **
rd
, c⁄° *
byã°r
);

47 
ldns_°©us
 
ldns_°r2rdf_öt16
(
ldns_rdf
 **
rd
, c⁄° *
sh‹t°r
);

55 
ldns_°©us
 
ldns_°r2rdf_öt32
(
ldns_rdf
 **
rd
, c⁄° *
l⁄g°r
);

63 
ldns_°©us
 
ldns_°r2rdf_time
(
ldns_rdf
 **
rd
, c⁄° *
time
);

70 
ldns_°©us
 
ldns_°r2rdf_n£c3_ß…
(
ldns_rdf
 **
rd
, c⁄° *
n£c3_ß…
);

77 
ldns_°©us
 
ldns_°r2rdf_≥riod
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

85 
ldns_°©us
 
ldns_°r2rdf_a
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

93 
ldns_°©us
 
ldns_°r2rdf_ØØ
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

101 
ldns_°©us
 
ldns_°r2rdf_°r
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

109 
ldns_°©us
 
ldns_°r2rdf_≠l
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

117 
ldns_°©us
 
ldns_°r2rdf_b64
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

125 
ldns_°©us
 
ldns_°r2rdf_b32_ext
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

133 
ldns_°©us
 
ldns_°r2rdf_hex
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

141 
ldns_°©us
 
ldns_°r2rdf_n£c
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

149 
ldns_°©us
 
ldns_°r2rdf_ty≥
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

157 
ldns_°©us
 
ldns_°r2rdf_˛ass
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

165 
ldns_°©us
 
ldns_°r2rdf_˚π_Æg
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

173 
ldns_°©us
 
ldns_°r2rdf_Æg
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

181 
ldns_°©us
 
ldns_°r2rdf_unknown
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

189 
ldns_°©us
 
ldns_°r2rdf_£rvi˚
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

197 
ldns_°©us
 
ldns_°r2rdf_loc
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

205 
ldns_°©us
 
ldns_°r2rdf_wks
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

213 
ldns_°©us
 
ldns_°r2rdf_nßp
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

221 
ldns_°©us
 
ldns_°r2rdf_©ma
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

229 
ldns_°©us
 
ldns_°r2rdf_ù£ckey
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

237 
ldns_°©us
 
ldns_°r2rdf_d«me
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

245 
ldns_°©us
 
ldns_°r2rdf_û≈64
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

253 
ldns_°©us
 
ldns_°r2rdf_eui48
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

261 
ldns_°©us
 
ldns_°r2rdf_eui64
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

269 
ldns_°©us
 
ldns_°r2rdf_èg
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

278 
ldns_°©us
 
ldns_°r2rdf_l⁄g_°r
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

288 
ldns_°©us
 
ldns_°r2rdf_hù
(
ldns_rdf
 **
rd
, c⁄° *
°r
);

291 #ifde‡
__˝lu•lus


	@ldns/tsig.h

9 #i‚de‡
LDNS_TSIG_H


10 
	#LDNS_TSIG_H


	)

12 #ifde‡
__˝lu•lus


26 
	sldns_tsig_¸edítüls_°ru˘


28 *
Æg‹ôhm
;

29 *
key«me
;

30 *
keyd©a
;

32 } 
	tldns_tsig_¸edítüls
;

34 *
ldns_tsig_Æg‹ôhm
(
ldns_tsig_¸edítüls
 *);

35 *
ldns_tsig_key«me
(
ldns_tsig_¸edítüls
 *);

36 *
ldns_tsig_keyd©a
(
ldns_tsig_¸edítüls
 *);

37 *
ldns_tsig_key«me_˛⁄e
(
ldns_tsig_¸edítüls
 *);

38 *
ldns_tsig_keyd©a_˛⁄e
(
ldns_tsig_¸edítüls
 *);

51 
boﬁ
 
ldns_pkt_tsig_vîify
(
ldns_pkt
 *
pkt
, 
uöt8_t
 *
wúe
, 
size_t
 
wúe_size
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
ldns_rdf
 *
mac
);

66 
boﬁ
 
ldns_pkt_tsig_vîify_√xt
(
ldns_pkt
 *
pkt
, 
uöt8_t
 *
wúe
, 
size_t
 
wúe_size
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
ldns_rdf
 *
mac
,

67 
tsig_timîs_⁄ly
);

79 
ldns_°©us
 
ldns_pkt_tsig_sign
(
ldns_pkt
 *
pkt
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
uöt16_t
 
fudge
,

80 c⁄° *
Æg‹ôhm_«me
, 
ldns_rdf
 *
quîy_mac
);

94 
ldns_°©us
 
ldns_pkt_tsig_sign_√xt
(
ldns_pkt
 *
pkt
, c⁄° *
key_«me
, c⁄° *
key_d©a
, 
uöt16_t
 
fudge
,

95 c⁄° *
Æg‹ôhm_«me
, 
ldns_rdf
 *
quîy_mac
, 
tsig_timîs_⁄ly
);

97 #ifde‡
__˝lu•lus


	@ldns/update.h

18 #i‚de‡
LDNS_UPDATE_H


19 
	#LDNS_UPDATE_H


	)

21 
	~<ldns/ªsﬁvî.h
>

23 #ifde‡
__˝lu•lus


36 
ldns_pkt
 *
ldns_upd©e_pkt_√w
(
ldns_rdf
 *
z⁄e_rdf
, 
ldns_º_˛ass
 
˛as
, 
ldns_º_li°
 *
¥_ºli°
,Üdns_º_li° *
up_ºli°
,Üdns_º_li° *
ad_ºli°
);

46 
ldns_°©us
 
ldns_upd©e_pkt_tsig_add
(
ldns_pkt
 *
p
, 
ldns_ªsﬁvî
 *
r
);

55 
uöt16_t
 
ldns_upd©e_zocou¡
(c⁄° 
ldns_pkt
 *
p
);

61 
uöt16_t
 
ldns_upd©e_¥cou¡
(c⁄° 
ldns_pkt
 *
p
);

67 
uöt16_t
 
ldns_upd©e_upcou¡
(c⁄° 
ldns_pkt
 *
p
);

73 
uöt16_t
 
ldns_upd©e_ad
(c⁄° 
ldns_pkt
 *
p
);

79 
ldns_upd©e_£t_zo
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

85 
ldns_upd©e_£t_¥cou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

91 
ldns_upd©e_£t_upcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

97 
ldns_upd©e_£t_adcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
c
);

104 
ldns_°©us
 
ldns_upd©e_sﬂ_m«me
(
ldns_rdf
 *
z⁄e
, 
ldns_ªsﬁvî
 *
r
, 
ldns_º_˛ass
 
c
,Üdns_rd‡**
m«me
);

109 
ldns_°©us
 
ldns_upd©e_sﬂ_z⁄e_m«me
(c⁄° *
fqdn
, 
ldns_ªsﬁvî
 *
r
, 
ldns_º_˛ass
 
c
, 
ldns_rdf
 **
z⁄e_rdf
,Üdns_rd‡**
m«me_rdf
);

111 #ifde‡
__˝lu•lus


	@ldns/util.h

13 #i‚de‡
_UTIL_H


14 
	#_UTIL_H


	)

16 
	~<öây≥s.h
>

17 
	~<sys/ty≥s.h
>

18 
	~<uni°d.h
>

19 
	~<ldns/comm⁄.h
>

20 
	~<time.h
>

21 
	~<°dio.h
>

23 #ifde‡
__˝lu•lus


27 
	#d¥ötf
(
X
,
Y
Ë
	`Ârötf
(
°dîr
, (X), (Y))

	)

30 
	#LDNS_VERSION
 "1.6.17"

	)

31 
	#LDNS_REVISION
 ((1<<16)|(6<<8)|(17))

	)

36 #ifde‡
S_SPLINT_S


37 
	#INLINE


	)

39 #ifde‡
SWIG


40 
	#INLINE
 

	)

42 
	#INLINE
 
ölöe


	)

49 
	#LDNS_MALLOC
(
ty≥
Ë
	`LDNS_XMALLOC
—y≥, 1)

	)

51 
	#LDNS_XMALLOC
(
ty≥
, 
cou¡
Ë(—y≥ *Ë
	`mÆloc
((cou¡Ë* —y≥)))

	)

53 
	#LDNS_CALLOC
(
ty≥
, 
cou¡
Ë(—y≥ *Ë
	`ˇŒoc
((cou¡), —y≥)))

	)

55 
	#LDNS_REALLOC
(
±r
, 
ty≥
Ë
	`LDNS_XREALLOC
(’å),Åy≥, 1)

	)

57 
	#LDNS_XREALLOC
(
±r
, 
ty≥
, 
cou¡
) \

58 ((
ty≥
 *Ë
	`ªÆloc
((
±r
), (
cou¡
Ë* —y≥)))

	)

60 
	#LDNS_FREE
(
±r
) \

61 dÿ{ 
	`‰ì
((
±r
)); (±rË
NULL
; } 0)

	)

63 
	#LDNS_DEP
 
	`¥ötf
("DEPRECATED FUNCTION!\n");

	)

69 
INLINE
 
uöt16_t


70 
ldns_ªad_uöt16
(c⁄° *
§c
)

72 #ifde‡
ALLOW_UNALIGNED_ACCESSES


73  
¡ohs
(*(
uöt16_t
 *Ë
§c
);

75 
uöt8_t
 *
p
 = (uöt8_à*Ë
§c
;

76  ((
uöt16_t
Ë
p
[0] << 8) | (uint16_t)Ö[1];

80 
INLINE
 
uöt32_t


81 
ldns_ªad_uöt32
(c⁄° *
§c
)

83 #ifde‡
ALLOW_UNALIGNED_ACCESSES


84  
¡ohl
(*(
uöt32_t
 *Ë
§c
);

86 
uöt8_t
 *
p
 = (uöt8_à*Ë
§c
;

87  ( ((
uöt32_t
Ë
p
[0] << 24)

88 | ((
uöt32_t
Ë
p
[1] << 16)

89 | ((
uöt32_t
Ë
p
[2] << 8)

90 | (
uöt32_t
Ë
p
[3]);

98 
INLINE
 

99 
ldns_wrôe_uöt16
(*
d°
, 
uöt16_t
 
d©a
)

101 #ifde‡
ALLOW_UNALIGNED_ACCESSES


102 * (
uöt16_t
 *Ë
d°
 = 
ht⁄s
(
d©a
);

104 
uöt8_t
 *
p
 = (uöt8_à*Ë
d°
;

105 
p
[0] = (
uöt8_t
Ë((
d©a
 >> 8) & 0xff);

106 
p
[1] = (
uöt8_t
Ë(
d©a
 & 0xff);

110 
INLINE
 

111 
ldns_wrôe_uöt32
(*
d°
, 
uöt32_t
 
d©a
)

113 #ifde‡
ALLOW_UNALIGNED_ACCESSES


114 * (
uöt32_t
 *Ë
d°
 = 
ht⁄l
(
d©a
);

116 
uöt8_t
 *
p
 = (uöt8_à*Ë
d°
;

117 
p
[0] = (
uöt8_t
Ë((
d©a
 >> 24) & 0xff);

118 
p
[1] = (
uöt8_t
Ë((
d©a
 >> 16) & 0xff);

119 
p
[2] = (
uöt8_t
Ë((
d©a
 >> 8) & 0xff);

120 
p
[3] = (
uöt8_t
Ë(
d©a
 & 0xff);

125 
INLINE
 

126 
ldns_wrôe_uöt64_as_uöt48
(*
d°
, 
uöt64_t
 
d©a
)

128 
uöt8_t
 *
p
 = (uöt8_à*Ë
d°
;

129 
p
[0] = (
uöt8_t
Ë((
d©a
 >> 40) & 0xff);

130 
p
[1] = (
uöt8_t
Ë((
d©a
 >> 32) & 0xff);

131 
p
[2] = (
uöt8_t
Ë((
d©a
 >> 24) & 0xff);

132 
p
[3] = (
uöt8_t
Ë((
d©a
 >> 16) & 0xff);

133 
p
[4] = (
uöt8_t
Ë((
d©a
 >> 8) & 0xff);

134 
p
[5] = (
uöt8_t
Ë(
d©a
 & 0xff);

144 
	sldns_schw¨tzün_com∑ª_°ru˘
 {

145 *
‹igöÆ_obje˘
;

146 *
å™sf‹med_obje˘
;

156 
	sldns_°ru˘_lookup_èbÀ
 {

157 
id
;

158 c⁄° *
«me
;

160 
ldns_°ru˘_lookup_èbÀ
 
	tldns_lookup_èbÀ
;

168 
ldns_lookup_èbÀ
 *
ldns_lookup_by_«me
÷dns_lookup_èbÀ 
èbÀ
[],

169 c⁄° *
«me
);

177 
ldns_lookup_èbÀ
 *
ldns_lookup_by_id
÷dns_lookup_èbÀ 
èbÀ
[], 
id
);

187 
ldns_gë_bô
(
uöt8_t
 
bôs
[], 
size_t
 
ödex
);

198 
ldns_gë_bô_r
(
uöt8_t
 
bôs
[], 
size_t
 
ödex
);

210 
ldns_£t_bô
(
uöt8_t
 *
byã
, 
bô_ƒ
, 
boﬁ
 
vÆue
);

217 
INLINE
 

218 
ldns_powî
(
a
, 
b
) {

219 
ªsu…
 = 1;

220 
b
 > 0) {

221 i‡(
b
 & 1) {

222 
ªsu…
 *
a
;

223 i‡(
b
 == 1) {

224  
ªsu…
;

227 
a
 *=á;

228 
b
 /= 2;

230  
ªsu…
;

238 
ldns_hexdigô_to_öt
(
ch
);

245 
ldns_öt_to_hexdigô
(
ch
);

257 
ldns_hex°rög_to_d©a
(
uöt8_t
 *
d©a
, c⁄° *
°r
);

263 c⁄° * 
ldns_vîsi⁄
();

271 
time_t
 
ldns_mktime_‰om_utc
(c⁄° 
tm
 *tm);

273 
time_t
 
mktime_‰om_utc
(c⁄° 
tm
 *tm);

289 
tm
 * 
ldns_£rül_¨ôhmôics_gmtime_r
(
öt32_t
 
time
, 
time_t
 
now
, tm *
ªsu…
);

310 
ldns_öô_øndom
(
FILE
 *
fd
, 
size
);

317 
uöt16_t
 
ldns_gë_øndom
();

326 *
ldns_bubbÀbabbÀ
(
uöt8_t
 *
d©a
, 
size_t
 
Àn
);

329 
INLINE
 
time_t
 
ldns_time
—ime_à*
t
Ë{  
time
(t); }

336 
INLINE
 
size_t
 
ldns_b32_¡›_ˇlcuœã_size
(size_à
§c_d©a_Àngth
)

338  
§c_d©a_Àngth
 == 0 ? 0 : ((src_data_length - 1) / 5 + 1) * 8;

341 
INLINE
 
size_t
 
ldns_b32_¡›_ˇlcuœã_size_no_∑ddög
(size_à
§c_d©a_Àngth
)

343  ((
§c_d©a_Àngth
 + 3) * 8 / 5) - 4;

346 
ldns_b32_¡›
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

347 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

349 
ldns_b32_¡›_exãnded_hex
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

350 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

352 #i‡! 
LDNS_BUILD_CONFIG_HAVE_B32_NTOP


354 
b32_¡›
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

355 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

357 
b32_¡›_exãnded_hex
(c⁄° 
uöt8_t
* 
§c_d©a
, 
size_t
 
§c_d©a_Àngth
,

358 * 
èrgë_ãxt_buf„r
, 
size_t
 
èrgë_ãxt_buf„r_size
);

367 
INLINE
 
size_t
 
ldns_b32_±⁄_ˇlcuœã_size
(size_à
§c_ãxt_Àngth
)

369  
§c_ãxt_Àngth
 * 5 / 8;

372 
ldns_b32_±⁄
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

373 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

375 
ldns_b32_±⁄_exãnded_hex
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

376 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

378 #i‡! 
LDNS_BUILD_CONFIG_HAVE_B32_PTON


380 
b32_±⁄
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

381 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

383 
b32_±⁄_exãnded_hex
(c⁄° * 
§c_ãxt
, 
size_t
 
§c_ãxt_Àngth
,

384 
uöt8_t
* 
èrgë_d©a_buf„r
, 
size_t
 
èrgë_d©a_buf„r_size
);

389 #ifde‡
__˝lu•lus


	@ldns/wire2host.h

18 #i‚de‡
LDNS_WIRE2HOST_H


19 
	#LDNS_WIRE2HOST_H


	)

21 
	~<ldns/rd©a.h
>

22 
	~<ldns/comm⁄.h
>

23 
	~<ldns/îr‹.h
>

24 
	~<ldns/º.h
>

25 
	~<ldns/∑ckë.h
>

27 #ifde‡
__˝lu•lus


32 
	#LDNS_HEADER_SIZE
 12

	)

35 
	#LDNS_RD_MASK
 0x01U

	)

36 
	#LDNS_RD_SHIFT
 0

	)

37 
	#LDNS_RD_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_RD_MASK
)

	)

38 
	#LDNS_RD_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_RD_MASK
)

	)

39 
	#LDNS_RD_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_RD_MASK
)

	)

41 
	#LDNS_TC_MASK
 0x02U

	)

42 
	#LDNS_TC_SHIFT
 1

	)

43 
	#LDNS_TC_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_TC_MASK
)

	)

44 
	#LDNS_TC_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_TC_MASK
)

	)

45 
	#LDNS_TC_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_TC_MASK
)

	)

47 
	#LDNS_AA_MASK
 0x04U

	)

48 
	#LDNS_AA_SHIFT
 2

	)

49 
	#LDNS_AA_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_AA_MASK
)

	)

50 
	#LDNS_AA_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_AA_MASK
)

	)

51 
	#LDNS_AA_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_AA_MASK
)

	)

53 
	#LDNS_OPCODE_MASK
 0x78U

	)

54 
	#LDNS_OPCODE_SHIFT
 3

	)

55 
	#LDNS_OPCODE_WIRE
(
wúebuf
Ë((*(wúebuf+2Ë& 
LDNS_OPCODE_MASK
Ë>> 
LDNS_OPCODE_SHIFT
)

	)

56 
	#LDNS_OPCODE_SET
(
wúebuf
, 
›code
) \

57 (*(
wúebuf
+2Ë((*(wúebuf+2)Ë& ~
LDNS_OPCODE_MASK
Ë| ((
›code
Ë<< 
LDNS_OPCODE_SHIFT
))

	)

59 
	#LDNS_QR_MASK
 0x80U

	)

60 
	#LDNS_QR_SHIFT
 7

	)

61 
	#LDNS_QR_WIRE
(
wúebuf
Ë(*(wúebuf+2Ë& 
LDNS_QR_MASK
)

	)

62 
	#LDNS_QR_SET
(
wúebuf
Ë(*(wúebuf+2Ë|
LDNS_QR_MASK
)

	)

63 
	#LDNS_QR_CLR
(
wúebuf
Ë(*(wúebuf+2Ë&~
LDNS_QR_MASK
)

	)

66 
	#LDNS_RCODE_MASK
 0x0fU

	)

67 
	#LDNS_RCODE_SHIFT
 0

	)

68 
	#LDNS_RCODE_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_RCODE_MASK
)

	)

69 
	#LDNS_RCODE_SET
(
wúebuf
, 
rcode
) \

70 (*(
wúebuf
+3Ë((*(wúebuf+3)Ë& ~
LDNS_RCODE_MASK
Ë| (
rcode
))

	)

72 
	#LDNS_CD_MASK
 0x10U

	)

73 
	#LDNS_CD_SHIFT
 4

	)

74 
	#LDNS_CD_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_CD_MASK
)

	)

75 
	#LDNS_CD_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_CD_MASK
)

	)

76 
	#LDNS_CD_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_CD_MASK
)

	)

78 
	#LDNS_AD_MASK
 0x20U

	)

79 
	#LDNS_AD_SHIFT
 5

	)

80 
	#LDNS_AD_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_AD_MASK
)

	)

81 
	#LDNS_AD_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_AD_MASK
)

	)

82 
	#LDNS_AD_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_AD_MASK
)

	)

84 
	#LDNS_Z_MASK
 0x40U

	)

85 
	#LDNS_Z_SHIFT
 6

	)

86 
	#LDNS_Z_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_Z_MASK
)

	)

87 
	#LDNS_Z_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_Z_MASK
)

	)

88 
	#LDNS_Z_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_Z_MASK
)

	)

90 
	#LDNS_RA_MASK
 0x80U

	)

91 
	#LDNS_RA_SHIFT
 7

	)

92 
	#LDNS_RA_WIRE
(
wúebuf
Ë(*(wúebuf+3Ë& 
LDNS_RA_MASK
)

	)

93 
	#LDNS_RA_SET
(
wúebuf
Ë(*(wúebuf+3Ë|
LDNS_RA_MASK
)

	)

94 
	#LDNS_RA_CLR
(
wúebuf
Ë(*(wúebuf+3Ë&~
LDNS_RA_MASK
)

	)

97 
	#LDNS_ID_WIRE
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf))

	)

98 
	#LDNS_ID_SET
(
wúebuf
, 
id
Ë(
	`ldns_wrôe_uöt16
(wúebuf, id))

	)

101 
	#LDNS_QDCOUNT_OFF
 4

	)

105 
	#LDNS_QDCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_QDCOUNT_OFF
))

	)

108 
	#LDNS_ANCOUNT_OFF
 6

	)

109 
	#LDNS_ANCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_ANCOUNT_OFF
))

	)

112 
	#LDNS_NSCOUNT_OFF
 8

	)

113 
	#LDNS_NSCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_NSCOUNT_OFF
))

	)

116 
	#LDNS_ARCOUNT_OFF
 10

	)

117 
	#LDNS_ARCOUNT
(
wúebuf
Ë(
	`ldns_ªad_uöt16
(wúebuf+
LDNS_ARCOUNT_OFF
))

	)

129 
ldns_°©us
 
ldns_wúe2pkt
(
ldns_pkt
 **
∑ckë
, c⁄° 
uöt8_t
 *
d©a
, 
size_t
 
Àn
);

140 
ldns_°©us
 
ldns_buf„r2pkt_wúe
(
ldns_pkt
 **
∑ckë
, 
ldns_buf„r
 *
buf„r
);

155 
ldns_°©us
 
ldns_wúe2d«me
(
ldns_rdf
 **
d«me
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
);

174 
ldns_°©us
 
ldns_wúe2rdf
(
ldns_º
 *
º
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
);

191 
ldns_°©us
 
ldns_wúe2º
(
ldns_º
 **
º
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
);

193 #ifde‡
__˝lu•lus


	@ldns/zone.h

23 #i‚de‡
LDNS_ZONE_H


24 
	#LDNS_ZONE_H


	)

26 
	~<ldns/comm⁄.h
>

27 
	~<ldns/rd©a.h
>

28 
	~<ldns/º.h
>

29 
	~<ldns/îr‹.h
>

31 #ifde‡
__˝lu•lus


42 
	sldns_°ru˘_z⁄e


45 
ldns_º
 *
_sﬂ
;

47 
ldns_º_li°
 *
_ºs
;

50 
ldns_°ru˘_z⁄e
 
	tldns_z⁄e
;

56 
ldns_z⁄e
 * 
ldns_z⁄e_√w
();

63 
ldns_º
 * 
ldns_z⁄e_sﬂ
(c⁄° 
ldns_z⁄e
 *
z
);

70 
size_t
 
ldns_z⁄e_º_cou¡
(c⁄° 
ldns_z⁄e
 *
z
);

77 
ldns_z⁄e_£t_sﬂ
(
ldns_z⁄e
 *
z
, 
ldns_º
 *
sﬂ
);

86 
ldns_º_li°
 * 
ldns_z⁄e_ºs
(c⁄° 
ldns_z⁄e
 *
z
);

93 
ldns_z⁄e_£t_ºs
(
ldns_z⁄e
 *
z
, 
ldns_º_li°
 *
ºli°
);

102 
boﬁ
 
ldns_z⁄e_push_º_li°
(
ldns_z⁄e
 *
z
, 
ldns_º_li°
 *
li°
);

111 
boﬁ
 
ldns_z⁄e_push_º
(
ldns_z⁄e
 *
z
, 
ldns_º
 *
º
);

126 
ldns_º_li°
 *
ldns_z⁄e_glue_º_li°
(c⁄° 
ldns_z⁄e
 *
z
);

138 
ldns_°©us
 
ldns_z⁄e_√w_‰m_Â
(
ldns_z⁄e
 **
z
, 
FILE
 *
Â
, 
ldns_rdf
 *
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
);

151 
ldns_°©us
 
ldns_z⁄e_√w_‰m_Â_l
(
ldns_z⁄e
 **
z
, 
FILE
 *
Â
, 
ldns_rdf
 *
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
, *
löe_ƒ
);

157 
ldns_z⁄e_‰ì
(
ldns_z⁄e
 *
z⁄e
);

164 
ldns_z⁄e_dìp_‰ì
(
ldns_z⁄e
 *
z⁄e
);

170 
ldns_z⁄e_s‹t
(
ldns_z⁄e
 *
z⁄e
);

172 #ifde‡
__˝lu•lus


	@linktest.c

2 
	~"ldns/c⁄fig.h
"

3 
	~<ldns/ldns.h
>

6 
	$maö
()

8 
ldns_º
 *
º
 = 
	`ldns_º_√w
();

10 
	`ldns_º_‰ì
(
º
);

12 
	}
}

	@net.c

14 
	~<ldns/c⁄fig.h
>

16 
	~<ldns/ldns.h
>

18 #ifde‡
HAVE_NETINET_IN_H


19 
	~<√töë/ö.h
>

21 #ifde‡
HAVE_SYS_SOCKET_H


22 
	~<sys/sockë.h
>

24 #ifde‡
HAVE_NETDB_H


25 
	~<√tdb.h
>

27 #ifde‡
HAVE_ARPA_INET_H


28 
	~<¨∑/öë.h
>

30 
	~<sys/time.h
>

31 
	~<î∫o.h
>

32 
	~<f˙é.h
>

34 
ldns_°©us


35 
	$ldns_£nd
(
ldns_pkt
 **
ªsu…_∑ckë
, 
ldns_ªsﬁvî
 *
r
, c⁄°Üdns_pkà*
quîy_pkt
)

37 
ldns_buf„r
 *
qb
;

38 
ldns_°©us
 
ªsu…
;

39 
ldns_rdf
 *
tsig_mac
 = 
NULL
;

41 
qb
 = 
	`ldns_buf„r_√w
(
LDNS_MIN_BUFLEN
);

43 i‡(
quîy_pkt
 && 
	`ldns_pkt_tsig
(query_pkt)) {

44 
tsig_mac
 = 
	`ldns_º_rdf
(
	`ldns_pkt_tsig
(
quîy_pkt
), 3);

47 i‡(!
quîy_pkt
 ||

48 
	`ldns_pkt2buf„r_wúe
(
qb
, 
quîy_pkt
Ë!
LDNS_STATUS_OK
) {

49 
ªsu…
 = 
LDNS_STATUS_ERR
;

51 
ªsu…
 = 
	`ldns_£nd_buf„r
(
ªsu…_∑ckë
, 
r
, 
qb
, 
tsig_mac
);

54 
	`ldns_buf„r_‰ì
(
qb
);

56  
ªsu…
;

57 
	}
}

60 
sockaddr_°‹age
 *

61 
	$ldns_rdf2«tive_sockaddr_°‹age_p‹t
(

62 c⁄° 
ldns_rdf
 *
rd
, 
uöt16_t
 
p‹t
, 
size_t
 *
size
)

64 
sockaddr_°‹age
 *
d©a
;

65 
sockaddr_ö
 *
d©a_ö
;

66 
sockaddr_ö6
 *
d©a_ö6
;

68 
d©a
 = 
	`LDNS_MALLOC
(
sockaddr_°‹age
);

69 i‡(!
d©a
) {

70  
NULL
;

73 
	`mem£t
(
d©a
, 0, (
sockaddr_°‹age
));

75 
	`ldns_rdf_gë_ty≥
(
rd
)) {

76 
LDNS_RDF_TYPE_A
:

77 #i‚de‡
S_SPLINT_S


78 
d©a
->
ss_Ámûy
 = 
AF_INET
;

80 
d©a_ö
 = (
sockaddr_ö
*Ë
d©a
;

81 
d©a_ö
->
sö_p‹t
 = (
ö_p‹t_t
)
	`ht⁄s
(
p‹t
);

82 
	`mem˝y
(&(
d©a_ö
->
sö_addr
), 
	`ldns_rdf_d©a
(
rd
), 
	`ldns_rdf_size
(rd));

83 *
size
 = (
sockaddr_ö
);

84  
d©a
;

85 
LDNS_RDF_TYPE_AAAA
:

86 #i‚de‡
S_SPLINT_S


87 
d©a
->
ss_Ámûy
 = 
AF_INET6
;

89 
d©a_ö6
 = (
sockaddr_ö6
*Ë
d©a
;

90 
d©a_ö6
->
sö6_p‹t
 = (
ö_p‹t_t
)
	`ht⁄s
(
p‹t
);

91 
	`mem˝y
(&
d©a_ö6
->
sö6_addr
, 
	`ldns_rdf_d©a
(
rd
), 
	`ldns_rdf_size
(rd));

92 *
size
 = (
sockaddr_ö6
);

93  
d©a
;

95 
	`LDNS_FREE
(
d©a
);

96  
NULL
;

98 
	}
}

100 
sockaddr_°‹age
 *

101 
	$ldns_rdf2«tive_sockaddr_°‹age
(

102 c⁄° 
ldns_rdf
 *
rd
, 
uöt16_t
 
p‹t
, 
size_t
 *
size
)

104  
	`ldns_rdf2«tive_sockaddr_°‹age_p‹t
(

105 
rd
, (
p‹t
 =0 ? (
uöt16_t
)
LDNS_PORT
 :Ö‹t), 
size
);

106 
	}
}

110 
	$ldns_sock_n⁄block
(
sockfd
)

112 #ifde‡
HAVE_FCNTL


113 
Êag
;

114 if((
Êag
 = 
	`f˙é
(
sockfd
, 
F_GETFL
)) != -1) {

115 
Êag
 |
O_NONBLOCK
;

116 if(
	`f˙é
(
sockfd
, 
F_SETFL
, 
Êag
) == -1) {

120 #ñi‡
	`deföed
(
HAVE_IOCTLSOCKET
)

121 
⁄
 = 1;

122 if(
	`io˘lsockë
(
sockfd
, 
FIONBIO
, &
⁄
) != 0) {

126 
	}
}

130 
	$ldns_sock_block
(
sockfd
)

132 #ifde‡
HAVE_FCNTL


133 
Êag
;

134 if((
Êag
 = 
	`f˙é
(
sockfd
, 
F_GETFL
)) != -1) {

135 
Êag
 &~
O_NONBLOCK
;

136 if(
	`f˙é
(
sockfd
, 
F_SETFL
, 
Êag
) == -1) {

140 #ñi‡
	`deföed
(
HAVE_IOCTLSOCKET
)

141 
off
 = 0;

142 if(
	`io˘lsockë
(
sockfd
, 
FIONBIO
, &
off
) != 0) {

146 
	}
}

150 
	$ldns_sock_waô
(
sockfd
, 
timevÆ
 
timeout
, 
wrôe
)

152 
ªt
;

153 #i‚de‡
S_SPLINT_S


154 
fd_£t
 
fds
;

155 
	`FD_ZERO
(&
fds
);

156 
	`FD_SET
(
FD_SET_T
 
sockfd
, &
fds
);

157 if(
wrôe
)

158 
ªt
 = 
	`£À˘
(
sockfd
+1, 
NULL
, &
fds
, NULL, &
timeout
);

160 
ªt
 = 
	`£À˘
(
sockfd
+1, &
fds
, 
NULL
, NULL, &
timeout
);

162 if(
ªt
 == 0)

165 if(
ªt
 == -1)

169 
	}
}

173 
	$ldns_t˝_c⁄√˘_‰om
(c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

174 c⁄° 
sockaddr_°‹age
 *
‰om
, 
sockÀn_t
 
‰omÀn
,

175 
timevÆ
 
timeout
)

177 
sockfd
;

179 #i‚de‡
S_SPLINT_S


180 i‡((
sockfd
 = 
	`sockë
(()((
sockaddr
*)
to
)->
ß_Ámûy
, 
SOCK_STREAM
,

181 
IPPROTO_TCP
)) == -1) {

185 i‡(
‰om
 && 
	`böd
(
sockfd
, (c⁄° 
sockaddr
*)‰om, 
‰omÀn
) == -1){

190 
	`ldns_sock_n⁄block
(
sockfd
);

191 i‡(
	`c⁄√˘
(
sockfd
, (
sockaddr
*)
to
, 
tﬁí
) == -1) {

192 #i‚de‡
USE_WINSOCK


193 #ifde‡
EINPROGRESS


194 if(
î∫o
 !
EINPROGRESS
) {

198 
	`˛o£
(
sockfd
);

202 if(
	`WSAGëLa°Eº‹
(Ë!
WSAEINPROGRESS
 &&

203 
	`WSAGëLa°Eº‹
(Ë!
WSAEWOULDBLOCK
) {

204 
	`˛o£sockë
(
sockfd
);

213 
îr‹
 = 0;

214 
sockÀn_t
 
Àn
 = (sockÀn_t)(
îr‹
);

216 if(!
	`ldns_sock_waô
(
sockfd
, 
timeout
, 1)) {

217 #i‚de‡
USE_WINSOCK


218 
	`˛o£
(
sockfd
);

220 
	`˛o£sockë
(
sockfd
);

226 if(
	`gësock›t
(
sockfd
, 
SOL_SOCKET
, 
SO_ERROR
, (*)&
îr‹
,

227 &
Àn
) < 0) {

228 #i‚de‡
USE_WINSOCK


229 
îr‹
 = 
î∫o
;

231 
îr‹
 = 
	`WSAGëLa°Eº‹
();

234 #i‚de‡
USE_WINSOCK


235 #i‡
	`deföed
(
EINPROGRESS
Ë&& deföed(
EWOULDBLOCK
)

236 if(
îr‹
 =
EINPROGRESS
 ||Éº‹ =
EWOULDBLOCK
)

239 if(
îr‹
 != 0) {

240 
	`˛o£
(
sockfd
);

242 
î∫o
 = 
îr‹
;

246 if(
îr‹
 =
WSAEINPROGRESS
)

248 if(
îr‹
 =
WSAEWOULDBLOCK
)

250 if(
îr‹
 != 0) {

251 
	`˛o£sockë
(
sockfd
);

252 
î∫o
 = 
îr‹
;

261 
	`ldns_sock_block
(
sockfd
);

263  
sockfd
;

264 
	}
}

267 
	$ldns_t˝_c⁄√˘
(c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

268 
timevÆ
 
timeout
)

270  
	`ldns_t˝_c⁄√˘_‰om
(
to
, 
tﬁí
, 
NULL
, 0, 
timeout
);

271 
	}
}

274 
	$ldns_t˝_bg£nd_‰om
(
ldns_buf„r
 *
qbö
,

275 c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

276 c⁄° 
sockaddr_°‹age
 *
‰om
, 
sockÀn_t
 
‰omÀn
,

277 
timevÆ
 
timeout
)

279 
sockfd
;

281 
sockfd
 = 
	`ldns_t˝_c⁄√˘_‰om
(
to
, 
tﬁí
, 
‰om
, 
‰omÀn
, 
timeout
);

283 i‡(
sockfd
 == 0) {

287 i‡(
	`ldns_t˝_£nd_quîy
(
qbö
, 
sockfd
, 
to
, 
tﬁí
) == 0) {

288 #i‚de‡
USE_WINSOCK


289 
	`˛o£
(
sockfd
);

291 
	`˛o£sockë
(
sockfd
);

296  
sockfd
;

297 
	}
}

300 
	$ldns_t˝_bg£nd
(
ldns_buf„r
 *
qbö
,

301 c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

302 
timevÆ
 
timeout
)

304  
	`ldns_t˝_bg£nd_‰om
(
qbö
, 
to
, 
tﬁí
, 
NULL
, 0, 
timeout
);

305 
	}
}

311 
ldns_°©us


312 
	$ldns_t˝_£nd_‰om
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
,

313 c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

314 c⁄° 
sockaddr_°‹age
 *
‰om
, 
sockÀn_t
 
‰omÀn
,

315 
timevÆ
 
timeout
, 
size_t
 *
™swî_size
)

317 
sockfd
;

318 
uöt8_t
 *
™swî
;

320 
sockfd
 = 
	`ldns_t˝_bg£nd_‰om
(
qbö
, 
to
, 
tﬁí
, 
‰om
, 
‰omÀn
, 
timeout
);

322 i‡(
sockfd
 == 0) {

323  
LDNS_STATUS_ERR
;

326 
™swî
 = 
	`ldns_t˝_ªad_wúe_timeout
(
sockfd
, 
™swî_size
, 
timeout
);

327 #i‚de‡
USE_WINSOCK


328 
	`˛o£
(
sockfd
);

330 
	`˛o£sockë
(
sockfd
);

333 i‡(*
™swî_size
 == 0) {

335  
LDNS_STATUS_NETWORK_ERR
;

339 *
ªsu…
 = 
	`LDNS_XREALLOC
(
™swî
, 
uöt8_t
, (
size_t
)*
™swî_size
);

340 if(!*
ªsu…
) {

341 
	`LDNS_FREE
(
™swî
);

342  
LDNS_STATUS_MEM_ERR
;

344  
LDNS_STATUS_OK
;

345 
	}
}

347 
ldns_°©us


348 
	$ldns_t˝_£nd
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
,

349 c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
,

350 
timevÆ
 
timeout
, 
size_t
 *
™swî_size
)

352  
	`ldns_t˝_£nd_‰om
(
ªsu…
, 
qbö
,

353 
to
, 
tﬁí
, 
NULL
, 0, 
timeout
, 
™swî_size
);

354 
	}
}

357 
ldns_udp_c⁄√˘
(c⁄° 
sockaddr_°‹age
 *
to
, 
timevÆ
 
	$ATTR_UNUSED
(
timeout
))

359 
sockfd
;

361 #i‚de‡
S_SPLINT_S


362 i‡((
sockfd
 = 
	`sockë
(()((
sockaddr
*)
to
)->
ß_Ámûy
, 
SOCK_DGRAM
,

363 
IPPROTO_UDP
))

368  
sockfd
;

369 
	}
}

372 
	$ldns_udp_bg£nd_‰om
(
ldns_buf„r
 *
qbö
,

373 c⁄° 
sockaddr_°‹age
 *
to
 , 
sockÀn_t
 
tﬁí
,

374 c⁄° 
sockaddr_°‹age
 *
‰om
, 
sockÀn_t
 
‰omÀn
,

375 
timevÆ
 
timeout
)

377 
sockfd
;

379 
sockfd
 = 
	`ldns_udp_c⁄√˘
(
to
, 
timeout
);

381 i‡(
sockfd
 == 0) {

385 i‡(
‰om
 && 
	`böd
(
sockfd
, (c⁄° 
sockaddr
*)‰om, 
‰omÀn
) == -1){

389 i‡(
	`ldns_udp_£nd_quîy
(
qbö
, 
sockfd
, 
to
, 
tﬁí
) == 0) {

390 #i‚de‡
USE_WINSOCK


391 
	`˛o£
(
sockfd
);

393 
	`˛o£sockë
(
sockfd
);

397  
sockfd
;

398 
	}
}

401 
	$ldns_udp_bg£nd
(
ldns_buf„r
 *
qbö
,

402 c⁄° 
sockaddr_°‹age
 *
to
 , 
sockÀn_t
 
tﬁí
,

403 
timevÆ
 
timeout
)

405  
	`ldns_udp_bg£nd_‰om
(
qbö
, 
to
, 
tﬁí
, 
NULL
, 0, 
timeout
);

406 
	}
}

408 
ldns_°©us


409 
	$ldns_udp_£nd_‰om
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
,

410 c⁄° 
sockaddr_°‹age
 *
to
 , 
sockÀn_t
 
tﬁí
,

411 c⁄° 
sockaddr_°‹age
 *
‰om
, 
sockÀn_t
 
‰omÀn
,

412 
timevÆ
 
timeout
, 
size_t
 *
™swî_size
)

414 
sockfd
;

415 
uöt8_t
 *
™swî
;

417 
sockfd
 = 
	`ldns_udp_bg£nd_‰om
(
qbö
, 
to
, 
tﬁí
, 
‰om
, 
‰omÀn
, 
timeout
);

419 i‡(
sockfd
 == 0) {

420  
LDNS_STATUS_SOCKET_ERROR
;

424 if(!
	`ldns_sock_waô
(
sockfd
, 
timeout
, 0)) {

425 #i‚de‡
USE_WINSOCK


426 
	`˛o£
(
sockfd
);

428 
	`˛o£sockë
(
sockfd
);

430  
LDNS_STATUS_NETWORK_ERR
;

436 
	`ldns_sock_n⁄block
(
sockfd
);

438 
™swî
 = 
	`ldns_udp_ªad_wúe
(
sockfd
, 
™swî_size
, 
NULL
, NULL);

439 #i‚de‡
USE_WINSOCK


440 
	`˛o£
(
sockfd
);

442 
	`˛o£sockë
(
sockfd
);

445 i‡(*
™swî_size
 == 0) {

447  
LDNS_STATUS_NETWORK_ERR
;

450 *
ªsu…
 = 
™swî
;

451  
LDNS_STATUS_OK
;

452 
	}
}

454 
ldns_°©us


455 
	$ldns_udp_£nd
(
uöt8_t
 **
ªsu…
, 
ldns_buf„r
 *
qbö
,

456 c⁄° 
sockaddr_°‹age
 *
to
 , 
sockÀn_t
 
tﬁí
,

457 
timevÆ
 
timeout
, 
size_t
 *
™swî_size
)

459  
	`ldns_udp_£nd_‰om
(
ªsu…
, 
qbö
, 
to
, 
tﬁí
, 
NULL
, 0,

460 
timeout
, 
™swî_size
);

461 
	}
}

463 
ldns_°©us


464 
	$ldns_£nd_buf„r
(
ldns_pkt
 **
ªsu…
, 
ldns_ªsﬁvî
 *
r
, 
ldns_buf„r
 *
qb
, 
ldns_rdf
 *
tsig_mac
)

466 
uöt8_t
 
i
;

468 
sockaddr_°‹age
 *
§c
 = 
NULL
;

469 
size_t
 
§c_Àn
;

470 
sockaddr_°‹age
 *
ns
;

471 
size_t
 
ns_Àn
;

472 
timevÆ
 
tv_s
;

473 
timevÆ
 
tv_e
;

475 
ldns_rdf
 **
ns_¨øy
;

476 
size_t
 *
πt
;

477 
ldns_pkt
 *
ª∂y
;

478 
boﬁ
 
Æl_£rvîs_πt_öf
;

479 
uöt8_t
 
ªåõs
;

481 
uöt8_t
 *
ª∂y_byãs
 = 
NULL
;

482 
size_t
 
ª∂y_size
 = 0;

483 
ldns_°©us
 
°©us
, 
£nd_°©us
;

485 
	`as£π
(
r
 !
NULL
);

487 
°©us
 = 
LDNS_STATUS_OK
;

488 
πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

489 
ns_¨øy
 = 
	`ldns_ªsﬁvî_«me£rvîs
(
r
);

490 
ª∂y
 = 
NULL
;

491 
ns_Àn
 = 0;

493 
Æl_£rvîs_πt_öf
 = 
åue
;

495 i‡(
	`ldns_ªsﬁvî_øndom
(
r
)) {

496 
	`ldns_ªsﬁvî_«me£rvîs_øndomize
(
r
);

499 if(
	`ldns_ªsﬁvî_sour˚
(
r
)) {

500 
§c
 = 
	`ldns_rdf2«tive_sockaddr_°‹age_p‹t
(

501 
	`ldns_ªsﬁvî_sour˚
(
r
), 0, &
§c_Àn
);

505 
i
 = 0; i < 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
); i++) {

506 i‡(
πt
[
i
] =
LDNS_RESOLV_RTT_INF
) {

516 
ns
 = 
	`ldns_rdf2«tive_sockaddr_°‹age
(
ns_¨øy
[
i
],

517 
	`ldns_ªsﬁvî_p‹t
(
r
), &
ns_Àn
);

520 #i‚de‡
S_SPLINT_S


521 i‡((
ns
->
ss_Ámûy
 =
AF_INET
) &&

522 (
	`ldns_ªsﬁvî_ù6
(
r
Ë=
LDNS_RESOLV_INET6
)) {

524 
	`LDNS_FREE
(
ns
);

528 i‡((
ns
->
ss_Ámûy
 =
AF_INET6
) &&

529 (
	`ldns_ªsﬁvî_ù6
(
r
Ë=
LDNS_RESOLV_INET
)) {

531 
	`LDNS_FREE
(
ns
);

536 
Æl_£rvîs_πt_öf
 = 
Ál£
;

538 
	`gëtimeofday
(&
tv_s
, 
NULL
);

540 
£nd_°©us
 = 
LDNS_STATUS_ERR
;

543 i‡(
	`ldns_ªsﬁvî_u£vc
(
r
)) {

544 
ªåõs
 = 
	`ldns_ªsﬁvî_ªåy
(
r
);Ñetries > 0;Ñetries--) {

545 
£nd_°©us
 =

546 
	`ldns_t˝_£nd_‰om
(&
ª∂y_byãs
, 
qb
,

547 
ns
, (
sockÀn_t
)
ns_Àn
,

548 
§c
, (
sockÀn_t
)
§c_Àn
,

549 
	`ldns_ªsﬁvî_timeout
(
r
),

550 &
ª∂y_size
);

551 i‡(
£nd_°©us
 =
LDNS_STATUS_OK
) {

556 
ªåõs
 = 
	`ldns_ªsﬁvî_ªåy
(
r
);Ñetries > 0;Ñetries--) {

558 
£nd_°©us
 =

559 
	`ldns_udp_£nd_‰om
(&
ª∂y_byãs
, 
qb
,

560 
ns
, (
sockÀn_t
)
ns_Àn
,

561 
§c
, (
sockÀn_t
)
§c_Àn
,

562 
	`ldns_ªsﬁvî_timeout
(
r
),

563 &
ª∂y_size
);

564 i‡(
£nd_°©us
 =
LDNS_STATUS_OK
) {

570 i‡(
£nd_°©us
 !
LDNS_STATUS_OK
) {

571 
	`ldns_ªsﬁvî_£t_«me£rvî_πt
(
r
, 
i
, 
LDNS_RESOLV_RTT_INF
);

572 
°©us
 = 
£nd_°©us
;

576 i‡(!
ª∂y_byãs
) {

578 i‡(
	`ldns_ªsﬁvî_Áû
(
r
)) {

579 
	`LDNS_FREE
(
ns
);

580  
LDNS_STATUS_ERR
;

582 
	`LDNS_FREE
(
ns
);

587 
°©us
 = 
	`ldns_wúe2pkt
(&
ª∂y
, 
ª∂y_byãs
, 
ª∂y_size
);

588 i‡(
°©us
 !
LDNS_STATUS_OK
) {

589 
	`LDNS_FREE
(
ª∂y_byãs
);

590 
	`LDNS_FREE
(
ns
);

591  
°©us
;

594 
	`LDNS_FREE
(
ns
);

595 
	`gëtimeofday
(&
tv_e
, 
NULL
);

597 i‡(
ª∂y
) {

598 
	`ldns_pkt_£t_quîytime
(
ª∂y
, (
uöt32_t
)

599 ((
tv_e
.
tv_£c
 - 
tv_s
.tv_sec) * 1000) +

600 (
tv_e
.
tv_u£c
 - 
tv_s
.tv_usec) / 1000);

601 
	`ldns_pkt_£t_™swî‰om
(
ª∂y
,

602 
	`ldns_rdf_˛⁄e
(
ns_¨øy
[
i
]));

603 
	`ldns_pkt_£t_time°amp
(
ª∂y
, 
tv_s
);

604 
	`ldns_pkt_£t_size
(
ª∂y
, 
ª∂y_size
);

607 i‡(
	`ldns_ªsﬁvî_Áû
(
r
)) {

615 
	`¶ìp
((Ë
	`ldns_ªsﬁvî_ªå™s
(
r
));

618 if(
§c
) {

619 
	`LDNS_FREE
(
§c
);

621 i‡(
Æl_£rvîs_πt_öf
) {

622 
	`LDNS_FREE
(
ª∂y_byãs
);

623  
LDNS_STATUS_RES_NO_NS
;

625 #ifde‡
HAVE_SSL


626 i‡(
tsig_mac
 && 
ª∂y
 && 
ª∂y_byãs
) {

627 i‡(!
	`ldns_pkt_tsig_vîify
(
ª∂y
,

628 
ª∂y_byãs
,

629 
ª∂y_size
,

630 
	`ldns_ªsﬁvî_tsig_key«me
(
r
),

631 
	`ldns_ªsﬁvî_tsig_keyd©a
(
r
), 
tsig_mac
)) {

632 
°©us
 = 
LDNS_STATUS_CRYPTO_TSIG_BOGUS
;

636 ()
tsig_mac
;

639 
	`LDNS_FREE
(
ª∂y_byãs
);

640 i‡(
ªsu…
) {

641 *
ªsu…
 = 
ª∂y
;

644  
°©us
;

645 
	}
}

647 
ssize_t


648 
	$ldns_t˝_£nd_quîy
(
ldns_buf„r
 *
qbö
, 
sockfd
,

649 c⁄° 
sockaddr_°‹age
 *
to
, 
sockÀn_t
 
tﬁí
)

651 
uöt8_t
 *
£ndbuf
;

652 
ssize_t
 
byãs
;

655 
£ndbuf
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
	`ldns_buf„r_posôi⁄
(
qbö
) + 2);

656 if(!
£ndbuf
)  0;

657 
	`ldns_wrôe_uöt16
(
£ndbuf
, 
	`ldns_buf„r_posôi⁄
(
qbö
));

658 
	`mem˝y
(
£ndbuf
 + 2, 
	`ldns_buf„r_begö
(
qbö
), 
	`ldns_buf„r_posôi⁄
(qbin));

660 
byãs
 = 
	`£ndto
(
sockfd
, (*)
£ndbuf
,

661 
	`ldns_buf„r_posôi⁄
(
qbö
Ë+ 2, 0, (
sockaddr
 *)
to
, 
tﬁí
);

663 
	`LDNS_FREE
(
£ndbuf
);

665 i‡(
byãs
 =-1 || (
size_t
Ëbyã†!
	`ldns_buf„r_posôi⁄
(
qbö
) + 2 ) {

668  
byãs
;

669 
	}
}

672 
ssize_t


673 
	$ldns_udp_£nd_quîy
(
ldns_buf„r
 *
qbö
, 
sockfd
, c⁄° 
sockaddr_°‹age
 *
to
,

674 
sockÀn_t
 
tﬁí
)

676 
ssize_t
 
byãs
;

678 
byãs
 = 
	`£ndto
(
sockfd
, (*)
	`ldns_buf„r_begö
(
qbö
),

679 
	`ldns_buf„r_posôi⁄
(
qbö
), 0, (
sockaddr
 *)
to
, 
tﬁí
);

681 i‡(
byãs
 =-1 || (
size_t
)byã†!
	`ldns_buf„r_posôi⁄
(
qbö
)) {

684 i‡((
size_t
Ë
byãs
 !
	`ldns_buf„r_posôi⁄
(
qbö
)) {

687  
byãs
;

688 
	}
}

690 
uöt8_t
 *

691 
	$ldns_udp_ªad_wúe
(
sockfd
, 
size_t
 *
size
, 
sockaddr_°‹age
 *
‰om
,

692 
sockÀn_t
 *
‰omÀn
)

694 
uöt8_t
 *
wúe
, *
wúeout
;

695 
ssize_t
 
wúe_size
;

697 
wúe
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
LDNS_MAX_PACKETLEN
);

698 i‡(!
wúe
) {

699 *
size
 = 0;

700  
NULL
;

703 
wúe_size
 = 
	`ªcv‰om
(
sockfd
, (*)
wúe
, 
LDNS_MAX_PACKETLEN
, 0,

704 (
sockaddr
 *)
‰om
, 
‰omÀn
);

707 i‡(
wúe_size
 == -1 || wire_size == 0) {

708 *
size
 = 0;

709 
	`LDNS_FREE
(
wúe
);

710  
NULL
;

713 *
size
 = (
size_t
)
wúe_size
;

714 
wúeout
 = 
	`LDNS_XREALLOC
(
wúe
, 
uöt8_t
, (
size_t
)
wúe_size
);

715 if(!
wúeout
Ë
	`LDNS_FREE
(
wúe
);

717  
wúeout
;

718 
	}
}

720 
uöt8_t
 *

721 
	$ldns_t˝_ªad_wúe_timeout
(
sockfd
, 
size_t
 *
size
, 
timevÆ
 
timeout
)

723 
uöt8_t
 *
wúe
;

724 
uöt16_t
 
wúe_size
;

725 
ssize_t
 
byãs
 = 0, 
rc
 = 0;

727 
wúe
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 2);

728 i‡(!
wúe
) {

729 *
size
 = 0;

730  
NULL
;

733 
byãs
 < 2) {

734 if(!
	`ldns_sock_waô
(
sockfd
, 
timeout
, 0)) {

735 *
size
 = 0;

736 
	`LDNS_FREE
(
wúe
);

737  
NULL
;

739 
rc
 = 
	`ªcv
(
sockfd
, (*Ë(
wúe
 + 
byãs
),

740 (
size_t
Ë(2 - 
byãs
), 0);

741 i‡(
rc
 == -1 ||Ñc == 0) {

742 *
size
 = 0;

743 
	`LDNS_FREE
(
wúe
);

744  
NULL
;

746 
byãs
 +
rc
;

749 
wúe_size
 = 
	`ldns_ªad_uöt16
(
wúe
);

751 
	`LDNS_FREE
(
wúe
);

752 
wúe
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
wúe_size
);

753 i‡(!
wúe
) {

754 *
size
 = 0;

755  
NULL
;

757 
byãs
 = 0;

759 
byãs
 < (
ssize_t
Ë
wúe_size
) {

760 if(!
	`ldns_sock_waô
(
sockfd
, 
timeout
, 0)) {

761 *
size
 = 0;

762 
	`LDNS_FREE
(
wúe
);

763  
NULL
;

765 
rc
 = 
	`ªcv
(
sockfd
, (*Ë(
wúe
 + 
byãs
),

766 (
size_t
Ë(
wúe_size
 - 
byãs
), 0);

767 i‡(
rc
 == -1 ||Ñc == 0) {

768 
	`LDNS_FREE
(
wúe
);

769 *
size
 = 0;

770  
NULL
;

772 
byãs
 +
rc
;

775 *
size
 = (
size_t
Ë
byãs
;

776  
wúe
;

777 
	}
}

779 
uöt8_t
 *

780 
	$ldns_t˝_ªad_wúe
(
sockfd
, 
size_t
 *
size
)

782 
uöt8_t
 *
wúe
;

783 
uöt16_t
 
wúe_size
;

784 
ssize_t
 
byãs
 = 0, 
rc
 = 0;

786 
wúe
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 2);

787 i‡(!
wúe
) {

788 *
size
 = 0;

789  
NULL
;

792 
byãs
 < 2) {

793 
rc
 = 
	`ªcv
(
sockfd
, (*Ë(
wúe
 + 
byãs
),

794 (
size_t
Ë(2 - 
byãs
), 0);

795 i‡(
rc
 == -1 ||Ñc == 0) {

796 *
size
 = 0;

797 
	`LDNS_FREE
(
wúe
);

798  
NULL
;

800 
byãs
 +
rc
;

803 
wúe_size
 = 
	`ldns_ªad_uöt16
(
wúe
);

805 
	`LDNS_FREE
(
wúe
);

806 
wúe
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
wúe_size
);

807 i‡(!
wúe
) {

808 *
size
 = 0;

809  
NULL
;

811 
byãs
 = 0;

813 
byãs
 < (
ssize_t
Ë
wúe_size
) {

814 
rc
 = 
	`ªcv
(
sockfd
, (*Ë(
wúe
 + 
byãs
),

815 (
size_t
Ë(
wúe_size
 - 
byãs
), 0);

816 i‡(
rc
 == -1 ||Ñc == 0) {

817 
	`LDNS_FREE
(
wúe
);

818 *
size
 = 0;

819  
NULL
;

821 
byãs
 +
rc
;

824 *
size
 = (
size_t
Ë
byãs
;

825  
wúe
;

826 
	}
}

828 #i‚de‡
S_SPLINT_S


829 
ldns_rdf
 *

830 
	$ldns_sockaddr_°‹age2rdf
(
sockaddr_°‹age
 *
sock
, 
uöt16_t
 *
p‹t
)

832 
ldns_rdf
 *
addr
;

833 
sockaddr_ö
 *
d©a_ö
;

834 
sockaddr_ö6
 *
d©a_ö6
;

836 
sock
->
ss_Ámûy
) {

837 
AF_INET
:

838 
d©a_ö
 = (
sockaddr_ö
*)
sock
;

839 i‡(
p‹t
) {

840 *
p‹t
 = 
	`¡ohs
((
uöt16_t
)
d©a_ö
->
sö_p‹t
);

842 
addr
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_A
,

843 
LDNS_IP4ADDRLEN
, &
d©a_ö
->
sö_addr
);

845 
AF_INET6
:

846 
d©a_ö6
 = (
sockaddr_ö6
*)
sock
;

847 i‡(
p‹t
) {

848 *
p‹t
 = 
	`¡ohs
((
uöt16_t
)
d©a_ö6
->
sö6_p‹t
);

850 
addr
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_AAAA
,

851 
LDNS_IP6ADDRLEN
, &
d©a_ö6
->
sö6_addr
);

854 i‡(
p‹t
) {

855 *
p‹t
 = 0;

857  
NULL
;

859  
addr
;

860 
	}
}

864 
ldns_°©us


865 
	$ldns_ax‰_°¨t
(
ldns_ªsﬁvî
 *
ªsﬁvî
, 
ldns_rdf
 *
domaö
, 
ldns_º_˛ass
 
˛ass
)

867 
ldns_pkt
 *
quîy
;

868 
ldns_buf„r
 *
quîy_wúe
;

870 
sockaddr_°‹age
 *
§c
 = 
NULL
;

871 
size_t
 
§c_Àn
 = 0;

872 
sockaddr_°‹age
 *
ns
 = 
NULL
;

873 
size_t
 
ns_Àn
 = 0;

874 
size_t
 
ns_i
;

875 
ldns_°©us
 
°©us
;

877 i‡(!
ªsﬁvî
 || 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(resolver) < 1) {

878  
LDNS_STATUS_ERR
;

881 
quîy
 = 
	`ldns_pkt_quîy_√w
(
	`ldns_rdf_˛⁄e
(
domaö
), 
LDNS_RR_TYPE_AXFR
, 
˛ass
, 0);

883 i‡(!
quîy
) {

884  
LDNS_STATUS_ADDRESS_ERR
;

886 if(
	`ldns_ªsﬁvî_sour˚
(
ªsﬁvî
)) {

887 
§c
 = 
	`ldns_rdf2«tive_sockaddr_°‹age_p‹t
(

888 
	`ldns_ªsﬁvî_sour˚
(
ªsﬁvî
), 0, &
§c_Àn
);

893 
ns_i
 = 0;

894 
ns_i
 < 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
ªsﬁvî
) &&

895 
ªsﬁvî
->
_sockë
 == 0;

896 
ns_i
++) {

897 i‡(
ns
 !
NULL
) {

898 
	`LDNS_FREE
(
ns
);

900 
ns
 = 
	`ldns_rdf2«tive_sockaddr_°‹age
(

901 
ªsﬁvî
->
_«me£rvîs
[
ns_i
],

902 
	`ldns_ªsﬁvî_p‹t
(
ªsﬁvî
), &
ns_Àn
);

904 
ªsﬁvî
->
_sockë
 = 
	`ldns_t˝_c⁄√˘_‰om
(

905 
ns
, (
sockÀn_t
)
ns_Àn
,

906 
§c
, (
sockÀn_t
)
§c_Àn
,

907 
	`ldns_ªsﬁvî_timeout
(
ªsﬁvî
));

910 i‡(
ªsﬁvî
->
_sockë
 == 0) {

911 
	`ldns_pkt_‰ì
(
quîy
);

912 
	`LDNS_FREE
(
ns
);

913  
LDNS_STATUS_NETWORK_ERR
;

916 #ifde‡
HAVE_SSL


917 i‡(
	`ldns_ªsﬁvî_tsig_key«me
(
ªsﬁvî
Ë&& 
	`ldns_ªsﬁvî_tsig_keyd©a
(resolver)) {

918 
°©us
 = 
	`ldns_pkt_tsig_sign
(
quîy
,

919 
	`ldns_ªsﬁvî_tsig_key«me
(
ªsﬁvî
),

920 
	`ldns_ªsﬁvî_tsig_keyd©a
(
ªsﬁvî
),

921 300, 
	`ldns_ªsﬁvî_tsig_Æg‹ôhm
(
ªsﬁvî
), 
NULL
);

922 i‡(
°©us
 !
LDNS_STATUS_OK
) {

925 #i‚de‡
USE_WINSOCK


926 
	`˛o£
(
ªsﬁvî
->
_sockë
);

928 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

930 
ªsﬁvî
->
_sockë
 = 0;

932 
	`ldns_pkt_‰ì
(
quîy
);

933 
	`LDNS_FREE
(
ns
);

935  
LDNS_STATUS_CRYPTO_TSIG_ERR
;

943 
quîy_wúe
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

944 if(!
quîy_wúe
) {

945 
	`ldns_pkt_‰ì
(
quîy
);

946 
	`LDNS_FREE
(
ns
);

947 #i‚de‡
USE_WINSOCK


948 
	`˛o£
(
ªsﬁvî
->
_sockë
);

950 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

952 
ªsﬁvî
->
_sockë
 = 0;

954  
LDNS_STATUS_MEM_ERR
;

956 
°©us
 = 
	`ldns_pkt2buf„r_wúe
(
quîy_wúe
, 
quîy
);

957 i‡(
°©us
 !
LDNS_STATUS_OK
) {

958 
	`ldns_pkt_‰ì
(
quîy
);

959 
	`ldns_buf„r_‰ì
(
quîy_wúe
);

960 
	`LDNS_FREE
(
ns
);

964 #i‚de‡
USE_WINSOCK


965 
	`˛o£
(
ªsﬁvî
->
_sockë
);

967 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

969 
ªsﬁvî
->
_sockë
 = 0;

971  
°©us
;

974 i‡(
	`ldns_t˝_£nd_quîy
(
quîy_wúe
, 
ªsﬁvî
->
_sockë
, 
ns
,

975 (
sockÀn_t
)
ns_Àn
) == 0) {

976 
	`ldns_pkt_‰ì
(
quîy
);

977 
	`ldns_buf„r_‰ì
(
quîy_wúe
);

978 
	`LDNS_FREE
(
ns
);

983 #i‚de‡
USE_WINSOCK


984 
	`˛o£
(
ªsﬁvî
->
_sockë
);

986 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

988 
ªsﬁvî
->
_sockë
 = 0;

990  
LDNS_STATUS_NETWORK_ERR
;

993 
	`ldns_pkt_‰ì
(
quîy
);

994 
	`ldns_buf„r_‰ì
(
quîy_wúe
);

995 
	`LDNS_FREE
(
ns
);

1000 
ªsﬁvî
->
_ax‰_sﬂ_cou¡
 = 0;

1001  
LDNS_STATUS_OK
;

1002 
	}
}

	@packet.c

13 
	~<ldns/c⁄fig.h
>

15 
	~<ldns/ldns.h
>

17 
	~<°rögs.h
>

18 
	~<limôs.h
>

20 #ifde‡
HAVE_SSL


21 
	~<›ís¶/ønd.h
>

28 
	#LDNS_EDNS_MASK_DO_BIT
 0x8000

	)

32 
ldns_lookup_èbÀ
 
	gldns_edns_Êags
[] = {

34 { 0, 
NULL
}

38 
uöt16_t


39 
	$ldns_pkt_id
(c⁄° 
ldns_pkt
 *
∑ckë
)

41  
∑ckë
->
_hódî
->
_id
;

42 
	}
}

44 
boﬁ


45 
	$ldns_pkt_qr
(c⁄° 
ldns_pkt
 *
∑ckë
)

47  
∑ckë
->
_hódî
->
_qr
;

48 
	}
}

50 
boﬁ


51 
	$ldns_pkt_Ø
(c⁄° 
ldns_pkt
 *
∑ckë
)

53  
∑ckë
->
_hódî
->
_Ø
;

54 
	}
}

56 
boﬁ


57 
	$ldns_pkt_tc
(c⁄° 
ldns_pkt
 *
∑ckë
)

59  
∑ckë
->
_hódî
->
_tc
;

60 
	}
}

62 
boﬁ


63 
	$ldns_pkt_rd
(c⁄° 
ldns_pkt
 *
∑ckë
)

65  
∑ckë
->
_hódî
->
_rd
;

66 
	}
}

68 
boﬁ


69 
	$ldns_pkt_cd
(c⁄° 
ldns_pkt
 *
∑ckë
)

71  
∑ckë
->
_hódî
->
_cd
;

72 
	}
}

74 
boﬁ


75 
	$ldns_pkt_ø
(c⁄° 
ldns_pkt
 *
∑ckë
)

77  
∑ckë
->
_hódî
->
_ø
;

78 
	}
}

80 
boﬁ


81 
	$ldns_pkt_ad
(c⁄° 
ldns_pkt
 *
∑ckë
)

83  
∑ckë
->
_hódî
->
_ad
;

84 
	}
}

86 
ldns_pkt_›code


87 
	$ldns_pkt_gë_›code
(c⁄° 
ldns_pkt
 *
∑ckë
)

89  
∑ckë
->
_hódî
->
_›code
;

90 
	}
}

92 
ldns_pkt_rcode


93 
	$ldns_pkt_gë_rcode
(c⁄° 
ldns_pkt
 *
∑ckë
)

95  
∑ckë
->
_hódî
->
_rcode
;

96 
	}
}

98 
uöt16_t


99 
	$ldns_pkt_qdcou¡
(c⁄° 
ldns_pkt
 *
∑ckë
)

101  
∑ckë
->
_hódî
->
_qdcou¡
;

102 
	}
}

104 
uöt16_t


105 
	$ldns_pkt_™cou¡
(c⁄° 
ldns_pkt
 *
∑ckë
)

107  
∑ckë
->
_hódî
->
_™cou¡
;

108 
	}
}

110 
uöt16_t


111 
	$ldns_pkt_nscou¡
(c⁄° 
ldns_pkt
 *
∑ckë
)

113  
∑ckë
->
_hódî
->
_nscou¡
;

114 
	}
}

116 
uöt16_t


117 
	$ldns_pkt_¨cou¡
(c⁄° 
ldns_pkt
 *
∑ckë
)

119  
∑ckë
->
_hódî
->
_¨cou¡
;

120 
	}
}

122 
ldns_º_li°
 *

123 
	$ldns_pkt_que°i⁄
(c⁄° 
ldns_pkt
 *
∑ckë
)

125  
∑ckë
->
_que°i⁄
;

126 
	}
}

128 
ldns_º_li°
 *

129 
	$ldns_pkt_™swî
(c⁄° 
ldns_pkt
 *
∑ckë
)

131  
∑ckë
->
_™swî
;

132 
	}
}

134 
ldns_º_li°
 *

135 
	$ldns_pkt_auth‹ôy
(c⁄° 
ldns_pkt
 *
∑ckë
)

137  
∑ckë
->
_auth‹ôy
;

138 
	}
}

140 
ldns_º_li°
 *

141 
	$ldns_pkt_addôi⁄Æ
(c⁄° 
ldns_pkt
 *
∑ckë
)

143  
∑ckë
->
_addôi⁄Æ
;

144 
	}
}

147 
ldns_º_li°
 *

148 
	$ldns_pkt_Æl
(c⁄° 
ldns_pkt
 *
∑ckë
)

150 
ldns_º_li°
 *
Æl
, *
¥ev_Æl
;

152 
Æl
 = 
	`ldns_º_li°_ˇt_˛⁄e
(

153 
	`ldns_pkt_que°i⁄
(
∑ckë
),

154 
	`ldns_pkt_™swî
(
∑ckë
));

155 
¥ev_Æl
 = 
Æl
;

156 
Æl
 = 
	`ldns_º_li°_ˇt_˛⁄e
(all,

157 
	`ldns_pkt_auth‹ôy
(
∑ckë
));

158 
	`ldns_º_li°_dìp_‰ì
(
¥ev_Æl
);

159 
¥ev_Æl
 = 
Æl
;

160 
Æl
 = 
	`ldns_º_li°_ˇt_˛⁄e
(all,

161 
	`ldns_pkt_addôi⁄Æ
(
∑ckë
));

162 
	`ldns_º_li°_dìp_‰ì
(
¥ev_Æl
);

163  
Æl
;

164 
	}
}

166 
ldns_º_li°
 *

167 
	$ldns_pkt_Æl_noque°i⁄
(c⁄° 
ldns_pkt
 *
∑ckë
)

169 
ldns_º_li°
 *
Æl
, *
Æl2
;

171 
Æl
 = 
	`ldns_º_li°_ˇt_˛⁄e
(

172 
	`ldns_pkt_™swî
(
∑ckë
),

173 
	`ldns_pkt_auth‹ôy
(
∑ckë
));

174 
Æl2
 = 
	`ldns_º_li°_ˇt_˛⁄e
(
Æl
,

175 
	`ldns_pkt_addôi⁄Æ
(
∑ckë
));

177 
	`ldns_º_li°_dìp_‰ì
(
Æl
);

178  
Æl2
;

179 
	}
}

181 
size_t


182 
	$ldns_pkt_size
(c⁄° 
ldns_pkt
 *
∑ckë
)

184  
∑ckë
->
_size
;

185 
	}
}

187 
uöt32_t


188 
	$ldns_pkt_quîytime
(c⁄° 
ldns_pkt
 *
∑ckë
)

190  
∑ckë
->
_quîytime
;

191 
	}
}

193 
ldns_rdf
 *

194 
	$ldns_pkt_™swî‰om
(c⁄° 
ldns_pkt
 *
∑ckë
)

196  
∑ckë
->
_™swî‰om
;

197 
	}
}

199 
timevÆ


200 
	$ldns_pkt_time°amp
(c⁄° 
ldns_pkt
 *
∑ckë
)

202  
∑ckë
->
time°amp
;

203 
	}
}

205 
uöt16_t


206 
	$ldns_pkt_edns_udp_size
(c⁄° 
ldns_pkt
 *
∑ckë
)

208  
∑ckë
->
_edns_udp_size
;

209 
	}
}

211 
uöt8_t


212 
	$ldns_pkt_edns_exãnded_rcode
(c⁄° 
ldns_pkt
 *
∑ckë
)

214  
∑ckë
->
_edns_exãnded_rcode
;

215 
	}
}

217 
uöt8_t


218 
	$ldns_pkt_edns_vîsi⁄
(c⁄° 
ldns_pkt
 *
∑ckë
)

220  
∑ckë
->
_edns_vîsi⁄
;

221 
	}
}

223 
uöt16_t


224 
	$ldns_pkt_edns_z
(c⁄° 
ldns_pkt
 *
∑ckë
)

226  
∑ckë
->
_edns_z
;

227 
	}
}

229 
boﬁ


230 
	$ldns_pkt_edns_do
(c⁄° 
ldns_pkt
 *
∑ckë
)

232  (
∑ckë
->
_edns_z
 & 
LDNS_EDNS_MASK_DO_BIT
);

233 
	}
}

236 
	$ldns_pkt_£t_edns_do
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
vÆue
)

238 i‡(
vÆue
) {

239 
∑ckë
->
_edns_z
 =Öackë->_edns_z | 
LDNS_EDNS_MASK_DO_BIT
;

241 
∑ckë
->
_edns_z
 =Öackë->_edns_z & ~
LDNS_EDNS_MASK_DO_BIT
;

243 
	}
}

245 
ldns_rdf
 *

246 
	$ldns_pkt_edns_d©a
(c⁄° 
ldns_pkt
 *
∑ckë
)

248  
∑ckë
->
_edns_d©a
;

249 
	}
}

252 
ldns_º_li°
 *

253 
	$ldns_pkt_º_li°_by_«me
(
ldns_pkt
 *
∑ckë
,

254 
ldns_rdf
 *
ow√∫ame
,

255 
ldns_pkt_£˘i⁄
 
£c
)

257 
ldns_º_li°
 *
ºs
;

258 
ldns_º_li°
 *
ªt
;

259 
uöt16_t
 
i
;

261 i‡(!
∑ckë
) {

262  
NULL
;

265 
ºs
 = 
	`ldns_pkt_gë_£˘i⁄_˛⁄e
(
∑ckë
, 
£c
);

266 
ªt
 = 
NULL
;

268 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºs
); i++) {

269 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(

270 
	`ldns_º_li°_º
(
ºs
, 
i
)),

271 
ow√∫ame
) == 0) {

273 i‡(
ªt
 =
NULL
) {

274 
ªt
 = 
	`ldns_º_li°_√w
();

276 
	`ldns_º_li°_push_º
(
ªt
, 
	`ldns_º_li°_º
(
ºs
, 
i
));

279  
ªt
;

280 
	}
}

283 
ldns_º_li°
 *

284 
	$ldns_pkt_º_li°_by_ty≥
(c⁄° 
ldns_pkt
 *
∑ckë
,

285 
ldns_º_ty≥
 
ty≥
,

286 
ldns_pkt_£˘i⁄
 
£c
)

288 
ldns_º_li°
 *
ºs
;

289 
ldns_º_li°
 *
√w
;

290 
uöt16_t
 
i
;

292 if(!
∑ckë
) {

293  
NULL
;

296 
ºs
 = 
	`ldns_pkt_gë_£˘i⁄_˛⁄e
(
∑ckë
, 
£c
);

297 
√w
 = 
	`ldns_º_li°_√w
();

299 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºs
); i++) {

300 i‡(
ty≥
 =
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
ºs
, 
i
))) {

302 
	`ldns_º_li°_push_º
(
√w
,

303 
	`ldns_º_˛⁄e
(

304 
	`ldns_º_li°_º
(
ºs
, 
i
))

308 
	`ldns_º_li°_dìp_‰ì
(
ºs
);

310 i‡(
	`ldns_º_li°_º_cou¡
(
√w
) == 0) {

311 
	`ldns_º_li°_‰ì
(
√w
);

312  
NULL
;

314  
√w
;

316 
	}
}

319 
ldns_º_li°
 *

320 
	$ldns_pkt_º_li°_by_«me_™d_ty≥
(c⁄° 
ldns_pkt
 *
∑ckë
,

321 c⁄° 
ldns_rdf
 *
ow√∫ame
,

322 
ldns_º_ty≥
 
ty≥
,

323 
ldns_pkt_£˘i⁄
 
£c
)

325 
ldns_º_li°
 *
ºs
;

326 
ldns_º_li°
 *
√w
;

327 
ldns_º_li°
 *
ªt
;

328 
uöt16_t
 
i
;

330 if(!
∑ckë
) {

331  
NULL
;

334 
ºs
 = 
	`ldns_pkt_gë_£˘i⁄_˛⁄e
(
∑ckë
, 
£c
);

335 
√w
 = 
	`ldns_º_li°_√w
();

336 
ªt
 = 
NULL
;

338 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºs
); i++) {

339 i‡(
ty≥
 =
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
ºs
, 
i
)) &&

340 
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
ºs
, 
i
)),

341 
ow√∫ame


345 
	`ldns_º_li°_push_º
(
√w
, 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
ºs
, 
i
)));

346 
ªt
 = 
√w
;

349 
	`ldns_º_li°_dìp_‰ì
(
ºs
);

350 i‡(!
ªt
) {

351 
	`ldns_º_li°_‰ì
(
√w
);

353  
ªt
;

354 
	}
}

356 
boﬁ


357 
	$ldns_pkt_º
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º
 *
º
)

359 
boﬁ
 
ªsu…
 = 
Ál£
;

361 
£c
) {

362 
LDNS_SECTION_QUESTION
:

363  
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_que°i⁄
(
pkt
), 
º
);

364 
LDNS_SECTION_ANSWER
:

365  
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_™swî
(
pkt
), 
º
);

366 
LDNS_SECTION_AUTHORITY
:

367  
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_auth‹ôy
(
pkt
), 
º
);

368 
LDNS_SECTION_ADDITIONAL
:

369  
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_addôi⁄Æ
(
pkt
), 
º
);

370 
LDNS_SECTION_ANY
:

371 
ªsu…
 = 
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_que°i⁄
(
pkt
), 
º
);

372 
LDNS_SECTION_ANY_NOQUESTION
:

373 
ªsu…
 =Ñesult

374 || 
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_™swî
(
pkt
), 
º
)

375 || 
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_auth‹ôy
(
pkt
), 
º
)

376 || 
	`ldns_º_li°_c⁄èös_º
(
	`ldns_pkt_addôi⁄Æ
(
pkt
), 
º
);

379  
ªsu…
;

380 
	}
}

382 
uöt16_t


383 
	$ldns_pkt_£˘i⁄_cou¡
(c⁄° 
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
s
)

385 
s
) {

386 
LDNS_SECTION_QUESTION
:

387  
	`ldns_pkt_qdcou¡
(
∑ckë
);

388 
LDNS_SECTION_ANSWER
:

389  
	`ldns_pkt_™cou¡
(
∑ckë
);

390 
LDNS_SECTION_AUTHORITY
:

391  
	`ldns_pkt_nscou¡
(
∑ckë
);

392 
LDNS_SECTION_ADDITIONAL
:

393  
	`ldns_pkt_¨cou¡
(
∑ckë
);

394 
LDNS_SECTION_ANY
:

395  
	`ldns_pkt_qdcou¡
(
∑ckë
) +

396 
	`ldns_pkt_™cou¡
(
∑ckë
) +

397 
	`ldns_pkt_nscou¡
(
∑ckë
) +

398 
	`ldns_pkt_¨cou¡
(
∑ckë
);

399 
LDNS_SECTION_ANY_NOQUESTION
:

400  
	`ldns_pkt_™cou¡
(
∑ckë
) +

401 
	`ldns_pkt_nscou¡
(
∑ckë
) +

402 
	`ldns_pkt_¨cou¡
(
∑ckë
);

406 
	}
}

408 
boﬁ


409 
	$ldns_pkt_em±y
(
ldns_pkt
 *
p
)

411 i‡(!
p
) {

412  
åue
;

414 i‡(
	`ldns_pkt_£˘i⁄_cou¡
(
p
, 
LDNS_SECTION_ANY
) > 0) {

415  
Ál£
;

417  
åue
;

419 
	}
}

422 
ldns_º_li°
 *

423 
	$ldns_pkt_gë_£˘i⁄_˛⁄e
(c⁄° 
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
s
)

425 
s
) {

426 
LDNS_SECTION_QUESTION
:

427  
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_que°i⁄
(
∑ckë
));

428 
LDNS_SECTION_ANSWER
:

429  
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_™swî
(
∑ckë
));

430 
LDNS_SECTION_AUTHORITY
:

431  
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_auth‹ôy
(
∑ckë
));

432 
LDNS_SECTION_ADDITIONAL
:

433  
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_addôi⁄Æ
(
∑ckë
));

434 
LDNS_SECTION_ANY
:

436  
	`ldns_pkt_Æl
(
∑ckë
);

437 
LDNS_SECTION_ANY_NOQUESTION
:

438  
	`ldns_pkt_Æl_noque°i⁄
(
∑ckë
);

440  
NULL
;

442 
	}
}

444 
ldns_º
 *
	$ldns_pkt_tsig
(c⁄° 
ldns_pkt
 *
pkt
) {

445  
pkt
->
_tsig_º
;

446 
	}
}

450 
	$ldns_pkt_£t_id
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
id
)

452 
∑ckë
->
_hódî
->
_id
 = 
id
;

453 
	}
}

456 
	$ldns_pkt_£t_øndom_id
(
ldns_pkt
 *
∑ckë
)

458 
uöt16_t
 
rid
 = 
	`ldns_gë_øndom
();

459 
	`ldns_pkt_£t_id
(
∑ckë
, 
rid
);

460 
	}
}

464 
	$ldns_pkt_£t_qr
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
qr
)

466 
∑ckë
->
_hódî
->
_qr
 = 
qr
;

467 
	}
}

470 
	$ldns_pkt_£t_Ø
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
Ø
)

472 
∑ckë
->
_hódî
->
_Ø
 = 
Ø
;

473 
	}
}

476 
	$ldns_pkt_£t_tc
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
tc
)

478 
∑ckë
->
_hódî
->
_tc
 = 
tc
;

479 
	}
}

482 
	$ldns_pkt_£t_rd
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
rd
)

484 
∑ckë
->
_hódî
->
_rd
 = 
rd
;

485 
	}
}

488 
	$ldns_pkt_£t_addôi⁄Æ
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
)

490 
p
->
_addôi⁄Æ
 = 
º
;

491 
	}
}

494 
	$ldns_pkt_£t_que°i⁄
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
)

496 
p
->
_que°i⁄
 = 
º
;

497 
	}
}

500 
	$ldns_pkt_£t_™swî
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
)

502 
p
->
_™swî
 = 
º
;

503 
	}
}

506 
	$ldns_pkt_£t_auth‹ôy
(
ldns_pkt
 *
p
, 
ldns_º_li°
 *
º
)

508 
p
->
_auth‹ôy
 = 
º
;

509 
	}
}

512 
	$ldns_pkt_£t_cd
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
cd
)

514 
∑ckë
->
_hódî
->
_cd
 = 
cd
;

515 
	}
}

518 
	$ldns_pkt_£t_ø
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
ø
)

520 
∑ckë
->
_hódî
->
_ø
 = 
ø
;

521 
	}
}

524 
	$ldns_pkt_£t_ad
(
ldns_pkt
 *
∑ckë
, 
boﬁ
 
ad
)

526 
∑ckë
->
_hódî
->
_ad
 = 
ad
;

527 
	}
}

530 
	$ldns_pkt_£t_›code
(
ldns_pkt
 *
∑ckë
, 
ldns_pkt_›code
 
›code
)

532 
∑ckë
->
_hódî
->
_›code
 = 
›code
;

533 
	}
}

536 
	$ldns_pkt_£t_rcode
(
ldns_pkt
 *
∑ckë
, 
uöt8_t
 
rcode
)

538 
∑ckë
->
_hódî
->
_rcode
 = 
rcode
;

539 
	}
}

542 
	$ldns_pkt_£t_qdcou¡
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
qdcou¡
)

544 
∑ckë
->
_hódî
->
_qdcou¡
 = 
qdcou¡
;

545 
	}
}

548 
	$ldns_pkt_£t_™cou¡
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
™cou¡
)

550 
∑ckë
->
_hódî
->
_™cou¡
 = 
™cou¡
;

551 
	}
}

554 
	$ldns_pkt_£t_nscou¡
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
nscou¡
)

556 
∑ckë
->
_hódî
->
_nscou¡
 = 
nscou¡
;

557 
	}
}

560 
	$ldns_pkt_£t_¨cou¡
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
¨cou¡
)

562 
∑ckë
->
_hódî
->
_¨cou¡
 = 
¨cou¡
;

563 
	}
}

566 
	$ldns_pkt_£t_quîytime
(
ldns_pkt
 *
∑ckë
, 
uöt32_t
 
time
)

568 
∑ckë
->
_quîytime
 = 
time
;

569 
	}
}

572 
	$ldns_pkt_£t_™swî‰om
(
ldns_pkt
 *
∑ckë
, 
ldns_rdf
 *
™swî‰om
)

574 
∑ckë
->
_™swî‰om
 = 
™swî‰om
;

575 
	}
}

578 
	$ldns_pkt_£t_time°amp
(
ldns_pkt
 *
∑ckë
, 
timevÆ
Åimeval)

580 
∑ckë
->
time°amp
.
tv_£c
 = 
timevÆ
.tv_sec;

581 
∑ckë
->
time°amp
.
tv_u£c
 = 
timevÆ
.tv_usec;

582 
	}
}

585 
	$ldns_pkt_£t_size
(
ldns_pkt
 *
∑ckë
, 
size_t
 
s
)

587 
∑ckë
->
_size
 = 
s
;

588 
	}
}

591 
	$ldns_pkt_£t_edns_udp_size
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
s
)

593 
∑ckë
->
_edns_udp_size
 = 
s
;

594 
	}
}

597 
	$ldns_pkt_£t_edns_exãnded_rcode
(
ldns_pkt
 *
∑ckë
, 
uöt8_t
 
c
)

599 
∑ckë
->
_edns_exãnded_rcode
 = 
c
;

600 
	}
}

603 
	$ldns_pkt_£t_edns_vîsi⁄
(
ldns_pkt
 *
∑ckë
, 
uöt8_t
 
v
)

605 
∑ckë
->
_edns_vîsi⁄
 = 
v
;

606 
	}
}

609 
	$ldns_pkt_£t_edns_z
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
z
)

611 
∑ckë
->
_edns_z
 = 
z
;

612 
	}
}

615 
	$ldns_pkt_£t_edns_d©a
(
ldns_pkt
 *
∑ckë
, 
ldns_rdf
 *
d©a
)

617 
∑ckë
->
_edns_d©a
 = 
d©a
;

618 
	}
}

621 
	$ldns_pkt_£t_£˘i⁄_cou¡
(
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
s
, 
uöt16_t
 
cou¡
)

623 
s
) {

624 
LDNS_SECTION_QUESTION
:

625 
	`ldns_pkt_£t_qdcou¡
(
∑ckë
, 
cou¡
);

627 
LDNS_SECTION_ANSWER
:

628 
	`ldns_pkt_£t_™cou¡
(
∑ckë
, 
cou¡
);

630 
LDNS_SECTION_AUTHORITY
:

631 
	`ldns_pkt_£t_nscou¡
(
∑ckë
, 
cou¡
);

633 
LDNS_SECTION_ADDITIONAL
:

634 
	`ldns_pkt_£t_¨cou¡
(
∑ckë
, 
cou¡
);

636 
LDNS_SECTION_ANY
:

637 
LDNS_SECTION_ANY_NOQUESTION
:

640 
	}
}

642 
	$ldns_pkt_£t_tsig
(
ldns_pkt
 *
pkt
, 
ldns_º
 *
º
)

644 
pkt
->
_tsig_º
 = 
º
;

645 
	}
}

647 
boﬁ


648 
	$ldns_pkt_push_º
(
ldns_pkt
 *
∑ckë
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
, 
ldns_º
 *
º
)

650 
£˘i⁄
) {

651 
LDNS_SECTION_QUESTION
:

652 i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_que°i⁄
(
∑ckë
), 
º
)) {

653  
Ál£
;

655 
	`ldns_pkt_£t_qdcou¡
(
∑ckë
, 
	`ldns_pkt_qdcou¡
(packet) + 1);

657 
LDNS_SECTION_ANSWER
:

658 i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_™swî
(
∑ckë
), 
º
)) {

659  
Ál£
;

661 
	`ldns_pkt_£t_™cou¡
(
∑ckë
, 
	`ldns_pkt_™cou¡
(packet) + 1);

663 
LDNS_SECTION_AUTHORITY
:

664 i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_auth‹ôy
(
∑ckë
), 
º
)) {

665  
Ál£
;

667 
	`ldns_pkt_£t_nscou¡
(
∑ckë
, 
	`ldns_pkt_nscou¡
(packet) + 1);

669 
LDNS_SECTION_ADDITIONAL
:

670 i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_addôi⁄Æ
(
∑ckë
), 
º
)) {

671  
Ál£
;

673 
	`ldns_pkt_£t_¨cou¡
(
∑ckë
, 
	`ldns_pkt_¨cou¡
(packet) + 1);

675 
LDNS_SECTION_ANY
:

676 
LDNS_SECTION_ANY_NOQUESTION
:

680  
åue
;

681 
	}
}

683 
boﬁ


684 
	$ldns_pkt_ß„_push_º
(
ldns_pkt
 *
pkt
, 
ldns_pkt_£˘i⁄
 
£c
, 
ldns_º
 *
º
)

688 i‡(
	`ldns_pkt_º
(
pkt
, 
£c
, 
º
)) {

690  
Ál£
;

692  
	`ldns_pkt_push_º
(
pkt
, 
£c
, 
º
);

693 
	}
}

695 
boﬁ


696 
	$ldns_pkt_push_º_li°
(
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
, 
ldns_º_li°
 *
li°
)

698 
size_t
 
i
;

699 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
li°
); i++) {

700 i‡(!
	`ldns_pkt_push_º
(
p
, 
s
, 
	`ldns_º_li°_º
(
li°
, 
i
))) {

701  
Ál£
;

704  
åue
;

705 
	}
}

707 
boﬁ


708 
	$ldns_pkt_ß„_push_º_li°
(
ldns_pkt
 *
p
, 
ldns_pkt_£˘i⁄
 
s
, 
ldns_º_li°
 *
li°
)

710 
size_t
 
i
;

711 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
li°
); i++) {

712 i‡(!
	`ldns_pkt_ß„_push_º
(
p
, 
s
, 
	`ldns_º_li°_º
(
li°
, 
i
))) {

713  
Ál£
;

716  
åue
;

717 
	}
}

719 
boﬁ


720 
	$ldns_pkt_edns
(c⁄° 
ldns_pkt
 *
pkt
) {

721  (
	`ldns_pkt_edns_udp_size
(
pkt
) > 0 ||

722 
	`ldns_pkt_edns_exãnded_rcode
(
pkt
) > 0 ||

723 
	`ldns_pkt_edns_d©a
(
pkt
) ||

724 
	`ldns_pkt_edns_do
(
pkt
)

726 
	}
}

731 
ldns_pkt
 *

732 
	$ldns_pkt_√w
()

734 
ldns_pkt
 *
∑ckë
;

735 
∑ckë
 = 
	`LDNS_MALLOC
(
ldns_pkt
);

736 i‡(!
∑ckë
) {

737  
NULL
;

740 
∑ckë
->
_hódî
 = 
	`LDNS_MALLOC
(
ldns_hdr
);

741 i‡(!
∑ckë
->
_hódî
) {

742 
	`LDNS_FREE
(
∑ckë
);

743  
NULL
;

746 
∑ckë
->
_que°i⁄
 = 
	`ldns_º_li°_√w
();

747 
∑ckë
->
_™swî
 = 
	`ldns_º_li°_√w
();

748 
∑ckë
->
_auth‹ôy
 = 
	`ldns_º_li°_√w
();

749 
∑ckë
->
_addôi⁄Æ
 = 
	`ldns_º_li°_√w
();

752 
	`ldns_pkt_£t_qr
(
∑ckë
, 
Ál£
);

753 
	`ldns_pkt_£t_Ø
(
∑ckë
, 
Ál£
);

754 
	`ldns_pkt_£t_tc
(
∑ckë
, 
Ál£
);

755 
	`ldns_pkt_£t_rd
(
∑ckë
, 
Ál£
);

756 
	`ldns_pkt_£t_ø
(
∑ckë
, 
Ál£
);

757 
	`ldns_pkt_£t_ad
(
∑ckë
, 
Ál£
);

758 
	`ldns_pkt_£t_cd
(
∑ckë
, 
Ál£
);

760 
	`ldns_pkt_£t_›code
(
∑ckë
, 
LDNS_PACKET_QUERY
);

761 
	`ldns_pkt_£t_rcode
(
∑ckë
, 0);

762 
	`ldns_pkt_£t_id
(
∑ckë
, 0);

763 
	`ldns_pkt_£t_size
(
∑ckë
, 0);

764 
	`ldns_pkt_£t_quîytime
(
∑ckë
, 0);

765 
	`mem£t
(&
∑ckë
->
time°amp
, 0, (packet->timestamp));

766 
	`ldns_pkt_£t_™swî‰om
(
∑ckë
, 
NULL
);

767 
	`ldns_pkt_£t_£˘i⁄_cou¡
(
∑ckë
, 
LDNS_SECTION_QUESTION
, 0);

768 
	`ldns_pkt_£t_£˘i⁄_cou¡
(
∑ckë
, 
LDNS_SECTION_ANSWER
, 0);

769 
	`ldns_pkt_£t_£˘i⁄_cou¡
(
∑ckë
, 
LDNS_SECTION_AUTHORITY
, 0);

770 
	`ldns_pkt_£t_£˘i⁄_cou¡
(
∑ckë
, 
LDNS_SECTION_ADDITIONAL
, 0);

772 
	`ldns_pkt_£t_edns_udp_size
(
∑ckë
, 0);

773 
	`ldns_pkt_£t_edns_exãnded_rcode
(
∑ckë
, 0);

774 
	`ldns_pkt_£t_edns_vîsi⁄
(
∑ckë
, 0);

775 
	`ldns_pkt_£t_edns_z
(
∑ckë
, 0);

776 
	`ldns_pkt_£t_edns_d©a
(
∑ckë
, 
NULL
);

778 
	`ldns_pkt_£t_tsig
(
∑ckë
, 
NULL
);

780  
∑ckë
;

781 
	}
}

784 
	$ldns_pkt_‰ì
(
ldns_pkt
 *
∑ckë
)

786 i‡(
∑ckë
) {

787 
	`LDNS_FREE
(
∑ckë
->
_hódî
);

788 
	`ldns_º_li°_dìp_‰ì
(
∑ckë
->
_que°i⁄
);

789 
	`ldns_º_li°_dìp_‰ì
(
∑ckë
->
_™swî
);

790 
	`ldns_º_li°_dìp_‰ì
(
∑ckë
->
_auth‹ôy
);

791 
	`ldns_º_li°_dìp_‰ì
(
∑ckë
->
_addôi⁄Æ
);

792 
	`ldns_º_‰ì
(
∑ckë
->
_tsig_º
);

793 
	`ldns_rdf_dìp_‰ì
(
∑ckë
->
_edns_d©a
);

794 
	`ldns_rdf_dìp_‰ì
(
∑ckë
->
_™swî‰om
);

795 
	`LDNS_FREE
(
∑ckë
);

797 
	}
}

799 
boﬁ


800 
	$ldns_pkt_£t_Êags
(
ldns_pkt
 *
∑ckë
, 
uöt16_t
 
Êags
)

802 i‡(!
∑ckë
) {

803  
Ál£
;

805 i‡((
Êags
 & 
LDNS_QR
) == LDNS_QR) {

806 
	`ldns_pkt_£t_qr
(
∑ckë
, 
åue
);

808 i‡((
Êags
 & 
LDNS_AA
) == LDNS_AA) {

809 
	`ldns_pkt_£t_Ø
(
∑ckë
, 
åue
);

811 i‡((
Êags
 & 
LDNS_RD
) == LDNS_RD) {

812 
	`ldns_pkt_£t_rd
(
∑ckë
, 
åue
);

814 i‡((
Êags
 & 
LDNS_TC
) == LDNS_TC) {

815 
	`ldns_pkt_£t_tc
(
∑ckë
, 
åue
);

817 i‡((
Êags
 & 
LDNS_CD
) == LDNS_CD) {

818 
	`ldns_pkt_£t_cd
(
∑ckë
, 
åue
);

820 i‡((
Êags
 & 
LDNS_RA
) == LDNS_RA) {

821 
	`ldns_pkt_£t_ø
(
∑ckë
, 
åue
);

823 i‡((
Êags
 & 
LDNS_AD
) == LDNS_AD) {

824 
	`ldns_pkt_£t_ad
(
∑ckë
, 
åue
);

826  
åue
;

827 
	}
}

830 
ldns_º
*

831 
	$ldns_pkt_authsﬂ
(
ldns_rdf
* 
º_«me
, 
ldns_º_˛ass
 
º_˛ass
)

833 
ldns_º
* 
sﬂ_º
 = 
	`ldns_º_√w
();

834 
ldns_rdf
 *
ow√r_rdf
;

835 
ldns_rdf
 *
m«me_rdf
;

836 
ldns_rdf
 *
∫ame_rdf
;

837 
ldns_rdf
 *
£rül_rdf
;

838 
ldns_rdf
 *
ª‰esh_rdf
;

839 
ldns_rdf
 *
ªåy_rdf
;

840 
ldns_rdf
 *
expúe_rdf
;

841 
ldns_rdf
 *
möimum_rdf
;

843 i‡(!
sﬂ_º
) {

844  
NULL
;

846 
ow√r_rdf
 = 
	`ldns_rdf_˛⁄e
(
º_«me
);

847 i‡(!
ow√r_rdf
) {

848 
	`ldns_º_‰ì
(
sﬂ_º
);

849  
NULL
;

852 
	`ldns_º_£t_ow√r
(
sﬂ_º
, 
ow√r_rdf
);

853 
	`ldns_º_£t_ty≥
(
sﬂ_º
, 
LDNS_RR_TYPE_SOA
);

854 
	`ldns_º_£t_˛ass
(
sﬂ_º
, 
º_˛ass
);

855 
	`ldns_º_£t_que°i⁄
(
sﬂ_º
, 
Ál£
);

857 i‡(
	`ldns_°r2rdf_d«me
(&
m«me_rdf
, "."Ë!
LDNS_STATUS_OK
) {

858 
	`ldns_º_‰ì
(
sﬂ_º
);

859  
NULL
;

861 
	`ldns_º_push_rdf
(
sﬂ_º
, 
m«me_rdf
);

863 i‡(
	`ldns_°r2rdf_d«me
(&
∫ame_rdf
, "."Ë!
LDNS_STATUS_OK
) {

864 
	`ldns_º_‰ì
(
sﬂ_º
);

865  
NULL
;

867 
	`ldns_º_push_rdf
(
sﬂ_º
, 
∫ame_rdf
);

869 
£rül_rdf
 = 
	`ldns_«tive2rdf_öt32
(
LDNS_RDF_TYPE_INT32
, 0);

870 i‡(!
£rül_rdf
) {

871 
	`ldns_º_‰ì
(
sﬂ_º
);

872  
NULL
;

874 
	`ldns_º_push_rdf
(
sﬂ_º
, 
£rül_rdf
);

876 
ª‰esh_rdf
 = 
	`ldns_«tive2rdf_öt32
(
LDNS_RDF_TYPE_INT32
, 0);

877 i‡(!
ª‰esh_rdf
) {

878 
	`ldns_º_‰ì
(
sﬂ_º
);

879  
NULL
;

881 
	`ldns_º_push_rdf
(
sﬂ_º
, 
ª‰esh_rdf
);

883 
ªåy_rdf
 = 
	`ldns_«tive2rdf_öt32
(
LDNS_RDF_TYPE_INT32
, 0);

884 i‡(!
ªåy_rdf
) {

885 
	`ldns_º_‰ì
(
sﬂ_º
);

886  
NULL
;

888 
	`ldns_º_push_rdf
(
sﬂ_º
, 
ªåy_rdf
);

890 
expúe_rdf
 = 
	`ldns_«tive2rdf_öt32
(
LDNS_RDF_TYPE_INT32
, 0);

891 i‡(!
expúe_rdf
) {

892 
	`ldns_º_‰ì
(
sﬂ_º
);

893  
NULL
;

895 
	`ldns_º_push_rdf
(
sﬂ_º
, 
expúe_rdf
);

897 
möimum_rdf
 = 
	`ldns_«tive2rdf_öt32
(
LDNS_RDF_TYPE_INT32
, 0);

898 i‡(!
möimum_rdf
) {

899 
	`ldns_º_‰ì
(
sﬂ_º
);

900  
NULL
;

902 
	`ldns_º_push_rdf
(
sﬂ_º
, 
möimum_rdf
);

904  
sﬂ_º
;

905 
	}
}

908 
ldns_°©us


909 
	$ldns_pkt_quîy_√w_‰m_°r_öã∫Æ
(
ldns_pkt
 **
p
, c⁄° *
«me
,

910 
ldns_º_ty≥
 
º_ty≥
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
,

911 
ldns_º
* 
authsﬂ_º
)

913 
ldns_pkt
 *
∑ckë
;

914 
ldns_º
 *
que°i⁄_º
;

915 
ldns_rdf
 *
«me_rdf
;

917 
∑ckë
 = 
	`ldns_pkt_√w
();

918 i‡(!
∑ckë
) {

919  
LDNS_STATUS_MEM_ERR
;

922 i‡(!
	`ldns_pkt_£t_Êags
(
∑ckë
, 
Êags
)) {

923  
LDNS_STATUS_ERR
;

926 
que°i⁄_º
 = 
	`ldns_º_√w
();

927 i‡(!
que°i⁄_º
) {

928  
LDNS_STATUS_MEM_ERR
;

931 i‡(
º_ty≥
 == 0) {

932 
º_ty≥
 = 
LDNS_RR_TYPE_A
;

934 i‡(
º_˛ass
 == 0) {

935 
º_˛ass
 = 
LDNS_RR_CLASS_IN
;

938 i‡(
	`ldns_°r2rdf_d«me
(&
«me_rdf
, 
«me
Ë=
LDNS_STATUS_OK
) {

939 
	`ldns_º_£t_ow√r
(
que°i⁄_º
, 
«me_rdf
);

940 
	`ldns_º_£t_ty≥
(
que°i⁄_º
, 
º_ty≥
);

941 
	`ldns_º_£t_˛ass
(
que°i⁄_º
, 
º_˛ass
);

942 
	`ldns_º_£t_que°i⁄
(
que°i⁄_º
, 
åue
);

944 
	`ldns_pkt_push_º
(
∑ckë
, 
LDNS_SECTION_QUESTION
, 
que°i⁄_º
);

946 
	`ldns_º_‰ì
(
que°i⁄_º
);

947 
	`ldns_pkt_‰ì
(
∑ckë
);

948  
LDNS_STATUS_ERR
;

951 i‡(
authsﬂ_º
) {

952 
	`ldns_pkt_push_º
(
∑ckë
, 
LDNS_SECTION_AUTHORITY
, 
authsﬂ_º
);

955 
∑ckë
->
_tsig_º
 = 
NULL
;

956 
	`ldns_pkt_£t_™swî‰om
(
∑ckë
, 
NULL
);

957 i‡(
p
) {

958 *
p
 = 
∑ckë
;

959  
LDNS_STATUS_OK
;

961 
	`ldns_pkt_‰ì
(
∑ckë
);

962  
LDNS_STATUS_NULL
;

964 
	}
}

966 
ldns_°©us


967 
	$ldns_pkt_quîy_√w_‰m_°r
(
ldns_pkt
 **
p
, c⁄° *
«me
,

968 
ldns_º_ty≥
 
º_ty≥
, 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
)

970  
	`ldns_pkt_quîy_√w_‰m_°r_öã∫Æ
(
p
, 
«me
, 
º_ty≥
,

971 
º_˛ass
, 
Êags
, 
NULL
);

972 
	}
}

974 
ldns_°©us


975 
	$ldns_pkt_ix‰_ªque°_√w_‰m_°r
(
ldns_pkt
 **
p
, c⁄° *
«me
,

976 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
, 
ldns_º
 *
sﬂ
)

978 
ldns_º
* 
authsﬂ_º
 = 
sﬂ
;

979 i‡(!
authsﬂ_º
) {

980 
ldns_rdf
 *
«me_rdf
;

981 i‡(
	`ldns_°r2rdf_d«me
(&
«me_rdf
, 
«me
Ë=
LDNS_STATUS_OK
) {

982 
authsﬂ_º
 = 
	`ldns_pkt_authsﬂ
(
«me_rdf
, 
º_˛ass
);

984 
	`ldns_rdf_‰ì
(
«me_rdf
);

986  
	`ldns_pkt_quîy_√w_‰m_°r_öã∫Æ
(
p
, 
«me
, 
LDNS_RR_TYPE_IXFR
,

987 
º_˛ass
, 
Êags
, 
authsﬂ_º
);

988 
	}
}

990 
ldns_pkt
 *

991 
	$ldns_pkt_quîy_√w_öã∫Æ
(
ldns_rdf
 *
º_«me
, 
ldns_º_ty≥
 
º_ty≥
,

992 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
, 
ldns_º
* 
authsﬂ_º
)

994 
ldns_pkt
 *
∑ckë
;

995 
ldns_º
 *
que°i⁄_º
;

997 
∑ckë
 = 
	`ldns_pkt_√w
();

998 i‡(!
∑ckë
) {

999  
NULL
;

1002 i‡(!
	`ldns_pkt_£t_Êags
(
∑ckë
, 
Êags
)) {

1003  
NULL
;

1006 
que°i⁄_º
 = 
	`ldns_º_√w
();

1007 i‡(!
que°i⁄_º
) {

1008 
	`ldns_pkt_‰ì
(
∑ckë
);

1009  
NULL
;

1012 i‡(
º_ty≥
 == 0) {

1013 
º_ty≥
 = 
LDNS_RR_TYPE_A
;

1015 i‡(
º_˛ass
 == 0) {

1016 
º_˛ass
 = 
LDNS_RR_CLASS_IN
;

1019 
	`ldns_º_£t_ow√r
(
que°i⁄_º
, 
º_«me
);

1020 
	`ldns_º_£t_ty≥
(
que°i⁄_º
, 
º_ty≥
);

1021 
	`ldns_º_£t_˛ass
(
que°i⁄_º
, 
º_˛ass
);

1022 
	`ldns_º_£t_que°i⁄
(
que°i⁄_º
, 
åue
);

1023 
	`ldns_pkt_push_º
(
∑ckë
, 
LDNS_SECTION_QUESTION
, 
que°i⁄_º
);

1025 i‡(
authsﬂ_º
) {

1026 
	`ldns_pkt_push_º
(
∑ckë
, 
LDNS_SECTION_AUTHORITY
, 
authsﬂ_º
);

1029 
∑ckë
->
_tsig_º
 = 
NULL
;

1030  
∑ckë
;

1031 
	}
}

1033 
ldns_pkt
 *

1034 
	$ldns_pkt_quîy_√w
(
ldns_rdf
 *
º_«me
, 
ldns_º_ty≥
 
º_ty≥
,

1035 
ldns_º_˛ass
 
º_˛ass
, 
uöt16_t
 
Êags
)

1037  
	`ldns_pkt_quîy_√w_öã∫Æ
(
º_«me
, 
º_ty≥
,

1038 
º_˛ass
, 
Êags
, 
NULL
);

1039 
	}
}

1041 
ldns_pkt
 *

1042 
	$ldns_pkt_ix‰_ªque°_√w
(
ldns_rdf
 *
º_«me
, 
ldns_º_˛ass
 
º_˛ass
,

1043 
uöt16_t
 
Êags
, 
ldns_º
* 
sﬂ
)

1045 
ldns_º
* 
authsﬂ_º
 = 
sﬂ
;

1046 i‡(!
authsﬂ_º
) {

1047 
authsﬂ_º
 = 
	`ldns_pkt_authsﬂ
(
º_«me
, 
º_˛ass
);

1049  
	`ldns_pkt_quîy_√w_öã∫Æ
(
º_«me
, 
LDNS_RR_TYPE_IXFR
,

1050 
º_˛ass
, 
Êags
, 
authsﬂ_º
);

1051 
	}
}

1053 
ldns_pkt_ty≥


1054 
	$ldns_pkt_ª∂y_ty≥
(
ldns_pkt
 *
p
)

1056 
ldns_º_li°
 *
tmp
;

1058 i‡(!
p
) {

1059  
LDNS_PACKET_UNKNOWN
;

1062 i‡(
	`ldns_pkt_gë_rcode
(
p
Ë=
LDNS_RCODE_NXDOMAIN
) {

1063  
LDNS_PACKET_NXDOMAIN
;

1066 i‡(
	`ldns_pkt_™cou¡
(
p
Ë=0 && 
	`ldns_pkt_¨cou¡
(p) == 0

1067 && 
	`ldns_pkt_nscou¡
(
p
) == 1) {

1070 
tmp
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_SOA
,

1071 
LDNS_SECTION_AUTHORITY
);

1072 i‡(
tmp
) {

1073 
	`ldns_º_li°_dìp_‰ì
(
tmp
);

1074  
LDNS_PACKET_NODATA
;

1080 i‡(
	`ldns_pkt_™cou¡
(
p
Ë=0 && 
	`ldns_pkt_nscou¡
(p) > 0) {

1081 
tmp
 = 
	`ldns_pkt_º_li°_by_ty≥
(
p
, 
LDNS_RR_TYPE_NS
,

1082 
LDNS_SECTION_AUTHORITY
);

1083 i‡(
tmp
) {

1085 
	`ldns_º_li°_dìp_‰ì
(
tmp
);

1086  
LDNS_PACKET_REFERRAL
;

1090 
	`ldns_º_li°_dìp_‰ì
(
tmp
);

1096  
LDNS_PACKET_ANSWER
;

1097 
	}
}

1099 
ldns_pkt
 *

1100 
	$ldns_pkt_˛⁄e
(
ldns_pkt
 *
pkt
)

1102 
ldns_pkt
 *
√w_pkt
;

1104 i‡(!
pkt
) {

1105  
NULL
;

1107 
√w_pkt
 = 
	`ldns_pkt_√w
();

1109 
	`ldns_pkt_£t_id
(
√w_pkt
, 
	`ldns_pkt_id
(
pkt
));

1110 
	`ldns_pkt_£t_qr
(
√w_pkt
, 
	`ldns_pkt_qr
(
pkt
));

1111 
	`ldns_pkt_£t_Ø
(
√w_pkt
, 
	`ldns_pkt_Ø
(
pkt
));

1112 
	`ldns_pkt_£t_tc
(
√w_pkt
, 
	`ldns_pkt_tc
(
pkt
));

1113 
	`ldns_pkt_£t_rd
(
√w_pkt
, 
	`ldns_pkt_rd
(
pkt
));

1114 
	`ldns_pkt_£t_cd
(
√w_pkt
, 
	`ldns_pkt_cd
(
pkt
));

1115 
	`ldns_pkt_£t_ø
(
√w_pkt
, 
	`ldns_pkt_ø
(
pkt
));

1116 
	`ldns_pkt_£t_ad
(
√w_pkt
, 
	`ldns_pkt_ad
(
pkt
));

1117 
	`ldns_pkt_£t_›code
(
√w_pkt
, 
	`ldns_pkt_gë_›code
(
pkt
));

1118 
	`ldns_pkt_£t_rcode
(
√w_pkt
, 
	`ldns_pkt_gë_rcode
(
pkt
));

1119 
	`ldns_pkt_£t_qdcou¡
(
√w_pkt
, 
	`ldns_pkt_qdcou¡
(
pkt
));

1120 
	`ldns_pkt_£t_™cou¡
(
√w_pkt
, 
	`ldns_pkt_™cou¡
(
pkt
));

1121 
	`ldns_pkt_£t_nscou¡
(
√w_pkt
, 
	`ldns_pkt_nscou¡
(
pkt
));

1122 
	`ldns_pkt_£t_¨cou¡
(
√w_pkt
, 
	`ldns_pkt_¨cou¡
(
pkt
));

1123 i‡(
	`ldns_pkt_™swî‰om
(
pkt
))

1124 
	`ldns_pkt_£t_™swî‰om
(
√w_pkt
,

1125 
	`ldns_rdf_˛⁄e
(
	`ldns_pkt_™swî‰om
(
pkt
)));

1126 
	`ldns_pkt_£t_quîytime
(
√w_pkt
, 
	`ldns_pkt_quîytime
(
pkt
));

1127 
	`ldns_pkt_£t_size
(
√w_pkt
, 
	`ldns_pkt_size
(
pkt
));

1128 
	`ldns_pkt_£t_tsig
(
√w_pkt
, 
	`ldns_º_˛⁄e
(
	`ldns_pkt_tsig
(
pkt
)));

1130 
	`ldns_pkt_£t_edns_udp_size
(
√w_pkt
, 
	`ldns_pkt_edns_udp_size
(
pkt
));

1131 
	`ldns_pkt_£t_edns_exãnded_rcode
(
√w_pkt
,

1132 
	`ldns_pkt_edns_exãnded_rcode
(
pkt
));

1133 
	`ldns_pkt_£t_edns_vîsi⁄
(
√w_pkt
, 
	`ldns_pkt_edns_vîsi⁄
(
pkt
));

1134 
	`ldns_pkt_£t_edns_z
(
√w_pkt
, 
	`ldns_pkt_edns_z
(
pkt
));

1135 if(
	`ldns_pkt_edns_d©a
(
pkt
))

1136 
	`ldns_pkt_£t_edns_d©a
(
√w_pkt
,

1137 
	`ldns_rdf_˛⁄e
(
	`ldns_pkt_edns_d©a
(
pkt
)));

1138 
	`ldns_pkt_£t_edns_do
(
√w_pkt
, 
	`ldns_pkt_edns_do
(
pkt
));

1140 
	`ldns_º_li°_dìp_‰ì
(
√w_pkt
->
_que°i⁄
);

1141 
	`ldns_º_li°_dìp_‰ì
(
√w_pkt
->
_™swî
);

1142 
	`ldns_º_li°_dìp_‰ì
(
√w_pkt
->
_auth‹ôy
);

1143 
	`ldns_º_li°_dìp_‰ì
(
√w_pkt
->
_addôi⁄Æ
);

1144 
√w_pkt
->
_que°i⁄
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_que°i⁄
(
pkt
));

1145 
√w_pkt
->
_™swî
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_™swî
(
pkt
));

1146 
√w_pkt
->
_auth‹ôy
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_auth‹ôy
(
pkt
));

1147 
√w_pkt
->
_addôi⁄Æ
 = 
	`ldns_º_li°_˛⁄e
(
	`ldns_pkt_addôi⁄Æ
(
pkt
));

1148  
√w_pkt
;

1149 
	}
}

	@parse.c

10 
	~<ldns/c⁄fig.h
>

11 
	~<ldns/ldns.h
>

13 
	~<limôs.h
>

14 
	~<°rögs.h
>

16 
ldns_lookup_èbÀ
 
	gldns_dúe˘ive_ty≥s
[] = {

17 { 
LDNS_DIR_TTL
, "$TTL" },

18 { 
LDNS_DIR_ORIGIN
, "$ORIGIN" },

19 { 
LDNS_DIR_INCLUDE
, "$INCLUDE" },

20 { 0, 
NULL
 }

24 
ssize_t


25 
	$ldns_fgë_tokí
(
FILE
 *
f
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
)

27  
	`ldns_fgë_tokí_l
(
f
, 
tokí
, 
dñim
, 
limô
, 
NULL
);

28 
	}
}

30 
ssize_t


31 
	$ldns_fgë_tokí_l
(
FILE
 *
f
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
, *
löe_ƒ
)

33 
c
, 
¥ev_c
;

34 
p
;

35 
com
, 
quŸed
;

36 *
t
;

37 
size_t
 
i
;

38 c⁄° *
d
;

39 c⁄° *
dñ
;

42 i‡(!
dñim
) {

44 
dñ
 = 
LDNS_PARSE_NORMAL
;

46 
dñ
 = 
dñim
;

49 
p
 = 0;

50 
i
 = 0;

51 
com
 = 0;

52 
quŸed
 = 0;

53 
¥ev_c
 = 0;

54 
t
 = 
tokí
;

55 i‡(
dñ
[0] == '"') {

56 
quŸed
 = 1;

58 (
c
 = 
	`gëc
(
f
)Ë!
EOF
) {

59 i‡(
c
 == '\r')

60 
c
 = ' ';

61 i‡(
c
 ='(' && 
¥ev_c
 !'\\' && !
quŸed
) {

63 i‡(
com
 == 0) {

64 
p
++;

66 
¥ev_c
 = 
c
;

70 i‡(
c
 =')' && 
¥ev_c
 !'\\' && !
quŸed
) {

72 i‡(
com
 == 0) {

73 
p
--;

75 
¥ev_c
 = 
c
;

79 i‡(
p
 < 0) {

81 *
t
 = '\0';

86 i‡(
c
 =';' && 
quŸed
 == 0) {

87 i‡(
¥ev_c
 != '\\') {

88 
com
 = 1;

91 i‡(
c
 ='\"' && 
com
 =0 && 
¥ev_c
 != '\\') {

92 
quŸed
 = 1 - quoted;

95 i‡(
c
 ='\n' && 
com
 != 0) {

97 
com
 = 0;

98 *
t
 = ' ';

99 i‡(
löe_ƒ
) {

100 *
löe_ƒ
 = *line_nr + 1;

102 i‡(
p
 =0 && 
i
 > 0) {

103 
tokíªad
;

105 
¥ev_c
 = 
c
;

110 i‡(
com
 == 1) {

111 *
t
 = ' ';

112 
¥ev_c
 = 
c
;

116 i‡(
c
 ='\n' && 
p
 !0 && 
t
 > 
tokí
) {

118 i‡(
löe_ƒ
) {

119 *
löe_ƒ
 = *line_nr + 1;

121 *
t
++ = ' ';

122 
¥ev_c
 = 
c
;

127 
d
 = 
dñ
; *d; d++) {

128 i‡(
c
 =*
d
 && 
i
 > 0 && 
¥ev_c
 !'\\' && 
p
 == 0) {

129 i‡(
c
 ='\n' && 
löe_ƒ
) {

130 *
löe_ƒ
 = *line_nr + 1;

132 
tokíªad
;

135 i‡(
c
 != '\0' && c != '\n') {

136 
i
++;

138 i‡(
limô
 > 0 && (
i
 >limô || (
size_t
)(
t
-
tokí
) >=Üimit)) {

139 *
t
 = '\0';

142 i‡(
c
 != '\0' && c != '\n') {

143 *
t
++ = 
c
;

145 i‡(
c
 ='\\' && 
¥ev_c
 == '\\')

146 
¥ev_c
 = 0;

147 
¥ev_c
 = 
c
;

149 *
t
 = '\0';

150 i‡(
c
 =
EOF
) {

151  (
ssize_t
)
i
;

154 i‡(
i
 == 0) {

158 i‡(
p
 != 0) {

161  (
ssize_t
)
i
;

163 
tokíªad
:

164 
	`ldns_fskùcs_l
(
f
, 
dñ
, 
löe_ƒ
);

165 *
t
 = '\0';

166 i‡(
p
 != 0) {

170  (
ssize_t
)
i
;

171 
	}
}

173 
ssize_t


174 
	$ldns_fgë_keyw‹d_d©a
(
FILE
 *
f
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
,

175 c⁄° *
d_dñ
, 
size_t
 
d©a_limô
)

177  
	`ldns_fgë_keyw‹d_d©a_l
(
f
, 
keyw‹d
, 
k_dñ
, 
d©a
, 
d_dñ
,

178 
d©a_limô
, 
NULL
);

179 
	}
}

181 
ssize_t


182 
	$ldns_fgë_keyw‹d_d©a_l
(
FILE
 *
f
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, *
d©a
,

183 c⁄° *
d_dñ
, 
size_t
 
d©a_limô
, *
löe_ƒ
)

186 *
fkeyw‹d
;

187 
ssize_t
 
i
;

189 if(
	`°æí
(
keyw‹d
Ë>
LDNS_MAX_KEYWORDLEN
)

191 
fkeyw‹d
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_KEYWORDLEN
);

192 if(!
fkeyw‹d
)

195 
i
 = 
	`ldns_fgë_tokí
(
f
, 
fkeyw‹d
, 
k_dñ
, 
LDNS_MAX_KEYWORDLEN
);

196 if(
i
==0 || i==-1) {

197 
	`LDNS_FREE
(
fkeyw‹d
);

202 i‡(
	`°∫cmp
(
fkeyw‹d
, 
keyw‹d
, 
LDNS_MAX_KEYWORDLEN
 - 1) == 0) {

205 
i
 = 
	`ldns_fgë_tokí_l
(
f
, 
d©a
, 
d_dñ
, 
d©a_limô
, 
löe_ƒ
);

206 
	`LDNS_FREE
(
fkeyw‹d
);

207  
i
;

210 
	`LDNS_FREE
(
fkeyw‹d
);

213 
	}
}

216 
ssize_t


217 
	$ldns_bgë_tokí
(
ldns_buf„r
 *
b
, *
tokí
, c⁄° *
dñim
, 
size_t
 
limô
)

219 
c
, 
lc
;

220 
p
;

221 
com
, 
quŸed
;

222 *
t
;

223 
size_t
 
i
;

224 c⁄° *
d
;

225 c⁄° *
dñ
;

228 i‡(!
dñim
) {

230 
dñ
 = 
LDNS_PARSE_NORMAL
;

232 
dñ
 = 
dñim
;

235 
p
 = 0;

236 
i
 = 0;

237 
com
 = 0;

238 
quŸed
 = 0;

239 
t
 = 
tokí
;

240 
lc
 = 0;

241 i‡(
dñ
[0] == '"') {

242 
quŸed
 = 1;

245 (
c
 = 
	`ldns_bgëc
(
b
)Ë!
EOF
) {

246 i‡(
c
 == '\r')

247 
c
 = ' ';

248 i‡(
c
 ='(' && 
lc
 !'\\' && !
quŸed
) {

250 i‡(
com
 == 0) {

251 
p
++;

253 
lc
 = 
c
;

257 i‡(
c
 =')' && 
lc
 !'\\' && !
quŸed
) {

259 i‡(
com
 == 0) {

260 
p
--;

262 
lc
 = 
c
;

266 i‡(
p
 < 0) {

268 *
t
 = '\0';

273 i‡(
c
 =';' && 
quŸed
 == 0) {

274 i‡(
lc
 != '\\') {

275 
com
 = 1;

278 i‡(
c
 ='"' && 
com
 =0 && 
lc
 != '\\') {

279 
quŸed
 = 1 - quoted;

282 i‡(
c
 ='\n' && 
com
 != 0) {

284 
com
 = 0;

285 *
t
 = ' ';

286 
lc
 = 
c
;

290 i‡(
com
 == 1) {

291 *
t
 = ' ';

292 
lc
 = 
c
;

296 i‡(
c
 ='\n' && 
p
 != 0) {

298 *
t
++ = ' ';

299 
lc
 = 
c
;

304 
d
 = 
dñ
; *d; d++) {

305 i‡(
c
 =*
d
 && 
lc
 !'\\' && 
p
 == 0) {

306 
tokíªad
;

310 
i
++;

311 i‡(
limô
 > 0 && (
i
 >limô || (
size_t
)(
t
-
tokí
) >=Üimit)) {

312 *
t
 = '\0';

315 *
t
++ = 
c
;

317 i‡(
c
 ='\\' && 
lc
 == '\\') {

318 
lc
 = 0;

320 
lc
 = 
c
;

323 *
t
 = '\0';

324 i‡(
i
 == 0) {

328 i‡(
p
 != 0) {

331  (
ssize_t
)
i
;

333 
tokíªad
:

334 
	`ldns_bskùcs
(
b
, 
dñ
);

335 *
t
 = '\0';

337 i‡(
p
 != 0) {

340  (
ssize_t
)
i
;

341 
	}
}

345 
	$ldns_bskùcs
(
ldns_buf„r
 *
buf„r
, c⁄° *
s
)

347 
boﬁ
 
found
;

348 
c
;

349 c⁄° *
d
;

351 
	`ldns_buf„r_avaûabÀ_©
(
buf„r
, buf„r->
_posôi⁄
, ())) {

352 
c
 = (Ë
	`ldns_buf„r_ªad_u8_©
(
buf„r
, buf„r->
_posôi⁄
);

353 
found
 = 
Ál£
;

354 
d
 = 
s
; *d; d++) {

355 i‡(*
d
 =
c
) {

356 
found
 = 
åue
;

359 i‡(
found
 && 
buf„r
->
_limô
 > buf„r->
_posôi⁄
) {

360 
buf„r
->
_posôi⁄
 += ();

365 
	}
}

368 
	$ldns_fskùcs
(
FILE
 *
Â
, c⁄° *
s
)

370 
	`ldns_fskùcs_l
(
Â
, 
s
, 
NULL
);

371 
	}
}

374 
	$ldns_fskùcs_l
(
FILE
 *
Â
, c⁄° *
s
, *
löe_ƒ
)

376 
boﬁ
 
found
;

377 
c
;

378 c⁄° *
d
;

380 (
c
 = 
	`fgëc
(
Â
)Ë!
EOF
) {

381 i‡(
löe_ƒ
 && 
c
 == '\n') {

382 *
löe_ƒ
 = *line_nr + 1;

384 
found
 = 
Ál£
;

385 
d
 = 
s
; *d; d++) {

386 i‡(*
d
 =
c
) {

387 
found
 = 
åue
;

390 i‡(!
found
) {

392 
	`ungëc
(
c
, 
Â
);

396 
	}
}

398 
ssize_t


399 
	$ldns_bgë_keyw‹d_d©a
(
ldns_buf„r
 *
b
, c⁄° *
keyw‹d
, c⁄° *
k_dñ
, 

400 *
d©a
, c⁄° *
d_dñ
, 
size_t
 
d©a_limô
)

403 *
fkeyw‹d
;

404 
ssize_t
 
i
;

406 if(
	`°æí
(
keyw‹d
Ë>
LDNS_MAX_KEYWORDLEN
)

408 
fkeyw‹d
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_KEYWORDLEN
);

409 if(!
fkeyw‹d
)

412 
i
 = 
	`ldns_bgë_tokí
(
b
, 
fkeyw‹d
, 
k_dñ
, 
d©a_limô
);

413 if(
i
==0 || i==-1) {

414 
	`LDNS_FREE
(
fkeyw‹d
);

419 i‡(
	`°∫cmp
(
fkeyw‹d
, 
keyw‹d
, 
	`°æí
(keyword)) == 0) {

420 
	`LDNS_FREE
(
fkeyw‹d
);

423 
i
 = 
	`ldns_bgë_tokí
(
b
, 
d©a
, 
d_dñ
, 0);

424  
i
;

426 
	`LDNS_FREE
(
fkeyw‹d
);

429 
	}
}

	@radix.c

44 
	~<ldns/c⁄fig.h
>

45 
	~<ldns/ødix.h
>

46 
	~<ldns/utû.h
>

47 
	~<°dlib.h
>

50 
ldns_ødix_node_t
* 
ldns_ødix_√w_node
(* 
d©a
, 
uöt8_t
* 
key
,

51 
ødix_°æí_t
 
Àn
);

52 
ldns_ødix_föd_¥efix
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

53 
ødix_°æí_t
 
Àn
, 
ldns_ødix_node_t
** 
ªsu…
,Ñadix_°æí_t* 
pos
);

54 
ldns_ødix_¨øy_•a˚
(
ldns_ødix_node_t
* 
node
, 
uöt8_t
 
byã
);

55 
ldns_ødix_¨øy_grow
(
ldns_ødix_node_t
* 
node
, 
√ed
);

56 
ldns_ødix_°r_¸óã
(
ldns_ødix_¨øy_t
* 
¨øy
, 
uöt8_t
* 
key
,

57 
ødix_°æí_t
 
pos
,Ñadix_°æí_à
Àn
);

58 
ldns_ødix_¥efix_ªmaödî
(
ødix_°æí_t
 
¥efix_Àn
,

59 
uöt8_t
* 
l⁄gî_°r
, 
ødix_°æí_t
 
l⁄gî_Àn
, uöt8_t** 
•lô_°r
,

60 
ødix_°æí_t
* 
•lô_Àn
);

61 
ldns_ødix_¨øy_•lô
(
ldns_ødix_¨øy_t
* 
¨øy
, 
uöt8_t
* 
key
,

62 
ødix_°æí_t
 
pos
,Ñadix_°æí_à
Àn
, 
ldns_ødix_node_t
* 
add
);

63 
ldns_ødix_°r_is_¥efix
(
uöt8_t
* 
°r1
, 
ødix_°æí_t
 
Àn1
,

64 
uöt8_t
* 
°r2
, 
ødix_°æí_t
 
Àn2
);

65 
ødix_°æí_t
 
ldns_ødix_°r_comm⁄
(
uöt8_t
* 
°r1
,Ñadix_°æí_à
Àn1
,

66 
uöt8_t
* 
°r2
, 
ødix_°æí_t
 
Àn2
);

67 
ldns_ødix_node_t
* 
ldns_ødix_√xt_ö_subåì
÷dns_ødix_node_t* 
node
);

68 
ldns_ødix_node_t
* 
ldns_ødix_¥ev_‰om_ödex
÷dns_ødix_node_t* 
node
,

69 
uöt8_t
 
ödex
);

70 
ldns_ødix_node_t
* 
ldns_ødix_œ°_ö_subåì_ö˛_£lf
(

71 
ldns_ødix_node_t
* 
node
);

72 
ldns_ødix_node_t
* 
ldns_ødix_œ°_ö_subåì
÷dns_ødix_node_t* 
node
);

73 
ldns_ødix_dñ_fix
(
ldns_ødix_t
* 
åì
, 
ldns_ødix_node_t
* 
node
);

74 
ldns_ødix_˛ónup_⁄echûd
(
ldns_ødix_node_t
* 
node
);

75 
ldns_ødix_˛ónup_Àaf
(
ldns_ødix_node_t
* 
node
);

76 
ldns_ødix_node_‰ì
(
ldns_ødix_node_t
* 
node
, * 
¨g
);

77 
ldns_ødix_node_¨øy_‰ì
(
ldns_ødix_node_t
* 
node
);

78 
ldns_ødix_node_¨øy_‰ì_‰⁄t
(
ldns_ødix_node_t
* 
node
);

79 
ldns_ødix_node_¨øy_‰ì_íd
(
ldns_ødix_node_t
* 
node
);

80 
ldns_ødix_¨øy_ªdu˚
(
ldns_ødix_node_t
* 
node
);

81 
ldns_ødix_£lf_‹_¥ev
(
ldns_ødix_node_t
* 
node
,

82 
ldns_ødix_node_t
** 
ªsu…
);

89 
ldns_ødix_node_t
*

90 
	$ldns_ødix_√w_node
(* 
d©a
, 
uöt8_t
* 
key
, 
ødix_°æí_t
 
Àn
)

92 
ldns_ødix_node_t
* 
node
 = 
	`LDNS_MALLOC
(ldns_radix_node_t);

93 i‡(!
node
) {

94  
NULL
;

96 
node
->
d©a
 = data;

97 
node
->
key
 = key;

98 
node
->
kÀn
 = 
Àn
;

99 
node
->
∑ª¡
 = 
NULL
;

100 
node
->
∑ª¡_ödex
 = 0;

101 
node
->
Àn
 = 0;

102 
node
->
off£t
 = 0;

103 
node
->
ˇ∑côy
 = 0;

104 
node
->
¨øy
 = 
NULL
;

105  
node
;

106 
	}
}

113 
ldns_ødix_t
 *

114 
	$ldns_ødix_¸óã
()

116 
ldns_ødix_t
* 
åì
;

119 
åì
 = (
ldns_ødix_t
 *Ë
	`LDNS_MALLOC
(ldns_radix_t);

120 i‡(!
åì
) {

121  
NULL
;

124 
	`ldns_ødix_öô
(
åì
);

125  
åì
;

126 
	}
}

134 
	$ldns_ødix_öô
(
ldns_ødix_t
* 
åì
)

137 i‡(
åì
) {

138 
åì
->
roŸ
 = 
NULL
;

139 
åì
->
cou¡
 = 0;

142 
	}
}

150 
	$ldns_ødix_‰ì
(
ldns_ødix_t
* 
åì
)

152 i‡(
åì
) {

153 i‡(
åì
->
roŸ
) {

154 
	`ldns_ødix_åavî£_po°‹dî
(
åì
->
roŸ
,

155 
ldns_ødix_node_‰ì
, 
NULL
);

157 
	`LDNS_FREE
(
åì
);

160 
	}
}

167 
ldns_°©us


168 
	$ldns_ødix_ö£π
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
, 
ødix_°æí_t
 
Àn
,

169 * 
d©a
)

171 
ødix_°æí_t
 
pos
 = 0;

172 
ldns_ødix_node_t
* 
add
 = 
NULL
;

173 
ldns_ødix_node_t
* 
¥efix
 = 
NULL
;

175 i‡(!
åì
 || !
key
 || !
d©a
) {

176  
LDNS_STATUS_NULL
;

178 
add
 = 
	`ldns_ødix_√w_node
(
d©a
, 
key
, 
Àn
);

179 i‡(!
add
) {

180  
LDNS_STATUS_MEM_ERR
;

183 i‡(!
	`ldns_ødix_föd_¥efix
(
åì
, 
key
, 
Àn
, &
¥efix
, &
pos
)) {

185 
	`as£π
(
åì
->
roŸ
 =
NULL
);

186 i‡(
Àn
 == 0) {

191 
åì
->
roŸ
 = 
add
;

197 
¥efix
 = 
	`ldns_ødix_√w_node
(
NULL
, (
uöt8_t
*)"", 0);

198 i‡(!
¥efix
) {

199 
	`LDNS_FREE
(
add
);

200  
LDNS_STATUS_MEM_ERR
;

203 i‡(!
	`ldns_ødix_¨øy_•a˚
(
¥efix
, 
key
[0])) {

204 
	`LDNS_FREE
(
add
);

205 
	`LDNS_FREE
(
¥efix
->
¨øy
);

206 
	`LDNS_FREE
(
¥efix
);

207  
LDNS_STATUS_MEM_ERR
;

210 
add
->
∑ª¡
 = 
¥efix
;

211 
add
->
∑ª¡_ödex
 = 0;

212 
¥efix
->
¨øy
[0].
edge
 = 
add
;

213 i‡(
Àn
 > 1) {

215 i‡(!
	`ldns_ødix_¥efix_ªmaödî
(1, 
key
,

216 
Àn
, &
¥efix
->
¨øy
[0].
°r
,

217 &
¥efix
->
¨øy
[0].
Àn
)) {

218 
	`LDNS_FREE
(
add
);

219 
	`LDNS_FREE
(
¥efix
->
¨øy
);

220 
	`LDNS_FREE
(
¥efix
);

221  
LDNS_STATUS_MEM_ERR
;

224 
åì
->
roŸ
 = 
¥efix
;

226 } i‡(
pos
 =
Àn
) {

228 i‡(
¥efix
->
d©a
) {

230 
	`LDNS_FREE
(
add
);

231  
LDNS_STATUS_EXISTS_ERR
;

233 
¥efix
->
d©a
 = data;

234 
¥efix
->
key
 = key;

235 
¥efix
->
kÀn
 = 
Àn
;

238 
uöt8_t
 
byã
 = 
key
[
pos
];

239 
	`as£π
(
pos
 < 
Àn
);

240 i‡(
byã
 < 
¥efix
->
off£t
 ||

241 (
byã
 - 
¥efix
->
off£t
Ë>¥efix->
Àn
) {

249 i‡(!
	`ldns_ødix_¨øy_•a˚
(
¥efix
, 
byã
)) {

250 
	`LDNS_FREE
(
add
);

251  
LDNS_STATUS_MEM_ERR
;

253 
	`as£π
(
byã
 >
¥efix
->
off£t
);

254 
	`as£π
((
byã
 - 
¥efix
->
off£t
Ë<¥efix->
Àn
);

255 
byã
 -
¥efix
->
off£t
;

256 i‡(
pos
+1 < 
Àn
) {

258 i‡(!
	`ldns_ødix_°r_¸óã
(

259 &
¥efix
->
¨øy
[
byã
], 
key
, 
pos
+1,

260 
Àn
)) {

261 
	`LDNS_FREE
(
add
);

262  
LDNS_STATUS_MEM_ERR
;

266 
add
->
∑ª¡
 = 
¥efix
;

267 
add
->
∑ª¡_ödex
 = 
byã
;

268 
¥efix
->
¨øy
[
byã
].
edge
 = 
add
;

269 } i‡(
¥efix
->
¨øy
[
byã
-¥efix->
off£t
].
edge
 =
NULL
) {

278 
byã
 -
¥efix
->
off£t
;

279 i‡(
pos
+1 < 
Àn
) {

281 i‡(!
	`ldns_ødix_°r_¸óã
(

282 &
¥efix
->
¨øy
[
byã
], 
key
, 
pos
+1,

283 
Àn
)) {

284 
	`LDNS_FREE
(
add
);

285  
LDNS_STATUS_MEM_ERR
;

289 
add
->
∑ª¡
 = 
¥efix
;

290 
add
->
∑ª¡_ödex
 = 
byã
;

291 
¥efix
->
¨øy
[
byã
].
edge
 = 
add
;

297 i‡(!
	`ldns_ødix_¨øy_•lô
(&
¥efix
->
¨øy
[
byã
-’ªfix->
off£t
)],

298 
key
, 
pos
+1, 
Àn
, 
add
)) {

299 
	`LDNS_FREE
(
add
);

300  
LDNS_STATUS_MEM_ERR
;

305 
åì
->
cou¡
 ++;

306  
LDNS_STATUS_OK
;

307 
	}
}

314 * 
	$ldns_ødix_dñëe
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
, 
ødix_°æí_t
 
Àn
)

316 
ldns_ødix_node_t
* 
dñ
 = 
	`ldns_ødix_£¨ch
(
åì
, 
key
, 
Àn
);

317 * 
d©a
 = 
NULL
;

318 i‡(
dñ
) {

319 
åì
->
cou¡
--;

320 
d©a
 = 
dñ
->data;

321 
dñ
->
d©a
 = 
NULL
;

322 
	`ldns_ødix_dñ_fix
(
åì
, 
dñ
);

323  
d©a
;

325  
NULL
;

326 
	}
}

333 
ldns_ødix_node_t
*

334 
	$ldns_ødix_£¨ch
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
, 
ødix_°æí_t
 
Àn
)

336 
ldns_ødix_node_t
* 
node
 = 
NULL
;

337 
ødix_°æí_t
 
pos
 = 0;

338 
uöt8_t
 
byã
 = 0;

340 i‡(!
åì
 || !
key
) {

341  
NULL
;

343 
node
 = 
åì
->
roŸ
;

344 
node
) {

345 i‡(
pos
 =
Àn
) {

346  
node
->
d©a
?node:
NULL
;

348 
byã
 = 
key
[
pos
];

349 i‡(
byã
 < 
node
->
off£t
) {

350  
NULL
;

352 
byã
 -
node
->
off£t
;

353 i‡(
byã
 >
node
->
Àn
) {

354  
NULL
;

356 
pos
++;

357 i‡(
node
->
¨øy
[
byã
].
Àn
 > 0) {

359 i‡(
pos
 + 
node
->
¨øy
[
byã
].
Àn
 >Üen) {

360  
NULL
;

362 i‡(
	`memcmp
(&
key
[
pos
], 
node
->
¨øy
[
byã
].
°r
,

363 
node
->
¨øy
[
byã
].
Àn
) != 0) {

364  
NULL
;

366 
pos
 +
node
->
¨øy
[
byã
].
Àn
;

368 
node
 =Çode->
¨øy
[
byã
].
edge
;

370  
NULL
;

371 
	}
}

380 
	$ldns_ødix_föd_Àss_equÆ
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

381 
ødix_°æí_t
 
Àn
, 
ldns_ødix_node_t
** 
ªsu…
)

383 
ldns_ødix_node_t
* 
node
 = 
NULL
;

384 
ødix_°æí_t
 
pos
 = 0;

385 
uöt8_t
 
byã
;

386 
memcmp_ªs
 = 0;

388 i‡(!
åì
 || !åì->
roŸ
 || !
key
) {

389 *
ªsu…
 = 
NULL
;

393 
node
 = 
åì
->
roŸ
;

394 
pos
 < 
Àn
) {

395 
byã
 = 
key
[
pos
];

396 i‡(
byã
 < 
node
->
off£t
) {

401 
	`ldns_ødix_£lf_‹_¥ev
(
node
, 
ªsu…
);

404 
byã
 -
node
->
off£t
;

405 i‡(
byã
 >
node
->
Àn
) {

410 *
ªsu…
 = 
	`ldns_ødix_œ°_ö_subåì_ö˛_£lf
(
node
);

411 i‡(*
ªsu…
 =
NULL
) {

412 *
ªsu…
 = 
	`ldns_ødix_¥ev
(
node
);

416 
pos
++;

417 i‡(!
node
->
¨øy
[
byã
].
edge
) {

422 *
ªsu…
 = 
	`ldns_ødix_¥ev_‰om_ödex
(
node
, 
byã
);

423 i‡(*
ªsu…
 =
NULL
) {

424 
	`ldns_ødix_£lf_‹_¥ev
(
node
, 
ªsu…
);

428 i‡(
node
->
¨øy
[
byã
].
Àn
 != 0) {

430 i‡(
pos
 + 
node
->
¨øy
[
byã
].
Àn
 >Üen) {

432 i‡(
	`memcmp
(&
key
[
pos
], 
node
->
¨øy
[
byã
].
°r
,

433 
Àn
-
pos
) <= 0) {

435 *
ªsu…
 = 
	`ldns_ødix_¥ev
(

436 
node
->
¨øy
[
byã
].
edge
);

439 *
ªsu…
 = 
	`ldns_ødix_œ°_ö_subåì_ö˛_£lf
(
node
->
¨øy
[
byã
].
edge
);

440 i‡(*
ªsu…
 =
NULL
) {

441 *
ªsu…
 = 
	`ldns_ødix_¥ev
(
node
->
¨øy
[
byã
].
edge
);

446 
memcmp_ªs
 = 
	`memcmp
(&
key
[
pos
], 
node
->
¨øy
[
byã
].
°r
,

447 
node
->
¨øy
[
byã
].
Àn
);

448 i‡(
memcmp_ªs
 < 0) {

449 *
ªsu…
 = 
	`ldns_ødix_¥ev
(

450 
node
->
¨øy
[
byã
].
edge
);

452 } i‡(
memcmp_ªs
 > 0) {

453 *
ªsu…
 = 
	`ldns_ødix_œ°_ö_subåì_ö˛_£lf
(
node
->
¨øy
[
byã
].
edge
);

454 i‡(*
ªsu…
 =
NULL
) {

455 *
ªsu…
 = 
	`ldns_ødix_¥ev
(
node
->
¨øy
[
byã
].
edge
);

460 
pos
 +
node
->
¨øy
[
byã
].
Àn
;

462 
node
 =Çode->
¨øy
[
byã
].
edge
;

464 i‡(
node
->
d©a
) {

466 *
ªsu…
 = 
node
;

470 *
ªsu…
 = 
	`ldns_ødix_¥ev
(
node
);

472 
	}
}

479 
ldns_ødix_node_t
*

480 
	$ldns_ødix_fú°
(
ldns_ødix_t
* 
åì
)

482 
ldns_ødix_node_t
* 
fú°
 = 
NULL
;

483 i‡(!
åì
 || !åì->
roŸ
) {

484  
NULL
;

486 
fú°
 = 
åì
->
roŸ
;

487 i‡(
fú°
->
d©a
) {

488  
fú°
;

490  
	`ldns_ødix_√xt
(
fú°
);

491 
	}
}

498 
ldns_ødix_node_t
*

499 
	$ldns_ødix_œ°
(
ldns_ødix_t
* 
åì
)

501 i‡(!
åì
 || !åì->
roŸ
) {

502  
NULL
;

504  
	`ldns_ødix_œ°_ö_subåì_ö˛_£lf
(
åì
->
roŸ
);

505 
	}
}

512 
ldns_ødix_node_t
*

513 
	$ldns_ødix_√xt
(
ldns_ødix_node_t
* 
node
)

515 i‡(!
node
) {

516  
NULL
;

518 i‡(
node
->
Àn
) {

520 
ldns_ødix_node_t
* 
√xt
 = 
	`ldns_ødix_√xt_ö_subåì
(
node
);

521 i‡(
√xt
) {

522  
√xt
;

526 
node
->
∑ª¡
) {

527 
uöt8_t
 
ödex
 = 
node
->
∑ª¡_ödex
;

528 
node
 =Çode->
∑ª¡
;

529 
ödex
++;

530 ; 
ödex
 < 
node
->
Àn
; index++) {

531 i‡(
node
->
¨øy
[
ödex
].
edge
) {

532 
ldns_ødix_node_t
* 
√xt
;

534 i‡(
node
->
¨øy
[
ödex
].
edge
->
d©a
) {

535  
node
->
¨øy
[
ödex
].
edge
;

538 
√xt
 = 
	`ldns_ødix_√xt_ö_subåì
(
node
);

539 i‡(
√xt
) {

540  
√xt
;

545  
NULL
;

546 
	}
}

553 
ldns_ødix_node_t
*

554 
	$ldns_ødix_¥ev
(
ldns_ødix_node_t
* 
node
)

556 i‡(!
node
) {

557  
NULL
;

561 
node
->
∑ª¡
) {

562 
uöt8_t
 
ödex
 = 
node
->
∑ª¡_ödex
;

563 
ldns_ødix_node_t
* 
¥ev
;

564 
node
 =Çode->
∑ª¡
;

565 
	`as£π
(
node
->
Àn
 > 0);

566 
¥ev
 = 
	`ldns_ødix_¥ev_‰om_ödex
(
node
, 
ödex
);

567 i‡(
¥ev
) {

568  
¥ev
;

570 i‡(
node
->
d©a
) {

571  
node
;

574  
NULL
;

575 
	}
}

583 
	$ldns_ødix_node_¥öt
(
FILE
* 
fd
, 
ldns_ødix_node_t
* 
node
,

584 
uöt8_t
 
i
, uöt8_t* 
°r
, 
ødix_°æí_t
 
Àn
, 
d
)

586 
uöt8_t
 
j
;

587 i‡(!
node
) {

590 
j
 = 0; j < 
d
; j++) {

591 
	`Ârötf
(
fd
, "--");

593 i‡(
°r
) {

594 
ødix_°æí_t
 
l
;

595 
	`Ârötf
(
fd
, "| [%u+", (Ë
i
);

596 
l
=0;Ü < 
Àn
;Ü++) {

597 
	`Ârötf
(
fd
, "%c", (Ë
°r
[
l
]);

599 
	`Ârötf
(
fd
, "]%u", (Ë
Àn
);

601 
	`Ârötf
(
fd
, "| [%u]", (Ë
i
);

604 i‡(
node
->
d©a
) {

605 
	`Ârötf
(
fd
, " %s", (*Ë
node
->
d©a
);

607 
	`Ârötf
(
fd
, "\n");

609 
j
 = 0; j < 
node
->
Àn
; j++) {

610 i‡(
node
->
¨øy
[
j
].
edge
) {

611 
	`ldns_ødix_node_¥öt
(
fd
, 
node
->
¨øy
[
j
].
edge
, j,

612 
node
->
¨øy
[
j
].
°r
,Çode->¨øy[j].
Àn
, 
d
+1);

616 
	}
}

624 
	$ldns_ødix_¥ötf
(
FILE
* 
fd
, 
ldns_ødix_t
* 
åì
)

626 i‡(!
fd
 || !
åì
) {

629 i‡(!
åì
->
roŸ
) {

630 
	`Ârötf
(
fd
, ";ÉmptyÑadixÅree\n");

633 
	`ldns_ødix_node_¥öt
(
fd
, 
åì
->
roŸ
, 0, 
NULL
, 0, 0);

635 
	}
}

642 
ldns_°©us


643 
	$ldns_ødix_joö
(
ldns_ødix_t
* 
åì1
,Üdns_ødix_t* 
åì2
)

645 
ldns_ødix_node_t
* 
cur_node
, *
√xt_node
;

646 
ldns_°©us
 
°©us
;

647 i‡(!
åì2
 || !åì2->
roŸ
) {

648  
LDNS_STATUS_OK
;

652 
cur_node
 = 
	`ldns_ødix_fú°
(
åì2
);

653 
cur_node
) {

654 
°©us
 = 
LDNS_STATUS_NO_DATA
;

656 i‡(
cur_node
->
d©a
) {

657 
°©us
 = 
	`ldns_ødix_ö£π
(
åì1
, 
cur_node
->
key
,

658 
cur_node
->
kÀn
, cur_node->
d©a
);

660 i‡(
°©us
 !
LDNS_STATUS_OK
 &&

661 
°©us
 !
LDNS_STATUS_EXISTS_ERR
) {

662  
°©us
;

665 
√xt_node
 = 
	`ldns_ødix_√xt
(
cur_node
);

666 i‡(
°©us
 =
LDNS_STATUS_OK
) {

667 (Ë
	`ldns_ødix_dñëe
(
åì2
, 
cur_node
->
key
,

668 
cur_node
->
kÀn
);

670 
cur_node
 = 
√xt_node
;

673  
LDNS_STATUS_OK
;

674 
	}
}

681 
ldns_°©us


682 
	$ldns_ødix_•lô
(
ldns_ødix_t
* 
åì1
, 
size_t
 
num
,Üdns_ødix_t** 
åì2
)

684 
size_t
 
cou¡
 = 0;

685 
ldns_ødix_node_t
* 
cur_node
;

686 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

687 i‡(!
åì1
 || !åì1->
roŸ
 || 
num
 == 0) {

688  
LDNS_STATUS_OK
;

690 i‡(!
åì2
) {

691  
LDNS_STATUS_NULL
;

693 i‡(!*
åì2
) {

694 *
åì2
 = 
	`ldns_ødix_¸óã
();

695 i‡(!*
åì2
) {

696  
LDNS_STATUS_MEM_ERR
;

699 
cur_node
 = 
	`ldns_ødix_fú°
(
åì1
);

700 
cou¡
 < 
num
 && 
cur_node
) {

701 i‡(
cur_node
->
d©a
) {

703 
uöt8_t
* 
cur_key
 = 
cur_node
->
key
;

704 
ødix_°æí_t
 
cur_Àn
 = 
cur_node
->
kÀn
;

705 * 
cur_d©a
 = 
	`ldns_ødix_dñëe
(
åì1
, 
cur_key
,

706 
cur_Àn
);

708 i‡(!
cur_d©a
) {

709  
LDNS_STATUS_NO_DATA
;

711 
°©us
 = 
	`ldns_ødix_ö£π
(*
åì2
, 
cur_key
, 
cur_Àn
,

712 
cur_d©a
);

713 i‡(
°©us
 !
LDNS_STATUS_OK
 &&

714 
°©us
 !
LDNS_STATUS_EXISTS_ERR
) {

715  
°©us
;

724 
cou¡
++;

725 
cur_node
 = 
	`ldns_ødix_fú°
(
åì1
);

727 
cur_node
 = 
	`ldns_ødix_√xt
(cur_node);

730  
LDNS_STATUS_OK
;

731 
	}
}

740 
ldns_ødix_åavî£_po°‹dî
(
ldns_ødix_node_t
* 
node
,

741 (*
func
)(
ldns_ødix_node_t
*, *), * 
¨g
)

743 
uöt8_t
 
i
;

744 i‡(!
node
) {

747 
i
=0; i < 
node
->
Àn
; i++) {

748 
	`ldns_ødix_åavî£_po°‹dî
(
node
->
¨øy
[
i
].
edge
,

749 
func
, 
¨g
);

752 (*
func
)(
node
, 
¨g
);

754 
	}
}

773 
	$ldns_ødix_föd_¥efix
(
ldns_ødix_t
* 
åì
, 
uöt8_t
* 
key
,

774 
ødix_°æí_t
 
Àn
, 
ldns_ødix_node_t
** 
ªsu…
,Ñadix_°æí_t* 
ª•os
)

777 
ldns_ødix_node_t
* 
n
 = 
åì
->
roŸ
;

778 
ødix_°æí_t
 
pos
 = 0;

779 
uöt8_t
 
byã
;

780 *
ª•os
 = 0;

781 *
ªsu…
 = 
n
;

782 i‡(!
n
) {

787 
n
) {

788 i‡(
pos
 =
Àn
) {

792 
byã
 = 
key
[
pos
];

793 i‡(
byã
 < 
n
->
off£t
) {

797 
byã
 -
n
->
off£t
;

798 i‡(
byã
 >
n
->
Àn
) {

803 
pos
++;

804 i‡(
n
->
¨øy
[
byã
].
Àn
 != 0) {

806 i‡(
pos
 + 
n
->
¨øy
[
byã
].
Àn
 >Üen) {

809 i‡(
	`memcmp
(&
key
[
pos
], 
n
->
¨øy
[
byã
].
°r
,

810 
n
->
¨øy
[
byã
].
Àn
) != 0) {

813 
pos
 +
n
->
¨øy
[
byã
].
Àn
;

816 
n
 =Ç->
¨øy
[
byã
].
edge
;

817 i‡(!
n
) {

821 *
ª•os
 = 
pos
;

822 *
ªsu…
 = 
n
;

826 
	}
}

837 
	$ldns_ødix_¨øy_•a˚
(
ldns_ødix_node_t
* 
node
, 
uöt8_t
 
byã
)

840 i‡(!
node
->
¨øy
) {

841 
	`as£π
(
node
->
ˇ∑côy
 == 0);

843 
node
->
¨øy
 = 
	`LDNS_MALLOC
(
ldns_ødix_¨øy_t
);

844 i‡(!
node
->
¨øy
) {

847 
	`mem£t
(&
node
->
¨øy
[0], 0, (
ldns_ødix_¨øy_t
));

848 
node
->
Àn
 = 1;

849 
node
->
ˇ∑côy
 = 1;

850 
node
->
off£t
 = 
byã
;

854 
	`as£π
(
node
->
¨øy
 !
NULL
);

855 
	`as£π
(
node
->
ˇ∑côy
 > 0);

857 i‡(
node
->
Àn
 == 0) {

859 
node
->
Àn
 = 1;

860 
node
->
off£t
 = 
byã
;

861 } i‡(
byã
 < 
node
->
off£t
) {

863 
uöt8_t
 
ödex
;

864 
uöt16_t
 
√ed
 = 
node
->
off£t
 - 
byã
;

866 i‡(
node
->
Àn
 + 
√ed
 >Çode->
ˇ∑côy
) {

868 i‡(!
	`ldns_ødix_¨øy_grow
(
node
,

869 (Ë(
node
->
Àn
 + 
√ed
))) {

874 
	`memmove
(&
node
->
¨øy
[
√ed
], &node->array[0],

875 
node
->
Àn
*(
ldns_ødix_¨øy_t
));

877 
ödex
 = 0; index < 
node
->
Àn
; index++) {

878 i‡(
node
->
¨øy
[
ödex
+
√ed
].
edge
) {

879 
node
->
¨øy
[
ödex
+
√ed
].
edge
->
∑ª¡_ödex
 =

880 
ödex
 + 
√ed
;

884 
	`mem£t
(&
node
->
¨øy
[0], 0, 
√ed
*(
ldns_ødix_¨øy_t
));

885 
node
->
Àn
 +
√ed
;

886 
node
->
off£t
 = 
byã
;

887 } i‡(
byã
 - 
node
->
off£t
 >node->
Àn
) {

889 
uöt16_t
 
√ed
 = (
byã
 - 
node
->
off£t
Ë-Çode->
Àn
 + 1;

891 i‡(
node
->
Àn
 + 
√ed
 >Çode->
ˇ∑côy
) {

893 i‡(!
	`ldns_ødix_¨øy_grow
(
node
,

894 (Ë(
node
->
Àn
 + 
√ed
))) {

899 
	`mem£t
(&
node
->
¨øy
[node->
Àn
], 0,

900 
√ed
*(
ldns_ødix_¨øy_t
));

901 
node
->
Àn
 +
√ed
;

904 
	}
}

916 
	$ldns_ødix_¨øy_grow
(
ldns_ødix_node_t
* 
node
, 
√ed
)

918 
size
 = (()
node
->
ˇ∑côy
)*2;

919 
ldns_ødix_¨øy_t
* 
a
 = 
NULL
;

920 i‡(
√ed
 > 
size
) {

921 
size
 = 
√ed
;

923 i‡(
size
 > 256) {

924 
size
 = 256;

926 
a
 = 
	`LDNS_XMALLOC
(
ldns_ødix_¨øy_t
, 
size
);

927 i‡(!
a
) {

930 
	`as£π
(
node
->
Àn
 <node->
ˇ∑côy
);

931 
	`as£π
(
node
->
ˇ∑côy
 < 
size
);

932 
	`mem˝y
(&
a
[0], &
node
->
¨øy
[0],Çode->
Àn
*(
ldns_ødix_¨øy_t
));

933 
	`LDNS_FREE
(
node
->
¨øy
);

934 
node
->
¨øy
 = 
a
;

935 
node
->
ˇ∑côy
 = 
size
;

937 
	}
}

950 
	$ldns_ødix_°r_¸óã
(
ldns_ødix_¨øy_t
* 
¨øy
, 
uöt8_t
* 
key
,

951 
ødix_°æí_t
 
pos
,Ñadix_°æí_à
Àn
)

953 
¨øy
->
°r
 = 
	`LDNS_XMALLOC
(
uöt8_t
, (
Àn
-
pos
));

954 i‡(!
¨øy
->
°r
) {

957 
	`memmove
(
¨øy
->
°r
, 
key
+
pos
, 
Àn
-pos);

958 
¨øy
->
Àn
 = (Àn-
pos
);

960 
	}
}

974 
	$ldns_ødix_¥efix_ªmaödî
(
ødix_°æí_t
 
¥efix_Àn
,

975 
uöt8_t
* 
l⁄gî_°r
, 
ødix_°æí_t
 
l⁄gî_Àn
,

976 
uöt8_t
** 
•lô_°r
, 
ødix_°æí_t
* 
•lô_Àn
)

978 *
•lô_Àn
 = 
l⁄gî_Àn
 - 
¥efix_Àn
;

979 *
•lô_°r
 = 
	`LDNS_XMALLOC
(
uöt8_t
, (*
•lô_Àn
));

980 i‡(!*
•lô_°r
) {

983 
	`memmove
(*
•lô_°r
, 
l⁄gî_°r
+
¥efix_Àn
, 
l⁄gî_Àn
-prefix_len);

985 
	}
}

999 
	$ldns_ødix_¨øy_•lô
(
ldns_ødix_¨øy_t
* 
¨øy
, 
uöt8_t
* 
key
,

1000 
ødix_°æí_t
 
pos
,Ñadix_°æí_à
Àn
, 
ldns_ødix_node_t
* 
add
)

1002 
uöt8_t
* 
°r_to_add
 = 
key
 + 
pos
;

1003 
ødix_°æí_t
 
°æí_to_add
 = 
Àn
 - 
pos
;

1005 i‡(
	`ldns_ødix_°r_is_¥efix
(
°r_to_add
, 
°æí_to_add
,

1006 
¨øy
->
°r
,áºay->
Àn
)) {

1008 
uöt8_t
* 
•lô_°r
 = 
NULL
, *
dup_°r
 = NULL;

1009 
ødix_°æí_t
 
•lô_Àn
 = 0;

1018 
	`as£π
(
°æí_to_add
 < 
¨øy
->
Àn
);

1020 i‡(
¨øy
->
Àn
 - 
°æí_to_add
 > 1) {

1021 i‡(!
	`ldns_ødix_¥efix_ªmaödî
(
°æí_to_add
+1,

1022 
¨øy
->
°r
,áºay->
Àn
, &
•lô_°r
,

1023 &
•lô_Àn
)) {

1028 i‡(
°æí_to_add
 != 0) {

1029 
dup_°r
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
°æí_to_add
);

1030 i‡(!
dup_°r
) {

1031 
	`LDNS_FREE
(
•lô_°r
);

1034 
	`mem˝y
(
dup_°r
, 
°r_to_add
, 
°æí_to_add
);

1037 i‡(!
	`ldns_ødix_¨øy_•a˚
(
add
,

1038 
¨øy
->
°r
[
°æí_to_add
])) {

1039 
	`LDNS_FREE
(
•lô_°r
);

1040 
	`LDNS_FREE
(
dup_°r
);

1047 
add
->
∑ª¡
 = 
¨øy
->
edge
->parent;

1048 
add
->
∑ª¡_ödex
 = 
¨øy
->
edge
->parent_index;

1049 
add
->
¨øy
[0].
edge
 =árray->edge;

1050 
add
->
¨øy
[0].
°r
 = 
•lô_°r
;

1051 
add
->
¨øy
[0].
Àn
 = 
•lô_Àn
;

1052 
¨øy
->
edge
->
∑ª¡
 = 
add
;

1053 
¨øy
->
edge
->
∑ª¡_ödex
 = 0;

1054 
	`LDNS_FREE
(
¨øy
->
°r
);

1055 
¨øy
->
edge
 = 
add
;

1056 
¨øy
->
°r
 = 
dup_°r
;

1057 
¨øy
->
Àn
 = 
°æí_to_add
;

1058 } i‡(
	`ldns_ødix_°r_is_¥efix
(
¨øy
->
°r
,áºay->
Àn
,

1059 
°r_to_add
, 
°æí_to_add
)) {

1070 
uöt8_t
* 
•lô_°r
 = 
NULL
;

1071 
ødix_°æí_t
 
•lô_Àn
 = 0;

1072 
	`as£π
(
¨øy
->
Àn
 < 
°æí_to_add
);

1073 i‡(
°æí_to_add
 - 
¨øy
->
Àn
 > 1) {

1074 i‡(!
	`ldns_ødix_¥efix_ªmaödî
(
¨øy
->
Àn
+1,

1075 
°r_to_add
, 
°æí_to_add
, &
•lô_°r
,

1076 &
•lô_Àn
)) {

1081 i‡(!
	`ldns_ødix_¨øy_•a˚
(
¨øy
->
edge
,

1082 
°r_to_add
[
¨øy
->
Àn
])) {

1083 
	`LDNS_FREE
(
•lô_°r
);

1089 
add
->
∑ª¡
 = 
¨øy
->
edge
;

1090 
add
->
∑ª¡_ödex
 = 
°r_to_add
[
¨øy
->
Àn
] -

1091 
¨øy
->
edge
->
off£t
;

1092 
¨øy
->
edge
->¨øy[
add
->
∑ª¡_ödex
].edge =ádd;

1093 
¨øy
->
edge
->¨øy[
add
->
∑ª¡_ödex
].
°r
 = 
•lô_°r
;

1094 
¨øy
->
edge
->¨øy[
add
->
∑ª¡_ödex
].
Àn
 = 
•lô_Àn
;

1108 
ldns_ødix_node_t
* 
comm⁄
 = 
NULL
;

1109 
uöt8_t
* 
comm⁄_°r
 = 
NULL
, *
s1
 = NULL, *
s2
 = NULL;

1110 
ødix_°æí_t
 
comm⁄_Àn
 = 0, 
l1
 = 0, 
l2
 = 0;

1111 
comm⁄_Àn
 = 
	`ldns_ødix_°r_comm⁄
(
¨øy
->
°r
,áºay->
Àn
,

1112 
°r_to_add
, 
°æí_to_add
);

1113 
	`as£π
(
comm⁄_Àn
 < 
¨øy
->
Àn
);

1114 
	`as£π
(
comm⁄_Àn
 < 
°æí_to_add
);

1116 
comm⁄
 = 
	`ldns_ødix_√w_node
(
NULL
, (
uöt8_t
*)"", 0);

1117 i‡(!
comm⁄
) {

1120 i‡(
¨øy
->
Àn
 - 
comm⁄_Àn
 > 1) {

1121 i‡(!
	`ldns_ødix_¥efix_ªmaödî
(
comm⁄_Àn
+1,

1122 
¨øy
->
°r
,áºay->
Àn
, &
s1
, &
l1
)) {

1126 i‡(
°æí_to_add
 - 
comm⁄_Àn
 > 1) {

1127 i‡(!
	`ldns_ødix_¥efix_ªmaödî
(
comm⁄_Àn
+1,

1128 
°r_to_add
, 
°æí_to_add
, &
s2
, &
l2
)) {

1133 i‡(
comm⁄_Àn
 > 0) {

1134 
comm⁄_°r
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
comm⁄_Àn
);

1135 i‡(!
comm⁄_°r
) {

1136 
	`LDNS_FREE
(
comm⁄
);

1137 
	`LDNS_FREE
(
s1
);

1138 
	`LDNS_FREE
(
s2
);

1141 
	`mem˝y
(
comm⁄_°r
, 
°r_to_add
, 
comm⁄_Àn
);

1144 i‡(!
	`ldns_ødix_¨øy_•a˚
(
comm⁄
, 
¨øy
->
°r
[
comm⁄_Àn
]) ||

1145 !
	`ldns_ødix_¨øy_•a˚
(
comm⁄
, 
°r_to_add
[
comm⁄_Àn
])) {

1146 
	`LDNS_FREE
(
comm⁄
->
¨øy
);

1147 
	`LDNS_FREE
(
comm⁄
);

1148 
	`LDNS_FREE
(
comm⁄_°r
);

1149 
	`LDNS_FREE
(
s1
);

1150 
	`LDNS_FREE
(
s2
);

1157 
comm⁄
->
∑ª¡
 = 
¨øy
->
edge
->parent;

1158 
comm⁄
->
∑ª¡_ödex
 = 
¨øy
->
edge
->parent_index;

1159 
¨øy
->
edge
->
∑ª¡
 = 
comm⁄
;

1160 
¨øy
->
edge
->
∑ª¡_ödex
 =áºay->
°r
[
comm⁄_Àn
] -

1161 
comm⁄
->
off£t
;

1162 
add
->
∑ª¡
 = 
comm⁄
;

1163 
add
->
∑ª¡_ödex
 = 
°r_to_add
[
comm⁄_Àn
] - 
comm⁄
->
off£t
;

1164 
comm⁄
->
¨øy
[¨øy->
edge
->
∑ª¡_ödex
].edge =árray->edge;

1165 
comm⁄
->
¨øy
[¨øy->
edge
->
∑ª¡_ödex
].
°r
 = 
s1
;

1166 
comm⁄
->
¨øy
[¨øy->
edge
->
∑ª¡_ödex
].
Àn
 = 
l1
;

1167 
comm⁄
->
¨øy
[
add
->
∑ª¡_ödex
].
edge
 =ádd;

1168 
comm⁄
->
¨øy
[
add
->
∑ª¡_ödex
].
°r
 = 
s2
;

1169 
comm⁄
->
¨øy
[
add
->
∑ª¡_ödex
].
Àn
 = 
l2
;

1170 
	`LDNS_FREE
(
¨øy
->
°r
);

1171 
¨øy
->
edge
 = 
comm⁄
;

1172 
¨øy
->
°r
 = 
comm⁄_°r
;

1173 
¨øy
->
Àn
 = 
comm⁄_Àn
;

1176 
	}
}

1189 
	$ldns_ødix_°r_is_¥efix
(
uöt8_t
* 
°r1
, 
ødix_°æí_t
 
Àn1
,

1190 
uöt8_t
* 
°r2
, 
ødix_°æí_t
 
Àn2
)

1192 i‡(
Àn1
 == 0) {

1195 i‡(
Àn1
 > 
Àn2
) {

1198  (
	`memcmp
(
°r1
, 
°r2
, 
Àn1
) == 0);

1199 
	}
}

1211 
ødix_°æí_t


1212 
	$ldns_ødix_°r_comm⁄
(
uöt8_t
* 
°r1
, 
ødix_°æí_t
 
Àn1
,

1213 
uöt8_t
* 
°r2
, 
ødix_°æí_t
 
Àn2
)

1215 
ødix_°æí_t
 
i
, 
max
 = (
Àn1
<
Àn2
)?len1:len2;

1216 
i
=0; i<
max
; i++) {

1217 i‡(
°r1
[
i
] !
°r2
[i]) {

1218  
i
;

1221  
max
;

1222 
	}
}

1231 
ldns_ødix_node_t
*

1232 
	$ldns_ødix_√xt_ö_subåì
(
ldns_ødix_node_t
* 
node
)

1234 
uöt16_t
 
i
;

1235 
ldns_ødix_node_t
* 
√xt
;

1237 
i
 = 0; i < 
node
->
Àn
; i++) {

1238 i‡(
node
->
¨øy
[
i
].
edge
) {

1240 i‡(
node
->
¨øy
[
i
].
edge
->
d©a
) {

1241  
node
->
¨øy
[
i
].
edge
;

1244 
√xt
 = 
	`ldns_ødix_√xt_ö_subåì
(
node
->
¨øy
[
i
].
edge
);

1245 i‡(
√xt
) {

1246  
√xt
;

1250  
NULL
;

1251 
	}
}

1261 
ldns_ødix_node_t
*

1262 
	$ldns_ødix_¥ev_‰om_ödex
(
ldns_ødix_node_t
* 
node
, 
uöt8_t
 
ödex
)

1264 
uöt8_t
 
i
 = 
ödex
;

1265 
i
 > 0) {

1266 
i
--;

1267 i‡(
node
->
¨øy
[
i
].
edge
) {

1268 
ldns_ødix_node_t
* 
¥ev
 =

1269 
	`ldns_ødix_œ°_ö_subåì_ö˛_£lf
(
node
);

1270 i‡(
¥ev
) {

1271  
¥ev
;

1275  
NULL
;

1276 
	}
}

1285 
ldns_ødix_node_t
*

1286 
	$ldns_ødix_œ°_ö_subåì_ö˛_£lf
(
ldns_ødix_node_t
* 
node
)

1288 
ldns_ødix_node_t
* 
œ°
 = 
	`ldns_ødix_œ°_ö_subåì
(
node
);

1289 i‡(
œ°
) {

1290  
œ°
;

1291 } i‡(
node
->
d©a
) {

1292  
node
;

1294  
NULL
;

1295 
	}
}

1304 
ldns_ødix_node_t
*

1305 
	$ldns_ødix_œ°_ö_subåì
(
ldns_ødix_node_t
* 
node
)

1307 
i
;

1309 
i
=()(
node
->
Àn
)-1; i >= 0; i--) {

1310 i‡(
node
->
¨øy
[
i
].
edge
) {

1312 i‡(
node
->
¨øy
[
i
].
edge
->
Àn
 > 0) {

1313 
ldns_ødix_node_t
* 
œ°
 =

1314 
	`ldns_ødix_œ°_ö_subåì
(

1315 
node
->
¨øy
[
i
].
edge
);

1316 i‡(
œ°
) {

1317  
œ°
;

1321 i‡(
node
->
¨øy
[
i
].
edge
->
d©a
) {

1322  
node
->
¨øy
[
i
].
edge
;

1326  
NULL
;

1327 
	}
}

1337 
	$ldns_ødix_dñ_fix
(
ldns_ødix_t
* 
åì
, 
ldns_ødix_node_t
* 
node
)

1339 
node
) {

1340 i‡(
node
->
d©a
) {

1343 } i‡(
node
->
Àn
 =1 &&Çode->
∑ª¡
) {

1345 
	`ldns_ødix_˛ónup_⁄echûd
(
node
);

1347 } i‡(
node
->
Àn
 == 0) {

1349 
ldns_ødix_node_t
* 
∑ª¡
 = 
node
->parent;

1350 i‡(!
∑ª¡
) {

1352 
	`ldns_ødix_node_‰ì
(
node
, 
NULL
);

1353 
åì
->
roŸ
 = 
NULL
;

1357 
	`ldns_ødix_˛ónup_Àaf
(
node
);

1358 
node
 = 
∑ª¡
;

1369 
	}
}

1378 
	$ldns_ødix_˛ónup_⁄echûd
(
ldns_ødix_node_t
* 
node
)

1380 
uöt8_t
* 
joö_°r
;

1381 
ødix_°æí_t
 
joö_Àn
;

1382 
uöt8_t
 
∑ª¡_ödex
 = 
node
->parent_index;

1383 
ldns_ødix_node_t
* 
chûd
 = 
node
->
¨øy
[0].
edge
;

1384 
ldns_ødix_node_t
* 
∑ª¡
 = 
node
->parent;

1387 
	`as£π
(
∑ª¡_ödex
 < 
∑ª¡
->
Àn
);

1388 
joö_Àn
 = 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
Àn
 + 
node
->array[0].len + 1;

1390 
joö_°r
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
joö_Àn
);

1391 i‡(!
joö_°r
) {

1400 
	`mem˝y
(
joö_°r
, 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
°r
,

1401 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
Àn
);

1402 
joö_°r
[
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
Àn
] = 
chûd
->parent_index +

1403 
node
->
off£t
;

1404 
	`memmove
(
joö_°r
 + 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
Àn
+1,

1405 
node
->
¨øy
[0].
°r
,Çode->¨øy[0].
Àn
);

1407 
	`LDNS_FREE
(
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
°r
);

1408 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
°r
 = 
joö_°r
;

1409 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
Àn
 = 
joö_Àn
;

1410 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
edge
 = 
chûd
;

1411 
chûd
->
∑ª¡
 =Öarent;

1412 
chûd
->
∑ª¡_ödex
 =Öarent_index;

1413 
	`ldns_ødix_node_‰ì
(
node
, 
NULL
);

1415 
	}
}

1424 
	$ldns_ødix_˛ónup_Àaf
(
ldns_ødix_node_t
* 
node
)

1426 
uöt8_t
 
∑ª¡_ödex
 = 
node
->parent_index;

1427 
ldns_ødix_node_t
* 
∑ª¡
 = 
node
->parent;

1429 
	`as£π
(
∑ª¡_ödex
 < 
∑ª¡
->
Àn
);

1430 
	`ldns_ødix_node_‰ì
(
node
, 
NULL
);

1431 
	`LDNS_FREE
(
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
°r
);

1432 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
°r
 = 
NULL
;

1433 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
Àn
 = 0;

1434 
∑ª¡
->
¨øy
[
∑ª¡_ödex
].
edge
 = 
NULL
;

1436 i‡(
∑ª¡
->
Àn
 == 1) {

1437 
	`ldns_ødix_node_¨øy_‰ì
(
∑ª¡
);

1438 } i‡(
∑ª¡_ödex
 == 0) {

1439 
	`ldns_ødix_node_¨øy_‰ì_‰⁄t
(
∑ª¡
);

1441 
	`ldns_ødix_node_¨øy_‰ì_íd
(
∑ª¡
);

1444 
	}
}

1454 
	$ldns_ødix_node_‰ì
(
ldns_ødix_node_t
* 
node
, * 
¨g
)

1456 
uöt16_t
 
i
;

1457 (Ë
¨g
;

1458 i‡(!
node
) {

1461 
i
=0; i < 
node
->
Àn
; i++) {

1462 
	`LDNS_FREE
(
node
->
¨øy
[
i
].
°r
);

1464 
node
->
key
 = 
NULL
;

1465 
node
->
kÀn
 = 0;

1466 
	`LDNS_FREE
(
node
->
¨øy
);

1467 
	`LDNS_FREE
(
node
);

1469 
	}
}

1478 
	$ldns_ødix_node_¨øy_‰ì
(
ldns_ødix_node_t
* 
node
)

1480 
node
->
off£t
 = 0;

1481 
node
->
Àn
 = 0;

1482 
	`LDNS_FREE
(
node
->
¨øy
);

1483 
node
->
¨øy
 = 
NULL
;

1484 
node
->
ˇ∑côy
 = 0;

1486 
	}
}

1495 
	$ldns_ødix_node_¨øy_‰ì_‰⁄t
(
ldns_ødix_node_t
* 
node
)

1497 
uöt16_t
 
i
, 
n
 = 0;

1499 
n
 < 
node
->
Àn
 &&Çode->
¨øy
[n].
edge
 =
NULL
) {

1500 
n
++;

1502 i‡(
n
 == 0) {

1505 i‡(
n
 =
node
->
Àn
) {

1506 
	`ldns_ødix_node_¨øy_‰ì
(
node
);

1509 
	`as£π
(
n
 < 
node
->
Àn
);

1510 
	`as£π
((Ë
n
 <(255 - (Ë
node
->
off£t
));

1511 
	`memmove
(&
node
->
¨øy
[0], &node->¨øy[
n
],

1512 (
node
->
Àn
 - 
n
)*(
ldns_ødix_¨øy_t
));

1513 
node
->
off£t
 +
n
;

1514 
node
->
Àn
 -
n
;

1515 
i
=0; i < 
node
->
Àn
; i++) {

1516 i‡(
node
->
¨øy
[
i
].
edge
) {

1517 
node
->
¨øy
[
i
].
edge
->
∑ª¡_ödex
 = i;

1520 
	`ldns_ødix_¨øy_ªdu˚
(
node
);

1522 
	}
}

1531 
	$ldns_ødix_node_¨øy_‰ì_íd
(
ldns_ødix_node_t
* 
node
)

1533 
uöt16_t
 
n
 = 0;

1535 
n
 < 
node
->
Àn
 &&Çode->
¨øy
[node->Àn-1-n].
edge
 =
NULL
) {

1536 
n
++;

1538 i‡(
n
 == 0) {

1541 i‡(
n
 =
node
->
Àn
) {

1542 
	`ldns_ødix_node_¨øy_‰ì
(
node
);

1545 
	`as£π
(
n
 < 
node
->
Àn
);

1546 
node
->
Àn
 -
n
;

1547 
	`ldns_ødix_¨øy_ªdu˚
(
node
);

1549 
	}
}

1558 
	$ldns_ødix_¨øy_ªdu˚
(
ldns_ødix_node_t
* 
node
)

1560 i‡(
node
->
Àn
 <node->
ˇ∑côy
/2 &&Çode->len !=Çode->capacity) {

1561 
ldns_ødix_¨øy_t
* 
a
 = 
	`LDNS_XMALLOC
(ldns_radix_array_t,

1562 
node
->
Àn
);

1563 i‡(!
a
) {

1566 
	`mem˝y
(
a
, 
node
->
¨øy
, (
ldns_ødix_¨øy_t
)*node->
Àn
);

1567 
	`LDNS_FREE
(
node
->
¨øy
);

1568 
node
->
¨øy
 = 
a
;

1569 
node
->
ˇ∑côy
 =Çode->
Àn
;

1572 
	}
}

1582 
	$ldns_ødix_£lf_‹_¥ev
(
ldns_ødix_node_t
* 
node
,Üdns_ødix_node_t** 
ªsu…
)

1584 i‡(
node
->
d©a
) {

1585 *
ªsu…
 = 
node
;

1587 *
ªsu…
 = 
	`ldns_ødix_¥ev
(
node
);

1590 
	}
}

	@rbtree.c

44 
	~<ldns/c⁄fig.h
>

45 
	~<ldns/rbåì.h
>

46 
	~<ldns/utû.h
>

47 
	~<°dlib.h
>

50 
	#BLACK
 0

	)

52 
	#RED
 1

	)

55 
ldns_rbnode_t
 
	gldns_rbåì_nuŒ_node
 = {

56 
LDNS_RBTREE_NULL
,

57 
LDNS_RBTREE_NULL
,

58 
LDNS_RBTREE_NULL
,

59 
NULL
,

60 
NULL
,

61 
BLACK


65 
ldns_rbåì_rŸ©e_À·
(
ldns_rbåì_t
 *
rbåì
, 
ldns_rbnode_t
 *
node
);

67 
ldns_rbåì_rŸ©e_right
(
ldns_rbåì_t
 *
rbåì
, 
ldns_rbnode_t
 *
node
);

69 
ldns_rbåì_ö£π_fixup
(
ldns_rbåì_t
 *
rbåì
, 
ldns_rbnode_t
 *
node
);

71 
ldns_rbåì_dñëe_fixup
(
ldns_rbåì_t
* 
rbåì
, 
ldns_rbnode_t
* 
chûd
,Üdns_rbnode_t* 
chûd_∑ª¡
);

79 
ldns_rbåì_t
 *

80 
ldns_rbåì_¸óã
 ((*
cmpf
)(const *, const *))

82 
ldns_rbåì_t
 *
rbåì
;

85 
rbåì
 = (
ldns_rbåì_t
 *Ë
	`LDNS_MALLOC
(ldns_rbtree_t);

86 i‡(!
rbåì
) {

87  
NULL
;

91 
	`ldns_rbåì_öô
(
rbåì
, 
cmpf
);

93  
rbåì
;

94 
	}
}

97 
ldns_rbåì_öô
(
ldns_rbåì_t
 *
rbåì
, (*
cmpf
)(const *, const *))

100 
rbåì
->
roŸ
 = 
LDNS_RBTREE_NULL
;

101 
rbåì
->
cou¡
 = 0;

102 
rbåì
->
cmp
 = 
cmpf
;

103 
	}
}

106 
	$ldns_rbåì_‰ì
(
ldns_rbåì_t
 *
rbåì
)

108 
	`LDNS_FREE
(
rbåì
);

109 
	}
}

116 
	$ldns_rbåì_rŸ©e_À·
(
ldns_rbåì_t
 *
rbåì
, 
ldns_rbnode_t
 *
node
)

118 
ldns_rbnode_t
 *
right
 = 
node
->right;

119 
node
->
right
 =Ñight->
À·
;

120 i‡(
right
->
À·
 !
LDNS_RBTREE_NULL
)

121 
right
->
À·
->
∑ª¡
 = 
node
;

123 
right
->
∑ª¡
 = 
node
->parent;

125 i‡(
node
->
∑ª¡
 !
LDNS_RBTREE_NULL
) {

126 i‡(
node
 =node->
∑ª¡
->
À·
) {

127 
node
->
∑ª¡
->
À·
 = 
right
;

129 
node
->
∑ª¡
->
right
 =Ñight;

132 
rbåì
->
roŸ
 = 
right
;

134 
right
->
À·
 = 
node
;

135 
node
->
∑ª¡
 = 
right
;

136 
	}
}

143 
	$ldns_rbåì_rŸ©e_right
(
ldns_rbåì_t
 *
rbåì
, 
ldns_rbnode_t
 *
node
)

145 
ldns_rbnode_t
 *
À·
 = 
node
->left;

146 
node
->
À·
 =Üe·->
right
;

147 i‡(
À·
->
right
 !
LDNS_RBTREE_NULL
)

148 
À·
->
right
->
∑ª¡
 = 
node
;

150 
À·
->
∑ª¡
 = 
node
->parent;

152 i‡(
node
->
∑ª¡
 !
LDNS_RBTREE_NULL
) {

153 i‡(
node
 =node->
∑ª¡
->
right
) {

154 
node
->
∑ª¡
->
right
 = 
À·
;

156 
node
->
∑ª¡
->
À·
 =Üeft;

159 
rbåì
->
roŸ
 = 
À·
;

161 
À·
->
right
 = 
node
;

162 
node
->
∑ª¡
 = 
À·
;

163 
	}
}

166 
	$ldns_rbåì_ö£π_fixup
(
ldns_rbåì_t
 *
rbåì
, 
ldns_rbnode_t
 *
node
)

168 
ldns_rbnode_t
 *
un˛e
;

171 
node
 !
rbåì
->
roŸ
 &&Çode->
∑ª¡
->
cﬁ‹
 =
RED
) {

173 i‡(
node
->
∑ª¡
 =node->∑ª¡->∑ª¡->
À·
) {

174 
un˛e
 = 
node
->
∑ª¡
->∑ª¡->
right
;

177 i‡(
un˛e
->
cﬁ‹
 =
RED
) {

179 
node
->
∑ª¡
->
cﬁ‹
 = 
BLACK
;

180 
un˛e
->
cﬁ‹
 = 
BLACK
;

183 
node
->
∑ª¡
->∑ª¡->
cﬁ‹
 = 
RED
;

186 
node
 =Çode->
∑ª¡
->parent;

189 i‡(
node
 =node->
∑ª¡
->
right
) {

190 
node
 =Çode->
∑ª¡
;

191 
	`ldns_rbåì_rŸ©e_À·
(
rbåì
, 
node
);

194 
node
->
∑ª¡
->
cﬁ‹
 = 
BLACK
;

195 
node
->
∑ª¡
->∑ª¡->
cﬁ‹
 = 
RED
;

196 
	`ldns_rbåì_rŸ©e_right
(
rbåì
, 
node
->
∑ª¡
->parent);

199 
un˛e
 = 
node
->
∑ª¡
->∑ª¡->
À·
;

202 i‡(
un˛e
->
cﬁ‹
 =
RED
) {

204 
node
->
∑ª¡
->
cﬁ‹
 = 
BLACK
;

205 
un˛e
->
cﬁ‹
 = 
BLACK
;

208 
node
->
∑ª¡
->∑ª¡->
cﬁ‹
 = 
RED
;

211 
node
 =Çode->
∑ª¡
->parent;

214 i‡(
node
 =node->
∑ª¡
->
À·
) {

215 
node
 =Çode->
∑ª¡
;

216 
	`ldns_rbåì_rŸ©e_right
(
rbåì
, 
node
);

219 
node
->
∑ª¡
->
cﬁ‹
 = 
BLACK
;

220 
node
->
∑ª¡
->∑ª¡->
cﬁ‹
 = 
RED
;

221 
	`ldns_rbåì_rŸ©e_À·
(
rbåì
, 
node
->
∑ª¡
->parent);

225 
rbåì
->
roŸ
->
cﬁ‹
 = 
BLACK
;

226 
	}
}

229 
	$ldns_rbåì_ö£π_vªf
(
ldns_rbnode_t
 *
d©a
, *
rbåì
)

231 (Ë
	`ldns_rbåì_ö£π
((
ldns_rbåì_t
 *Ë
rbåì
,

232 
d©a
);

233 
	}
}

241 
ldns_rbnode_t
 *

242 
	$ldns_rbåì_ö£π
 (
ldns_rbåì_t
 *
rbåì
, 
ldns_rbnode_t
 *
d©a
)

245 
r
 = 0;

248 
ldns_rbnode_t
 *
node
 = 
rbåì
->
roŸ
;

249 
ldns_rbnode_t
 *
∑ª¡
 = 
LDNS_RBTREE_NULL
;

252 
node
 !
LDNS_RBTREE_NULL
) {

254 i‡((
r
 = 
rbåì
->
	`cmp
(
d©a
->
key
, 
node
->key)) == 0) {

255  
NULL
;

257 
∑ª¡
 = 
node
;

259 i‡(
r
 < 0) {

260 
node
 =Çode->
À·
;

262 
node
 =Çode->
right
;

267 
d©a
->
∑ª¡
 =Öarent;

268 
d©a
->
À·
 = d©a->
right
 = 
LDNS_RBTREE_NULL
;

269 
d©a
->
cﬁ‹
 = 
RED
;

270 
rbåì
->
cou¡
++;

273 i‡(
∑ª¡
 !
LDNS_RBTREE_NULL
) {

274 i‡(
r
 < 0) {

275 
∑ª¡
->
À·
 = 
d©a
;

277 
∑ª¡
->
right
 = 
d©a
;

280 
rbåì
->
roŸ
 = 
d©a
;

284 
	`ldns_rbåì_ö£π_fixup
(
rbåì
, 
d©a
);

286  
d©a
;

287 
	}
}

293 
ldns_rbnode_t
 *

294 
	$ldns_rbåì_£¨ch
 (
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
)

296 
ldns_rbnode_t
 *
node
;

298 i‡(
	`ldns_rbåì_föd_Àss_equÆ
(
rbåì
, 
key
, &
node
)) {

299  
node
;

301  
NULL
;

303 
	}
}

306 
	$sw≠_öt8
(
uöt8_t
* 
x
, uöt8_t* 
y
)

308 
uöt8_t
 
t
 = *
x
; *x = *
y
; *y =Å;

309 
	}
}

312 
	$sw≠_≈
(
ldns_rbnode_t
** 
x
,Üdns_rbnode_t** 
y
)

314 
ldns_rbnode_t
* 
t
 = *
x
; *x = *
y
; *y =Å;

315 
	}
}

318 
	$ch™ge_∑ª¡_±r
(
ldns_rbåì_t
* 
rbåì
, 
ldns_rbnode_t
* 
∑ª¡
,Üdns_rbnode_t* 
ﬁd
,Üdns_rbnode_t* 
√w
)

320 if(
∑ª¡
 =
LDNS_RBTREE_NULL
)

322 if(
rbåì
->
roŸ
 =
ﬁd
Ërbåì->roŸ = 
√w
;

325 if(
∑ª¡
->
À·
 =
ﬁd
Ë∑ª¡->À· = 
√w
;

326 if(
∑ª¡
->
right
 =
ﬁd
Ë∑ª¡->righà
√w
;

327 
	}
}

329 
	$ch™ge_chûd_±r
(
ldns_rbnode_t
* 
chûd
,Üdns_rbnode_t* 
ﬁd
,Üdns_rbnode_t* 
√w
)

331 if(
chûd
 =
LDNS_RBTREE_NULL
) ;

332 if(
chûd
->
∑ª¡
 =
ﬁd
Ëchûd->∑ª¡ = 
√w
;

333 
	}
}

335 
ldns_rbnode_t
*

336 
	$ldns_rbåì_dñëe
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
)

338 
ldns_rbnode_t
 *
to_dñëe
;

339 
ldns_rbnode_t
 *
chûd
;

340 if((
to_dñëe
 = 
	`ldns_rbåì_£¨ch
(
rbåì
, 
key
)) == 0)  0;

341 
rbåì
->
cou¡
--;

344 if(
to_dñëe
->
À·
 !
LDNS_RBTREE_NULL
 &&

345 
to_dñëe
->
right
 !
LDNS_RBTREE_NULL
)

348 
ldns_rbnode_t
 *
smright
 = 
to_dñëe
->
right
;

349 
smright
->
À·
 !
LDNS_RBTREE_NULL
)

350 
smright
 = smright->
À·
;

357 
	`sw≠_öt8
(&
to_dñëe
->
cﬁ‹
, &
smright
->color);

360 
	`ch™ge_∑ª¡_±r
(
rbåì
, 
to_dñëe
->
∑ª¡
,Åo_dñëe, 
smright
);

361 if(
to_dñëe
->
right
 !
smright
)

362 
	`ch™ge_∑ª¡_±r
(
rbåì
, 
smright
->
∑ª¡
, smright, 
to_dñëe
);

365 
	`ch™ge_chûd_±r
(
smright
->
À·
, smright, 
to_dñëe
);

366 
	`ch™ge_chûd_±r
(
smright
->
À·
, smright, 
to_dñëe
);

367 
	`ch™ge_chûd_±r
(
smright
->
right
, smright, 
to_dñëe
);

368 
	`ch™ge_chûd_±r
(
smright
->
right
, smright, 
to_dñëe
);

369 
	`ch™ge_chûd_±r
(
to_dñëe
->
À·
,Åo_dñëe, 
smright
);

370 if(
to_dñëe
->
right
 !
smright
)

371 
	`ch™ge_chûd_±r
(
to_dñëe
->
right
,Åo_dñëe, 
smright
);

372 if(
to_dñëe
->
right
 =
smright
)

375 
to_dñëe
->
right
 =Åo_delete;

376 
smright
->
∑ª¡
 = smright;

380 
	`sw≠_≈
(&
to_dñëe
->
∑ª¡
, &
smright
->parent);

381 
	`sw≠_≈
(&
to_dñëe
->
À·
, &
smright
->left);

382 
	`sw≠_≈
(&
to_dñëe
->
right
, &
smright
->right);

387 if(
to_dñëe
->
À·
 !
LDNS_RBTREE_NULL
Ë
chûd
 =Åo_delete->left;

388 
chûd
 = 
to_dñëe
->
right
;

391 
	`ch™ge_∑ª¡_±r
(
rbåì
, 
to_dñëe
->
∑ª¡
,Åo_dñëe, 
chûd
);

392 
	`ch™ge_chûd_±r
(
chûd
, 
to_dñëe
,Åo_dñëe->
∑ª¡
);

394 if(
to_dñëe
->
cﬁ‹
 =
RED
)

398 if(
chûd
->
cﬁ‹
 =
RED
)

401 if(
chûd
!=
LDNS_RBTREE_NULL
Ëchûd->
cﬁ‹
 = 
BLACK
;

403 
	`ldns_rbåì_dñëe_fixup
(
rbåì
, 
chûd
, 
to_dñëe
->
∑ª¡
);

406 
to_dñëe
->
∑ª¡
 = 
LDNS_RBTREE_NULL
;

407 
to_dñëe
->
À·
 = 
LDNS_RBTREE_NULL
;

408 
to_dñëe
->
right
 = 
LDNS_RBTREE_NULL
;

409 
to_dñëe
->
cﬁ‹
 = 
BLACK
;

410  
to_dñëe
;

411 
	}
}

413 
	$ldns_rbåì_dñëe_fixup
(
ldns_rbåì_t
* 
rbåì
, 
ldns_rbnode_t
* 
chûd
,Üdns_rbnode_t* 
chûd_∑ª¡
)

415 
ldns_rbnode_t
* 
siblög
;

416 
go_up
 = 1;

419 if(
chûd_∑ª¡
->
right
 =
chûd
Ë
siblög
 = chûd_∑ª¡->
À·
;

420 
siblög
 = 
chûd_∑ª¡
->
right
;

422 
go_up
)

424 if(
chûd_∑ª¡
 =
LDNS_RBTREE_NULL
)

430 if(
siblög
->
cﬁ‹
 =
RED
)

432 
chûd_∑ª¡
->
cﬁ‹
 = 
RED
;

433 
siblög
->
cﬁ‹
 = 
BLACK
;

434 if(
chûd_∑ª¡
->
right
 =
chûd
)

435 
	`ldns_rbåì_rŸ©e_right
(
rbåì
, 
chûd_∑ª¡
);

436 
	`ldns_rbåì_rŸ©e_À·
(
rbåì
, 
chûd_∑ª¡
);

438 if(
chûd_∑ª¡
->
right
 =
chûd
Ë
siblög
 = chûd_∑ª¡->
À·
;

439 
siblög
 = 
chûd_∑ª¡
->
right
;

442 if(
chûd_∑ª¡
->
cﬁ‹
 =
BLACK


443 && 
siblög
->
cﬁ‹
 =
BLACK


444 && 
siblög
->
À·
->
cﬁ‹
 =
BLACK


445 && 
siblög
->
right
->
cﬁ‹
 =
BLACK
)

447 if(
siblög
 !
LDNS_RBTREE_NULL
)

448 
siblög
->
cﬁ‹
 = 
RED
;

450 
chûd
 = 
chûd_∑ª¡
;

451 
chûd_∑ª¡
 = chûd_∑ª¡->
∑ª¡
;

453 if(
chûd_∑ª¡
->
right
 =
chûd
Ë
siblög
 = chûd_∑ª¡->
À·
;

454 
siblög
 = 
chûd_∑ª¡
->
right
;

456 
go_up
 = 0;

459 if(
chûd_∑ª¡
->
cﬁ‹
 =
RED


460 && 
siblög
->
cﬁ‹
 =
BLACK


461 && 
siblög
->
À·
->
cﬁ‹
 =
BLACK


462 && 
siblög
->
right
->
cﬁ‹
 =
BLACK
)

465 if(
siblög
 !
LDNS_RBTREE_NULL
)

466 
siblög
->
cﬁ‹
 = 
RED
;

467 
chûd_∑ª¡
->
cﬁ‹
 = 
BLACK
;

473 if(
chûd_∑ª¡
->
right
 =
chûd


474 && 
siblög
->
cﬁ‹
 =
BLACK


475 && 
siblög
->
right
->
cﬁ‹
 =
RED


476 && 
siblög
->
À·
->
cﬁ‹
 =
BLACK
)

478 
siblög
->
cﬁ‹
 = 
RED
;

479 
siblög
->
right
->
cﬁ‹
 = 
BLACK
;

480 
	`ldns_rbåì_rŸ©e_À·
(
rbåì
, 
siblög
);

482 if(
chûd_∑ª¡
->
right
 =
chûd
Ë
siblög
 = chûd_∑ª¡->
À·
;

483 
siblög
 = 
chûd_∑ª¡
->
right
;

485 if(
chûd_∑ª¡
->
À·
 =
chûd


486 && 
siblög
->
cﬁ‹
 =
BLACK


487 && 
siblög
->
À·
->
cﬁ‹
 =
RED


488 && 
siblög
->
right
->
cﬁ‹
 =
BLACK
)

490 
siblög
->
cﬁ‹
 = 
RED
;

491 
siblög
->
À·
->
cﬁ‹
 = 
BLACK
;

492 
	`ldns_rbåì_rŸ©e_right
(
rbåì
, 
siblög
);

494 if(
chûd_∑ª¡
->
right
 =
chûd
Ë
siblög
 = chûd_∑ª¡->
À·
;

495 
siblög
 = 
chûd_∑ª¡
->
right
;

499 
siblög
->
cﬁ‹
 = 
chûd_∑ª¡
->color;

500 
chûd_∑ª¡
->
cﬁ‹
 = 
BLACK
;

501 if(
chûd_∑ª¡
->
right
 =
chûd
)

503 
siblög
->
À·
->
cﬁ‹
 = 
BLACK
;

504 
	`ldns_rbåì_rŸ©e_right
(
rbåì
, 
chûd_∑ª¡
);

508 
siblög
->
right
->
cﬁ‹
 = 
BLACK
;

509 
	`ldns_rbåì_rŸ©e_À·
(
rbåì
, 
chûd_∑ª¡
);

511 
	}
}

514 
	$ldns_rbåì_föd_Àss_equÆ
(
ldns_rbåì_t
 *
rbåì
, c⁄° *
key
, 
ldns_rbnode_t
 **
ªsu…
)

516 
r
;

517 
ldns_rbnode_t
 *
node
;

520 
node
 = 
rbåì
->
roŸ
;

522 *
ªsu…
 = 
NULL
;

525 
node
 !
LDNS_RBTREE_NULL
) {

526 
r
 = 
rbåì
->
	`cmp
(
key
, 
node
->key);

527 i‡(
r
 == 0) {

529 *
ªsu…
 = 
node
;

532 i‡(
r
 < 0) {

533 
node
 =Çode->
À·
;

536 *
ªsu…
 = 
node
;

537 
node
 =Çode->
right
;

541 
	}
}

547 
ldns_rbnode_t
 *

548 
	$ldns_rbåì_fú°
 (
ldns_rbåì_t
 *
rbåì
)

550 
ldns_rbnode_t
 *
node
 = 
rbåì
->
roŸ
;

552 i‡(
rbåì
->
roŸ
 !
LDNS_RBTREE_NULL
) {

553 
node
 = 
rbåì
->
roŸ
;Çode->
À·
 !
LDNS_RBTREE_NULL
;Çode =Çode->left);

555  
node
;

556 
	}
}

558 
ldns_rbnode_t
 *

559 
	$ldns_rbåì_œ°
 (
ldns_rbåì_t
 *
rbåì
)

561 
ldns_rbnode_t
 *
node
 = 
rbåì
->
roŸ
;

563 i‡(
rbåì
->
roŸ
 !
LDNS_RBTREE_NULL
) {

564 
node
 = 
rbåì
->
roŸ
;Çode->
right
 !
LDNS_RBTREE_NULL
;Çode =Çode->right);

566  
node
;

567 
	}
}

573 
ldns_rbnode_t
 *

574 
	$ldns_rbåì_√xt
 (
ldns_rbnode_t
 *
node
)

576 
ldns_rbnode_t
 *
∑ª¡
;

578 i‡(
node
->
right
 !
LDNS_RBTREE_NULL
) {

580 
node
 =Çode->
right
;

581 
node
->
À·
 !
LDNS_RBTREE_NULL
;

582 
node
 =Çode->
À·
);

584 
∑ª¡
 = 
node
->parent;

585 
∑ª¡
 !
LDNS_RBTREE_NULL
 && 
node
 =∑ª¡->
right
) {

586 
node
 = 
∑ª¡
;

587 
∑ª¡
 =Öarent->parent;

589 
node
 = 
∑ª¡
;

591  
node
;

592 
	}
}

594 
ldns_rbnode_t
 *

595 
	$ldns_rbåì_¥evious
(
ldns_rbnode_t
 *
node
)

597 
ldns_rbnode_t
 *
∑ª¡
;

599 i‡(
node
->
À·
 !
LDNS_RBTREE_NULL
) {

601 
node
 =Çode->
À·
;

602 
node
->
right
 !
LDNS_RBTREE_NULL
;

603 
node
 =Çode->
right
);

605 
∑ª¡
 = 
node
->parent;

606 
∑ª¡
 !
LDNS_RBTREE_NULL
 && 
node
 =∑ª¡->
À·
) {

607 
node
 = 
∑ª¡
;

608 
∑ª¡
 =Öarent->parent;

610 
node
 = 
∑ª¡
;

612  
node
;

613 
	}
}

619 
ldns_rbåì_t
 *

620 
	$ldns_rbåì_•lô
(
ldns_rbåì_t
 *
åì
,

621 
size_t
 
ñemíts
)

623 
ldns_rbåì_t
 *
√w_åì
;

624 
ldns_rbnode_t
 *
cur_node
;

625 
ldns_rbnode_t
 *
move_node
;

626 
size_t
 
cou¡
 = 0;

628 
√w_åì
 = 
	`ldns_rbåì_¸óã
(
åì
->
cmp
);

630 
cur_node
 = 
	`ldns_rbåì_fú°
(
åì
);

631 
cou¡
 < 
ñemíts
 && 
cur_node
 !
LDNS_RBTREE_NULL
) {

632 
move_node
 = 
	`ldns_rbåì_dñëe
(
åì
, 
cur_node
->
key
);

633 ()
	`ldns_rbåì_ö£π
(
√w_åì
, 
move_node
);

634 
cur_node
 = 
	`ldns_rbåì_fú°
(
åì
);

635 
cou¡
++;

638  
√w_åì
;

639 
	}
}

646 
	$ldns_rbåì_joö
(
ldns_rbåì_t
 *
åì1
,Üdns_rbåì_à*
åì2
)

648 
	`ldns_åavî£_po°‹dî
(
åì2
, 
ldns_rbåì_ö£π_vªf
, 
åì1
);

649 
	}
}

653 
åavî£_po°
((*
func
)(
ldns_rbnode_t
*, *), * 
¨g
,

654 
ldns_rbnode_t
* 
node
)

656 if(!
node
 ||Çodê=
LDNS_RBTREE_NULL
)

659 
	`åavî£_po°
(
func
, 
¨g
, 
node
->
À·
);

660 
	`åavî£_po°
(
func
, 
¨g
, 
node
->
right
);

662 (*
func
)(
node
, 
¨g
);

663 
	}
}

666 
ldns_åavî£_po°‹dî
(
ldns_rbåì_t
* 
åì
,

667 (*
func
)(
ldns_rbnode_t
*, *), * 
¨g
)

669 
	`åavî£_po°
(
func
, 
¨g
, 
åì
->
roŸ
);

670 
	}
}

	@rdata.c

13 
	~<ldns/c⁄fig.h
>

15 
	~<ldns/ldns.h
>

23 
size_t


24 
	$ldns_rdf_size
(c⁄° 
ldns_rdf
 *
rd
)

26 
	`as£π
(
rd
 !
NULL
);

27  
rd
->
_size
;

28 
	}
}

30 
ldns_rdf_ty≥


31 
	$ldns_rdf_gë_ty≥
(c⁄° 
ldns_rdf
 *
rd
)

33 
	`as£π
(
rd
 !
NULL
);

34  
rd
->
_ty≥
;

35 
	}
}

37 
uöt8_t
 *

38 
	$ldns_rdf_d©a
(c⁄° 
ldns_rdf
 *
rd
)

40 
	`as£π
(
rd
 !
NULL
);

41  
rd
->
_d©a
;

42 
	}
}

46 
	$ldns_rdf_£t_size
(
ldns_rdf
 *
rd
, 
size_t
 
size
)

48 
	`as£π
(
rd
 !
NULL
);

49 
rd
->
_size
 = 
size
;

50 
	}
}

53 
	$ldns_rdf_£t_ty≥
(
ldns_rdf
 *
rd
, 
ldns_rdf_ty≥
 
ty≥
)

55 
	`as£π
(
rd
 !
NULL
);

56 
rd
->
_ty≥
 = 
ty≥
;

57 
	}
}

60 
	$ldns_rdf_£t_d©a
(
ldns_rdf
 *
rd
, *
d©a
)

63 
	`as£π
(
rd
 !
NULL
);

64 
rd
->
_d©a
 = 
d©a
;

65 
	}
}

69 
uöt8_t


70 
	$ldns_rdf2«tive_öt8
(c⁄° 
ldns_rdf
 *
rd
)

72 
uöt8_t
 
d©a
;

75 i‡(
	`ldns_rdf_size
(
rd
Ë!
LDNS_RDF_SIZE_BYTE
) {

79 
	`mem˝y
(&
d©a
, 
	`ldns_rdf_d©a
(
rd
), (data));

80  
d©a
;

81 
	}
}

83 
uöt16_t


84 
	$ldns_rdf2«tive_öt16
(c⁄° 
ldns_rdf
 *
rd
)

86 
uöt16_t
 
d©a
;

89 i‡(
	`ldns_rdf_size
(
rd
Ë!
LDNS_RDF_SIZE_WORD
) {

93 
	`mem˝y
(&
d©a
, 
	`ldns_rdf_d©a
(
rd
), (data));

94  
	`¡ohs
(
d©a
);

95 
	}
}

97 
uöt32_t


98 
	$ldns_rdf2«tive_öt32
(c⁄° 
ldns_rdf
 *
rd
)

100 
uöt32_t
 
d©a
;

103 i‡(
	`ldns_rdf_size
(
rd
Ë!
LDNS_RDF_SIZE_DOUBLEWORD
) {

107 
	`mem˝y
(&
d©a
, 
	`ldns_rdf_d©a
(
rd
), (data));

108  
	`¡ohl
(
d©a
);

109 
	}
}

111 
time_t


112 
	$ldns_rdf2«tive_time_t
(c⁄° 
ldns_rdf
 *
rd
)

114 
uöt32_t
 
d©a
;

117 i‡(
	`ldns_rdf_size
(
rd
Ë!
LDNS_RDF_SIZE_DOUBLEWORD
 ||

118 
	`ldns_rdf_gë_ty≥
(
rd
Ë!
LDNS_RDF_TYPE_TIME
) {

121 
	`mem˝y
(&
d©a
, 
	`ldns_rdf_d©a
(
rd
), (data));

122  (
time_t
)
	`¡ohl
(
d©a
);

123 
	}
}

125 
ldns_rdf
 *

126 
	$ldns_«tive2rdf_öt8
(
ldns_rdf_ty≥
 
ty≥
, 
uöt8_t
 
vÆue
)

128  
	`ldns_rdf_√w_‰m_d©a
(
ty≥
, 
LDNS_RDF_SIZE_BYTE
, &
vÆue
);

129 
	}
}

131 
ldns_rdf
 *

132 
	$ldns_«tive2rdf_öt16
(
ldns_rdf_ty≥
 
ty≥
, 
uöt16_t
 
vÆue
)

134 
uöt16_t
 *
rdf_d©a
 = 
	`LDNS_XMALLOC
(uint16_t, 1);

135 
ldns_rdf
* 
rdf
;

136 i‡(!
rdf_d©a
) {

137  
NULL
;

139 
	`ldns_wrôe_uöt16
(
rdf_d©a
, 
vÆue
);

140 
rdf
 = 
	`ldns_rdf_√w
(
ty≥
, 
LDNS_RDF_SIZE_WORD
, 
rdf_d©a
);

141 if(!
rdf
)

142 
	`LDNS_FREE
(
rdf_d©a
);

143  
rdf
;

144 
	}
}

146 
ldns_rdf
 *

147 
	$ldns_«tive2rdf_öt32
(
ldns_rdf_ty≥
 
ty≥
, 
uöt32_t
 
vÆue
)

149 
uöt32_t
 *
rdf_d©a
 = 
	`LDNS_XMALLOC
(uint32_t, 1);

150 
ldns_rdf
* 
rdf
;

151 i‡(!
rdf_d©a
) {

152  
NULL
;

154 
	`ldns_wrôe_uöt32
(
rdf_d©a
, 
vÆue
);

155 
rdf
 = 
	`ldns_rdf_√w
(
ty≥
, 
LDNS_RDF_SIZE_DOUBLEWORD
, 
rdf_d©a
);

156 if(!
rdf
)

157 
	`LDNS_FREE
(
rdf_d©a
);

158  
rdf
;

159 
	}
}

161 
ldns_rdf
 *

162 
	$ldns_«tive2rdf_öt16_d©a
(
size_t
 
size
, 
uöt8_t
 *
d©a
)

164 
uöt8_t
 *
rdf_d©a
 = 
	`LDNS_XMALLOC
(uöt8_t, 
size
 + 2);

165 
ldns_rdf
* 
rdf
;

166 i‡(!
rdf_d©a
) {

167  
NULL
;

169 
	`ldns_wrôe_uöt16
(
rdf_d©a
, 
size
);

170 
	`mem˝y
(
rdf_d©a
 + 2, 
d©a
, 
size
);

171 
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_INT16_DATA
, 
size
 + 2, 
rdf_d©a
);

172 if(!
rdf
)

173 
	`LDNS_FREE
(
rdf_d©a
);

174  
rdf
;

175 
	}
}

178 
ldns_rdf
 *

179 
	$ldns_rdf_√w
(
ldns_rdf_ty≥
 
ty≥
, 
size_t
 
size
, *
d©a
)

181 
ldns_rdf
 *
rd
;

182 
rd
 = 
	`LDNS_MALLOC
(
ldns_rdf
);

183 i‡(!
rd
) {

184  
NULL
;

186 
	`ldns_rdf_£t_size
(
rd
, 
size
);

187 
	`ldns_rdf_£t_ty≥
(
rd
, 
ty≥
);

188 
	`ldns_rdf_£t_d©a
(
rd
, 
d©a
);

189  
rd
;

190 
	}
}

192 
ldns_rdf
 *

193 
	$ldns_rdf_√w_‰m_d©a
(
ldns_rdf_ty≥
 
ty≥
, 
size_t
 
size
, c⁄° *
d©a
)

195 
ldns_rdf
 *
rdf
;

198 i‡(
size
 > 
LDNS_MAX_RDFLEN
) {

199  
NULL
;

203 
rdf
 = 
	`LDNS_MALLOC
(
ldns_rdf
);

204 i‡(!
rdf
) {

205  
NULL
;

207 
rdf
->
_d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
size
);

208 i‡(!
rdf
->
_d©a
) {

209 
	`LDNS_FREE
(
rdf
);

210  
NULL
;

214 
	`ldns_rdf_£t_ty≥
(
rdf
, 
ty≥
);

215 
	`ldns_rdf_£t_size
(
rdf
, 
size
);

216 
	`mem˝y
(
rdf
->
_d©a
, 
d©a
, 
size
);

218  
rdf
;

219 
	}
}

221 
ldns_rdf
 *

222 
	$ldns_rdf_˛⁄e
(c⁄° 
ldns_rdf
 *
rd
)

224 
	`as£π
(
rd
 !
NULL
);

225  (
	`ldns_rdf_√w_‰m_d©a
–
	`ldns_rdf_gë_ty≥
(
rd
),

226 
	`ldns_rdf_size
(
rd
), 
	`ldns_rdf_d©a
(rd)));

227 
	}
}

230 
	$ldns_rdf_dìp_‰ì
(
ldns_rdf
 *
rd
)

232 i‡(
rd
) {

233 i‡(
rd
->
_d©a
) {

234 
	`LDNS_FREE
(
rd
->
_d©a
);

236 
	`LDNS_FREE
(
rd
);

238 
	}
}

241 
	$ldns_rdf_‰ì
(
ldns_rdf
 *
rd
)

243 i‡(
rd
) {

244 
	`LDNS_FREE
(
rd
);

246 
	}
}

248 
ldns_rdf
 *

249 
	$ldns_rdf_√w_‰m_°r
(
ldns_rdf_ty≥
 
ty≥
, c⁄° *
°r
)

251 
ldns_rdf
 *
rdf
 = 
NULL
;

252 
ldns_°©us
 
°©us
;

254 
ty≥
) {

255 
LDNS_RDF_TYPE_DNAME
:

256 
°©us
 = 
	`ldns_°r2rdf_d«me
(&
rdf
, 
°r
);

258 
LDNS_RDF_TYPE_INT8
:

259 
°©us
 = 
	`ldns_°r2rdf_öt8
(&
rdf
, 
°r
);

261 
LDNS_RDF_TYPE_INT16
:

262 
°©us
 = 
	`ldns_°r2rdf_öt16
(&
rdf
, 
°r
);

264 
LDNS_RDF_TYPE_INT32
:

265 
°©us
 = 
	`ldns_°r2rdf_öt32
(&
rdf
, 
°r
);

267 
LDNS_RDF_TYPE_A
:

268 
°©us
 = 
	`ldns_°r2rdf_a
(&
rdf
, 
°r
);

270 
LDNS_RDF_TYPE_AAAA
:

271 
°©us
 = 
	`ldns_°r2rdf_ØØ
(&
rdf
, 
°r
);

273 
LDNS_RDF_TYPE_STR
:

274 
°©us
 = 
	`ldns_°r2rdf_°r
(&
rdf
, 
°r
);

276 
LDNS_RDF_TYPE_APL
:

277 
°©us
 = 
	`ldns_°r2rdf_≠l
(&
rdf
, 
°r
);

279 
LDNS_RDF_TYPE_B64
:

280 
°©us
 = 
	`ldns_°r2rdf_b64
(&
rdf
, 
°r
);

282 
LDNS_RDF_TYPE_B32_EXT
:

283 
°©us
 = 
	`ldns_°r2rdf_b32_ext
(&
rdf
, 
°r
);

285 
LDNS_RDF_TYPE_HEX
:

286 
°©us
 = 
	`ldns_°r2rdf_hex
(&
rdf
, 
°r
);

288 
LDNS_RDF_TYPE_NSEC
:

289 
°©us
 = 
	`ldns_°r2rdf_n£c
(&
rdf
, 
°r
);

291 
LDNS_RDF_TYPE_TYPE
:

292 
°©us
 = 
	`ldns_°r2rdf_ty≥
(&
rdf
, 
°r
);

294 
LDNS_RDF_TYPE_CLASS
:

295 
°©us
 = 
	`ldns_°r2rdf_˛ass
(&
rdf
, 
°r
);

297 
LDNS_RDF_TYPE_CERT_ALG
:

298 
°©us
 = 
	`ldns_°r2rdf_˚π_Æg
(&
rdf
, 
°r
);

300 
LDNS_RDF_TYPE_ALG
:

301 
°©us
 = 
	`ldns_°r2rdf_Æg
(&
rdf
, 
°r
);

303 
LDNS_RDF_TYPE_UNKNOWN
:

304 
°©us
 = 
	`ldns_°r2rdf_unknown
(&
rdf
, 
°r
);

306 
LDNS_RDF_TYPE_TIME
:

307 
°©us
 = 
	`ldns_°r2rdf_time
(&
rdf
, 
°r
);

309 
LDNS_RDF_TYPE_PERIOD
:

310 
°©us
 = 
	`ldns_°r2rdf_≥riod
(&
rdf
, 
°r
);

312 
LDNS_RDF_TYPE_HIP
:

313 
°©us
 = 
	`ldns_°r2rdf_hù
(&
rdf
, 
°r
);

315 
LDNS_RDF_TYPE_SERVICE
:

316 
°©us
 = 
	`ldns_°r2rdf_£rvi˚
(&
rdf
, 
°r
);

318 
LDNS_RDF_TYPE_LOC
:

319 
°©us
 = 
	`ldns_°r2rdf_loc
(&
rdf
, 
°r
);

321 
LDNS_RDF_TYPE_WKS
:

322 
°©us
 = 
	`ldns_°r2rdf_wks
(&
rdf
, 
°r
);

324 
LDNS_RDF_TYPE_NSAP
:

325 
°©us
 = 
	`ldns_°r2rdf_nßp
(&
rdf
, 
°r
);

327 
LDNS_RDF_TYPE_ATMA
:

328 
°©us
 = 
	`ldns_°r2rdf_©ma
(&
rdf
, 
°r
);

330 
LDNS_RDF_TYPE_IPSECKEY
:

331 
°©us
 = 
	`ldns_°r2rdf_ù£ckey
(&
rdf
, 
°r
);

333 
LDNS_RDF_TYPE_NSEC3_SALT
:

334 
°©us
 = 
	`ldns_°r2rdf_n£c3_ß…
(&
rdf
, 
°r
);

336 
LDNS_RDF_TYPE_NSEC3_NEXT_OWNER
:

337 
°©us
 = 
	`ldns_°r2rdf_b32_ext
(&
rdf
, 
°r
);

339 
LDNS_RDF_TYPE_ILNP64
:

340 
°©us
 = 
	`ldns_°r2rdf_û≈64
(&
rdf
, 
°r
);

342 
LDNS_RDF_TYPE_EUI48
:

343 
°©us
 = 
	`ldns_°r2rdf_eui48
(&
rdf
, 
°r
);

345 
LDNS_RDF_TYPE_EUI64
:

346 
°©us
 = 
	`ldns_°r2rdf_eui64
(&
rdf
, 
°r
);

348 
LDNS_RDF_TYPE_TAG
:

349 
°©us
 = 
	`ldns_°r2rdf_èg
(&
rdf
, 
°r
);

351 
LDNS_RDF_TYPE_LONG_STR
:

352 
°©us
 = 
	`ldns_°r2rdf_l⁄g_°r
(&
rdf
, 
°r
);

354 
LDNS_RDF_TYPE_NONE
:

357 
°©us
 = 
LDNS_STATUS_ERR
;

360 i‡(
LDNS_STATUS_OK
 =
°©us
) {

361 
	`ldns_rdf_£t_ty≥
(
rdf
, 
ty≥
);

362  
rdf
;

364 i‡(
rdf
) {

365 
	`LDNS_FREE
(
rdf
);

367  
NULL
;

368 
	}
}

370 
ldns_°©us


371 
	$ldns_rdf_√w_‰m_Â
(
ldns_rdf
 **
rdf
, 
ldns_rdf_ty≥
 
ty≥
, 
FILE
 *
Â
)

373  
	`ldns_rdf_√w_‰m_Â_l
(
rdf
, 
ty≥
, 
Â
, 
NULL
);

374 
	}
}

376 
ldns_°©us


377 
	$ldns_rdf_√w_‰m_Â_l
(
ldns_rdf
 **
rdf
, 
ldns_rdf_ty≥
 
ty≥
, 
FILE
 *
Â
, *
löe_ƒ
)

379 *
löe
;

380 
ldns_rdf
 *
r
;

381 
ssize_t
 
t
;

383 
löe
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
 + 1);

384 i‡(!
löe
) {

385  
LDNS_STATUS_MEM_ERR
;

389 i‡((
t
 = 
	`ldns_fgë_tokí_l
(
Â
, 
löe
, 
LDNS_PARSE_SKIP_SPACE
, 0, 
löe_ƒ
)) == -1 ||Å == 0) {

390 
	`LDNS_FREE
(
löe
);

391  
LDNS_STATUS_SYNTAX_RDATA_ERR
;

393 
r
 = 
	`ldns_rdf_√w_‰m_°r
(
ty≥
, (c⁄° *Ë
löe
);

394 
	`LDNS_FREE
(
löe
);

395 i‡(
rdf
) {

396 *
rdf
 = 
r
;

397  
LDNS_STATUS_OK
;

399  
LDNS_STATUS_NULL
;

401 
	}
}

403 
ldns_rdf
 *

404 
	$ldns_rdf_addªss_ªvî£
(
ldns_rdf
 *
rd
)

406 
uöt8_t
 
buf_4
[
LDNS_IP4ADDRLEN
];

407 
uöt8_t
 
buf_6
[
LDNS_IP6ADDRLEN
 * 2];

408 
ldns_rdf
 *
ªv
;

409 
ldns_rdf
 *
ö_addr
;

410 
ldns_rdf
 *
ªt_d«me
;

411 
uöt8_t
 
o˘ë
;

412 
uöt8_t
 
¬ibbÀ
;

413 
uöt8_t
 
nibbÀ
;

414 
uöt8_t
 
i
, 
j
;

416 *
ch¨_d«me
;

417 
nbô
;

419 i‡(
	`ldns_rdf_gë_ty≥
(
rd
Ë!
LDNS_RDF_TYPE_A
 &&

420 
	`ldns_rdf_gë_ty≥
(
rd
Ë!
LDNS_RDF_TYPE_AAAA
) {

421  
NULL
;

424 
ö_addr
 = 
NULL
;

425 
ªt_d«me
 = 
NULL
;

427 
	`ldns_rdf_gë_ty≥
(
rd
)) {

428 
LDNS_RDF_TYPE_A
:

430 
buf_4
[3] = 
	`ldns_rdf_d©a
(
rd
)[0];

431 
buf_4
[2] = 
	`ldns_rdf_d©a
(
rd
)[1];

432 
buf_4
[1] = 
	`ldns_rdf_d©a
(
rd
)[2];

433 
buf_4
[0] = 
	`ldns_rdf_d©a
(
rd
)[3];

434 
ö_addr
 = 
	`ldns_d«me_√w_‰m_°r
("in-addr.arpa.");

435 i‡(!
ö_addr
) {

436  
NULL
;

439 
ªv
 = 
	`ldns_rdf_√w_‰m_d©a
–
LDNS_RDF_TYPE_A
,

440 
LDNS_IP4ADDRLEN
, (*)&
buf_4
);

441 i‡(!
ªv
) {

442 
	`LDNS_FREE
(
ö_addr
);

443  
NULL
;

447 
ch¨_d«me
 = 
	`ldns_rdf2°r
(
ªv
);

448 i‡(!
ch¨_d«me
) {

449 
	`LDNS_FREE
(
ö_addr
);

450 
	`ldns_rdf_dìp_‰ì
(
ªv
);

451  
NULL
;

454 
ªt_d«me
 = 
	`ldns_d«me_√w_‰m_°r
(
ch¨_d«me
);

455 i‡(!
ªt_d«me
) {

456 
	`LDNS_FREE
(
ö_addr
);

457 
	`ldns_rdf_dìp_‰ì
(
ªv
);

458 
	`LDNS_FREE
(
ch¨_d«me
);

459  
NULL
;

462 
	`ldns_rdf_dìp_‰ì
(
ªv
);

463 
	`LDNS_FREE
(
ch¨_d«me
);

465 
LDNS_RDF_TYPE_AAAA
:

468 
nbô
 = 127;Çbit >= 0;Çbit =Çbit - 4) {

470 
o˘ë
 = ( ((Ë
nbô
) & 0x78) >> 3;

472 
¬ibbÀ
 = ( ((Ë
nbô
) & 0x04) >> 2;

474 
nibbÀ
 = (
	`ldns_rdf_d©a
(
rd
)[
o˘ë
] & ( 0xf << (4 * (1 -

475 
¬ibbÀ
)) ) ) >> ( 4 * (1 -

476 
¬ibbÀ
));

478 
buf_6
[(
LDNS_IP6ADDRLEN
 * 2 - 1) -

479 (
o˘ë
 * 2 + 
¬ibbÀ
)] =

480 (
uöt8_t
)
	`ldns_öt_to_hexdigô
(()
nibbÀ
);

483 
ch¨_d«me
 = 
	`LDNS_XMALLOC
(, (
LDNS_IP6ADDRLEN
 * 4));

484 i‡(!
ch¨_d«me
) {

485  
NULL
;

487 
ch¨_d«me
[
LDNS_IP6ADDRLEN
 * 4 - 1] = '\0';

490 
i
 = 0, 
j
 = 0; i < 
LDNS_IP6ADDRLEN
 * 2; i++, j = j + 2) {

491 
ch¨_d«me
[
j
] = ()
buf_6
[
i
];

492 i‡(
i
 !
LDNS_IP6ADDRLEN
 * 2 - 1) {

493 
ch¨_d«me
[
j
 + 1] = '.';

496 
ö_addr
 = 
	`ldns_d«me_√w_‰m_°r
("ip6.arpa.");

497 i‡(!
ö_addr
) {

498 
	`LDNS_FREE
(
ch¨_d«me
);

499  
NULL
;

503 
ªt_d«me
 = 
	`ldns_d«me_√w_‰m_°r
(
ch¨_d«me
);

504 
	`LDNS_FREE
(
ch¨_d«me
);

505 i‡(!
ªt_d«me
) {

506 
	`ldns_rdf_dìp_‰ì
(
ö_addr
);

507  
NULL
;

514 
ªv
 = 
	`ldns_d«me_ˇt_˛⁄e
(
ªt_d«me
, 
ö_addr
);

516 
	`ldns_rdf_dìp_‰ì
(
ªt_d«me
);

517 
	`ldns_rdf_dìp_‰ì
(
ö_addr
);

518  
ªv
;

519 
	}
}

521 
ldns_°©us


522 
	$ldns_rdf_hù_gë_Æg_hô_pk
(
ldns_rdf
 *
rdf
, 
uöt8_t
* 
Æg
,

523 
uöt8_t
 *
hô_size
, uöt8_t** 
hô
,

524 
uöt16_t
 *
pk_size
, 
uöt8_t
** 
pk
)

526 
uöt8_t
 *
d©a
;

527 
size_t
 
rdf_size
;

529 i‡(! 
rdf
 || ! 
Æg
 || ! 
hô
 || ! 
hô_size
 || ! 
pk
 || ! 
pk_size
) {

530  
LDNS_STATUS_INVALID_POINTER
;

531 } i‡(
	`ldns_rdf_gë_ty≥
(
rdf
Ë!
LDNS_RDF_TYPE_HIP
) {

532  
LDNS_STATUS_INVALID_RDF_TYPE
;

533 } i‡((
rdf_size
 = 
	`ldns_rdf_size
(
rdf
)) < 6) {

534  
LDNS_STATUS_WIRE_RDATA_ERR
;

536 
d©a
 = 
	`ldns_rdf_d©a
(
rdf
);

537 *
hô_size
 = 
d©a
[0];

538 *
Æg
 = 
d©a
[1];

539 *
pk_size
 = 
	`ldns_ªad_uöt16
(
d©a
 + 2);

540 *
hô
 = 
d©a
 + 4;

541 *
pk
 = 
d©a
 + 4 + *
hô_size
;

542 i‡(*
hô_size
 =0 || *
pk_size
 == 0 ||

543 
rdf_size
 < (
size_t
Ë*
hô_size
 + *
pk_size
 + 4) {

544  
LDNS_STATUS_WIRE_RDATA_ERR
;

546  
LDNS_STATUS_OK
;

547 
	}
}

549 
ldns_°©us


550 
	$ldns_rdf_hù_√w_‰m_Æg_hô_pk
(
ldns_rdf
** 
rdf
, 
uöt8_t
 
Æg
,

551 
uöt8_t
 
hô_size
, uöt8_à*
hô
,

552 
uöt16_t
 
pk_size
, 
uöt8_t
 *
pk
)

554 
uöt8_t
 *
d©a
;

556 i‡(! 
rdf
) {

557  
LDNS_STATUS_INVALID_POINTER
;

559 i‡(4 + 
hô_size
 + 
pk_size
 > 
LDNS_MAX_RDFLEN
) {

560  
LDNS_STATUS_RDATA_OVERFLOW
;

562 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 4 + 
hô_size
 + 
pk_size
);

563 i‡(
d©a
 =
NULL
) {

564  
LDNS_STATUS_MEM_ERR
;

566 
d©a
[0] = 
hô_size
;

567 
d©a
[1] = 
Æg
;

568 
	`ldns_wrôe_uöt16
(
d©a
 + 2, 
pk_size
);

569 
	`mem˝y
(
d©a
 + 4, 
hô
, 
hô_size
);

570 
	`mem˝y
(
d©a
 + 4 + 
hô_size
, 
pk
, 
pk_size
);

571 *
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_HIP
, 4 + 
hô_size
 + 
pk_size
, 
d©a
);

572 i‡(! *
rdf
) {

573 
	`LDNS_FREE
(
d©a
);

574  
LDNS_STATUS_MEM_ERR
;

576  
LDNS_STATUS_OK
;

577 
	}
}

579 
ldns_°©us


580 
	$ldns_o˘ë
(*
w‹d
, 
size_t
 *
Àngth
)

582 *
s
;

583 *
p
;

584 *
Àngth
 = 0;

586 
s
 = 
p
 = 
w‹d
; *s != '\0'; s++,p++) {

587 *
s
) {

589 i‡(
s
[1] == '.') {

590  
LDNS_STATUS_EMPTY_LABEL
;

592 *
p
 = *
s
;

593 (*
Àngth
)++;

596 i‡('0' <
s
[1] && s[1] <= '9' &&

597 '0' <
s
[2] && s[2] <= '9' &&

598 '0' <
s
[3] && s[3] <= '9') {

600 
vÆ
 = ((
s
[1] - '0') * 100 +

601 (
s
[2] - '0') * 10 + (s[3] - '0'));

603 i‡(0 <
vÆ
 && val <= 255) {

605 
s
 += 3;

606 *
p
 = 
vÆ
;

607 (*
Àngth
)++;

609  
LDNS_STATUS_DDD_OVERFLOW
;

614 *
p
 = *++
s
;

615 (*
Àngth
)++;

622 *
p
 = *++
s
;

623 (*
Àngth
)++;

625 i‡–*
s
 == '\0' ) {

627 *
p
 = '\0';

628  
LDNS_STATUS_OK
;

632 *
p
 = *
s
;

633 (*
Àngth
)++;

637 *
p
 = '\0';

638  
LDNS_STATUS_OK
;

639 
	}
}

642 
	$ldns_rdf_com∑ª
(c⁄° 
ldns_rdf
 *
rd1
, c⁄°Üdns_rd‡*
rd2
)

644 
uöt16_t
 
i1
, 
i2
, 
i
;

645 
uöt8_t
 *
d1
, *
d2
;

648 i‡(!
rd1
 && !
rd2
) {

651 i‡(!
rd1
 || !
rd2
) {

654 
i1
 = 
	`ldns_rdf_size
(
rd1
);

655 
i2
 = 
	`ldns_rdf_size
(
rd2
);

657 i‡(
i1
 < 
i2
) {

659 } i‡(
i1
 > 
i2
) {

662 
d1
 = (
uöt8_t
*)
	`ldns_rdf_d©a
(
rd1
);

663 
d2
 = (
uöt8_t
*)
	`ldns_rdf_d©a
(
rd2
);

664 
i
 = 0; i < 
i1
; i++) {

665 i‡(
d1
[
i
] < 
d2
[i]) {

667 } i‡(
d1
[
i
] > 
d2
[i]) {

673 
	}
}

675 
uöt32_t


676 
	$ldns_°r2≥riod
(c⁄° *
≈å
, c⁄° **
íd±r
)

678 
sign
 = 0;

679 
uöt32_t
 
i
 = 0;

680 
uöt32_t
 
£c⁄ds
 = 0;

682 *
íd±r
 = 
≈å
; **endptr; (*endptr)++) {

683 **
íd±r
) {

688 if(
sign
 == 0) {

689 
sign
 = -1;

691  
£c⁄ds
;

695 if(
sign
 == 0) {

696 
sign
 = 1;

698  
£c⁄ds
;

703 
£c⁄ds
 +
i
;

704 
i
 = 0;

708 
£c⁄ds
 +
i
 * 60;

709 
i
 = 0;

713 
£c⁄ds
 +
i
 * 60 * 60;

714 
i
 = 0;

718 
£c⁄ds
 +
i
 * 60 * 60 * 24;

719 
i
 = 0;

723 
£c⁄ds
 +
i
 * 60 * 60 * 24 * 7;

724 
i
 = 0;

736 
i
 *= 10;

737 
i
 +(**
íd±r
 - '0');

740 
£c⁄ds
 +
i
;

742  
£c⁄ds
;

745 
£c⁄ds
 +
i
;

747  
£c⁄ds
;

748 
	}
}

	@resolver.c

13 
	~<ldns/c⁄fig.h
>

15 
	~<ldns/ldns.h
>

16 
	~<°rögs.h
>

23 
uöt16_t


24 
	$ldns_ªsﬁvî_p‹t
(c⁄° 
ldns_ªsﬁvî
 *
r
)

26  
r
->
_p‹t
;

27 
	}
}

29 
ldns_rdf
 *

30 
	$ldns_ªsﬁvî_sour˚
(c⁄° 
ldns_ªsﬁvî
 *
r
)

32  
r
->
_sour˚
;

33 
	}
}

35 
uöt16_t


36 
	$ldns_ªsﬁvî_edns_udp_size
(c⁄° 
ldns_ªsﬁvî
 *
r
)

38  
r
->
_edns_udp_size
;

39 
	}
}

41 
uöt8_t


42 
	$ldns_ªsﬁvî_ªåy
(c⁄° 
ldns_ªsﬁvî
 *
r
)

44  
r
->
_ªåy
;

45 
	}
}

47 
uöt8_t


48 
	$ldns_ªsﬁvî_ªå™s
(c⁄° 
ldns_ªsﬁvî
 *
r
)

50  
r
->
_ªå™s
;

51 
	}
}

53 
boﬁ


54 
	$ldns_ªsﬁvî_ÁŒback
(c⁄° 
ldns_ªsﬁvî
 *
r
)

56  
r
->
_ÁŒback
;

57 
	}
}

59 
uöt8_t


60 
	$ldns_ªsﬁvî_ù6
(c⁄° 
ldns_ªsﬁvî
 *
r
)

62  
r
->
_ù6
;

63 
	}
}

65 
boﬁ


66 
	$ldns_ªsﬁvî_ªcursive
(c⁄° 
ldns_ªsﬁvî
 *
r
)

68  
r
->
_ªcursive
;

69 
	}
}

71 
boﬁ


72 
	$ldns_ªsﬁvî_debug
(c⁄° 
ldns_ªsﬁvî
 *
r
)

74  
r
->
_debug
;

75 
	}
}

77 
boﬁ


78 
	$ldns_ªsﬁvî_dn§ch
(c⁄° 
ldns_ªsﬁvî
 *
r
)

80  
r
->
_dn§ch
;

81 
	}
}

83 
boﬁ


84 
	$ldns_ªsﬁvî_Áû
(c⁄° 
ldns_ªsﬁvî
 *
r
)

86  
r
->
_Áû
;

87 
	}
}

89 
boﬁ


90 
	$ldns_ªsﬁvî_de‚ames
(c⁄° 
ldns_ªsﬁvî
 *
r
)

92  
r
->
_de‚ames
;

93 
	}
}

95 
ldns_rdf
 *

96 
	$ldns_ªsﬁvî_domaö
(c⁄° 
ldns_ªsﬁvî
 *
r
)

98  
r
->
_domaö
;

99 
	}
}

101 
ldns_rdf
 **

102 
	$ldns_ªsﬁvî_£¨chli°
(c⁄° 
ldns_ªsﬁvî
 *
r
)

104  
r
->
_£¨chli°
;

105 
	}
}

107 
ldns_rdf
 **

108 
	$ldns_ªsﬁvî_«me£rvîs
(c⁄° 
ldns_ªsﬁvî
 *
r
)

110  
r
->
_«me£rvîs
;

111 
	}
}

113 
size_t


114 
	$ldns_ªsﬁvî_«me£rvî_cou¡
(c⁄° 
ldns_ªsﬁvî
 *
r
)

116  
r
->
_«me£rvî_cou¡
;

117 
	}
}

119 
boﬁ


120 
	$ldns_ªsﬁvî_dns£c
(c⁄° 
ldns_ªsﬁvî
 *
r
)

122  
r
->
_dns£c
;

123 
	}
}

125 
boﬁ


126 
	$ldns_ªsﬁvî_dns£c_cd
(c⁄° 
ldns_ªsﬁvî
 *
r
)

128  
r
->
_dns£c_cd
;

129 
	}
}

131 
ldns_º_li°
 *

132 
	$ldns_ªsﬁvî_dns£c_™ch‹s
(c⁄° 
ldns_ªsﬁvî
 *
r
)

134  
r
->
_dns£c_™ch‹s
;

135 
	}
}

137 
boﬁ


138 
	$ldns_ªsﬁvî_åu°ed_key
(c⁄° 
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 * 
keys
,Üdns_º_li° * 
åu°ed_keys
)

140 
size_t
 
i
;

141 
boﬁ
 
ªsu…
 = 
Ál£
;

143 
ldns_º_li°
 * 
åu°_™ch‹s
;

144 
ldns_º
 * 
cur_º
;

146 i‡(!
r
 || !
keys
Ë{  
Ál£
; }

148 
åu°_™ch‹s
 = 
	`ldns_ªsﬁvî_dns£c_™ch‹s
(
r
);

150 i‡(!
åu°_™ch‹s
Ë{  
Ál£
; }

152 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
keys
); i++) {

154 
cur_º
 = 
	`ldns_º_li°_º
(
keys
, 
i
);

155 i‡(
	`ldns_º_li°_c⁄èös_º
(
åu°_™ch‹s
, 
cur_º
)) {

156 i‡(
åu°ed_keys
Ë{ 
	`ldns_º_li°_push_º
—ru°ed_keys, 
cur_º
); }

157 
ªsu…
 = 
åue
;

161  
ªsu…
;

162 
	}
}

164 
boﬁ


165 
	$ldns_ªsﬁvî_ig¡c
(c⁄° 
ldns_ªsﬁvî
 *
r
)

167  
r
->
_ig¡c
;

168 
	}
}

170 
boﬁ


171 
	$ldns_ªsﬁvî_u£vc
(c⁄° 
ldns_ªsﬁvî
 *
r
)

173  
r
->
_u£vc
;

174 
	}
}

176 
size_t
 *

177 
	$ldns_ªsﬁvî_πt
(c⁄° 
ldns_ªsﬁvî
 *
r
)

179  
r
->
_πt
;

180 
	}
}

182 
size_t


183 
	$ldns_ªsﬁvî_«me£rvî_πt
(c⁄° 
ldns_ªsﬁvî
 *
r
, 
size_t
 
pos
)

185 
size_t
 *
πt
;

187 
	`as£π
(
r
 !
NULL
);

189 
πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

191 i‡(
pos
 >
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
)) {

195  
πt
[
pos
];

198 
	}
}

200 
timevÆ


201 
	$ldns_ªsﬁvî_timeout
(c⁄° 
ldns_ªsﬁvî
 *
r
)

203  
r
->
_timeout
;

204 
	}
}

207 
	$ldns_ªsﬁvî_tsig_key«me
(c⁄° 
ldns_ªsﬁvî
 *
r
)

209  
r
->
_tsig_key«me
;

210 
	}
}

213 
	$ldns_ªsﬁvî_tsig_Æg‹ôhm
(c⁄° 
ldns_ªsﬁvî
 *
r
)

215  
r
->
_tsig_Æg‹ôhm
;

216 
	}
}

219 
	$ldns_ªsﬁvî_tsig_keyd©a
(c⁄° 
ldns_ªsﬁvî
 *
r
)

221  
r
->
_tsig_keyd©a
;

222 
	}
}

224 
boﬁ


225 
	$ldns_ªsﬁvî_øndom
(c⁄° 
ldns_ªsﬁvî
 *
r
)

227  
r
->
_øndom
;

228 
	}
}

230 
size_t


231 
	$ldns_ªsﬁvî_£¨chli°_cou¡
(c⁄° 
ldns_ªsﬁvî
 *
r
)

233  
r
->
_£¨chli°_cou¡
;

234 
	}
}

238 
	$ldns_ªsﬁvî_£t_p‹t
(
ldns_ªsﬁvî
 *
r
, 
uöt16_t
 
p
)

240 
r
->
_p‹t
 = 
p
;

241 
	}
}

244 
	$ldns_ªsﬁvî_£t_sour˚
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
s
)

246 
r
->
_sour˚
 = 
s
;

247 
	}
}

249 
ldns_rdf
 *

250 
	$ldns_ªsﬁvî_p›_«me£rvî
(
ldns_ªsﬁvî
 *
r
)

252 
ldns_rdf
 **
«me£rvîs
;

253 
ldns_rdf
 *
p›
;

254 
size_t
 
ns_cou¡
;

255 
size_t
 *
πt
;

257 
	`as£π
(
r
 !
NULL
);

259 
ns_cou¡
 = 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
);

260 
«me£rvîs
 = 
	`ldns_ªsﬁvî_«me£rvîs
(
r
);

261 
πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

262 i‡(
ns_cou¡
 =0 || !
«me£rvîs
) {

263  
NULL
;

266 
p›
 = 
«me£rvîs
[
ns_cou¡
 - 1];

268 i‡(
ns_cou¡
 == 1) {

269 
	`LDNS_FREE
(
«me£rvîs
);

270 
	`LDNS_FREE
(
πt
);

272 
	`ldns_ªsﬁvî_£t_«me£rvîs
(
r
, 
NULL
);

273 
	`ldns_ªsﬁvî_£t_πt
(
r
, 
NULL
);

275 
«me£rvîs
 = 
	`LDNS_XREALLOC
“ame£rvîs, 
ldns_rdf
 *,

276 (
ns_cou¡
 - 1));

277 
πt
 = 
	`LDNS_XREALLOC
‘â, 
size_t
, (
ns_cou¡
 - 1));

279 
	`ldns_ªsﬁvî_£t_«me£rvîs
(
r
, 
«me£rvîs
);

280 
	`ldns_ªsﬁvî_£t_πt
(
r
, 
πt
);

283 
	`ldns_ªsﬁvî_dec_«me£rvî_cou¡
(
r
);

284  
p›
;

285 
	}
}

287 
ldns_°©us


288 
	$ldns_ªsﬁvî_push_«me£rvî
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
n
)

290 
ldns_rdf
 **
«me£rvîs
;

291 
size_t
 
ns_cou¡
;

292 
size_t
 *
πt
;

294 i‡(
	`ldns_rdf_gë_ty≥
(
n
Ë!
LDNS_RDF_TYPE_A
 &&

295 
	`ldns_rdf_gë_ty≥
(
n
Ë!
LDNS_RDF_TYPE_AAAA
) {

296  
LDNS_STATUS_ERR
;

299 
ns_cou¡
 = 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
);

300 
«me£rvîs
 = 
	`ldns_ªsﬁvî_«me£rvîs
(
r
);

301 
πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

304 i‡(
ns_cou¡
 == 0) {

305 
«me£rvîs
 = 
	`LDNS_XMALLOC
(
ldns_rdf
 *, 1);

307 
«me£rvîs
 = 
	`LDNS_XREALLOC
“ame£rvîs, 
ldns_rdf
 *, (
ns_cou¡
 + 1));

309 if(!
«me£rvîs
)

310  
LDNS_STATUS_MEM_ERR
;

313 
	`ldns_ªsﬁvî_£t_«me£rvîs
(
r
, 
«me£rvîs
);

316 i‡(
ns_cou¡
 == 0) {

317 
πt
 = 
	`LDNS_XMALLOC
(
size_t
, 1);

319 
πt
 = 
	`LDNS_XREALLOC
‘â, 
size_t
, (
ns_cou¡
 + 1));

321 if(!
πt
)

322  
LDNS_STATUS_MEM_ERR
;

327 
«me£rvîs
[
ns_cou¡
] = 
	`ldns_rdf_˛⁄e
(
n
);

328 
πt
[
ns_cou¡
] = 
LDNS_RESOLV_RTT_MIN
;

329 
	`ldns_ªsﬁvî_ö¸_«me£rvî_cou¡
(
r
);

330 
	`ldns_ªsﬁvî_£t_πt
(
r
, 
πt
);

331  
LDNS_STATUS_OK
;

332 
	}
}

334 
ldns_°©us


335 
	$ldns_ªsﬁvî_push_«me£rvî_º
(
ldns_ªsﬁvî
 *
r
, 
ldns_º
 *
º
)

337 
ldns_rdf
 *
addªss
;

338 i‡((!
º
Ë|| (
	`ldns_º_gë_ty≥
‘rË!
LDNS_RR_TYPE_A
 &&

339 
	`ldns_º_gë_ty≥
(
º
Ë!
LDNS_RR_TYPE_AAAA
)) {

340  
LDNS_STATUS_ERR
;

342 
addªss
 = 
	`ldns_º_rdf
(
º
, 0);

343 i‡(
addªss
) {

344  
	`ldns_ªsﬁvî_push_«me£rvî
(
r
, 
addªss
);

346  
LDNS_STATUS_ERR
;

348 
	}
}

350 
ldns_°©us


351 
	$ldns_ªsﬁvî_push_«me£rvî_º_li°
(
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 *
ºli°
)

353 
ldns_º
 *
º
;

354 
ldns_°©us
 
°©
;

355 
size_t
 
i
;

357 
°©
 = 
LDNS_STATUS_OK
;

358 i‡(
ºli°
) {

359 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºli°
); i++) {

360 
º
 = 
	`ldns_º_li°_º
(
ºli°
, 
i
);

361 i‡(
	`ldns_ªsﬁvî_push_«me£rvî_º
(
r
, 
º
Ë!
LDNS_STATUS_OK
) {

362 
°©
 = 
LDNS_STATUS_ERR
;

366  
°©
;

368  
LDNS_STATUS_ERR
;

370 
	}
}

373 
	$ldns_ªsﬁvî_£t_edns_udp_size
(
ldns_ªsﬁvî
 *
r
, 
uöt16_t
 
s
)

375 
r
->
_edns_udp_size
 = 
s
;

376 
	}
}

379 
	$ldns_ªsﬁvî_£t_ªcursive
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
ª
)

381 
r
->
_ªcursive
 = 
ª
;

382 
	}
}

385 
	$ldns_ªsﬁvî_£t_dns£c
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
d
)

387 
r
->
_dns£c
 = 
d
;

388 
	}
}

391 
	$ldns_ªsﬁvî_£t_dns£c_cd
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
d
)

393 
r
->
_dns£c_cd
 = 
d
;

394 
	}
}

397 
	$ldns_ªsﬁvî_£t_dns£c_™ch‹s
(
ldns_ªsﬁvî
 *
r
, 
ldns_º_li°
 * 
l
)

399 
r
->
_dns£c_™ch‹s
 = 
l
;

400 
	}
}

402 
ldns_°©us


403 
	$ldns_ªsﬁvî_push_dns£c_™ch‹
(
ldns_ªsﬁvî
 *
r
, 
ldns_º
 *
º
)

405 
ldns_º_li°
 * 
åu°_™ch‹s
;

407 i‡((!
º
Ë|| (
	`ldns_º_gë_ty≥
‘rË!
LDNS_RR_TYPE_DNSKEY
 &&

408 
	`ldns_º_gë_ty≥
(
º
Ë!
LDNS_RR_TYPE_DS
)) {

410  
LDNS_STATUS_ERR
;

413 i‡(!(
åu°_™ch‹s
 = 
	`ldns_ªsﬁvî_dns£c_™ch‹s
(
r
))) {

414 
åu°_™ch‹s
 = 
	`ldns_º_li°_√w
();

415 
	`ldns_ªsﬁvî_£t_dns£c_™ch‹s
(
r
, 
åu°_™ch‹s
);

418  (
	`ldns_º_li°_push_º
(
åu°_™ch‹s
, 
	`ldns_º_˛⁄e
(
º
))Ë? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_ERR
;

419 
	}
}

422 
	$ldns_ªsﬁvî_£t_ig¡c
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
i
)

424 
r
->
_ig¡c
 = 
i
;

425 
	}
}

428 
	$ldns_ªsﬁvî_£t_u£vc
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
vc
)

430 
r
->
_u£vc
 = 
vc
;

431 
	}
}

434 
	$ldns_ªsﬁvî_£t_debug
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
d
)

436 
r
->
_debug
 = 
d
;

437 
	}
}

440 
	$ldns_ªsﬁvî_£t_ù6
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
ù6
)

442 
r
->
_ù6
 = 
ù6
;

443 
	}
}

446 
	$ldns_ªsﬁvî_£t_Áû
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
f
)

448 
r
->
_Áû
 =
f
;

449 
	}
}

452 
	$ldns_ªsﬁvî_£t_£¨chli°_cou¡
(
ldns_ªsﬁvî
 *
r
, 
size_t
 
c
)

454 
r
->
_£¨chli°_cou¡
 = 
c
;

455 
	}
}

458 
	$ldns_ªsﬁvî_£t_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
, 
size_t
 
c
)

460 
r
->
_«me£rvî_cou¡
 = 
c
;

461 
	}
}

464 
	$ldns_ªsﬁvî_£t_dn§ch
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
d
)

466 
r
->
_dn§ch
 = 
d
;

467 
	}
}

470 
	$ldns_ªsﬁvî_£t_ªåy
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
ªåy
)

472 
r
->
_ªåy
 = 
ªåy
;

473 
	}
}

476 
	$ldns_ªsﬁvî_£t_ªå™s
(
ldns_ªsﬁvî
 *
r
, 
uöt8_t
 
ªå™s
)

478 
r
->
_ªå™s
 = 
ªå™s
;

479 
	}
}

482 
	$ldns_ªsﬁvî_£t_ÁŒback
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
ÁŒback
)

484 
r
->
_ÁŒback
 = 
ÁŒback
;

485 
	}
}

488 
	$ldns_ªsﬁvî_£t_«me£rvîs
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 **
n
)

490 
r
->
_«me£rvîs
 = 
n
;

491 
	}
}

494 
	$ldns_ªsﬁvî_£t_de‚ames
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
d
)

496 
r
->
_de‚ames
 = 
d
;

497 
	}
}

500 
	$ldns_ªsﬁvî_£t_πt
(
ldns_ªsﬁvî
 *
r
, 
size_t
 *
πt
)

502 
r
->
_πt
 = 
πt
;

503 
	}
}

506 
	$ldns_ªsﬁvî_£t_«me£rvî_πt
(
ldns_ªsﬁvî
 *
r
, 
size_t
 
pos
, size_à
vÆue
)

508 
size_t
 *
πt
;

510 
	`as£π
(
r
 !
NULL
);

512 
πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

514 i‡(
pos
 >
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
)) {

517 
πt
[
pos
] = 
vÆue
;

520 
	}
}

523 
	$ldns_ªsﬁvî_ö¸_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
)

525 
size_t
 
c
;

527 
c
 = 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
);

528 
	`ldns_ªsﬁvî_£t_«me£rvî_cou¡
(
r
, ++
c
);

529 
	}
}

532 
	$ldns_ªsﬁvî_dec_«me£rvî_cou¡
(
ldns_ªsﬁvî
 *
r
)

534 
size_t
 
c
;

536 
c
 = 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
);

537 i‡(
c
 == 0) {

540 
	`ldns_ªsﬁvî_£t_«me£rvî_cou¡
(
r
, --
c
);

542 
	}
}

545 
	$ldns_ªsﬁvî_£t_domaö
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
d
)

547 
r
->
_domaö
 = 
d
;

548 
	}
}

551 
	$ldns_ªsﬁvî_£t_timeout
(
ldns_ªsﬁvî
 *
r
, 
timevÆ
 
timeout
)

553 
r
->
_timeout
.
tv_£c
 = 
timeout
.tv_sec;

554 
r
->
_timeout
.
tv_u£c
 = 
timeout
.tv_usec;

555 
	}
}

558 
	$ldns_ªsﬁvî_push_£¨chli°
(
ldns_ªsﬁvî
 *
r
, 
ldns_rdf
 *
d
)

560 
ldns_rdf
 **
£¨chli°
;

561 
size_t
 
li°_cou¡
;

563 i‡(
	`ldns_rdf_gë_ty≥
(
d
Ë!
LDNS_RDF_TYPE_DNAME
) {

567 
li°_cou¡
 = 
	`ldns_ªsﬁvî_£¨chli°_cou¡
(
r
);

568 
£¨chli°
 = 
	`ldns_ªsﬁvî_£¨chli°
(
r
);

570 
£¨chli°
 = 
	`LDNS_XREALLOC
(£¨chli°, 
ldns_rdf
 *, (
li°_cou¡
 + 1));

571 i‡(
£¨chli°
) {

572 
r
->
_£¨chli°
 = 
£¨chli°
;

574 
£¨chli°
[
li°_cou¡
] = 
	`ldns_rdf_˛⁄e
(
d
);

575 
	`ldns_ªsﬁvî_£t_£¨chli°_cou¡
(
r
, 
li°_cou¡
 + 1);

577 
	}
}

580 
	$ldns_ªsﬁvî_£t_tsig_key«me
(
ldns_ªsﬁvî
 *
r
, *
tsig_key«me
)

582 
	`LDNS_FREE
(
r
->
_tsig_key«me
);

583 
r
->
_tsig_key«me
 = 
	`°rdup
(
tsig_key«me
);

584 
	}
}

587 
	$ldns_ªsﬁvî_£t_tsig_Æg‹ôhm
(
ldns_ªsﬁvî
 *
r
, *
tsig_Æg‹ôhm
)

589 
	`LDNS_FREE
(
r
->
_tsig_Æg‹ôhm
);

590 
r
->
_tsig_Æg‹ôhm
 = 
	`°rdup
(
tsig_Æg‹ôhm
);

591 
	}
}

594 
	$ldns_ªsﬁvî_£t_tsig_keyd©a
(
ldns_ªsﬁvî
 *
r
, *
tsig_keyd©a
)

596 
	`LDNS_FREE
(
r
->
_tsig_keyd©a
);

597 
r
->
_tsig_keyd©a
 = 
	`°rdup
(
tsig_keyd©a
);

598 
	}
}

601 
	$ldns_ªsﬁvî_£t_øndom
(
ldns_ªsﬁvî
 *
r
, 
boﬁ
 
b
)

603 
r
->
_øndom
 = 
b
;

604 
	}
}

607 
ldns_ªsﬁvî
 *

608 
	$ldns_ªsﬁvî_√w
()

610 
ldns_ªsﬁvî
 *
r
;

612 
r
 = 
	`LDNS_MALLOC
(
ldns_ªsﬁvî
);

613 i‡(!
r
) {

614  
NULL
;

617 
r
->
_£¨chli°
 = 
NULL
;

618 
r
->
_«me£rvîs
 = 
NULL
;

619 
r
->
_πt
 = 
NULL
;

622 
	`ldns_ªsﬁvî_£t_£¨chli°_cou¡
(
r
, 0);

623 
	`ldns_ªsﬁvî_£t_«me£rvî_cou¡
(
r
, 0);

624 
	`ldns_ªsﬁvî_£t_u£vc
(
r
, 0);

625 
	`ldns_ªsﬁvî_£t_p‹t
(
r
, 
LDNS_PORT
);

626 
	`ldns_ªsﬁvî_£t_domaö
(
r
, 
NULL
);

627 
	`ldns_ªsﬁvî_£t_de‚ames
(
r
, 
Ál£
);

628 
	`ldns_ªsﬁvî_£t_ªåy
(
r
, 3);

629 
	`ldns_ªsﬁvî_£t_ªå™s
(
r
, 2);

630 
	`ldns_ªsﬁvî_£t_ÁŒback
(
r
, 
åue
);

631 
	`ldns_ªsﬁvî_£t_Áû
(
r
, 
Ál£
);

632 
	`ldns_ªsﬁvî_£t_edns_udp_size
(
r
, 0);

633 
	`ldns_ªsﬁvî_£t_dns£c
(
r
, 
Ál£
);

634 
	`ldns_ªsﬁvî_£t_dns£c_cd
(
r
, 
Ál£
);

635 
	`ldns_ªsﬁvî_£t_dns£c_™ch‹s
(
r
, 
NULL
);

636 
	`ldns_ªsﬁvî_£t_ù6
(
r
, 
LDNS_RESOLV_INETANY
);

637 
	`ldns_ªsﬁvî_£t_ig¡c
(
r
, 
Ál£
);

638 
	`ldns_ªsﬁvî_£t_ªcursive
(
r
, 
Ál£
);

639 
	`ldns_ªsﬁvî_£t_dn§ch
(
r
, 
åue
);

640 
	`ldns_ªsﬁvî_£t_sour˚
(
r
, 
NULL
);

645 
	`ldns_ªsﬁvî_£t_øndom
(
r
, 
åue
);

647 
	`ldns_ªsﬁvî_£t_debug
(
r
, 0);

649 
r
->
_timeout
.
tv_£c
 = 
LDNS_DEFAULT_TIMEOUT_SEC
;

650 
r
->
_timeout
.
tv_u£c
 = 
LDNS_DEFAULT_TIMEOUT_USEC
;

654 
r
->
_sockë
 = 0;

655 
r
->
_ax‰_sﬂ_cou¡
 = 0;

656 
r
->
_ax‰_i
 = 0;

657 
r
->
_cur_ax‰_pkt
 = 
NULL
;

659 
r
->
_tsig_key«me
 = 
NULL
;

660 
r
->
_tsig_keyd©a
 = 
NULL
;

661 
r
->
_tsig_Æg‹ôhm
 = 
NULL
;

662  
r
;

663 
	}
}

665 
ldns_°©us


666 
	$ldns_ªsﬁvî_√w_‰m_Â
(
ldns_ªsﬁvî
 **
ªs
, 
FILE
 *
Â
)

668  
	`ldns_ªsﬁvî_√w_‰m_Â_l
(
ªs
, 
Â
, 
NULL
);

669 
	}
}

671 
ldns_°©us


672 
	$ldns_ªsﬁvî_√w_‰m_Â_l
(
ldns_ªsﬁvî
 **
ªs
, 
FILE
 *
Â
, *
löe_ƒ
)

674 
ldns_ªsﬁvî
 *
r
;

675 c⁄° *
keyw‹d
[
LDNS_RESOLV_KEYWORDS
];

676 
w‹d
[
LDNS_MAX_LINELEN
 + 1];

677 
öt8_t
 
ex≥˘
;

678 
uöt8_t
 
i
;

679 
ldns_rdf
 *
tmp
;

680 #ifde‡
HAVE_SSL


681 
ldns_º
 *
tmp_º
;

683 
ssize_t
 
gå
, 
bgå
;

684 
ldns_buf„r
 *
b
;

685 
 r
 = 0, 
ﬁdlöe
;

686 
FILE
* 
myÂ
 = 
Â
;

687 if(!
löe_ƒ
Ëlöe_ƒ = &
 r
;

689 if(!
Â
) {

690 
myÂ
 = 
	`f›í
("/etc/resolv.conf", "r");

691 if(!
myÂ
)

692  
LDNS_STATUS_FILE_ERR
;

703 
keyw‹d
[
LDNS_RESOLV_NAMESERVER
] = "nameserver";

704 
keyw‹d
[
LDNS_RESOLV_DEFDOMAIN
] = "domain";

705 
keyw‹d
[
LDNS_RESOLV_SEARCH
] = "search";

707 
keyw‹d
[
LDNS_RESOLV_SORTLIST
] = "sortlist";

708 
keyw‹d
[
LDNS_RESOLV_OPTIONS
] = "options";

709 
keyw‹d
[
LDNS_RESOLV_ANCHOR
] = "anchor";

710 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

712 
r
 = 
	`ldns_ªsﬁvî_√w
();

713 i‡(!
r
) {

714 if(!
Â
Ë
	`f˛o£
(
myÂ
);

715  
LDNS_STATUS_MEM_ERR
;

718 
gå
 = 1;

719 
w‹d
[0] = 0;

720 
ﬁdlöe
 = *
löe_ƒ
;

721 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

722 
gå
 > 0) {

724 i‡(
w‹d
[0] == '#') {

725 
w‹d
[0]='x';

726 if(
ﬁdlöe
 =*
löe_ƒ
) {

728 
c
;

730 
c
 = 
	`fgëc
(
myÂ
);

731 } 
c
 !
EOF
 && c != '\n');

732 if(
c
=='\n'Ë(*
löe_ƒ
)++;

735 
ﬁdlöe
 = *
löe_ƒ
;

738 
ﬁdlöe
 = *
löe_ƒ
;

739 
ex≥˘
) {

740 
LDNS_RESOLV_KEYWORD
:

742 
gå
 = 
	`ldns_fgë_tokí_l
(
myÂ
, 
w‹d
, 
LDNS_PARSE_NORMAL
, 0, 
löe_ƒ
);

743 i‡(
gå
 != 0) {

744 if(
w‹d
[0] == '#') ;

745 
i
 = 0; i < 
LDNS_RESOLV_KEYWORDS
; i++) {

746 i‡(
	`°rˇ£cmp
(
keyw‹d
[
i
], 
w‹d
) == 0) {

750 
ex≥˘
 = 
i
;

755 i‡(
ex≥˘
 =
LDNS_RESOLV_KEYWORD
) {

765 
LDNS_RESOLV_DEFDOMAIN
:

767 
gå
 = 
	`ldns_fgë_tokí_l
(
myÂ
, 
w‹d
, 
LDNS_PARSE_NORMAL
, 0, 
löe_ƒ
);

768 i‡(
gå
 == 0) {

769 if(!
Â
Ë
	`f˛o£
(
myÂ
);

770  
LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
;

772 if(
w‹d
[0] == '#') {

773 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

776 
tmp
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
w‹d
);

777 i‡(!
tmp
) {

778 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

779 if(!
Â
Ë
	`f˛o£
(
myÂ
);

780  
LDNS_STATUS_SYNTAX_DNAME_ERR
;

784 
	`ldns_ªsﬁvî_£t_domaö
(
r
, 
tmp
);

785 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

787 
LDNS_RESOLV_NAMESERVER
:

789 
gå
 = 
	`ldns_fgë_tokí_l
(
myÂ
, 
w‹d
, 
LDNS_PARSE_NORMAL
, 0, 
löe_ƒ
);

790 i‡(
gå
 == 0) {

791 if(!
Â
Ë
	`f˛o£
(
myÂ
);

792  
LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
;

794 if(
w‹d
[0] == '#') {

795 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

798 if(
	`°rchr
(
w‹d
, '%')) {

801 
	`°rchr
(
w‹d
, '%')[0]=0;

803 
tmp
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_AAAA
, 
w‹d
);

804 i‡(!
tmp
) {

806 
tmp
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_A
, 
w‹d
);

809 i‡(!
tmp
) {

810 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

811 if(!
Â
Ë
	`f˛o£
(
myÂ
);

812  
LDNS_STATUS_SYNTAX_ERR
;

814 ()
	`ldns_ªsﬁvî_push_«me£rvî
(
r
, 
tmp
);

815 
	`ldns_rdf_dìp_‰ì
(
tmp
);

816 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

818 
LDNS_RESOLV_SEARCH
:

820 
gå
 = 
	`ldns_fgë_tokí_l
(
myÂ
, 
w‹d
, 
LDNS_PARSE_SKIP_SPACE
, 0, 
löe_ƒ
);

821 
b
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

822 if(!
b
) {

823 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

824 if(!
Â
Ë
	`f˛o£
(
myÂ
);

825  
LDNS_STATUS_MEM_ERR
;

828 
	`ldns_buf„r_√w_‰m_d©a
(
b
, 
w‹d
, (
size_t
Ë
gå
);

829 if(
	`ldns_buf„r_°©us
(
b
Ë!
LDNS_STATUS_OK
) {

830 
	`LDNS_FREE
(
b
);

831 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

832 if(!
Â
Ë
	`f˛o£
(
myÂ
);

833  
LDNS_STATUS_MEM_ERR
;

835 
bgå
 = 
	`ldns_bgë_tokí
(
b
, 
w‹d
, 
LDNS_PARSE_NORMAL
, (
size_t
Ë
gå
 + 1);

836 
bgå
 > 0) {

837 
gå
 -
bgå
;

838 if(
w‹d
[0] == '#') {

839 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

842 
tmp
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
w‹d
);

843 i‡(!
tmp
) {

844 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

845 
	`ldns_buf„r_‰ì
(
b
);

846 if(!
Â
Ë
	`f˛o£
(
myÂ
);

847  
LDNS_STATUS_SYNTAX_DNAME_ERR
;

850 
	`ldns_ªsﬁvî_push_£¨chli°
(
r
, 
tmp
);

852 
	`ldns_rdf_dìp_‰ì
(
tmp
);

853 
bgå
 = 
	`ldns_bgë_tokí
(
b
, 
w‹d
, 
LDNS_PARSE_NORMAL
,

854 (
size_t
Ë
gå
 + 1);

856 
	`ldns_buf„r_‰ì
(
b
);

857 i‡(
ex≥˘
 !
LDNS_RESOLV_KEYWORD
) {

858 
gå
 = 1;

859 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

862 
LDNS_RESOLV_SORTLIST
:

863 
gå
 = 
	`ldns_fgë_tokí_l
(
myÂ
, 
w‹d
, 
LDNS_PARSE_SKIP_SPACE
, 0, 
löe_ƒ
);

865 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

867 
LDNS_RESOLV_OPTIONS
:

868 
gå
 = 
	`ldns_fgë_tokí_l
(
myÂ
, 
w‹d
, 
LDNS_PARSE_SKIP_SPACE
, 0, 
löe_ƒ
);

870 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

872 
LDNS_RESOLV_ANCHOR
:

874 
gå
 = 
	`ldns_fgë_tokí_l
(
myÂ
, 
w‹d
, 
LDNS_PARSE_NORMAL
, 0, 
löe_ƒ
);

875 i‡(
gå
 == 0) {

876 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

877 if(!
Â
Ë
	`f˛o£
(
myÂ
);

878  
LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
;

880 if(
w‹d
[0] == '#') {

881 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

885 #ifde‡
HAVE_SSL


886 
tmp_º
 = 
	`ldns_ªad_™ch‹_fûe
(
w‹d
);

887 (Ë
	`ldns_ªsﬁvî_push_dns£c_™ch‹
(
r
, 
tmp_º
);

888 
	`ldns_º_‰ì
(
tmp_º
);

890 
ex≥˘
 = 
LDNS_RESOLV_KEYWORD
;

895 if(!
Â
)

896 
	`f˛o£
(
myÂ
);

898 i‡(
ªs
) {

899 *
ªs
 = 
r
;

900  
LDNS_STATUS_OK
;

902 
	`ldns_ªsﬁvî_dìp_‰ì
(
r
);

903  
LDNS_STATUS_NULL
;

905 
	}
}

907 
ldns_°©us


908 
	$ldns_ªsﬁvî_√w_‰m_fûe
(
ldns_ªsﬁvî
 **
ªs
, c⁄° *
fûíame
)

910 
ldns_ªsﬁvî
 *
r
;

911 
FILE
 *
Â
;

912 
ldns_°©us
 
s
;

914 i‡(!
fûíame
) {

915 
Â
 = 
	`f›í
(
LDNS_RESOLV_CONF
, "r");

918 
Â
 = 
	`f›í
(
fûíame
, "r");

920 i‡(!
Â
) {

921  
LDNS_STATUS_FILE_ERR
;

924 
s
 = 
	`ldns_ªsﬁvî_√w_‰m_Â
(&
r
, 
Â
);

925 
	`f˛o£
(
Â
);

926 i‡(
s
 =
LDNS_STATUS_OK
) {

927 i‡(
ªs
) {

928 *
ªs
 = 
r
;

929  
LDNS_STATUS_OK
;

931 
	`ldns_ªsﬁvî_‰ì
(
r
);

932  
LDNS_STATUS_NULL
;

935  
s
;

936 
	}
}

939 
	$ldns_ªsﬁvî_‰ì
(
ldns_ªsﬁvî
 *
ªs
)

941 
	`LDNS_FREE
(
ªs
);

942 
	}
}

945 
	$ldns_ªsﬁvî_dìp_‰ì
(
ldns_ªsﬁvî
 *
ªs
)

947 
size_t
 
i
;

949 i‡(
ªs
) {

950 i‡(
ªs
->
_£¨chli°
) {

951 
i
 = 0; i < 
	`ldns_ªsﬁvî_£¨chli°_cou¡
(
ªs
); i++) {

952 
	`ldns_rdf_dìp_‰ì
(
ªs
->
_£¨chli°
[
i
]);

954 
	`LDNS_FREE
(
ªs
->
_£¨chli°
);

956 i‡(
ªs
->
_«me£rvîs
) {

957 
i
 = 0; i < 
ªs
->
_«me£rvî_cou¡
; i++) {

958 
	`ldns_rdf_dìp_‰ì
(
ªs
->
_«me£rvîs
[
i
]);

960 
	`LDNS_FREE
(
ªs
->
_«me£rvîs
);

962 i‡(
	`ldns_ªsﬁvî_domaö
(
ªs
)) {

963 
	`ldns_rdf_dìp_‰ì
(
	`ldns_ªsﬁvî_domaö
(
ªs
));

965 i‡(
ªs
->
_tsig_key«me
) {

966 
	`LDNS_FREE
(
ªs
->
_tsig_key«me
);

968 i‡(
ªs
->
_tsig_keyd©a
) {

969 
	`LDNS_FREE
(
ªs
->
_tsig_keyd©a
);

971 i‡(
ªs
->
_tsig_Æg‹ôhm
) {

972 
	`LDNS_FREE
(
ªs
->
_tsig_Æg‹ôhm
);

975 i‡(
ªs
->
_cur_ax‰_pkt
) {

976 
	`ldns_pkt_‰ì
(
ªs
->
_cur_ax‰_pkt
);

979 i‡(
ªs
->
_πt
) {

980 
	`LDNS_FREE
(
ªs
->
_πt
);

982 i‡(
ªs
->
_dns£c_™ch‹s
) {

983 
	`ldns_º_li°_dìp_‰ì
(
ªs
->
_dns£c_™ch‹s
);

985 
	`LDNS_FREE
(
ªs
);

987 
	}
}

989 
ldns_°©us


990 
	$ldns_ªsﬁvî_£¨ch_°©us
(
ldns_pkt
** 
pkt
,

991 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
,

992 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
)

994 
ldns_rdf
 *
√w_«me
;

995 
ldns_rdf
 **
£¨ch_li°
;

996 
size_t
 
i
;

997 
ldns_°©us
 
s
 = 
LDNS_STATUS_OK
;

999 i‡(
	`ldns_d«me_absﬁuã
(
«me
)) {

1001  
	`ldns_ªsﬁvî_quîy_°©us
(
pkt
, 
r
, 
«me
, 
t
, 
c
, 
Êags
);

1002 } i‡(
	`ldns_ªsﬁvî_dn§ch
(
r
)) {

1003 
£¨ch_li°
 = 
	`ldns_ªsﬁvî_£¨chli°
(
r
);

1004 
i
 = 0; i < 
	`ldns_ªsﬁvî_£¨chli°_cou¡
(
r
); i++) {

1005 
√w_«me
 = 
	`ldns_d«me_ˇt_˛⁄e
(
«me
, 
£¨ch_li°
[
i
]);

1007 
s
 = 
	`ldns_ªsﬁvî_quîy_°©us
(
pkt
, 
r
,

1008 
√w_«me
, 
t
, 
c
, 
Êags
);

1009 
	`ldns_rdf_‰ì
(
√w_«me
);

1010 i‡(
pkt
) {

1011 i‡(
s
 =
LDNS_STATUS_OK
 && *
pkt
 &&

1012 
	`ldns_pkt_gë_rcode
(*
pkt
) ==

1013 
LDNS_RCODE_NOERROR
) {

1014  
LDNS_STATUS_OK
;

1016 
	`ldns_pkt_‰ì
(*
pkt
);

1020  
s
;

1021 
	}
}

1023 
ldns_pkt
 *

1024 
	$ldns_ªsﬁvî_£¨ch
(c⁄° 
ldns_ªsﬁvî
 *
r
,c⁄° 
ldns_rdf
 *
«me
,

1025 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
)

1027 
ldns_pkt
* 
pkt
 = 
NULL
;

1028 i‡(
	`ldns_ªsﬁvî_£¨ch_°©us
(&
pkt
, (
ldns_ªsﬁvî
 *)
r
,

1029 
«me
, 
t
, 
c
, 
Êags
Ë!
LDNS_STATUS_OK
) {

1030 
	`ldns_pkt_‰ì
(
pkt
);

1032  
pkt
;

1033 
	}
}

1035 
ldns_°©us


1036 
	$ldns_ªsﬁvî_quîy_°©us
(
ldns_pkt
** 
pkt
,

1037 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
,

1038 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
)

1040 
ldns_rdf
 *
√w«me
;

1041 
ldns_°©us
 
°©us
;

1043 i‡(!
	`ldns_ªsﬁvî_de‚ames
(
r
Ë|| !
	`ldns_ªsﬁvî_domaö
(r)) {

1044  
	`ldns_ªsﬁvî_£nd
(
pkt
, 
r
, 
«me
, 
t
, 
c
, 
Êags
);

1047 
√w«me
 = 
	`ldns_d«me_ˇt_˛⁄e
(
«me
, 
	`ldns_ªsﬁvî_domaö
(
r
));

1048 i‡(!
√w«me
) {

1049  
LDNS_STATUS_MEM_ERR
;

1051 
°©us
 = 
	`ldns_ªsﬁvî_£nd
(
pkt
, 
r
, 
√w«me
, 
t
, 
c
, 
Êags
);

1052 
	`ldns_rdf_‰ì
(
√w«me
);

1053  
°©us
;

1054 
	}
}

1056 
ldns_pkt
 *

1057 
	$ldns_ªsﬁvî_quîy
(c⁄° 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
,

1058 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
)

1060 
ldns_pkt
* 
pkt
 = 
NULL
;

1061 i‡(
	`ldns_ªsﬁvî_quîy_°©us
(&
pkt
, (
ldns_ªsﬁvî
 *)
r
,

1062 
«me
, 
t
, 
c
, 
Êags
Ë!
LDNS_STATUS_OK
) {

1063 
	`ldns_pkt_‰ì
(
pkt
);

1065  
pkt
;

1066 
	}
}

1068 
size_t
 *

1069 
	$ldns_ªsﬁvî_backup_πt
(
ldns_ªsﬁvî
 *
r
)

1071 
size_t
 *
√w_πt
;

1072 
size_t
 *
ﬁd_πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

1074 i‡(
ﬁd_πt
 && 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
)) {

1075 
√w_πt
 = 
	`LDNS_XMALLOC
(
size_t


1076 , 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
));

1077 
	`mem˝y
(
√w_πt
, 
ﬁd_πt
, (
size_t
)

1078 * 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
));

1079 
	`ldns_ªsﬁvî_£t_πt
(
r
, 
√w_πt
);

1080  
ﬁd_πt
;

1082  
NULL
;

1083 
	}
}

1086 
	$ldns_ªsﬁvî_ª°‹e_πt
(
ldns_ªsﬁvî
 *
r
, 
size_t
 *
ﬁd_πt
)

1088 
size_t
 *
cur_πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

1090 i‡(
cur_πt
) {

1091 
	`LDNS_FREE
(
cur_πt
);

1093 
	`ldns_ªsﬁvî_£t_πt
(
r
, 
ﬁd_πt
);

1094 
	}
}

1096 
ldns_°©us


1097 
	$ldns_ªsﬁvî_£nd_pkt
(
ldns_pkt
 **
™swî
, 
ldns_ªsﬁvî
 *
r
,

1098 
ldns_pkt
 *
quîy_pkt
)

1100 
ldns_pkt
 *
™swî_pkt
 = 
NULL
;

1101 
ldns_°©us
 
°©
 = 
LDNS_STATUS_OK
;

1102 
size_t
 *
πt
;

1104 
°©
 = 
	`ldns_£nd
(&
™swî_pkt
, (
ldns_ªsﬁvî
 *)
r
, 
quîy_pkt
);

1105 i‡(
°©
 !
LDNS_STATUS_OK
) {

1106 if(
™swî_pkt
) {

1107 
	`ldns_pkt_‰ì
(
™swî_pkt
);

1108 
™swî_pkt
 = 
NULL
;

1113 i‡(!
	`ldns_ªsﬁvî_u£vc
(
r
Ë&& 
	`ldns_ªsﬁvî_ÁŒback
(r)) {

1114 i‡(
	`ldns_pkt_tc
(
™swî_pkt
)) {

1116 i‡(
	`ldns_pkt_edns_udp_size
(
quîy_pkt
) == 0) {

1117 
	`ldns_pkt_£t_edns_udp_size
(
quîy_pkt


1119 
	`ldns_pkt_‰ì
(
™swî_pkt
);

1128 
πt
 = 
	`ldns_ªsﬁvî_backup_πt
(
r
);

1129 
°©
 = 
	`ldns_£nd
(&
™swî_pkt
, 
r


1130 , 
quîy_pkt
);

1131 
	`ldns_ªsﬁvî_ª°‹e_πt
(
r
, 
πt
);

1134 i‡(
°©
 !
LDNS_STATUS_OK
 ||

1135 
	`ldns_pkt_tc
(
™swî_pkt
)) {

1136 
	`ldns_ªsﬁvî_£t_u£vc
(
r
, 
åue
);

1137 
	`ldns_pkt_‰ì
(
™swî_pkt
);

1138 
°©
 = 
	`ldns_£nd
(&
™swî_pkt
, 
r
, 
quîy_pkt
);

1139 
	`ldns_ªsﬁvî_£t_u£vc
(
r
, 
Ál£
);

1145 i‡(
™swî
) {

1146 *
™swî
 = 
™swî_pkt
;

1149  
°©
;

1150 
	}
}

1152 
ldns_°©us


1153 
	$ldns_ªsﬁvî_¥ï¨e_quîy_pkt
(
ldns_pkt
 **
quîy_pkt
, 
ldns_ªsﬁvî
 *
r
,

1154 c⁄° 
ldns_rdf
 *
«me
, 
ldns_º_ty≥
 
t
,

1155 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
)

1157 
timevÆ
 
now
;

1161 i‡(
t
 =
LDNS_RR_TYPE_IXFR
) {

1162 *
quîy_pkt
 = 
	`ldns_pkt_ix‰_ªque°_√w
(
	`ldns_rdf_˛⁄e
(
«me
),

1163 
c
, 
Êags
, 
NULL
);

1165 *
quîy_pkt
 = 
	`ldns_pkt_quîy_√w
(
	`ldns_rdf_˛⁄e
(
«me
), 
t
, 
c
, 
Êags
);

1167 i‡(!*
quîy_pkt
) {

1168  
LDNS_STATUS_ERR
;

1172 i‡(
	`ldns_ªsﬁvî_dns£c
(
r
)) {

1173 i‡(
	`ldns_ªsﬁvî_edns_udp_size
(
r
) == 0) {

1174 
	`ldns_ªsﬁvî_£t_edns_udp_size
(
r
, 4096);

1176 
	`ldns_pkt_£t_edns_do
(*
quîy_pkt
, 
åue
);

1177 i‡(
	`ldns_ªsﬁvî_dns£c_cd
(
r
Ë|| (
Êags
 & 
LDNS_CD
)) {

1178 
	`ldns_pkt_£t_cd
(*
quîy_pkt
, 
åue
);

1183 i‡(
	`ldns_ªsﬁvî_edns_udp_size
(
r
) != 0) {

1184 
	`ldns_pkt_£t_edns_udp_size
(*
quîy_pkt
, 
	`ldns_ªsﬁvî_edns_udp_size
(
r
));

1188 
now
.
tv_£c
 = 
	`time
(
NULL
);

1189 
now
.
tv_u£c
 = 0;

1190 
	`ldns_pkt_£t_time°amp
(*
quîy_pkt
, 
now
);

1193 i‡(
	`ldns_ªsﬁvî_debug
(
r
)) {

1194 
	`ldns_pkt_¥öt
(
°dout
, *
quîy_pkt
);

1198 i‡(
	`ldns_pkt_id
(*
quîy_pkt
) == 0) {

1199 
	`ldns_pkt_£t_øndom_id
(*
quîy_pkt
);

1202  
LDNS_STATUS_OK
;

1203 
	}
}

1206 
ldns_°©us


1207 
	$ldns_ªsﬁvî_£nd
(
ldns_pkt
 **
™swî
, 
ldns_ªsﬁvî
 *
r
, c⁄° 
ldns_rdf
 *
«me
,

1208 
ldns_º_ty≥
 
t
, 
ldns_º_˛ass
 
c
, 
uöt16_t
 
Êags
)

1210 
ldns_pkt
 *
quîy_pkt
;

1211 
ldns_pkt
 *
™swî_pkt
;

1212 
ldns_°©us
 
°©us
;

1214 
	`as£π
(
r
 !
NULL
);

1215 
	`as£π
(
«me
 !
NULL
);

1217 
™swî_pkt
 = 
NULL
;

1222 i‡(0 =
t
) {

1223 
t

LDNS_RR_TYPE_A
;

1225 i‡(0 =
c
) {

1226 
c

LDNS_RR_CLASS_IN
;

1228 i‡(0 =
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
)) {

1229  
LDNS_STATUS_RES_NO_NS
;

1231 i‡(
	`ldns_rdf_gë_ty≥
(
«me
Ë!
LDNS_RDF_TYPE_DNAME
) {

1232  
LDNS_STATUS_RES_QUERY
;

1235 
°©us
 = 
	`ldns_ªsﬁvî_¥ï¨e_quîy_pkt
(&
quîy_pkt
, 
r
, 
«me
,

1236 
t
, 
c
, 
Êags
);

1237 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1238  
°©us
;

1247 i‡(
	`ldns_ªsﬁvî_tsig_key«me
(
r
Ë&& 
	`ldns_ªsﬁvî_tsig_keyd©a
(r)) {

1248 #ifde‡
HAVE_SSL


1249 
°©us
 = 
	`ldns_pkt_tsig_sign
(
quîy_pkt
,

1250 
	`ldns_ªsﬁvî_tsig_key«me
(
r
),

1251 
	`ldns_ªsﬁvî_tsig_keyd©a
(
r
),

1252 300, 
	`ldns_ªsﬁvî_tsig_Æg‹ôhm
(
r
), 
NULL
);

1253 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1254 
	`ldns_pkt_‰ì
(
quîy_pkt
);

1255  
LDNS_STATUS_CRYPTO_TSIG_ERR
;

1258 
	`ldns_pkt_‰ì
(
quîy_pkt
);

1259  
LDNS_STATUS_CRYPTO_TSIG_ERR
;

1263 
°©us
 = 
	`ldns_ªsﬁvî_£nd_pkt
(&
™swî_pkt
, 
r
, 
quîy_pkt
);

1264 
	`ldns_pkt_‰ì
(
quîy_pkt
);

1267 i‡(
™swî
) {

1268 *
™swî
 = 
™swî_pkt
;

1270  
°©us
;

1271 
	}
}

1273 
ldns_º
 *

1274 
	$ldns_ax‰_√xt
(
ldns_ªsﬁvî
 *
ªsﬁvî
)

1276 
ldns_º
 *
cur_º
;

1277 
uöt8_t
 *
∑ckë_wúe
;

1278 
size_t
 
∑ckë_wúe_size
;

1279 
ldns_lookup_èbÀ
 *
rcode
;

1280 
ldns_°©us
 
°©us
;

1283 i‡(!
ªsﬁvî
 ||Ñesﬁvî->
_sockë
 == 0) {

1284  
NULL
;

1287 i‡(
ªsﬁvî
->
_cur_ax‰_pkt
) {

1288 i‡(
ªsﬁvî
->
_ax‰_i
 =
	`ldns_pkt_™cou¡
‘esﬁvî->
_cur_ax‰_pkt
)) {

1289 
	`ldns_pkt_‰ì
(
ªsﬁvî
->
_cur_ax‰_pkt
);

1290 
ªsﬁvî
->
_cur_ax‰_pkt
 = 
NULL
;

1291  
	`ldns_ax‰_√xt
(
ªsﬁvî
);

1293 
cur_º
 = 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(

1294 
	`ldns_pkt_™swî
(
ªsﬁvî
->
_cur_ax‰_pkt
),

1295 
ªsﬁvî
->
_ax‰_i
));

1296 
ªsﬁvî
->
_ax‰_i
++;

1297 i‡(
	`ldns_º_gë_ty≥
(
cur_º
Ë=
LDNS_RR_TYPE_SOA
) {

1298 
ªsﬁvî
->
_ax‰_sﬂ_cou¡
++;

1299 i‡(
ªsﬁvî
->
_ax‰_sﬂ_cou¡
 >= 2) {

1300 #i‚de‡
USE_WINSOCK


1301 
	`˛o£
(
ªsﬁvî
->
_sockë
);

1303 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

1305 
ªsﬁvî
->
_sockë
 = 0;

1306 
	`ldns_pkt_‰ì
(
ªsﬁvî
->
_cur_ax‰_pkt
);

1307 
ªsﬁvî
->
_cur_ax‰_pkt
 = 
NULL
;

1310  
cur_º
;

1312 
∑ckë_wúe
 = 
	`ldns_t˝_ªad_wúe
(
ªsﬁvî
->
_sockë
, &
∑ckë_wúe_size
);

1313 if(!
∑ckë_wúe
)

1314  
NULL
;

1316 
°©us
 = 
	`ldns_wúe2pkt
(&
ªsﬁvî
->
_cur_ax‰_pkt
, 
∑ckë_wúe
,

1317 
∑ckë_wúe_size
);

1318 
	`LDNS_FREE
(
∑ckë_wúe
);

1320 
ªsﬁvî
->
_ax‰_i
 = 0;

1321 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1323 #ifde‡
STDERR_MSGS


1324 
	`Ârötf
(
°dîr
, "Eº‹Ö¨sögÑ∏durög AXFR: %s\n", 
	`ldns_gë_îr‹°r_by_id
(
°©us
));

1330 #i‚de‡
USE_WINSOCK


1331 
	`˛o£
(
ªsﬁvî
->
_sockë
);

1333 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

1335 
ªsﬁvî
->
_sockë
 = 0;

1337  
NULL
;

1338 } i‡(
	`ldns_pkt_gë_rcode
(
ªsﬁvî
->
_cur_ax‰_pkt
) != 0) {

1339 
rcode
 = 
	`ldns_lookup_by_id
(
ldns_rcodes
, (Ë
	`ldns_pkt_gë_rcode
(
ªsﬁvî
->
_cur_ax‰_pkt
));

1340 #ifde‡
STDERR_MSGS


1341 i‡(
rcode
) {

1342 
	`Ârötf
(
°dîr
, "Error in AXFR: %s\n",

1343 
rcode
->
«me
);

1345 
	`Ârötf
(
°dîr
, "Error in AXFR: %d\n",

1346 (Ë
	`ldns_pkt_gë_rcode
(

1347 
ªsﬁvî
->
_cur_ax‰_pkt
));

1354 #i‚de‡
USE_WINSOCK


1355 
	`˛o£
(
ªsﬁvî
->
_sockë
);

1357 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

1359 
ªsﬁvî
->
_sockë
 = 0;

1361  
NULL
;

1363  
	`ldns_ax‰_√xt
(
ªsﬁvî
);

1368 
	}
}

1376 
	$ldns_ax‰_ab‹t
(
ldns_ªsﬁvî
 *
ªsﬁvî
)

1379 i‡(
ªsﬁvî
->
_sockë
 != 0)

1381 #i‚de‡
USE_WINSOCK


1382 
	`˛o£
(
ªsﬁvî
->
_sockë
);

1384 
	`˛o£sockë
(
ªsﬁvî
->
_sockë
);

1386 
ªsﬁvî
->
_sockë
 = 0;

1388 
	}
}

1390 
boﬁ


1391 
	$ldns_ax‰_com∂ëe
(c⁄° 
ldns_ªsﬁvî
 *
ªs
)

1394  
ªs
->
_ax‰_sﬂ_cou¡
 == 2;

1395 
	}
}

1397 
ldns_pkt
 *

1398 
	$ldns_ax‰_œ°_pkt
(c⁄° 
ldns_ªsﬁvî
 *
ªs
)

1400  
ªs
->
_cur_ax‰_pkt
;

1401 
	}
}

1405 
	$ldns_ªsﬁvî_«me£rvîs_øndomize
(
ldns_ªsﬁvî
 *
r
)

1407 
uöt16_t
 
i
, 
j
;

1408 
ldns_rdf
 **
ns
, *
tm≤s
;

1409 
size_t
 *
πt
, 
tm¥â
;

1412 
	`as£π
(
r
 !
NULL
);

1414 
ns
 = 
	`ldns_ªsﬁvî_«me£rvîs
(
r
);

1415 
πt
 = 
	`ldns_ªsﬁvî_πt
(
r
);

1416 
i
 = 0; i < 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
); i++) {

1417 
j
 = 
	`ldns_gë_øndom
(Ë% 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
);

1418 
tm≤s
 = 
ns
[
i
];

1419 
ns
[
i
] =Çs[
j
];

1420 
ns
[
j
] = 
tm≤s
;

1421 
tm¥â
 = 
πt
[
i
];

1422 
πt
[
i
] =Ñâ[
j
];

1423 
πt
[
j
] = 
tm¥â
;

1425 
	`ldns_ªsﬁvî_£t_«me£rvîs
(
r
, 
ns
);

1426 
	}
}

	@rr.c

10 
	~<ldns/c⁄fig.h
>

12 
	~<ldns/ldns.h
>

14 
	~<°rögs.h
>

15 
	~<limôs.h
>

17 
	~<î∫o.h
>

19 
	#LDNS_SYNTAX_DATALEN
 16

	)

20 
	#LDNS_TTL_DATALEN
 21

	)

21 
	#LDNS_RRLIST_INIT
 8

	)

23 
ldns_º
 *

24 
	$ldns_º_√w
()

26 
ldns_º
 *
º
;

27 
º
 = 
	`LDNS_MALLOC
(
ldns_º
);

28 i‡(!
º
) {

29  
NULL
;

32 
	`ldns_º_£t_ow√r
(
º
, 
NULL
);

33 
	`ldns_º_£t_que°i⁄
(
º
, 
Ál£
);

34 
	`ldns_º_£t_rd_cou¡
(
º
, 0);

35 
º
->
_rd©a_fõlds
 = 
NULL
;

36 
	`ldns_º_£t_˛ass
(
º
, 
LDNS_RR_CLASS_IN
);

37 
	`ldns_º_£t_âl
(
º
, 
LDNS_DEFAULT_TTL
);

38  
º
;

39 
	}
}

41 
ldns_º
 *

42 
	$ldns_º_√w_‰m_ty≥
(
ldns_º_ty≥
 
t
)

44 
ldns_º
 *
º
;

45 c⁄° 
ldns_º_des¸ùt‹
 *
desc
;

46 
size_t
 
i
;

48 
º
 = 
	`LDNS_MALLOC
(
ldns_º
);

49 i‡(!
º
) {

50  
NULL
;

53 
desc
 = 
	`ldns_º_des¸ùt
(
t
);

55 
º
->
_rd©a_fõlds
 = 
	`LDNS_XMALLOC
(
ldns_rdf
 *, 
	`ldns_º_des¸ùt‹_möimum
(
desc
));

56 if(!
º
->
_rd©a_fõlds
) {

57 
	`LDNS_FREE
(
º
);

58  
NULL
;

60 
i
 = 0; i < 
	`ldns_º_des¸ùt‹_möimum
(
desc
); i++) {

61 
º
->
_rd©a_fõlds
[
i
] = 
NULL
;

64 
	`ldns_º_£t_ow√r
(
º
, 
NULL
);

65 
	`ldns_º_£t_que°i⁄
(
º
, 
Ál£
);

67 
	`ldns_º_£t_rd_cou¡
(
º
, 
	`ldns_º_des¸ùt‹_möimum
(
desc
));

68 
	`ldns_º_£t_˛ass
(
º
, 
LDNS_RR_CLASS_IN
);

69 
	`ldns_º_£t_âl
(
º
, 
LDNS_DEFAULT_TTL
);

70 
	`ldns_º_£t_ty≥
(
º
, 
t
);

71  
º
;

72 
	}
}

75 
	$ldns_º_‰ì
(
ldns_º
 *
º
)

77 
size_t
 
i
;

78 i‡(
º
) {

79 i‡(
	`ldns_º_ow√r
(
º
)) {

80 
	`ldns_rdf_dìp_‰ì
(
	`ldns_º_ow√r
(
º
));

82 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

83 
	`ldns_rdf_dìp_‰ì
(
	`ldns_º_rdf
(
º
, 
i
));

85 
	`LDNS_FREE
(
º
->
_rd©a_fõlds
);

86 
	`LDNS_FREE
(
º
);

88 
	}
}

91 
INLINE
 
boﬁ


92 
	$ldns_rdf_ty≥_maybe_quŸed
(
ldns_rdf_ty≥
 
rdf_ty≥
)

94  
rdf_ty≥
 =
LDNS_RDF_TYPE_STR
 ||

95 
rdf_ty≥
 =
LDNS_RDF_TYPE_LONG_STR
;

96 
	}
}

112 
ldns_°©us


113 
	$ldns_º_√w_‰m_°r_öã∫Æ
(
ldns_º
 **
√wº
, c⁄° *
°r
,

114 
uöt32_t
 
deÁu…_âl
, 
ldns_rdf
 *
‹igö
,

115 
ldns_rdf
 **
¥ev
, 
boﬁ
 
que°i⁄
)

117 
ldns_º
 *
√w
;

118 c⁄° 
ldns_º_des¸ùt‹
 *
desc
;

119 
ldns_º_ty≥
 
º_ty≥
;

120 
ldns_buf„r
 *
º_buf
 = 
NULL
;

121 
ldns_buf„r
 *
rd_buf
 = 
NULL
;

122 
uöt32_t
 
âl_vÆ
;

123 *
ow√r
 = 
NULL
;

124 *
âl
 = 
NULL
;

125 
ldns_º_˛ass
 
˛as_vÆ
;

126 *
˛as
 = 
NULL
;

127 *
ty≥
 = 
NULL
;

128 *
rd©a
 = 
NULL
;

129 *
rd
 = 
NULL
;

130 *
xtok
 = 
NULL
;

131 
size_t
 
rd_°æí
;

132 c⁄° *
dñimôîs
;

133 
ssize_t
 
c
;

134 
ldns_rdf
 *
ow√r_d«me
;

135 c⁄° * 
íd±r
;

136 
was_unknown_º_f‹m©
 = 0;

137 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

140 
boﬁ
 
d⁄e
;

141 
boﬁ
 
quŸed
;

143 
ldns_rdf
 *
r
 = 
NULL
;

144 
uöt16_t
 
r_˙t
;

145 
uöt16_t
 
r_mö
;

146 
uöt16_t
 
r_max
;

147 
size_t
 
¥e_d©a_pos
;

149 
uöt16_t
 
hex_d©a_size
;

150 *
hex_d©a_°r
 = 
NULL
;

151 
uöt16_t
 
cur_hex_d©a_size
;

152 
size_t
 
hex_pos
 = 0;

153 
uöt8_t
 *
hex_d©a
 = 
NULL
;

155 
√w
 = 
	`ldns_º_√w
();

157 
ow√r
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_DOMAINLEN
 + 1);

158 
âl
 = 
	`LDNS_XMALLOC
(, 
LDNS_TTL_DATALEN
);

159 
˛as
 = 
	`LDNS_XMALLOC
(, 
LDNS_SYNTAX_DATALEN
);

160 
rd©a
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_PACKETLEN
 + 1);

161 
º_buf
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

162 
rd_buf
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

163 
rd
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_RDFLEN
);

164 
xtok
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_RDFLEN
);

165 i‡(
º_buf
) {

166 
º_buf
->
_d©a
 = 
NULL
;

168 i‡(
rd_buf
) {

169 
rd_buf
->
_d©a
 = 
NULL
;

171 i‡(!
√w
 || !
ow√r
 || !
âl
 || !
˛as
 || !
rd©a
 ||

172 !
º_buf
 || !
rd_buf
 || !
rd
 || !
xtok
) {

174 
memîr‹
;

177 
	`ldns_buf„r_√w_‰m_d©a
(
º_buf
, (*)
°r
, 
	`°æí
(str));

180 i‡(
	`ldns_bgë_tokí
(
º_buf
, 
ow√r
, "\t\¿", 
LDNS_MAX_DOMAINLEN
) == -1){

182 
°©us
 = 
LDNS_STATUS_SYNTAX_ERR
;

183 
îr‹
;

186 i‡(
	`ldns_bgë_tokí
(
º_buf
, 
âl
, "\t\¿", 
LDNS_TTL_DATALEN
) == -1) {

188 
°©us
 = 
LDNS_STATUS_SYNTAX_TTL_ERR
;

189 
îr‹
;

191 
âl_vÆ
 = (
uöt32_t
Ë
	`ldns_°r2≥riod
(
âl
, &
íd±r
);

193 i‡(
	`°æí
(
âl
Ë> 0 && !
	`isdigô
(()Åtl[0])) {

195 i‡(
deÁu…_âl
 == 0) {

196 
âl_vÆ
 = 
LDNS_DEFAULT_TTL
;

198 
âl_vÆ
 = 
deÁu…_âl
;

205 
˛as_vÆ
 = 
	`ldns_gë_º_˛ass_by_«me
(
âl
);

209 i‡(
˛as_vÆ
 == 0) {

210 
˛as_vÆ
 = 
LDNS_RR_CLASS_IN
;

211 
ty≥
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
âl
) + 1);

212 i‡(!
ty≥
) {

213 
memîr‹
;

215 
	`°∫˝y
(
ty≥
, 
âl
, 
	`°æí
(ttl) + 1);

218 i‡(-1 =
	`ldns_bgë_tokí
(

219 
º_buf
, 
˛as
, "\t\¿", 
LDNS_SYNTAX_DATALEN
)) {

221 
°©us
 = 
LDNS_STATUS_SYNTAX_CLASS_ERR
;

222 
îr‹
;

224 
˛as_vÆ
 = 
	`ldns_gë_º_˛ass_by_«me
(
˛as
);

228 i‡(
˛as_vÆ
 == 0) {

229 
˛as_vÆ
 = 
LDNS_RR_CLASS_IN
;

230 
ty≥
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
˛as
) + 1);

231 i‡(!
ty≥
) {

232 
memîr‹
;

234 
	`°∫˝y
(
ty≥
, 
˛as
, 
	`°æí
(clas) + 1);

239 i‡(!
ty≥
) {

240 
ty≥
 = 
	`LDNS_XMALLOC
(, 
LDNS_SYNTAX_DATALEN
);

241 i‡(!
ty≥
) {

242 
memîr‹
;

244 i‡(-1 =
	`ldns_bgë_tokí
(

245 
º_buf
, 
ty≥
, "\t\¿", 
LDNS_SYNTAX_DATALEN
)) {

247 
°©us
 = 
LDNS_STATUS_SYNTAX_TYPE_ERR
;

248 
îr‹
;

252 i‡(
	`ldns_bgë_tokí
(
º_buf
, 
rd©a
, "\0", 
LDNS_MAX_PACKETLEN
) == -1) {

257 
	`ldns_buf„r_√w_‰m_d©a
(
rd_buf
, 
rd©a
, 
	`°æí
(rdata));

259 i‡(
	`°æí
(
ow√r
Ë<1 && 
	`°∫cmp
(owner, "@", 1) == 0) {

260 i‡(
‹igö
) {

261 
	`ldns_º_£t_ow√r
(
√w
, 
	`ldns_rdf_˛⁄e
(
‹igö
));

262 } i‡(
¥ev
 && *prev) {

263 
	`ldns_º_£t_ow√r
(
√w
, 
	`ldns_rdf_˛⁄e
(*
¥ev
));

266 
	`ldns_º_£t_ow√r
(
√w
, 
	`ldns_d«me_√w_‰m_°r
("."));

270 i‡(
¥ev
) {

271 
	`ldns_rdf_dìp_‰ì
(*
¥ev
);

272 *
¥ev
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_ow√r
(
√w
));

273 i‡(!*
¥ev
) {

274 
memîr‹
;

278 i‡(
	`°æí
(
ow√r
) == 0) {

281 i‡(
¥ev
 && *prev) {

282 
	`ldns_º_£t_ow√r
(
√w
, 
	`ldns_rdf_˛⁄e
(*
¥ev
));

283 } i‡(
‹igö
) {

284 
	`ldns_º_£t_ow√r
(
√w
, 
	`ldns_rdf_˛⁄e
(
‹igö
));

286 
	`ldns_º_£t_ow√r
(
√w
,

287 
	`ldns_d«me_√w_‰m_°r
("."));

289 if(!
	`ldns_º_ow√r
(
√w
)) {

290 
memîr‹
;

293 
ow√r_d«me
 = 
	`ldns_d«me_√w_‰m_°r
(
ow√r
);

294 i‡(!
ow√r_d«me
) {

295 
°©us
 = 
LDNS_STATUS_SYNTAX_ERR
;

296 
îr‹
;

299 
	`ldns_º_£t_ow√r
(
√w
, 
ow√r_d«me
);

300 i‡(!
	`ldns_d«me_°r_absﬁuã
(
ow√r
Ë&& 
‹igö
) {

301 if(
	`ldns_d«me_ˇt
(
	`ldns_º_ow√r
(
√w
), 
‹igö
)

302 !
LDNS_STATUS_OK
) {

304 
°©us
 = 
LDNS_STATUS_SYNTAX_ERR
;

305 
îr‹
;

308 i‡(
¥ev
) {

309 
	`ldns_rdf_dìp_‰ì
(*
¥ev
);

310 *
¥ev
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_ow√r
(
√w
));

311 i‡(!*
¥ev
) {

312 
îr‹
;

317 
	`LDNS_FREE
(
ow√r
);

319 
	`ldns_º_£t_que°i⁄
(
√w
, 
que°i⁄
);

321 
	`ldns_º_£t_âl
(
√w
, 
âl_vÆ
);

322 
	`LDNS_FREE
(
âl
);

324 
	`ldns_º_£t_˛ass
(
√w
, 
˛as_vÆ
);

325 
	`LDNS_FREE
(
˛as
);

327 
º_ty≥
 = 
	`ldns_gë_º_ty≥_by_«me
(
ty≥
);

328 
	`LDNS_FREE
(
ty≥
);

330 
desc
 = 
	`ldns_º_des¸ùt
((
uöt16_t
)
º_ty≥
);

331 
	`ldns_º_£t_ty≥
(
√w
, 
º_ty≥
);

332 i‡(
desc
) {

334 
r_max
 = 
	`ldns_º_des¸ùt‹_maximum
(
desc
);

335 
r_mö
 = 
	`ldns_º_des¸ùt‹_möimum
(
desc
);

337 
r_mö
 = 0;

338 
r_max
 = 1;

341 
d⁄e
 = 
Ál£
, 
r_˙t
 = 0; !d⁄ê&&Ñ_˙à< 
r_max
;Ñ_cnt++) {

342 
quŸed
 = 
Ál£
;

344 
	`ldns_º_des¸ùt‹_fõld_ty≥
(
desc
, 
r_˙t
)) {

345 
LDNS_RDF_TYPE_B64
 :

346 
LDNS_RDF_TYPE_HEX
 :

347 
LDNS_RDF_TYPE_LOC
 :

348 
LDNS_RDF_TYPE_WKS
 :

349 
LDNS_RDF_TYPE_IPSECKEY
 :

350 
LDNS_RDF_TYPE_NSEC
 : i‡(
r_˙t
 =
r_max
 - 1) {

351 
dñimôîs
 = "\n\t";

354  : 
dñimôîs
 = "\n\t ";

357 i‡(
	`ldns_rdf_ty≥_maybe_quŸed
(

358 
	`ldns_º_des¸ùt‹_fõld_ty≥
(

359 
desc
, 
r_˙t
)) &&

360 
	`ldns_buf„r_ªmaöög
(
rd_buf
) > 0){

363 *(
	`ldns_buf„r_cuºít
(
rd_buf
)) == ' ') {

364 
	`ldns_buf„r_skù
(
rd_buf
, 1);

367 i‡(*(
	`ldns_buf„r_cuºít
(
rd_buf
)) == '\"') {

368 
dñimôîs
 = "\"\0";

369 
	`ldns_buf„r_skù
(
rd_buf
, 1);

370 
quŸed
 = 
åue
;

379 
	`ldns_buf„r_posôi⁄
(
rd_buf
Ë< 
	`ldns_buf„r_limô
(rd_buf)

380 && *(
	`ldns_buf„r_cuºít
(
rd_buf
)) == ' '

381 && !
quŸed
) {

383 
	`ldns_buf„r_skù
(
rd_buf
, 1);

386 
¥e_d©a_pos
 = 
	`ldns_buf„r_posôi⁄
(
rd_buf
);

387 i‡(-1 =(
c
 = 
	`ldns_bgë_tokí
(

388 
rd_buf
, 
rd
, 
dñimôîs
, 
LDNS_MAX_RDFLEN
))) {

390 
d⁄e
 = 
åue
;

397 
rd_°æí
 = 
	`°æí
(
rd
);

400 i‡(
	`°∫cmp
(
rd
, "\\#", 2Ë=0 && !
quŸed
 &&

401 (
rd_°æí
 =2 || 
rd
[2]==' ')) {

403 
was_unknown_º_f‹m©
 = 1;

407 
	`ldns_buf„r_£t_posôi⁄
(
rd_buf
, 
¥e_d©a_pos
);

408 
dñimôîs
 = "\n\t ";

409 ()
	`ldns_bgë_tokí
(
rd_buf
, 
rd
,

410 
dñimôîs
, 
LDNS_MAX_RDFLEN
);

412 
c
 = 
	`ldns_bgë_tokí
(
rd_buf
, 
rd
,

413 
dñimôîs
, 
LDNS_MAX_RDFLEN
);

414 i‡(
c
 == -1) {

416 
°©us
 = 
LDNS_STATUS_SYNTAX_RDATA_ERR
;

417 
îr‹
;

419 
hex_d©a_size
 = (
uöt16_t
Ë
	`©oi
(
rd
);

421 
hex_d©a_°r
 = 
	`LDNS_XMALLOC
(, 2*
hex_d©a_size
 + 1);

422 i‡(!
hex_d©a_°r
) {

424 
memîr‹
;

426 
cur_hex_d©a_size
 = 0;

427 
cur_hex_d©a_size
 < 2 * 
hex_d©a_size
) {

428 
c
 = 
	`ldns_bgë_tokí
(
rd_buf
, 
rd
,

429 
dñimôîs
, 
LDNS_MAX_RDFLEN
);

430 i‡(
c
 != -1) {

431 
rd_°æí
 = 
	`°æí
(
rd
);

433 i‡(
c
 == -1 ||

434 (
size_t
)
cur_hex_d©a_size
 + 
rd_°æí
 >

435 2 * (
size_t
)
hex_d©a_size
) {

437 
°©us
 = 
LDNS_STATUS_SYNTAX_RDATA_ERR
;

438 
îr‹
;

440 
	`°∫˝y
(
hex_d©a_°r
 + 
cur_hex_d©a_size
, 
rd
,

441 
rd_°æí
);

443 
cur_hex_d©a_size
 +
rd_°æí
;

445 
hex_d©a_°r
[
cur_hex_d©a_size
] = '\0';

449 i‡(
desc
) {

450 
hex_pos
 = 0;

451 
hex_d©a
 =

452 
	`LDNS_XMALLOC
(
uöt8_t
, 
hex_d©a_size
+2);

454 i‡(!
hex_d©a
) {

455 
memîr‹
;

457 
	`ldns_wrôe_uöt16
(
hex_d©a
, 
hex_d©a_size
);

458 
	`ldns_hex°rög_to_d©a
(

459 
hex_d©a
 + 2, 
hex_d©a_°r
);

460 
°©us
 = 
	`ldns_wúe2rdf
(
√w
, 
hex_d©a
,

461 
hex_d©a_size
 + 2, &
hex_pos
);

462 i‡(
°©us
 !
LDNS_STATUS_OK
) {

463 
îr‹
;

465 
	`LDNS_FREE
(
hex_d©a
);

467 
r
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_HEX
,

468 
hex_d©a_°r
);

469 i‡(!
r
) {

470 
memîr‹
;

472 
	`ldns_rdf_£t_ty≥
(
r
, 
LDNS_RDF_TYPE_UNKNOWN
);

473 i‡(!
	`ldns_º_push_rdf
(
√w
, 
r
)) {

474 
memîr‹
;

477 
	`LDNS_FREE
(
hex_d©a_°r
);

481 
	`ldns_º_des¸ùt‹_fõld_ty≥
(
desc
, 
r_˙t
)) {

483 
LDNS_RDF_TYPE_HEX
:

484 
LDNS_RDF_TYPE_B64
:

489 i‡(
r_˙t
 =
r_max
 - 1) {

490 
c
 = 
	`ldns_bgë_tokí
(
rd_buf
, 
xtok
,

491 "\n", 
LDNS_MAX_RDFLEN
);

492 i‡(
c
 != -1) {

493 (Ë
	`°∫ˇt
(
rd
, 
xtok
,

494 
LDNS_MAX_RDFLEN
 -

495 
	`°æí
(
rd
) - 1);

498 
r
 = 
	`ldns_rdf_√w_‰m_°r
(

499 
	`ldns_º_des¸ùt‹_fõld_ty≥
(

500 
desc
, 
r_˙t
), 
rd
);

503 
LDNS_RDF_TYPE_HIP
:

515 i‡(
	`ldns_bgë_tokí
(
rd_buf
,

516 
xtok
, 
dñimôîs
,

517 
LDNS_MAX_RDFLEN
) == -1)

520 (Ë
	`°∫ˇt
(
rd
, " ",

521 
LDNS_MAX_RDFLEN
 -

522 
	`°æí
(
rd
) - 1);

523 (Ë
	`°∫ˇt
(
rd
, 
xtok
,

524 
LDNS_MAX_RDFLEN
 -

525 
	`°æí
(
rd
) - 1);

528 i‡(
	`ldns_bgë_tokí
(
rd_buf
,

529 
xtok
, 
dñimôîs
,

530 
LDNS_MAX_RDFLEN
) == -1)

533 (Ë
	`°∫ˇt
(
rd
, " ",

534 
LDNS_MAX_RDFLEN
 -

535 
	`°æí
(
rd
) - 1);

536 (Ë
	`°∫ˇt
(
rd
, 
xtok
,

537 
LDNS_MAX_RDFLEN
 -

538 
	`°æí
(
rd
) - 1);

539 } 
Ál£
);

541 
r
 = 
	`ldns_rdf_√w_‰m_°r
(

542 
	`ldns_º_des¸ùt‹_fõld_ty≥
(

543 
desc
, 
r_˙t
), 
rd
);

546 
LDNS_RDF_TYPE_DNAME
:

547 
r
 = 
	`ldns_rdf_√w_‰m_°r
(

548 
	`ldns_º_des¸ùt‹_fõld_ty≥
(

549 
desc
, 
r_˙t
), 
rd
);

554 i‡(
r
 && 
	`ldns_rdf_size
(r) > 1 &&

555 
	`ldns_rdf_d©a
(
r
)[0] == 1 &&

556 
	`ldns_rdf_d©a
(
r
)[1] == '@') {

558 
	`ldns_rdf_dìp_‰ì
(
r
);

560 
r
 = 
‹igö
 ? 
	`ldns_rdf_˛⁄e
(origin)

562 : ( 
º_ty≥
 =
LDNS_RR_TYPE_SOA
 ?

564 
	`ldns_rdf_˛⁄e
(

565 
	`ldns_º_ow√r
(
√w
))

567 : 
	`ldns_rdf_√w_‰m_°r
(

568 
LDNS_RDF_TYPE_DNAME
, ".")

571 } i‡(
r
 && 
rd_°æí
 >1 && 
‹igö
 &&

572 !
	`ldns_d«me_°r_absﬁuã
(
rd
)) {

574 
°©us
 = 
	`ldns_d«me_ˇt
(
r
, 
‹igö
);

575 i‡(
°©us
 !
LDNS_STATUS_OK
) {

576 
îr‹
;

581 
r
 = 
	`ldns_rdf_√w_‰m_°r
(

582 
	`ldns_º_des¸ùt‹_fõld_ty≥
(

583 
desc
, 
r_˙t
), 
rd
);

586 i‡(!
r
) {

587 
°©us
 = 
LDNS_STATUS_SYNTAX_RDATA_ERR
;

588 
îr‹
;

590 
	`ldns_º_push_rdf
(
√w
, 
r
);

592 i‡(
quŸed
) {

593 i‡(
	`ldns_buf„r_avaûabÀ
(
rd_buf
, 1)) {

594 
	`ldns_buf„r_skù
(
rd_buf
, 1);

596 
d⁄e
 = 
åue
;

601 
	`LDNS_FREE
(
rd
);

602 
	`LDNS_FREE
(
xtok
);

603 
	`ldns_buf„r_‰ì
(
rd_buf
);

604 
	`ldns_buf„r_‰ì
(
º_buf
);

605 
	`LDNS_FREE
(
rd©a
);

607 i‡(!
que°i⁄
 && 
desc
 && !
was_unknown_º_f‹m©
 &&

608 
	`ldns_º_rd_cou¡
(
√w
Ë< 
r_mö
) {

610 
	`ldns_º_‰ì
(
√w
);

611  
LDNS_STATUS_SYNTAX_MISSING_VALUE_ERR
;

614 i‡(
√wº
) {

615 *
√wº
 = 
√w
;

618 
	`ldns_º_‰ì
(
√w
);

620  
LDNS_STATUS_OK
;

622 
memîr‹
:

623 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

624 
îr‹
:

625 i‡(
rd_buf
 &&Ñd_buf->
_d©a
) {

626 
	`ldns_buf„r_‰ì
(
rd_buf
);

628 
	`LDNS_FREE
(
rd_buf
);

630 i‡(
º_buf
 &&Ñr_buf->
_d©a
) {

631 
	`ldns_buf„r_‰ì
(
º_buf
);

633 
	`LDNS_FREE
(
º_buf
);

635 
	`LDNS_FREE
(
ty≥
);

636 
	`LDNS_FREE
(
ow√r
);

637 
	`LDNS_FREE
(
âl
);

638 
	`LDNS_FREE
(
˛as
);

639 
	`LDNS_FREE
(
hex_d©a
);

640 
	`LDNS_FREE
(
hex_d©a_°r
);

641 
	`LDNS_FREE
(
xtok
);

642 
	`LDNS_FREE
(
rd
);

643 
	`LDNS_FREE
(
rd©a
);

644 
	`ldns_º_‰ì
(
√w
);

645  
°©us
;

646 
	}
}

648 
ldns_°©us


649 
	$ldns_º_√w_‰m_°r
(
ldns_º
 **
√wº
, c⁄° *
°r
,

650 
uöt32_t
 
deÁu…_âl
, 
ldns_rdf
 *
‹igö
,

651 
ldns_rdf
 **
¥ev
)

653  
	`ldns_º_√w_‰m_°r_öã∫Æ
(
√wº
,

654 
°r
,

655 
deÁu…_âl
,

656 
‹igö
,

657 
¥ev
,

658 
Ál£
);

659 
	}
}

661 
ldns_°©us


662 
	$ldns_º_√w_que°i⁄_‰m_°r
(
ldns_º
 **
√wº
, c⁄° *
°r
,

663 
ldns_rdf
 *
‹igö
,Üdns_rd‡**
¥ev
)

665  
	`ldns_º_√w_‰m_°r_öã∫Æ
(
√wº
,

666 
°r
,

668 
‹igö
,

669 
¥ev
,

670 
åue
);

671 
	}
}

673 
ldns_°©us


674 
	$ldns_º_√w_‰m_Â
(
ldns_º
 **
√wº
, 
FILE
 *
Â
, 
uöt32_t
 *
âl
, 
ldns_rdf
 **
‹igö
,Üdns_rd‡**
¥ev
)

676  
	`ldns_º_√w_‰m_Â_l
(
√wº
, 
Â
, 
âl
, 
‹igö
, 
¥ev
, 
NULL
);

677 
	}
}

679 
ldns_°©us


680 
	$ldns_º_√w_‰m_Â_l
(
ldns_º
 **
√wº
, 
FILE
 *
Â
, 
uöt32_t
 *
deÁu…_âl
, 
ldns_rdf
 **
‹igö
,Üdns_rd‡**
¥ev
, *
löe_ƒ
)

682 *
löe
;

683 c⁄° *
íd±r
;

684 
ldns_º
 *
º
;

685 
uöt32_t
 
âl
;

686 
ldns_rdf
 *
tmp
;

687 
ldns_°©us
 
s
;

688 
ssize_t
 
size
;

689 
off£t
 = 0;

691 i‡(
deÁu…_âl
) {

692 
âl
 = *
deÁu…_âl
;

694 
âl
 = 0;

697 
löe
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_LINELEN
 + 1);

698 i‡(!
löe
) {

699  
LDNS_STATUS_MEM_ERR
;

703 i‡((
size
 = 
	`ldns_fgë_tokí_l
(
Â
, 
löe
, 
LDNS_PARSE_SKIP_SPACE
, 
LDNS_MAX_LINELEN
, 
löe_ƒ
)) == -1) {

704 
	`LDNS_FREE
(
löe
);

709  
LDNS_STATUS_SYNTAX_ERR
;

715 i‡(
size
 == 0) {

716 
	`LDNS_FREE
(
löe
);

717  
LDNS_STATUS_SYNTAX_EMPTY
;

720 i‡(
	`°∫cmp
(
löe
, "$ORIGIN", 7Ë=0 && 
	`is•a˚
(line[7])) {

721 i‡(*
‹igö
) {

722 
	`ldns_rdf_dìp_‰ì
(*
‹igö
);

723 *
‹igö
 = 
NULL
;

725 
off£t
 = 8;

726 
	`is•a˚
(
löe
[
off£t
])) {

727 
off£t
++;

729 
tmp
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
löe
 + 
off£t
);

730 i‡(!
tmp
) {

732 
	`LDNS_FREE
(
löe
);

733  
LDNS_STATUS_SYNTAX_DNAME_ERR
;

735 *
‹igö
 = 
tmp
;

736 
s
 = 
LDNS_STATUS_SYNTAX_ORIGIN
;

737 } i‡(
	`°∫cmp
(
löe
, "$TTL", 4Ë=0 && 
	`is•a˚
(line[4])) {

738 
off£t
 = 5;

739 
	`is•a˚
(
löe
[
off£t
])) {

740 
off£t
++;

742 i‡(
deÁu…_âl
) {

743 *
deÁu…_âl
 = 
	`ldns_°r2≥riod
(
löe
 + 
off£t
, &
íd±r
);

745 
s
 = 
LDNS_STATUS_SYNTAX_TTL
;

746 } i‡(
	`°∫cmp
(
löe
, "$INCLUDE", 8) == 0) {

747 
s
 = 
LDNS_STATUS_SYNTAX_INCLUDE
;

749 i‡(
‹igö
 && *origin) {

750 
s
 = 
	`ldns_º_√w_‰m_°r
(&
º
, (c⁄° *Ë
löe
, 
âl
, *
‹igö
, 
¥ev
);

752 
s
 = 
	`ldns_º_√w_‰m_°r
(&
º
, (c⁄° *Ë
löe
, 
âl
, 
NULL
, 
¥ev
);

755 
	`LDNS_FREE
(
löe
);

756 i‡(
s
 =
LDNS_STATUS_OK
) {

757 i‡(
√wº
) {

758 *
√wº
 = 
º
;

761 
	`ldns_º_‰ì
(
º
);

764  
s
;

765 
	}
}

768 
	$ldns_º_£t_ow√r
(
ldns_º
 *
º
, 
ldns_rdf
 *
ow√r
)

770 
º
->
_ow√r
 = 
ow√r
;

771 
	}
}

774 
	$ldns_º_£t_que°i⁄
(
ldns_º
 *
º
, 
boﬁ
 
que°i⁄
)

776 
º
->
_º_que°i⁄
 = 
que°i⁄
;

777 
	}
}

780 
	$ldns_º_£t_âl
(
ldns_º
 *
º
, 
uöt32_t
 
âl
)

782 
º
->
_âl
 = 
âl
;

783 
	}
}

786 
	$ldns_º_£t_rd_cou¡
(
ldns_º
 *
º
, 
size_t
 
cou¡
)

788 
º
->
_rd_cou¡
 = 
cou¡
;

789 
	}
}

792 
	$ldns_º_£t_ty≥
(
ldns_º
 *
º
, 
ldns_º_ty≥
 
º_ty≥
)

794 
º
->
_º_ty≥
 = 
º_ty≥
;

795 
	}
}

798 
	$ldns_º_£t_˛ass
(
ldns_º
 *
º
, 
ldns_º_˛ass
 
º_˛ass
)

800 
º
->
_º_˛ass
 = 
º_˛ass
;

801 
	}
}

803 
ldns_rdf
 *

804 
	$ldns_º_£t_rdf
(
ldns_º
 *
º
, c⁄° 
ldns_rdf
 *
f
, 
size_t
 
posôi⁄
)

806 
size_t
 
rd_cou¡
;

807 
ldns_rdf
 *
p›
;

809 
rd_cou¡
 = 
	`ldns_º_rd_cou¡
(
º
);

810 i‡(
posôi⁄
 < 
rd_cou¡
) {

812 
p›
 = 
º
->
_rd©a_fõlds
[
posôi⁄
];

813 
º
->
_rd©a_fõlds
[
posôi⁄
] = (
ldns_rdf
*)
f
;

814  
p›
;

816  
NULL
;

818 
	}
}

820 
boﬁ


821 
	$ldns_º_push_rdf
(
ldns_º
 *
º
, c⁄° 
ldns_rdf
 *
f
)

823 
size_t
 
rd_cou¡
;

824 
ldns_rdf
 **
rd©a_fõlds
;

826 
rd_cou¡
 = 
	`ldns_º_rd_cou¡
(
º
);

829 
rd©a_fõlds
 = 
	`LDNS_XREALLOC
(

830 
º
->
_rd©a_fõlds
, 
ldns_rdf
 *, 
rd_cou¡
 + 1);

831 i‡(!
rd©a_fõlds
) {

832  
Ál£
;

836 
º
->
_rd©a_fõlds
 = 
rd©a_fõlds
;

837 
º
->
_rd©a_fõlds
[
rd_cou¡
] = (
ldns_rdf
*)
f
;

839 
	`ldns_º_£t_rd_cou¡
(
º
, 
rd_cou¡
 + 1);

840  
åue
;

841 
	}
}

843 
ldns_rdf
 *

844 
	$ldns_º_p›_rdf
(
ldns_º
 *
º
)

846 
size_t
 
rd_cou¡
;

847 
ldns_rdf
 *
p›
;

848 
ldns_rdf
** 
√wrd
;

850 
rd_cou¡
 = 
	`ldns_º_rd_cou¡
(
º
);

852 i‡(
rd_cou¡
 == 0) {

853  
NULL
;

856 
p›
 = 
º
->
_rd©a_fõlds
[
rd_cou¡
 - 1];

859 if(
rd_cou¡
 > 1) {

860 
√wrd
 = 
	`LDNS_XREALLOC
(

861 
º
->
_rd©a_fõlds
, 
ldns_rdf
 *, 
rd_cou¡
 - 1);

862 if(
√wrd
)

863 
º
->
_rd©a_fõlds
 = 
√wrd
;

865 
	`LDNS_FREE
(
º
->
_rd©a_fõlds
);

868 
	`ldns_º_£t_rd_cou¡
(
º
, 
rd_cou¡
 - 1);

869  
p›
;

870 
	}
}

872 
ldns_rdf
 *

873 
	$ldns_º_rdf
(c⁄° 
ldns_º
 *
º
, 
size_t
 
ƒ
)

875 i‡(
º
 && 
ƒ
 < 
	`ldns_º_rd_cou¡
(rr)) {

876  
º
->
_rd©a_fõlds
[
ƒ
];

878  
NULL
;

880 
	}
}

882 
ldns_rdf
 *

883 
	$ldns_º_ow√r
(c⁄° 
ldns_º
 *
º
)

885  
º
->
_ow√r
;

886 
	}
}

888 
boﬁ


889 
	$ldns_º_is_que°i⁄
(c⁄° 
ldns_º
 *
º
)

891  
º
->
_º_que°i⁄
;

892 
	}
}

894 
uöt32_t


895 
	$ldns_º_âl
(c⁄° 
ldns_º
 *
º
)

897  
º
->
_âl
;

898 
	}
}

900 
size_t


901 
	$ldns_º_rd_cou¡
(c⁄° 
ldns_º
 *
º
)

903  
º
->
_rd_cou¡
;

904 
	}
}

906 
ldns_º_ty≥


907 
	$ldns_º_gë_ty≥
(c⁄° 
ldns_º
 *
º
)

909  
º
->
_º_ty≥
;

910 
	}
}

912 
ldns_º_˛ass


913 
	$ldns_º_gë_˛ass
(c⁄° 
ldns_º
 *
º
)

915  
º
->
_º_˛ass
;

916 
	}
}

920 
size_t


921 
	$ldns_º_li°_º_cou¡
(c⁄° 
ldns_º_li°
 *
º_li°
)

923 i‡(
º_li°
) {

924  
º_li°
->
_º_cou¡
;

928 
	}
}

930 
ldns_º
 *

931 
	$ldns_º_li°_£t_º
(
ldns_º_li°
 *
º_li°
, c⁄° 
ldns_º
 *
r
, 
size_t
 
cou¡
)

933 
ldns_º
 *
ﬁd
;

935 i‡(
cou¡
 > 
	`ldns_º_li°_º_cou¡
(
º_li°
)) {

936  
NULL
;

939 
ﬁd
 = 
	`ldns_º_li°_º
(
º_li°
, 
cou¡
);

942 
º_li°
->
_ºs
[
cou¡
] = (
ldns_º
*)
r
;

943  
ﬁd
;

944 
	}
}

947 
	$ldns_º_li°_£t_º_cou¡
(
ldns_º_li°
 *
º_li°
, 
size_t
 
cou¡
)

949 
	`as£π
(
cou¡
 <
º_li°
->
_º_ˇ∑côy
);

950 
º_li°
->
_º_cou¡
 = 
cou¡
;

951 
	}
}

953 
ldns_º
 *

954 
	$ldns_º_li°_º
(c⁄° 
ldns_º_li°
 *
º_li°
, 
size_t
 
ƒ
)

956 i‡(
ƒ
 < 
	`ldns_º_li°_º_cou¡
(
º_li°
)) {

957  
º_li°
->
_ºs
[
ƒ
];

959  
NULL
;

961 
	}
}

963 
ldns_º_li°
 *

964 
	$ldns_º_li°_√w
()

966 
ldns_º_li°
 *
º_li°
 = 
	`LDNS_MALLOC
(ldns_rr_list);

967 if(!
º_li°
Ë 
NULL
;

968 
º_li°
->
_º_cou¡
 = 0;

969 
º_li°
->
_º_ˇ∑côy
 = 0;

970 
º_li°
->
_ºs
 = 
NULL
;

971  
º_li°
;

972 
	}
}

975 
	$ldns_º_li°_‰ì
(
ldns_º_li°
 *
º_li°
)

977 i‡(
º_li°
) {

978 
	`LDNS_FREE
(
º_li°
->
_ºs
);

979 
	`LDNS_FREE
(
º_li°
);

981 
	}
}

984 
	$ldns_º_li°_dìp_‰ì
(
ldns_º_li°
 *
º_li°
)

986 
size_t
 
i
;

988 i‡(
º_li°
) {

989 
i
=0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

990 
	`ldns_º_‰ì
(
	`ldns_º_li°_º
(
º_li°
, 
i
));

992 
	`LDNS_FREE
(
º_li°
->
_ºs
);

993 
	`LDNS_FREE
(
º_li°
);

995 
	}
}

999 
boﬁ


1000 
	$ldns_º_li°_ˇt
(
ldns_º_li°
 *
À·
,Üdns_º_li° *
right
)

1002 
size_t
 
r_º_cou¡
;

1003 
size_t
 
i
;

1005 i‡(!
À·
) {

1006  
Ál£
;

1009 i‡(
right
) {

1010 
r_º_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
right
);

1012 
r_º_cou¡
 = 0;

1016 
i
 = 0; i < 
r_º_cou¡
; i++) {

1017 
	`ldns_º_li°_push_º
(
À·
, 
	`ldns_º_li°_º
(
right
, 
i
));

1019  
åue
;

1020 
	}
}

1022 
ldns_º_li°
 *

1023 
	$ldns_º_li°_ˇt_˛⁄e
(
ldns_º_li°
 *
À·
,Üdns_º_li° *
right
)

1025 
size_t
 
l_º_cou¡
;

1026 
size_t
 
r_º_cou¡
;

1027 
size_t
 
i
;

1028 
ldns_º_li°
 *
ˇt
;

1030 i‡(
À·
) {

1031 
l_º_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
À·
);

1033  
	`ldns_º_li°_˛⁄e
(
right
);

1036 i‡(
right
) {

1037 
r_º_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
right
);

1039 
r_º_cou¡
 = 0;

1042 
ˇt
 = 
	`ldns_º_li°_√w
();

1044 i‡(!
ˇt
) {

1045  
NULL
;

1049 
i
 = 0; i < 
l_º_cou¡
; i++) {

1050 
	`ldns_º_li°_push_º
(
ˇt
,

1051 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
À·
, 
i
)));

1054 
i
 = 0; i < 
r_º_cou¡
; i++) {

1055 
	`ldns_º_li°_push_º
(
ˇt
,

1056 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
right
, 
i
)));

1058  
ˇt
;

1059 
	}
}

1061 
ldns_º_li°
 *

1062 
	$ldns_º_li°_subty≥_by_rdf
(
ldns_º_li°
 *
l
, 
ldns_rdf
 *
r
, 
size_t
 
pos
)

1064 
size_t
 
i
;

1065 
ldns_º_li°
 *
subty≥d
;

1066 
ldns_rdf
 *
li°_rdf
;

1068 
subty≥d
 = 
	`ldns_º_li°_√w
();

1070 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
l
); i++) {

1071 
li°_rdf
 = 
	`ldns_º_rdf
(

1072 
	`ldns_º_li°_º
(
l
, 
i
),

1073 
pos
);

1074 i‡(!
li°_rdf
) {

1076 
	`ldns_º_li°_dìp_‰ì
(
subty≥d
);

1077  
NULL
;

1080 i‡(
	`ldns_rdf_com∑ª
(
li°_rdf
, 
r
) == 0) {

1082 
	`ldns_º_li°_push_º
(
subty≥d
,

1083 
	`ldns_º_˛⁄e
(
	`ldns_º_li°_º
(
l
, 
i
)));

1087 i‡(
	`ldns_º_li°_º_cou¡
(
subty≥d
) > 0) {

1088  
subty≥d
;

1090 
	`ldns_º_li°_‰ì
(
subty≥d
);

1091  
NULL
;

1093 
	}
}

1095 
boﬁ


1096 
	$ldns_º_li°_push_º
(
ldns_º_li°
 *
º_li°
, c⁄° 
ldns_º
 *
º
)

1098 
size_t
 
º_cou¡
;

1099 
size_t
 
ˇp
;

1101 
º_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
º_li°
);

1102 
ˇp
 = 
º_li°
->
_º_ˇ∑côy
;

1105 if(
º_cou¡
+1 > 
ˇp
) {

1106 
ldns_º
 **
ºs
;

1108 if(
ˇp
 == 0)

1109 
ˇp
 = 
LDNS_RRLIST_INIT
;

1110 
ˇp
 *= 2;

1111 
ºs
 = 
	`LDNS_XREALLOC
(
º_li°
->
_ºs
, 
ldns_º
 *, 
ˇp
);

1112 i‡(!
ºs
) {

1113  
Ál£
;

1115 
º_li°
->
_ºs
 = 
ºs
;

1116 
º_li°
->
_º_ˇ∑côy
 = 
ˇp
;

1120 
º_li°
->
_ºs
[
º_cou¡
] = (
ldns_º
*)
º
;

1122 
	`ldns_º_li°_£t_º_cou¡
(
º_li°
, 
º_cou¡
 + 1);

1123  
åue
;

1124 
	}
}

1126 
boﬁ


1127 
	$ldns_º_li°_push_º_li°
(
ldns_º_li°
 *
º_li°
, c⁄°Üdns_º_li° *
push_li°
)

1129 
size_t
 
i
;

1131 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
push_li°
); i++) {

1132 i‡(!
	`ldns_º_li°_push_º
(
º_li°
,

1133 
	`ldns_º_li°_º
(
push_li°
, 
i
))) {

1134  
Ál£
;

1137  
åue
;

1138 
	}
}

1140 
ldns_º
 *

1141 
	$ldns_º_li°_p›_º
(
ldns_º_li°
 *
º_li°
)

1143 
size_t
 
º_cou¡
;

1144 
size_t
 
ˇp
;

1145 
ldns_º
 *
p›
;

1147 
º_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
º_li°
);

1149 i‡(
º_cou¡
 == 0) {

1150  
NULL
;

1153 
ˇp
 = 
º_li°
->
_º_ˇ∑côy
;

1154 
p›
 = 
	`ldns_º_li°_º
(
º_li°
, 
º_cou¡
 - 1);

1157 if(
ˇp
 > 
LDNS_RRLIST_INIT
 && 
º_cou¡
-1 <= cap/2) {

1158 
ldns_º
** 
a
;

1159 
ˇp
 /= 2;

1160 
a
 = 
	`LDNS_XREALLOC
(
º_li°
->
_ºs
, 
ldns_º
 *, 
ˇp
);

1161 if(
a
) {

1162 
º_li°
->
_ºs
 = 
a
;

1163 
º_li°
->
_º_ˇ∑côy
 = 
ˇp
;

1167 
	`ldns_º_li°_£t_º_cou¡
(
º_li°
, 
º_cou¡
 - 1);

1169  
p›
;

1170 
	}
}

1172 
ldns_º_li°
 *

1173 
	$ldns_º_li°_p›_º_li°
(
ldns_º_li°
 *
º_li°
, 
size_t
 
howm™y
)

1176 
ldns_º_li°
 *
p›≥d
;

1177 
ldns_º
 *
p
;

1178 
size_t
 
i
 = 
howm™y
;

1180 
p›≥d
 = 
	`ldns_º_li°_√w
();

1182 i‡(!
p›≥d
) {

1183  
NULL
;

1187 
i
 > 0 &&

1188 (
p
 = 
	`ldns_º_li°_p›_º
(
º_li°
)Ë!
NULL
) {

1189 
	`ldns_º_li°_push_º
(
p›≥d
, 
p
);

1190 
i
--;

1193 i‡(
i
 =
howm™y
) {

1194 
	`ldns_º_li°_‰ì
(
p›≥d
);

1195  
NULL
;

1197  
p›≥d
;

1199 
	}
}

1202 
boﬁ


1203 
	$ldns_º_li°_c⁄èös_º
(c⁄° 
ldns_º_li°
 *
º_li°
, 
ldns_º
 *
º
)

1205 
size_t
 
i
;

1207 i‡(!
º_li°
 || !
º
 || 
	`ldns_º_li°_º_cou¡
(rr_list) == 0) {

1208  
Ál£
;

1211 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

1212 i‡(
º
 =
	`ldns_º_li°_º
(
º_li°
, 
i
)) {

1213  
åue
;

1214 } i‡(
	`ldns_º_com∑ª
(
º
, 
	`ldns_º_li°_º
(
º_li°
, 
i
)) == 0) {

1215  
åue
;

1218  
Ál£
;

1219 
	}
}

1221 
boﬁ


1222 
	$ldns_is_º£t
(
ldns_º_li°
 *
º_li°
)

1224 
ldns_º_ty≥
 
t
;

1225 
ldns_º_˛ass
 
c
;

1226 
ldns_rdf
 *
o
;

1227 
ldns_º
 *
tmp
;

1228 
size_t
 
i
;

1230 i‡(!
º_li°
 || 
	`ldns_º_li°_º_cou¡
(rr_list) == 0) {

1231  
Ál£
;

1234 
tmp
 = 
	`ldns_º_li°_º
(
º_li°
, 0);

1236 
t
 = 
	`ldns_º_gë_ty≥
(
tmp
);

1237 
c
 = 
	`ldns_º_gë_˛ass
(
tmp
);

1238 
o
 = 
	`ldns_º_ow√r
(
tmp
);

1241 
i
 = 1; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

1242 
tmp
 = 
	`ldns_º_li°_º
(
º_li°
, 
i
);

1243 i‡(
t
 !
	`ldns_º_gë_ty≥
(
tmp
)) {

1244  
Ál£
;

1246 i‡(
c
 !
	`ldns_º_gë_˛ass
(
tmp
)) {

1247  
Ál£
;

1249 i‡(
	`ldns_rdf_com∑ª
(
o
, 
	`ldns_º_ow√r
(
tmp
)) != 0) {

1250  
Ál£
;

1253  
åue
;

1254 
	}
}

1256 
boﬁ


1257 
	$ldns_º_£t_push_º
(
ldns_º_li°
 *
º_li°
, 
ldns_º
 *
º
)

1259 
size_t
 
º_cou¡
;

1260 
size_t
 
i
;

1261 
ldns_º
 *
œ°
;

1263 
	`as£π
(
º
 !
NULL
);

1265 
º_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
º_li°
);

1267 i‡(
º_cou¡
 == 0) {

1270  
	`ldns_º_li°_push_º
(
º_li°
, 
º
);

1273 
œ°
 = 
	`ldns_º_li°_º
(
º_li°
, 
º_cou¡
 - 1);

1275 i‡(
	`ldns_º_gë_˛ass
(
œ°
Ë!ldns_º_gë_˛ass(
º
)) {

1276  
Ál£
;

1278 i‡(
	`ldns_º_gë_ty≥
(
œ°
Ë!ldns_º_gë_ty≥(
º
)) {

1279  
Ál£
;

1282 i‡(
	`ldns_º_gë_ty≥
(
º
Ë!
LDNS_RR_TYPE_RRSIG
) {

1283 i‡(
	`ldns_º_âl
(
œ°
Ë!ldns_º_âl(
º
)) {

1284  
Ál£
;

1287 i‡(
	`ldns_rdf_com∑ª
(
	`ldns_º_ow√r
(
œ°
),

1288 
	`ldns_º_ow√r
(
º
)) != 0) {

1289  
Ál£
;

1293 
i
 = 0; i < 
º_cou¡
; i++) {

1294 if(
	`ldns_º_com∑ª
(

1295 
	`ldns_º_li°_º
(
º_li°
, 
i
), 
º
) == 0) {

1296  
Ál£
;

1300  
	`ldns_º_li°_push_º
(
º_li°
, 
º
);

1302 
	}
}

1304 
ldns_º
 *

1305 
	$ldns_º_£t_p›_º
(
ldns_º_li°
 *
º_li°
)

1307  
	`ldns_º_li°_p›_º
(
º_li°
);

1308 
	}
}

1310 
ldns_º_li°
 *

1311 
	$ldns_º_li°_p›_º£t
(
ldns_º_li°
 *
º_li°
)

1313 
ldns_º_li°
 *
º£t
;

1314 
ldns_º
 *
œ°_º
 = 
NULL
;

1315 
ldns_º
 *
√xt_º
;

1317 i‡(!
º_li°
) {

1318  
NULL
;

1321 
º£t
 = 
	`ldns_º_li°_√w
();

1322 i‡(!
œ°_º
) {

1323 
œ°_º
 = 
	`ldns_º_li°_p›_º
(
º_li°
);

1324 i‡(!
œ°_º
) {

1325 
	`ldns_º_li°_‰ì
(
º£t
);

1326  
NULL
;

1328 
	`ldns_º_li°_push_º
(
º£t
, 
œ°_º
);

1332 i‡(
	`ldns_º_li°_º_cou¡
(
º_li°
) > 0) {

1333 
√xt_º
 = 
	`ldns_º_li°_º
(
º_li°
, 
	`ldns_º_li°_º_cou¡
(rr_list) - 1);

1335 
√xt_º
 = 
NULL
;

1338 
√xt_º
) {

1340 
	`ldns_rdf_com∑ª
(
	`ldns_º_ow√r
(
√xt_º
),

1341 
	`ldns_º_ow√r
(
œ°_º
)) == 0

1343 
	`ldns_º_gë_ty≥
(
√xt_º
Ë=ldns_º_gë_ty≥(
œ°_º
)

1345 
	`ldns_º_gë_˛ass
(
√xt_º
Ë=ldns_º_gë_˛ass(
œ°_º
)

1347 
	`ldns_º_li°_push_º
(
º£t
, 
	`ldns_º_li°_p›_º
(
º_li°
));

1348 i‡(
	`ldns_º_li°_º_cou¡
(
º_li°
) > 0) {

1349 
œ°_º
 = 
√xt_º
;

1350 
√xt_º
 = 
	`ldns_º_li°_º
(
º_li°
, 
	`ldns_º_li°_º_cou¡
(rr_list) - 1);

1352 
√xt_º
 = 
NULL
;

1355 
√xt_º
 = 
NULL
;

1359  
º£t
;

1360 
	}
}

1362 
ldns_º
 *

1363 
	$ldns_º_˛⁄e
(c⁄° 
ldns_º
 *
º
)

1365 
size_t
 
i
;

1366 
ldns_º
 *
√w_º
;

1368 i‡(!
º
) {

1369  
NULL
;

1372 
√w_º
 = 
	`ldns_º_√w
();

1373 i‡(!
√w_º
) {

1374  
NULL
;

1376 i‡(
	`ldns_º_ow√r
(
º
)) {

1377 
	`ldns_º_£t_ow√r
(
√w_º
, 
	`ldns_rdf_˛⁄e
(
	`ldns_º_ow√r
(
º
)));

1379 
	`ldns_º_£t_âl
(
√w_º
, 
	`ldns_º_âl
(
º
));

1380 
	`ldns_º_£t_ty≥
(
√w_º
, 
	`ldns_º_gë_ty≥
(
º
));

1381 
	`ldns_º_£t_˛ass
(
√w_º
, 
	`ldns_º_gë_˛ass
(
º
));

1382 
	`ldns_º_£t_que°i⁄
(
√w_º
, 
	`ldns_º_is_que°i⁄
(
º
));

1384 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

1385 i‡(
	`ldns_º_rdf
(
º
,
i
)) {

1386 
	`ldns_º_push_rdf
(
√w_º
, 
	`ldns_rdf_˛⁄e
(
	`ldns_º_rdf
(
º
, 
i
)));

1390  
√w_º
;

1391 
	}
}

1393 
ldns_º_li°
 *

1394 
	$ldns_º_li°_˛⁄e
(c⁄° 
ldns_º_li°
 *
ºli°
)

1396 
size_t
 
i
;

1397 
ldns_º_li°
 *
√w_li°
;

1398 
ldns_º
 *
r
;

1400 i‡(!
ºli°
) {

1401  
NULL
;

1404 
√w_li°
 = 
	`ldns_º_li°_√w
();

1405 i‡(!
√w_li°
) {

1406  
NULL
;

1408 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºli°
); i++) {

1409 
r
 = 
	`ldns_º_˛⁄e
(

1410 
	`ldns_º_li°_º
(
ºli°
, 
i
)

1412 i‡(!
r
) {

1414 
	`ldns_º_li°_dìp_‰ì
(
√w_li°
);

1415  
NULL
;

1417 
	`ldns_º_li°_push_º
(
√w_li°
, 
r
);

1419  
√w_li°
;

1420 
	}
}

1424 
	$qs‹t_schw¨tz_º_com∑ª
(c⁄° *
a
, c⁄° *
b
)

1426 
ªsu…
 = 0;

1427 
ldns_º
 *
º1
, *
º2
;

1428 
ldns_buf„r
 *
º1_buf
, *
º2_buf
;

1429 
ldns_schw¨tzün_com∑ª_°ru˘
 *
ß
 = *(ldns_schw¨tzün_com∑ª_°ru˘ **Ë
a
;

1430 
ldns_schw¨tzün_com∑ª_°ru˘
 *
sb
 = *(ldns_schw¨tzün_com∑ª_°ru˘ **Ë
b
;

1435 
ldns_º
 *
ˇn⁄iˇl_a
, *
ˇn⁄iˇl_b
;

1437 
º1
 = (
ldns_º
 *Ë
ß
->
‹igöÆ_obje˘
;

1438 
º2
 = (
ldns_º
 *Ë
sb
->
‹igöÆ_obje˘
;

1440 
ªsu…
 = 
	`ldns_º_com∑ª_no_rd©a
(
º1
, 
º2
);

1442 i‡(
ªsu…
 == 0) {

1443 i‡(!
ß
->
å™sf‹med_obje˘
) {

1444 
ˇn⁄iˇl_a
 = 
	`ldns_º_˛⁄e
(
ß
->
‹igöÆ_obje˘
);

1445 
	`ldns_º2ˇn⁄iˇl
(
ˇn⁄iˇl_a
);

1446 
ß
->
å™sf‹med_obje˘
 = 
	`ldns_buf„r_√w
(
	`ldns_º_uncom¥es£d_size
(
ˇn⁄iˇl_a
));

1447 i‡(
	`ldns_º2buf„r_wúe
(
ß
->
å™sf‹med_obje˘
, 
ˇn⁄iˇl_a
, 
LDNS_SECTION_ANY
Ë!
LDNS_STATUS_OK
) {

1448 
	`ldns_buf„r_‰ì
((
ldns_buf„r
 *)
ß
->
å™sf‹med_obje˘
);

1449 
ß
->
å™sf‹med_obje˘
 = 
NULL
;

1450 
	`ldns_º_‰ì
(
ˇn⁄iˇl_a
);

1453 
	`ldns_º_‰ì
(
ˇn⁄iˇl_a
);

1455 i‡(!
sb
->
å™sf‹med_obje˘
) {

1456 
ˇn⁄iˇl_b
 = 
	`ldns_º_˛⁄e
(
sb
->
‹igöÆ_obje˘
);

1457 
	`ldns_º2ˇn⁄iˇl
(
ˇn⁄iˇl_b
);

1458 
sb
->
å™sf‹med_obje˘
 = 
	`ldns_buf„r_√w
(
	`ldns_º_uncom¥es£d_size
(
ˇn⁄iˇl_b
));

1459 i‡(
	`ldns_º2buf„r_wúe
(
sb
->
å™sf‹med_obje˘
, 
ˇn⁄iˇl_b
, 
LDNS_SECTION_ANY
Ë!
LDNS_STATUS_OK
) {

1460 
	`ldns_buf„r_‰ì
((
ldns_buf„r
 *)
ß
->
å™sf‹med_obje˘
);

1461 
	`ldns_buf„r_‰ì
((
ldns_buf„r
 *)
sb
->
å™sf‹med_obje˘
);

1462 
ß
->
å™sf‹med_obje˘
 = 
NULL
;

1463 
sb
->
å™sf‹med_obje˘
 = 
NULL
;

1464 
	`ldns_º_‰ì
(
ˇn⁄iˇl_b
);

1467 
	`ldns_º_‰ì
(
ˇn⁄iˇl_b
);

1469 
º1_buf
 = (
ldns_buf„r
 *Ë
ß
->
å™sf‹med_obje˘
;

1470 
º2_buf
 = (
ldns_buf„r
 *Ë
sb
->
å™sf‹med_obje˘
;

1472 
ªsu…
 = 
	`ldns_º_com∑ª_wúe
(
º1_buf
, 
º2_buf
);

1475  
ªsu…
;

1476 
	}
}

1479 
	$ldns_º_li°_s‹t
(
ldns_º_li°
 *
uns‹ãd
)

1481 
ldns_schw¨tzün_com∑ª_°ru˘
 **
s‹èbÀs
;

1482 
size_t
 
ôem_cou¡
;

1483 
size_t
 
i
;

1485 i‡(
uns‹ãd
) {

1486 
ôem_cou¡
 = 
	`ldns_º_li°_º_cou¡
(
uns‹ãd
);

1488 
s‹èbÀs
 = 
	`LDNS_XMALLOC
(
ldns_schw¨tzün_com∑ª_°ru˘
 *,

1489 
ôem_cou¡
);

1490 if(!
s‹èbÀs
) ;

1491 
i
 = 0; i < 
ôem_cou¡
; i++) {

1492 
s‹èbÀs
[
i
] = 
	`LDNS_XMALLOC
(
ldns_schw¨tzün_com∑ª_°ru˘
, 1);

1493 if(!
s‹èbÀs
[
i
]) {

1495 
i
>0) {

1496 
i
--;

1497 
	`LDNS_FREE
(
s‹èbÀs
[
i
]);

1500 
	`LDNS_FREE
(
s‹èbÀs
);

1503 
s‹èbÀs
[
i
]->
‹igöÆ_obje˘
 = 
	`ldns_º_li°_º
(
uns‹ãd
, i);

1504 
s‹èbÀs
[
i
]->
å™sf‹med_obje˘
 = 
NULL
;

1506 
	`qs‹t
(
s‹èbÀs
,

1507 
ôem_cou¡
,

1508 (
ldns_schw¨tzün_com∑ª_°ru˘
 *),

1509 
qs‹t_schw¨tz_º_com∑ª
);

1510 
i
 = 0; i < 
ôem_cou¡
; i++) {

1511 
uns‹ãd
->
_ºs
[
i
] = 
s‹èbÀs
[i]->
‹igöÆ_obje˘
;

1512 i‡(
s‹èbÀs
[
i
]->
å™sf‹med_obje˘
) {

1513 
	`ldns_buf„r_‰ì
(
s‹èbÀs
[
i
]->
å™sf‹med_obje˘
);

1515 
	`LDNS_FREE
(
s‹èbÀs
[
i
]);

1517 
	`LDNS_FREE
(
s‹èbÀs
);

1519 
	}
}

1522 
	$ldns_º_com∑ª_no_rd©a
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
)

1524 
size_t
 
º1_Àn
;

1525 
size_t
 
º2_Àn
;

1526 
size_t
 
off£t
;

1528 
	`as£π
(
º1
 !
NULL
);

1529 
	`as£π
(
º2
 !
NULL
);

1531 
º1_Àn
 = 
	`ldns_º_uncom¥es£d_size
(
º1
);

1532 
º2_Àn
 = 
	`ldns_º_uncom¥es£d_size
(
º2
);

1534 i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
º1
),Üdns_º_ow√r(
º2
)) < 0) {

1536 } i‡(
	`ldns_d«me_com∑ª
(
	`ldns_º_ow√r
(
º1
),Üdns_º_ow√r(
º2
)) > 0) {

1541 i‡(
	`ldns_º_gë_˛ass
(
º1
Ë!ldns_º_gë_˛ass(
º2
)) {

1542  
	`ldns_º_gë_˛ass
(
º1
Ë-Üdns_º_gë_˛ass(
º2
);

1546 i‡(
	`ldns_º_gë_ty≥
(
º1
Ë!ldns_º_gë_ty≥(
º2
)) {

1547  
	`ldns_º_gë_ty≥
(
º1
Ë-Üdns_º_gë_ty≥(
º2
);

1551 
off£t
 = 
	`ldns_rdf_size
(
	`ldns_º_ow√r
(
º1
)) + 4 + 2 + 2 + 2;

1553 i‡(
off£t
 > 
º1_Àn
 || off£à> 
º2_Àn
) {

1554 i‡(
º1_Àn
 =
º2_Àn
) {

1557  ((Ë
º2_Àn
 - (Ë
º1_Àn
);

1561 
	}
}

1563 
	$ldns_º_com∑ª_wúe
(
ldns_buf„r
 *
º1_buf
,Üdns_buf„∏*
º2_buf
)

1565 
size_t
 
º1_Àn
, 
º2_Àn
, 
mö_Àn
, 
i
, 
off£t
;

1567 
º1_Àn
 = 
	`ldns_buf„r_ˇ∑côy
(
º1_buf
);

1568 
º2_Àn
 = 
	`ldns_buf„r_ˇ∑côy
(
º2_buf
);

1572 
off£t
 = 0;

1573 
off£t
 < 
º1_Àn
 && *
	`ldns_buf„r_©
(
º1_buf
, offset) != 0) {

1574 
off£t
 +*
	`ldns_buf„r_©
(
º1_buf
, offset) + 1;

1578 
off£t
 += 11;

1579 
mö_Àn
 = (
º1_Àn
 < 
º2_Àn
) ?Ñr1_len :Ñr2_len;

1581 
i
 = 
off£t
; i < 
mö_Àn
; i++) {

1582 i‡(*
	`ldns_buf„r_©
(
º1_buf
,
i
Ë< *ldns_buf„r_©(
º2_buf
,i)) {

1584 } i‡(*
	`ldns_buf„r_©
(
º1_buf
,
i
Ë> *ldns_buf„r_©(
º2_buf
,i)) {

1590 i‡(
º1_Àn
 < 
º2_Àn
) {

1592 } i‡(
º1_Àn
 > 
º2_Àn
) {

1598 
	}
}

1601 
	$ldns_º_com∑ª
(c⁄° 
ldns_º
 *
º1
, c⁄°Üdns_º *
º2
)

1603 
ªsu…
;

1604 
size_t
 
º1_Àn
, 
º2_Àn
;

1606 
ldns_buf„r
 *
º1_buf
;

1607 
ldns_buf„r
 *
º2_buf
;

1609 
ªsu…
 = 
	`ldns_º_com∑ª_no_rd©a
(
º1
, 
º2
);

1610 i‡(
ªsu…
 == 0) {

1611 
º1_Àn
 = 
	`ldns_º_uncom¥es£d_size
(
º1
);

1612 
º2_Àn
 = 
	`ldns_º_uncom¥es£d_size
(
º2
);

1614 
º1_buf
 = 
	`ldns_buf„r_√w
(
º1_Àn
);

1615 
º2_buf
 = 
	`ldns_buf„r_√w
(
º2_Àn
);

1617 i‡(
	`ldns_º2buf„r_wúe_ˇn⁄iˇl
(
º1_buf
,

1618 
º1
,

1619 
LDNS_SECTION_ANY
)

1620 !
LDNS_STATUS_OK
) {

1621 
	`ldns_buf„r_‰ì
(
º1_buf
);

1622 
	`ldns_buf„r_‰ì
(
º2_buf
);

1625 i‡(
	`ldns_º2buf„r_wúe_ˇn⁄iˇl
(
º2_buf
,

1626 
º2
,

1627 
LDNS_SECTION_ANY
)

1628 !
LDNS_STATUS_OK
) {

1629 
	`ldns_buf„r_‰ì
(
º1_buf
);

1630 
	`ldns_buf„r_‰ì
(
º2_buf
);

1634 
ªsu…
 = 
	`ldns_º_com∑ª_wúe
(
º1_buf
, 
º2_buf
);

1636 
	`ldns_buf„r_‰ì
(
º1_buf
);

1637 
	`ldns_buf„r_‰ì
(
º2_buf
);

1640  
ªsu…
;

1641 
	}
}

1646 
	$ldns_º_com∑ª_ds_dnskey
(
ldns_º
 *
ds
,

1647 
ldns_º
 *
dnskey
)

1649 
ldns_º
 *
ds_gí
;

1650 
boﬁ
 
ªsu…
 = 
Ál£
;

1651 
ldns_hash
 
Ægo
;

1653 i‡(!
dnskey
 || !
ds
 ||

1654 
	`ldns_º_gë_ty≥
(
ds
Ë!
LDNS_RR_TYPE_DS
 ||

1655 
	`ldns_º_gë_ty≥
(
dnskey
Ë!
LDNS_RR_TYPE_DNSKEY
) {

1656  
Ál£
;

1659 i‡(
	`ldns_º_rdf
(
ds
, 2Ë=
NULL
) {

1660  
Ál£
;

1662 
Ægo
 = 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_rdf
(
ds
, 2));

1664 
ds_gí
 = 
	`ldns_key_º2ds
(
dnskey
, 
Ægo
);

1665 i‡(
ds_gí
) {

1666 
ªsu…
 = 
	`ldns_º_com∑ª
(
ds
, 
ds_gí
) == 0;

1667 
	`ldns_º_‰ì
(
ds_gí
);

1669  
ªsu…
;

1670 
	}
}

1672 
boﬁ


1673 
	$ldns_º_com∑ª_ds
(c⁄° 
ldns_º
 *
‹r1
, c⁄°Üdns_º *
‹r2
)

1675 
boﬁ
 
ªsu…
;

1676 
ldns_º
 *
º1
 = 
	`ldns_º_˛⁄e
(
‹r1
);

1677 
ldns_º
 *
º2
 = 
	`ldns_º_˛⁄e
(
‹r2
);

1680 
	`ldns_º_£t_âl
(
º1
, 0);

1681 
	`ldns_º_£t_âl
(
º2
, 0);

1683 i‡(
	`ldns_º_gë_ty≥
(
º1
Ë=
LDNS_RR_TYPE_DS
 &&

1684 
	`ldns_º_gë_ty≥
(
º2
Ë=
LDNS_RR_TYPE_DNSKEY
) {

1685 
ªsu…
 = 
	`ldns_º_com∑ª_ds_dnskey
(
º1
, 
º2
);

1686 } i‡(
	`ldns_º_gë_ty≥
(
º1
Ë=
LDNS_RR_TYPE_DNSKEY
 &&

1687 
	`ldns_º_gë_ty≥
(
º2
Ë=
LDNS_RR_TYPE_DS
) {

1688 
ªsu…
 = 
	`ldns_º_com∑ª_ds_dnskey
(
º2
, 
º1
);

1690 
ªsu…
 = (
	`ldns_º_com∑ª
(
º1
, 
º2
) == 0);

1693 
	`ldns_º_‰ì
(
º1
);

1694 
	`ldns_º_‰ì
(
º2
);

1696  
ªsu…
;

1697 
	}
}

1700 
	$ldns_º_li°_com∑ª
(c⁄° 
ldns_º_li°
 *
ºl1
, c⁄°Üdns_º_li° *
ºl2
)

1702 
size_t
 
i
 = 0;

1703 
º_cmp
;

1705 
	`as£π
(
ºl1
 !
NULL
);

1706 
	`as£π
(
ºl2
 !
NULL
);

1708 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
ºl1
Ë&& i <Üdns_º_li°_º_cou¡(
ºl2
); i++) {

1709 
º_cmp
 = 
	`ldns_º_com∑ª
(
	`ldns_º_li°_º
(
ºl1
, 
i
),Üdns_º_li°_º(
ºl2
, i));

1710 i‡(
º_cmp
 != 0) {

1711  
º_cmp
;

1715 i‡(
i
 =
	`ldns_º_li°_º_cou¡
(
ºl1
) &&

1716 
i
 !
	`ldns_º_li°_º_cou¡
(
ºl2
)) {

1718 } i‡(
i
 =
	`ldns_º_li°_º_cou¡
(
ºl2
) &&

1719 
i
 !
	`ldns_º_li°_º_cou¡
(
ºl1
)) {

1724 
	}
}

1726 
size_t


1727 
	$ldns_º_uncom¥es£d_size
(c⁄° 
ldns_º
 *
r
)

1729 
size_t
 
ºsize
;

1730 
size_t
 
i
;

1732 
ºsize
 = 0;

1734 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
r
); i++) {

1735 
ºsize
 +
	`ldns_rdf_size
(
	`ldns_º_rdf
(
r
, 
i
));

1738 
ºsize
 +
	`ldns_rdf_size
(
	`ldns_º_ow√r
(
r
));

1739 
ºsize
 +
LDNS_RR_OVERHEAD
;

1740  
ºsize
;

1741 
	}
}

1744 
	$ldns_º2ˇn⁄iˇl
(
ldns_º
 *
º
)

1746 
uöt16_t
 
i
;

1748 i‡(!
º
) {

1752 
	`ldns_d«me2ˇn⁄iˇl
(
	`ldns_º_ow√r
(
º
));

1761 
	`ldns_º_gë_ty≥
(
º
)) {

1762 
LDNS_RR_TYPE_NS
:

1763 
LDNS_RR_TYPE_MD
:

1764 
LDNS_RR_TYPE_MF
:

1765 
LDNS_RR_TYPE_CNAME
:

1766 
LDNS_RR_TYPE_SOA
:

1767 
LDNS_RR_TYPE_MB
:

1768 
LDNS_RR_TYPE_MG
:

1769 
LDNS_RR_TYPE_MR
:

1770 
LDNS_RR_TYPE_PTR
:

1771 
LDNS_RR_TYPE_MINFO
:

1772 
LDNS_RR_TYPE_MX
:

1773 
LDNS_RR_TYPE_RP
:

1774 
LDNS_RR_TYPE_AFSDB
:

1775 
LDNS_RR_TYPE_RT
:

1776 
LDNS_RR_TYPE_SIG
:

1777 
LDNS_RR_TYPE_PX
:

1778 
LDNS_RR_TYPE_NXT
:

1779 
LDNS_RR_TYPE_NAPTR
:

1780 
LDNS_RR_TYPE_KX
:

1781 
LDNS_RR_TYPE_SRV
:

1782 
LDNS_RR_TYPE_DNAME
:

1783 
LDNS_RR_TYPE_A6
:

1784 
LDNS_RR_TYPE_RRSIG
:

1785 
i
 = 0; i < 
	`ldns_º_rd_cou¡
(
º
); i++) {

1786 
	`ldns_d«me2ˇn⁄iˇl
(
	`ldns_º_rdf
(
º
, 
i
));

1793 
	}
}

1796 
	$ldns_º_li°2ˇn⁄iˇl
(
ldns_º_li°
 *
º_li°
)

1798 
size_t
 
i
;

1799 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
º_li°
); i++) {

1800 
	`ldns_º2ˇn⁄iˇl
(
	`ldns_º_li°_º
(
º_li°
, 
i
));

1802 
	}
}

1804 
uöt8_t


1805 
	$ldns_º_œbñ_cou¡
(
ldns_º
 *
º
)

1807 i‡(!
º
) {

1810  
	`ldns_d«me_œbñ_cou¡
(

1811 
	`ldns_º_ow√r
(
º
));

1812 
	}
}

1815 c⁄° 
ldns_rdf_ty≥
 
	gty≥_0_wúef‹m©
[] = { 
LDNS_RDF_TYPE_UNKNOWN
 };

1816 c⁄° 
ldns_rdf_ty≥
 
	gty≥_a_wúef‹m©
[] = { 
LDNS_RDF_TYPE_A
 };

1817 c⁄° 
ldns_rdf_ty≥
 
	gty≥_ns_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1818 c⁄° 
ldns_rdf_ty≥
 
	gty≥_md_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1819 c⁄° 
ldns_rdf_ty≥
 
	gty≥_mf_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1820 c⁄° 
ldns_rdf_ty≥
 
	gty≥_˙ame_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1821 c⁄° 
ldns_rdf_ty≥
 
	gty≥_sﬂ_wúef‹m©
[] = {

1822 
LDNS_RDF_TYPE_DNAME
, LDNS_RDF_TYPE_DNAME, 
LDNS_RDF_TYPE_INT32
,

1823 
LDNS_RDF_TYPE_PERIOD
, LDNS_RDF_TYPE_PERIOD, LDNS_RDF_TYPE_PERIOD,

1824 
LDNS_RDF_TYPE_PERIOD


1826 c⁄° 
ldns_rdf_ty≥
 
	gty≥_mb_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1827 c⁄° 
ldns_rdf_ty≥
 
	gty≥_mg_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1828 c⁄° 
ldns_rdf_ty≥
 
	gty≥_mr_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1829 c⁄° 
ldns_rdf_ty≥
 
	gty≥_wks_wúef‹m©
[] = {

1830 
LDNS_RDF_TYPE_A
, 
LDNS_RDF_TYPE_WKS


1832 c⁄° 
ldns_rdf_ty≥
 
	gty≥_±r_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1833 c⁄° 
ldns_rdf_ty≥
 
	gty≥_höfo_wúef‹m©
[] = {

1834 
LDNS_RDF_TYPE_STR
, LDNS_RDF_TYPE_STR

1836 c⁄° 
ldns_rdf_ty≥
 
	gty≥_möfo_wúef‹m©
[] = {

1837 
LDNS_RDF_TYPE_DNAME
, LDNS_RDF_TYPE_DNAME

1839 c⁄° 
ldns_rdf_ty≥
 
	gty≥_mx_wúef‹m©
[] = {

1840 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_DNAME


1842 c⁄° 
ldns_rdf_ty≥
 
	gty≥_Ω_wúef‹m©
[] = {

1843 
LDNS_RDF_TYPE_DNAME
, LDNS_RDF_TYPE_DNAME

1845 c⁄° 
ldns_rdf_ty≥
 
	gty≥_afsdb_wúef‹m©
[] = {

1846 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_DNAME


1848 c⁄° 
ldns_rdf_ty≥
 
	gty≥_x25_wúef‹m©
[] = { 
LDNS_RDF_TYPE_STR
 };

1849 c⁄° 
ldns_rdf_ty≥
 
	gty≥_isdn_wúef‹m©
[] = {

1850 
LDNS_RDF_TYPE_STR
, LDNS_RDF_TYPE_STR

1852 c⁄° 
ldns_rdf_ty≥
 
	gty≥_π_wúef‹m©
[] = {

1853 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_DNAME


1855 c⁄° 
ldns_rdf_ty≥
 
	gty≥_nßp_wúef‹m©
[] = {

1856 
LDNS_RDF_TYPE_NSAP


1858 c⁄° 
ldns_rdf_ty≥
 
	gty≥_nßp_±r_wúef‹m©
[] = {

1859 
LDNS_RDF_TYPE_STR


1861 c⁄° 
ldns_rdf_ty≥
 
	gty≥_sig_wúef‹m©
[] = {

1862 
LDNS_RDF_TYPE_TYPE
, 
LDNS_RDF_TYPE_ALG
, 
LDNS_RDF_TYPE_INT8
, 
LDNS_RDF_TYPE_INT32
,

1863 
LDNS_RDF_TYPE_TIME
, LDNS_RDF_TYPE_TIME, 
LDNS_RDF_TYPE_INT16
,

1864 
LDNS_RDF_TYPE_DNAME
, 
LDNS_RDF_TYPE_B64


1866 c⁄° 
ldns_rdf_ty≥
 
	gty≥_key_wúef‹m©
[] = {

1867 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_INT8
, LDNS_RDF_TYPE_INT8, 
LDNS_RDF_TYPE_B64


1869 c⁄° 
ldns_rdf_ty≥
 
	gty≥_px_wúef‹m©
[] = {

1870 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_DNAME
, LDNS_RDF_TYPE_DNAME

1872 c⁄° 
ldns_rdf_ty≥
 
	gty≥_gpos_wúef‹m©
[] = {

1873 
LDNS_RDF_TYPE_STR
, LDNS_RDF_TYPE_STR, LDNS_RDF_TYPE_STR

1875 c⁄° 
ldns_rdf_ty≥
 
	gty≥_ØØ_wúef‹m©
[] = { 
LDNS_RDF_TYPE_AAAA
 };

1876 c⁄° 
ldns_rdf_ty≥
 
	gty≥_loc_wúef‹m©
[] = { 
LDNS_RDF_TYPE_LOC
 };

1877 c⁄° 
ldns_rdf_ty≥
 
	gty≥_nxt_wúef‹m©
[] = {

1878 
LDNS_RDF_TYPE_DNAME
, 
LDNS_RDF_TYPE_UNKNOWN


1880 c⁄° 
ldns_rdf_ty≥
 
	gty≥_eid_wúef‹m©
[] = {

1881 
LDNS_RDF_TYPE_HEX


1883 c⁄° 
ldns_rdf_ty≥
 
	gty≥_nimloc_wúef‹m©
[] = {

1884 
LDNS_RDF_TYPE_HEX


1886 c⁄° 
ldns_rdf_ty≥
 
	gty≥_§v_wúef‹m©
[] = {

1887 
LDNS_RDF_TYPE_INT16
, LDNS_RDF_TYPE_INT16, LDNS_RDF_TYPE_INT16, 
LDNS_RDF_TYPE_DNAME


1889 c⁄° 
ldns_rdf_ty≥
 
	gty≥_©ma_wúef‹m©
[] = {

1890 
LDNS_RDF_TYPE_ATMA


1892 c⁄° 
ldns_rdf_ty≥
 
	gty≥_«±r_wúef‹m©
[] = {

1893 
LDNS_RDF_TYPE_INT16
, LDNS_RDF_TYPE_INT16, 
LDNS_RDF_TYPE_STR
, LDNS_RDF_TYPE_STR, LDNS_RDF_TYPE_STR, 
LDNS_RDF_TYPE_DNAME


1895 c⁄° 
ldns_rdf_ty≥
 
	gty≥_kx_wúef‹m©
[] = {

1896 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_DNAME


1898 c⁄° 
ldns_rdf_ty≥
 
	gty≥_˚π_wúef‹m©
[] = {

1899 
LDNS_RDF_TYPE_CERT_ALG
, 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_ALG
, 
LDNS_RDF_TYPE_B64


1901 c⁄° 
ldns_rdf_ty≥
 
	gty≥_a6_wúef‹m©
[] = { 
LDNS_RDF_TYPE_UNKNOWN
 };

1902 c⁄° 
ldns_rdf_ty≥
 
	gty≥_d«me_wúef‹m©
[] = { 
LDNS_RDF_TYPE_DNAME
 };

1903 c⁄° 
ldns_rdf_ty≥
 
	gty≥_sök_wúef‹m©
[] = { 
LDNS_RDF_TYPE_INT8
,

1904 
LDNS_RDF_TYPE_INT8
, LDNS_RDF_TYPE_INT8, 
LDNS_RDF_TYPE_B64


1906 c⁄° 
ldns_rdf_ty≥
 
	gty≥_≠l_wúef‹m©
[] = {

1907 
LDNS_RDF_TYPE_APL


1909 c⁄° 
ldns_rdf_ty≥
 
	gty≥_ds_wúef‹m©
[] = {

1910 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_ALG
, 
LDNS_RDF_TYPE_INT8
, 
LDNS_RDF_TYPE_HEX


1912 c⁄° 
ldns_rdf_ty≥
 
	gty≥_sshÂ_wúef‹m©
[] = {

1913 
LDNS_RDF_TYPE_INT8
, LDNS_RDF_TYPE_INT8, 
LDNS_RDF_TYPE_HEX


1915 c⁄° 
ldns_rdf_ty≥
 
	gty≥_ù£ckey_wúef‹m©
[] = {

1916 
LDNS_RDF_TYPE_IPSECKEY


1918 c⁄° 
ldns_rdf_ty≥
 
	gty≥_ºsig_wúef‹m©
[] = {

1919 
LDNS_RDF_TYPE_TYPE
, 
LDNS_RDF_TYPE_ALG
, 
LDNS_RDF_TYPE_INT8
, 
LDNS_RDF_TYPE_INT32
,

1920 
LDNS_RDF_TYPE_TIME
, LDNS_RDF_TYPE_TIME, 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_DNAME
, 
LDNS_RDF_TYPE_B64


1922 c⁄° 
ldns_rdf_ty≥
 
	gty≥_n£c_wúef‹m©
[] = {

1923 
LDNS_RDF_TYPE_DNAME
, 
LDNS_RDF_TYPE_NSEC


1925 c⁄° 
ldns_rdf_ty≥
 
	gty≥_dhcid_wúef‹m©
[] = {

1926 
LDNS_RDF_TYPE_B64


1928 c⁄° 
ldns_rdf_ty≥
 
	gty≥_èlök_wúef‹m©
[] = {

1929 
LDNS_RDF_TYPE_DNAME
, LDNS_RDF_TYPE_DNAME

1932 c⁄° 
ldns_rdf_ty≥
 
	gty≥_n£c3_wúef‹m©
[] = {

1934 
LDNS_RDF_TYPE_INT8
, LDNS_RDF_TYPE_INT8, 
LDNS_RDF_TYPE_INT16
, 
LDNS_RDF_TYPE_NSEC3_SALT
, 
LDNS_RDF_TYPE_NSEC3_NEXT_OWNER
, 
LDNS_RDF_TYPE_NSEC


1937 c⁄° 
ldns_rdf_ty≥
 
	gty≥_n£c3∑øm_wúef‹m©
[] = {

1939 
LDNS_RDF_TYPE_INT8
,

1940 
LDNS_RDF_TYPE_INT8
,

1941 
LDNS_RDF_TYPE_INT16
,

1942 
LDNS_RDF_TYPE_NSEC3_SALT


1945 c⁄° 
ldns_rdf_ty≥
 
	gty≥_dnskey_wúef‹m©
[] = {

1946 
LDNS_RDF_TYPE_INT16
,

1947 
LDNS_RDF_TYPE_INT8
,

1948 
LDNS_RDF_TYPE_ALG
,

1949 
LDNS_RDF_TYPE_B64


1951 c⁄° 
ldns_rdf_ty≥
 
	gty≥_tkey_wúef‹m©
[] = {

1952 
LDNS_RDF_TYPE_DNAME
,

1953 
LDNS_RDF_TYPE_TIME
,

1954 
LDNS_RDF_TYPE_TIME
,

1955 
LDNS_RDF_TYPE_INT16
,

1956 
LDNS_RDF_TYPE_INT16
,

1957 
LDNS_RDF_TYPE_INT16_DATA
,

1958 
LDNS_RDF_TYPE_INT16_DATA
,

1960 c⁄° 
ldns_rdf_ty≥
 
	gty≥_tsig_wúef‹m©
[] = {

1961 
LDNS_RDF_TYPE_DNAME
,

1962 
LDNS_RDF_TYPE_TSIGTIME
,

1963 
LDNS_RDF_TYPE_INT16
,

1964 
LDNS_RDF_TYPE_INT16_DATA
,

1965 
LDNS_RDF_TYPE_INT16
,

1966 
LDNS_RDF_TYPE_INT16
,

1967 
LDNS_RDF_TYPE_INT16_DATA


1969 c⁄° 
ldns_rdf_ty≥
 
	gty≥_éß_wúef‹m©
[] = {

1970 
LDNS_RDF_TYPE_INT8
,

1971 
LDNS_RDF_TYPE_INT8
,

1972 
LDNS_RDF_TYPE_INT8
,

1973 
LDNS_RDF_TYPE_HEX


1975 c⁄° 
ldns_rdf_ty≥
 
	gty≥_hù_wúef‹m©
[] = {

1976 
LDNS_RDF_TYPE_HIP


1978 c⁄° 
ldns_rdf_ty≥
 
	gty≥_nid_wúef‹m©
[] = {

1979 
LDNS_RDF_TYPE_INT16
,

1980 
LDNS_RDF_TYPE_ILNP64


1982 c⁄° 
ldns_rdf_ty≥
 
	gty≥_l32_wúef‹m©
[] = {

1983 
LDNS_RDF_TYPE_INT16
,

1984 
LDNS_RDF_TYPE_A


1986 c⁄° 
ldns_rdf_ty≥
 
	gty≥_l64_wúef‹m©
[] = {

1987 
LDNS_RDF_TYPE_INT16
,

1988 
LDNS_RDF_TYPE_ILNP64


1990 c⁄° 
ldns_rdf_ty≥
 
	gty≥_Õ_wúef‹m©
[] = {

1991 
LDNS_RDF_TYPE_INT16
,

1992 
LDNS_RDF_TYPE_DNAME


1994 c⁄° 
ldns_rdf_ty≥
 
	gty≥_eui48_wúef‹m©
[] = {

1995 
LDNS_RDF_TYPE_EUI48


1997 c⁄° 
ldns_rdf_ty≥
 
	gty≥_eui64_wúef‹m©
[] = {

1998 
LDNS_RDF_TYPE_EUI64


2000 #ifde‡
RRTYPE_URI


2001 c⁄° 
ldns_rdf_ty≥
 
	gty≥_uri_wúef‹m©
[] = {

2002 
LDNS_RDF_TYPE_INT16
,

2003 
LDNS_RDF_TYPE_INT16
,

2004 
LDNS_RDF_TYPE_LONG_STR


2007 c⁄° 
ldns_rdf_ty≥
 
	gty≥_ˇa_wúef‹m©
[] = {

2008 
LDNS_RDF_TYPE_INT8
,

2009 
LDNS_RDF_TYPE_TAG
,

2010 
LDNS_RDF_TYPE_LONG_STR


2019 
ldns_º_des¸ùt‹
 
	grd©a_fõld_des¸ùt‹s
[] = {

2021 { 0, 
NULL
, 0, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2023 {
LDNS_RR_TYPE_A
, "A", 1, 1, 
ty≥_a_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2025 {
LDNS_RR_TYPE_NS
, "NS", 1, 1, 
ty≥_ns_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2027 {
LDNS_RR_TYPE_MD
, "MD", 1, 1, 
ty≥_md_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2029 {
LDNS_RR_TYPE_MF
, "MF", 1, 1, 
ty≥_mf_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2031 {
LDNS_RR_TYPE_CNAME
, "CNAME", 1, 1, 
ty≥_˙ame_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2033 {
LDNS_RR_TYPE_SOA
, "SOA", 7, 7, 
ty≥_sﬂ_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 2 },

2035 {
LDNS_RR_TYPE_MB
, "MB", 1, 1, 
ty≥_mb_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2037 {
LDNS_RR_TYPE_MG
, "MG", 1, 1, 
ty≥_mg_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2039 {
LDNS_RR_TYPE_MR
, "MR", 1, 1, 
ty≥_mr_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2041 {
LDNS_RR_TYPE_NULL
, "NULL", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2043 {
LDNS_RR_TYPE_WKS
, "WKS", 2, 2, 
ty≥_wks_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2045 {
LDNS_RR_TYPE_PTR
, "PTR", 1, 1, 
ty≥_±r_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2047 {
LDNS_RR_TYPE_HINFO
, "HINFO", 2, 2, 
ty≥_höfo_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2049 {
LDNS_RR_TYPE_MINFO
, "MINFO", 2, 2, 
ty≥_möfo_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 2 },

2051 {
LDNS_RR_TYPE_MX
, "MX", 2, 2, 
ty≥_mx_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_COMPRESS
, 1 },

2053 {
LDNS_RR_TYPE_TXT
, "TXT", 1, 0, 
NULL
, 
LDNS_RDF_TYPE_STR
, 
LDNS_RR_NO_COMPRESS
, 0 },

2055 {
LDNS_RR_TYPE_RP
, "RP", 2, 2, 
ty≥_Ω_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 2 },

2057 {
LDNS_RR_TYPE_AFSDB
, "AFSDB", 2, 2, 
ty≥_afsdb_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2059 {
LDNS_RR_TYPE_X25
, "X25", 1, 1, 
ty≥_x25_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2061 {
LDNS_RR_TYPE_ISDN
, "ISDN", 1, 2, 
ty≥_isdn_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2063 {
LDNS_RR_TYPE_RT
, "RT", 2, 2, 
ty≥_π_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2065 {
LDNS_RR_TYPE_NSAP
, "NSAP", 1, 1, 
ty≥_nßp_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2067 {
LDNS_RR_TYPE_NSAP_PTR
, "NSAP-PTR", 1, 1, 
ty≥_nßp_±r_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2069 {
LDNS_RR_TYPE_SIG
, "SIG", 9, 9, 
ty≥_sig_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2071 {
LDNS_RR_TYPE_KEY
, "KEY", 4, 4, 
ty≥_key_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2073 {
LDNS_RR_TYPE_PX
, "PX", 3, 3, 
ty≥_px_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 2 },

2075 {
LDNS_RR_TYPE_GPOS
, "GPOS", 3, 3, 
ty≥_gpos_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2077 {
LDNS_RR_TYPE_AAAA
, "AAAA", 1, 1, 
ty≥_ØØ_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2079 {
LDNS_RR_TYPE_LOC
, "LOC", 1, 1, 
ty≥_loc_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2081 {
LDNS_RR_TYPE_NXT
, "NXT", 2, 2, 
ty≥_nxt_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2083 {
LDNS_RR_TYPE_EID
, "EID", 1, 1, 
ty≥_eid_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2085 {
LDNS_RR_TYPE_NIMLOC
, "NIMLOC", 1, 1, 
ty≥_nimloc_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2087 {
LDNS_RR_TYPE_SRV
, "SRV", 4, 4, 
ty≥_§v_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2089 {
LDNS_RR_TYPE_ATMA
, "ATMA", 1, 1, 
ty≥_©ma_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2091 {
LDNS_RR_TYPE_NAPTR
, "NAPTR", 6, 6, 
ty≥_«±r_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2093 {
LDNS_RR_TYPE_KX
, "KX", 2, 2, 
ty≥_kx_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2095 {
LDNS_RR_TYPE_CERT
, "CERT", 4, 4, 
ty≥_˚π_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2097 {
LDNS_RR_TYPE_A6
, "A6", 1, 1, 
ty≥_a6_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2099 {
LDNS_RR_TYPE_DNAME
, "DNAME", 1, 1, 
ty≥_d«me_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2101 {
LDNS_RR_TYPE_SINK
, "SINK", 1, 1, 
ty≥_sök_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2103 {
LDNS_RR_TYPE_OPT
, "OPT", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2105 {
LDNS_RR_TYPE_APL
, "APL", 0, 0, 
ty≥_≠l_wúef‹m©
, 
LDNS_RDF_TYPE_APL
, 
LDNS_RR_NO_COMPRESS
, 0 },

2107 {
LDNS_RR_TYPE_DS
, "DS", 4, 4, 
ty≥_ds_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2109 {
LDNS_RR_TYPE_SSHFP
, "SSHFP", 3, 3, 
ty≥_sshÂ_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2111 {
LDNS_RR_TYPE_IPSECKEY
, "IPSECKEY", 1, 1, 
ty≥_ù£ckey_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2113 {
LDNS_RR_TYPE_RRSIG
, "RRSIG", 9, 9, 
ty≥_ºsig_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2115 {
LDNS_RR_TYPE_NSEC
, "NSEC", 1, 2, 
ty≥_n£c_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2117 {
LDNS_RR_TYPE_DNSKEY
, "DNSKEY", 4, 4, 
ty≥_dnskey_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2119 {
LDNS_RR_TYPE_DHCID
, "DHCID", 1, 1, 
ty≥_dhcid_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2121 {
LDNS_RR_TYPE_NSEC3
, "NSEC3", 5, 6, 
ty≥_n£c3_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2123 {
LDNS_RR_TYPE_NSEC3PARAM
, "NSEC3PARAM", 4, 4, 
ty≥_n£c3∑øm_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2125 {
LDNS_RR_TYPE_TLSA
, "TLSA", 4, 4, 
ty≥_éß_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2127 {
LDNS_RR_TYPE_NULL
, "TYPE53", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2128 {
LDNS_RR_TYPE_NULL
, "TYPE54", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2135 {
LDNS_RR_TYPE_HIP
, "HIP", 1, 1, 
ty≥_hù_wúef‹m©
, 
LDNS_RDF_TYPE_DNAME
, 
LDNS_RR_NO_COMPRESS
, 0 },

2137 #ifde‡
RRTYPE_NINFO


2139 {
LDNS_RR_TYPE_NINFO
, "NINFO", 1, 0, 
NULL
, 
LDNS_RDF_TYPE_STR
, 
LDNS_RR_NO_COMPRESS
, 0 },

2141 {
LDNS_RR_TYPE_NULL
, "TYPE56", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2143 #ifde‡
RRTYPE_RKEY


2145 {
LDNS_RR_TYPE_RKEY
, "RKEY", 4, 4, 
ty≥_key_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2147 {
LDNS_RR_TYPE_NULL
, "TYPE57", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2150 {
LDNS_RR_TYPE_TALINK
, "TALINK", 2, 2, 
ty≥_èlök_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 2 },

2152 #ifde‡
RRTYPE_CDS


2154 {
LDNS_RR_TYPE_CDS
, "CDS", 4, 4, 
ty≥_ds_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2156 {
LDNS_RR_TYPE_NULL
, "TYPE59", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2159 {
LDNS_RR_TYPE_NULL
, "TYPE60", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2160 {
LDNS_RR_TYPE_NULL
, "TYPE61", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2161 {
LDNS_RR_TYPE_NULL
, "TYPE62", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2162 {
LDNS_RR_TYPE_NULL
, "TYPE63", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2163 {
LDNS_RR_TYPE_NULL
, "TYPE64", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2164 {
LDNS_RR_TYPE_NULL
, "TYPE65", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2165 {
LDNS_RR_TYPE_NULL
, "TYPE66", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2166 {
LDNS_RR_TYPE_NULL
, "TYPE67", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2167 {
LDNS_RR_TYPE_NULL
, "TYPE68", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2168 {
LDNS_RR_TYPE_NULL
, "TYPE69", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2169 {
LDNS_RR_TYPE_NULL
, "TYPE70", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2170 {
LDNS_RR_TYPE_NULL
, "TYPE71", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2171 {
LDNS_RR_TYPE_NULL
, "TYPE72", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2172 {
LDNS_RR_TYPE_NULL
, "TYPE73", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2173 {
LDNS_RR_TYPE_NULL
, "TYPE74", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2174 {
LDNS_RR_TYPE_NULL
, "TYPE75", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2175 {
LDNS_RR_TYPE_NULL
, "TYPE76", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2176 {
LDNS_RR_TYPE_NULL
, "TYPE77", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2177 {
LDNS_RR_TYPE_NULL
, "TYPE78", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2178 {
LDNS_RR_TYPE_NULL
, "TYPE79", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2179 {
LDNS_RR_TYPE_NULL
, "TYPE80", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2180 {
LDNS_RR_TYPE_NULL
, "TYPE81", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2181 {
LDNS_RR_TYPE_NULL
, "TYPE82", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2182 {
LDNS_RR_TYPE_NULL
, "TYPE83", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2183 {
LDNS_RR_TYPE_NULL
, "TYPE84", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2184 {
LDNS_RR_TYPE_NULL
, "TYPE85", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2185 {
LDNS_RR_TYPE_NULL
, "TYPE86", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2186 {
LDNS_RR_TYPE_NULL
, "TYPE87", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2187 {
LDNS_RR_TYPE_NULL
, "TYPE88", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2188 {
LDNS_RR_TYPE_NULL
, "TYPE89", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2189 {
LDNS_RR_TYPE_NULL
, "TYPE90", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2190 {
LDNS_RR_TYPE_NULL
, "TYPE91", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2191 {
LDNS_RR_TYPE_NULL
, "TYPE92", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2192 {
LDNS_RR_TYPE_NULL
, "TYPE93", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2193 {
LDNS_RR_TYPE_NULL
, "TYPE94", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2194 {
LDNS_RR_TYPE_NULL
, "TYPE95", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2195 {
LDNS_RR_TYPE_NULL
, "TYPE96", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2196 {
LDNS_RR_TYPE_NULL
, "TYPE97", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2197 {
LDNS_RR_TYPE_NULL
, "TYPE98", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2200 {
LDNS_RR_TYPE_SPF
, "SPF", 1, 0, 
NULL
, 
LDNS_RDF_TYPE_STR
, 
LDNS_RR_NO_COMPRESS
, 0 },

2203 {
LDNS_RR_TYPE_NULL
, "TYPE100", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2205 {
LDNS_RR_TYPE_NULL
, "TYPE101", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2207 {
LDNS_RR_TYPE_NULL
, "TYPE102", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2209 {
LDNS_RR_TYPE_NULL
, "TYPE103", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2212 {
LDNS_RR_TYPE_NID
, "NID", 2, 2, 
ty≥_nid_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2214 {
LDNS_RR_TYPE_L32
, "L32", 2, 2, 
ty≥_l32_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2216 {
LDNS_RR_TYPE_L64
, "L64", 2, 2, 
ty≥_l64_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2218 {
LDNS_RR_TYPE_LP
, "LP", 2, 2, 
ty≥_Õ_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2220 {
LDNS_RR_TYPE_EUI48
, "EUI48", 1, 1, 
ty≥_eui48_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2222 {
LDNS_RR_TYPE_EUI64
, "EUI64", 1, 1, 
ty≥_eui64_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2224 {
LDNS_RR_TYPE_NULL
, "TYPE110", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2225 {
LDNS_RR_TYPE_NULL
, "TYPE111", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2226 {
LDNS_RR_TYPE_NULL
, "TYPE112", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2227 {
LDNS_RR_TYPE_NULL
, "TYPE113", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2228 {
LDNS_RR_TYPE_NULL
, "TYPE114", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2229 {
LDNS_RR_TYPE_NULL
, "TYPE115", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2230 {
LDNS_RR_TYPE_NULL
, "TYPE116", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2231 {
LDNS_RR_TYPE_NULL
, "TYPE117", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2232 {
LDNS_RR_TYPE_NULL
, "TYPE118", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2233 {
LDNS_RR_TYPE_NULL
, "TYPE119", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2234 {
LDNS_RR_TYPE_NULL
, "TYPE120", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2235 {
LDNS_RR_TYPE_NULL
, "TYPE121", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2236 {
LDNS_RR_TYPE_NULL
, "TYPE122", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2237 {
LDNS_RR_TYPE_NULL
, "TYPE123", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2238 {
LDNS_RR_TYPE_NULL
, "TYPE124", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2239 {
LDNS_RR_TYPE_NULL
, "TYPE125", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2240 {
LDNS_RR_TYPE_NULL
, "TYPE126", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2241 {
LDNS_RR_TYPE_NULL
, "TYPE127", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2242 {
LDNS_RR_TYPE_NULL
, "TYPE128", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2243 {
LDNS_RR_TYPE_NULL
, "TYPE129", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2244 {
LDNS_RR_TYPE_NULL
, "TYPE130", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2245 {
LDNS_RR_TYPE_NULL
, "TYPE131", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2246 {
LDNS_RR_TYPE_NULL
, "TYPE132", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2247 {
LDNS_RR_TYPE_NULL
, "TYPE133", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2248 {
LDNS_RR_TYPE_NULL
, "TYPE134", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2249 {
LDNS_RR_TYPE_NULL
, "TYPE135", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2250 {
LDNS_RR_TYPE_NULL
, "TYPE136", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2251 {
LDNS_RR_TYPE_NULL
, "TYPE137", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2252 {
LDNS_RR_TYPE_NULL
, "TYPE138", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2253 {
LDNS_RR_TYPE_NULL
, "TYPE139", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2254 {
LDNS_RR_TYPE_NULL
, "TYPE140", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2255 {
LDNS_RR_TYPE_NULL
, "TYPE141", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2256 {
LDNS_RR_TYPE_NULL
, "TYPE142", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2257 {
LDNS_RR_TYPE_NULL
, "TYPE143", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2258 {
LDNS_RR_TYPE_NULL
, "TYPE144", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2259 {
LDNS_RR_TYPE_NULL
, "TYPE145", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2260 {
LDNS_RR_TYPE_NULL
, "TYPE146", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2261 {
LDNS_RR_TYPE_NULL
, "TYPE147", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2262 {
LDNS_RR_TYPE_NULL
, "TYPE148", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2263 {
LDNS_RR_TYPE_NULL
, "TYPE149", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2264 {
LDNS_RR_TYPE_NULL
, "TYPE150", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2265 {
LDNS_RR_TYPE_NULL
, "TYPE151", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2266 {
LDNS_RR_TYPE_NULL
, "TYPE152", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2267 {
LDNS_RR_TYPE_NULL
, "TYPE153", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2268 {
LDNS_RR_TYPE_NULL
, "TYPE154", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2269 {
LDNS_RR_TYPE_NULL
, "TYPE155", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2270 {
LDNS_RR_TYPE_NULL
, "TYPE156", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2271 {
LDNS_RR_TYPE_NULL
, "TYPE157", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2272 {
LDNS_RR_TYPE_NULL
, "TYPE158", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2273 {
LDNS_RR_TYPE_NULL
, "TYPE159", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2274 {
LDNS_RR_TYPE_NULL
, "TYPE160", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2275 {
LDNS_RR_TYPE_NULL
, "TYPE161", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2276 {
LDNS_RR_TYPE_NULL
, "TYPE162", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2277 {
LDNS_RR_TYPE_NULL
, "TYPE163", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2278 {
LDNS_RR_TYPE_NULL
, "TYPE164", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2279 {
LDNS_RR_TYPE_NULL
, "TYPE165", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2280 {
LDNS_RR_TYPE_NULL
, "TYPE166", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2281 {
LDNS_RR_TYPE_NULL
, "TYPE167", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2282 {
LDNS_RR_TYPE_NULL
, "TYPE168", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2283 {
LDNS_RR_TYPE_NULL
, "TYPE169", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2284 {
LDNS_RR_TYPE_NULL
, "TYPE170", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2285 {
LDNS_RR_TYPE_NULL
, "TYPE171", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2286 {
LDNS_RR_TYPE_NULL
, "TYPE172", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2287 {
LDNS_RR_TYPE_NULL
, "TYPE173", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2288 {
LDNS_RR_TYPE_NULL
, "TYPE174", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2289 {
LDNS_RR_TYPE_NULL
, "TYPE175", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2290 {
LDNS_RR_TYPE_NULL
, "TYPE176", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2291 {
LDNS_RR_TYPE_NULL
, "TYPE177", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2292 {
LDNS_RR_TYPE_NULL
, "TYPE178", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2293 {
LDNS_RR_TYPE_NULL
, "TYPE179", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2294 {
LDNS_RR_TYPE_NULL
, "TYPE180", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2295 {
LDNS_RR_TYPE_NULL
, "TYPE181", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2296 {
LDNS_RR_TYPE_NULL
, "TYPE182", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2297 {
LDNS_RR_TYPE_NULL
, "TYPE183", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2298 {
LDNS_RR_TYPE_NULL
, "TYPE184", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2299 {
LDNS_RR_TYPE_NULL
, "TYPE185", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2300 {
LDNS_RR_TYPE_NULL
, "TYPE186", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2301 {
LDNS_RR_TYPE_NULL
, "TYPE187", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2302 {
LDNS_RR_TYPE_NULL
, "TYPE188", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2303 {
LDNS_RR_TYPE_NULL
, "TYPE189", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2304 {
LDNS_RR_TYPE_NULL
, "TYPE190", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2305 {
LDNS_RR_TYPE_NULL
, "TYPE191", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2306 {
LDNS_RR_TYPE_NULL
, "TYPE192", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2307 {
LDNS_RR_TYPE_NULL
, "TYPE193", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2308 {
LDNS_RR_TYPE_NULL
, "TYPE194", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2309 {
LDNS_RR_TYPE_NULL
, "TYPE195", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2310 {
LDNS_RR_TYPE_NULL
, "TYPE196", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2311 {
LDNS_RR_TYPE_NULL
, "TYPE197", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2312 {
LDNS_RR_TYPE_NULL
, "TYPE198", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2313 {
LDNS_RR_TYPE_NULL
, "TYPE199", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2314 {
LDNS_RR_TYPE_NULL
, "TYPE200", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2315 {
LDNS_RR_TYPE_NULL
, "TYPE201", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2316 {
LDNS_RR_TYPE_NULL
, "TYPE202", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2317 {
LDNS_RR_TYPE_NULL
, "TYPE203", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2318 {
LDNS_RR_TYPE_NULL
, "TYPE204", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2319 {
LDNS_RR_TYPE_NULL
, "TYPE205", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2320 {
LDNS_RR_TYPE_NULL
, "TYPE206", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2321 {
LDNS_RR_TYPE_NULL
, "TYPE207", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2322 {
LDNS_RR_TYPE_NULL
, "TYPE208", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2323 {
LDNS_RR_TYPE_NULL
, "TYPE209", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2324 {
LDNS_RR_TYPE_NULL
, "TYPE210", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2325 {
LDNS_RR_TYPE_NULL
, "TYPE211", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2326 {
LDNS_RR_TYPE_NULL
, "TYPE212", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2327 {
LDNS_RR_TYPE_NULL
, "TYPE213", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2328 {
LDNS_RR_TYPE_NULL
, "TYPE214", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2329 {
LDNS_RR_TYPE_NULL
, "TYPE215", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2330 {
LDNS_RR_TYPE_NULL
, "TYPE216", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2331 {
LDNS_RR_TYPE_NULL
, "TYPE217", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2332 {
LDNS_RR_TYPE_NULL
, "TYPE218", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2333 {
LDNS_RR_TYPE_NULL
, "TYPE219", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2334 {
LDNS_RR_TYPE_NULL
, "TYPE220", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2335 {
LDNS_RR_TYPE_NULL
, "TYPE221", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2336 {
LDNS_RR_TYPE_NULL
, "TYPE222", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2337 {
LDNS_RR_TYPE_NULL
, "TYPE223", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2338 {
LDNS_RR_TYPE_NULL
, "TYPE224", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2339 {
LDNS_RR_TYPE_NULL
, "TYPE225", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2340 {
LDNS_RR_TYPE_NULL
, "TYPE226", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2341 {
LDNS_RR_TYPE_NULL
, "TYPE227", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2342 {
LDNS_RR_TYPE_NULL
, "TYPE228", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2343 {
LDNS_RR_TYPE_NULL
, "TYPE229", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2344 {
LDNS_RR_TYPE_NULL
, "TYPE230", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2345 {
LDNS_RR_TYPE_NULL
, "TYPE231", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2346 {
LDNS_RR_TYPE_NULL
, "TYPE232", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2347 {
LDNS_RR_TYPE_NULL
, "TYPE233", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2348 {
LDNS_RR_TYPE_NULL
, "TYPE234", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2349 {
LDNS_RR_TYPE_NULL
, "TYPE235", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2350 {
LDNS_RR_TYPE_NULL
, "TYPE236", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2351 {
LDNS_RR_TYPE_NULL
, "TYPE237", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2352 {
LDNS_RR_TYPE_NULL
, "TYPE238", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2353 {
LDNS_RR_TYPE_NULL
, "TYPE239", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2354 {
LDNS_RR_TYPE_NULL
, "TYPE240", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2355 {
LDNS_RR_TYPE_NULL
, "TYPE241", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2356 {
LDNS_RR_TYPE_NULL
, "TYPE242", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2357 {
LDNS_RR_TYPE_NULL
, "TYPE243", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2358 {
LDNS_RR_TYPE_NULL
, "TYPE244", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2359 {
LDNS_RR_TYPE_NULL
, "TYPE245", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2360 {
LDNS_RR_TYPE_NULL
, "TYPE246", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2361 {
LDNS_RR_TYPE_NULL
, "TYPE247", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2362 {
LDNS_RR_TYPE_NULL
, "TYPE248", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2368 {
LDNS_RR_TYPE_TKEY
, "TKEY", 7, 7, 
ty≥_tkey_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2373 {
LDNS_RR_TYPE_TSIG
, "TSIG", 7, 7, 
ty≥_tsig_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 1 },

2376 {
LDNS_RR_TYPE_NULL
, "TYPE251", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2378 {
LDNS_RR_TYPE_NULL
, "TYPE252", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2380 {
LDNS_RR_TYPE_NULL
, "TYPE253", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2382 {
LDNS_RR_TYPE_NULL
, "TYPE254", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2384 {
LDNS_RR_TYPE_NULL
, "TYPE255", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2386 #ifde‡
RRTYPE_URI


2388 {
LDNS_RR_TYPE_URI
, "URI", 3, 3, 
ty≥_uri_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2390 {
LDNS_RR_TYPE_NULL
, "TYPE256", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2393 {
LDNS_RR_TYPE_CAA
, "CAA", 3, 3, 
ty≥_ˇa_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2397 #ifde‡
RRTYPE_TA


2399 {
LDNS_RR_TYPE_TA
, "TA", 4, 4, 
ty≥_ds_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2401 {
LDNS_RR_TYPE_NULL
, "TYPE32768", 1, 1, 
ty≥_0_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 },

2404 {
LDNS_RR_TYPE_DLV
, "DLV", 4, 4, 
ty≥_ds_wúef‹m©
, 
LDNS_RDF_TYPE_NONE
, 
LDNS_RR_NO_COMPRESS
, 0 }

2412 
	#LDNS_RDATA_FIELD_DESCRIPTORS_COUNT
 \

2413 ((
rd©a_fõld_des¸ùt‹s
)/‘d©a_fõld_des¸ùt‹s[0]))

	)

2426 
ldns_º_des¸ùt‹
* 
	grd©a_fõld_des¸ùt‹s_íd
 =

2427 &
rd©a_fõld_des¸ùt‹s
[
LDNS_RDATA_FIELD_DESCRIPTORS_COUNT
];

2456 
ldns_°©us


2457 
	$ldns_rdf_bôm≠_known_º_ty≥s_£t
(
ldns_rdf
** 
rdf
, 
vÆue
)

2459 
uöt8_t
 
wödow
;

2460 
uöt8_t
 
subty≥
;

2461 
uöt16_t
 
wödows
[256]

2462 #i‚de‡
S_SPLINT_S


2466 
ldns_º_des¸ùt‹
* 
d
;

2467 
size_t
 
i
;

2469 
size_t
 
sz
;

2470 
uöt8_t
* 
d©a
 = 
NULL
;

2471 
uöt8_t
* 
d±r
;

2473 
	`as£π
(
rdf
 !
NULL
);

2477 
d
=
rd©a_fõld_des¸ùt‹s
; d < 
rd©a_fõld_des¸ùt‹s_íd
; d++) {

2478 
wödow
 = 
d
->
_ty≥
 >> 8;

2479 
subty≥
 = 
d
->
_ty≥
 & 0xff;

2480 i‡(
wödows
[
wödow
] < 
subty≥
) {

2481 
wödows
[
wödow
] = 
subty≥
;

2487 
sz
 = 0;

2488 
i
 = 0; i < 256; i++) {

2489 i‡(
wödows
[
i
]) {

2490 
sz
 +
wödows
[
i
] / 8 + 3;

2493 i‡(
sz
 > 0) {

2496 
d±r
 = 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
sz
);

2497 
	`mem£t
(
d©a
, 
vÆue
, 
sz
);

2498 i‡(!
d©a
) {

2499  
LDNS_STATUS_MEM_ERR
;

2501 
i
 = 0; i < 256; i++) {

2502 i‡(
wödows
[
i
]) {

2503 *
d±r
++ = (
uöt8_t
)
i
;

2504 *
d±r
++ = (
uöt8_t
)(
wödows
[
i
] / 8 + 1);

2505 
d±r
 += dptr[-1];

2511 *
rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_BITMAP
, 
sz
, 
d©a
);

2512 i‡(!*
rdf
) {

2513 
	`LDNS_FREE
(
d©a
);

2514  
LDNS_STATUS_MEM_ERR
;

2516  
LDNS_STATUS_OK
;

2517 
	}
}

2519 
ldns_°©us


2520 
	$ldns_rdf_bôm≠_known_º_ty≥s_•a˚
(
ldns_rdf
** 
rdf
)

2522  
	`ldns_rdf_bôm≠_known_º_ty≥s_£t
(
rdf
, 0);

2523 
	}
}

2525 
ldns_°©us


2526 
	$ldns_rdf_bôm≠_known_º_ty≥s
(
ldns_rdf
** 
rdf
)

2528  
	`ldns_rdf_bôm≠_known_º_ty≥s_£t
(
rdf
, 255);

2529 
	}
}

2534 c⁄° 
ldns_º_des¸ùt‹
 *

2535 
	$ldns_º_des¸ùt
(
uöt16_t
 
ty≥
)

2537 
size_t
 
i
;

2538 i‡(
ty≥
 < 
LDNS_RDATA_FIELD_DESCRIPTORS_COMMON
) {

2539  &
rd©a_fõld_des¸ùt‹s
[
ty≥
];

2542 
i
 = 
LDNS_RDATA_FIELD_DESCRIPTORS_COMMON
;

2543 
i
 < 
LDNS_RDATA_FIELD_DESCRIPTORS_COUNT
;

2544 
i
++) {

2545 i‡(
rd©a_fõld_des¸ùt‹s
[
i
].
_ty≥
 =
ty≥
) {

2546  &
rd©a_fõld_des¸ùt‹s
[
i
];

2549  &
rd©a_fõld_des¸ùt‹s
[0];

2551 
	}
}

2553 
size_t


2554 
	$ldns_º_des¸ùt‹_möimum
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
)

2556 i‡(
des¸ùt‹
) {

2557  
des¸ùt‹
->
_möimum
;

2561 
	}
}

2563 
size_t


2564 
	$ldns_º_des¸ùt‹_maximum
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
)

2566 i‡(
des¸ùt‹
) {

2567 i‡(
des¸ùt‹
->
_v¨übÀ
 !
LDNS_RDF_TYPE_NONE
) {

2569  
UINT_MAX
;

2571  
des¸ùt‹
->
_maximum
;

2576 
	}
}

2578 
ldns_rdf_ty≥


2579 
	$ldns_º_des¸ùt‹_fõld_ty≥
(c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
,

2580 
size_t
 
ödex
)

2582 
	`as£π
(
des¸ùt‹
 !
NULL
);

2583 
	`as£π
(
ödex
 < 
des¸ùt‹
->
_maximum


2584 || 
des¸ùt‹
->
_v¨übÀ
 !
LDNS_RDF_TYPE_NONE
);

2585 i‡(
ödex
 < 
des¸ùt‹
->
_maximum
) {

2586  
des¸ùt‹
->
_wúef‹m©
[
ödex
];

2588  
des¸ùt‹
->
_v¨übÀ
;

2590 
	}
}

2592 
ldns_º_ty≥


2593 
	$ldns_gë_º_ty≥_by_«me
(c⁄° *
«me
)

2595 
i
;

2596 c⁄° *
desc_«me
;

2597 c⁄° 
ldns_º_des¸ùt‹
 *
desc
;

2600 i‡(
	`°æí
(
«me
Ë> 4 && 
	`°∫ˇ£cmp
(name, "TYPE", 4) == 0) {

2601  
	`©oi
(
«me
 + 4);

2605 
i
 = 0; i < (Ë
LDNS_RDATA_FIELD_DESCRIPTORS_COUNT
; i++) {

2606 
desc
 = &
rd©a_fõld_des¸ùt‹s
[
i
];

2607 
desc_«me
 = 
desc
->
_«me
;

2608 if(
desc_«me
 &&

2609 
	`°æí
(
«me
Ë=°æí(
desc_«me
) &&

2610 
	`°∫ˇ£cmp
(
«me
, 
desc_«me
, 
	`°æí
(desc_name)) == 0) {

2612  
desc
->
_ty≥
;

2617 i‡(
	`°æí
(
«me
Ë=4 && 
	`°∫ˇ£cmp
(name, "IXFR", 4) == 0) {

2619 } i‡(
	`°æí
(
«me
Ë=4 && 
	`°∫ˇ£cmp
(name, "AXFR", 4) == 0) {

2621 } i‡(
	`°æí
(
«me
Ë=5 && 
	`°∫ˇ£cmp
(name, "MAILB", 5) == 0) {

2623 } i‡(
	`°æí
(
«me
Ë=5 && 
	`°∫ˇ£cmp
(name, "MAILA", 5) == 0) {

2625 } i‡(
	`°æí
(
«me
Ë=3 && 
	`°∫ˇ£cmp
(name, "ANY", 3) == 0) {

2630 
	}
}

2632 
ldns_º_˛ass


2633 
	$ldns_gë_º_˛ass_by_«me
(c⁄° *
«me
)

2635 
ldns_lookup_èbÀ
 *
…
;

2638 i‡(
	`°æí
(
«me
Ë> 5 && 
	`°∫ˇ£cmp
(name, "CLASS", 5) == 0) {

2639  
	`©oi
(
«me
 + 5);

2643 
…
 = 
	`ldns_lookup_by_«me
(
ldns_º_˛as£s
, 
«me
);

2645 i‡(
…
) {

2646  
…
->
id
;

2649 
	}
}

2652 
ldns_º_ty≥


2653 
	$ldns_rdf2º_ty≥
(c⁄° 
ldns_rdf
 *
rd
)

2655 
ldns_º_ty≥
 
r
;

2657 i‡(!
rd
) {

2661 i‡(
	`ldns_rdf_gë_ty≥
(
rd
Ë!
LDNS_RDF_TYPE_TYPE
) {

2665 
r
 = (
ldns_º_ty≥
Ë
	`ldns_rdf2«tive_öt16
(
rd
);

2666  
r
;

2667 
	}
}

2669 
ldns_º_ty≥


2670 
	$ldns_º_li°_ty≥
(c⁄° 
ldns_º_li°
 *
º_li°
)

2672 i‡(
º_li°
 && 
	`ldns_º_li°_º_cou¡
(rr_list) > 0) {

2673  
	`ldns_º_gë_ty≥
(
	`ldns_º_li°_º
(
º_li°
, 0));

2677 
	}
}

2679 
ldns_rdf
 *

2680 
	$ldns_º_li°_ow√r
(c⁄° 
ldns_º_li°
 *
º_li°
)

2682 i‡(
º_li°
 && 
	`ldns_º_li°_º_cou¡
(rr_list) > 0) {

2683  
	`ldns_º_ow√r
(
	`ldns_º_li°_º
(
º_li°
, 0));

2685  
NULL
;

2687 
	}
}

	@rr_functions.c

16 
	~<ldns/c⁄fig.h
>

18 
	~<ldns/ldns.h
>

20 
	~<limôs.h
>

21 
	~<°rögs.h
>

30 
ldns_rdf
 *

31 
	$ldns_º_fun˘i⁄
(
ldns_º_ty≥
 
ty≥
, c⁄° 
ldns_º
 *
º
, 
size_t
 
pos
)

33 i‡(!
º
 || 
	`ldns_º_gë_ty≥
‘rË!
ty≥
) {

34  
NULL
;

36  
	`ldns_º_rdf
(
º
, 
pos
);

37 
	}
}

47 
boﬁ


48 
	$ldns_º_£t_fun˘i⁄
(
ldns_º_ty≥
 
ty≥
, 
ldns_º
 *
º
, 
ldns_rdf
 *
rdf
, 
size_t
 
pos
)

50 
ldns_rdf
 *
p›
;

51 i‡(!
º
 || 
	`ldns_º_gë_ty≥
‘rË!
ty≥
) {

52  
Ál£
;

54 
p›
 = 
	`ldns_º_£t_rdf
(
º
, 
rdf
, 
pos
);

55 
	`ldns_rdf_dìp_‰ì
(
p›
);

56  
åue
;

57 
	}
}

60 
ldns_rdf
 *

61 
	$ldns_º_a_addªss
(c⁄° 
ldns_º
 *
r
)

64 i‡(!
r
 || (
	`ldns_º_gë_ty≥
‘Ë!
LDNS_RR_TYPE_A
 &&

65 
	`ldns_º_gë_ty≥
(
r
Ë!
LDNS_RR_TYPE_AAAA
)) {

66  
NULL
;

68  
	`ldns_º_rdf
(
r
, 0);

69 
	}
}

71 
boﬁ


72 
	$ldns_º_a_£t_addªss
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

75 
ldns_rdf
 *
p›
;

76 i‡(!
r
 || (
	`ldns_º_gë_ty≥
‘Ë!
LDNS_RR_TYPE_A
 &&

77 
	`ldns_º_gë_ty≥
(
r
Ë!
LDNS_RR_TYPE_AAAA
)) {

78  
Ál£
;

80 
p›
 = 
	`ldns_º_£t_rdf
(
r
, 
f
, 0);

81 i‡(
p›
) {

82 
	`LDNS_FREE
(
p›
);

83  
åue
;

85  
Ál£
;

87 
	}
}

90 
ldns_rdf
 *

91 
	$ldns_º_ns_nsd«me
(c⁄° 
ldns_º
 *
r
)

93  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_NS
, 
r
, 0);

94 
	}
}

97 
ldns_rdf
 *

98 
	$ldns_º_mx_¥e„ªn˚
(c⁄° 
ldns_º
 *
r
)

100  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_MX
, 
r
, 0);

101 
	}
}

103 
ldns_rdf
 *

104 
	$ldns_º_mx_exch™ge
(c⁄° 
ldns_º
 *
r
)

106  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_MX
, 
r
, 1);

107 
	}
}

110 
ldns_rdf
 *

111 
	$ldns_º_ºsig_ty≥covîed
(c⁄° 
ldns_º
 *
r
)

113  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 0);

114 
	}
}

116 
boﬁ


117 
	$ldns_º_ºsig_£t_ty≥covîed
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

119  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 0);

120 
	}
}

122 
ldns_rdf
 *

123 
	$ldns_º_ºsig_Æg‹ôhm
(c⁄° 
ldns_º
 *
r
)

125  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 1);

126 
	}
}

128 
boﬁ


129 
	$ldns_º_ºsig_£t_Æg‹ôhm
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

131  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 1);

132 
	}
}

134 
ldns_rdf
 *

135 
	$ldns_º_ºsig_œbñs
(c⁄° 
ldns_º
 *
r
)

137  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 2);

138 
	}
}

140 
boﬁ


141 
	$ldns_º_ºsig_£t_œbñs
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

143  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 2);

144 
	}
}

146 
ldns_rdf
 *

147 
	$ldns_º_ºsig_‹igâl
(c⁄° 
ldns_º
 *
r
)

149  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 3);

150 
	}
}

152 
boﬁ


153 
	$ldns_º_ºsig_£t_‹igâl
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

155  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 3);

156 
	}
}

158 
ldns_rdf
 *

159 
	$ldns_º_ºsig_expú©i⁄
(c⁄° 
ldns_º
 *
r
)

161  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 4);

162 
	}
}

164 
boﬁ


165 
	$ldns_º_ºsig_£t_expú©i⁄
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

167  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 4);

168 
	}
}

170 
ldns_rdf
 *

171 
	$ldns_º_ºsig_ö˚±i⁄
(c⁄° 
ldns_º
 *
r
)

173  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 5);

174 
	}
}

176 
boﬁ


177 
	$ldns_º_ºsig_£t_ö˚±i⁄
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

179  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 5);

180 
	}
}

182 
ldns_rdf
 *

183 
	$ldns_º_ºsig_keyèg
(c⁄° 
ldns_º
 *
r
)

185  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 6);

186 
	}
}

188 
boﬁ


189 
	$ldns_º_ºsig_£t_keyèg
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

191  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 6);

192 
	}
}

194 
ldns_rdf
 *

195 
	$ldns_º_ºsig_sig«me
(c⁄° 
ldns_º
 *
r
)

197  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 7);

198 
	}
}

200 
boﬁ


201 
	$ldns_º_ºsig_£t_sig«me
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

203  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 7);

204 
	}
}

206 
ldns_rdf
 *

207 
	$ldns_º_ºsig_sig
(c⁄° 
ldns_º
 *
r
)

209  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 8);

210 
	}
}

212 
boﬁ


213 
	$ldns_º_ºsig_£t_sig
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

215  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_RRSIG
, 
r
, 
f
, 8);

216 
	}
}

219 
ldns_rdf
 *

220 
	$ldns_º_dnskey_Êags
(c⁄° 
ldns_º
 *
r
)

222  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 0);

223 
	}
}

225 
boﬁ


226 
	$ldns_º_dnskey_£t_Êags
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

228  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 
f
, 0);

229 
	}
}

231 
ldns_rdf
 *

232 
	$ldns_º_dnskey_¥Ÿocﬁ
(c⁄° 
ldns_º
 *
r
)

234  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 1);

235 
	}
}

237 
boﬁ


238 
	$ldns_º_dnskey_£t_¥Ÿocﬁ
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

240  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 
f
, 1);

241 
	}
}

243 
ldns_rdf
 *

244 
	$ldns_º_dnskey_Æg‹ôhm
(c⁄° 
ldns_º
 *
r
)

246  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 2);

247 
	}
}

249 
boﬁ


250 
	$ldns_º_dnskey_£t_Æg‹ôhm
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

252  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 
f
, 2);

253 
	}
}

255 
ldns_rdf
 *

256 
	$ldns_º_dnskey_key
(c⁄° 
ldns_º
 *
r
)

258  
	`ldns_º_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 3);

259 
	}
}

261 
boﬁ


262 
	$ldns_º_dnskey_£t_key
(
ldns_º
 *
r
, 
ldns_rdf
 *
f
)

264  
	`ldns_º_£t_fun˘i⁄
(
LDNS_RR_TYPE_DNSKEY
, 
r
, 
f
, 3);

265 
	}
}

267 
size_t


268 
	$ldns_º_dnskey_key_size_øw
(c⁄° * 
keyd©a
,

269 c⁄° 
size_t
 
Àn
,

270 c⁄° 
ldns_Æg‹ôhm
 
Æg
)

273 
uöt8_t
 
t
;

276 
uöt16_t
 
exp
;

277 
uöt16_t
 
öt16
;

279 (
ldns_signög_Æg‹ôhm
)
Æg
) {

280 
LDNS_SIGN_DSA
:

281 
LDNS_SIGN_DSA_NSEC3
:

282 i‡(
Àn
 > 0) {

283 
t
 = 
keyd©a
[0];

284  (64 + 
t
*8)*8;

289 
LDNS_SIGN_RSAMD5
:

290 
LDNS_SIGN_RSASHA1
:

291 
LDNS_SIGN_RSASHA1_NSEC3
:

292 #ifde‡
USE_SHA2


293 
LDNS_SIGN_RSASHA256
:

294 
LDNS_SIGN_RSASHA512
:

296 i‡(
Àn
 > 0) {

297 i‡(
keyd©a
[0] == 0) {

299 i‡(
Àn
 > 3) {

300 
	`memmove
(&
öt16
, 
keyd©a
 + 1, 2);

301 
exp
 = 
	`¡ohs
(
öt16
);

302  (
Àn
 - 
exp
 - 3)*8;

307 
exp
 = 
keyd©a
[0];

308  (
Àn
-
exp
-1)*8;

314 #ifde‡
USE_GOST


315 
LDNS_SIGN_ECC_GOST
:

318 #ifde‡
USE_ECDSA


319 
LDNS_SIGN_ECDSAP256SHA256
:

321 
LDNS_SIGN_ECDSAP384SHA384
:

324 
LDNS_SIGN_HMACMD5
:

325  
Àn
;

329 
	}
}

331 
size_t


332 
	$ldns_º_dnskey_key_size
(c⁄° 
ldns_º
 *
key
)

334 i‡(!
key
 || !
	`ldns_º_dnskey_key
(key)

335 || !
	`ldns_º_dnskey_Æg‹ôhm
(
key
)) {

338  
	`ldns_º_dnskey_key_size_øw
((*)
	`ldns_rdf_d©a
(
	`ldns_º_dnskey_key
(
key
)),

339 
	`ldns_rdf_size
(
	`ldns_º_dnskey_key
(
key
)),

340 
	`ldns_rdf2«tive_öt8
(
	`ldns_º_dnskey_Æg‹ôhm
(
key
))

342 
	}
}

344 
uöt32_t
 
ldns_sﬂ_£rül_idítôy
(uöt32_à
ATTR_UNUSED
(
unu£d
), *
d©a
)

346  (
	guöt32_t
Ë(
	göçå_t
Ë
	gd©a
;

349 
uöt32_t
 
ldns_sﬂ_£rül_ö¸emít
(uöt32_à
s
, *
	$ATTR_UNUSED
(
unu£d
))

351  
	`ldns_sﬂ_£rül_ö¸emít_by
(
s
, (*)1);

352 
	}
}

354 
uöt32_t
 
	$ldns_sﬂ_£rül_ö¸emít_by
(
uöt32_t
 
s
, *
d©a
)

356  
s
 + (
öçå_t
Ë
d©a
;

357 
	}
}

359 
uöt32_t
 
	$ldns_sﬂ_£rül_d©ecou¡î
(
uöt32_t
 
s
, *
d©a
)

361 
tm
Åm;

362 
s_°r
[11];

363 
öt32_t
 
√w_s
;

364 
time_t
 
t
 = 
d©a
 ? (time_tË(
öçå_t
Ëd©®: 
	`ldns_time
(
NULL
);

366 (Ë
	`°r·ime
(
s_°r
, 11, "%Y%m%d00", 
	`loˇ…ime_r
(&
t
, &
tm
));

367 
√w_s
 = (
öt32_t
Ë
	`©oi
(
s_°r
);

368  
√w_s
 - ((
öt32_t
Ë
s
Ë<0 ? s+1 : ((
uöt32_t
)Çew_s);

369 
	}
}

371 
uöt32_t
 
	$ldns_sﬂ_£rül_unixtime
(
uöt32_t
 
s
, *
d©a
)

373 
öt32_t
 
√w_s
 = 
d©a
 ? (öt32_tË(
öçå_t
) data

374 : (
öt32_t
Ë
	`ldns_time
(
NULL
);

375  
√w_s
 - ((
öt32_t
Ë
s
Ë<0 ? s+1 : ((
uöt32_t
)Çew_s);

376 
	}
}

379 
	$ldns_º_sﬂ_ö¸emít
(
ldns_º
 *
sﬂ
)

381 
	`ldns_º_sﬂ_ö¸emít_func_d©a
(
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít
, 
NULL
);

382 
	}
}

385 
	$ldns_º_sﬂ_ö¸emít_func
(
ldns_º
 *
sﬂ
, 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
)

387 
	`ldns_º_sﬂ_ö¸emít_func_d©a
(
sﬂ
, 
f
, 
NULL
);

388 
	}
}

391 
	$ldns_º_sﬂ_ö¸emít_func_d©a
(
ldns_º
 *
sﬂ
,

392 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
, *
d©a
)

394 
ldns_rdf
 *
¥ev_sﬂ_£rül_rdf
;

395 i‡–!
sﬂ
 || !
f
 || 
	`ldns_º_gë_ty≥
(sﬂË!
LDNS_RR_TYPE_SOA


396 || !
	`ldns_º_rdf
(
sﬂ
, 2)) {

399 
¥ev_sﬂ_£rül_rdf
 = 
	`ldns_º_£t_rdf
(

400 
sﬂ


401 , 
	`ldns_«tive2rdf_öt32
(

402 
LDNS_RDF_TYPE_INT32


403 , (*
f
)–
	`ldns_rdf2«tive_öt32
(

404 
	`ldns_º_rdf
(
sﬂ
, 2))

405 , 
d©a


410 
	`LDNS_FREE
(
¥ev_sﬂ_£rül_rdf
);

411 
	}
}

414 
	$ldns_º_sﬂ_ö¸emít_func_öt
(
ldns_º
 *
sﬂ
,

415 
ldns_sﬂ_£rül_ö¸emít_func_t
 
f
, 
d©a
)

417 
	`ldns_º_sﬂ_ö¸emít_func_d©a
(
sﬂ
, 
f
, (*Ë(
öçå_t
Ë
d©a
);

418 
	}
}

	@sha1.c

19 
	~<ldns/c⁄fig.h
>

20 
	~<ldns/ldns.h
>

21 
	~<°rögs.h
>

23 
	#SHA1HANDSOFF
 1

	)

24 
	#rﬁ
(
vÆue
, 
bôs
Ë(((vÆueË<< (bôs)Ë| ((vÆueË>> (32 - (bôs))))

	)

28 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


29 
	#blk0
(
i
Ë(
block
->
l
[i] = (
	`rﬁ
(block->l[i],24)&0xFF00FF00) \

30 |(
	`rﬁ
(
block
->
l
[
i
],8)&0x00FF00FF))

	)

32 
	#blk0
(
i
Ë
block
->
l
[i]

	)

34 
	#blk
(
i
Ë(
block
->
l
[i&15] = 
	`rﬁ
(block->l[(i+13)&15]^block->l[(i+8)&15] \

35 ^
block
->
l
[(
i
+2)&15]^block->l[i&15],1))

	)

38 
	#R0
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=((w&(x^y))^y)+
	`blk0
(i)+0x5A827999+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

39 
	#R1
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=((w&(x^y))^y)+
	`blk
(i)+0x5A827999+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

40 
	#R2
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=(w^x^y)+
	`blk
(i)+0x6ED9EBA1+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

41 
	#R3
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=(((w|x)&y)|(w&x))+
	`blk
(i)+0x8F1BBCDC+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

42 
	#R4
(
v
,
w
,
x
,
y
,
z
,
i
Ëz+=(w^x^y)+
	`blk
(i)+0xCA62C1D6+
	`rﬁ
(v,5);wÙﬁ(w,30);

	)

47 
	$ldns_sha1_å™sf‹m
(
uöt32_t
 
°©e
[5], c⁄° 
buf„r
[
LDNS_SHA1_BLOCK_LENGTH
])

49 
uöt32_t
 
a
, 
b
, 
c
, 
d
, 
e
;

51 
c
[64];

52 
l
[16];

53 } 
	tCHAR64LONG16
;

54 
CHAR64LONG16
* 
block
;

55 #ifde‡
SHA1HANDSOFF


56 
w‹k•a˚
[
LDNS_SHA1_BLOCK_LENGTH
];

58 
block
 = (
CHAR64LONG16
 *)
w‹k•a˚
;

59 
	`memmove
(
block
, 
buf„r
, 
LDNS_SHA1_BLOCK_LENGTH
);

61 
block
 = (
CHAR64LONG16
 *)
buf„r
;

64 
a
 = 
°©e
[0];

65 
b
 = 
°©e
[1];

66 
c
 = 
°©e
[2];

67 
d
 = 
°©e
[3];

68 
e
 = 
°©e
[4];

71 
	`R0
(
a
,
b
,
c
,
d
,
e
, 0); R0(e,a,b,c,d, 1); R0(d,e,a,b,c, 2); R0(c,d,e,a,b, 3);

72 
	`R0
(
b
,
c
,
d
,
e
,
a
, 4); R0(a,b,c,d,e, 5); R0(e,a,b,c,d, 6); R0(d,e,a,b,c, 7);

73 
	`R0
(
c
,
d
,
e
,
a
,
b
, 8); R0(b,c,d,e,a, 9); R0(a,b,c,d,e,10); R0(e,a,b,c,d,11);

74 
	`R0
(
d
,
e
,
a
,
b
,
c
,12); R0(c,d,e,a,b,13); R0(b,c,d,e,a,14); R0(a,b,c,d,e,15);

75 
	`R1
(
e
,
a
,
b
,
c
,
d
,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);

76 
	`R2
(
a
,
b
,
c
,
d
,
e
,20); R2(e,a,b,c,d,21); R2(d,e,a,b,c,22); R2(c,d,e,a,b,23);

77 
	`R2
(
b
,
c
,
d
,
e
,
a
,24); R2(a,b,c,d,e,25); R2(e,a,b,c,d,26); R2(d,e,a,b,c,27);

78 
	`R2
(
c
,
d
,
e
,
a
,
b
,28); R2(b,c,d,e,a,29); R2(a,b,c,d,e,30); R2(e,a,b,c,d,31);

79 
	`R2
(
d
,
e
,
a
,
b
,
c
,32); R2(c,d,e,a,b,33); R2(b,c,d,e,a,34); R2(a,b,c,d,e,35);

80 
	`R2
(
e
,
a
,
b
,
c
,
d
,36); R2(d,e,a,b,c,37); R2(c,d,e,a,b,38); R2(b,c,d,e,a,39);

81 
	`R3
(
a
,
b
,
c
,
d
,
e
,40); R3(e,a,b,c,d,41); R3(d,e,a,b,c,42); R3(c,d,e,a,b,43);

82 
	`R3
(
b
,
c
,
d
,
e
,
a
,44); R3(a,b,c,d,e,45); R3(e,a,b,c,d,46); R3(d,e,a,b,c,47);

83 
	`R3
(
c
,
d
,
e
,
a
,
b
,48); R3(b,c,d,e,a,49); R3(a,b,c,d,e,50); R3(e,a,b,c,d,51);

84 
	`R3
(
d
,
e
,
a
,
b
,
c
,52); R3(c,d,e,a,b,53); R3(b,c,d,e,a,54); R3(a,b,c,d,e,55);

85 
	`R3
(
e
,
a
,
b
,
c
,
d
,56); R3(d,e,a,b,c,57); R3(c,d,e,a,b,58); R3(b,c,d,e,a,59);

86 
	`R4
(
a
,
b
,
c
,
d
,
e
,60); R4(e,a,b,c,d,61); R4(d,e,a,b,c,62); R4(c,d,e,a,b,63);

87 
	`R4
(
b
,
c
,
d
,
e
,
a
,64); R4(a,b,c,d,e,65); R4(e,a,b,c,d,66); R4(d,e,a,b,c,67);

88 
	`R4
(
c
,
d
,
e
,
a
,
b
,68); R4(b,c,d,e,a,69); R4(a,b,c,d,e,70); R4(e,a,b,c,d,71);

89 
	`R4
(
d
,
e
,
a
,
b
,
c
,72); R4(c,d,e,a,b,73); R4(b,c,d,e,a,74); R4(a,b,c,d,e,75);

90 
	`R4
(
e
,
a
,
b
,
c
,
d
,76); R4(d,e,a,b,c,77); R4(c,d,e,a,b,78); R4(b,c,d,e,a,79);

93 
°©e
[0] +
a
;

94 
°©e
[1] +
b
;

95 
°©e
[2] +
c
;

96 
°©e
[3] +
d
;

97 
°©e
[4] +
e
;

99 
a
 = 
b
 = 
c
 = 
d
 = 
e
 = 0;

100 
	}
}

106 
	$ldns_sha1_öô
(
ldns_sha1_˘x
 *
c⁄ãxt
)

109 
c⁄ãxt
->
cou¡
 = 0;

110 
c⁄ãxt
->
°©e
[0] = 0x67452301;

111 
c⁄ãxt
->
°©e
[1] = 0xEFCDAB89;

112 
c⁄ãxt
->
°©e
[2] = 0x98BADCFE;

113 
c⁄ãxt
->
°©e
[3] = 0x10325476;

114 
c⁄ãxt
->
°©e
[4] = 0xC3D2E1F0;

115 
	}
}

121 
	$ldns_sha1_upd©e
(
ldns_sha1_˘x
 *
c⁄ãxt
, c⁄° *
d©a
, 
Àn
)

123 
i
;

124 
j
;

126 
j
 = ()(
uöt32_t
)((
c⁄ãxt
->
cou¡
 >> 3) & 63);

127 
c⁄ãxt
->
cou¡
 +(
Àn
 << 3);

128 i‡((
j
 + 
Àn
) > 63) {

129 
	`memmove
(&
c⁄ãxt
->
buf„r
[
j
], 
d©a
, (
i
 = 64 - j));

130 
	`ldns_sha1_å™sf‹m
(
c⁄ãxt
->
°©e
, c⁄ãxt->
buf„r
);

131  ; 
i
 + 63 < 
Àn
; i += 64) {

132 
	`ldns_sha1_å™sf‹m
(
c⁄ãxt
->
°©e
, &
d©a
[
i
]);

134 
j
 = 0;

136 
i
 = 0;

137 
	`memmove
(&
c⁄ãxt
->
buf„r
[
j
], &
d©a
[
i
], 
Àn
 - i);

138 
	}
}

144 
	$ldns_sha1_föÆ
(
dige°
[
LDNS_SHA1_DIGEST_LENGTH
], 
ldns_sha1_˘x
 *
c⁄ãxt
)

146 
i
;

147 
föÆcou¡
[8];

149 
i
 = 0; i < 8; i++) {

150 
föÆcou¡
[
i
] = ()((
c⁄ãxt
->
cou¡
 >>

151 ((7 - (
i
 & 7)) * 8)) & 255);

153 
	`ldns_sha1_upd©e
(
c⁄ãxt
, (*)"\200", 1);

154 (
c⁄ãxt
->
cou¡
 & 504) != 448) {

155 
	`ldns_sha1_upd©e
(
c⁄ãxt
, (*)"\0", 1);

157 
	`ldns_sha1_upd©e
(
c⁄ãxt
, 
föÆcou¡
, 8);

159 i‡(
dige°
 !
NULL
)

160 
i
 = 0; i < 
LDNS_SHA1_DIGEST_LENGTH
; i++) {

161 
dige°
[
i
] = ()((
c⁄ãxt
->
°©e
[i >> 2] >>

162 ((3 - (
i
 & 3)) * 8)) & 255);

164 #ifde‡
SHA1HANDSOFF


165 
	`ldns_sha1_å™sf‹m
(
c⁄ãxt
->
°©e
, c⁄ãxt->
buf„r
);

167 
	}
}

170 
	$ldns_sha1
(*
d©a
, 
d©a_Àn
, *
dige°
)

172 
ldns_sha1_˘x
 
˘x
;

173 
	`ldns_sha1_öô
(&
˘x
);

174 
	`ldns_sha1_upd©e
(&
˘x
, 
d©a
, 
d©a_Àn
);

175 
	`ldns_sha1_föÆ
(
dige°
, &
˘x
);

176  
dige°
;

177 
	}
}

	@sha2.c

43 
	~<ldns/c⁄fig.h
>

44 
	~<°rög.h
>

45 
	~<as£π.h
>

46 
	~<ldns/sha2.h
>

97 #i‡!
deföed
(
BYTE_ORDER
Ë|| (BYTE_ORDER !
LITTLE_ENDIAN
 && BYTE_ORDER !
BIG_ENDIAN
)

98 #îr‹ 
Deföe
 
BYTE_ORDER
 
to
 
be
 
equÆ
Åÿ
eôhî
 
LITTLE_ENDIAN
 
‹
 
BIG_ENDIAN


101 
uöt8_t
 
	tsha2_byã
;

102 
uöt32_t
 
	tsha2_w‹d32
;

103 #ifde‡
S_SPLINT_S


104 
	tsha2_w‹d64
;

106 
uöt64_t
 
	tsha2_w‹d64
;

111 
	#ldns_sha256_SHORT_BLOCK_LENGTH
 (
LDNS_SHA256_BLOCK_LENGTH
 - 8)

	)

112 
	#ldns_sha384_SHORT_BLOCK_LENGTH
 (
LDNS_SHA384_BLOCK_LENGTH
 - 16)

	)

113 
	#ldns_sha512_SHORT_BLOCK_LENGTH
 (
LDNS_SHA512_BLOCK_LENGTH
 - 16)

	)

117 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


118 
	#REVERSE32
(
w
,
x
) { \

119 
sha2_w‹d32
 
tmp
 = (
w
); \

120 
tmp
 = (tmp >> 16) | (tmp << 16); \

121 (
x
Ë((
tmp
 & 0xff00ff00UL) >> 8) | ((tmp & 0x00ff00ffUL) << 8); \

122 }

	)

123 #i‚de‡
S_SPLINT_S


124 
	#REVERSE64
(
w
,
x
) { \

125 
sha2_w‹d64
 
tmp
 = (
w
); \

126 
tmp
 = (tmp >> 32) | (tmp << 32); \

127 
tmp
 = ((tmp & 0xff00ff00ff00ff00ULL) >> 8) | \

128 ((
tmp
 & 0x00ff00ff00ff00ffULL) << 8); \

129 (
x
Ë((
tmp
 & 0xffff0000ffff0000ULL) >> 16) | \

130 ((
tmp
 & 0x0000ffff0000ffffULL) << 16); \

131 }

	)

133 
	#REVERSE64
(
w
,
x
Ë

	)

142 
	#ADDINC128
(
w
,
n
) { \

143 (
w
)[0] +(
sha2_w‹d64
)(
n
); \

144 i‡((
w
)[0] < (
n
)) { \

145 (
w
)[1]++; \

147 }

	)

148 #ifde‡
S_SPLINT_S


149 #unde‡
ADDINC128


150 
	#ADDINC128
(
w
,
n
Ë

	)

162 #i‡!
deföed
(
SHA2_USE_MEMSET_MEMCPY
Ë&& !deföed(
SHA2_USE_BZERO_BCOPY
)

164 
	#SHA2_USE_MEMSET_MEMCPY
 1

	)

166 #i‡
deföed
(
SHA2_USE_MEMSET_MEMCPY
Ë&& deföed(
SHA2_USE_BZERO_BCOPY
)

168 #îr‹ 
Deföe
 
eôhî
 
SHA2_USE_MEMSET_MEMCPY
 
‹
 
SHA2_USE_BZERO_BCOPY
, 
nŸ
 
bŸh
!

171 #ifde‡
SHA2_USE_MEMSET_MEMCPY


172 
	#MEMSET_BZERO
(
p
,
l
Ë
	`mem£t
(’), 0, (l))

	)

173 
	#MEMCPY_BCOPY
(
d
,
s
,
l
Ë
	`mem˝y
((d), (s), (l))

	)

175 #ifde‡
SHA2_USE_BZERO_BCOPY


176 
	#MEMSET_BZERO
(
p
,
l
Ë
	`bzîo
(’), (l))

	)

177 
	#MEMCPY_BCOPY
(
d
,
s
,
l
Ë
	`bc›y
((s), (d), (l))

	)

191 
	#R
(
b
,
x
Ë((xË>> (b))

	)

193 
	#S32
(
b
,
x
Ë(((xË>> (b)Ë| ((xË<< (32 - (b))))

	)

195 
	#S64
(
b
,
x
Ë(((xË>> (b)Ë| ((xË<< (64 - (b))))

	)

198 
	#Ch
(
x
,
y
,
z
Ë(((xË& (y)Ë^ ((~(x)Ë& (z)))

	)

199 
	#Maj
(
x
,
y
,
z
Ë(((xË& (y)Ë^ ((xË& (z)Ë^ ((yË& (z)))

	)

202 
	#Sigma0_256
(
x
Ë(
	`S32
(2, (x)Ë^ S32(13, (x)Ë^ S32(22, (x)))

	)

203 
	#Sigma1_256
(
x
Ë(
	`S32
(6, (x)Ë^ S32(11, (x)Ë^ S32(25, (x)))

	)

204 
	#sigma0_256
(
x
Ë(
	`S32
(7, (x)Ë^ S32(18, (x)Ë^ 
	`R
(3 , (x)))

	)

205 
	#sigma1_256
(
x
Ë(
	`S32
(17, (x)Ë^ S32(19, (x)Ë^ 
	`R
(10, (x)))

	)

208 
	#Sigma0_512
(
x
Ë(
	`S64
(28, (x)Ë^ S64(34, (x)Ë^ S64(39, (x)))

	)

209 
	#Sigma1_512
(
x
Ë(
	`S64
(14, (x)Ë^ S64(18, (x)Ë^ S64(41, (x)))

	)

210 
	#sigma0_512
(
x
Ë(
	`S64
–1, (x)Ë^ S64–8, (x)Ë^ 
	`R
–7, (x)))

	)

211 
	#sigma1_512
(
x
Ë(
	`S64
(19, (x)Ë^ S64(61, (x)Ë^ 
	`R
–6, (x)))

	)

215 c⁄° 
sha2_w‹d32
 
	gK256
[64] = {

235 c⁄° 
sha2_w‹d32
 
	gldns_sha256_öôül_hash_vÆue
[8] = {

247 c⁄° 
sha2_w‹d64
 
	gK512
[80] = {

291 c⁄° 
sha2_w‹d64
 
	gsha384_öôül_hash_vÆue
[8] = {

303 c⁄° 
sha2_w‹d64
 
	gsha512_öôül_hash_vÆue
[8] = {

315 
	$ldns_sha256_öô
(
ldns_sha256_CTX
* 
c⁄ãxt
) {

316 i‡(
c⁄ãxt
 =(
ldns_sha256_CTX
*)0) {

319 
	`MEMCPY_BCOPY
(
c⁄ãxt
->
°©e
, 
ldns_sha256_öôül_hash_vÆue
, 
LDNS_SHA256_DIGEST_LENGTH
);

320 
	`MEMSET_BZERO
(
c⁄ãxt
->
buf„r
, 
LDNS_SHA256_BLOCK_LENGTH
);

321 
c⁄ãxt
->
bôcou¡
 = 0;

322 
	}
}

324 #ifde‡
SHA2_UNROLL_TRANSFORM


328 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


330 
	#ROUND256_0_TO_15
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
) \

331 
	`REVERSE32
(*
d©a
++, 
W256
[
j
]); \

332 
T1
 = (
h
Ë+ 
	`Sigma1_256
(
e
Ë+ 
	`Ch
(”), (
f
), (
g
)) + \

333 
K256
[
j
] + 
W256
[j]; \

334 (
d
Ë+
T1
; \

335 (
h
Ë
T1
 + 
	`Sigma0_256
(
a
Ë+ 
	`Maj
(◊), (
b
), (
c
)); \

336 
j
++

	)

341 
	#ROUND256_0_TO_15
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
) \

342 
T1
 = (
h
Ë+ 
	`Sigma1_256
(
e
Ë+ 
	`Ch
(”), (
f
), (
g
)) + \

343 
K256
[
j
] + (
W256
[j] = *
d©a
++); \

344 (
d
Ë+
T1
; \

345 (
h
Ë
T1
 + 
	`Sigma0_256
(
a
Ë+ 
	`Maj
(◊), (
b
), (
c
)); \

346 
j
++

	)

350 
	#ROUND256
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
) \

351 
s0
 = 
W256
[(
j
+1)&0x0f]; \

352 
s0
 = 
	`sigma0_256
(s0); \

353 
s1
 = 
W256
[(
j
+14)&0x0f]; \

354 
s1
 = 
	`sigma1_256
(s1); \

355 
T1
 = (
h
Ë+ 
	`Sigma1_256
(
e
Ë+ 
	`Ch
(”), (
f
), (
g
)Ë+ 
K256
[
j
] + \

356 (
W256
[
j
&0x0f] +
s1
 + W256[(j+9)&0x0f] + 
s0
); \

357 (
d
Ë+
T1
; \

358 (
h
Ë
T1
 + 
	`Sigma0_256
(
a
Ë+ 
	`Maj
(◊), (
b
), (
c
)); \

359 
j
++

	)

361 
	$ldns_sha256_Tønsf‹m
(
ldns_sha256_CTX
* 
c⁄ãxt
,

362 c⁄° 
sha2_w‹d32
* 
d©a
) {

363 
sha2_w‹d32
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
s0
, 
s1
;

364 
sha2_w‹d32
 
T1
, *
W256
;

365 
j
;

367 
W256
 = (
sha2_w‹d32
*)
c⁄ãxt
->
buf„r
;

370 
a
 = 
c⁄ãxt
->
°©e
[0];

371 
b
 = 
c⁄ãxt
->
°©e
[1];

372 
c
 = 
c⁄ãxt
->
°©e
[2];

373 
d
 = 
c⁄ãxt
->
°©e
[3];

374 
e
 = 
c⁄ãxt
->
°©e
[4];

375 
f
 = 
c⁄ãxt
->
°©e
[5];

376 
g
 = 
c⁄ãxt
->
°©e
[6];

377 
h
 = 
c⁄ãxt
->
°©e
[7];

379 
j
 = 0;

382 
	`ROUND256_0_TO_15
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
);

383 
	`ROUND256_0_TO_15
(
h
,
a
,
b
,
c
,
d
,
e
,
f
,
g
);

384 
	`ROUND256_0_TO_15
(
g
,
h
,
a
,
b
,
c
,
d
,
e
,
f
);

385 
	`ROUND256_0_TO_15
(
f
,
g
,
h
,
a
,
b
,
c
,
d
,
e
);

386 
	`ROUND256_0_TO_15
(
e
,
f
,
g
,
h
,
a
,
b
,
c
,
d
);

387 
	`ROUND256_0_TO_15
(
d
,
e
,
f
,
g
,
h
,
a
,
b
,
c
);

388 
	`ROUND256_0_TO_15
(
c
,
d
,
e
,
f
,
g
,
h
,
a
,
b
);

389 
	`ROUND256_0_TO_15
(
b
,
c
,
d
,
e
,
f
,
g
,
h
,
a
);

390 } 
j
 < 16);

394 
	`ROUND256
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
);

395 
	`ROUND256
(
h
,
a
,
b
,
c
,
d
,
e
,
f
,
g
);

396 
	`ROUND256
(
g
,
h
,
a
,
b
,
c
,
d
,
e
,
f
);

397 
	`ROUND256
(
f
,
g
,
h
,
a
,
b
,
c
,
d
,
e
);

398 
	`ROUND256
(
e
,
f
,
g
,
h
,
a
,
b
,
c
,
d
);

399 
	`ROUND256
(
d
,
e
,
f
,
g
,
h
,
a
,
b
,
c
);

400 
	`ROUND256
(
c
,
d
,
e
,
f
,
g
,
h
,
a
,
b
);

401 
	`ROUND256
(
b
,
c
,
d
,
e
,
f
,
g
,
h
,
a
);

402 } 
j
 < 64);

405 
c⁄ãxt
->
°©e
[0] +
a
;

406 
c⁄ãxt
->
°©e
[1] +
b
;

407 
c⁄ãxt
->
°©e
[2] +
c
;

408 
c⁄ãxt
->
°©e
[3] +
d
;

409 
c⁄ãxt
->
°©e
[4] +
e
;

410 
c⁄ãxt
->
°©e
[5] +
f
;

411 
c⁄ãxt
->
°©e
[6] +
g
;

412 
c⁄ãxt
->
°©e
[7] +
h
;

415 
a
 = 
b
 = 
c
 = 
d
 = 
e
 = 
f
 = 
g
 = 
h
 = 
T1
 = 0;

416 
	}
}

420 
	$ldns_sha256_Tønsf‹m
(
ldns_sha256_CTX
* 
c⁄ãxt
,

421 c⁄° 
sha2_w‹d32
* 
d©a
) {

422 
sha2_w‹d32
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
s0
, 
s1
;

423 
sha2_w‹d32
 
T1
, 
T2
, *
W256
;

424 
j
;

426 
W256
 = (
sha2_w‹d32
*)
c⁄ãxt
->
buf„r
;

429 
a
 = 
c⁄ãxt
->
°©e
[0];

430 
b
 = 
c⁄ãxt
->
°©e
[1];

431 
c
 = 
c⁄ãxt
->
°©e
[2];

432 
d
 = 
c⁄ãxt
->
°©e
[3];

433 
e
 = 
c⁄ãxt
->
°©e
[4];

434 
f
 = 
c⁄ãxt
->
°©e
[5];

435 
g
 = 
c⁄ãxt
->
°©e
[6];

436 
h
 = 
c⁄ãxt
->
°©e
[7];

438 
j
 = 0;

440 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


442 
	`REVERSE32
(*
d©a
++,
W256
[
j
]);

444 
T1
 = 
h
 + 
	`Sigma1_256
(
e
Ë+ 
	`Ch
”, 
f
, 
g
Ë+ 
K256
[
j
] + 
W256
[j];

447 
T1
 = 
h
 + 
	`Sigma1_256
(
e
Ë+ 
	`Ch
”, 
f
, 
g
Ë+ 
K256
[
j
] + (
W256
[j] = *
d©a
++);

449 
T2
 = 
	`Sigma0_256
(
a
Ë+ 
	`Maj
◊, 
b
, 
c
);

450 
h
 = 
g
;

451 
g
 = 
f
;

452 
f
 = 
e
;

453 
e
 = 
d
 + 
T1
;

454 
d
 = 
c
;

455 
c
 = 
b
;

456 
b
 = 
a
;

457 
a
 = 
T1
 + 
T2
;

459 
j
++;

460 } 
j
 < 16);

464 
s0
 = 
W256
[(
j
+1)&0x0f];

465 
s0
 = 
	`sigma0_256
(s0);

466 
s1
 = 
W256
[(
j
+14)&0x0f];

467 
s1
 = 
	`sigma1_256
(s1);

470 
T1
 = 
h
 + 
	`Sigma1_256
(
e
Ë+ 
	`Ch
”, 
f
, 
g
Ë+ 
K256
[
j
] +

471 (
W256
[
j
&0x0f] +
s1
 + W256[(j+9)&0x0f] + 
s0
);

472 
T2
 = 
	`Sigma0_256
(
a
Ë+ 
	`Maj
◊, 
b
, 
c
);

473 
h
 = 
g
;

474 
g
 = 
f
;

475 
f
 = 
e
;

476 
e
 = 
d
 + 
T1
;

477 
d
 = 
c
;

478 
c
 = 
b
;

479 
b
 = 
a
;

480 
a
 = 
T1
 + 
T2
;

482 
j
++;

483 } 
j
 < 64);

486 
c⁄ãxt
->
°©e
[0] +
a
;

487 
c⁄ãxt
->
°©e
[1] +
b
;

488 
c⁄ãxt
->
°©e
[2] +
c
;

489 
c⁄ãxt
->
°©e
[3] +
d
;

490 
c⁄ãxt
->
°©e
[4] +
e
;

491 
c⁄ãxt
->
°©e
[5] +
f
;

492 
c⁄ãxt
->
°©e
[6] +
g
;

493 
c⁄ãxt
->
°©e
[7] +
h
;

496 
a
 = 
b
 = 
c
 = 
d
 = 
e
 = 
f
 = 
g
 = 
h
 = 
T1
 = 
T2
 = 0;

497 
	}
}

501 
	$ldns_sha256_upd©e
(
ldns_sha256_CTX
* 
c⁄ãxt
, c⁄° 
sha2_byã
 *
d©a
, 
size_t
 
Àn
) {

502 
size_t
 
‰ì•a˚
, 
u£d•a˚
;

504 i‡(
Àn
 == 0) {

510 
	`as£π
(
c⁄ãxt
 !(
ldns_sha256_CTX
*)0 && 
d©a
 !(
sha2_byã
*)0);

512 
u£d•a˚
 = (
c⁄ãxt
->
bôcou¡
 >> 3Ë% 
LDNS_SHA256_BLOCK_LENGTH
;

513 i‡(
u£d•a˚
 > 0) {

515 
‰ì•a˚
 = 
LDNS_SHA256_BLOCK_LENGTH
 - 
u£d•a˚
;

517 i‡(
Àn
 >
‰ì•a˚
) {

519 
	`MEMCPY_BCOPY
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
d©a
, 
‰ì•a˚
);

520 
c⁄ãxt
->
bôcou¡
 +
‰ì•a˚
 << 3;

521 
Àn
 -
‰ì•a˚
;

522 
d©a
 +
‰ì•a˚
;

523 
	`ldns_sha256_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d32
*)c⁄ãxt->
buf„r
);

526 
	`MEMCPY_BCOPY
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
d©a
, 
Àn
);

527 
c⁄ãxt
->
bôcou¡
 +
Àn
 << 3;

529 
u£d•a˚
 = 
‰ì•a˚
 = 0;

533 
Àn
 >
LDNS_SHA256_BLOCK_LENGTH
) {

535 
	`ldns_sha256_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d32
*)
d©a
);

536 
c⁄ãxt
->
bôcou¡
 +
LDNS_SHA256_BLOCK_LENGTH
 << 3;

537 
Àn
 -
LDNS_SHA256_BLOCK_LENGTH
;

538 
d©a
 +
LDNS_SHA256_BLOCK_LENGTH
;

540 i‡(
Àn
 > 0) {

542 
	`MEMCPY_BCOPY
(
c⁄ãxt
->
buf„r
, 
d©a
, 
Àn
);

543 
c⁄ãxt
->
bôcou¡
 +
Àn
 << 3;

546 
u£d•a˚
 = 
‰ì•a˚
 = 0;

547 
	}
}

549 
	u_ldns_sha2_buf„r_uni⁄
 {

550 
uöt8_t
* 
	mtheCh¨s
;

551 
uöt64_t
* 
	mtheL⁄gs
;

552 } 
	tldns_sha2_buf„r_uni⁄
;

554 
	$ldns_sha256_föÆ
(
sha2_byã
 
dige°
[], 
ldns_sha256_CTX
* 
c⁄ãxt
) {

555 
sha2_w‹d32
 *
d
 = (sha2_w‹d32*)
dige°
;

556 
size_t
 
u£d•a˚
;

557 
ldns_sha2_buf„r_uni⁄
 
ˇ°_v¨
;

560 
	`as£π
(
c⁄ãxt
 !(
ldns_sha256_CTX
*)0);

563 i‡(
dige°
 !(
sha2_byã
*)0) {

564 
u£d•a˚
 = (
c⁄ãxt
->
bôcou¡
 >> 3Ë% 
LDNS_SHA256_BLOCK_LENGTH
;

565 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


567 
	`REVERSE64
(
c⁄ãxt
->
bôcou¡
,context->bitcount);

569 i‡(
u£d•a˚
 > 0) {

571 
c⁄ãxt
->
buf„r
[
u£d•a˚
++] = 0x80;

573 i‡(
u£d•a˚
 <
ldns_sha256_SHORT_BLOCK_LENGTH
) {

575 
	`MEMSET_BZERO
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
ldns_sha256_SHORT_BLOCK_LENGTH
 - usedspace);

577 i‡(
u£d•a˚
 < 
LDNS_SHA256_BLOCK_LENGTH
) {

578 
	`MEMSET_BZERO
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
LDNS_SHA256_BLOCK_LENGTH
 - usedspace);

581 
	`ldns_sha256_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d32
*)c⁄ãxt->
buf„r
);

584 
	`MEMSET_BZERO
(
c⁄ãxt
->
buf„r
, 
ldns_sha256_SHORT_BLOCK_LENGTH
);

588 
	`MEMSET_BZERO
(
c⁄ãxt
->
buf„r
, 
ldns_sha256_SHORT_BLOCK_LENGTH
);

591 *
c⁄ãxt
->
buf„r
 = 0x80;

594 
ˇ°_v¨
.
theCh¨s
 = 
c⁄ãxt
->
buf„r
;

595 
ˇ°_v¨
.
theL⁄gs
[
ldns_sha256_SHORT_BLOCK_LENGTH
 / 8] = 
c⁄ãxt
->
bôcou¡
;

598 
	`ldns_sha256_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d32
*)c⁄ãxt->
buf„r
);

600 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


603 
j
;

604 
j
 = 0; j < 8; j++) {

605 
	`REVERSE32
(
c⁄ãxt
->
°©e
[
j
],context->state[j]);

606 *
d
++ = 
c⁄ãxt
->
°©e
[
j
];

610 
	`MEMCPY_BCOPY
(
d
, 
c⁄ãxt
->
°©e
, 
LDNS_SHA256_DIGEST_LENGTH
);

615 
	`MEMSET_BZERO
(
c⁄ãxt
, (
ldns_sha256_CTX
));

616 
u£d•a˚
 = 0;

617 
	}
}

620 
	$ldns_sha256
(*
d©a
, 
d©a_Àn
, *
dige°
)

622 
ldns_sha256_CTX
 
˘x
;

623 
	`ldns_sha256_öô
(&
˘x
);

624 
	`ldns_sha256_upd©e
(&
˘x
, 
d©a
, 
d©a_Àn
);

625 
	`ldns_sha256_föÆ
(
dige°
, &
˘x
);

626  
dige°
;

627 
	}
}

630 
	$ldns_sha512_öô
(
ldns_sha512_CTX
* 
c⁄ãxt
) {

631 i‡(
c⁄ãxt
 =(
ldns_sha512_CTX
*)0) {

634 
	`MEMCPY_BCOPY
(
c⁄ãxt
->
°©e
, 
sha512_öôül_hash_vÆue
, 
LDNS_SHA512_DIGEST_LENGTH
);

635 
	`MEMSET_BZERO
(
c⁄ãxt
->
buf„r
, 
LDNS_SHA512_BLOCK_LENGTH
);

636 
c⁄ãxt
->
bôcou¡
[0] = context->bitcount[1] = 0;

637 
	}
}

639 #ifde‡
SHA2_UNROLL_TRANSFORM


642 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


644 
	#ROUND512_0_TO_15
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
) \

645 
	`REVERSE64
(*
d©a
++, 
W512
[
j
]); \

646 
T1
 = (
h
Ë+ 
	`Sigma1_512
(
e
Ë+ 
	`Ch
(”), (
f
), (
g
)) + \

647 
K512
[
j
] + 
W512
[j]; \

648 (
d
Ë+
T1
, \

649 (
h
Ë
T1
 + 
	`Sigma0_512
(
a
Ë+ 
	`Maj
(◊), (
b
), (
c
)), \

650 
j
++

	)

655 
	#ROUND512_0_TO_15
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
) \

656 
T1
 = (
h
Ë+ 
	`Sigma1_512
(
e
Ë+ 
	`Ch
(”), (
f
), (
g
)) + \

657 
K512
[
j
] + (
W512
[j] = *
d©a
++); \

658 (
d
Ë+
T1
; \

659 (
h
Ë
T1
 + 
	`Sigma0_512
(
a
Ë+ 
	`Maj
(◊), (
b
), (
c
)); \

660 
j
++

	)

664 
	#ROUND512
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
) \

665 
s0
 = 
W512
[(
j
+1)&0x0f]; \

666 
s0
 = 
	`sigma0_512
(s0); \

667 
s1
 = 
W512
[(
j
+14)&0x0f]; \

668 
s1
 = 
	`sigma1_512
(s1); \

669 
T1
 = (
h
Ë+ 
	`Sigma1_512
(
e
Ë+ 
	`Ch
(”), (
f
), (
g
)Ë+ 
K512
[
j
] + \

670 (
W512
[
j
&0x0f] +
s1
 + W512[(j+9)&0x0f] + 
s0
); \

671 (
d
Ë+
T1
; \

672 (
h
Ë
T1
 + 
	`Sigma0_512
(
a
Ë+ 
	`Maj
(◊), (
b
), (
c
)); \

673 
j
++

	)

675 
	$ldns_sha512_Tønsf‹m
(
ldns_sha512_CTX
* 
c⁄ãxt
,

676 c⁄° 
sha2_w‹d64
* 
d©a
) {

677 
sha2_w‹d64
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
s0
, 
s1
;

678 
sha2_w‹d64
 
T1
, *
W512
 = (sha2_w‹d64*)
c⁄ãxt
->
buf„r
;

679 
j
;

682 
a
 = 
c⁄ãxt
->
°©e
[0];

683 
b
 = 
c⁄ãxt
->
°©e
[1];

684 
c
 = 
c⁄ãxt
->
°©e
[2];

685 
d
 = 
c⁄ãxt
->
°©e
[3];

686 
e
 = 
c⁄ãxt
->
°©e
[4];

687 
f
 = 
c⁄ãxt
->
°©e
[5];

688 
g
 = 
c⁄ãxt
->
°©e
[6];

689 
h
 = 
c⁄ãxt
->
°©e
[7];

691 
j
 = 0;

693 
	`ROUND512_0_TO_15
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
);

694 
	`ROUND512_0_TO_15
(
h
,
a
,
b
,
c
,
d
,
e
,
f
,
g
);

695 
	`ROUND512_0_TO_15
(
g
,
h
,
a
,
b
,
c
,
d
,
e
,
f
);

696 
	`ROUND512_0_TO_15
(
f
,
g
,
h
,
a
,
b
,
c
,
d
,
e
);

697 
	`ROUND512_0_TO_15
(
e
,
f
,
g
,
h
,
a
,
b
,
c
,
d
);

698 
	`ROUND512_0_TO_15
(
d
,
e
,
f
,
g
,
h
,
a
,
b
,
c
);

699 
	`ROUND512_0_TO_15
(
c
,
d
,
e
,
f
,
g
,
h
,
a
,
b
);

700 
	`ROUND512_0_TO_15
(
b
,
c
,
d
,
e
,
f
,
g
,
h
,
a
);

701 } 
j
 < 16);

705 
	`ROUND512
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
);

706 
	`ROUND512
(
h
,
a
,
b
,
c
,
d
,
e
,
f
,
g
);

707 
	`ROUND512
(
g
,
h
,
a
,
b
,
c
,
d
,
e
,
f
);

708 
	`ROUND512
(
f
,
g
,
h
,
a
,
b
,
c
,
d
,
e
);

709 
	`ROUND512
(
e
,
f
,
g
,
h
,
a
,
b
,
c
,
d
);

710 
	`ROUND512
(
d
,
e
,
f
,
g
,
h
,
a
,
b
,
c
);

711 
	`ROUND512
(
c
,
d
,
e
,
f
,
g
,
h
,
a
,
b
);

712 
	`ROUND512
(
b
,
c
,
d
,
e
,
f
,
g
,
h
,
a
);

713 } 
j
 < 80);

716 
c⁄ãxt
->
°©e
[0] +
a
;

717 
c⁄ãxt
->
°©e
[1] +
b
;

718 
c⁄ãxt
->
°©e
[2] +
c
;

719 
c⁄ãxt
->
°©e
[3] +
d
;

720 
c⁄ãxt
->
°©e
[4] +
e
;

721 
c⁄ãxt
->
°©e
[5] +
f
;

722 
c⁄ãxt
->
°©e
[6] +
g
;

723 
c⁄ãxt
->
°©e
[7] +
h
;

726 
a
 = 
b
 = 
c
 = 
d
 = 
e
 = 
f
 = 
g
 = 
h
 = 
T1
 = 0;

727 
	}
}

731 
	$ldns_sha512_Tønsf‹m
(
ldns_sha512_CTX
* 
c⁄ãxt
,

732 c⁄° 
sha2_w‹d64
* 
d©a
) {

733 
sha2_w‹d64
 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
s0
, 
s1
;

734 
sha2_w‹d64
 
T1
, 
T2
, *
W512
 = (sha2_w‹d64*)
c⁄ãxt
->
buf„r
;

735 
j
;

738 
a
 = 
c⁄ãxt
->
°©e
[0];

739 
b
 = 
c⁄ãxt
->
°©e
[1];

740 
c
 = 
c⁄ãxt
->
°©e
[2];

741 
d
 = 
c⁄ãxt
->
°©e
[3];

742 
e
 = 
c⁄ãxt
->
°©e
[4];

743 
f
 = 
c⁄ãxt
->
°©e
[5];

744 
g
 = 
c⁄ãxt
->
°©e
[6];

745 
h
 = 
c⁄ãxt
->
°©e
[7];

747 
j
 = 0;

749 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


751 
	`REVERSE64
(*
d©a
++, 
W512
[
j
]);

753 
T1
 = 
h
 + 
	`Sigma1_512
(
e
Ë+ 
	`Ch
”, 
f
, 
g
Ë+ 
K512
[
j
] + 
W512
[j];

756 
T1
 = 
h
 + 
	`Sigma1_512
(
e
Ë+ 
	`Ch
”, 
f
, 
g
Ë+ 
K512
[
j
] + (
W512
[j] = *
d©a
++);

758 
T2
 = 
	`Sigma0_512
(
a
Ë+ 
	`Maj
◊, 
b
, 
c
);

759 
h
 = 
g
;

760 
g
 = 
f
;

761 
f
 = 
e
;

762 
e
 = 
d
 + 
T1
;

763 
d
 = 
c
;

764 
c
 = 
b
;

765 
b
 = 
a
;

766 
a
 = 
T1
 + 
T2
;

768 
j
++;

769 } 
j
 < 16);

773 
s0
 = 
W512
[(
j
+1)&0x0f];

774 
s0
 = 
	`sigma0_512
(s0);

775 
s1
 = 
W512
[(
j
+14)&0x0f];

776 
s1
 = 
	`sigma1_512
(s1);

779 
T1
 = 
h
 + 
	`Sigma1_512
(
e
Ë+ 
	`Ch
”, 
f
, 
g
Ë+ 
K512
[
j
] +

780 (
W512
[
j
&0x0f] +
s1
 + W512[(j+9)&0x0f] + 
s0
);

781 
T2
 = 
	`Sigma0_512
(
a
Ë+ 
	`Maj
◊, 
b
, 
c
);

782 
h
 = 
g
;

783 
g
 = 
f
;

784 
f
 = 
e
;

785 
e
 = 
d
 + 
T1
;

786 
d
 = 
c
;

787 
c
 = 
b
;

788 
b
 = 
a
;

789 
a
 = 
T1
 + 
T2
;

791 
j
++;

792 } 
j
 < 80);

795 
c⁄ãxt
->
°©e
[0] +
a
;

796 
c⁄ãxt
->
°©e
[1] +
b
;

797 
c⁄ãxt
->
°©e
[2] +
c
;

798 
c⁄ãxt
->
°©e
[3] +
d
;

799 
c⁄ãxt
->
°©e
[4] +
e
;

800 
c⁄ãxt
->
°©e
[5] +
f
;

801 
c⁄ãxt
->
°©e
[6] +
g
;

802 
c⁄ãxt
->
°©e
[7] +
h
;

805 
a
 = 
b
 = 
c
 = 
d
 = 
e
 = 
f
 = 
g
 = 
h
 = 
T1
 = 
T2
 = 0;

806 
	}
}

810 
	$ldns_sha512_upd©e
(
ldns_sha512_CTX
* 
c⁄ãxt
, c⁄° 
sha2_byã
 *
d©a
, 
size_t
 
Àn
) {

811 
size_t
 
‰ì•a˚
, 
u£d•a˚
;

813 i‡(
Àn
 == 0) {

819 
	`as£π
(
c⁄ãxt
 !(
ldns_sha512_CTX
*)0 && 
d©a
 !(
sha2_byã
*)0);

821 
u£d•a˚
 = (
c⁄ãxt
->
bôcou¡
[0] >> 3Ë% 
LDNS_SHA512_BLOCK_LENGTH
;

822 i‡(
u£d•a˚
 > 0) {

824 
‰ì•a˚
 = 
LDNS_SHA512_BLOCK_LENGTH
 - 
u£d•a˚
;

826 i‡(
Àn
 >
‰ì•a˚
) {

828 
	`MEMCPY_BCOPY
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
d©a
, 
‰ì•a˚
);

829 
	`ADDINC128
(
c⁄ãxt
->
bôcou¡
, 
‰ì•a˚
 << 3);

830 
Àn
 -
‰ì•a˚
;

831 
d©a
 +
‰ì•a˚
;

832 
	`ldns_sha512_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d64
*)c⁄ãxt->
buf„r
);

835 
	`MEMCPY_BCOPY
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
d©a
, 
Àn
);

836 
	`ADDINC128
(
c⁄ãxt
->
bôcou¡
, 
Àn
 << 3);

838 
u£d•a˚
 = 
‰ì•a˚
 = 0;

842 
Àn
 >
LDNS_SHA512_BLOCK_LENGTH
) {

844 
	`ldns_sha512_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d64
*)
d©a
);

845 
	`ADDINC128
(
c⁄ãxt
->
bôcou¡
, 
LDNS_SHA512_BLOCK_LENGTH
 << 3);

846 
Àn
 -
LDNS_SHA512_BLOCK_LENGTH
;

847 
d©a
 +
LDNS_SHA512_BLOCK_LENGTH
;

849 i‡(
Àn
 > 0) {

851 
	`MEMCPY_BCOPY
(
c⁄ãxt
->
buf„r
, 
d©a
, 
Àn
);

852 
	`ADDINC128
(
c⁄ãxt
->
bôcou¡
, 
Àn
 << 3);

855 
u£d•a˚
 = 
‰ì•a˚
 = 0;

856 
	}
}

858 
	$ldns_sha512_La°
(
ldns_sha512_CTX
* 
c⁄ãxt
) {

859 
size_t
 
u£d•a˚
;

860 
ldns_sha2_buf„r_uni⁄
 
ˇ°_v¨
;

862 
u£d•a˚
 = (
c⁄ãxt
->
bôcou¡
[0] >> 3Ë% 
LDNS_SHA512_BLOCK_LENGTH
;

863 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


865 
	`REVERSE64
(
c⁄ãxt
->
bôcou¡
[0],context->bitcount[0]);

866 
	`REVERSE64
(
c⁄ãxt
->
bôcou¡
[1],context->bitcount[1]);

868 i‡(
u£d•a˚
 > 0) {

870 
c⁄ãxt
->
buf„r
[
u£d•a˚
++] = 0x80;

872 i‡(
u£d•a˚
 <
ldns_sha512_SHORT_BLOCK_LENGTH
) {

874 
	`MEMSET_BZERO
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
ldns_sha512_SHORT_BLOCK_LENGTH
 - usedspace);

876 i‡(
u£d•a˚
 < 
LDNS_SHA512_BLOCK_LENGTH
) {

877 
	`MEMSET_BZERO
(&
c⁄ãxt
->
buf„r
[
u£d•a˚
], 
LDNS_SHA512_BLOCK_LENGTH
 - usedspace);

880 
	`ldns_sha512_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d64
*)c⁄ãxt->
buf„r
);

883 
	`MEMSET_BZERO
(
c⁄ãxt
->
buf„r
, 
LDNS_SHA512_BLOCK_LENGTH
 - 2);

887 
	`MEMSET_BZERO
(
c⁄ãxt
->
buf„r
, 
ldns_sha512_SHORT_BLOCK_LENGTH
);

890 *
c⁄ãxt
->
buf„r
 = 0x80;

893 
ˇ°_v¨
.
theCh¨s
 = 
c⁄ãxt
->
buf„r
;

894 
ˇ°_v¨
.
theL⁄gs
[
ldns_sha512_SHORT_BLOCK_LENGTH
 / 8] = 
c⁄ãxt
->
bôcou¡
[1];

895 
ˇ°_v¨
.
theL⁄gs
[
ldns_sha512_SHORT_BLOCK_LENGTH
 / 8 + 1] = 
c⁄ãxt
->
bôcou¡
[0];

898 
	`ldns_sha512_Tønsf‹m
(
c⁄ãxt
, (
sha2_w‹d64
*)c⁄ãxt->
buf„r
);

899 
	}
}

901 
	$ldns_sha512_föÆ
(
sha2_byã
 
dige°
[], 
ldns_sha512_CTX
* 
c⁄ãxt
) {

902 
sha2_w‹d64
 *
d
 = (sha2_w‹d64*)
dige°
;

905 
	`as£π
(
c⁄ãxt
 !(
ldns_sha512_CTX
*)0);

908 i‡(
dige°
 !(
sha2_byã
*)0) {

909 
	`ldns_sha512_La°
(
c⁄ãxt
);

912 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


915 
j
;

916 
j
 = 0; j < 8; j++) {

917 
	`REVERSE64
(
c⁄ãxt
->
°©e
[
j
],context->state[j]);

918 *
d
++ = 
c⁄ãxt
->
°©e
[
j
];

922 
	`MEMCPY_BCOPY
(
d
, 
c⁄ãxt
->
°©e
, 
LDNS_SHA512_DIGEST_LENGTH
);

927 
	`MEMSET_BZERO
(
c⁄ãxt
, (
ldns_sha512_CTX
));

928 
	}
}

931 
	$ldns_sha512
(*
d©a
, 
d©a_Àn
, *
dige°
)

933 
ldns_sha512_CTX
 
˘x
;

934 
	`ldns_sha512_öô
(&
˘x
);

935 
	`ldns_sha512_upd©e
(&
˘x
, 
d©a
, 
d©a_Àn
);

936 
	`ldns_sha512_föÆ
(
dige°
, &
˘x
);

937  
dige°
;

938 
	}
}

941 
	$ldns_sha384_öô
(
ldns_sha384_CTX
* 
c⁄ãxt
) {

942 i‡(
c⁄ãxt
 =(
ldns_sha384_CTX
*)0) {

945 
	`MEMCPY_BCOPY
(
c⁄ãxt
->
°©e
, 
sha384_öôül_hash_vÆue
, 
LDNS_SHA512_DIGEST_LENGTH
);

946 
	`MEMSET_BZERO
(
c⁄ãxt
->
buf„r
, 
LDNS_SHA384_BLOCK_LENGTH
);

947 
c⁄ãxt
->
bôcou¡
[0] = context->bitcount[1] = 0;

948 
	}
}

950 
	$ldns_sha384_upd©e
(
ldns_sha384_CTX
* 
c⁄ãxt
, c⁄° 
sha2_byã
* 
d©a
, 
size_t
 
Àn
) {

951 
	`ldns_sha512_upd©e
((
ldns_sha512_CTX
*)
c⁄ãxt
, 
d©a
, 
Àn
);

952 
	}
}

954 
	$ldns_sha384_föÆ
(
sha2_byã
 
dige°
[], 
ldns_sha384_CTX
* 
c⁄ãxt
) {

955 
sha2_w‹d64
 *
d
 = (sha2_w‹d64*)
dige°
;

958 
	`as£π
(
c⁄ãxt
 !(
ldns_sha384_CTX
*)0);

961 i‡(
dige°
 !(
sha2_byã
*)0) {

962 
	`ldns_sha512_La°
((
ldns_sha512_CTX
*)
c⁄ãxt
);

965 #i‡
BYTE_ORDER
 =
LITTLE_ENDIAN


968 
j
;

969 
j
 = 0; j < 6; j++) {

970 
	`REVERSE64
(
c⁄ãxt
->
°©e
[
j
],context->state[j]);

971 *
d
++ = 
c⁄ãxt
->
°©e
[
j
];

975 
	`MEMCPY_BCOPY
(
d
, 
c⁄ãxt
->
°©e
, 
LDNS_SHA384_DIGEST_LENGTH
);

980 
	`MEMSET_BZERO
(
c⁄ãxt
, (
ldns_sha384_CTX
));

981 
	}
}

984 
	$ldns_sha384
(*
d©a
, 
d©a_Àn
, *
dige°
)

986 
ldns_sha384_CTX
 
˘x
;

987 
	`ldns_sha384_öô
(&
˘x
);

988 
	`ldns_sha384_upd©e
(&
˘x
, 
d©a
, 
d©a_Àn
);

989 
	`ldns_sha384_föÆ
(
dige°
, &
˘x
);

990  
dige°
;

991 
	}
}

	@str2host.c

13 
	~<ldns/c⁄fig.h
>

15 
	~<ldns/ldns.h
>

17 #ifde‡
HAVE_SYS_SOCKET_H


18 
	~<sys/sockë.h
>

20 #ifde‡
HAVE_ARPA_INET_H


21 
	~<¨∑/öë.h
>

23 
	~<time.h
>

25 
	~<î∫o.h
>

26 #ifde‡
HAVE_NETDB_H


27 
	~<√tdb.h
>

30 
	~<limôs.h
>

31 #ifde‡
HAVE_SYS_PARAM_H


32 
	~<sys/∑øm.h
>

35 
ldns_°©us


36 
	$ldns_°r2rdf_öt16
(
ldns_rdf
 **
rd
, c⁄° *
sh‹t°r
)

38 *
íd
 = 
NULL
;

39 
uöt16_t
 *
r
;

40 
r
 = 
	`LDNS_MALLOC
(
uöt16_t
);

41 if(!
r
Ë 
LDNS_STATUS_MEM_ERR
;

43 *
r
 = 
	`ht⁄s
((
uöt16_t
)
	`°πﬁ
((*)
sh‹t°r
, &
íd
, 10));

45 if(*
íd
 != 0) {

46 
	`LDNS_FREE
(
r
);

47  
LDNS_STATUS_INVALID_INT
;

49 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

50 
LDNS_RDF_TYPE_INT16
, (
uöt16_t
), 
r
);

51 
	`LDNS_FREE
(
r
);

52  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

54 
	}
}

56 
ldns_°©us


57 
	$ldns_°r2rdf_time
(
ldns_rdf
 **
rd
, c⁄° *
time
)

60 
uöt16_t
 *
r
 = 
NULL
;

61 
tm
Åm;

62 
uöt32_t
 
l
;

63 *
íd
;

66 
r
 = (
uöt16_t
*)
	`LDNS_MALLOC
(
uöt32_t
);

67 if(!
r
Ë 
LDNS_STATUS_MEM_ERR
;

69 
	`mem£t
(&
tm
, 0, (tm));

71 i‡(
	`°æí
(
time
) == 14 &&

72 
	`ssˇnf
(
time
, "%4d%2d%2d%2d%2d%2d", &
tm
.
tm_yór
, &tm.
tm_m⁄
, &tm.
tm_mday
, &tm.
tm_hour
, &tm.
tm_mö
, &tm.
tm_£c
) == 6

74 
tm
.
tm_yór
 -= 1900;

75 
tm
.
tm_m⁄
--;

77 i‡(
tm
.
tm_yór
 < 70) {

78 
bad_f‹m©
;

80 i‡(
tm
.
tm_m⁄
 < 0 ||Åm.tm_mon > 11) {

81 
bad_f‹m©
;

83 i‡(
tm
.
tm_mday
 < 1 ||Åm.tm_mday > 31) {

84 
bad_f‹m©
;

87 i‡(
tm
.
tm_hour
 < 0 ||Åm.tm_hour > 23) {

88 
bad_f‹m©
;

91 i‡(
tm
.
tm_mö
 < 0 ||Åm.tm_min > 59) {

92 
bad_f‹m©
;

95 i‡(
tm
.
tm_£c
 < 0 ||Åm.tm_sec > 59) {

96 
bad_f‹m©
;

99 
l
 = 
	`ht⁄l
(
	`ldns_mktime_‰om_utc
(&
tm
));

100 
	`mem˝y
(
r
, &
l
, (
uöt32_t
));

101 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

102 
LDNS_RDF_TYPE_TIME
, (
uöt32_t
), 
r
);

103 
	`LDNS_FREE
(
r
);

104  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

107 
l
 = 
	`ht⁄l
((
uöt32_t
)
	`°πﬁ
((*)
time
, &
íd
, 10));

108 if(*
íd
 != 0) {

109 
	`LDNS_FREE
(
r
);

110  
LDNS_STATUS_ERR
;

112 
	`mem˝y
(
r
, &
l
, (
uöt32_t
));

113 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

114 
LDNS_RDF_TYPE_INT32
, (
uöt32_t
), 
r
);

115 
	`LDNS_FREE
(
r
);

116  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

120 
bad_f‹m©
:

121 
	`LDNS_FREE
(
r
);

122  
LDNS_STATUS_INVALID_TIME
;

123 
	}
}

125 
ldns_°©us


126 
	$ldns_°r2rdf_n£c3_ß…
(
ldns_rdf
 **
rd
, c⁄° *
ß…_°r
)

128 
uöt8_t
 
ß…_Àngth
;

129 
c
;

130 
ß…_Àngth_°r
;

132 
uöt8_t
 *
ß…
;

133 
uöt8_t
 *
d©a
;

134 if(
rd
 =
NULL
) {

135  
LDNS_STATUS_NULL
;

138 
ß…_Àngth_°r
 = ()
	`°æí
(
ß…_°r
);

139 i‡(
ß…_Àngth_°r
 =1 && 
ß…_°r
[0] == '-') {

140 
ß…_Àngth_°r
 = 0;

141 } i‡(
ß…_Àngth_°r
 % 2 != 0) {

142  
LDNS_STATUS_INVALID_HEX
;

144 i‡(
ß…_Àngth_°r
 > 512) {

145  
LDNS_STATUS_INVALID_HEX
;

148 
ß…
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
ß…_Àngth_°r
 / 2);

149 if(!
ß…
) {

150  
LDNS_STATUS_MEM_ERR
;

152 
c
 = 0; c < 
ß…_Àngth_°r
; c += 2) {

153 i‡(
	`isxdigô
((Ë
ß…_°r
[
c
]) && isxdigit(() salt_str[c+1])) {

154 
ß…
[
c
/2] = (
uöt8_t
Ë
	`ldns_hexdigô_to_öt
(
ß…_°r
[c]) * 16 +

155 
	`ldns_hexdigô_to_öt
(
ß…_°r
[
c
+1]);

157 
	`LDNS_FREE
(
ß…
);

158  
LDNS_STATUS_INVALID_HEX
;

161 
ß…_Àngth
 = (
uöt8_t
Ë(
ß…_Àngth_°r
 / 2);

163 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 1 + 
ß…_Àngth
);

164 if(!
d©a
) {

165 
	`LDNS_FREE
(
ß…
);

166  
LDNS_STATUS_MEM_ERR
;

168 
d©a
[0] = 
ß…_Àngth
;

169 
	`mem˝y
(&
d©a
[1], 
ß…
, 
ß…_Àngth
);

170 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_NSEC3_SALT
, 1 + 
ß…_Àngth
, 
d©a
);

171 
	`LDNS_FREE
(
d©a
);

172 
	`LDNS_FREE
(
ß…
);

174  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

175 
	}
}

177 
ldns_°©us


178 
	$ldns_°r2rdf_≥riod
(
ldns_rdf
 **
rd
,c⁄° *
≥riod
)

180 
uöt32_t
 
p
;

181 c⁄° *
íd
;

184 
p
 = 
	`ldns_°r2≥riod
(
≥riod
, &
íd
);

186 i‡(*
íd
 != 0) {

187  
LDNS_STATUS_ERR
;

189 
p
 = (
uöt32_t
Ë
	`ht⁄l
(p);

190 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

191 
LDNS_RDF_TYPE_PERIOD
, (
uöt32_t
), &
p
);

193  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

194 
	}
}

196 
ldns_°©us


197 
	$ldns_°r2rdf_öt32
(
ldns_rdf
 **
rd
, c⁄° *
l⁄g°r
)

199 *
íd
;

200 
uöt16_t
 *
r
 = 
NULL
;

201 
uöt32_t
 
l
;

203 
r
 = (
uöt16_t
*)
	`LDNS_MALLOC
(
uöt32_t
);

204 if(!
r
Ë 
LDNS_STATUS_MEM_ERR
;

205 
î∫o
 = 0;

207 if(*
l⁄g°r
 == '-')

208 
l
 = 
	`ht⁄l
((
uöt32_t
)
	`°πﬁ
((*)
l⁄g°r
, &
íd
, 10));

209 
l
 = 
	`ht⁄l
((
uöt32_t
)
	`°πoul
((*)
l⁄g°r
, &
íd
, 10));

211 if(*
íd
 != 0) {

212 
	`LDNS_FREE
(
r
);

213  
LDNS_STATUS_ERR
;

215 i‡(
î∫o
 =
ERANGE
) {

216 
	`LDNS_FREE
(
r
);

217  
LDNS_STATUS_SYNTAX_INTEGER_OVERFLOW
;

219 
	`mem˝y
(
r
, &
l
, (
uöt32_t
));

220 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

221 
LDNS_RDF_TYPE_INT32
, (
uöt32_t
), 
r
);

222 
	`LDNS_FREE
(
r
);

223  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

225 
	}
}

227 
ldns_°©us


228 
	$ldns_°r2rdf_öt8
(
ldns_rdf
 **
rd
, c⁄° *
byã°r
)

230 *
íd
;

231 
uöt8_t
 *
r
 = 
NULL
;

233 
r
 = 
	`LDNS_MALLOC
(
uöt8_t
);

234 if(!
r
Ë 
LDNS_STATUS_MEM_ERR
;

236 *
r
 = (
uöt8_t
)
	`°πﬁ
((*)
byã°r
, &
íd
, 10);

238 if(*
íd
 != 0) {

239 
	`LDNS_FREE
(
r
);

240  
LDNS_STATUS_ERR
;

242 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

243 
LDNS_RDF_TYPE_INT8
, (
uöt8_t
), 
r
);

244 
	`LDNS_FREE
(
r
);

245  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

247 
	}
}

260 
INLINE
 
boﬁ


261 
	$∑r£_esˇ≥
(
uöt8_t
 *
ch_p
, c⁄° ** 
°r_p
)

263 
uöt16_t
 
vÆ
;

265 i‡((*
°r_p
)[0] && 
	`isdigô
((*str_p)[0]) &&

266 (*
°r_p
)[1] && 
	`isdigô
((*str_p)[1]) &&

267 (*
°r_p
)[2] && 
	`isdigô
((*str_p)[2])) {

269 
vÆ
 = (
uöt16_t
)(((*
°r_p
)[0] - '0') * 100 +

270 ((*
°r_p
)[1] - '0') * 10 +

271 ((*
°r_p
)[2] - '0'));

273 i‡(
vÆ
 > 255) {

274 
îr‹
;

276 *
ch_p
 = (
uöt8_t
)
vÆ
;

277 *
°r_p
 += 3;

278  
åue
;

280 } i‡((*
°r_p
)[0] && !
	`isdigô
((*str_p)[0])) {

282 *
ch_p
 = (
uöt8_t
)*(*
°r_p
)++;

283  
åue
;

285 
îr‹
:

286 *
°r_p
 = 
NULL
;

287  
Ál£
;

288 
	}
}

290 
INLINE
 
boﬁ


291 
	$∑r£_ch¨
(
uöt8_t
 *
ch_p
, c⁄° ** 
°r_p
)

293 **
°r_p
) {

295 '\0':  
Ál£
;

297 '\\': *
°r_p
 += 1;

298  
	`∑r£_esˇ≥
(
ch_p
, 
°r_p
);

300 : *
ch_p
 = (
uöt8_t
)*(*
°r_p
)++;

301  
åue
;

303 
	}
}

310 
ldns_°©us


311 
	$ldns_°r2rdf_d«me
(
ldns_rdf
 **
d
, c⁄° *
°r
)

313 
size_t
 
Àn
;

315 c⁄° *
s
;

316 
uöt8_t
 *
q
, *
pq
, 
œbñ_Àn
;

317 
uöt8_t
 
buf
[
LDNS_MAX_DOMAINLEN
 + 1];

318 *
d
 = 
NULL
;

320 
Àn
 = 
	`°æí
((*)
°r
);

322 i‡(
Àn
 > 
LDNS_MAX_DOMAINLEN
 * 4) {

323  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

325 i‡(0 =
Àn
) {

326  
LDNS_STATUS_DOMAINNAME_UNDERFLOW
;

330 i‡(1 =
Àn
 && *
°r
 == '.') {

331 *
d
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_DNAME
, 1, "\0");

332  
LDNS_STATUS_OK
;

342 
Àn
 = 0;

343 
q
 = 
buf
+1;

344 
pq
 = 
buf
;

345 
œbñ_Àn
 = 0;

346 
s
 = 
°r
; *s; s++, 
q
++) {

347 i‡(
q
 > 
buf
 + 
LDNS_MAX_DOMAINLEN
) {

348  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

350 *
q
 = 0;

351 *
s
) {

353 i‡(
œbñ_Àn
 > 
LDNS_MAX_LABELLEN
) {

354  
LDNS_STATUS_LABEL_OVERFLOW
;

356 i‡(
œbñ_Àn
 == 0) {

357  
LDNS_STATUS_EMPTY_LABEL
;

359 
Àn
 +
œbñ_Àn
 + 1;

360 *
pq
 = 
œbñ_Àn
;

361 
œbñ_Àn
 = 0;

362 
pq
 = 
q
;

366 
s
 += 1;

367 i‡(! 
	`∑r£_esˇ≥
(
q
, &
s
)) {

368  
LDNS_STATUS_SYNTAX_BAD_ESCAPE
;

370 
s
 -= 1;

371 
œbñ_Àn
++;

374 *
q
 = (
uöt8_t
)*
s
;

375 
œbñ_Àn
++;

380 i‡(!
	`ldns_d«me_°r_absﬁuã
(
°r
)) {

381 i‡(
q
 > 
buf
 + 
LDNS_MAX_DOMAINLEN
) {

382  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

384 i‡(
œbñ_Àn
 > 
LDNS_MAX_LABELLEN
) {

385  
LDNS_STATUS_LABEL_OVERFLOW
;

387 i‡(
œbñ_Àn
 == 0) {

388  
LDNS_STATUS_EMPTY_LABEL
;

390 
Àn
 +
œbñ_Àn
 + 1;

391 *
pq
 = 
œbñ_Àn
;

392 *
q
 = 0;

394 
Àn
++;

396 *
d
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_DNAME
, 
Àn
, 
buf
);

397  
LDNS_STATUS_OK
;

398 
	}
}

400 
ldns_°©us


401 
	$ldns_°r2rdf_a
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

403 
ö_addr_t
 
addªss
;

404 i‡(
	`öë_±⁄
(
AF_INET
, (*)
°r
, &
addªss
) != 1) {

405  
LDNS_STATUS_INVALID_IP4
;

407 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

408 
LDNS_RDF_TYPE_A
, (
addªss
), &address);

410  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

411 
	}
}

413 
ldns_°©us


414 
	$ldns_°r2rdf_ØØ
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

416 
uöt8_t
 
addªss
[
LDNS_IP6ADDRLEN
 + 1];

418 i‡(
	`öë_±⁄
(
AF_INET6
, (*)
°r
, 
addªss
) != 1) {

419  
LDNS_STATUS_INVALID_IP6
;

421 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

422 
LDNS_RDF_TYPE_AAAA
, (
addªss
) - 1, &address);

424  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

425 
	}
}

427 
ldns_°©us


428 
	$ldns_°r2rdf_°r
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

430 
uöt8_t
 *
d©a
, *
dp
, 
ch
 = 0;

431 
size_t
 
Àngth
;

434 
dp
 = 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
	`°æí
(
°r
) > 255 ? 256 : (strlen(str) + 1));

435 i‡(! 
d©a
) {

436  
LDNS_STATUS_MEM_ERR
;

440 
	`∑r£_ch¨
(&
ch
, &
°r
)) {

441 i‡(
dp
 - 
d©a
 >= 255) {

442 
	`LDNS_FREE
(
d©a
);

443  
LDNS_STATUS_INVALID_STR
;

445 *++
dp
 = 
ch
;

447 i‡(! 
°r
) {

448  
LDNS_STATUS_SYNTAX_BAD_ESCAPE
;

450 
Àngth
 = (
size_t
)(
dp
 - 
d©a
);

452 
d©a
[0] = (
uöt8_t
)
Àngth
;

455 
d©a
 = 
	`LDNS_XREALLOC
(
dp
 = d©a, 
uöt8_t
, 
Àngth
 + 1);

456 i‡(! 
d©a
) {

457 
	`LDNS_FREE
(
dp
);

458  
LDNS_STATUS_MEM_ERR
;

462 *
rd
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_STR
, 
Àngth
 + 1, 
d©a
);

463 i‡(! *
rd
) {

464 
	`LDNS_FREE
(
d©a
);

465  
LDNS_STATUS_MEM_ERR
;

467  
LDNS_STATUS_OK
;

468 
	}
}

470 
ldns_°©us


471 
	$ldns_°r2rdf_≠l
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

473 c⁄° *
my_°r
 = 
°r
;

475 *
my_ù_°r
;

476 
size_t
 
ù_°r_Àn
;

478 
uöt16_t
 
Ámûy
;

479 
boﬁ
 
√g©i⁄
;

480 
uöt8_t
 
afdÀngth
 = 0;

481 
uöt8_t
 *
afd∑π
;

482 
uöt8_t
 
¥efix
;

484 
uöt8_t
 *
d©a
;

486 
size_t
 
i
 = 0;

489 i‡(
	`°æí
(
my_°r
) < 2

490 || 
	`°rchr
(
my_°r
, ':'Ë=
NULL


491 || 
	`°rchr
(
my_°r
, '/'Ë=
NULL


492 || 
	`°rchr
(
my_°r
, ':') > strchr(my_str, '/')) {

493  
LDNS_STATUS_INVALID_STR
;

496 i‡(
my_°r
[0] == '!') {

497 
√g©i⁄
 = 
åue
;

498 
my_°r
 += 1;

500 
√g©i⁄
 = 
Ál£
;

503 
Ámûy
 = (
uöt16_t
Ë
	`©oi
(
my_°r
);

505 
my_°r
 = 
	`°rchr
(my_str, ':') + 1;

508 
ù_°r_Àn
 = (
size_t
Ë(
	`°rchr
(
my_°r
, '/') - my_str);

509 
my_ù_°r
 = 
	`LDNS_XMALLOC
(, 
ù_°r_Àn
 + 1);

510 if(!
my_ù_°r
Ë 
LDNS_STATUS_MEM_ERR
;

511 
	`°∫˝y
(
my_ù_°r
, 
my_°r
, 
ù_°r_Àn
 + 1);

512 
my_ù_°r
[
ù_°r_Àn
] = '\0';

514 i‡(
Ámûy
 == 1) {

516 
afd∑π
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 4);

517 if(!
afd∑π
) {

518 
	`LDNS_FREE
(
my_ù_°r
);

519  
LDNS_STATUS_MEM_ERR
;

521 i‡(
	`öë_±⁄
(
AF_INET
, 
my_ù_°r
, 
afd∑π
) == 0) {

522 
	`LDNS_FREE
(
my_ù_°r
);

523 
	`LDNS_FREE
(
afd∑π
);

524  
LDNS_STATUS_INVALID_STR
;

526 
i
 = 0; i < 4; i++) {

527 i‡(
afd∑π
[
i
] != 0) {

528 
afdÀngth
 = 
i
 + 1;

531 } i‡(
Ámûy
 == 2) {

533 
afd∑π
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 16);

534 if(!
afd∑π
) {

535 
	`LDNS_FREE
(
my_ù_°r
);

536  
LDNS_STATUS_MEM_ERR
;

538 i‡(
	`öë_±⁄
(
AF_INET6
, 
my_ù_°r
, 
afd∑π
) == 0) {

539 
	`LDNS_FREE
(
my_ù_°r
);

540 
	`LDNS_FREE
(
afd∑π
);

541  
LDNS_STATUS_INVALID_STR
;

543 
i
 = 0; i < 16; i++) {

544 i‡(
afd∑π
[
i
] != 0) {

545 
afdÀngth
 = 
i
 + 1;

550 
	`LDNS_FREE
(
my_ù_°r
);

551  
LDNS_STATUS_INVALID_STR
;

554 
my_°r
 = 
	`°rchr
(my_str, '/') + 1;

555 
¥efix
 = (
uöt8_t
Ë
	`©oi
(
my_°r
);

557 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 4 + 
afdÀngth
);

558 if(!
d©a
) {

559 
	`LDNS_FREE
(
afd∑π
);

560 
	`LDNS_FREE
(
my_ù_°r
);

561  
LDNS_STATUS_INVALID_STR
;

563 
	`ldns_wrôe_uöt16
(
d©a
, 
Ámûy
);

564 
d©a
[2] = 
¥efix
;

565 
d©a
[3] = 
afdÀngth
;

566 i‡(
√g©i⁄
) {

568 
d©a
[3] = data[3] | 0x80;

571 
	`mem˝y
(
d©a
 + 4, 
afd∑π
, 
afdÀngth
);

573 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_APL
, 
afdÀngth
 + 4, 
d©a
);

574 
	`LDNS_FREE
(
afd∑π
);

575 
	`LDNS_FREE
(
d©a
);

576 
	`LDNS_FREE
(
my_ù_°r
);

578  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

579 
	}
}

581 
ldns_°©us


582 
	$ldns_°r2rdf_b64
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

584 
uöt8_t
 *
buf„r
;

585 
öt16_t
 
i
;

587 
buf„r
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(
°r
)));

588 if(!
buf„r
) {

589  
LDNS_STATUS_MEM_ERR
;

592 
i
 = (
uöt16_t
)
	`ldns_b64_±⁄
((c⁄° *)
°r
, 
buf„r
,

593 
	`ldns_b64_¡›_ˇlcuœã_size
(
	`°æí
(
°r
)));

594 i‡(-1 =
i
) {

595 
	`LDNS_FREE
(
buf„r
);

596  
LDNS_STATUS_INVALID_B64
;

598 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

599 
LDNS_RDF_TYPE_B64
, (
uöt16_t
Ë
i
, 
buf„r
);

601 
	`LDNS_FREE
(
buf„r
);

603  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

604 
	}
}

606 
ldns_°©us


607 
	$ldns_°r2rdf_b32_ext
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

609 
uöt8_t
 *
buf„r
;

610 
i
;

612 
uöt8_t
 
Àn
 = 
	`ldns_b32_±⁄_ˇlcuœã_size
(
	`°æí
(
°r
));

613 
buf„r
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
Àn
 + 1);

614 if(!
buf„r
) {

615  
LDNS_STATUS_MEM_ERR
;

617 
buf„r
[0] = 
Àn
;

619 
i
 = 
	`ldns_b32_±⁄_exãnded_hex
((c⁄° *)
°r
, 
	`°æí
(°r), 
buf„r
 + 1,

620 
	`ldns_b32_¡›_ˇlcuœã_size
(
	`°æí
(
°r
)));

621 i‡(
i
 < 0) {

622 
	`LDNS_FREE
(
buf„r
);

623  
LDNS_STATUS_INVALID_B32_EXT
;

625 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

626 
LDNS_RDF_TYPE_B32_EXT
, (
uöt16_t
Ë
i
 + 1, 
buf„r
);

628 
	`LDNS_FREE
(
buf„r
);

630  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

631 
	}
}

633 
ldns_°©us


634 
	$ldns_°r2rdf_hex
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

636 
uöt8_t
 *
t
, *
t_‹ig
;

637 
i
;

638 
size_t
 
Àn
;

640 
Àn
 = 
	`°æí
(
°r
);

642 i‡(
Àn
 > 
LDNS_MAX_RDFLEN
 * 2) {

643  
LDNS_STATUS_LABEL_OVERFLOW
;

645 
t
 = 
	`LDNS_XMALLOC
(
uöt8_t
, (
Àn
 / 2) + 1);

646 if(!
t
) {

647  
LDNS_STATUS_MEM_ERR
;

649 
t_‹ig
 = 
t
;

651 *
°r
) {

652 *
t
 = 0;

653 i‡(
	`is•a˚
((Ë*
°r
)) {

654 
°r
++;

656 
i
 = 16; i >= 1; i -= 15) {

657 *
°r
 && 
	`is•a˚
(() *str)) { str++; }

658 i‡(*
°r
) {

659 i‡(
	`isxdigô
((Ë*
°r
)) {

660 *
t
 +
	`ldns_hexdigô_to_öt
(*
°r
Ë* 
i
;

662 
	`LDNS_FREE
(
t_‹ig
);

663  
LDNS_STATUS_ERR
;

665 ++
°r
;

668 ++
t
;

671 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_HEX
,

672 (
size_t
Ë(
t
 - 
t_‹ig
),

673 
t_‹ig
);

674 
	`LDNS_FREE
(
t_‹ig
);

676  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

677 
	}
}

679 
ldns_°©us


680 
	$ldns_°r2rdf_n£c
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

682 c⁄° *
dñimôîs
 = "\n\t ";

683 *
tokí
 = 
	`LDNS_XMALLOC
(, 
LDNS_MAX_RDFLEN
);

684 
ldns_buf„r
 *
°r_buf
;

685 
ssize_t
 
c
;

686 
uöt16_t
 
cur_ty≥
;

687 
size_t
 
ty≥_cou¡
 = 0;

688 
ldns_º_ty≥
 
ty≥_li°
[65536];

689 if(!
tokí
Ë 
LDNS_STATUS_MEM_ERR
;

690 if(
rd
 =
NULL
) {

691 
	`LDNS_FREE
(
tokí
);

692  
LDNS_STATUS_NULL
;

695 
°r_buf
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

696 if(!
°r_buf
) {

697 
	`LDNS_FREE
(
tokí
);

698  
LDNS_STATUS_MEM_ERR
;

700 
	`ldns_buf„r_√w_‰m_d©a
(
°r_buf
, (*)
°r
, 
	`°æí
(str));

701 if(
	`ldns_buf„r_°©us
(
°r_buf
Ë!
LDNS_STATUS_OK
) {

702 
	`LDNS_FREE
(
°r_buf
);

703 
	`LDNS_FREE
(
tokí
);

704  
LDNS_STATUS_MEM_ERR
;

707 (
c
 = 
	`ldns_bgë_tokí
(
°r_buf
, 
tokí
, 
dñimôîs
, 
LDNS_MAX_RDFLEN
)) != -1 && c != 0) {

708 if(
ty≥_cou¡
 >(
ty≥_li°
)) {

709 
	`LDNS_FREE
(
°r_buf
);

710 
	`LDNS_FREE
(
tokí
);

711  
LDNS_STATUS_ERR
;

713 
cur_ty≥
 = 
	`ldns_gë_º_ty≥_by_«me
(
tokí
);

714 
ty≥_li°
[
ty≥_cou¡
] = 
cur_ty≥
;

715 
ty≥_cou¡
++;

718 *
rd
 = 
	`ldns_dns£c_¸óã_n£c_bôm≠
(
ty≥_li°
,

719 
ty≥_cou¡
,

720 
LDNS_RR_TYPE_NSEC
);

722 
	`LDNS_FREE
(
tokí
);

723 
	`ldns_buf„r_‰ì
(
°r_buf
);

724  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

725 
	}
}

727 
ldns_°©us


728 
	$ldns_°r2rdf_ty≥
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

730 
uöt16_t
 
ty≥
;

731 
ty≥
 = 
	`ht⁄s
(
	`ldns_gë_º_ty≥_by_«me
(
°r
));

733 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

734 
LDNS_RDF_TYPE_TYPE
, (
uöt16_t
), &
ty≥
);

735  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

736 
	}
}

738 
ldns_°©us


739 
	$ldns_°r2rdf_˛ass
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

741 
uöt16_t
 
kœss
;

742 
kœss
 = 
	`ht⁄s
(
	`ldns_gë_º_˛ass_by_«me
(
°r
));

744 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

745 
LDNS_RDF_TYPE_CLASS
, (
uöt16_t
), &
kœss
);

746  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

747 
	}
}

752 
ldns_°©us


753 
	$ldns_°r2rdf_˚π_Æg
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

755 
ldns_lookup_èbÀ
 *
…
;

756 
ldns_°©us
 
°
;

757 
uöt8_t
 
idd
[2];

758 
…
 = 
	`ldns_lookup_by_«me
(
ldns_˚π_Æg‹ôhms
, 
°r
);

759 
°
 = 
LDNS_STATUS_OK
;

761 i‡(
…
) {

762 
	`ldns_wrôe_uöt16
(
idd
, (
uöt16_t
Ë
…
->
id
);

763 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

764 
LDNS_RDF_TYPE_INT16
, (
uöt16_t
), 
idd
);

765 i‡(!*
rd
) {

766 
°
 = 
LDNS_STATUS_ERR
;

770 
°
 = 
	`ldns_°r2rdf_öt16
(
rd
, 
°r
);

771 i‡(
°
 =
LDNS_STATUS_OK
 &&

772 
	`ldns_rdf2«tive_öt16
(*
rd
) == 0) {

773 
°
 = 
LDNS_STATUS_CERT_BAD_ALGORITHM
;

777  
°
;

778 
	}
}

783 
ldns_°©us


784 
	$ldns_°r2rdf_Æg
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

786 
ldns_lookup_èbÀ
 *
…
;

787 
ldns_°©us
 
°
;

789 
…
 = 
	`ldns_lookup_by_«me
(
ldns_Æg‹ôhms
, 
°r
);

790 
°
 = 
LDNS_STATUS_OK
;

792 i‡(
…
) {

794 *
rd
 = 
	`ldns_«tive2rdf_öt8
(
LDNS_RDF_TYPE_INT8
, (
uöt8_t
Ë
…
->
id
);

795 i‡(!*
rd
) {

796 
°
 = 
LDNS_STATUS_ERR
;

800 
°
 = 
	`ldns_°r2rdf_öt8
(
rd
, 
°r
);

802  
°
;

803 
	}
}

805 
ldns_°©us


806 
ldns_°r2rdf_unknown
–
ATTR_UNUSED
(
ldns_rdf
 **
rd
)

807 , 
	$ATTR_UNUSED
(c⁄° *
°r
)

812  
LDNS_STATUS_NOT_IMPL
;

813 
	}
}

815 
ldns_°©us


816 
ldns_°r2rdf_£rvi˚
–
ATTR_UNUSED
(
ldns_rdf
 **
rd
)

817 , 
	$ATTR_UNUSED
(c⁄° *
°r
)

821  
LDNS_STATUS_NOT_IMPL
;

822 
	}
}

825 
	$loc_∑r£_cm
(* 
my_°r
, ** 
íd°r
, 
uöt8_t
* 
m
, uöt8_t* 
e
)

829 
uöt32_t
 
mëîs
 = 0, 
cm
 = 0, 
vÆ
;

830 
	`isbœnk
(*
my_°r
)) {

831 
my_°r
++;

833 
mëîs
 = (
uöt32_t
)
	`°πﬁ
(
my_°r
, &my_str, 10);

834 i‡(*
my_°r
 == '.') {

835 
my_°r
++;

836 
cm
 = (
uöt32_t
)
	`°πﬁ
(
my_°r
, &my_str, 10);

838 i‡(
mëîs
 >= 1) {

839 *
e
 = 2;

840 
vÆ
 = 
mëîs
;

842 *
e
 = 0;

843 
vÆ
 = 
cm
;

845 
vÆ
 >= 10) {

846 (*
e
)++;

847 
vÆ
 /= 10;

849 *
m
 = (
uöt8_t
)
vÆ
;

851 i‡(*
e
 > 9)

853 i‡(*
my_°r
 == 'm' || *my_str == 'M') {

854 
my_°r
++;

856 *
íd°r
 = 
my_°r
;

858 
	}
}

860 
ldns_°©us


861 
	$ldns_°r2rdf_loc
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

863 
uöt32_t
 
œtôude
 = 0;

864 
uöt32_t
 
l⁄gôude
 = 0;

865 
uöt32_t
 
Ætôude
 = 0;

867 
uöt8_t
 *
d©a
;

868 
uöt32_t
 
equ©‹
 = (uöt32_tË
	`ldns_powî
(2, 31);

870 
uöt32_t
 
h
 = 0;

871 
uöt32_t
 
m
 = 0;

872 
uöt8_t
 
size_b
 = 1, 
size_e
 = 2;

873 
uöt8_t
 
h‹iz_¥e_b
 = 1, 
h‹iz_¥e_e
 = 6;

874 
uöt8_t
 
vît_¥e_b
 = 1, 
vît_¥e_e
 = 3;

876 
s
 = 0.0;

877 
boﬁ
 
n‹thî√ss
;

878 
boﬁ
 
ó°î√ss
;

880 *
my_°r
 = (*Ë
°r
;

883 i‡(
	`isdigô
((Ë*
my_°r
)) {

884 
h
 = (
uöt32_t
Ë
	`°πﬁ
(
my_°r
, &my_str, 10);

886  
LDNS_STATUS_INVALID_STR
;

889 
	`isbœnk
((Ë*
my_°r
)) {

890 
my_°r
++;

893 i‡(
	`isdigô
((Ë*
my_°r
)) {

894 
m
 = (
uöt32_t
Ë
	`°πﬁ
(
my_°r
, &my_str, 10);

895 } i‡(*
my_°r
 == 'N' || *my_str == 'S') {

896 
n‹th
;

898  
LDNS_STATUS_INVALID_STR
;

901 
	`isbœnk
((Ë*
my_°r
)) {

902 
my_°r
++;

905 i‡(
	`isdigô
((Ë*
my_°r
)) {

906 
s
 = 
	`°πod
(
my_°r
, &my_str);

908 
n‹th
:

909 
	`isbœnk
((Ë*
my_°r
)) {

910 
my_°r
++;

913 i‡(*
my_°r
 == 'N') {

914 
n‹thî√ss
 = 
åue
;

915 } i‡(*
my_°r
 == 'S') {

916 
n‹thî√ss
 = 
Ál£
;

918  
LDNS_STATUS_INVALID_STR
;

921 
my_°r
++;

924 
s
 = 1000.0 * s;

926 
s
 += 0.0005;

927 
œtôude
 = (
uöt32_t
Ë
s
;

928 
œtôude
 +1000 * 60 * 
m
;

929 
œtôude
 +1000 * 60 * 60 * 
h
;

930 i‡(
n‹thî√ss
) {

931 
œtôude
 = 
equ©‹
 +Üatitude;

933 
œtôude
 = 
equ©‹
 -Üatitude;

935 
	`isbœnk
(*
my_°r
)) {

936 
my_°r
++;

939 i‡(
	`isdigô
((Ë*
my_°r
)) {

940 
h
 = (
uöt32_t
Ë
	`°πﬁ
(
my_°r
, &my_str, 10);

942  
LDNS_STATUS_INVALID_STR
;

945 
	`isbœnk
((Ë*
my_°r
)) {

946 
my_°r
++;

949 i‡(
	`isdigô
((Ë*
my_°r
)) {

950 
m
 = (
uöt32_t
Ë
	`°πﬁ
(
my_°r
, &my_str, 10);

951 } i‡(*
my_°r
 == 'E' || *my_str == 'W') {

952 
ó°
;

954  
LDNS_STATUS_INVALID_STR
;

957 
	`isbœnk
(*
my_°r
)) {

958 
my_°r
++;

961 i‡(
	`isdigô
((Ë*
my_°r
)) {

962 
s
 = 
	`°πod
(
my_°r
, &my_str);

965 
ó°
:

966 
	`isbœnk
(*
my_°r
)) {

967 
my_°r
++;

970 i‡(*
my_°r
 == 'E') {

971 
ó°î√ss
 = 
åue
;

972 } i‡(*
my_°r
 == 'W') {

973 
ó°î√ss
 = 
Ál£
;

975  
LDNS_STATUS_INVALID_STR
;

978 
my_°r
++;

981 
s
 *= 1000.0;

983 
s
 += 0.0005;

984 
l⁄gôude
 = (
uöt32_t
Ë
s
;

985 
l⁄gôude
 +1000 * 60 * 
m
;

986 
l⁄gôude
 +1000 * 60 * 60 * 
h
;

988 i‡(
ó°î√ss
) {

989 
l⁄gôude
 +
equ©‹
;

991 
l⁄gôude
 = 
equ©‹
 -Üongitude;

994 
Ætôude
 = (
uöt32_t
)(
	`°πod
(
my_°r
, &my_str)*100.0 +

996 i‡(*
my_°r
 == 'm' || *my_str == 'M') {

997 
my_°r
++;

1000 i‡(
	`°æí
(
my_°r
) > 0) {

1001 if(!
	`loc_∑r£_cm
(
my_°r
, &my_°r, &
size_b
, &
size_e
))

1002  
LDNS_STATUS_INVALID_STR
;

1005 i‡(
	`°æí
(
my_°r
) > 0) {

1006 if(!
	`loc_∑r£_cm
(
my_°r
, &my_°r, &
h‹iz_¥e_b
, &
h‹iz_¥e_e
))

1007  
LDNS_STATUS_INVALID_STR
;

1010 i‡(
	`°æí
(
my_°r
) > 0) {

1011 if(!
	`loc_∑r£_cm
(
my_°r
, &my_°r, &
vît_¥e_b
, &
vît_¥e_e
))

1012  
LDNS_STATUS_INVALID_STR
;

1015 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 16);

1016 if(!
d©a
) {

1017  
LDNS_STATUS_MEM_ERR
;

1019 
d©a
[0] = 0;

1020 
d©a
[1] = 0;

1021 
d©a
[1] = ((
size_b
 << 4Ë& 0xf0Ë| (
size_e
 & 0x0f);

1022 
d©a
[2] = ((
h‹iz_¥e_b
 << 4Ë& 0xf0Ë| (
h‹iz_¥e_e
 & 0x0f);

1023 
d©a
[3] = ((
vît_¥e_b
 << 4Ë& 0xf0Ë| (
vît_¥e_e
 & 0x0f);

1024 
	`ldns_wrôe_uöt32
(
d©a
 + 4, 
œtôude
);

1025 
	`ldns_wrôe_uöt32
(
d©a
 + 8, 
l⁄gôude
);

1026 
	`ldns_wrôe_uöt32
(
d©a
 + 12, 
Ætôude
);

1028 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

1029 
LDNS_RDF_TYPE_LOC
, 16, 
d©a
);

1031 
	`LDNS_FREE
(
d©a
);

1032  *
rd
?
LDNS_STATUS_OK
:
LDNS_STATUS_MEM_ERR
;

1033 
	}
}

1035 
ldns_°©us


1036 
	$ldns_°r2rdf_wks
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1038 
uöt8_t
 *
bôm≠
 = 
NULL
;

1039 
uöt8_t
 *
d©a
;

1040 
bm_Àn
 = 0;

1042 
¥Ÿ€¡
 *
¥Ÿo
 = 
NULL
;

1043 
£rvít
 *
£rv
 = 
NULL
;

1044 
£rv_p‹t
;

1046 
ldns_buf„r
 *
°r_buf
;

1048 *
¥Ÿo_°r
 = 
NULL
;

1049 *
tokí
;

1050 if(
	`°æí
(
°r
) == 0)

1051 
tokí
 = 
	`LDNS_XMALLOC
(, 50);

1052 
tokí
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
°r
)+2);

1053 if(!
tokí
Ë 
LDNS_STATUS_MEM_ERR
;

1055 
°r_buf
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

1056 if(!
°r_buf
Ë{
	`LDNS_FREE
(
tokí
);  
LDNS_STATUS_MEM_ERR
;}

1057 
	`ldns_buf„r_√w_‰m_d©a
(
°r_buf
, (*)
°r
, 
	`°æí
(str));

1058 if(
	`ldns_buf„r_°©us
(
°r_buf
Ë!
LDNS_STATUS_OK
) {

1059 
	`LDNS_FREE
(
°r_buf
);

1060 
	`LDNS_FREE
(
tokí
);

1061  
LDNS_STATUS_MEM_ERR
;

1064 
	`ldns_bgë_tokí
(
°r_buf
, 
tokí
, "\t\¿", 
	`°æí
(
°r
)) > 0) {

1065 i‡(!
¥Ÿo_°r
) {

1066 
¥Ÿo_°r
 = 
	`°rdup
(
tokí
);

1067 i‡(!
¥Ÿo_°r
) {

1068 
	`LDNS_FREE
(
bôm≠
);

1069 
	`LDNS_FREE
(
tokí
);

1070 
	`ldns_buf„r_‰ì
(
°r_buf
);

1071  
LDNS_STATUS_INVALID_STR
;

1074 
£rv
 = 
	`gë£rvby«me
(
tokí
, 
¥Ÿo_°r
);

1075 i‡(
£rv
) {

1076 
£rv_p‹t
 = (Ë
	`¡ohs
((
uöt16_t
Ë
£rv
->
s_p‹t
);

1078 
£rv_p‹t
 = 
	`©oi
(
tokí
);

1080 i‡(
£rv_p‹t
 / 8 >
bm_Àn
) {

1081 
uöt8_t
 *
b2
 = 
	`LDNS_XREALLOC
(
bôm≠
, uöt8_t, (
£rv_p‹t
 / 8) + 1);

1082 if(!
b2
) {

1083 
	`LDNS_FREE
(
bôm≠
);

1084 
	`LDNS_FREE
(
tokí
);

1085 
	`ldns_buf„r_‰ì
(
°r_buf
);

1086 
	`‰ì
(
¥Ÿo_°r
);

1087  
LDNS_STATUS_INVALID_STR
;

1089 
bôm≠
 = 
b2
;

1091 ; 
bm_Àn
 <
£rv_p‹t
 / 8; bm_len++) {

1092 
bôm≠
[
bm_Àn
] = 0;

1095 
	`ldns_£t_bô
(
bôm≠
 + (
£rv_p‹t
 / 8), 7 - (£rv_p‹à% 8), 
åue
);

1099 i‡(!
¥Ÿo_°r
 || !
bôm≠
) {

1100 
	`LDNS_FREE
(
bôm≠
);

1101 
	`LDNS_FREE
(
tokí
);

1102 
	`ldns_buf„r_‰ì
(
°r_buf
);

1103 
	`‰ì
(
¥Ÿo_°r
);

1104  
LDNS_STATUS_INVALID_STR
;

1107 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
bm_Àn
 + 1);

1108 if(!
d©a
) {

1109 
	`LDNS_FREE
(
tokí
);

1110 
	`ldns_buf„r_‰ì
(
°r_buf
);

1111 
	`LDNS_FREE
(
bôm≠
);

1112 
	`‰ì
(
¥Ÿo_°r
);

1113  
LDNS_STATUS_INVALID_STR
;

1115 i‡(
¥Ÿo_°r
)

1116 
¥Ÿo
 = 
	`gë¥Ÿoby«me
(
¥Ÿo_°r
);

1117 i‡(
¥Ÿo
) {

1118 
d©a
[0] = (
uöt8_t
Ë
¥Ÿo
->
p_¥Ÿo
;

1119 } i‡(
¥Ÿo_°r
) {

1120 
d©a
[0] = (
uöt8_t
Ë
	`©oi
(
¥Ÿo_°r
);

1122 
	`mem˝y
(
d©a
 + 1, 
bôm≠
, (
size_t
Ë
bm_Àn
);

1124 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_WKS
, (
uöt16_t
Ë(
bm_Àn
 + 1), 
d©a
);

1126 
	`LDNS_FREE
(
d©a
);

1127 
	`LDNS_FREE
(
tokí
);

1128 
	`ldns_buf„r_‰ì
(
°r_buf
);

1129 
	`LDNS_FREE
(
bôm≠
);

1130 
	`‰ì
(
¥Ÿo_°r
);

1131 #ifde‡
HAVE_ENDSERVENT


1132 
	`íd£rvít
();

1134 #ifde‡
HAVE_ENDPROTOENT


1135 
	`íd¥Ÿ€¡
();

1138 if(!*
rd
Ë 
LDNS_STATUS_MEM_ERR
;

1140  
LDNS_STATUS_OK
;

1141 
	}
}

1143 
ldns_°©us


1144 
	$ldns_°r2rdf_nßp
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1146 
size_t
 
Àn
, 
i
;

1147 * 
nßp_°r
 = (*Ë
°r
;

1150 i‡(
°r
[0] != '0' || str[1] != 'x') {

1151  
LDNS_STATUS_INVALID_STR
;

1153 
Àn
 = 
	`°æí
(
°r
);

1154 
i
=0; i < 
Àn
; i++) {

1155 i‡(
nßp_°r
[
i
] == '.')

1156 
nßp_°r
[
i
] = ' ';

1158  
	`ldns_°r2rdf_hex
(
rd
, 
°r
+2);

1160 
	}
}

1162 
ldns_°©us


1163 
	$ldns_°r2rdf_©ma
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1165 
size_t
 
Àn
, 
i
;

1166 * 
©ma_°r
 = (*Ë
°r
;

1167 
ldns_°©us
 
°©us
;

1170 
Àn
 = 
	`°æí
(
°r
);

1171 
i
=0; i < 
Àn
; i++) {

1172 i‡(
©ma_°r
[
i
] == '.')

1173 
©ma_°r
[
i
] = ' ';

1175 
°©us
 = 
	`ldns_°r2rdf_hex
(
rd
, 
°r
);

1176 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1179  
°©us
;

1180 
	}
}

1182 
ldns_°©us


1183 
	$ldns_°r2rdf_ù£ckey
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1185 
uöt8_t
 
¥e˚dí˚
 = 0;

1186 
uöt8_t
 
g©eway_ty≥
 = 0;

1187 
uöt8_t
 
Æg‹ôhm
 = 0;

1188 * 
g©eway
 = 
NULL
;

1189 * 
publickey
 = 
NULL
;

1190 
uöt8_t
 *
d©a
;

1191 
ldns_buf„r
 *
°r_buf
;

1192 *
tokí
;

1193 
tokí_cou¡
 = 0;

1194 
ù£ckey_Àn
 = 0;

1195 
ldns_rdf
* 
g©eway_rdf
 = 
NULL
;

1196 
ldns_rdf
* 
publickey_rdf
 = 
NULL
;

1197 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

1199 if(
	`°æí
(
°r
) == 0)

1200 
tokí
 = 
	`LDNS_XMALLOC
(, 256);

1201 
tokí
 = 
	`LDNS_XMALLOC
(, 
	`°æí
(
°r
)+2);

1202 if(!
tokí
Ë 
LDNS_STATUS_MEM_ERR
;

1204 
°r_buf
 = 
	`LDNS_MALLOC
(
ldns_buf„r
);

1205 if(!
°r_buf
Ë{
	`LDNS_FREE
(
tokí
);  
LDNS_STATUS_MEM_ERR
;}

1206 
	`ldns_buf„r_√w_‰m_d©a
(
°r_buf
, (*)
°r
, 
	`°æí
(str));

1207 if(
	`ldns_buf„r_°©us
(
°r_buf
Ë!
LDNS_STATUS_OK
) {

1208 
	`LDNS_FREE
(
°r_buf
);

1209 
	`LDNS_FREE
(
tokí
);

1210  
LDNS_STATUS_MEM_ERR
;

1212 
	`ldns_bgë_tokí
(
°r_buf
, 
tokí
, "\t\¿", 
	`°æí
(
°r
)) > 0) {

1213 
tokí_cou¡
) {

1215 
¥e˚dí˚
 = (
uöt8_t
)
	`©oi
(
tokí
);

1218 
g©eway_ty≥
 = (
uöt8_t
)
	`©oi
(
tokí
);

1221 
Æg‹ôhm
 = (
uöt8_t
)
	`©oi
(
tokí
);

1224 
g©eway
 = 
	`°rdup
(
tokí
);

1225 i‡(!
g©eway
 || (
g©eway_ty≥
 == 0 &&

1226 (
tokí
[0] != '.' ||Åoken[1] != '\0'))) {

1227 
	`LDNS_FREE
(
g©eway
);

1228 
	`LDNS_FREE
(
tokí
);

1229 
	`ldns_buf„r_‰ì
(
°r_buf
);

1230  
LDNS_STATUS_INVALID_STR
;

1234 
publickey
 = 
	`°rdup
(
tokí
);

1237 
	`LDNS_FREE
(
tokí
);

1238 
	`ldns_buf„r_‰ì
(
°r_buf
);

1239  
LDNS_STATUS_INVALID_STR
;

1242 
tokí_cou¡
++;

1245 i‡(!
g©eway
 || !
publickey
) {

1246 i‡(
g©eway
)

1247 
	`LDNS_FREE
(
g©eway
);

1248 i‡(
publickey
)

1249 
	`LDNS_FREE
(
publickey
);

1250 
	`LDNS_FREE
(
tokí
);

1251 
	`ldns_buf„r_‰ì
(
°r_buf
);

1252  
LDNS_STATUS_INVALID_STR
;

1255 i‡(
g©eway_ty≥
 == 1) {

1256 
°©us
 = 
	`ldns_°r2rdf_a
(&
g©eway_rdf
, 
g©eway
);

1257 } i‡(
g©eway_ty≥
 == 2) {

1258 
°©us
 = 
	`ldns_°r2rdf_ØØ
(&
g©eway_rdf
, 
g©eway
);

1259 } i‡(
g©eway_ty≥
 == 3) {

1260 
°©us
 = 
	`ldns_°r2rdf_d«me
(&
g©eway_rdf
, 
g©eway
);

1263 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1264 i‡(
g©eway
)

1265 
	`LDNS_FREE
(
g©eway
);

1266 i‡(
publickey
)

1267 
	`LDNS_FREE
(
publickey
);

1268 
	`LDNS_FREE
(
tokí
);

1269 
	`ldns_buf„r_‰ì
(
°r_buf
);

1270  
LDNS_STATUS_INVALID_STR
;

1273 
°©us
 = 
	`ldns_°r2rdf_b64
(&
publickey_rdf
, 
publickey
);

1275 i‡(
°©us
 !
LDNS_STATUS_OK
) {

1276 i‡(
g©eway
)

1277 
	`LDNS_FREE
(
g©eway
);

1278 i‡(
publickey
)

1279 
	`LDNS_FREE
(
publickey
);

1280 
	`LDNS_FREE
(
tokí
);

1281 
	`ldns_buf„r_‰ì
(
°r_buf
);

1282 i‡(
g©eway_rdf
Ë
	`ldns_rdf_‰ì
(gateway_rdf);

1283  
LDNS_STATUS_INVALID_STR
;

1287 i‡(
g©eway_ty≥
)

1288 
ù£ckey_Àn
 = 3 + ()
	`ldns_rdf_size
(
g©eway_rdf
Ë+ (Ódns_rdf_size(
publickey_rdf
);

1290 
ù£ckey_Àn
 = 3 + ()
	`ldns_rdf_size
(
publickey_rdf
);

1292 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
ù£ckey_Àn
);

1293 if(!
d©a
) {

1294 i‡(
g©eway
)

1295 
	`LDNS_FREE
(
g©eway
);

1296 i‡(
publickey
)

1297 
	`LDNS_FREE
(
publickey
);

1298 
	`LDNS_FREE
(
tokí
);

1299 
	`ldns_buf„r_‰ì
(
°r_buf
);

1300 i‡(
g©eway_rdf
Ë
	`ldns_rdf_‰ì
(gateway_rdf);

1301 i‡(
publickey_rdf
Ë
	`ldns_rdf_‰ì
(publickey_rdf);

1302  
LDNS_STATUS_MEM_ERR
;

1305 
d©a
[0] = 
¥e˚dí˚
;

1306 
d©a
[1] = 
g©eway_ty≥
;

1307 
d©a
[2] = 
Æg‹ôhm
;

1309 i‡(
g©eway_ty≥
) {

1310 
	`mem˝y
(
d©a
 + 3,

1311 
	`ldns_rdf_d©a
(
g©eway_rdf
), 
	`ldns_rdf_size
(gateway_rdf));

1312 
	`mem˝y
(
d©a
 + 3 + 
	`ldns_rdf_size
(
g©eway_rdf
),

1313 
	`ldns_rdf_d©a
(
publickey_rdf
), 
	`ldns_rdf_size
(publickey_rdf));

1315 
	`mem˝y
(
d©a
 + 3,

1316 
	`ldns_rdf_d©a
(
publickey_rdf
), 
	`ldns_rdf_size
(publickey_rdf));

1319 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_IPSECKEY
, (
uöt16_t
Ë
ù£ckey_Àn
, 
d©a
);

1321 i‡(
g©eway
)

1322 
	`LDNS_FREE
(
g©eway
);

1323 i‡(
publickey
)

1324 
	`LDNS_FREE
(
publickey
);

1325 
	`LDNS_FREE
(
tokí
);

1326 
	`ldns_buf„r_‰ì
(
°r_buf
);

1327 
	`ldns_rdf_‰ì
(
g©eway_rdf
);

1328 
	`ldns_rdf_‰ì
(
publickey_rdf
);

1329 
	`LDNS_FREE
(
d©a
);

1330 if(!*
rd
Ë 
LDNS_STATUS_MEM_ERR
;

1331  
LDNS_STATUS_OK
;

1332 
	}
}

1334 
ldns_°©us


1335 
	$ldns_°r2rdf_û≈64
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1337 
a
, 
b
, 
c
, 
d
;

1338 
uöt16_t
 
sh‹ts
[4];

1339 
l
;

1341 i‡(
	`ssˇnf
(
°r
, "%4x:%4x:%4x:%4x%n", &
a
, &
b
, &
c
, &
d
, &
l
) != 4 ||

1342 
l
 !()
	`°æí
(
°r
) ||

1343 
	`°Ωbrk
(
°r
, "+-")

1345  
LDNS_STATUS_INVALID_ILNP64
;

1347 
sh‹ts
[0] = 
	`ht⁄s
(
a
);

1348 
sh‹ts
[1] = 
	`ht⁄s
(
b
);

1349 
sh‹ts
[2] = 
	`ht⁄s
(
c
);

1350 
sh‹ts
[3] = 
	`ht⁄s
(
d
);

1351 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(

1352 
LDNS_RDF_TYPE_ILNP64
, 4 * (
uöt16_t
), &
sh‹ts
);

1354  *
rd
 ? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_MEM_ERR
;

1355 
	}
}

1357 
ldns_°©us


1358 
	$ldns_°r2rdf_eui48
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1360 
a
, 
b
, 
c
, 
d
, 
e
, 
f
;

1361 
uöt8_t
 
byãs
[6];

1362 
l
;

1364 i‡(
	`ssˇnf
(
°r
, "%2x-%2x-%2x-%2x-%2x-%2x%n",

1365 &
a
, &
b
, &
c
, &
d
, &
e
, &
f
, &
l
) != 6 ||

1366 
l
 !()
	`°æí
(
°r
) ||

1367 
	`°Ωbrk
(
°r
, "+-")

1369  
LDNS_STATUS_INVALID_EUI48
;

1371 
byãs
[0] = 
a
;

1372 
byãs
[1] = 
b
;

1373 
byãs
[2] = 
c
;

1374 
byãs
[3] = 
d
;

1375 
byãs
[4] = 
e
;

1376 
byãs
[5] = 
f
;

1377 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_EUI48
, 6, &
byãs
);

1379  *
rd
 ? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_MEM_ERR
;

1380 
	}
}

1382 
ldns_°©us


1383 
	$ldns_°r2rdf_eui64
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1385 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
;

1386 
uöt8_t
 
byãs
[8];

1387 
l
;

1389 i‡(
	`ssˇnf
(
°r
, "%2x-%2x-%2x-%2x-%2x-%2x-%2x-%2x%n",

1390 &
a
, &
b
, &
c
, &
d
, &
e
, &
f
, &
g
, &
h
, &
l
) != 8 ||

1391 
l
 !()
	`°æí
(
°r
) ||

1392 
	`°Ωbrk
(
°r
, "+-")

1394  
LDNS_STATUS_INVALID_EUI64
;

1396 
byãs
[0] = 
a
;

1397 
byãs
[1] = 
b
;

1398 
byãs
[2] = 
c
;

1399 
byãs
[3] = 
d
;

1400 
byãs
[4] = 
e
;

1401 
byãs
[5] = 
f
;

1402 
byãs
[6] = 
g
;

1403 
byãs
[7] = 
h
;

1404 *
rd
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_EUI64
, 8, &
byãs
);

1406  *
rd
 ? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_MEM_ERR
;

1407 
	}
}

1409 
ldns_°©us


1410 
	$ldns_°r2rdf_èg
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1412 
uöt8_t
 *
d©a
;

1413 c⁄° * 
±r
;

1415 i‡(
	`°æí
(
°r
) > 255) {

1416  
LDNS_STATUS_INVALID_TAG
;

1418 
±r
 = 
°r
; *ptr;Ötr++) {

1419 i‡(! 
	`iß um
(*
±r
)) {

1420  
LDNS_STATUS_INVALID_TAG
;

1423 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
	`°æí
(
°r
) + 1);

1424 i‡(!
d©a
) {

1425  
LDNS_STATUS_MEM_ERR
;

1427 
d©a
[0] = 
	`°æí
(
°r
);

1428 
	`mem˝y
(
d©a
 + 1, 
°r
, 
	`°æí
(str));

1430 *
rd
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_TAG
, 
	`°æí
(
°r
Ë+ 1, 
d©a
);

1431 i‡(!*
rd
) {

1432 
	`LDNS_FREE
(
d©a
);

1433  
LDNS_STATUS_MEM_ERR
;

1435  
LDNS_STATUS_OK
;

1436 
	}
}

1438 
ldns_°©us


1439 
	$ldns_°r2rdf_l⁄g_°r
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1441 
uöt8_t
 *
d©a
, *
dp
, 
ch
 = 0;

1442 
size_t
 
Àngth
;

1445 
dp
 = 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
	`°æí
(
°r
));

1446 i‡(! 
d©a
) {

1447  
LDNS_STATUS_MEM_ERR
;

1451 
	`∑r£_ch¨
(&
ch
, &
°r
)) {

1452 *
dp
++ = 
ch
;

1453 i‡(
dp
 - 
d©a
 > 
LDNS_MAX_RDFLEN
) {

1454 
	`LDNS_FREE
(
d©a
);

1455  
LDNS_STATUS_INVALID_STR
;

1458 i‡(! 
°r
) {

1459  
LDNS_STATUS_SYNTAX_BAD_ESCAPE
;

1461 
Àngth
 = (
size_t
)(
dp
 - 
d©a
);

1464 
d©a
 = 
	`LDNS_XREALLOC
(
dp
 = d©a, 
uöt8_t
, 
Àngth
);

1465 i‡(! 
d©a
) {

1466 
	`LDNS_FREE
(
dp
);

1467  
LDNS_STATUS_MEM_ERR
;

1471 *
rd
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_LONG_STR
, 
Àngth
, 
d©a
);

1472 i‡(! *
rd
) {

1473 
	`LDNS_FREE
(
d©a
);

1474  
LDNS_STATUS_MEM_ERR
;

1476  
LDNS_STATUS_OK
;

1477 
	}
}

1479 
ldns_°©us


1480 
	$ldns_°r2rdf_hù
(
ldns_rdf
 **
rd
, c⁄° *
°r
)

1482 c⁄° *
hô
 = 
	`°rchr
(
°r
, ' ') + 1;

1483 c⁄° *
pk
 = 
hô
 =
NULL
 ? NULL : 
	`°rchr
(hit, ' ') + 1;

1484 
size_t
 
hô_size
 = 
hô
 =
NULL
 ? 0

1485 : 
pk
 =
NULL
 ? 
	`°æí
(
hô
Ë: (
size_t
) (pk - hit) - 1;

1486 
size_t
 
pk_size
 = 
pk
 =
NULL
 ? 0 : 
	`°æí
(pk);

1487 
size_t
 
hô_wúe_size
 = (
hô_size
 + 1) / 2;

1488 
size_t
 
pk_wúe_size
 = 
	`ldns_b64_±⁄_ˇlcuœã_size
(
pk_size
);

1489 
size_t
 
rdf_size
 = 4 + 
hô_wúe_size
 + 
pk_wúe_size
;

1491 *
íd±r
;

1492 
Æg‹ôhm
 = 
	`°πﬁ
(
°r
, &
íd±r
, 10);

1494 
uöt8_t
 *
d©a
, *
dp
;

1495 
hi
, 
lo
, 
wrôãn
;

1497 i‡(
hô_size
 =0 || 
pk_size
 == 0 || (hit_size + 1) / 2 > 255

1498 || 
rdf_size
 > 
LDNS_MAX_RDFLEN


1499 || 
Æg‹ôhm
 < 0 ||álgorithm > 255

1500 || (
î∫o
 !0 && 
Æg‹ôhm
 == 0)

1501 || 
íd±r
 =
°r
 ) {

1503  
LDNS_STATUS_SYNTAX_ERR
;

1505 i‡((
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
rdf_size
)Ë=
NULL
) {

1507  
LDNS_STATUS_MEM_ERR
;

1536 
d©a
[0] = (
uöt8_t
Ë
hô_wúe_size
;

1537 
d©a
[1] = (
uöt8_t
Ë
Æg‹ôhm
;

1539 
dp
 = 
d©a
 + 4; *
hô
 && *hit != ' '; dp++) {

1541 i‡((
hi
 = 
	`ldns_hexdigô_to_öt
(*
hô
++)) == -1 ||

1542 (
lo
 = 
	`ldns_hexdigô_to_öt
(*
hô
++)) == -1) {

1544 
	`LDNS_FREE
(
d©a
);

1545  
LDNS_STATUS_INVALID_HEX
;

1547 *
dp
 = (
uöt8_t
Ë
hi
 << 4 | 
lo
;

1549 i‡((
wrôãn
 = 
	`ldns_b64_±⁄
(
pk
, 
dp
, 
pk_wúe_size
)) <= 0) {

1551 
	`LDNS_FREE
(
d©a
);

1552  
LDNS_STATUS_INVALID_B64
;

1558 
pk_wúe_size
 = (
uöt16_t
Ë
wrôãn
;

1559 
	`ldns_wrôe_uöt16
(
d©a
 + 2, 
pk_wúe_size
);

1560 
rdf_size
 = 4 + 
hô_wúe_size
 + 
pk_wúe_size
;

1563 i‡(! (*
rd
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_HIP
, 
rdf_size
, 
d©a
))) {

1565 
	`LDNS_FREE
(
d©a
);

1566  
LDNS_STATUS_MEM_ERR
;

1568  
LDNS_STATUS_OK
;

1569 
	}
}

	@tsig.c

10 
	~<ldns/c⁄fig.h
>

12 
	~<ldns/ldns.h
>

14 
	~<°rögs.h
>

16 #ifde‡
HAVE_SSL


17 
	~<›ís¶/hmac.h
>

18 
	~<›ís¶/md5.h
>

22 
	$ldns_tsig_Æg‹ôhm
(
ldns_tsig_¸edítüls
 *
tc
)

24  
tc
->
Æg‹ôhm
;

25 
	}
}

28 
	$ldns_tsig_key«me
(
ldns_tsig_¸edítüls
 *
tc
)

30  
tc
->
key«me
;

31 
	}
}

34 
	$ldns_tsig_keyd©a
(
ldns_tsig_¸edítüls
 *
tc
)

36  
tc
->
keyd©a
;

37 
	}
}

40 
	$ldns_tsig_key«me_˛⁄e
(
ldns_tsig_¸edítüls
 *
tc
)

42  
	`°rdup
(
tc
->
key«me
);

43 
	}
}

46 
	$ldns_tsig_keyd©a_˛⁄e
(
ldns_tsig_¸edítüls
 *
tc
)

48  
	`°rdup
(
tc
->
keyd©a
);

49 
	}
}

54 
uöt8_t
 *

55 
	$ldns_tsig_¥ï¨e_pkt_wúe
(
uöt8_t
 *
wúe
, 
size_t
 
wúe_Àn
, size_à*
ªsu…_Àn
)

57 
uöt8_t
 *
wúe2
 = 
NULL
;

58 
uöt16_t
 
qd_cou¡
;

59 
uöt16_t
 
™_cou¡
;

60 
uöt16_t
 
ns_cou¡
;

61 
uöt16_t
 
¨_cou¡
;

62 
ldns_º
 *
º
;

64 
size_t
 
pos
;

65 
uöt16_t
 
i
;

67 
ldns_°©us
 
°©us
;

69 if(
wúe_Àn
 < 
LDNS_HEADER_SIZE
) {

70  
NULL
;

73 
qd_cou¡
 = 
	`LDNS_QDCOUNT
(
wúe
);

74 
™_cou¡
 = 
	`LDNS_ANCOUNT
(
wúe
);

75 
ns_cou¡
 = 
	`LDNS_NSCOUNT
(
wúe
);

76 
¨_cou¡
 = 
	`LDNS_ARCOUNT
(
wúe
);

78 i‡(
¨_cou¡
 > 0) {

79 
¨_cou¡
--;

81  
NULL
;

84 
pos
 = 
LDNS_HEADER_SIZE
;

86 
i
 = 0; i < 
qd_cou¡
; i++) {

87 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
wúe_Àn
, &
pos
, 
LDNS_SECTION_QUESTION
);

88 i‡(
°©us
 !
LDNS_STATUS_OK
) {

89  
NULL
;

91 
	`ldns_º_‰ì
(
º
);

94 
i
 = 0; i < 
™_cou¡
; i++) {

95 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
wúe_Àn
, &
pos
, 
LDNS_SECTION_ANSWER
);

96 i‡(
°©us
 !
LDNS_STATUS_OK
) {

97  
NULL
;

99 
	`ldns_º_‰ì
(
º
);

102 
i
 = 0; i < 
ns_cou¡
; i++) {

103 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
wúe_Àn
, &
pos
, 
LDNS_SECTION_AUTHORITY
);

104 i‡(
°©us
 !
LDNS_STATUS_OK
) {

105  
NULL
;

107 
	`ldns_º_‰ì
(
º
);

110 
i
 = 0; i < 
¨_cou¡
; i++) {

111 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
wúe_Àn
, &
pos
,

112 
LDNS_SECTION_ADDITIONAL
);

113 i‡(
°©us
 !
LDNS_STATUS_OK
) {

114  
NULL
;

116 
	`ldns_º_‰ì
(
º
);

119 *
ªsu…_Àn
 = 
pos
;

120 
wúe2
 = 
	`LDNS_XMALLOC
(
uöt8_t
, *
ªsu…_Àn
);

121 if(!
wúe2
) {

122  
NULL
;

124 
	`mem˝y
(
wúe2
, 
wúe
, *
ªsu…_Àn
);

126 
	`ldns_wrôe_uöt16
(
wúe2
 + 
LDNS_ARCOUNT_OFF
, 
¨_cou¡
);

128  
wúe2
;

129 
	}
}

131 #ifde‡
HAVE_SSL


132 c⁄° 
EVP_MD
 *

133 
	$ldns_dige°_fun˘i⁄
(*
«me
)

137 i‡(
	`°rˇ£cmp
(
«me
, "hmac-sha256.") == 0) {

138 #ifde‡
HAVE_EVP_SHA256


139  
	`EVP_sha256
();

141  
NULL
;

143 } i‡(
	`°rˇ£cmp
(
«me
, "hmac-sha1.") == 0) {

144  
	`EVP_sha1
();

145 } i‡(
	`°rˇ£cmp
(
«me
, "hmac-md5.sig-alg.reg.int.") == 0) {

146  
	`EVP_md5
();

148  
NULL
;

150 
	}
}

153 #ifde‡
HAVE_SSL


154 
ldns_°©us


155 
	$ldns_tsig_mac_√w
(
ldns_rdf
 **
tsig_mac
, 
uöt8_t
 *
pkt_wúe
, 
size_t
 
pkt_wúe_size
,

156 c⁄° *
key_d©a
, 
ldns_rdf
 *
key_«me_rdf
,Üdns_rd‡*
fudge_rdf
,

157 
ldns_rdf
 *
Æg‹ôhm_rdf
,Üdns_rd‡*
time_sig√d_rdf
,Üdns_rd‡*
îr‹_rdf
,

158 
ldns_rdf
 *
Ÿhî_d©a_rdf
,Üdns_rd‡*
‹ig_mac_rdf
, 
tsig_timîs_⁄ly
)

160 
ldns_°©us
 
°©us
;

161 *
wúef‹m©
;

162 
wúesize
;

163 *
mac_byãs
 = 
NULL
;

164 *
key_byãs
 = 
NULL
;

165 
key_size
;

166 c⁄° 
EVP_MD
 *
dige°î
;

167 *
Æg‹ôhm_«me
 = 
NULL
;

168 
md_Àn
 = 
EVP_MAX_MD_SIZE
;

169 
ldns_rdf
 *
ªsu…
 = 
NULL
;

170 
ldns_buf„r
 *
d©a_buf„r
 = 
NULL
;

171 
ldns_rdf
 *
ˇn⁄iˇl_key_«me_rdf
 = 
NULL
;

172 
ldns_rdf
 *
ˇn⁄iˇl_Æg‹ôhm_rdf
 = 
NULL
;

174 i‡(
key_«me_rdf
 =
NULL
 || 
Æg‹ôhm_rdf
 == NULL) {

175  
LDNS_STATUS_NULL
;

177 
ˇn⁄iˇl_key_«me_rdf
 = 
	`ldns_rdf_˛⁄e
(
key_«me_rdf
);

178 i‡(
ˇn⁄iˇl_key_«me_rdf
 =
NULL
) {

179  
LDNS_STATUS_MEM_ERR
;

181 
ˇn⁄iˇl_Æg‹ôhm_rdf
 = 
	`ldns_rdf_˛⁄e
(
Æg‹ôhm_rdf
);

182 i‡(
ˇn⁄iˇl_Æg‹ôhm_rdf
 =
NULL
) {

183 
	`ldns_rdf_dìp_‰ì
(
ˇn⁄iˇl_key_«me_rdf
);

184  
LDNS_STATUS_MEM_ERR
;

189 
d©a_buf„r
 = 
	`ldns_buf„r_√w
(
LDNS_MAX_PACKETLEN
);

190 i‡(!
d©a_buf„r
) {

191 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

192 
˛ón
;

195 i‡(
‹ig_mac_rdf
) {

196 (Ë
	`ldns_rdf2buf„r_wúe
(
d©a_buf„r
, 
‹ig_mac_rdf
);

198 
	`ldns_buf„r_wrôe
(
d©a_buf„r
, 
pkt_wúe
, 
pkt_wúe_size
);

199 i‡(!
tsig_timîs_⁄ly
) {

200 
	`ldns_d«me2ˇn⁄iˇl
(
ˇn⁄iˇl_key_«me_rdf
);

201 ()
	`ldns_rdf2buf„r_wúe
(
d©a_buf„r
,

202 
ˇn⁄iˇl_key_«me_rdf
);

203 
	`ldns_buf„r_wrôe_u16
(
d©a_buf„r
, 
LDNS_RR_CLASS_ANY
);

204 
	`ldns_buf„r_wrôe_u32
(
d©a_buf„r
, 0);

205 
	`ldns_d«me2ˇn⁄iˇl
(
ˇn⁄iˇl_Æg‹ôhm_rdf
);

206 ()
	`ldns_rdf2buf„r_wúe
(
d©a_buf„r
,

207 
ˇn⁄iˇl_Æg‹ôhm_rdf
);

209 ()
	`ldns_rdf2buf„r_wúe
(
d©a_buf„r
, 
time_sig√d_rdf
);

210 ()
	`ldns_rdf2buf„r_wúe
(
d©a_buf„r
, 
fudge_rdf
);

211 i‡(!
tsig_timîs_⁄ly
) {

212 ()
	`ldns_rdf2buf„r_wúe
(
d©a_buf„r
, 
îr‹_rdf
);

213 ()
	`ldns_rdf2buf„r_wúe
(
d©a_buf„r
, 
Ÿhî_d©a_rdf
);

216 
wúef‹m©
 = (*Ë
d©a_buf„r
->
_d©a
;

217 
wúesize
 = (Ë
	`ldns_buf„r_posôi⁄
(
d©a_buf„r
);

219 
Æg‹ôhm_«me
 = 
	`ldns_rdf2°r
(
Æg‹ôhm_rdf
);

220 if(!
Æg‹ôhm_«me
) {

221 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

222 
˛ón
;

226 
key_byãs
 = 
	`LDNS_XMALLOC
(,

227 
	`ldns_b64_±⁄_ˇlcuœã_size
(
	`°æí
(
key_d©a
)));

228 if(!
key_byãs
) {

229 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

230 
˛ón
;

232 
key_size
 = 
	`ldns_b64_±⁄
(
key_d©a
, 
key_byãs
,

233 
	`ldns_b64_±⁄_ˇlcuœã_size
(
	`°æí
(
key_d©a
)));

234 i‡(
key_size
 < 0) {

235 
°©us
 = 
LDNS_STATUS_INVALID_B64
;

236 
˛ón
;

240 
mac_byãs
 = 
	`LDNS_XMALLOC
(, 
md_Àn
+2);

241 if(!
mac_byãs
) {

242 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

243 
˛ón
;

245 
	`mem£t
(
mac_byãs
, 0, 
md_Àn
+2);

247 
dige°î
 = 
	`ldns_dige°_fun˘i⁄
(
Æg‹ôhm_«me
);

249 i‡(
dige°î
) {

250 (Ë
	`HMAC
(
dige°î
, 
key_byãs
, 
key_size
, (*)
wúef‹m©
,

251 (
size_t
Ë
wúesize
, 
mac_byãs
 + 2, &
md_Àn
);

253 
	`ldns_wrôe_uöt16
(
mac_byãs
, 
md_Àn
);

254 
ªsu…
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_INT16_DATA
, 
md_Àn
 + 2,

255 
mac_byãs
);

257 
°©us
 = 
LDNS_STATUS_CRYPTO_UNKNOWN_ALGO
;

258 
˛ón
;

260 *
tsig_mac
 = 
ªsu…
;

261 
°©us
 = 
LDNS_STATUS_OK
;

262 
˛ón
:

263 
	`LDNS_FREE
(
mac_byãs
);

264 
	`LDNS_FREE
(
key_byãs
);

265 
	`LDNS_FREE
(
Æg‹ôhm_«me
);

266 
	`ldns_buf„r_‰ì
(
d©a_buf„r
);

267 
	`ldns_rdf_dìp_‰ì
(
ˇn⁄iˇl_Æg‹ôhm_rdf
);

268 
	`ldns_rdf_dìp_‰ì
(
ˇn⁄iˇl_key_«me_rdf
);

269  
°©us
;

270 
	}
}

274 #ifde‡
HAVE_SSL


275 
boﬁ


276 
	$ldns_pkt_tsig_vîify
(
ldns_pkt
 *
pkt
, 
uöt8_t
 *
wúe
, 
size_t
 
wúñí
, c⁄° *
key_«me
,

277 c⁄° *
key_d©a
, 
ldns_rdf
 *
‹ig_mac_rdf
)

279  
	`ldns_pkt_tsig_vîify_√xt
(
pkt
, 
wúe
, 
wúñí
, 
key_«me
, 
key_d©a
, 
‹ig_mac_rdf
, 0);

280 
	}
}

282 
boﬁ


283 
	$ldns_pkt_tsig_vîify_√xt
(
ldns_pkt
 *
pkt
, 
uöt8_t
 *
wúe
, 
size_t
 
wúñí
, c⁄° * 
key_«me
,

284 c⁄° *
key_d©a
, 
ldns_rdf
 *
‹ig_mac_rdf
, 
tsig_timîs_⁄ly
)

286 
ldns_rdf
 *
fudge_rdf
;

287 
ldns_rdf
 *
Æg‹ôhm_rdf
;

288 
ldns_rdf
 *
time_sig√d_rdf
;

289 
ldns_rdf
 *
‹ig_id_rdf
;

290 
ldns_rdf
 *
îr‹_rdf
;

291 
ldns_rdf
 *
Ÿhî_d©a_rdf
;

292 
ldns_rdf
 *
pkt_mac_rdf
;

293 
ldns_rdf
 *
my_mac_rdf
;

294 
ldns_rdf
 *
key_«me_rdf
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
key_«me
);

295 
uöt16_t
 
pkt_id
, 
‹ig_pkt_id
;

296 
ldns_°©us
 
°©us
;

298 
uöt8_t
 *
¥ï¨ed_wúe
 = 
NULL
;

299 
size_t
 
¥ï¨ed_wúe_size
 = 0;

301 
ldns_º
 *
‹ig_tsig
 = 
	`ldns_pkt_tsig
(
pkt
);

303 i‡(!
‹ig_tsig
 || 
	`ldns_º_rd_cou¡
(orig_tsig) <= 6) {

304 
	`ldns_rdf_dìp_‰ì
(
key_«me_rdf
);

305  
Ál£
;

307 
Æg‹ôhm_rdf
 = 
	`ldns_º_rdf
(
‹ig_tsig
, 0);

308 
time_sig√d_rdf
 = 
	`ldns_º_rdf
(
‹ig_tsig
, 1);

309 
fudge_rdf
 = 
	`ldns_º_rdf
(
‹ig_tsig
, 2);

310 
pkt_mac_rdf
 = 
	`ldns_º_rdf
(
‹ig_tsig
, 3);

311 
‹ig_id_rdf
 = 
	`ldns_º_rdf
(
‹ig_tsig
, 4);

312 
îr‹_rdf
 = 
	`ldns_º_rdf
(
‹ig_tsig
, 5);

313 
Ÿhî_d©a_rdf
 = 
	`ldns_º_rdf
(
‹ig_tsig
, 6);

316 
	`ldns_pkt_£t_tsig
(
pkt
, 
NULL
);

318 
pkt_id
 = 
	`ldns_pkt_id
(
pkt
);

319 
‹ig_pkt_id
 = 
	`ldns_rdf2«tive_öt16
(
‹ig_id_rdf
);

320 
	`ldns_pkt_£t_id
(
pkt
, 
‹ig_pkt_id
);

322 
¥ï¨ed_wúe
 = 
	`ldns_tsig_¥ï¨e_pkt_wúe
(
wúe
, 
wúñí
, &
¥ï¨ed_wúe_size
);

324 
°©us
 = 
	`ldns_tsig_mac_√w
(&
my_mac_rdf
, 
¥ï¨ed_wúe
, 
¥ï¨ed_wúe_size
,

325 
key_d©a
, 
key_«me_rdf
, 
fudge_rdf
, 
Æg‹ôhm_rdf
,

326 
time_sig√d_rdf
, 
îr‹_rdf
, 
Ÿhî_d©a_rdf
, 
‹ig_mac_rdf
, 
tsig_timîs_⁄ly
);

328 
	`LDNS_FREE
(
¥ï¨ed_wúe
);

330 i‡(
°©us
 !
LDNS_STATUS_OK
) {

331 
	`ldns_rdf_dìp_‰ì
(
key_«me_rdf
);

332  
Ál£
;

335 
	`ldns_pkt_£t_tsig
(
pkt
, 
‹ig_tsig
);

336 
	`ldns_pkt_£t_id
(
pkt
, 
pkt_id
);

338 
	`ldns_rdf_dìp_‰ì
(
key_«me_rdf
);

340 i‡(
	`ldns_rdf_com∑ª
(
pkt_mac_rdf
, 
my_mac_rdf
) == 0) {

341 
	`ldns_rdf_dìp_‰ì
(
my_mac_rdf
);

342  
åue
;

344 
	`ldns_rdf_dìp_‰ì
(
my_mac_rdf
);

345  
Ál£
;

347 
	}
}

350 #ifde‡
HAVE_SSL


351 
ldns_°©us


352 
	$ldns_pkt_tsig_sign
(
ldns_pkt
 *
pkt
, c⁄° *
key_«me
, c⁄° *
key_d©a
,

353 
uöt16_t
 
fudge
, c⁄° *
Æg‹ôhm_«me
, 
ldns_rdf
 *
quîy_mac
)

355  
	`ldns_pkt_tsig_sign_√xt
(
pkt
, 
key_«me
, 
key_d©a
, 
fudge
, 
Æg‹ôhm_«me
, 
quîy_mac
, 0);

356 
	}
}

358 
ldns_°©us


359 
	$ldns_pkt_tsig_sign_√xt
(
ldns_pkt
 *
pkt
, c⁄° *
key_«me
, c⁄° *
key_d©a
,

360 
uöt16_t
 
fudge
, c⁄° *
Æg‹ôhm_«me
, 
ldns_rdf
 *
quîy_mac
, 
tsig_timîs_⁄ly
)

362 
ldns_º
 *
tsig_º
;

363 
ldns_rdf
 *
key_«me_rdf
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
key_«me
);

364 
ldns_rdf
 *
fudge_rdf
 = 
NULL
;

365 
ldns_rdf
 *
‹ig_id_rdf
 = 
NULL
;

366 
ldns_rdf
 *
Æg‹ôhm_rdf
;

367 
ldns_rdf
 *
îr‹_rdf
 = 
NULL
;

368 
ldns_rdf
 *
mac_rdf
 = 
NULL
;

369 
ldns_rdf
 *
Ÿhî_d©a_rdf
 = 
NULL
;

371 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

373 
uöt8_t
 *
pkt_wúe
 = 
NULL
;

374 
size_t
 
pkt_wúe_Àn
;

376 
timevÆ
 
tv_time_sig√d
;

377 
uöt8_t
 *
time_sig√d
 = 
NULL
;

378 
ldns_rdf
 *
time_sig√d_rdf
 = 
NULL
;

380 
Æg‹ôhm_rdf
 = 
	`ldns_rdf_√w_‰m_°r
(
LDNS_RDF_TYPE_DNAME
, 
Æg‹ôhm_«me
);

381 if(!
key_«me_rdf
 || !
Æg‹ôhm_rdf
) {

382 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

383 
˛ón
;

388 i‡(
	`gëtimeofday
(&
tv_time_sig√d
, 
NULL
) == 0) {

389 
time_sig√d
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 6);

390 if(!
time_sig√d
) {

391 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

392 
˛ón
;

394 
	`ldns_wrôe_uöt64_as_uöt48
(
time_sig√d
,

395 (
uöt64_t
)
tv_time_sig√d
.
tv_£c
);

397 
°©us
 = 
LDNS_STATUS_INTERNAL_ERR
;

398 
˛ón
;

401 
time_sig√d_rdf
 = 
	`ldns_rdf_√w
(
LDNS_RDF_TYPE_TSIGTIME
, 6, 
time_sig√d
);

402 if(!
time_sig√d_rdf
) {

403 
	`LDNS_FREE
(
time_sig√d
);

404 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

405 
˛ón
;

408 
fudge_rdf
 = 
	`ldns_«tive2rdf_öt16
(
LDNS_RDF_TYPE_INT16
, 
fudge
);

410 
‹ig_id_rdf
 = 
	`ldns_«tive2rdf_öt16
(
LDNS_RDF_TYPE_INT16
, 
	`ldns_pkt_id
(
pkt
));

412 
îr‹_rdf
 = 
	`ldns_«tive2rdf_öt16
(
LDNS_RDF_TYPE_INT16
, 0);

414 
Ÿhî_d©a_rdf
 = 
	`ldns_«tive2rdf_öt16_d©a
(0, 
NULL
);

416 if(!
fudge_rdf
 || !
‹ig_id_rdf
 || !
îr‹_rdf
 || !
Ÿhî_d©a_rdf
) {

417 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

418 
˛ón
;

421 i‡(
	`ldns_pkt2wúe
(&
pkt_wúe
, 
pkt
, &
pkt_wúe_Àn
Ë!
LDNS_STATUS_OK
) {

422 
°©us
 = 
LDNS_STATUS_ERR
;

423 
˛ón
;

426 
°©us
 = 
	`ldns_tsig_mac_√w
(&
mac_rdf
, 
pkt_wúe
, 
pkt_wúe_Àn
,

427 
key_d©a
, 
key_«me_rdf
, 
fudge_rdf
, 
Æg‹ôhm_rdf
,

428 
time_sig√d_rdf
, 
îr‹_rdf
, 
Ÿhî_d©a_rdf
, 
quîy_mac
, 
tsig_timîs_⁄ly
);

430 i‡(!
mac_rdf
) {

431 
˛ón
;

434 
	`LDNS_FREE
(
pkt_wúe
);

437 
tsig_º
 = 
	`ldns_º_√w
();

438 if(!
tsig_º
) {

439 
°©us
 = 
LDNS_STATUS_MEM_ERR
;

440 
˛ón
;

442 
	`ldns_º_£t_ow√r
(
tsig_º
, 
key_«me_rdf
);

443 
	`ldns_º_£t_˛ass
(
tsig_º
, 
LDNS_RR_CLASS_ANY
);

444 
	`ldns_º_£t_ty≥
(
tsig_º
, 
LDNS_RR_TYPE_TSIG
);

445 
	`ldns_º_£t_âl
(
tsig_º
, 0);

447 
	`ldns_º_push_rdf
(
tsig_º
, 
Æg‹ôhm_rdf
);

448 
	`ldns_º_push_rdf
(
tsig_º
, 
time_sig√d_rdf
);

449 
	`ldns_º_push_rdf
(
tsig_º
, 
fudge_rdf
);

450 
	`ldns_º_push_rdf
(
tsig_º
, 
mac_rdf
);

451 
	`ldns_º_push_rdf
(
tsig_º
, 
‹ig_id_rdf
);

452 
	`ldns_º_push_rdf
(
tsig_º
, 
îr‹_rdf
);

453 
	`ldns_º_push_rdf
(
tsig_º
, 
Ÿhî_d©a_rdf
);

455 
	`ldns_pkt_£t_tsig
(
pkt
, 
tsig_º
);

457  
°©us
;

459 
˛ón
:

460 
	`LDNS_FREE
(
pkt_wúe
);

461 
	`ldns_rdf_‰ì
(
key_«me_rdf
);

462 
	`ldns_rdf_‰ì
(
Æg‹ôhm_rdf
);

463 
	`ldns_rdf_‰ì
(
time_sig√d_rdf
);

464 
	`ldns_rdf_‰ì
(
fudge_rdf
);

465 
	`ldns_rdf_‰ì
(
‹ig_id_rdf
);

466 
	`ldns_rdf_‰ì
(
îr‹_rdf
);

467 
	`ldns_rdf_‰ì
(
Ÿhî_d©a_rdf
);

468  
°©us
;

469 
	}
}

	@update.c

10 
	~<ldns/c⁄fig.h
>

12 
	~<ldns/ldns.h
>

14 
	~<°rögs.h
>

15 
	~<°dlib.h
>

16 
	~<limôs.h
>

26 
ldns_pkt
 *

27 
	$ldns_upd©e_pkt_√w
(
ldns_rdf
 *
z⁄e_rdf
, 
ldns_º_˛ass
 
c
,

28 
ldns_º_li°
 *
¥_ºli°
,Üdns_º_li° *
up_ºli°
,Üdns_º_li° *
ad_ºli°
)

30 
ldns_pkt
 *
p
;

32 i‡(!
z⁄e_rdf
 || !
up_ºli°
) {

33  
NULL
;

36 i‡(
c
 == 0) {

37 
c
 = 
LDNS_RR_CLASS_IN
;

41 
p
 = 
	`ldns_pkt_quîy_√w
(
z⁄e_rdf
, 
LDNS_RR_TYPE_SOA
, 
c
, 
LDNS_RD
);

42 i‡(!
p
) {

43  
NULL
;

45 
z⁄e_rdf
 = 
NULL
;

47 
	`ldns_pkt_£t_›code
(
p
, 
LDNS_PACKET_UPDATE
);

49 
	`ldns_º_li°_dìp_‰ì
(
p
->
_auth‹ôy
);

51 
	`ldns_pkt_£t_auth‹ôy
(
p
, 
	`ldns_º_li°_˛⁄e
(
up_ºli°
));

53 
	`ldns_upd©e_£t_upcou¡
(
p
, 
	`ldns_º_li°_º_cou¡
(
up_ºli°
));

55 i‡(
¥_ºli°
) {

56 
	`ldns_º_li°_dìp_‰ì
(
p
->
_™swî
);

57 
	`ldns_pkt_£t_™swî
(
p
, 
	`ldns_º_li°_˛⁄e
(
¥_ºli°
));

58 
	`ldns_upd©e_£t_¥cou¡
(
p
, 
	`ldns_º_li°_º_cou¡
(
¥_ºli°
));

61 i‡(
ad_ºli°
) {

62 
	`ldns_º_li°_dìp_‰ì
(
p
->
_addôi⁄Æ
);

63 
	`ldns_pkt_£t_addôi⁄Æ
(
p
, 
	`ldns_º_li°_˛⁄e
(
ad_ºli°
));

64 
	`ldns_upd©e_£t_adcou¡
(
p
, 
	`ldns_º_li°_º_cou¡
(
ad_ºli°
));

66  
p
;

67 
	}
}

69 
ldns_°©us


70 
	$ldns_upd©e_pkt_tsig_add
(
ldns_pkt
 *
p
, 
ldns_ªsﬁvî
 *
r
)

72 #ifde‡
HAVE_SSL


73 
uöt16_t
 
fudge
 = 300;

74 i‡(
	`ldns_ªsﬁvî_tsig_key«me
(
r
Ë&& 
	`ldns_ªsﬁvî_tsig_keyd©a
(r))

75  
	`ldns_pkt_tsig_sign
(
p
, 
	`ldns_ªsﬁvî_tsig_key«me
(
r
),

76 
	`ldns_ªsﬁvî_tsig_keyd©a
(
r
), 
fudge
,

77 
	`ldns_ªsﬁvî_tsig_Æg‹ôhm
(
r
), 
NULL
);

80 ()
p
;

81 ()
r
;

84  
LDNS_STATUS_OK
;

85 
	}
}

89 
ldns_°©us


90 
	$ldns_upd©e_sﬂ_m«me
(
ldns_rdf
 *
z⁄e
, 
ldns_ªsﬁvî
 *
r
,

91 
ldns_º_˛ass
 
c
, 
ldns_rdf
 **
m«me
)

93 
ldns_º
 *
sﬂ_º
;

94 
ldns_pkt
 *
quîy
, *
ª•
;

97 
quîy
 = 
	`ldns_pkt_quîy_√w
(
	`ldns_rdf_˛⁄e
(
z⁄e
), 
LDNS_RR_TYPE_SOA
,

98 
c
, 
LDNS_RD
);

99 i‡(!
quîy
) {

100  
LDNS_STATUS_ERR
;

103 
	`ldns_pkt_£t_øndom_id
(
quîy
);

104 i‡(
	`ldns_ªsﬁvî_£nd_pkt
(&
ª•
, 
r
, 
quîy
Ë!
LDNS_STATUS_OK
) {

105 
	`ldns_pkt_‰ì
(
quîy
);

106  
LDNS_STATUS_ERR
;

108 
	`ldns_pkt_‰ì
(
quîy
);

109 i‡(!
ª•
) {

110  
LDNS_STATUS_ERR
;

114 *
m«me
 = 
NULL
;

115 (
sﬂ_º
 = 
	`ldns_º_li°_p›_º
(
	`ldns_pkt_™swî
(
ª•
)))) {

116 i‡(
	`ldns_º_gë_ty≥
(
sﬂ_º
Ë!
LDNS_RR_TYPE_SOA


117 || 
	`ldns_º_rdf
(
sﬂ_º
, 0Ë=
NULL
)

120 *
m«me
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_rdf
(
sﬂ_º
, 0));

123 
	`ldns_pkt_‰ì
(
ª•
);

125  *
m«me
 ? 
LDNS_STATUS_OK
 : 
LDNS_STATUS_ERR
;

126 
	}
}

129 
ldns_°©us


130 
	$ldns_upd©e_sﬂ_z⁄e_m«me
(c⁄° *
fqdn
, 
ldns_ªsﬁvî
 *
r
,

131 
ldns_º_˛ass
 
c
, 
ldns_rdf
 **
z⁄e_rdf
,Üdns_rd‡**
m«me_rdf
)

133 
ldns_º
 *
sﬂ_º
, *
º
;

134 
ldns_rdf
 *
sﬂ_z⁄e
 = 
NULL
, *
sﬂ_m«me
 = NULL;

135 
ldns_rdf
 *
ùaddr
, *
fqdn_rdf
, *
tmp
;

136 
ldns_rdf
 **
n¶i°
;

137 
ldns_pkt
 *
quîy
, *
ª•
;

138 
size_t
 
i
;

146 
fqdn_rdf
 = 
	`ldns_d«me_√w_‰m_°r
(
fqdn
);

147 
quîy
 = 
	`ldns_pkt_quîy_√w
(
fqdn_rdf
, 
LDNS_RR_TYPE_SOA
, 
c
, 
LDNS_RD
);

148 i‡(!
quîy
) {

149  
LDNS_STATUS_ERR
;

151 
fqdn_rdf
 = 
NULL
;

153 
	`ldns_pkt_£t_øndom_id
(
quîy
);

154 i‡(
	`ldns_ªsﬁvî_£nd_pkt
(&
ª•
, 
r
, 
quîy
Ë!
LDNS_STATUS_OK
) {

155 
	`ldns_pkt_‰ì
(
quîy
);

156  
LDNS_STATUS_ERR
;

158 
	`ldns_pkt_‰ì
(
quîy
);

159 i‡(!
ª•
) {

160  
LDNS_STATUS_ERR
;

164 (
sﬂ_º
 = 
	`ldns_º_li°_p›_º
(
	`ldns_pkt_auth‹ôy
(
ª•
)))) {

165 i‡(
	`ldns_º_gë_ty≥
(
sﬂ_º
Ë!
LDNS_RR_TYPE_SOA


166 || 
	`ldns_º_rdf
(
sﬂ_º
, 0Ë=
NULL
)

169 
sﬂ_m«me
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_rdf
(
sﬂ_º
, 0));

172 
	`ldns_pkt_‰ì
(
ª•
);

173 i‡(!
sﬂ_º
) {

174  
LDNS_STATUS_ERR
;

178 
quîy
 = 
	`ldns_pkt_quîy_√w
(
sﬂ_m«me
, 
LDNS_RR_TYPE_A
, 
c
, 
LDNS_RD
);

179 i‡(!
quîy
) {

180  
LDNS_STATUS_ERR
;

182 
sﬂ_m«me
 = 
NULL
;

184 
	`ldns_pkt_£t_øndom_id
(
quîy
);

185 i‡(
	`ldns_ªsﬁvî_£nd_pkt
(&
ª•
, 
r
, 
quîy
Ë!
LDNS_STATUS_OK
) {

186 
	`ldns_pkt_‰ì
(
quîy
);

187  
LDNS_STATUS_ERR
;

189 
	`ldns_pkt_‰ì
(
quîy
);

190 i‡(!
ª•
) {

191  
LDNS_STATUS_ERR
;

194 i‡(
	`ldns_pkt_™cou¡
(
ª•
) == 0) {

195 
	`ldns_pkt_‰ì
(
ª•
);

196  
LDNS_STATUS_ERR
;

200 
º
 = 
	`ldns_º_li°_p›_º
(
	`ldns_pkt_™swî
(
ª•
));

201 
ùaddr
 = 
	`ldns_º_rdf
(
º
, 0);

204 
n¶i°
 = 
	`ldns_ªsﬁvî_«me£rvîs
(
r
);

205 
i
 = 0; i < 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
); i++) {

206 i‡(
	`ldns_rdf_com∑ª
(
ùaddr
, 
n¶i°
[
i
]) == 0) {

207 i‡(
i
) {

208 
tmp
 = 
n¶i°
[0];

209 
n¶i°
[0] =Ç¶i°[
i
];

210 
n¶i°
[
i
] = 
tmp
;

215 i‡(
i
 >
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
)) {

217 (Ë
	`ldns_ªsﬁvî_push_«me£rvî
(
r
, 
ùaddr
);

218 
n¶i°
 = 
	`ldns_ªsﬁvî_«me£rvîs
(
r
);

219 
i
 = 
	`ldns_ªsﬁvî_«me£rvî_cou¡
(
r
) - 1;

220 
tmp
 = 
n¶i°
[0];

221 
n¶i°
[0] =Ç¶i°[
i
];

222 
n¶i°
[
i
] = 
tmp
;

224 
	`ldns_pkt_‰ì
(
ª•
);

227 
	`ldns_ªsﬁvî_£t_øndom
(
r
, 
Ál£
);

230 
fqdn_rdf
 = 
	`ldns_d«me_√w_‰m_°r
(
fqdn
);

231 
quîy
 = 
	`ldns_pkt_quîy_√w
(
fqdn_rdf
, 
LDNS_RR_TYPE_SOA
, 
c
, 
LDNS_RD
);

232 i‡(!
quîy
) {

233  
LDNS_STATUS_ERR
;

235 
fqdn_rdf
 = 
NULL
;

237 
	`ldns_pkt_£t_øndom_id
(
quîy
);

238 i‡(
	`ldns_ªsﬁvî_£nd_pkt
(&
ª•
, 
r
, 
quîy
Ë!
LDNS_STATUS_OK
) {

239 
	`ldns_pkt_‰ì
(
quîy
);

240  
LDNS_STATUS_ERR
;

242 
	`ldns_pkt_‰ì
(
quîy
);

243 i‡(!
ª•
) {

244  
LDNS_STATUS_ERR
;

248 (
sﬂ_º
 = 
	`ldns_º_li°_p›_º
(
	`ldns_pkt_auth‹ôy
(
ª•
)))) {

249 i‡(
	`ldns_º_gë_ty≥
(
sﬂ_º
Ë!
LDNS_RR_TYPE_SOA


250 || 
	`ldns_º_rdf
(
sﬂ_º
, 0Ë=
NULL
)

253 
sﬂ_m«me
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_rdf
(
sﬂ_º
, 0));

254 
sﬂ_z⁄e
 = 
	`ldns_rdf_˛⁄e
(
	`ldns_º_ow√r
(
sﬂ_º
));

257 
	`ldns_pkt_‰ì
(
ª•
);

258 i‡(!
sﬂ_º
) {

259  
LDNS_STATUS_ERR
;

263 *
z⁄e_rdf
 = 
sﬂ_z⁄e
;

264 *
m«me_rdf
 = 
sﬂ_m«me
;

265  
LDNS_STATUS_OK
;

266 
	}
}

272 
uöt16_t


273 
	$ldns_upd©e_zocou¡
(c⁄° 
ldns_pkt
 *
p
)

275  
	`ldns_pkt_qdcou¡
(
p
);

276 
	}
}

278 
uöt16_t


279 
	$ldns_upd©e_¥cou¡
(c⁄° 
ldns_pkt
 *
p
)

281  
	`ldns_pkt_™cou¡
(
p
);

282 
	}
}

284 
uöt16_t


285 
	$ldns_upd©e_upcou¡
(c⁄° 
ldns_pkt
 *
p
)

287  
	`ldns_pkt_nscou¡
(
p
);

288 
	}
}

290 
uöt16_t


291 
	$ldns_upd©e_ad
(c⁄° 
ldns_pkt
 *
p
)

293  
	`ldns_pkt_¨cou¡
(
p
);

294 
	}
}

297 
	$ldns_upd©e_£t_zo
(
ldns_pkt
 *
p
, 
uöt16_t
 
v
)

299 
	`ldns_pkt_£t_qdcou¡
(
p
, 
v
);

300 
	}
}

303 
	$ldns_upd©e_£t_¥cou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
v
)

305 
	`ldns_pkt_£t_™cou¡
(
p
, 
v
);

306 
	}
}

309 
	$ldns_upd©e_£t_upcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
v
)

311 
	`ldns_pkt_£t_nscou¡
(
p
, 
v
);

312 
	}
}

315 
	$ldns_upd©e_£t_adcou¡
(
ldns_pkt
 *
p
, 
uöt16_t
 
v
)

317 
	`ldns_pkt_£t_¨cou¡
(
p
, 
v
);

318 
	}
}

	@util.c

13 
	~<ldns/c⁄fig.h
>

15 
	~<ldns/rd©a.h
>

16 
	~<ldns/º.h
>

17 
	~<ldns/utû.h
>

18 
	~<°rögs.h
>

19 
	~<°dlib.h
>

20 
	~<°dio.h
>

21 
	~<sys/time.h
>

22 
	~<time.h
>

23 
	~<˘y≥.h
>

25 #ifde‡
HAVE_SSL


26 
	~<›ís¶/ønd.h
>

29 
ldns_lookup_èbÀ
 *

30 
	$ldns_lookup_by_«me
(
ldns_lookup_èbÀ
 *
èbÀ
, c⁄° *
«me
)

32 
èbÀ
->
«me
 !
NULL
) {

33 i‡(
	`°rˇ£cmp
(
«me
, 
èbÀ
->name) == 0)

34  
èbÀ
;

35 
èbÀ
++;

37  
NULL
;

38 
	}
}

40 
ldns_lookup_èbÀ
 *

41 
	$ldns_lookup_by_id
(
ldns_lookup_èbÀ
 *
èbÀ
, 
id
)

43 
èbÀ
->
«me
 !
NULL
) {

44 i‡(
èbÀ
->
id
 == id)

45  
èbÀ
;

46 
èbÀ
++;

48  
NULL
;

49 
	}
}

52 
	$ldns_gë_bô
(
uöt8_t
 
bôs
[], 
size_t
 
ödex
)

58  (Ë(
bôs
[
ödex
 / 8] & (1 << (7 - index % 8)));

59 
	}
}

62 
	$ldns_gë_bô_r
(
uöt8_t
 
bôs
[], 
size_t
 
ödex
)

68  (Ë
bôs
[
ödex
 / 8] & (1 << (index % 8));

69 
	}
}

72 
	$ldns_£t_bô
(
uöt8_t
 *
byã
, 
bô_ƒ
, 
boﬁ
 
vÆue
)

78 i‡(
bô_ƒ
 >= 0 && bit_nr < 8) {

79 i‡(
vÆue
) {

80 *
byã
 = *byã | (0x01 << 
bô_ƒ
);

82 *
byã
 = *byã & ~(0x01 << 
bô_ƒ
);

85 
	}
}

88 
	$ldns_hexdigô_to_öt
(
ch
)

90 
ch
) {

110 
	}
}

113 
	$ldns_öt_to_hexdigô
(
i
)

115 
i
) {

133 
	`ab‹t
();

135 
	}
}

138 
	$ldns_hex°rög_to_d©a
(
uöt8_t
 *
d©a
, c⁄° *
°r
)

140 
size_t
 
i
;

142 i‡(!
°r
 || !
d©a
) {

146 i‡(
	`°æí
(
°r
) % 2 != 0) {

150 
i
 = 0; i < 
	`°æí
(
°r
) / 2; i++) {

151 
d©a
[
i
] =

152 16 * (
uöt8_t
Ë
	`ldns_hexdigô_to_öt
(
°r
[
i
*2]) +

153 (
uöt8_t
Ë
	`ldns_hexdigô_to_öt
(
°r
[
i
*2 + 1]);

156  (Ë
i
;

157 
	}
}

160 
	$ldns_vîsi⁄
()

162  (*)
LDNS_VERSION
;

163 
	}
}

166 c⁄° 
	gmdays
[] = {

170 
	#LDNS_MOD
(
x
,
y
Ë(((xË% (yË< 0Ë? ((xË% (yË+ (y)Ë: ((xË% (y)))

	)

171 
	#LDNS_DIV
(
x
,
y
Ë(((xË% (yË< 0Ë? ((xË/ (yË- 1 ) : ((xË/ (y)))

	)

174 
	$is_À≠_yór
(
yór
)

176  
	`LDNS_MOD
(
yór
, 4) == 0 && (LDNS_MOD(year, 100) != 0

177 || 
	`LDNS_MOD
(
yór
, 400) == 0);

178 
	}
}

181 
	$À≠_days
(
y1
, 
y2
)

183 --
y1
;

184 --
y2
;

185  (
	`LDNS_DIV
(
y2
, 4Ë- LDNS_DIV(
y1
, 4)) -

186 (
	`LDNS_DIV
(
y2
, 100Ë- LDNS_DIV(
y1
, 100)) +

187 (
	`LDNS_DIV
(
y2
, 400Ë- LDNS_DIV(
y1
, 400));

188 
	}
}

193 
time_t


194 
	$ldns_mktime_‰om_utc
(c⁄° 
tm
 *tm)

196 
yór
 = 1900 + 
tm
->
tm_yór
;

197 
time_t
 
days
 = 365 * (—ime_tË
yór
 - 1970Ë+ 
	`À≠_days
(1970, year);

198 
time_t
 
hours
;

199 
time_t
 
möuãs
;

200 
time_t
 
£c⁄ds
;

201 
i
;

203 
i
 = 0; i < 
tm
->
tm_m⁄
; ++i) {

204 
days
 +
mdays
[
i
];

206 i‡(
tm
->
tm_m⁄
 > 1 && 
	`is_À≠_yór
(
yór
)) {

207 ++
days
;

209 
days
 +
tm
->
tm_mday
 - 1;

211 
hours
 = 
days
 * 24 + 
tm
->
tm_hour
;

212 
möuãs
 = 
hours
 * 60 + 
tm
->
tm_mö
;

213 
£c⁄ds
 = 
möuãs
 * 60 + 
tm
->
tm_£c
;

215  
£c⁄ds
;

216 
	}
}

218 
time_t


219 
	$mktime_‰om_utc
(c⁄° 
tm
 *tm)

221  
	`ldns_mktime_‰om_utc
(
tm
);

222 
	}
}

224 #i‡
SIZEOF_TIME_T
 <= 4

227 
	$ldns_yór_™d_yday_‰om_days_sö˚_ïoch
(
öt64_t
 
days
, 
tm
 *
ªsu…
)

229 
yór
 = 1970;

230 
√w_yór
;

232 
days
 < 0 || day†>(
öt64_t
Ë(
	`is_À≠_yór
(
yór
) ? 366 : 365)) {

233 
√w_yór
 = 
yór
 + (Ë
	`LDNS_DIV
(
days
, 365);

234 
days
 -(
√w_yór
 - 
yór
) * 365;

235 
days
 -
	`À≠_days
(
yór
, 
√w_yór
);

236 
yór
 = 
√w_yór
;

238 
ªsu…
->
tm_yór
 = 
yór
;

239 
ªsu…
->
tm_yday
 = (Ë
days
;

240 
	}
}

243 c⁄° 
	gÀ≠_yór_mdays
[] = {

248 
	$ldns_m⁄_™d_mday_‰om_yór_™d_yday
(
tm
 *
ªsu…
)

250 
idays
 = 
ªsu…
->
tm_yday
;

251 c⁄° *
m⁄_Àngths
 = 
	`is_À≠_yór
(
ªsu…
->
tm_yór
) ?

252 
À≠_yór_mdays
 : 
mdays
;

254 
ªsu…
->
tm_m⁄
 = 0;

255 
idays
 >
m⁄_Àngths
[
ªsu…
->
tm_m⁄
]) {

256 
idays
 -
m⁄_Àngths
[
ªsu…
->
tm_m⁄
++];

258 
ªsu…
->
tm_mday
 = 
idays
 + 1;

259 
	}
}

262 
	$ldns_wday_‰om_yór_™d_yday
(
tm
 *
ªsu…
)

264 
ªsu…
->
tm_wday
 = 4

265 + 
	`LDNS_MOD
((
ªsu…
->
tm_yór
 - 1970), 7) * LDNS_MOD(365, 7)

266 + 
	`À≠_days
(1970, 
ªsu…
->
tm_yór
)

267 + 
ªsu…
->
tm_yday
;

268 
ªsu…
->
tm_wday
 = 
	`LDNS_MOD
(result->tm_wday, 7);

269 i‡(
ªsu…
->
tm_wday
 < 0) {

270 
ªsu…
->
tm_wday
 += 7;

272 
	}
}

274 
tm
 *

275 
	$ldns_gmtime64_r
(
öt64_t
 
˛ock
, 
tm
 *
ªsu…
)

277 
ªsu…
->
tm_isd°
 = 0;

278 
ªsu…
->
tm_£c
 = (Ë
	`LDNS_MOD
(
˛ock
, 60);

279 
˛ock
 = 
	`LDNS_DIV
(clock, 60);

280 
ªsu…
->
tm_mö
 = (Ë
	`LDNS_MOD
(
˛ock
, 60);

281 
˛ock
 = 
	`LDNS_DIV
(clock, 60);

282 
ªsu…
->
tm_hour
 = (Ë
	`LDNS_MOD
(
˛ock
, 24);

283 
˛ock
 = 
	`LDNS_DIV
(clock, 24);

285 
	`ldns_yór_™d_yday_‰om_days_sö˚_ïoch
(
˛ock
, 
ªsu…
);

286 
	`ldns_m⁄_™d_mday_‰om_yór_™d_yday
(
ªsu…
);

287 
	`ldns_wday_‰om_yór_™d_yday
(
ªsu…
);

288 
ªsu…
->
tm_yór
 -= 1900;

290  
ªsu…
;

291 
	}
}

295 
öt64_t


296 
	$ldns_£rül_¨ôhmôics_time
(
öt32_t
 
time
, 
time_t
 
now
)

298 
öt32_t
 
off£t
 = 
time
 - (öt32_tË
now
;

299  (
öt64_t
Ë
now
 + 
off£t
;

300 
	}
}

303 
tm
 *

304 
	$ldns_£rül_¨ôhmôics_gmtime_r
(
öt32_t
 
time
, 
time_t
 
now
, 
tm
 *
ªsu…
)

306 #i‡
SIZEOF_TIME_T
 <= 4

307 
öt64_t
 
£cs_sö˚_ïoch
 = 
	`ldns_£rül_¨ôhmôics_time
(
time
, 
now
);

308  
	`ldns_gmtime64_r
(
£cs_sö˚_ïoch
, 
ªsu…
);

310 
time_t
 
£cs_sö˚_ïoch
 = 
	`ldns_£rül_¨ôhmôics_time
(
time
, 
now
);

311  
	`gmtime_r
(&
£cs_sö˚_ïoch
, 
ªsu…
);

313 
	}
}

327 
	$ldns_öô_øndom
(
FILE
 *
fd
, 
size
)

331 
FILE
 *
ønd_f
;

332 
uöt8_t
 *
£ed
;

333 
size_t
 
ªad
 = 0;

334 
£ed_i
;

335 
timevÆ
 
tv
;

339 i‡(
size
 < (Ë(
£ed_i
)){

340 
size
 = (Ë(
£ed_i
);

343 
£ed
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
size
);

344 if(!
£ed
) {

348 i‡(!
fd
) {

349 i‡((
ønd_f
 = 
	`f›í
("/dev/uøndom", "r")Ë=
NULL
) {

351 i‡((
ønd_f
 = 
	`f›í
("/dev/øndom", "r")Ë=
NULL
) {

354 
ªad
 = 0;Ñód < 
size
;Ñead++) {

355 
	`gëtimeofday
(&
tv
, 
NULL
);

356 
£ed
[
ªad
] = (
uöt8_t
Ë(
tv
.
tv_u£c
 % 256);

359 
ªad
 = 
	`‰ód
(
£ed
, 1, 
size
, 
ønd_f
);

362 
ªad
 = 
	`‰ód
(
£ed
, 1, 
size
, 
ønd_f
);

365 
ønd_f
 = 
fd
;

366 
ªad
 = 
	`‰ód
(
£ed
, 1, 
size
, 
ønd_f
);

369 i‡(
ªad
 < 
size
) {

370 
	`LDNS_FREE
(
£ed
);

371 i‡(!
fd
Ë
	`f˛o£
(
ønd_f
);

374 #ifde‡
HAVE_SSL


377 
	`RAND_£ed
(
£ed
, (Ë
size
);

382 
	`mem˝y
(&
£ed_i
, 
£ed
, (seed_i));

383 
	`§™dom
(
£ed_i
);

385 
	`LDNS_FREE
(
£ed
);

388 i‡(!
fd
) {

389 i‡(
ønd_f
Ë
	`f˛o£
(rand_f);

393 
	}
}

399 
uöt16_t


400 
	$ldns_gë_øndom
()

402 
uöt16_t
 
rid
 = 0;

403 #ifde‡
HAVE_SSL


404 i‡(
	`RAND_byãs
((*)&
rid
, 2) != 1) {

405 
rid
 = (
uöt16_t
Ë
	`øndom
();

408 
rid
 = (
uöt16_t
Ë
	`øndom
();

410  
rid
;

411 
	}
}

418 
	$ldns_bubbÀbabbÀ
(
uöt8_t
 *
d©a
, 
size_t
 
Àn
)

420 
vowñs
[] = { 'a', 'e', 'i', 'o', 'u', 'y' };

421 
c⁄s⁄™ts
[] = { 'b', 'c', 'd', 'f', 'g', 'h', 'k', 'l', 'm',

423 
size_t
 
i
, 
j
 = 0, 
rounds
, 
£ed
 = 1;

424 *
ªtvÆ
;

426 
rounds
 = (
Àn
 / 2) + 1;

427 
ªtvÆ
 = 
	`LDNS_XMALLOC
(, 
rounds
 * 6);

428 if(!
ªtvÆ
Ë 
NULL
;

429 
ªtvÆ
[
j
++] = 'x';

430 
i
 = 0; i < 
rounds
; i++) {

431 
size_t
 
idx0
, 
idx1
, 
idx2
, 
idx3
, 
idx4
;

432 i‡((
i
 + 1 < 
rounds
Ë|| (
Àn
 % 2 != 0)) {

433 
idx0
 = (((((
size_t
)(
d©a
[2 * 
i
])) >> 6) & 3) +

434 
£ed
) % 6;

435 
idx1
 = (((
size_t
)(
d©a
[2 * 
i
])) >> 2) & 15;

436 
idx2
 = ((((
size_t
)(
d©a
[2 * 
i
])) & 3) +

437 (
£ed
 / 6)) % 6;

438 
ªtvÆ
[
j
++] = 
vowñs
[
idx0
];

439 
ªtvÆ
[
j
++] = 
c⁄s⁄™ts
[
idx1
];

440 
ªtvÆ
[
j
++] = 
vowñs
[
idx2
];

441 i‡((
i
 + 1Ë< 
rounds
) {

442 
idx3
 = (((
size_t
)(
d©a
[(2 * 
i
) + 1])) >> 4) & 15;

443 
idx4
 = (((
size_t
)(
d©a
[(2 * 
i
) + 1]))) & 15;

444 
ªtvÆ
[
j
++] = 
c⁄s⁄™ts
[
idx3
];

445 
ªtvÆ
[
j
++] = '-';

446 
ªtvÆ
[
j
++] = 
c⁄s⁄™ts
[
idx4
];

447 
£ed
 = ((seed * 5) +

448 ((((
size_t
)(
d©a
[2 * 
i
])) * 7) +

449 ((
size_t
)(
d©a
[(2 * 
i
) + 1])))) % 36;

452 
idx0
 = 
£ed
 % 6;

453 
idx1
 = 16;

454 
idx2
 = 
£ed
 / 6;

455 
ªtvÆ
[
j
++] = 
vowñs
[
idx0
];

456 
ªtvÆ
[
j
++] = 
c⁄s⁄™ts
[
idx1
];

457 
ªtvÆ
[
j
++] = 
vowñs
[
idx2
];

460 
ªtvÆ
[
j
++] = 'x';

461 
ªtvÆ
[
j
++] = '\0';

462  
ªtvÆ
;

463 
	}
}

468 #ifde‡
HAVE_B64_NTOP


469 
ldns_b64_¡›
(c⁄° 
uöt8_t
* 
§c
, 
size_t
 
§˛ígth
,

470 *
èrgë
, 
size_t
 
èrgsize
);

472  
b64_¡›
(
§c
, 
§˛ígth
, 
èrgë
, 
èrgsize
);

479 #ifde‡
HAVE_B64_PTON


480 
	$ldns_b64_±⁄
(c⁄° * 
§c
, 
uöt8_t
 *
èrgë
, 
size_t
 
èrgsize
)

482  
	`b64_±⁄
(
§c
, 
èrgë
, 
èrgsize
);

483 
	}
}

488 
	$ldns_b32_¡›_ba£
(c⁄° 
uöt8_t
* 
§c
, 
size_t
 
§c_sz
,

489 * 
d°
, 
size_t
 
d°_sz
,

490 
boﬁ
 
exãnded_hex
, boﬁ 
add_∑ddög
)

492 
size_t
 
ªt_sz
;

493 c⁄° * 
b32
 = 
exãnded_hex
 ? "0123456789abcdefghijklmnopqrstuv"

496 
size_t
 
c
 = 0;

501 
ªt_sz
 = 
add_∑ddög
 ? 
	`ldns_b32_¡›_ˇlcuœã_size
(
§c_sz
)

502 : 
	`ldns_b32_¡›_ˇlcuœã_size_no_∑ddög
(
§c_sz
);

505 i‡(
d°_sz
 < 
ªt_sz
 + 1)

509 
d°
[
ªt_sz
] = '\0';

512 
§c_sz
 >= 5) {

514 
d°
[0] = 
b32
[(
§c
[0] ) >> 3];

517 
d°
[1] = 
b32
[(
§c
[0] & 0x07) << 2 | src[1] >> 6];

520 
d°
[2] = 
b32
[(
§c
[1] & 0x3e) >> 1];

523 
d°
[3] = 
b32
[(
§c
[1] & 0x01) << 4 | src[2] >> 4];

526 
d°
[4] = 
b32
[(
§c
[2] & 0x0f) << 1 | src[3] >> 7];

529 
d°
[5] = 
b32
[(
§c
[3] & 0x7c) >> 2];

532 
d°
[6] = 
b32
[(
§c
[3] & 0x03) << 3 | src[4] >> 5];

535 
d°
[7] = 
b32
[(
§c
[4] & 0x1f) ];

537 
§c_sz
 -= 5;

538 
§c
 += 5;

539 
d°
 += 8;

542 
§c_sz
) {

544 
d°
[6] = 
b32
[(
§c
[3] & 0x03) << 3];

547 
d°
[5] = 
b32
[(
§c
[3] & 0x7c) >> 2];

550 
c
 = 
§c
[3] >> 7 ;

551 3: 
d°
[4] = 
b32
[(
§c
[2] & 0x0fË<< 1 | 
c
];

554 
c
 = 
§c
[2] >> 4 ;

555 2: 
d°
[3] = 
b32
[(
§c
[1] & 0x01Ë<< 4 | 
c
];

558 
d°
[2] = 
b32
[(
§c
[1] & 0x3e) >> 1];

561 
c
 = 
§c
[1] >> 6 ;

562 1: 
d°
[1] = 
b32
[(
§c
[0] & 0x07Ë<< 2 | 
c
];

565 
d°
[0] = 
b32
[ 
§c
[0] >> 3];

568 i‡(
add_∑ddög
) {

569 
§c_sz
) {

570 1: 
d°
[2] = '=';

571 
d°
[3] = '=';

572 2: 
d°
[4] = '=';

573 3: 
d°
[5] = '=';

574 
d°
[6] = '=';

575 4: 
d°
[7] = '=';

578  ()
ªt_sz
;

579 
	}
}

582 
	$ldns_b32_¡›
(c⁄° 
uöt8_t
* 
§c
, 
size_t
 
§c_sz
, * 
d°
, size_à
d°_sz
)

584  
	`ldns_b32_¡›_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
Ál£
, 
åue
);

585 
	}
}

588 
	$ldns_b32_¡›_exãnded_hex
(c⁄° 
uöt8_t
* 
§c
, 
size_t
 
§c_sz
,

589 * 
d°
, 
size_t
 
d°_sz
)

591  
	`ldns_b32_¡›_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
åue
,Årue);

592 
	}
}

594 #i‚de‡
HAVE_B32_NTOP


597 
	$b32_¡›
(c⁄° 
uöt8_t
* 
§c
, 
size_t
 
§c_sz
, * 
d°
, size_à
d°_sz
)

599  
	`ldns_b32_¡›_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
Ál£
, 
åue
);

600 
	}
}

603 
	$b32_¡›_exãnded_hex
(c⁄° 
uöt8_t
* 
§c
, 
size_t
 
§c_sz
,

604 * 
d°
, 
size_t
 
d°_sz
)

606  
	`ldns_b32_¡›_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
åue
,Årue);

607 
	}
}

612 
	$ldns_b32_±⁄_ba£
(c⁄° * 
§c
, 
size_t
 
§c_sz
,

613 
uöt8_t
* 
d°
, 
size_t
 
d°_sz
,

614 
boﬁ
 
exãnded_hex
, boﬁ 
check_∑ddög
)

616 
size_t
 
i
 = 0;

617 
ch
 = '\0';

618 
uöt8_t
 
buf
[8];

619 
uöt8_t
* 
°¨t
 = 
d°
;

621 
§c_sz
) {

623 
i
 = 0; i < 8; i++) {

626 
ch
 = *
§c
++;

627 --
§c_sz
;

629 } 
	`is•a˚
(
ch
Ë&& 
§c_sz
 > 0);

631 i‡(
ch
 == '=' || ch == '\0')

634 i‡(
exãnded_hex
)

636 i‡(
ch
 >= '0' && ch <= '9')

637 
buf
[
i
] = (
uöt8_t
)
ch
 - '0';

638 i‡(
ch
 >= 'a' && ch <= 'v')

639 
buf
[
i
] = (
uöt8_t
)
ch
 - 'a' + 10;

640 i‡(
ch
 >= 'A' && ch <= 'V')

641 
buf
[
i
] = (
uöt8_t
)
ch
 - 'A' + 10;

645 i‡(
ch
 >= 'a' && ch <= 'z')

646 
buf
[
i
] = (
uöt8_t
)
ch
 - 'a';

647 i‡(
ch
 >= 'A' && ch <= 'Z')

648 
buf
[
i
] = (
uöt8_t
)
ch
 - 'A';

649 i‡(
ch
 >= '2' && ch <= '7')

650 
buf
[
i
] = (
uöt8_t
)
ch
 - '2' + 26;

655 i‡(
i
 < 8)

659 i‡(
d°_sz
 < 5)

664 
d°
[0] = 
buf
[0] << 3 | buf[1] >> 2;

669 
d°
[1] = 
buf
[1] << 6 | buf[2] << 1 | buf[3] >> 4;

673 
d°
[2] = 
buf
[3] << 4 | buf[4] >> 1;

678 
d°
[3] = 
buf
[4] << 7 | buf[5] << 2 | buf[6] >> 3;

682 
d°
[4] = 
buf
[6] << 5 | buf[7];

684 
d°
 += 5;

685 
d°_sz
 -= 5;

688 i‡(
i
 > 0 && i < 8) {

691 i‡(
d°_sz
 < (
i
 + 1) / 2)

694 
i
) {

698 
d°
[3] = 
buf
[4] << 7 | buf[5] << 2 | buf[6] >> 3;

702 
d°
[2] = 
buf
[3] << 4 | buf[4] >> 1;

707 
d°
[1] = 
buf
[1] << 6 | buf[2] << 1 | buf[3] >> 4;

711 
d°
[0] = 
buf
[0] << 3 | buf[1] >> 2;

718 
d°
 +(
i
 + 1) / 2;

720 i‡(
check_∑ddög
) {

722 i‡(
ch
 != '=')

726 
i
 = 8 - i - 1; i > 0; i--) {

729 i‡(
§c_sz
 == 0)

731 
ch
 = *
§c
++;

732 
§c_sz
--;

734 } 
	`is•a˚
(
ch
));

736 i‡(
ch
 != '=')

741  
d°
 - 
°¨t
;

742 
	}
}

745 
	$ldns_b32_±⁄
(c⁄° * 
§c
, 
size_t
 
§c_sz
, 
uöt8_t
* 
d°
, size_à
d°_sz
)

747  
	`ldns_b32_±⁄_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
Ál£
, 
åue
);

748 
	}
}

751 
	$ldns_b32_±⁄_exãnded_hex
(c⁄° * 
§c
, 
size_t
 
§c_sz
,

752 
uöt8_t
* 
d°
, 
size_t
 
d°_sz
)

754  
	`ldns_b32_±⁄_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
åue
,Årue);

755 
	}
}

757 #i‚de‡
HAVE_B32_PTON


760 
	$b32_±⁄
(c⁄° * 
§c
, 
size_t
 
§c_sz
, 
uöt8_t
* 
d°
, size_à
d°_sz
)

762  
	`ldns_b32_±⁄_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
Ál£
, 
åue
);

763 
	}
}

766 
	$b32_±⁄_exãnded_hex
(c⁄° * 
§c
, 
size_t
 
§c_sz
,

767 
uöt8_t
* 
d°
, 
size_t
 
d°_sz
)

769  
	`ldns_b32_±⁄_ba£
(
§c
, 
§c_sz
, 
d°
, 
d°_sz
, 
åue
,Årue);

770 
	}
}

	@wire2host.c

17 
	~<ldns/c⁄fig.h
>

19 
	~<ldns/ldns.h
>

22 
	~<°rögs.h
>

23 
	~<limôs.h
>

55 
ldns_°©us


56 
	$ldns_wúe2d«me
(
ldns_rdf
 **
d«me
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
)

58 
uöt8_t
 
œbñ_size
;

59 
uöt16_t
 
poöãr_èrgë
;

60 
uöt8_t
 
poöãr_èrgë_buf
[2];

61 
size_t
 
d«me_pos
 = 0;

62 
size_t
 
uncom¥es£d_Àngth
 = 0;

63 
size_t
 
com¥essi⁄_pos
 = 0;

64 
uöt8_t
 
tmp_d«me
[
LDNS_MAX_DOMAINLEN
];

65 
poöãr_cou¡
 = 0;

67 i‡(
pos
 =
NULL
) {

68  
LDNS_STATUS_WIRE_RDATA_ERR
;

70 i‡(*
pos
 >
max
) {

71  
LDNS_STATUS_PACKET_OVERFLOW
;

73 
œbñ_size
 = 
wúe
[*
pos
];

74 
œbñ_size
 > 0) {

76 
œbñ_size
 >= 192) {

77 i‡(
com¥essi⁄_pos
 == 0) {

78 
com¥essi⁄_pos
 = *
pos
 + 2;

81 
poöãr_cou¡
++;

84 i‡(*
pos
 + 2 > 
max
) {

85  
LDNS_STATUS_PACKET_OVERFLOW
;

87 
poöãr_èrgë_buf
[0] = 
wúe
[*
pos
] & 63;

88 
poöãr_èrgë_buf
[1] = 
wúe
[*
pos
 + 1];

89 
poöãr_èrgë
 = 
	`ldns_ªad_uöt16
(
poöãr_èrgë_buf
);

91 i‡(
poöãr_èrgë
 == 0) {

92  
LDNS_STATUS_INVALID_POINTER
;

93 } i‡(
poöãr_èrgë
 >
max
) {

94  
LDNS_STATUS_INVALID_POINTER
;

95 } i‡(
poöãr_cou¡
 > 
LDNS_MAX_POINTERS
) {

96  
LDNS_STATUS_INVALID_POINTER
;

98 *
pos
 = 
poöãr_èrgë
;

99 
œbñ_size
 = 
wúe
[*
pos
];

101 if(
œbñ_size
 == 0)

103 i‡(
œbñ_size
 > 
LDNS_MAX_LABELLEN
) {

104  
LDNS_STATUS_LABEL_OVERFLOW
;

106 i‡(*
pos
 + 1 + 
œbñ_size
 > 
max
) {

107  
LDNS_STATUS_LABEL_OVERFLOW
;

111 i‡(
d«me_pos
 + 1 > 
LDNS_MAX_DOMAINLEN
) {

112  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

114 
tmp_d«me
[
d«me_pos
] = 
œbñ_size
;

115 i‡(
œbñ_size
 > 0) {

116 
d«me_pos
++;

118 *
pos
 = *pos + 1;

119 i‡(
d«me_pos
 + 
œbñ_size
 > 
LDNS_MAX_DOMAINLEN
) {

120  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

122 
	`mem˝y
(&
tmp_d«me
[
d«me_pos
], &
wúe
[*
pos
], 
œbñ_size
);

123 
uncom¥es£d_Àngth
 +
œbñ_size
 + 1;

124 
d«me_pos
 +
œbñ_size
;

125 *
pos
 = *po†+ 
œbñ_size
;

127 i‡(*
pos
 < 
max
) {

128 
œbñ_size
 = 
wúe
[*
pos
];

132 i‡(
com¥essi⁄_pos
 > 0) {

133 *
pos
 = 
com¥essi⁄_pos
;

135 *
pos
 = *pos + 1;

138 i‡(
d«me_pos
 >
LDNS_MAX_DOMAINLEN
) {

139  
LDNS_STATUS_DOMAINNAME_OVERFLOW
;

142 
tmp_d«me
[
d«me_pos
] = 0;

143 
d«me_pos
++;

145 *
d«me
 = 
	`ldns_rdf_√w_‰m_d©a
(
LDNS_RDF_TYPE_DNAME
,

146 (
uöt16_t
Ë
d«me_pos
, 
tmp_d«me
);

147 i‡(!*
d«me
) {

148  
LDNS_STATUS_MEM_ERR
;

150  
LDNS_STATUS_OK
;

151 
	}
}

154 
	#LDNS_STATUS_CHECK_RETURN
(
°
Ë{i‡(° !
LDNS_STATUS_OK
Ë{  st; }}

	)

155 
	#LDNS_STATUS_CHECK_GOTO
(
°
, 
œbñ
Ë{i‡(° !
LDNS_STATUS_OK
Ë{ œbñ; }}

	)

157 
ldns_°©us


158 
	$ldns_wúe2rdf
(
ldns_º
 *
º
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
)

160 
size_t
 
íd
;

161 
size_t
 
cur_rdf_Àngth
;

162 
uöt8_t
 
rdf_ödex
;

163 
uöt8_t
 *
d©a
;

164 
uöt16_t
 
rd_Àngth
;

165 
ldns_rdf
 *
cur_rdf
 = 
NULL
;

166 
ldns_rdf_ty≥
 
cur_rdf_ty≥
;

167 c⁄° 
ldns_º_des¸ùt‹
 *
des¸ùt‹
;

168 
ldns_°©us
 
°©us
;

170 
	`as£π
(
º
 !
NULL
);

172 
des¸ùt‹
 = 
	`ldns_º_des¸ùt
(
	`ldns_º_gë_ty≥
(
º
));

174 i‡(*
pos
 + 2 > 
max
) {

175  
LDNS_STATUS_PACKET_OVERFLOW
;

178 
rd_Àngth
 = 
	`ldns_ªad_uöt16
(&
wúe
[*
pos
]);

179 *
pos
 = *pos + 2;

181 i‡(*
pos
 + 
rd_Àngth
 > 
max
) {

182  
LDNS_STATUS_PACKET_OVERFLOW
;

185 
íd
 = *
pos
 + (
size_t
Ë
rd_Àngth
;

187 
rdf_ödex
 = 0;

188 *
pos
 < 
íd
 &&

189 
rdf_ödex
 < 
	`ldns_º_des¸ùt‹_maximum
(
des¸ùt‹
)) {

191 
cur_rdf_Àngth
 = 0;

193 
cur_rdf_ty≥
 = 
	`ldns_º_des¸ùt‹_fõld_ty≥
(

194 
des¸ùt‹
, 
rdf_ödex
);

198 
cur_rdf_ty≥
) {

199 
LDNS_RDF_TYPE_DNAME
:

200 
°©us
 = 
	`ldns_wúe2d«me
(&
cur_rdf
, 
wúe
, 
max
, 
pos
);

201 
	`LDNS_STATUS_CHECK_RETURN
(
°©us
);

203 
LDNS_RDF_TYPE_CLASS
:

204 
LDNS_RDF_TYPE_ALG
:

205 
LDNS_RDF_TYPE_INT8
:

206 
cur_rdf_Àngth
 = 
LDNS_RDF_SIZE_BYTE
;

208 
LDNS_RDF_TYPE_TYPE
:

209 
LDNS_RDF_TYPE_INT16
:

210 
LDNS_RDF_TYPE_CERT_ALG
:

211 
cur_rdf_Àngth
 = 
LDNS_RDF_SIZE_WORD
;

213 
LDNS_RDF_TYPE_TIME
:

214 
LDNS_RDF_TYPE_INT32
:

215 
LDNS_RDF_TYPE_A
:

216 
LDNS_RDF_TYPE_PERIOD
:

217 
cur_rdf_Àngth
 = 
LDNS_RDF_SIZE_DOUBLEWORD
;

219 
LDNS_RDF_TYPE_TSIGTIME
:

220 
LDNS_RDF_TYPE_EUI48
:

221 
cur_rdf_Àngth
 = 
LDNS_RDF_SIZE_6BYTES
;

223 
LDNS_RDF_TYPE_ILNP64
:

224 
LDNS_RDF_TYPE_EUI64
:

225 
cur_rdf_Àngth
 = 
LDNS_RDF_SIZE_8BYTES
;

227 
LDNS_RDF_TYPE_AAAA
:

228 
cur_rdf_Àngth
 = 
LDNS_RDF_SIZE_16BYTES
;

230 
LDNS_RDF_TYPE_STR
:

231 
LDNS_RDF_TYPE_NSEC3_SALT
:

232 
LDNS_RDF_TYPE_TAG
:

237 
cur_rdf_Àngth
 = ((
size_t
Ë
wúe
[*
pos
]) + 1;

240 
LDNS_RDF_TYPE_INT16_DATA
:

241 i‡(*
pos
 + 2 > 
íd
) {

242  
LDNS_STATUS_PACKET_OVERFLOW
;

244 
cur_rdf_Àngth
 =

245 (
size_t
Ë
	`ldns_ªad_uöt16
(&
wúe
[*
pos
]) + 2;

247 
LDNS_RDF_TYPE_HIP
:

248 i‡(*
pos
 + 4 > 
íd
) {

249  
LDNS_STATUS_PACKET_OVERFLOW
;

251 
cur_rdf_Àngth
 =

252 (
size_t
Ë
wúe
[*
pos
] +

253 (
size_t
Ë
	`ldns_ªad_uöt16
(&
wúe
[*
pos
 + 2]) + 4;

255 
LDNS_RDF_TYPE_B32_EXT
:

256 
LDNS_RDF_TYPE_NSEC3_NEXT_OWNER
:

258 
cur_rdf_Àngth
 = ((
size_t
Ë
wúe
[*
pos
]) + 1;

260 
LDNS_RDF_TYPE_APL
:

261 
LDNS_RDF_TYPE_B64
:

262 
LDNS_RDF_TYPE_HEX
:

263 
LDNS_RDF_TYPE_NSEC
:

264 
LDNS_RDF_TYPE_UNKNOWN
:

265 
LDNS_RDF_TYPE_SERVICE
:

266 
LDNS_RDF_TYPE_LOC
:

267 
LDNS_RDF_TYPE_WKS
:

268 
LDNS_RDF_TYPE_NSAP
:

269 
LDNS_RDF_TYPE_ATMA
:

270 
LDNS_RDF_TYPE_IPSECKEY
:

271 
LDNS_RDF_TYPE_LONG_STR
:

272 
LDNS_RDF_TYPE_NONE
:

276 
cur_rdf_Àngth
 = 
íd
 - *
pos
;

281 i‡(
cur_rdf_Àngth
 > 0) {

282 i‡(
cur_rdf_Àngth
 + *
pos
 > 
íd
) {

283  
LDNS_STATUS_PACKET_OVERFLOW
;

285 
d©a
 = 
	`LDNS_XMALLOC
(
uöt8_t
, 
rd_Àngth
);

286 i‡(!
d©a
) {

287  
LDNS_STATUS_MEM_ERR
;

289 
	`mem˝y
(
d©a
, &
wúe
[*
pos
], 
cur_rdf_Àngth
);

291 
cur_rdf
 = 
	`ldns_rdf_√w
(
cur_rdf_ty≥
,

292 
cur_rdf_Àngth
, 
d©a
);

293 *
pos
 = *po†+ 
cur_rdf_Àngth
;

296 i‡(
cur_rdf
) {

297 
	`ldns_º_push_rdf
(
º
, 
cur_rdf
);

298 
cur_rdf
 = 
NULL
;

301 
rdf_ödex
++;

306  
LDNS_STATUS_OK
;

307 
	}
}

315 
ldns_°©us


316 
	$ldns_wúe2º
(
ldns_º
 **
º_p
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
,

317 
size_t
 *
pos
, 
ldns_pkt_£˘i⁄
 
£˘i⁄
)

319 
ldns_rdf
 *
ow√r
 = 
NULL
;

320 
ldns_º
 *
º
 = 
	`ldns_º_√w
();

321 
ldns_°©us
 
°©us
;

323 
°©us
 = 
	`ldns_wúe2d«me
(&
ow√r
, 
wúe
, 
max
, 
pos
);

324 
	`LDNS_STATUS_CHECK_GOTO
(
°©us
, 
°©us_îr‹
);

326 
	`ldns_º_£t_ow√r
(
º
, 
ow√r
);

328 i‡(*
pos
 + 4 > 
max
) {

329 
°©us
 = 
LDNS_STATUS_PACKET_OVERFLOW
;

330 
°©us_îr‹
;

333 
	`ldns_º_£t_ty≥
(
º
, 
	`ldns_ªad_uöt16
(&
wúe
[*
pos
]));

334 *
pos
 = *pos + 2;

336 
	`ldns_º_£t_˛ass
(
º
, 
	`ldns_ªad_uöt16
(&
wúe
[*
pos
]));

337 *
pos
 = *pos + 2;

339 i‡(
£˘i⁄
 !
LDNS_SECTION_QUESTION
) {

340 i‡(*
pos
 + 4 > 
max
) {

341 
°©us
 = 
LDNS_STATUS_PACKET_OVERFLOW
;

342 
°©us_îr‹
;

344 
	`ldns_º_£t_âl
(
º
, 
	`ldns_ªad_uöt32
(&
wúe
[*
pos
]));

346 *
pos
 = *pos + 4;

347 
°©us
 = 
	`ldns_wúe2rdf
(
º
, 
wúe
, 
max
, 
pos
);

349 
	`LDNS_STATUS_CHECK_GOTO
(
°©us
, 
°©us_îr‹
);

350 
	`ldns_º_£t_que°i⁄
(
º
, 
Ál£
);

352 
	`ldns_º_£t_que°i⁄
(
º
, 
åue
);

355 *
º_p
 = 
º
;

356  
LDNS_STATUS_OK
;

358 
°©us_îr‹
:

359 
	`ldns_º_‰ì
(
º
);

360  
°©us
;

361 
	}
}

363 
ldns_°©us


364 
	$ldns_wúe2pkt_hdr
(
ldns_pkt
 *
∑ckë
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
, size_à*
pos
)

366 i‡(*
pos
 + 
LDNS_HEADER_SIZE
 > 
max
) {

367  
LDNS_STATUS_WIRE_INCOMPLETE_HEADER
;

369 
	`ldns_pkt_£t_id
(
∑ckë
, 
	`LDNS_ID_WIRE
(
wúe
));

370 
	`ldns_pkt_£t_qr
(
∑ckë
, 
	`LDNS_QR_WIRE
(
wúe
));

371 
	`ldns_pkt_£t_›code
(
∑ckë
, 
	`LDNS_OPCODE_WIRE
(
wúe
));

372 
	`ldns_pkt_£t_Ø
(
∑ckë
, 
	`LDNS_AA_WIRE
(
wúe
));

373 
	`ldns_pkt_£t_tc
(
∑ckë
, 
	`LDNS_TC_WIRE
(
wúe
));

374 
	`ldns_pkt_£t_rd
(
∑ckë
, 
	`LDNS_RD_WIRE
(
wúe
));

375 
	`ldns_pkt_£t_ø
(
∑ckë
, 
	`LDNS_RA_WIRE
(
wúe
));

376 
	`ldns_pkt_£t_ad
(
∑ckë
, 
	`LDNS_AD_WIRE
(
wúe
));

377 
	`ldns_pkt_£t_cd
(
∑ckë
, 
	`LDNS_CD_WIRE
(
wúe
));

378 
	`ldns_pkt_£t_rcode
(
∑ckë
, 
	`LDNS_RCODE_WIRE
(
wúe
));

380 
	`ldns_pkt_£t_qdcou¡
(
∑ckë
, 
	`LDNS_QDCOUNT
(
wúe
));

381 
	`ldns_pkt_£t_™cou¡
(
∑ckë
, 
	`LDNS_ANCOUNT
(
wúe
));

382 
	`ldns_pkt_£t_nscou¡
(
∑ckë
, 
	`LDNS_NSCOUNT
(
wúe
));

383 
	`ldns_pkt_£t_¨cou¡
(
∑ckë
, 
	`LDNS_ARCOUNT
(
wúe
));

385 *
pos
 +
LDNS_HEADER_SIZE
;

387  
LDNS_STATUS_OK
;

389 
	}
}

391 
ldns_°©us


392 
	$ldns_buf„r2pkt_wúe
(
ldns_pkt
 **
∑ckë
, 
ldns_buf„r
 *
buf„r
)

395  
	`ldns_wúe2pkt
(
∑ckë
, 
	`ldns_buf„r_begö
(
buf„r
),

396 
	`ldns_buf„r_limô
(
buf„r
));

398 
	}
}

400 
ldns_°©us


401 
	$ldns_wúe2pkt
(
ldns_pkt
 **
∑ckë_p
, c⁄° 
uöt8_t
 *
wúe
, 
size_t
 
max
)

403 
size_t
 
pos
 = 0;

404 
uöt16_t
 
i
;

405 
ldns_º
 *
º
;

406 
ldns_pkt
 *
∑ckë
 = 
	`ldns_pkt_√w
();

407 
ldns_°©us
 
°©us
 = 
LDNS_STATUS_OK
;

408 
have_edns
 = 0;

410 
uöt8_t
 
d©a
[4];

412 
°©us
 = 
	`ldns_wúe2pkt_hdr
(
∑ckë
, 
wúe
, 
max
, &
pos
);

413 
	`LDNS_STATUS_CHECK_GOTO
(
°©us
, 
°©us_îr‹
);

415 
i
 = 0; i < 
	`ldns_pkt_qdcou¡
(
∑ckë
); i++) {

417 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
max
, &
pos
, 
LDNS_SECTION_QUESTION
);

418 i‡(
°©us
 =
LDNS_STATUS_PACKET_OVERFLOW
) {

419 
°©us
 = 
LDNS_STATUS_WIRE_INCOMPLETE_QUESTION
;

421 
	`LDNS_STATUS_CHECK_GOTO
(
°©us
, 
°©us_îr‹
);

422 i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_que°i⁄
(
∑ckë
), 
º
)) {

423 
	`ldns_pkt_‰ì
(
∑ckë
);

424  
LDNS_STATUS_INTERNAL_ERR
;

427 
i
 = 0; i < 
	`ldns_pkt_™cou¡
(
∑ckë
); i++) {

428 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
max
, &
pos
, 
LDNS_SECTION_ANSWER
);

429 i‡(
°©us
 =
LDNS_STATUS_PACKET_OVERFLOW
) {

430 
°©us
 = 
LDNS_STATUS_WIRE_INCOMPLETE_ANSWER
;

432 
	`LDNS_STATUS_CHECK_GOTO
(
°©us
, 
°©us_îr‹
);

433 i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_™swî
(
∑ckë
), 
º
)) {

434 
	`ldns_pkt_‰ì
(
∑ckë
);

435  
LDNS_STATUS_INTERNAL_ERR
;

438 
i
 = 0; i < 
	`ldns_pkt_nscou¡
(
∑ckë
); i++) {

439 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
max
, &
pos
, 
LDNS_SECTION_AUTHORITY
);

440 i‡(
°©us
 =
LDNS_STATUS_PACKET_OVERFLOW
) {

441 
°©us
 = 
LDNS_STATUS_WIRE_INCOMPLETE_AUTHORITY
;

443 
	`LDNS_STATUS_CHECK_GOTO
(
°©us
, 
°©us_îr‹
);

444 i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_auth‹ôy
(
∑ckë
), 
º
)) {

445 
	`ldns_pkt_‰ì
(
∑ckë
);

446  
LDNS_STATUS_INTERNAL_ERR
;

449 
i
 = 0; i < 
	`ldns_pkt_¨cou¡
(
∑ckë
); i++) {

450 
°©us
 = 
	`ldns_wúe2º
(&
º
, 
wúe
, 
max
, &
pos
, 
LDNS_SECTION_ADDITIONAL
);

451 i‡(
°©us
 =
LDNS_STATUS_PACKET_OVERFLOW
) {

452 
°©us
 = 
LDNS_STATUS_WIRE_INCOMPLETE_ADDITIONAL
;

454 
	`LDNS_STATUS_CHECK_GOTO
(
°©us
, 
°©us_îr‹
);

456 i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_OPT
) {

457 
	`ldns_pkt_£t_edns_udp_size
(
∑ckë
, 
	`ldns_º_gë_˛ass
(
º
));

458 
	`ldns_wrôe_uöt32
(
d©a
, 
	`ldns_º_âl
(
º
));

459 
	`ldns_pkt_£t_edns_exãnded_rcode
(
∑ckë
, 
d©a
[0]);

460 
	`ldns_pkt_£t_edns_vîsi⁄
(
∑ckë
, 
d©a
[1]);

461 
	`ldns_pkt_£t_edns_z
(
∑ckë
, 
	`ldns_ªad_uöt16
(&
d©a
[2]));

463 i‡(
	`ldns_º_rdf
(
º
, 0)) {

464 
	`ldns_pkt_£t_edns_d©a
(
∑ckë
, 
	`ldns_rdf_˛⁄e
(
	`ldns_º_rdf
(
º
, 0)));

466 
	`ldns_º_‰ì
(
º
);

467 
have_edns
 += 1;

468 } i‡(
	`ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_TSIG
) {

469 
	`ldns_pkt_£t_tsig
(
∑ckë
, 
º
);

470 
	`ldns_pkt_£t_¨cou¡
(
∑ckë
, 
	`ldns_pkt_¨cou¡
(packet) - 1);

471 } i‡(!
	`ldns_º_li°_push_º
(
	`ldns_pkt_addôi⁄Æ
(
∑ckë
), 
º
)) {

472 
	`ldns_pkt_‰ì
(
∑ckë
);

473  
LDNS_STATUS_INTERNAL_ERR
;

476 
	`ldns_pkt_£t_size
(
∑ckë
, 
max
);

477 if(
have_edns
)

478 
	`ldns_pkt_£t_¨cou¡
(
∑ckë
, 
	`ldns_pkt_¨cou¡
(packet)

479 - 
have_edns
);

481 *
∑ckë_p
 = 
∑ckë
;

482  
°©us
;

484 
°©us_îr‹
:

485 
	`ldns_pkt_‰ì
(
∑ckë
);

486  
°©us
;

487 
	}
}

	@zone.c

9 
	~<ldns/c⁄fig.h
>

11 
	~<ldns/ldns.h
>

13 
	~<°rögs.h
>

14 
	~<limôs.h
>

16 
ldns_º
 *

17 
	$ldns_z⁄e_sﬂ
(c⁄° 
ldns_z⁄e
 *
z
)

19  
z
->
_sﬂ
;

20 
	}
}

22 
size_t


23 
	$ldns_z⁄e_º_cou¡
(c⁄° 
ldns_z⁄e
 *
z
)

25  
	`ldns_º_li°_º_cou¡
(
z
->
_ºs
);

26 
	}
}

29 
	$ldns_z⁄e_£t_sﬂ
(
ldns_z⁄e
 *
z
, 
ldns_º
 *
sﬂ
)

31 
z
->
_sﬂ
 = 
sﬂ
;

32 
	}
}

34 
ldns_º_li°
 *

35 
	$ldns_z⁄e_ºs
(c⁄° 
ldns_z⁄e
 *
z
)

37  
z
->
_ºs
;

38 
	}
}

41 
	$ldns_z⁄e_£t_ºs
(
ldns_z⁄e
 *
z
, 
ldns_º_li°
 *
ºli°
)

43 
z
->
_ºs
 = 
ºli°
;

44 
	}
}

46 
boﬁ


47 
	$ldns_z⁄e_push_º_li°
(
ldns_z⁄e
 *
z
, 
ldns_º_li°
 *
li°
)

49  
	`ldns_º_li°_ˇt
(
	`ldns_z⁄e_ºs
(
z
), 
li°
);

51 
	}
}

53 
boﬁ


54 
	$ldns_z⁄e_push_º
(
ldns_z⁄e
 *
z
, 
ldns_º
 *
º
)

56  
	`ldns_º_li°_push_º
–
	`ldns_z⁄e_ºs
(
z
), 
º
);

57 
	}
}

65 
ldns_º_li°
 *

66 
	$ldns_z⁄e_glue_º_li°
(c⁄° 
ldns_z⁄e
 *
z
)

81 
ldns_º_li°
 *
z⁄e_cuts
;

82 
ldns_º_li°
 *
addr
;

83 
ldns_º_li°
 *
glue
;

84 
ldns_º
 *
r
, *
ns
, *
a
;

85 
ldns_rdf
 *
d«me_a
, *
ns_ow√r
;

86 
size_t
 
i
,
j
;

88 
z⁄e_cuts
 = 
NULL
;

89 
addr
 = 
NULL
;

90 
glue
 = 
NULL
;

93 i‡(!
	`ldns_z⁄e_sﬂ
(
z
)) {

94  
NULL
;

97 
z⁄e_cuts
 = 
	`ldns_º_li°_√w
();

98 i‡(!
z⁄e_cuts
Ë
mem‹y_îr‹
;

99 
addr
 = 
	`ldns_º_li°_√w
();

100 i‡(!
addr
Ë
mem‹y_îr‹
;

101 
glue
 = 
	`ldns_º_li°_√w
();

102 i‡(!
glue
Ë
mem‹y_îr‹
;

104 
i
 = 0; i < 
	`ldns_z⁄e_º_cou¡
(
z
); i++) {

105 
r
 = 
	`ldns_º_li°_º
(
	`ldns_z⁄e_ºs
(
z
), 
i
);

106 i‡(
	`ldns_º_gë_ty≥
(
r
Ë=
LDNS_RR_TYPE_A
 ||

107 
	`ldns_º_gë_ty≥
(
r
Ë=
LDNS_RR_TYPE_AAAA
) {

109 i‡(!
	`ldns_º_li°_push_º
(
addr
, 
r
)Ë
mem‹y_îr‹
;

112 i‡(
	`ldns_º_gë_ty≥
(
r
Ë=
LDNS_RR_TYPE_NS
) {

117 i‡(
	`ldns_rdf_com∑ª
(
	`ldns_º_ow√r
(
r
),

118 
	`ldns_º_ow√r
(
	`ldns_z⁄e_sﬂ
(
z
))) != 0) {

119 i‡(!
	`ldns_º_li°_push_º
(
z⁄e_cuts
, 
r
)Ë
mem‹y_îr‹
;

126 
i
 = 0; i < 
	`ldns_º_li°_º_cou¡
(
z⁄e_cuts
); i++) {

127 
ns
 = 
	`ldns_º_li°_º
(
z⁄e_cuts
, 
i
);

128 
ns_ow√r
 = 
	`ldns_º_ow√r
(
ns
);

130 
j
 = 0; j < 
	`ldns_º_li°_º_cou¡
(
addr
); j++) {

131 
a
 = 
	`ldns_º_li°_º
(
addr
, 
j
);

132 
d«me_a
 = 
	`ldns_º_ow√r
(
a
);

134 i‡(
	`ldns_d«me_is_subdomaö
(
d«me_a
, 
ns_ow√r
) ||

135 
	`ldns_d«me_com∑ª
(
d«me_a
, 
ns_ow√r
) == 0) {

137 i‡(!
	`ldns_º_li°_push_º
(
glue
, 
a
)Ë
mem‹y_îr‹
;

142 
	`ldns_º_li°_‰ì
(
addr
);

143 
	`ldns_º_li°_‰ì
(
z⁄e_cuts
);

145 i‡(
	`ldns_º_li°_º_cou¡
(
glue
) == 0) {

146 
	`ldns_º_li°_‰ì
(
glue
);

147  
NULL
;

149  
glue
;

152 
mem‹y_îr‹
:

153 i‡(
z⁄e_cuts
) {

154 
	`LDNS_FREE
(
z⁄e_cuts
);

156 i‡(
addr
) {

157 
	`ldns_º_li°_‰ì
(
addr
);

159 i‡(
glue
) {

160 
	`ldns_º_li°_‰ì
(
glue
);

162  
NULL
;

163 
	}
}

165 
ldns_z⁄e
 *

166 
	$ldns_z⁄e_√w
()

168 
ldns_z⁄e
 *
z
;

170 
z
 = 
	`LDNS_MALLOC
(
ldns_z⁄e
);

171 i‡(!
z
) {

172  
NULL
;

175 
z
->
_ºs
 = 
	`ldns_º_li°_√w
();

176 i‡(!
z
->
_ºs
) {

177 
	`LDNS_FREE
(
z
);

178  
NULL
;

180 
	`ldns_z⁄e_£t_sﬂ
(
z
, 
NULL
);

181  
z
;

182 
	}
}

187 
ldns_°©us


188 
	$ldns_z⁄e_√w_‰m_Â
(
ldns_z⁄e
 **
z
, 
FILE
 *
Â
, 
ldns_rdf
 *
‹igö
, 
uöt32_t
 
âl
, 
ldns_º_˛ass
 
c
)

190  
	`ldns_z⁄e_√w_‰m_Â_l
(
z
, 
Â
, 
‹igö
, 
âl
, 
c
, 
NULL
);

191 
	}
}

194 
ldns_°©us


195 
ldns_z⁄e_√w_‰m_Â_l
(
ldns_z⁄e
 **
z
, 
FILE
 *
Â
, 
ldns_rdf
 *
‹igö
, 
uöt32_t
 
âl
,

196 
ldns_º_˛ass
 
ATTR_UNUSED
(
c
), *
löe_ƒ
)

198 
ldns_z⁄e
 *
	g√wz⁄e
;

199 
ldns_º
 *
	gº
;

200 
uöt32_t
 
	gmy_âl
;

201 
ldns_rdf
 *
	gmy_‹igö
;

202 
ldns_rdf
 *
	gmy_¥ev
;

203 
boﬁ
 
	gsﬂ_£í
 = 
Ál£
;

204 
ldns_°©us
 
	gs
;

205 
ldns_°©us
 
	gªt
;

208 
	gªt
 = 
LDNS_STATUS_MEM_ERR
;

210 
	g√wz⁄e
 = 
NULL
;

211 
	gmy_‹igö
 = 
NULL
;

212 
	gmy_¥ev
 = 
NULL
;

214 
	gmy_âl
 = 
âl
;

216 i‡(
	g‹igö
) {

217 
	gmy_‹igö
 = 
ldns_rdf_˛⁄e
(
‹igö
);

218 i‡(!
	gmy_‹igö
Ë
	gîr‹
;

220 
	gmy_¥ev
 = 
ldns_rdf_˛⁄e
(
‹igö
);

221 i‡(!
	gmy_¥ev
Ë
	gîr‹
;

224 
	g√wz⁄e
 = 
ldns_z⁄e_√w
();

225 i‡(!
	g√wz⁄e
Ë
	gîr‹
;

227 !
„of
(
Â
)) {

228 
	gs
 = 
ldns_º_√w_‰m_Â_l
(&
º
, 
Â
, &
my_âl
, &
my_‹igö
, &
my_¥ev
, 
löe_ƒ
);

229 
	gs
) {

230 
	gLDNS_STATUS_OK
:

231 i‡(
ldns_º_gë_ty≥
(
º
Ë=
LDNS_RR_TYPE_SOA
) {

232 i‡(
sﬂ_£í
) {

236 
ldns_º_‰ì
(
º
);

239 
	gsﬂ_£í
 = 
åue
;

240 
ldns_z⁄e_£t_sﬂ
(
√wz⁄e
, 
º
);

242 i‡(!
	gmy_‹igö
) {

243 
	gmy_‹igö
 = 
ldns_rdf_˛⁄e
(
ldns_º_ow√r
(
º
));

249 i‡(!
ldns_z⁄e_push_º
(
√wz⁄e
, 
º
)Ë
	gîr‹
;

251 
	gLDNS_STATUS_SYNTAX_EMPTY
:

253 
LDNS_STATUS_SYNTAX_TTL
:

256 
	gLDNS_STATUS_SYNTAX_ORIGIN
:

259 
	gLDNS_STATUS_SYNTAX_INCLUDE
:

260 
ªt
 = 
LDNS_STATUS_SYNTAX_INCLUDE_ERR_NOTIMPL
;

263 
ªt
 = 
s
;

264 
	gîr‹
;

268 i‡(
	gmy_‹igö
) {

269 
ldns_rdf_dìp_‰ì
(
my_‹igö
);

271 i‡(
	gmy_¥ev
) {

272 
ldns_rdf_dìp_‰ì
(
my_¥ev
);

274 i‡(
	gz
) {

275 *
	gz
 = 
√wz⁄e
;

277 
ldns_z⁄e_‰ì
(
√wz⁄e
);

280  
	gLDNS_STATUS_OK
;

282 
	gîr‹
:

283 i‡(
my_‹igö
) {

284 
ldns_rdf_dìp_‰ì
(
my_‹igö
);

286 i‡(
	gmy_¥ev
) {

287 
ldns_rdf_dìp_‰ì
(
my_¥ev
);

289 i‡(
	g√wz⁄e
) {

290 
ldns_z⁄e_‰ì
(
√wz⁄e
);

292  
	gªt
;

296 
	$ldns_z⁄e_s‹t
(
ldns_z⁄e
 *
z⁄e
)

298 
ldns_º_li°
 *
zº
;

299 
	`as£π
(
z⁄e
 !
NULL
);

301 
zº
 = 
	`ldns_z⁄e_ºs
(
z⁄e
);

302 
	`ldns_º_li°_s‹t
(
zº
);

303 
	}
}

306 
	$ldns_z⁄e_‰ì
(
ldns_z⁄e
 *
z⁄e
)

308 
	`ldns_º_li°_‰ì
(
z⁄e
->
_ºs
);

309 
	`LDNS_FREE
(
z⁄e
);

310 
	}
}

313 
	$ldns_z⁄e_dìp_‰ì
(
ldns_z⁄e
 *
z⁄e
)

315 
	`ldns_º_‰ì
(
z⁄e
->
_sﬂ
);

316 
	`ldns_º_li°_dìp_‰ì
(
z⁄e
->
_ºs
);

317 
	`LDNS_FREE
(
z⁄e
);

318 
	}
}

	@
1
.
0
157
2718
buffer.c
compat/b64_ntop.c
compat/b64_pton.c
compat/calloc.c
compat/ctime_r.c
compat/fake-rfc2553.c
compat/fake-rfc2553.h
compat/gmtime_r.c
compat/inet_aton.c
compat/inet_ntop.c
compat/inet_pton.c
compat/isascii.c
compat/isblank.c
compat/localtime_r.c
compat/malloc.c
compat/memmove.c
compat/realloc.c
compat/snprintf.c
compat/strlcpy.c
compat/timegm.c
config.h
contrib/DNS-LDNS/ppport.h
dane.c
dname.c
dnssec.c
dnssec_sign.c
dnssec_verify.c
dnssec_zone.c
drill/chasetrace.c
drill/dnssec.c
drill/drill.c
drill/drill.h
drill/drill_util.c
drill/drill_util.h
drill/error.c
drill/root.c
drill/securetrace.c
drill/work.c
duration.c
error.c
examples/fake-rfc2553.h
examples/ldns-chaos.c
examples/ldns-compare-zones.c
examples/ldns-dane.c
examples/ldns-dpa.c
examples/ldns-dpa.h
examples/ldns-gen-zone.c
examples/ldns-key2ds.c
examples/ldns-keyfetcher.c
examples/ldns-keygen.c
examples/ldns-mx.c
examples/ldns-notify.c
examples/ldns-nsec3-hash.c
examples/ldns-read-zone.c
examples/ldns-resolver.c
examples/ldns-revoke.c
examples/ldns-rrsig.c
examples/ldns-signzone.c
examples/ldns-test-edns.c
examples/ldns-testns.c
examples/ldns-testpkts.c
examples/ldns-testpkts.h
examples/ldns-update.c
examples/ldns-verify-zone.c
examples/ldns-version.c
examples/ldns-walk.c
examples/ldns-zcat.c
examples/ldns-zsplit.c
examples/ldnsd.c
higher.c
host2str.c
host2wire.c
include/ldns/buffer.h
include/ldns/common.h
include/ldns/config.h
include/ldns/dane.h
include/ldns/dname.h
include/ldns/dnssec.h
include/ldns/dnssec_sign.h
include/ldns/dnssec_verify.h
include/ldns/dnssec_zone.h
include/ldns/duration.h
include/ldns/error.h
include/ldns/higher.h
include/ldns/host2str.h
include/ldns/host2wire.h
include/ldns/keys.h
include/ldns/ldns.h
include/ldns/net.h
include/ldns/packet.h
include/ldns/parse.h
include/ldns/radix.h
include/ldns/rbtree.h
include/ldns/rdata.h
include/ldns/resolver.h
include/ldns/rr.h
include/ldns/rr_functions.h
include/ldns/sha1.h
include/ldns/sha2.h
include/ldns/str2host.h
include/ldns/tsig.h
include/ldns/update.h
include/ldns/util.h
include/ldns/wire2host.h
include/ldns/zone.h
keys.c
ldns/buffer.h
ldns/common.h
ldns/config.h
ldns/dane.h
ldns/dname.h
ldns/dnssec.h
ldns/dnssec_sign.h
ldns/dnssec_verify.h
ldns/dnssec_zone.h
ldns/duration.h
ldns/error.h
ldns/higher.h
ldns/host2str.h
ldns/host2wire.h
ldns/keys.h
ldns/ldns.h
ldns/net.h
ldns/packet.h
ldns/parse.h
ldns/radix.h
ldns/rbtree.h
ldns/rdata.h
ldns/resolver.h
ldns/rr.h
ldns/rr_functions.h
ldns/sha1.h
ldns/sha2.h
ldns/str2host.h
ldns/tsig.h
ldns/update.h
ldns/util.h
ldns/wire2host.h
ldns/zone.h
linktest.c
net.c
packet.c
parse.c
radix.c
rbtree.c
rdata.c
resolver.c
rr.c
rr_functions.c
sha1.c
sha2.c
str2host.c
tsig.c
update.c
util.c
wire2host.c
zone.c
